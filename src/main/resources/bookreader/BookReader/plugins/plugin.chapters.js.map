{"version":3,"file":"plugins/plugin.chapters.js","mappings":"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","sources":["webpack://@internetarchive/bookreader/./node_modules/core-js/internals/string-trim-forced.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.trim.js","webpack://@internetarchive/bookreader/./src/BookReaderPlugin.js","webpack://@internetarchive/bookreader/./node_modules/@internetarchive/icon-toc/index.js","webpack://@internetarchive/bookreader/./node_modules/@internetarchive/icon-toc/icon-toc.js","webpack://@internetarchive/bookreader/./src/plugins/plugin.chapters.js","webpack://@internetarchive/bookreader/../src/directives/if-defined.ts","webpack://@internetarchive/bookreader/./src/util/strings.js"],"sourcesContent":["'use strict';\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","// @ts-check\r\n/** @typedef {import(\"./BookReader.js\").default} BookReader */\r\n\r\n/**\r\n * @template TOptions\r\n */\r\nexport class BookReaderPlugin {\r\n  /**\r\n   * @param {BookReader} br\r\n   */\r\n  constructor(br) {\r\n    /** @type {BookReader} */\r\n    this.br = br;\r\n    /** @type {TOptions} */\r\n    this.options;\r\n  }\r\n\r\n  /**\r\n   * @abstract\r\n   * @param {TOptions} options\r\n   **/\r\n  setup(options) {\r\n    this.options = Object.assign({}, this.options, options);\r\n  }\r\n\r\n  /** @abstract */\r\n  init() {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @protected\r\n   * @param {import (\"./BookReader/PageContainer.js\").PageContainer} pageContainer\r\n   */\r\n  _configurePageContainer(pageContainer) {\r\n  }\r\n\r\n  /**\r\n   * @abstract\r\n   * @protected\r\n   * @param {JQuery<HTMLElement>} $toolbarElement\r\n   */\r\n  _configureToolbar($toolbarElement) {\r\n  }\r\n\r\n  /** @abstract @protected */\r\n  _bindNavigationHandlers() {}\r\n\r\n  /**\r\n   * @param {JQuery<HTMLElement>} $navBar\r\n   */\r\n  extendNavBar($navBar) {}\r\n}\r\n","import { html } from 'lit';\n\nexport default html`\n<svg\n  viewBox=\"0 0 24 24\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  aria-labelledby=\"tocTitleID tocDescID\"\n>\n  <title id=\"tocTitleID\">Table of contents icon</title>\n  <desc id=\"tocDescID\">An illustration of three text list items</desc>\n  <g class=\"fill-color\" fill-rule=\"evenodd\"><rect height=\"3\" rx=\"1.5\" width=\"18\" x=\"6\"/><rect height=\"3\" rx=\"1.5\" width=\"18\" x=\"6\" y=\"21\"/><rect height=\"3\" rx=\"1.5\" width=\"18\" x=\"6\" y=\"14\"/><rect height=\"3\" rx=\"1.5\" width=\"18\" x=\"6\" y=\"7\"/><rect height=\"3\" rx=\"1.5\" width=\"4\"/><rect height=\"3\" rx=\"1.5\" width=\"4\" y=\"21\"/><rect height=\"3\" rx=\"1.5\" width=\"4\" y=\"14\"/><rect height=\"3\" rx=\"1.5\" width=\"4\" y=\"7\"/></g>\n</svg>\n`;\n","import icon from './index.js';\nimport { css, LitElement } from 'lit';\n\nclass IAIconToc extends LitElement {\n  static get styles() {\n    return css`\n      :host {\n        width: var(--iconWidth, 'auto');\n        height: var(--iconHeight, 'auto');\n      }\n\n      .fill-color {\n        fill: var(--iconFillColor);\n      }\n\n      .stroke-color {\n        stroke: var(--iconStrokeColor);\n      }\n    `;\n  }\n\n  render() {\n    return icon;\n  }\n}\n\ncustomElements.define('ia-icon-toc', IAIconToc);\n\nexport default IAIconToc;\n","// @ts-check\r\nimport { css, html, LitElement, nothing } from \"lit\";\r\nimport { customElement, property } from 'lit/decorators.js';\r\nimport { ifDefined } from 'lit/directives/if-defined.js';\r\nimport { styleMap } from 'lit/directives/style-map.js';\r\nimport '@internetarchive/icon-toc/icon-toc.js';\r\nimport { BookReaderPlugin } from \"../BookReaderPlugin.js\";\r\nimport { applyVariables } from \"../util/strings.js\";\r\n/** @typedef {import('@/src/BookReader/BookModel.js').PageIndex} PageIndex */\r\n/** @typedef {import('@/src/BookReader/BookModel.js').PageString} PageString */\r\n/** @typedef {import('@/src/BookReader/BookModel.js').LeafNum} LeafNum */\r\n\r\n// @ts-ignore\r\nconst BookReader = /** @type {typeof import('@/src/BookReader.js').default} */(window.BookReader);\r\n\r\n/**\r\n * Plugin for chapter markers in BookReader. Fetches from openlibrary.org\r\n * Could be forked, or extended to alter behavior\r\n */\r\nexport class ChaptersPlugin extends BookReaderPlugin {\r\n  options = {\r\n    enabled: true,\r\n\r\n    /**\r\n     * The Open Library host to fetch/query Open Library.\r\n     * @type {import('@/src/util/strings.js').StringWithVars}\r\n     */\r\n    openLibraryHost: 'https://openlibrary.org',\r\n\r\n    /**\r\n     * The Open Library edition to fetch the table of contents from.\r\n     * E.g. 'OL12345M'\r\n     *\r\n     * @type {import('@/src/util/strings.js').StringWithVars}\r\n     */\r\n    openLibraryId: '',\r\n\r\n    /**\r\n     * The Internet Archive identifier to fetch the Open Library table\r\n     * of contents from.\r\n     * E.g. 'goody'\r\n     *\r\n     * @type {import('@/src/util/strings.js').StringWithVars}\r\n     */\r\n    internetArchiveId: '',\r\n\r\n    /**\r\n     * @deprecated\r\n     * Old name for openLibraryHost\r\n     * @type {import('@/src/util/strings.js').StringWithVars}\r\n     */\r\n    olHost: 'https://openlibrary.org',\r\n\r\n    /**\r\n     * @deprecated\r\n     * Old name for internetArchiveId\r\n     * @type {import('@/src/util/strings.js').StringWithVars}\r\n     */\r\n    bookId: '{{bookId}}',\r\n  }\r\n\r\n  /** @type {TocEntry[]} */\r\n  _tocEntries;\r\n\r\n  /** @type {BRChaptersPanel} */\r\n  _chaptersPanel;\r\n\r\n  /** @override */\r\n  setup(options) {\r\n    super.setup(options);\r\n    this.options.internetArchiveId = this.options.internetArchiveId || this.options.bookId;\r\n    this.options.openLibraryHost = this.options.openLibraryHost || this.options.olHost;\r\n  }\r\n\r\n  /** @override Extend to call Open Library for TOC */\r\n  async init() {\r\n    if (!this.options.enabled || this.br.ui === 'embed') {\r\n      return;\r\n    }\r\n\r\n    let rawTableOfContents = null;\r\n    // Prefer explicit TOC if specified\r\n    if (this.br.options.table_of_contents?.length) {\r\n      rawTableOfContents = this.br.options.table_of_contents;\r\n    } else {\r\n      // Otherwise fetch from OL\r\n      const olEdition = await this.getOpenLibraryRecord();\r\n      if (olEdition?.table_of_contents?.length) {\r\n        rawTableOfContents = olEdition.table_of_contents;\r\n      }\r\n    }\r\n\r\n    if (rawTableOfContents) {\r\n      this._tocEntries = rawTableOfContents\r\n        .map(rawTOCEntry => (Object.assign({}, rawTOCEntry, {\r\n          pageIndex: (\r\n            typeof(rawTOCEntry.leaf) == 'number' ? this.br.book.leafNumToIndex(rawTOCEntry.leaf) :\r\n              rawTOCEntry.pagenum ? this.br.book.getPageIndex(rawTOCEntry.pagenum) :\r\n                undefined\r\n          ),\r\n        })));\r\n      this._render();\r\n      this.br.bind(BookReader.eventNames.pageChanged, () => this._updateCurrent());\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the table of contents based on array of TOC entries.\r\n   */\r\n  _render() {\r\n    this.br.shell.menuProviders['chapters'] = {\r\n      id: 'chapters',\r\n      icon: html`<ia-icon-toc style=\"width: var(--iconWidth); height: var(--iconHeight);\"></ia-icon-toc>`,\r\n      label: 'Table of Contents',\r\n      component: html`<br-chapters-panel\r\n        .contents=\"${this._tocEntries}\"\r\n        .jumpToPage=\"${(pageIndex) => {\r\n        this._updateCurrent(pageIndex);\r\n        this.br.jumpToIndex(pageIndex);\r\n      }}\"\r\n        @connected=\"${(e) => {\r\n        this._chaptersPanel = e.target;\r\n        this._updateCurrent();\r\n      }}\"\r\n      />`,\r\n    };\r\n    this.br.shell.addMenuShortcut('chapters');\r\n    this.br.shell.updateMenuContents();\r\n    this._tocEntries.forEach((tocEntry, i) => this._renderMarker(tocEntry, i));\r\n  }\r\n\r\n  /**\r\n   * @param {TocEntry} tocEntry\r\n   * @param {number} entryIndex\r\n   */\r\n  _renderMarker(tocEntry, entryIndex) {\r\n    if (tocEntry.pageIndex == undefined) return;\r\n\r\n    //creates a string with non-void tocEntry.label and tocEntry.title\r\n    const chapterStr = [tocEntry.label, tocEntry.title]\r\n      .filter(x => x)\r\n      .join(' ') || `Chapter ${entryIndex + 1}`;\r\n\r\n    const percentThrough = BookReader.util.cssPercentage(tocEntry.pageIndex, this.br.book.getNumLeafs() - 1);\r\n    $(`<div></div>`)\r\n      .append(\r\n        $('<div />')\r\n          .text(chapterStr)\r\n          .append(\r\n            $('<div class=\"BRchapterPage\" />')\r\n              .text(this.br.book.getPageName(tocEntry.pageIndex)),\r\n          ),\r\n      )\r\n      .addClass('BRchapter')\r\n      .css({ left: percentThrough })\r\n      .appendTo(this.br.$('.BRnavline'))\r\n      .on(\"mouseenter\", event => {\r\n        // remove hover effect from other markers then turn on just for this\r\n        const marker = event.currentTarget;\r\n        const tooltip = marker.querySelector('div');\r\n        const tooltipOffset = tooltip.getBoundingClientRect();\r\n        const targetOffset = marker.getBoundingClientRect();\r\n        const boxSizeAdjust = parseInt(getComputedStyle(tooltip).paddingLeft) * 2;\r\n        if (tooltipOffset.x - boxSizeAdjust < 0) {\r\n          tooltip.style.setProperty('transform', `translateX(-${targetOffset.left - boxSizeAdjust}px)`);\r\n        }\r\n        this.br.$('.BRsearch,.BRchapter').removeClass('front');\r\n        $(event.target).addClass('front');\r\n      })\r\n      .on(\"mouseleave\", event => $(event.target).removeClass('front'))\r\n      .on('click', () => {\r\n        this._updateCurrent(tocEntry.pageIndex);\r\n        this.br.jumpToIndex(tocEntry.pageIndex);\r\n      });\r\n\r\n    this.br.$('.BRchapter, .BRsearch').each((i, el) => {\r\n      const $el = $(el);\r\n      $el\r\n        .on(\"mouseenter\", () => $el.addClass('front'))\r\n        .on(\"mouseleave\", () => $el.removeClass('front'));\r\n    });\r\n  }\r\n\r\n  /**\r\n   * This makes a call to OL API and calls the given callback function with the\r\n   * response from the API.\r\n   */\r\n  async getOpenLibraryRecord() {\r\n    const olHost = applyVariables(this.options.openLibraryHost, this.br.options.vars);\r\n\r\n    if (this.options.openLibraryId) {\r\n      const openLibraryId = applyVariables(this.options.openLibraryId, this.br.options.vars);\r\n      return await $.ajax({ url: `${olHost}/books/${openLibraryId}.json` });\r\n    }\r\n\r\n    if (this.options.internetArchiveId) {\r\n      const ocaid = applyVariables(this.options.internetArchiveId, this.br.options.vars);\r\n\r\n      // Try looking up by ocaid first, then by source_record\r\n      const baseQueryUrl = `${olHost}/query.json?type=/type/edition&*=&`;\r\n\r\n      let data = await $.ajax({\r\n        url: baseQueryUrl + new URLSearchParams({ ocaid, limit: '1' }),\r\n      });\r\n\r\n      if (!data || !data.length) {\r\n        // try source_records\r\n        data = await $.ajax({\r\n          url: baseQueryUrl + new URLSearchParams({ source_records: `ia:${ocaid}`, limit: '1' }),\r\n        });\r\n      }\r\n\r\n      return data?.[0];\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Highlights the current chapter based on current page\r\n   * @param {PageIndex} curIndex\r\n   */\r\n  _updateCurrent(\r\n    curIndex = (this.br.mode == 2 ? Math.max(...this.br.displayedIndices) : this.br.firstIndex),\r\n  ) {\r\n    const tocEntriesIndexed = this._tocEntries.filter((el) => el.pageIndex != undefined).reverse();\r\n    const currChapter = tocEntriesIndexed[\r\n      // subtract one so that 2up shows the right label\r\n      tocEntriesIndexed.findIndex((chapter) => chapter.pageIndex <= curIndex)\r\n    ];\r\n    if (this._chaptersPanel) {\r\n      this._chaptersPanel.currentChapter = currChapter;\r\n    }\r\n  }\r\n}\r\nBookReader?.registerPlugin('chapters', ChaptersPlugin);\r\n\r\n/**\r\n * @typedef {Object} TocEntry\r\n * Table of contents entry as defined by Open Library, with some extra values for internal use\r\n * @property {number} [level]\r\n * @property {string} [label]\r\n * @property {string} [title]\r\n * @property {PageString} [pagenum]\r\n * @property {LeafNum} [leaf]\r\n * @property {number} [pageIndex] - Added\r\n *\r\n * @example {\r\n *   \"pagenum\": \"17\",\r\n *   \"level\": 1,\r\n *   \"label\": \"CHAPTER I\",\r\n *   \"title\": \"THE COUNTRY AND THE MISSION\"\r\n * }\r\n */\r\n\r\n@customElement('br-chapters-panel')\r\nexport class BRChaptersPanel extends LitElement {\r\n  /** @type {TocEntry[]} */\r\n  @property({ type: Array })\r\n  contents = [];\r\n\r\n  /** @type {TocEntry?} */\r\n  @property({ type: Object })\r\n  currentChapter = {};\r\n\r\n  /** @type {(pageIndex: PageIndex) => void} */\r\n  jumpToPage = () => {};\r\n\r\n  /**\r\n   * @param {TocEntry[]} contents\r\n   */\r\n  constructor(contents) {\r\n    super();\r\n    this.contents = contents;\r\n  }\r\n\r\n  render() {\r\n    return html`\r\n    <ol>\r\n      ${this.contents.map(tocEntry => this.renderTOCEntry(tocEntry))}\r\n    </ol>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * @param {TocEntry} tocEntry\r\n   */\r\n  renderTOCEntry(tocEntry) {\r\n    const chapterTitle = [tocEntry.label, tocEntry.title]\r\n      .filter(x => x)\r\n      .join(' ');\r\n    const clickable = tocEntry.pageIndex != undefined;\r\n    // note the click-tracking won't work...\r\n    return html`\r\n    <li\r\n      class=\"\r\n        BRtable-contents-el\r\n        ${clickable ? 'clickable' : ''}\r\n        ${tocEntry == this.currentChapter ? 'current' : ''}\r\n      \"\r\n      style=\"${styleMap({marginLeft: (tocEntry.level - 1) * 10 + 'px'})}\"\r\n      data-event-click-tracking=\"${ifDefined(clickable ? \"BRTOCPanel|GoToChapter\" : undefined)}\"\r\n      @click=\"${() => this.jumpToPage(tocEntry.pageIndex)}\"\r\n    >\r\n      ${chapterTitle}\r\n      ${tocEntry.pagenum ? html`\r\n        <br />\r\n        <span class=\"BRTOCElementPage\">Page ${tocEntry.pagenum}</span>\r\n      ` : nothing}\r\n    </li>`;\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.dispatchEvent(new CustomEvent('connected'));\r\n  }\r\n\r\n  updated(changedProperties) {\r\n    if (changedProperties.has('currentChapter')) {\r\n      this.shadowRoot.querySelector('li.current')?.scrollIntoView({\r\n        block: 'nearest',\r\n        behavior: 'smooth',\r\n      });\r\n    }\r\n  }\r\n\r\n  static get styles() {\r\n    return css`\r\n      ol {\r\n        padding: 0;\r\n        margin: 0;\r\n        margin-right: 5px;\r\n      }\r\n      li {\r\n        padding: 10px;\r\n        overflow: hidden;\r\n        border-radius: 4px;\r\n      }\r\n      li.clickable {\r\n        font-weight: normal;\r\n        cursor: pointer;\r\n        transition: background-color 0.2s;\r\n      }\r\n\r\n      li.clickable:not(.current):hover {\r\n        background-color: rgba(255,255,255, 0.05);\r\n      }\r\n\r\n      li.current {\r\n        background-color: rgba(255,255,255,0.9);\r\n        color: #333;\r\n      }\r\n\r\n      .BRTOCElementPage {\r\n        font-size: 0.85em;\r\n        opacity: .8;\r\n      }`;\r\n  }\r\n}\r\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nimport {nothing} from '../lit-html.js';\n\n/**\n * For AttributeParts, sets the attribute if the value is defined and removes\n * the attribute if the value is undefined.\n *\n * For other part types, this directive is a no-op.\n */\nexport const ifDefined = <T>(value: T) => value ?? nothing;\n","/**\r\n * @typedef {String} StringWithVars\r\n * A template string with {{foo}} style variables\r\n * Also supports filters, like {{bookPath|urlencode}} (See APPLY_FILTERS for the\r\n * supported list of filters)\r\n **/\r\n\r\n/**\r\n * @param {StringWithVars|String} template\r\n * @param { {[varName: string]: { toString: () => string} } } vars\r\n * @param { {[varName: string]: { toString: () => string} } } [overrides]\r\n * @returns {StringWithVars|string}\r\n */\r\nexport function applyVariables(template, vars, overrides = {}, possibleFilters = APPLY_FILTERS) {\r\n  return template?.replace(/\\{\\{([^}]*?)\\}\\}/g, ($0, $1) => {\r\n    if (!$1) return $0;\r\n    /** @type {string} */\r\n    const expression = $1;\r\n    const [varName, ...filterNames] = expression.split('|').map(x => x.trim());\r\n    const defined = varName in overrides || varName in vars;\r\n\r\n    // If it's not defined, don't expand it at all\r\n    if (!defined) return $0;\r\n\r\n    const value = varName in overrides ? overrides[varName]\r\n      : varName in vars ? vars[varName] : null;\r\n    const filters = filterNames.map(n => possibleFilters[n]);\r\n    return filters.reduce((acc, cur) => cur(acc), value && value.toString());\r\n  });\r\n}\r\n\r\n/** @type { {[filterName: String]:( string => string)} } */\r\nexport const APPLY_FILTERS = {\r\n  urlencode: encodeURIComponent,\r\n};\r\n"],"names":["PROPER_FUNCTION_NAME","fails","whitespaces","module","exports","METHOD_NAME","name","$","$trim","target","proto","forced","forcedStringTrimMethod","trim","this","BookReaderPlugin","br","_classCallCheck","options","key","value","Object","assign","pageContainer","$toolbarElement","$navBar","IAIconToc","styles","render","customElements","define","_regeneratorRuntime","e","t","r","prototype","n","hasOwnProperty","o","defineProperty","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","length","displayName","isGeneratorFunction","constructor","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","_createClass","_callSuper","_getPrototypeOf","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","Boolean","valueOf","_superPropGet","_get","get","bind","_superPropBase","getOwnPropertyDescriptor","_inherits","_setPrototypeOf","_defineProperty","toPrimitive","String","_toPrimitive","_initialize","BRChaptersPanel","BookReader","window","ChaptersPlugin","_BookReaderPlugin","_this","_len","args","Array","_key","concat","enabled","openLibraryHost","openLibraryId","internetArchiveId","olHost","bookId","_init","_callee","_this$br$options$tabl","rawTableOfContents","_olEdition$table_of_c","olEdition","_this2","_context","ui","table_of_contents","getOpenLibraryRecord","_tocEntries","map","rawTOCEntry","pageIndex","leaf","book","leafNumToIndex","pagenum","getPageIndex","undefined","_render","eventNames","pageChanged","_updateCurrent","_this3","shell","menuProviders","id","icon","html","_templateObject","_taggedTemplateLiteral","label","component","_templateObject2","jumpToIndex","_chaptersPanel","addMenuShortcut","updateMenuContents","tocEntry","_renderMarker","entryIndex","_this4","chapterStr","title","filter","x","join","percentThrough","util","cssPercentage","getNumLeafs","append","text","getPageName","addClass","css","left","appendTo","on","event","marker","currentTarget","tooltip","querySelector","tooltipOffset","getBoundingClientRect","targetOffset","boxSizeAdjust","parseInt","getComputedStyle","paddingLeft","style","setProperty","removeClass","each","el","$el","_getOpenLibraryRecord","_callee2","_data","ocaid","baseQueryUrl","data","_context2","applyVariables","vars","ajax","url","URLSearchParams","limit","source_records","curIndex","mode","Math","max","displayedIndices","firstIndex","tocEntriesIndexed","currChapter","findIndex","chapter","currentChapter","registerPlugin","customElement","LitElement","F","_LitElement2","contents","_this5","kind","decorators","property","_this6","_templateObject3","renderTOCEntry","_this7","chapterTitle","clickable","_templateObject4","styleMap","marginLeft","level","jumpToPage","_templateObject5","nothing","dispatchEvent","CustomEvent","changedProperties","_this$shadowRoot$quer","has","shadowRoot","scrollIntoView","block","behavior","static","_templateObject6","template","overrides","possibleFilters","APPLY_FILTERS","replace","$0","$1","_expression$split$map2","split","varName","filterNames","reduce","acc","cur","toString","urlencode","encodeURIComponent"],"sourceRoot":""}