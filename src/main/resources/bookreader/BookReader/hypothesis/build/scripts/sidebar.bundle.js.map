{"version":3,"file":"sidebar.bundle.js","sources":["app:///node_modules/focus-visible/dist/focus-visible.js","app:///node_modules/preact/dist/preact.mjs","app:///src/shared/injector.ts","app:///node_modules/preact/hooks/dist/hooks.mjs","app:///node_modules/@hypothesis/frontend-shared/lib/util/listener-collection.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-arrow-key-navigation.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-stable-callback.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-click-away.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-focus-away.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-key-press.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-popover-should-close.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-synced-ref.js","app:///node_modules/@hypothesis/frontend-shared/lib/util/date-and-time.js","app:///node_modules/classnames/index.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-tab-key-navigation.js","app:///node_modules/preact/jsx-runtime/dist/jsxRuntime.mjs","app:///node_modules/@hypothesis/frontend-shared/lib/components/layout/Overlay.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/CloseableContext.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/data/ScrollContext.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/data/Scroll.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/layout/Card.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/layout/CardActions.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/layout/CardContent.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Annotate.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/ArrowLeft.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/ArrowRight.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Cancel.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/CaretRight.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Caution.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/CcStd.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/CcZero.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Check.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Checkbox.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/CheckboxCheckedFilled.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Collapse.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Copy.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Download.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Edit.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/EditorLatex.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/EditorQuote.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/EditorTextBold.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/EditorTextItalic.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Email.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Expand.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/External.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/FileGeneric.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Flag.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/FlagFilled.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Globe.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/GlobeLock.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Groups.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Help.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Hide.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Highlight.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Image.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Info.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Leave.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Link.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/ListOrdered.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/ListUnordered.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/LockFilled.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Logo.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Mention.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/MenuCollapse.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/MenuExpand.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Minus.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Plus.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/PointerDown.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/PointerUp.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Profile.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Radio.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/RadioChecked.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Reply.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Restricted.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Search.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Share.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/SocialFacebook.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/SocialTwitter.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Sort.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/SpinnerSpokes.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/icons/Trash.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/Button.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/InputGroup.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/IconButton.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/CloseButton.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/layout/CardTitle.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/layout/CardHeader.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/layout/Panel.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/feedback/Dialog.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/feedback/ModalDialog.js","app:///node_modules/@hypothesis/frontend-shared/lib/util/prompts.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/ToggleInput.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/Checkbox.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/Input.js","app:///node_modules/@hypothesis/frontend-shared/lib/hooks/use-validation-error.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/RadioGroupContext.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/RadioGroup.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/feedback/Popover.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/SelectContext.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/input/Select.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/data/TableContext.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/data/TableSectionContext.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/feedback/Spinner.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/feedback/Callout.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/feedback/ToastMessages.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/navigation/Link.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/navigation/LinkButton.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/navigation/Pagination.js","app:///node_modules/@hypothesis/frontend-shared/lib/util/pagination.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/navigation/Tab.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/navigation/TabList.js","app:///node_modules/@hypothesis/frontend-shared/lib/components/transition/Slider.js","app:///src/sidebar/config/service-config.ts","app:///src/sidebar/helpers/is-third-party-service.ts","app:///src/sidebar/helpers/theme.ts","app:///src/sidebar/service-context.tsx","app:///node_modules/redux/dist/redux.mjs","app:///node_modules/redux-thunk/dist/redux-thunk.mjs","app:///src/sidebar/store/create-store.ts","app:///src/sidebar/store/debug-middleware.ts","app:///src/sidebar/store/modules/activity.ts","app:///node_modules/reselect/dist/reselect.mjs","app:///src/shared/has-own.ts","app:///src/sidebar/helpers/account-id.ts","app:///src/sidebar/helpers/annotation-metadata.ts","app:///src/sidebar/util/collections.ts","app:///src/sidebar/store/modules/route.ts","app:///src/sidebar/store/modules/session.ts","app:///src/sidebar/store/modules/annotations.ts","app:///src/sidebar/store/modules/defaults.ts","app:///src/sidebar/store/modules/direct-linked.ts","app:///src/sidebar/store/modules/drafts.ts","app:///src/sidebar/store/modules/filters.ts","app:///node_modules/shallowequal/index.js","app:///src/sidebar/store/modules/frames.ts","app:///src/sidebar/store/modules/groups.ts","app:///src/sidebar/util/url.ts","app:///src/sidebar/store/modules/links.ts","app:///src/sidebar/store/modules/real-time-updates.ts","app:///src/sidebar/store/modules/selection.ts","app:///src/sidebar/store/modules/sidebar-panels.ts","app:///src/sidebar/store/modules/toast-messages.ts","app:///src/sidebar/store/modules/viewer.ts","app:///src/sidebar/store/use-store.ts","app:///src/sidebar/store/index.ts","app:///src/sidebar/components/SidebarContentError.tsx","app:///node_modules/lodash.debounce/index.js","app:///src/sidebar/helpers/visible-threads.ts","app:///src/sidebar/util/dom.ts","app:///src/sidebar/helpers/thread.ts","app:///src/sidebar/helpers/annotation-user.ts","app:///src/sidebar/helpers/annotation-sharing.ts","app:///src/sidebar/helpers/permissions.ts","app:///src/shared/user-agent.ts","app:///src/sidebar/util/copy-to-clipboard.ts","app:///src/sidebar/components/MenuArrow.tsx","app:///src/sidebar/components/ShareLinks.tsx","app:///src/sidebar/components/Annotation/AnnotationShareControl.tsx","app:///src/sidebar/components/Annotation/AnnotationActionBar.tsx","app:///src/sidebar/components/Excerpt.tsx","app:///src/sidebar/util/observe-element-size.ts","app:///src/sidebar/helpers/mentions.ts","app:///src/sidebar/media-embedder.ts","app:///node_modules/dompurify/dist/purify.es.mjs","app:///node_modules/escape-html/index.js","app:///node_modules/katex/dist/katex.mjs","app:///node_modules/showdown/dist/showdown.js","app:///src/sidebar/render-markdown.ts","app:///src/sidebar/components/StyledText.tsx","app:///src/sidebar/components/mentions/MentionPopoverContent.tsx","app:///src/sidebar/components/MarkdownView.tsx","app:///src/sidebar/components/TagList.tsx","app:///src/sidebar/components/TagListItem.tsx","app:///src/sidebar/components/Annotation/AnnotationBody.tsx","app:///src/sidebar/markdown-commands.ts","app:///src/sidebar/util/textarea-caret-position.ts","app:///src/sidebar/components/MentionSuggestionsPopover.tsx","app:///src/sidebar/components/MarkdownEditor.tsx","app:///src/sidebar/helpers/mention-suggestions.ts","app:///src/sidebar/components/AutocompleteList.tsx","app:///src/sidebar/components/TagEditor.tsx","app:///src/sidebar/components/Annotation/AnnotationLicense.tsx","app:///src/sidebar/components/MenuKeyboardNavigation.tsx","app:///src/sidebar/components/Menu.tsx","app:///src/sidebar/components/MenuItem.tsx","app:///src/sidebar/components/Annotation/AnnotationPublishControl.tsx","app:///src/sidebar/components/Annotation/AnnotationEditor.tsx","app:///src/sidebar/components/Annotation/AnnotationDocumentInfo.tsx","app:///src/sidebar/components/Annotation/AnnotationGroupInfo.tsx","app:///src/sidebar/components/Annotation/AnnotationTimestamps.tsx","app:///src/sidebar/components/Annotation/AnnotationUser.tsx","app:///src/sidebar/components/Annotation/AnnotationHeader.tsx","app:///src/sidebar/components/Annotation/AnnotationQuote.tsx","app:///src/sidebar/components/Annotation/AnnotationReplyToggle.tsx","app:///src/sidebar/components/Annotation/AnnotationThumbnail.tsx","app:///src/sidebar/components/Annotation/Annotation.tsx","app:///src/sidebar/components/Annotation/EmptyAnnotation.tsx","app:///src/sidebar/components/ModerationBanner.tsx","app:///src/sidebar/components/Thread.tsx","app:///src/sidebar/components/ThreadCard.tsx","app:///src/sidebar/components/ThreadList.tsx","app:///src/sidebar/helpers/highlighted-annotations.ts","app:///src/sidebar/helpers/build-thread.ts","app:///src/shared/cfi.ts","app:///src/sidebar/util/page-range.ts","app:///src/sidebar/util/unicode.ts","app:///src/sidebar/helpers/filter-annotations.ts","app:///src/sidebar/helpers/query-parser.ts","app:///src/sidebar/helpers/tabs.ts","app:///src/sidebar/helpers/thread-sorters.ts","app:///src/sidebar/helpers/thread-annotations.ts","app:///src/sidebar/util/memoize.ts","app:///src/sidebar/components/hooks/use-root-thread.ts","app:///src/sidebar/components/AnnotationView.tsx","app:///src/sidebar/helpers/version-data.ts","app:///node_modules/scroll-into-view/scrollIntoView.js","app:///src/sidebar/components/SidebarPanel.tsx","app:///src/sidebar/components/Tutorial.tsx","app:///src/sidebar/components/VersionInfo.tsx","app:///src/sidebar/components/tabs/TabHeader.tsx","app:///src/sidebar/components/tabs/TabPanel.tsx","app:///src/sidebar/components/HelpPanel.tsx","app:///src/shared/event-emitter.ts","app:///src/sidebar/search-client.ts","app:///src/sidebar/components/FilterSelect.tsx","app:///src/sidebar/components/NotebookFilters.tsx","app:///src/sidebar/components/hooks/use-filter-options.ts","app:///src/sidebar/components/NotebookResultCount.tsx","app:///src/sidebar/components/PaginatedThreadList.tsx","app:///src/shared/pluralize.ts","app:///src/shared/shortcut.ts","app:///src/sidebar/components/PendingUpdatesNotification.tsx","app:///src/sidebar/components/NotebookView.tsx","app:///src/sidebar/components/ProfileView.tsx","app:///src/sidebar/helpers/annotations-by-user.ts","app:///src/sidebar/helpers/export-annotations.ts","app:///src/sidebar/components/ShareDialog/LoadingSpinner.tsx","app:///src/sidebar/components/ShareDialog/UserAnnotationsListItem.tsx","app:///src/sidebar/components/ShareDialog/ExportAnnotations.tsx","app:///src/shared/download-file.ts","app:///src/shared/read-json-file.ts","app:///src/shared/promise-with-resolvers.ts","app:///src/sidebar/components/CircularProgress.tsx","app:///src/sidebar/components/ShareDialog/FileInput.tsx","app:///src/sidebar/components/ShareDialog/ImportAnnotations.tsx","app:///src/sidebar/helpers/import.ts","app:///src/shared/is-object.ts","app:///src/sidebar/components/ShareDialog/ShareAnnotations.tsx","app:///src/sidebar/components/ShareDialog/ShareDialog.tsx","app:///src/sidebar/components/LoggedOutMessage.tsx","app:///src/sidebar/components/LoginPromptPanel.tsx","app:///src/sidebar/components/SidebarTabs.tsx","app:///src/sidebar/components/search/FilterControls.tsx","app:///src/sidebar/components/SidebarView.tsx","app:///src/sidebar/components/StreamView.tsx","app:///src/sidebar/components/ToastMessages.tsx","app:///src/sidebar/helpers/group-list-item-common.ts","app:///src/sidebar/helpers/group-organizations.ts","app:///src/sidebar/components/MenuSection.tsx","app:///src/sidebar/components/GroupList/GroupListItem.tsx","app:///src/sidebar/components/GroupList/GroupListSection.tsx","app:///src/sidebar/components/GroupList/GroupList.tsx","app:///src/sidebar/components/SortMenu.tsx","app:///src/sidebar/components/PressableIconButton.tsx","app:///src/sidebar/components/TopBarToggleButton.tsx","app:///src/sidebar/components/OpenDashboardMenuItem.tsx","app:///src/sidebar/components/UserMenu.tsx","app:///src/sidebar/components/search/SearchIconButton.tsx","app:///src/sidebar/components/search/SearchField.tsx","app:///src/sidebar/components/search/StreamSearchInput.tsx","app:///src/sidebar/components/TopBar.tsx","app:///src/sidebar/components/search/SearchPanel.tsx","app:///src/sidebar/components/HypothesisApp.tsx","app:///src/sidebar/helpers/session.ts","app:///src/sidebar/components/LaunchErrorPanel.tsx","app:///src/shared/random.ts","app:///src/sidebar/util/postmessage-json-rpc.ts","app:///src/shared/config-fragment.ts","app:///src/shared/type-coercions.ts","app:///src/sidebar/config/build-settings.ts","app:///src/shared/warn-once.ts","app:///node_modules/escape-string-regexp/index.js","app:///src/sidebar/helpers/groups.ts","app:///src/sidebar/cross-origin-rpc.ts","app:///src/sidebar/services/analytics.ts","app:///src/sidebar/services/annotation-activity.ts","app:///src/sidebar/services/annotations.ts","app:///node_modules/preact-render-to-string/dist/jsx/index.mjs","app:///src/shared/trim-and-dedent.ts","app:///src/sidebar/helpers/strip-internal-properties.ts","app:///src/sidebar/util/time.ts","app:///src/sidebar/services/annotations-exporter.tsx","app:///src/shared/csv.ts","app:///src/sidebar/util/fetch.ts","app:///src/sidebar/services/api.ts","app:///node_modules/retry/lib/retry.js","app:///node_modules/retry/lib/retry_operation.js","app:///node_modules/retry/index.js","app:///src/sidebar/util/retry.ts","app:///src/sidebar/services/api-routes.ts","app:///src/sidebar/util/oauth-client.ts","app:///src/sidebar/services/auth.ts","app:///src/sidebar/services/autosave.ts","app:///src/sidebar/services/dashboard.ts","app:///src/shared/messaging/port-util.ts","app:///src/shared/messaging/port-finder.ts","app:///src/shared/frame-error-capture.ts","app:///src/shared/messaging/port-rpc.ts","app:///src/sidebar/helpers/annotation-segment.ts","app:///src/sidebar/util/watch.ts","app:///src/sidebar/services/frame-sync.ts","app:///src/sidebar/services/groups.ts","app:///src/sidebar/store/util.ts","app:///node_modules/@sentry/core/build/esm/debug-build.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/worldwide.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/debug-build.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/version.js","app:///node_modules/@sentry/core/build/esm/carrier.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/logger.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/stacktrace.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/instrument/handlers.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/instrument/globalError.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/instrument/globalUnhandledRejection.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/time.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/is.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/browser.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/string.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/object.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/misc.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/syncpromise.js","app:///node_modules/@sentry/core/build/esm/session.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/propagationContext.js","app:///node_modules/@sentry/core/build/esm/utils/merge.js","app:///node_modules/@sentry/core/build/esm/utils/spanOnScope.js","app:///node_modules/@sentry/core/build/esm/scope.js","app:///node_modules/@sentry/core/build/esm/asyncContext/stackStrategy.js","app:///node_modules/@sentry/core/build/esm/defaultScopes.js","app:///node_modules/@sentry/core/build/esm/asyncContext/index.js","app:///node_modules/@sentry/core/build/esm/currentScopes.js","app:///node_modules/@sentry/core/build/esm/semanticAttributes.js","app:///node_modules/@sentry/core/build/esm/tracing/spanstatus.js","app:///node_modules/@sentry/core/build/esm/tracing/utils.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/baggage.js","app:///node_modules/@sentry/core/build/esm/utils/spanUtils.js","app:///node_modules/@sentry/core/build/esm/constants.js","app:///node_modules/@sentry/core/build/esm/tracing/dynamicSamplingContext.js","app:///node_modules/@sentry/core/build/esm/utils/hasSpansEnabled.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/dsn.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/normalize.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/envelope.js","app:///node_modules/@sentry/core/build/esm/envelope.js","app:///node_modules/@sentry/core/build/esm/eventProcessors.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/debug-ids.js","app:///node_modules/@sentry/core/build/esm/utils/applyScopeDataToEvent.js","app:///node_modules/@sentry/core/build/esm/utils/prepareEvent.js","app:///node_modules/@sentry/core/build/esm/exports.js","app:///node_modules/@sentry/core/build/esm/api.js","app:///node_modules/@sentry/core/build/esm/integration.js","app:///node_modules/@sentry/core/build/esm/utils/eventUtils.js","app:///node_modules/@sentry/core/build/esm/client.js","app:///node_modules/@sentry/core/build/esm/utils/parseSampleRate.js","app:///node_modules/@sentry/core/build/esm/utils/transactionEvent.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/clientreport.js","app:///node_modules/@sentry/core/build/esm/logs/envelope.js","app:///node_modules/@sentry/core/build/esm/logs/exports.js","app:///node_modules/@sentry/core/build/esm/sdk.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/promisebuffer.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/ratelimit.js","app:///node_modules/@sentry/core/build/esm/transports/base.js","app:///node_modules/@sentry/core/build/esm/utils/ipAddress.js","app:///node_modules/@sentry/core/build/esm/breadcrumbs.js","app:///node_modules/@sentry/core/build/esm/integrations/functiontostring.js","app:///node_modules/@sentry/core/build/esm/integrations/eventFilters.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/aggregate-errors.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/instrument/console.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/severity.js","app:///node_modules/@sentry/core/build/esm/integrations/dedupe.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/url.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/breadcrumb-log-level.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/supports.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/instrument/fetch.js","app:///node_modules/@sentry/browser/build/npm/esm/helpers.js","app:///node_modules/@sentry/browser/build/npm/esm/eventbuilder.js","app:///node_modules/@sentry/browser/build/npm/esm/client.js","app:///node_modules/@sentry/core/build/esm/utils/sdkMetadata.js","app:///node_modules/@sentry/core/build/esm/utils-hoist/env.js","app:///node_modules/@sentry-internal/browser-utils/build/esm/debug-build.js","app:///node_modules/@sentry-internal/browser-utils/build/esm/types.js","app:///node_modules/@sentry-internal/browser-utils/build/esm/instrument/dom.js","app:///node_modules/@sentry-internal/browser-utils/build/esm/instrument/history.js","app:///node_modules/@sentry-internal/browser-utils/build/esm/getNativeImplementation.js","app:///node_modules/@sentry-internal/browser-utils/build/esm/instrument/xhr.js","app:///node_modules/@sentry/browser/build/npm/esm/transports/fetch.js","app:///node_modules/@sentry/browser/build/npm/esm/stack-parsers.js","app:///node_modules/@sentry/browser/build/npm/esm/debug-build.js","app:///node_modules/@sentry/browser/build/npm/esm/integrations/breadcrumbs.js","app:///node_modules/@sentry/browser/build/npm/esm/integrations/browserapierrors.js","app:///node_modules/@sentry/browser/build/npm/esm/integrations/browsersession.js","app:///node_modules/@sentry/browser/build/npm/esm/integrations/globalhandlers.js","app:///node_modules/@sentry/browser/build/npm/esm/integrations/httpcontext.js","app:///node_modules/@sentry/browser/build/npm/esm/integrations/linkederrors.js","app:///node_modules/@sentry/browser/build/npm/esm/sdk.js","app:///src/sidebar/util/sentry.ts","app:///src/sidebar/services/import-annotations.ts","app:///src/sidebar/services/load-annotations.ts","app:///src/sidebar/services/local-storage.ts","app:///src/sidebar/services/persisted-defaults.ts","app:///src/sidebar/services/router.ts","app:///src/sidebar/services/service-url.ts","app:///src/sidebar/services/session.ts","app:///src/sidebar/services/stream-filter.ts","app:///src/sidebar/websocket.ts","app:///src/sidebar/services/streamer.ts","app:///src/sidebar/services/tags.ts","app:///src/sidebar/services/threads.ts","app:///src/sidebar/services/thumbnail.ts","app:///src/sidebar/services/toast-messenger.ts","app:///src/sidebar/index.tsx","app:///src/boot/parse-json-config.ts","app:///src/sidebar/config/check-env.ts","app:///src/sidebar/util/disable-opener-for-external-links.ts","app:///src/sidebar/config/host-config.ts","app:///src/sidebar/config/get-api-url.ts"],"sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (factory());\n}(this, (function () { 'use strict';\n\n  /**\n   * Applies the :focus-visible polyfill at the given scope.\n   * A scope in this case is either the top-level Document or a Shadow Root.\n   *\n   * @param {(Document|ShadowRoot)} scope\n   * @see https://github.com/WICG/focus-visible\n   */\n  function applyFocusVisiblePolyfill(scope) {\n    var hadKeyboardEvent = true;\n    var hadFocusVisibleRecently = false;\n    var hadFocusVisibleRecentlyTimeout = null;\n\n    var inputTypesAllowlist = {\n      text: true,\n      search: true,\n      url: true,\n      tel: true,\n      email: true,\n      password: true,\n      number: true,\n      date: true,\n      month: true,\n      week: true,\n      time: true,\n      datetime: true,\n      'datetime-local': true\n    };\n\n    /**\n     * Helper function for legacy browsers and iframes which sometimes focus\n     * elements like document, body, and non-interactive SVG.\n     * @param {Element} el\n     */\n    function isValidFocusTarget(el) {\n      if (\n        el &&\n        el !== document &&\n        el.nodeName !== 'HTML' &&\n        el.nodeName !== 'BODY' &&\n        'classList' in el &&\n        'contains' in el.classList\n      ) {\n        return true;\n      }\n      return false;\n    }\n\n    /**\n     * Computes whether the given element should automatically trigger the\n     * `focus-visible` class being added, i.e. whether it should always match\n     * `:focus-visible` when focused.\n     * @param {Element} el\n     * @return {boolean}\n     */\n    function focusTriggersKeyboardModality(el) {\n      var type = el.type;\n      var tagName = el.tagName;\n\n      if (tagName === 'INPUT' && inputTypesAllowlist[type] && !el.readOnly) {\n        return true;\n      }\n\n      if (tagName === 'TEXTAREA' && !el.readOnly) {\n        return true;\n      }\n\n      if (el.isContentEditable) {\n        return true;\n      }\n\n      return false;\n    }\n\n    /**\n     * Add the `focus-visible` class to the given element if it was not added by\n     * the author.\n     * @param {Element} el\n     */\n    function addFocusVisibleClass(el) {\n      if (el.classList.contains('focus-visible')) {\n        return;\n      }\n      el.classList.add('focus-visible');\n      el.setAttribute('data-focus-visible-added', '');\n    }\n\n    /**\n     * Remove the `focus-visible` class from the given element if it was not\n     * originally added by the author.\n     * @param {Element} el\n     */\n    function removeFocusVisibleClass(el) {\n      if (!el.hasAttribute('data-focus-visible-added')) {\n        return;\n      }\n      el.classList.remove('focus-visible');\n      el.removeAttribute('data-focus-visible-added');\n    }\n\n    /**\n     * If the most recent user interaction was via the keyboard;\n     * and the key press did not include a meta, alt/option, or control key;\n     * then the modality is keyboard. Otherwise, the modality is not keyboard.\n     * Apply `focus-visible` to any current active element and keep track\n     * of our keyboard modality state with `hadKeyboardEvent`.\n     * @param {KeyboardEvent} e\n     */\n    function onKeyDown(e) {\n      if (e.metaKey || e.altKey || e.ctrlKey) {\n        return;\n      }\n\n      if (isValidFocusTarget(scope.activeElement)) {\n        addFocusVisibleClass(scope.activeElement);\n      }\n\n      hadKeyboardEvent = true;\n    }\n\n    /**\n     * If at any point a user clicks with a pointing device, ensure that we change\n     * the modality away from keyboard.\n     * This avoids the situation where a user presses a key on an already focused\n     * element, and then clicks on a different element, focusing it with a\n     * pointing device, while we still think we're in keyboard modality.\n     * @param {Event} e\n     */\n    function onPointerDown(e) {\n      hadKeyboardEvent = false;\n    }\n\n    /**\n     * On `focus`, add the `focus-visible` class to the target if:\n     * - the target received focus as a result of keyboard navigation, or\n     * - the event target is an element that will likely require interaction\n     *   via the keyboard (e.g. a text box)\n     * @param {Event} e\n     */\n    function onFocus(e) {\n      // Prevent IE from focusing the document or HTML element.\n      if (!isValidFocusTarget(e.target)) {\n        return;\n      }\n\n      if (hadKeyboardEvent || focusTriggersKeyboardModality(e.target)) {\n        addFocusVisibleClass(e.target);\n      }\n    }\n\n    /**\n     * On `blur`, remove the `focus-visible` class from the target.\n     * @param {Event} e\n     */\n    function onBlur(e) {\n      if (!isValidFocusTarget(e.target)) {\n        return;\n      }\n\n      if (\n        e.target.classList.contains('focus-visible') ||\n        e.target.hasAttribute('data-focus-visible-added')\n      ) {\n        // To detect a tab/window switch, we look for a blur event followed\n        // rapidly by a visibility change.\n        // If we don't see a visibility change within 100ms, it's probably a\n        // regular focus change.\n        hadFocusVisibleRecently = true;\n        window.clearTimeout(hadFocusVisibleRecentlyTimeout);\n        hadFocusVisibleRecentlyTimeout = window.setTimeout(function() {\n          hadFocusVisibleRecently = false;\n        }, 100);\n        removeFocusVisibleClass(e.target);\n      }\n    }\n\n    /**\n     * If the user changes tabs, keep track of whether or not the previously\n     * focused element had .focus-visible.\n     * @param {Event} e\n     */\n    function onVisibilityChange(e) {\n      if (document.visibilityState === 'hidden') {\n        // If the tab becomes active again, the browser will handle calling focus\n        // on the element (Safari actually calls it twice).\n        // If this tab change caused a blur on an element with focus-visible,\n        // re-apply the class when the user switches back to the tab.\n        if (hadFocusVisibleRecently) {\n          hadKeyboardEvent = true;\n        }\n        addInitialPointerMoveListeners();\n      }\n    }\n\n    /**\n     * Add a group of listeners to detect usage of any pointing devices.\n     * These listeners will be added when the polyfill first loads, and anytime\n     * the window is blurred, so that they are active when the window regains\n     * focus.\n     */\n    function addInitialPointerMoveListeners() {\n      document.addEventListener('mousemove', onInitialPointerMove);\n      document.addEventListener('mousedown', onInitialPointerMove);\n      document.addEventListener('mouseup', onInitialPointerMove);\n      document.addEventListener('pointermove', onInitialPointerMove);\n      document.addEventListener('pointerdown', onInitialPointerMove);\n      document.addEventListener('pointerup', onInitialPointerMove);\n      document.addEventListener('touchmove', onInitialPointerMove);\n      document.addEventListener('touchstart', onInitialPointerMove);\n      document.addEventListener('touchend', onInitialPointerMove);\n    }\n\n    function removeInitialPointerMoveListeners() {\n      document.removeEventListener('mousemove', onInitialPointerMove);\n      document.removeEventListener('mousedown', onInitialPointerMove);\n      document.removeEventListener('mouseup', onInitialPointerMove);\n      document.removeEventListener('pointermove', onInitialPointerMove);\n      document.removeEventListener('pointerdown', onInitialPointerMove);\n      document.removeEventListener('pointerup', onInitialPointerMove);\n      document.removeEventListener('touchmove', onInitialPointerMove);\n      document.removeEventListener('touchstart', onInitialPointerMove);\n      document.removeEventListener('touchend', onInitialPointerMove);\n    }\n\n    /**\n     * When the polfyill first loads, assume the user is in keyboard modality.\n     * If any event is received from a pointing device (e.g. mouse, pointer,\n     * touch), turn off keyboard modality.\n     * This accounts for situations where focus enters the page from the URL bar.\n     * @param {Event} e\n     */\n    function onInitialPointerMove(e) {\n      // Work around a Safari quirk that fires a mousemove on <html> whenever the\n      // window blurs, even if you're tabbing out of the page. ¯\\_(ツ)_/¯\n      if (e.target.nodeName && e.target.nodeName.toLowerCase() === 'html') {\n        return;\n      }\n\n      hadKeyboardEvent = false;\n      removeInitialPointerMoveListeners();\n    }\n\n    // For some kinds of state, we are interested in changes at the global scope\n    // only. For example, global pointer input, global key presses and global\n    // visibility change should affect the state at every scope:\n    document.addEventListener('keydown', onKeyDown, true);\n    document.addEventListener('mousedown', onPointerDown, true);\n    document.addEventListener('pointerdown', onPointerDown, true);\n    document.addEventListener('touchstart', onPointerDown, true);\n    document.addEventListener('visibilitychange', onVisibilityChange, true);\n\n    addInitialPointerMoveListeners();\n\n    // For focus and blur, we specifically care about state changes in the local\n    // scope. This is because focus / blur events that originate from within a\n    // shadow root are not re-dispatched from the host element if it was already\n    // the active element in its own scope:\n    scope.addEventListener('focus', onFocus, true);\n    scope.addEventListener('blur', onBlur, true);\n\n    // We detect that a node is a ShadowRoot by ensuring that it is a\n    // DocumentFragment and also has a host property. This check covers native\n    // implementation and polyfill implementation transparently. If we only cared\n    // about the native implementation, we could just check if the scope was\n    // an instance of a ShadowRoot.\n    if (scope.nodeType === Node.DOCUMENT_FRAGMENT_NODE && scope.host) {\n      // Since a ShadowRoot is a special kind of DocumentFragment, it does not\n      // have a root element to add a class to. So, we add this attribute to the\n      // host element instead:\n      scope.host.setAttribute('data-js-focus-visible', '');\n    } else if (scope.nodeType === Node.DOCUMENT_NODE) {\n      document.documentElement.classList.add('js-focus-visible');\n      document.documentElement.setAttribute('data-js-focus-visible', '');\n    }\n  }\n\n  // It is important to wrap all references to global window and document in\n  // these checks to support server-side rendering use cases\n  // @see https://github.com/WICG/focus-visible/issues/199\n  if (typeof window !== 'undefined' && typeof document !== 'undefined') {\n    // Make the polyfill helper globally available. This can be used as a signal\n    // to interested libraries that wish to coordinate with the polyfill for e.g.,\n    // applying the polyfill to a shadow root:\n    window.applyFocusVisiblePolyfill = applyFocusVisiblePolyfill;\n\n    // Notify interested libraries of the polyfill's presence, in case the\n    // polyfill was loaded lazily:\n    var event;\n\n    try {\n      event = new CustomEvent('focus-visible-polyfill-ready');\n    } catch (error) {\n      // IE11 does not support using CustomEvent as a constructor directly:\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent('focus-visible-polyfill-ready', false, false, {});\n    }\n\n    window.dispatchEvent(event);\n  }\n\n  if (typeof document !== 'undefined') {\n    // Apply the polyfill to the global document, so that no JavaScript\n    // coordination is required to use the polyfill in the top-level document:\n    applyFocusVisiblePolyfill(document);\n  }\n\n})));\n","var n,l,u,t,i,r,o,e,f,c,s,a,h,p={},y=[],v=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(n,l){for(var u in l)n[u]=l[u];return n}function g(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function _(l,u,t){var i,r,o,e={};for(o in u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:e[o]=u[o];if(arguments.length>2&&(e.children=arguments.length>3?n.call(arguments,2):t),\"function\"==typeof l&&null!=l.defaultProps)for(o in l.defaultProps)null==e[o]&&(e[o]=l.defaultProps[o]);return m(l,e,i,r,null)}function m(n,t,i,r,o){var e={type:n,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==o?++u:o,__i:-1,__u:0};return null==o&&null!=l.vnode&&l.vnode(e),e}function b(){return{current:null}}function k(n){return n.children}function x(n,l){this.props=n,this.context=l}function S(n,l){if(null==l)return n.__?S(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?S(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var n,u,t,r,o,f,c,s=1;i.length;)i.length>s&&i.sort(e),n=i.shift(),s=i.length,n.__d&&(t=void 0,o=(r=(u=n).__v).__e,f=[],c=[],u.__P&&((t=d({},r)).__v=r.__v+1,l.vnode&&l.vnode(t),O(u.__P,t,r,u.__n,u.__P.namespaceURI,32&r.__u?[o]:null,f,null==o?S(r):o,!!(32&r.__u),c),t.__v=r.__v,t.__.__k[t.__i]=t,z(f,t,c),t.__e!=o&&C(t)));$.__r=0}function I(n,l,u,t,i,r,o,e,f,c,s){var a,h,v,w,d,g,_=t&&t.__k||y,m=l.length;for(f=P(u,l,_,f,m),a=0;a<m;a++)null!=(v=u.__k[a])&&(h=-1==v.__i?p:_[v.__i]||p,v.__i=a,g=O(n,v,h,i,r,o,e,f,c,s),w=v.__e,v.ref&&h.ref!=v.ref&&(h.ref&&q(h.ref,null,v),s.push(v.ref,v.__c||w,v)),null==d&&null!=w&&(d=w),4&v.__u||h.__k===v.__k?f=A(v,f,n):\"function\"==typeof v.type&&void 0!==g?f=g:w&&(f=w.nextSibling),v.__u&=-7);return u.__e=d,f}function P(n,l,u,t,i){var r,o,e,f,c,s=u.length,a=s,h=0;for(n.__k=new Array(i),r=0;r<i;r++)null!=(o=l[r])&&\"boolean\"!=typeof o&&\"function\"!=typeof o?(f=r+h,(o=n.__k[r]=\"string\"==typeof o||\"number\"==typeof o||\"bigint\"==typeof o||o.constructor==String?m(null,o,null,null,null):w(o)?m(k,{children:o},null,null,null):null==o.constructor&&o.__b>0?m(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,e=null,-1!=(c=o.__i=L(o,u,f,a))&&(a--,(e=u[c])&&(e.__u|=2)),null==e||null==e.__v?(-1==c&&(i>s?h--:i<s&&h++),\"function\"!=typeof o.type&&(o.__u|=4)):c!=f&&(c==f-1?h--:c==f+1?h++:(c>f?h--:h++,o.__u|=4))):n.__k[r]=null;if(a)for(r=0;r<s;r++)null!=(e=u[r])&&0==(2&e.__u)&&(e.__e==t&&(t=S(e)),B(e,e));return t}function A(n,l,u){var t,i;if(\"function\"==typeof n.type){for(t=n.__k,i=0;t&&i<t.length;i++)t[i]&&(t[i].__=n,l=A(t[i],l,u));return l}n.__e!=l&&(l&&n.type&&!u.contains(l)&&(l=S(n)),u.insertBefore(n.__e,l||null),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8==l.nodeType);return l}function H(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(w(n)?n.some(function(n){H(n,l)}):l.push(n)),l}function L(n,l,u,t){var i,r,o=n.key,e=n.type,f=l[u];if(null===f&&null==n.key||f&&o==f.key&&e==f.type&&0==(2&f.__u))return u;if(t>(null!=f&&0==(2&f.__u)?1:0))for(i=u-1,r=u+1;i>=0||r<l.length;){if(i>=0){if((f=l[i])&&0==(2&f.__u)&&o==f.key&&e==f.type)return i;i--}if(r<l.length){if((f=l[r])&&0==(2&f.__u)&&o==f.key&&e==f.type)return r;r++}}return-1}function T(n,l,u){\"-\"==l[0]?n.setProperty(l,null==u?\"\":u):n[l]=null==u?\"\":\"number\"!=typeof u||v.test(l)?u:u+\"px\"}function j(n,l,u,t,i){var r;n:if(\"style\"==l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof t&&(n.style.cssText=t=\"\"),t)for(l in t)u&&l in u||T(n.style,l,\"\");if(u)for(l in u)t&&u[l]==t[l]||T(n.style,l,u[l])}else if(\"o\"==l[0]&&\"n\"==l[1])r=l!=(l=l.replace(f,\"$1\")),l=l.toLowerCase()in n||\"onFocusOut\"==l||\"onFocusIn\"==l?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+r]=u,u?t?u.u=t.u:(u.u=c,n.addEventListener(l,r?a:s,r)):n.removeEventListener(l,r?a:s,r);else{if(\"http://www.w3.org/2000/svg\"==i)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"width\"!=l&&\"height\"!=l&&\"href\"!=l&&\"list\"!=l&&\"form\"!=l&&\"tabIndex\"!=l&&\"download\"!=l&&\"rowSpan\"!=l&&\"colSpan\"!=l&&\"role\"!=l&&\"popover\"!=l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null==u||!1===u&&\"-\"!=l[4]?n.removeAttribute(l):n.setAttribute(l,\"popover\"==l&&1==u?\"\":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=c++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,r,o,e,f,c,s){var a,h,p,y,v,_,m,b,S,C,M,$,P,A,H,L,T,j=u.type;if(null!=u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),o=[f=u.__e=t.__e]),(a=l.__b)&&a(u);n:if(\"function\"==typeof j)try{if(b=u.props,S=\"prototype\"in j&&j.prototype.render,C=(a=j.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?m=(h=u.__c=t.__c).__=h.__E:(S?u.__c=h=new j(b,M):(u.__c=h=new x(b,M),h.constructor=j,h.render=D),C&&C.sub(h),h.props=b,h.state||(h.state={}),h.context=M,h.__n=i,p=h.__d=!0,h.__h=[],h._sb=[]),S&&null==h.__s&&(h.__s=h.state),S&&null!=j.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,j.getDerivedStateFromProps(b,h.__s))),y=h.props,v=h.state,h.__v=u,p)S&&null==j.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),S&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(S&&null==j.getDerivedStateFromProps&&b!==y&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,M),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,M)||u.__v==t.__v){for(u.__v!=t.__v&&(h.props=b,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.some(function(n){n&&(n.__=u)}),$=0;$<h._sb.length;$++)h.__h.push(h._sb[$]);h._sb=[],h.__h.length&&e.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,M),S&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(y,v,_)})}if(h.context=M,h.props=b,h.__P=n,h.__e=!1,P=l.__r,A=0,S){for(h.state=h.__s,h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++A<25);h.state=h.__s,null!=h.getChildContext&&(i=d(d({},i),h.getChildContext())),S&&!p&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(y,v)),L=a,null!=a&&a.type===k&&null==a.key&&(L=N(a.props.children)),f=I(n,w(L)?L:[L],u,t,i,r,o,e,f,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&e.push(h),m&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=o)if(n.then){for(u.__u|=c?160:128;f&&8==f.nodeType&&f.nextSibling;)f=f.nextSibling;o[o.indexOf(f)]=null,u.__e=f}else for(T=o.length;T--;)g(o[T]);else u.__e=t.__e,u.__k=t.__k;l.__e(n,u,t)}else null==o&&u.__v==t.__v?(u.__k=t.__k,u.__e=t.__e):f=u.__e=V(t.__e,u,t,i,r,o,e,c,s);return(a=l.diffed)&&a(u),128&u.__u?void 0:f}function z(n,u,t){for(var i=0;i<t.length;i++)q(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function N(n){return\"object\"!=typeof n||null==n||n.__b&&n.__b>0?n:w(n)?n.map(N):d({},n)}function V(u,t,i,r,o,e,f,c,s){var a,h,y,v,d,_,m,b=i.props,k=t.props,x=t.type;if(\"svg\"==x?o=\"http://www.w3.org/2000/svg\":\"math\"==x?o=\"http://www.w3.org/1998/Math/MathML\":o||(o=\"http://www.w3.org/1999/xhtml\"),null!=e)for(a=0;a<e.length;a++)if((d=e[a])&&\"setAttribute\"in d==!!x&&(x?d.localName==x:3==d.nodeType)){u=d,e[a]=null;break}if(null==u){if(null==x)return document.createTextNode(k);u=document.createElementNS(o,x,k.is&&k),c&&(l.__m&&l.__m(t,e),c=!1),e=null}if(null==x)b===k||c&&u.data==k||(u.data=k);else{if(e=e&&n.call(u.childNodes),b=i.props||p,!c&&null!=e)for(b={},a=0;a<u.attributes.length;a++)b[(d=u.attributes[a]).name]=d.value;for(a in b)if(d=b[a],\"children\"==a);else if(\"dangerouslySetInnerHTML\"==a)y=d;else if(!(a in k)){if(\"value\"==a&&\"defaultValue\"in k||\"checked\"==a&&\"defaultChecked\"in k)continue;j(u,a,null,d,o)}for(a in k)d=k[a],\"children\"==a?v=d:\"dangerouslySetInnerHTML\"==a?h=d:\"value\"==a?_=d:\"checked\"==a?m=d:c&&\"function\"!=typeof d||b[a]===d||j(u,a,d,b[a],o);if(h)c||y&&(h.__html==y.__html||h.__html==u.innerHTML)||(u.innerHTML=h.__html),t.__k=[];else if(y&&(u.innerHTML=\"\"),I(\"template\"==t.type?u.content:u,w(v)?v:[v],t,i,r,\"foreignObject\"==x?\"http://www.w3.org/1999/xhtml\":o,e,f,e?e[0]:i.__k&&S(i,0),c,s),null!=e)for(a=e.length;a--;)g(e[a]);c||(a=\"value\",\"progress\"==x&&null==_?u.removeAttribute(\"value\"):null!=_&&(_!==u[a]||\"progress\"==x&&!_||\"option\"==x&&_!=b[a])&&j(u,a,_,b[a],o),a=\"checked\",null!=m&&m!=u[a]&&j(u,a,m,b[a],o))}return u}function q(n,u,t){try{if(\"function\"==typeof n){var i=\"function\"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function B(n,u,t){var i,r;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!=n.__e||q(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&B(i[r],u,t||\"function\"!=typeof n.type);t||g(n.__e),n.__c=n.__=n.__e=void 0}function D(n,l,u){return this.constructor(n,u)}function E(u,t,i){var r,o,e,f;t==document&&(t=document.documentElement),l.__&&l.__(u,t),o=(r=\"function\"==typeof i)?null:i&&i.__k||t.__k,e=[],f=[],O(t,u=(!r&&i||t).__k=_(k,null,[u]),o||p,p,t.namespaceURI,!r&&i?[i]:o?null:t.firstChild?n.call(t.childNodes):null,e,!r&&i?i:o?o.__e:t.firstChild,r,f),z(e,u,f)}function G(n,l){E(n,l,G)}function J(l,u,t){var i,r,o,e,f=d({},l.props);for(o in l.type&&l.type.defaultProps&&(e=l.type.defaultProps),u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:f[o]=null==u[o]&&null!=e?e[o]:u[o];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),m(l.type,f,i||l.key,r||l.ref,null)}function K(n){function l(n){var u,t;return this.getChildContext||(u=new Set,(t={})[l.__c]=this,this.getChildContext=function(){return t},this.componentWillUnmount=function(){u=null},this.shouldComponentUpdate=function(n){this.props.value!=n.value&&u.forEach(function(n){n.__e=!0,M(n)})},this.sub=function(n){u.add(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u&&u.delete(n),l&&l.call(n)}}),n.children}return l.__c=\"__cC\"+h++,l.__=n,l.Provider=l.__l=(l.Consumer=function(n,l){return n.children(l)}).contextType=l,l}n=y.slice,l={__e:function(n,l,u,t){for(var i,r,o;l=l.__;)if((i=l.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(n)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),o=i.__d),o)return i.__E=i}catch(l){n=l}throw n}},u=0,t=function(n){return null!=n&&null==n.constructor},x.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=d({},this.state),\"function\"==typeof n&&(n=n(d({},u),this.props)),n&&d(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},x.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},x.prototype.render=k,i=[],o=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(n,l){return n.__v.__b-l.__v.__b},$.__r=0,f=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0),h=0;export{x as Component,k as Fragment,J as cloneElement,K as createContext,_ as createElement,b as createRef,_ as h,G as hydrate,t as isValidElement,l as options,E as render,H as toChildArray};\n//# sourceMappingURL=preact.module.js.map\n","type ValueProvider = { value: unknown };\n\ntype Constructible = {\n  new (...args: any[]): unknown;\n};\n\ntype ClassProvider = { class: Constructible & { $inject?: string[] } };\n\ntype FactoryProvider = {\n  factory: ((...args: any[]) => unknown) & { $inject?: string[] };\n};\n\ntype Provider = ValueProvider | ClassProvider | FactoryProvider;\n\nfunction isValueProvider(provider: object): provider is ValueProvider {\n  return 'value' in provider;\n}\n\nfunction isClassProvider(provider: object): provider is ClassProvider {\n  return 'class' in provider && typeof provider.class === 'function';\n}\n\nfunction isFactoryProvider(provider: object): provider is FactoryProvider {\n  return 'factory' in provider && typeof provider.factory === 'function';\n}\n\nfunction isValidProvider(provider: unknown): provider is Provider {\n  if (typeof provider !== 'object' || provider === null) {\n    return false;\n  }\n\n  return (\n    isValueProvider(provider) ||\n    isClassProvider(provider) ||\n    isFactoryProvider(provider)\n  );\n}\n\n/**\n * `Injector` is a dependency injection container.\n *\n * It provides a convenient way to instantiate a set of named objects with\n * dependencies. Objects are constructed using a _provider_, which can be a\n * factory function, class constructor or value.\n *\n * If the provider is a factory function or constructor it may have dependencies\n * which are indicated by a `$inject` property on the function/class which\n * is a list of the names of the dependencies. The `$inject` property can be\n * added manually or by a compiler plugin (eg. `babel-plugin-inject-args`).\n *\n * To construct an object, call the `register` method with the name and provider\n * for the object and each of its dependencies, and then call\n * the `get` method to construct the object and its dependencies and return it.\n *\n * To run a function with arguments provided by the container, without registering\n * the function in the container for use by other factories or classes,\n * use the `run` method.\n */\nexport class Injector {\n  /** Map of name to object specifying how to create/provide that object. */\n  private _providers: Map<string, Provider>;\n  /** Map of name to existing instance. */\n  private _instances: Map<string, unknown>;\n  /** Set of instances already being constructed. Used to detect circular dependencies. */\n  private _constructing: Set<string>;\n\n  constructor() {\n    this._providers = new Map<string, Provider>();\n    this._instances = new Map<string, unknown>();\n    this._constructing = new Set<string>();\n  }\n\n  /**\n   * Construct or return the existing instance of an object with a given `name`\n   *\n   * @param name - Name of object to construct\n   * @return The constructed object\n   */\n  get(name: string): unknown {\n    if (this._instances.has(name)) {\n      return this._instances.get(name);\n    }\n\n    const provider = this._providers.get(name);\n\n    if (!provider) {\n      throw new Error(`\"${name}\" is not registered`);\n    }\n\n    if (isValueProvider(provider)) {\n      this._instances.set(name, provider.value);\n      return provider.value;\n    }\n\n    if (this._constructing.has(name)) {\n      throw new Error(\n        `Encountered a circular dependency when constructing \"${name}\"`,\n      );\n    }\n\n    this._constructing.add(name);\n    try {\n      const resolvedDependencies = [];\n      const dependencies =\n        (isClassProvider(provider) && provider.class.$inject) ||\n        (isFactoryProvider(provider) && provider.factory.$inject) ||\n        [];\n\n      for (const dependency of dependencies) {\n        try {\n          resolvedDependencies.push(this.get(dependency));\n        } catch (e) {\n          const resolveErr = new Error(\n            `Failed to construct dependency \"${dependency}\" of \"${name}\": ${e.message}`,\n          );\n          // @ts-ignore - `cause` is a custom property\n          resolveErr.cause = e;\n          throw resolveErr;\n        }\n      }\n\n      let instance;\n      if (isClassProvider(provider)) {\n        // eslint-disable-next-line new-cap\n        instance = new provider.class(...resolvedDependencies);\n      } else {\n        const factory = provider.factory;\n        instance = factory(...resolvedDependencies);\n      }\n      this._instances.set(name, instance);\n\n      return instance;\n    } finally {\n      this._constructing.delete(name);\n    }\n  }\n\n  /**\n   * Register a provider for an object in the container.\n   *\n   * If `provider` is a function, it is treated like a class. In other words\n   * `register(name, SomeClass)` is the same as `register(name, { class: SomeClass })`.\n   *\n   * @param name - Name of object\n   * @param provider - The class or other provider to use to create the object.\n   */\n  register(name: string, provider: Constructible | Provider): this {\n    if (typeof provider === 'function') {\n      provider = { class: provider };\n    } else if (!isValidProvider(provider)) {\n      throw new Error(`Invalid provider for \"${name}\"`);\n    }\n\n    this._providers.set(name, provider);\n    return this;\n  }\n\n  /**\n   * Run a function which uses one or more dependencies provided by the\n   * container.\n   *\n   * @param callback -\n   *   A callback to run, with dependencies annotated in the same way as\n   *   functions or classes passed to `register`.\n   * @return Returns the result of running the function.\n   */\n  run<T>(callback: (...args: any[]) => T): T {\n    const tempName = 'Injector.run';\n    this.register(tempName, { factory: callback });\n\n    try {\n      return this.get(tempName) as T;\n    } finally {\n      this._instances.delete(tempName);\n      this._providers.delete(tempName);\n    }\n  }\n}\n","import{options as n}from\"preact\";var t,r,u,i,o=0,f=[],c=n,e=c.__b,a=c.__r,v=c.diffed,l=c.__c,m=c.unmount,s=c.__;function p(n,t){c.__h&&c.__h(r,n,o||t),o=0;var u=r.__H||(r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({}),u.__[n]}function d(n){return o=1,h(D,n)}function h(n,u,i){var o=p(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.__f)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=o.__c.props!==n;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),c&&c.call(this,n,t,r)||i};r.__f=!0;var c=r.shouldComponentUpdate,e=r.componentWillUpdate;r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},r.shouldComponentUpdate=f}return o.__N||o.__}function y(n,u){var i=p(t++,3);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__H.__h.push(i))}function _(n,u){var i=p(t++,4);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__h.push(i))}function A(n){return o=5,T(function(){return{current:n}},[])}function F(n,t,r){o=6,_(function(){if(\"function\"==typeof n){var r=n(t());return function(){n(null),r&&\"function\"==typeof r&&r()}}if(n)return n.current=t(),function(){return n.current=null}},null==r?r:r.concat(n))}function T(n,r){var u=p(t++,7);return C(u.__H,r)&&(u.__=n(),u.__H=r,u.__h=n),u.__}function q(n,t){return o=8,T(function(){return n},t)}function x(n){var u=r.context[n.__c],i=p(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function P(n,t){c.useDebugValue&&c.useDebugValue(t?t(n):n)}function b(n){var u=p(t++,10),i=d();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function g(){var n=p(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__=\"P\"+i[0]+\"-\"+i[1]++}return n.__}function j(){for(var n;n=f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(z),n.__H.__h.forEach(B),n.__H.__h=[]}catch(t){n.__H.__h=[],c.__e(t,n.__v)}}c.__b=function(n){r=null,e&&e(n)},c.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),s&&s(n,t)},c.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(i.__h.forEach(z),i.__h.forEach(B),i.__h=[],t=0)),u=r},c.diffed=function(n){v&&v(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f.push(t)&&i===c.requestAnimationFrame||((i=c.requestAnimationFrame)||w)(j)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),u=r=null},c.__c=function(n,t){t.some(function(n){try{n.__h.forEach(z),n.__h=n.__h.filter(function(n){return!n.__||B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],c.__e(r,n.__v)}}),l&&l(n,t)},c.unmount=function(n){m&&m(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{z(n)}catch(n){t=n}}),r.__H=void 0,t&&c.__e(t,r.__v))};var k=\"function\"==typeof requestAnimationFrame;function w(n){var t,r=function(){clearTimeout(u),k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,100);k&&(t=requestAnimationFrame(r))}function z(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function B(n){var t=r;n.__c=n.__(),r=t}function C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function D(n,t){return\"function\"==typeof t?t(n):t}export{q as useCallback,x as useContext,P as useDebugValue,y as useEffect,b as useErrorBoundary,g as useId,F as useImperativeHandle,_ as useLayoutEffect,T as useMemo,h as useReducer,A as useRef,d as useState};\n//# sourceMappingURL=hooks.module.js.map\n","function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/**\n * Return the event type that a listener will receive.\n *\n * For example `EventType<HTMLElement, 'keydown'>` evaluates to `KeyboardEvent`.\n *\n * The event type is extracted from the target's `on${Type}` property (eg.\n * `HTMLElement.onkeydown` here) If there is no such property, the type defaults\n * to `Event`.\n */\n\n/**\n * Utility that provides a way to conveniently remove a set of DOM event\n * listeners when they are no longer needed.\n */\nexport class ListenerCollection {\n  constructor() {\n    _defineProperty(this, \"_listeners\", void 0);\n    this._listeners = new Map();\n  }\n\n  /**\n   * Add a listener and return an ID that can be used to remove it later\n   */\n  add(eventTarget, eventType, listener, options) {\n    eventTarget.addEventListener(eventType, listener, options);\n    const symbol = Symbol();\n    this._listeners.set(symbol, {\n      eventTarget,\n      eventType,\n      listener,\n      options\n    });\n    return symbol;\n  }\n\n  /**\n   * Remove a specific listener.\n   */\n  remove(listenerId) {\n    const event = this._listeners.get(listenerId);\n    if (event) {\n      const {\n        eventTarget,\n        eventType,\n        listener,\n        options\n      } = event;\n      eventTarget.removeEventListener(eventType, listener, options);\n      this._listeners.delete(listenerId);\n    }\n  }\n  removeAll() {\n    this._listeners.forEach(({\n      eventTarget,\n      eventType,\n      listener,\n      options\n    }) => {\n      eventTarget.removeEventListener(eventType, listener, options);\n    });\n    this._listeners.clear();\n  }\n}\n//# sourceMappingURL=listener-collection.js.map","import { useEffect, useRef } from 'preact/hooks';\nimport { ListenerCollection } from '../util/listener-collection';\nimport { useStableCallback } from './use-stable-callback';\nfunction isElementDisabled(element) {\n  return typeof element.disabled === 'boolean' && element.disabled;\n}\nfunction isElementVisible(element) {\n  return element.offsetParent !== null;\n}\nfunction defaultSetFocus(element) {\n  element.focus();\n}\n/**\n * Enable arrow key navigation between interactive descendants of a\n * container element.\n *\n * In addition to moving focus between elements when arrow keys are pressed,\n * this also implements the \"roving tabindex\" pattern [1] which sets the\n * `tabindex` attribute of elements to control which element gets focus when the\n * user tabs into the container.\n *\n * See [2] for a reference of how keyboard navigation should work in web\n * applications and how it applies to various common widgets.\n *\n * @example\n *   function MyToolbar() {\n *     const container = useRef();\n *\n *     // Enable arrow key navigation between interactive elements in the\n *     // toolbar container.\n *     useArrowKeyNavigation(container);\n *\n *     return (\n *       <div ref={container} role=\"toolbar\">\n *         <button>Bold</bold>\n *         <button>Italic</bold>\n *         <a href=\"https://example.com/help\">Help</a>\n *       </div>\n *     )\n *   }\n *\n * [1] https://www.w3.org/TR/wai-aria-practices/#kbd_roving_tabindex\n * [2] https://www.w3.org/TR/wai-aria-practices/#keyboard\n *\n */\nexport function useArrowKeyNavigation(containerRef, {\n  autofocus = false,\n  loop = true,\n  horizontal = true,\n  vertical = true,\n  selector = 'a,button',\n  containerVisible = true,\n  focusElement: focusElement_ = defaultSetFocus\n} = {}) {\n  // Keep track of the element that was last focused by this hook such that\n  // navigation can be restored if focus moves outside the container and then\n  // back to/into it.\n  const lastFocusedItem = useRef(null);\n  const focusElement = useStableCallback(focusElement_);\n  useEffect(() => {\n    if (!containerVisible) {\n      return () => {};\n    }\n    if (!containerRef.current) {\n      throw new Error('Container ref not set');\n    }\n    const container = containerRef.current;\n    const getNavigableElements = () => {\n      const elements = Array.from(container.querySelectorAll(selector));\n      const filtered = elements.filter(el => isElementVisible(el) && !isElementDisabled(el));\n      // Include the container itself in the set of navigable elements if it\n      // is currently focused. It will not be part of the tab sequence once it\n      // loses focus. This allows, e.g., a widget container to be focused when\n      // opened but not be part of the subsequent keyboard-navigation sequence.\n      if (document.activeElement === container) {\n        filtered.unshift(container);\n      }\n      return filtered;\n    };\n\n    /**\n     * Update the `tabindex` attribute of navigable elements.\n     *\n     * Exactly one element will have `tabindex=0` and all others will have\n     * `tabindex=1`.\n      * @param currentIndex - Index of element in `elements` to make current.\n     *   Defaults to the current element if there is one, or the first element\n     *   otherwise.\n     * @param setFocus - Whether to focus the current element\n     */\n    const updateTabIndexes = (elements = getNavigableElements(), currentIndex = -1, setFocus = false, keyEvent) => {\n      if (currentIndex < 0) {\n        currentIndex = elements.findIndex(el => el.tabIndex === 0);\n        if (currentIndex < 0) {\n          currentIndex = 0;\n        }\n      }\n      for (const [index, element] of elements.entries()) {\n        element.tabIndex = index === currentIndex ? 0 : -1;\n        if (index === currentIndex && setFocus) {\n          lastFocusedItem.current = element;\n          focusElement(element, keyEvent);\n        }\n      }\n    };\n    const onKeyDown = event => {\n      const elements = getNavigableElements();\n      let currentIndex = elements.findIndex(item => item.tabIndex === 0);\n      let handled = false;\n      if (horizontal && event.key === 'ArrowLeft' || vertical && event.key === 'ArrowUp') {\n        if (currentIndex === 0) {\n          currentIndex = loop ? elements.length - 1 : currentIndex;\n        } else {\n          --currentIndex;\n        }\n        handled = true;\n      } else if (horizontal && event.key === 'ArrowRight' || vertical && event.key === 'ArrowDown') {\n        if (currentIndex === elements.length - 1) {\n          currentIndex = loop ? 0 : currentIndex;\n        } else {\n          ++currentIndex;\n        }\n        handled = true;\n      } else if (event.key === 'Home') {\n        currentIndex = 0;\n        handled = true;\n      } else if (event.key === 'End') {\n        currentIndex = elements.length - 1;\n        handled = true;\n      }\n      if (!handled) {\n        return;\n      }\n      updateTabIndexes(elements, currentIndex, true /* setFocus */, event);\n      event.preventDefault();\n      event.stopPropagation();\n    };\n    const navigableElements = getNavigableElements();\n    // Start focus sequence with previously focused element, if any\n    const initialIndex = lastFocusedItem.current ? navigableElements.indexOf(lastFocusedItem.current) : 0;\n    updateTabIndexes(navigableElements, initialIndex, autofocus);\n    const listeners = new ListenerCollection();\n\n    // Set an element as current when it gains focus. In Safari this event\n    // may not be received if the element immediately loses focus after it\n    // is triggered.\n    listeners.add(container, 'focusin', event => {\n      if (event.target === container && lastFocusedItem.current) {\n        // Focus is moving back to the container after having left. Restore the\n        // last tabindex. This allows users to exit and re-enter the widget\n        // without resetting the navigation sequence.\n        focusElement(lastFocusedItem.current);\n        return;\n      }\n      const elements = getNavigableElements();\n      const targetIndex = elements.indexOf(event.target);\n      if (targetIndex >= 0) {\n        updateTabIndexes(elements, targetIndex, autofocus);\n      }\n    });\n    listeners.add(container, 'keydown', onKeyDown);\n\n    // Update the tab indexes of elements as they are added, removed, enabled\n    // or disabled.\n    const mo = new MutationObserver(() => {\n      updateTabIndexes();\n    });\n    mo.observe(container, {\n      subtree: true,\n      attributes: true,\n      attributeFilter: ['disabled'],\n      childList: true\n    });\n    return () => {\n      listeners.removeAll();\n      mo.disconnect();\n    };\n  }, [autofocus, containerRef, focusElement, horizontal, loop, selector, vertical, containerVisible]);\n}\n//# sourceMappingURL=use-arrow-key-navigation.js.map","import { useRef } from 'preact/hooks';\n\n/**\n * Return a function which wraps a callback to give it a stable value.\n *\n * The wrapper has a stable value across renders, but always forwards to the\n * callback from the most recent render. This is useful if you want to use a\n * callback inside a `useEffect` or `useMemo` hook without re-running the effect\n * or re-computing the memoed value when the callback changes.\n */\nexport function useStableCallback(callback) {\n  const wrapper = useRef({\n    callback,\n    call: (...args) => wrapper.current.callback(...args)\n  });\n\n  // On each render, save the last callback value.\n  wrapper.current.callback = callback;\n  return wrapper.current.call;\n}\n//# sourceMappingURL=use-stable-callback.js.map","import { useEffect } from 'preact/hooks';\nimport { ListenerCollection } from '../util/listener-collection';\n/**\n * Listen on document.body for click events. If a click event's target is\n * outside the `container` element, invoke the `callback`. Do not listen if\n * not `enabled`.\n */\nexport function useClickAway(container, callback, {\n  enabled = true\n} = {}) {\n  useEffect(() => {\n    if (!enabled) {\n      return () => {};\n    }\n    const target = document.body;\n    const listeners = new ListenerCollection();\n    const handleAwayClick = event => {\n      if (container.current &&\n      // We test the composed path here to handle the case where the clicked\n      // element was in fact in the container, but is removed from the DOM\n      // (eg. by a re-render in a child component) before this callback is run.\n      // The composed path reflects the DOM hierarchy at the time the event was\n      // dispatched.\n      !event.composedPath().includes(container.current)) {\n        callback(event);\n      }\n    };\n    listeners.add(target, 'mousedown', handleAwayClick);\n    listeners.add(target, 'click', handleAwayClick);\n    return () => {\n      listeners.removeAll();\n    };\n  }, [container, enabled, callback]);\n}\n//# sourceMappingURL=use-click-away.js.map","import { useEffect } from 'preact/hooks';\nimport { ListenerCollection } from '../util/listener-collection';\n/**\n * Listen on container for focusout events. If a focusout event's relatedTarget\n * is outside of the `container` element, invoke the `callback`.\n * Do not listen if not `enabled`.\n */\nexport function useFocusAway(container, callback, {\n  enabled = true\n} = {}) {\n  useEffect(() => {\n    if (!enabled || !container.current) {\n      return () => {};\n    }\n    const listeners = new ListenerCollection();\n    listeners.add(container.current, 'focusout', e => {\n      // Event type is not being properly inferred as FocusEvent\n      const event = e;\n      if (container.current && !container.current.contains(event.relatedTarget)) {\n        callback(event);\n      }\n    });\n    return () => {\n      listeners.removeAll();\n    };\n  }, [container, enabled, callback]);\n}\n//# sourceMappingURL=use-focus-away.js.map","import { useEffect } from 'preact/hooks';\nimport { ListenerCollection } from '../util/listener-collection';\n/**\n * Listen on HTMLElement `target` for key press events for the designated `keys`\n * and invoke a callback. Do not listen if not `enabled`.\n *\n * @param keys - Array of keys (e.g. 'Escape', 'd') to listen for\n */\nexport function useKeyPress(keys, callback, {\n  enabled = true\n} = {}) {\n  useEffect(() => {\n    if (!enabled) {\n      return () => {};\n    }\n    const target = document.body;\n    const listeners = new ListenerCollection();\n    listeners.add(target, 'keydown', event => {\n      if (keys.includes(event.key)) {\n        callback(event);\n      }\n    });\n    return () => {\n      listeners.removeAll();\n    };\n  }, [enabled, callback, keys]);\n}\n//# sourceMappingURL=use-key-press.js.map","import { useClickAway } from './use-click-away';\nimport { useFocusAway } from './use-focus-away';\nimport { useKeyPress } from './use-key-press';\n/**\n * This hook is a convenient way to close or hide a popover-like element when a\n * user interacts with elements outside of it or presses the Esc key.\n *\n * This hook is effectively a combination of {@link useClickAway},\n * {@link useFocusAway} and {@link useKeyPress} handling `Escape` key.\n *\n * @param popoverEl - Outer DOM element for the popover\n * @param handleClose - Callback invoked to close the popover\n * @param options\n */\nexport function usePopoverShouldClose(popoverEl, handleClose, options = {}) {\n  useClickAway(popoverEl, handleClose, options);\n  useFocusAway(popoverEl, handleClose, options);\n  useKeyPress(['Escape'], handleClose, options);\n}\n//# sourceMappingURL=use-popover-should-close.js.map","function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { useRef } from 'preact/hooks';\n\n/**\n * Object ref which synchronizes its value to another ref.\n */\nclass SyncedRef {\n  /**\n   * @param [target] - Initial target for this ref to synchronize to.\n   *   This is not called/set until the {@link current} property of the\n   *   SyncedRef is set. This makes the target behave close to how it would\n   *   if used in place of the SyncedRef.\n   */\n  constructor(target) {\n    _defineProperty(this, \"_target\", void 0);\n    _defineProperty(this, \"_value\", void 0);\n    this._target = target;\n    this._value = null;\n  }\n  get current() {\n    return this._value;\n  }\n  set current(value) {\n    this._value = value;\n    this._updateTarget();\n  }\n  get target() {\n    return this._target;\n  }\n  set target(target) {\n    if (target === this._target) {\n      return;\n    }\n    this._target = target;\n\n    // If the target changes after the initial render, we currently synchronize\n    // the value immediately. This is different than what happens if the target\n    // were passed to an element directly, as it would be updated only after the\n    // render.\n    this._updateTarget();\n  }\n  _updateTarget() {\n    const value = this._value;\n    if (typeof this._target === 'function') {\n      this._target(value);\n    } else if (this._target) {\n      this._target.current = value;\n    }\n  }\n}\n\n/**\n * Return an object ref which synchronizes its value to another \"target\" ref.\n *\n * This is useful when a component needs an object ref for an element for\n * internal use, but also wants to allow the caller to get a ref for the same\n * element.\n *\n * The target ref can be either a callback or an object.\n *\n * @example\n *   function Widget({ elementRef }) {\n *     const ref = useSyncedRef(elementRef);\n *\n *     useEffect(() => {\n *       ref.current.focus();\n *     }, []);\n *\n *     return <input ref={ref}>...</input>;\n *   }\n */\nexport function useSyncedRef(targetRef) {\n  const container = useRef(new SyncedRef(targetRef));\n  container.current.target = targetRef;\n  return container.current;\n}\n//# sourceMappingURL=use-synced-ref.js.map","const SECOND = 1000;\nconst MINUTE = 60 * SECOND;\nconst HOUR = 60 * MINUTE;\n\n/**\n * Map of stringified `DateTimeFormatOptions` to cached `DateTimeFormat` instances.\n */\nlet formatters = new Map();\n\n/**\n * Clears the cache of formatters.\n */\nexport function clearFormatters() {\n  formatters = new Map();\n}\n/**\n * Calculate time delta in milliseconds between two `Date` objects\n */\nfunction delta(date, now) {\n  // @ts-ignore\n  return now - date;\n}\n\n/**\n * Return date string formatted with `options`.\n *\n * This is a caching wrapper for `Intl.DateTimeFormat.format`, useful because\n * constructing a `DateTimeFormat` is expensive.\n *\n * @param Intl - Test seam. JS `Intl` API implementation.\n */\nfunction format(date, options, /* istanbul ignore next */\nIntl = window.Intl) {\n  const key = JSON.stringify(options);\n  let formatter = formatters.get(key);\n  if (!formatter) {\n    formatter = new Intl.DateTimeFormat(undefined, options);\n    formatters.set(key, formatter);\n  }\n  return formatter.format(date);\n}\n\n/**\n * @return formatted date\n */\n\nconst nSec = (date, now) => {\n  const n = Math.floor(delta(date, now) / SECOND);\n  return `${n} secs ago`;\n};\nconst nMin = (date, now) => {\n  const n = Math.floor(delta(date, now) / MINUTE);\n  const plural = n > 1 ? 's' : '';\n  return `${n} min${plural} ago`;\n};\nconst nHr = (date, now) => {\n  const n = Math.floor(delta(date, now) / HOUR);\n  const plural = n > 1 ? 's' : '';\n  return `${n} hr${plural} ago`;\n};\nconst dayAndMonth = (date, now, Intl) => {\n  return format(date, {\n    month: 'short',\n    day: 'numeric'\n  }, Intl);\n};\nconst dayAndMonthAndYear = (date, now, Intl) => {\n  return format(date, {\n    day: 'numeric',\n    month: 'short',\n    year: 'numeric'\n  }, Intl);\n};\nconst BREAKPOINTS = [{\n  // Less than 30 seconds\n  test: (date, now) => delta(date, now) < 30 * SECOND,\n  formatter: () => 'Just now',\n  nextUpdate: 1 * SECOND\n}, {\n  // Less than 1 minute\n  test: (date, now) => delta(date, now) < 1 * MINUTE,\n  formatter: nSec,\n  nextUpdate: 1 * SECOND\n}, {\n  // Less than one hour\n  test: (date, now) => delta(date, now) < 1 * HOUR,\n  formatter: nMin,\n  nextUpdate: 1 * MINUTE\n}, {\n  // Less than one day\n  test: (date, now) => delta(date, now) < 24 * HOUR,\n  formatter: nHr,\n  nextUpdate: 1 * HOUR\n}, {\n  // This year\n  test: (date, now) => date.getFullYear() === now.getFullYear(),\n  formatter: dayAndMonth,\n  nextUpdate: null\n}];\nconst DEFAULT_BREAKPOINT = {\n  test: /* istanbul ignore next */() => true,\n  formatter: dayAndMonthAndYear,\n  nextUpdate: null\n};\n\n/**\n * Returns a dict that describes how to format the date based on the delta\n * between date and now.\n *\n * @param date - The date to consider as the timestamp to format.\n * @param now - The date to consider as the current time.\n * @return An object that describes how to format the date.\n */\nfunction getBreakpoint(date, now) {\n  for (const breakpoint of BREAKPOINTS) {\n    if (breakpoint.test(date, now)) {\n      return breakpoint;\n    }\n  }\n  return DEFAULT_BREAKPOINT;\n}\n\n/**\n * Determines if provided date represents a specific instant of time.\n * See https://262.ecma-international.org/6.0/#sec-time-values-and-time-range\n */\nfunction isDateValid(date) {\n  return !isNaN(date.valueOf());\n}\n\n/**\n * Return the number of milliseconds until the next update for a given date\n * should be handled, based on the delta between `date` and `now`.\n *\n * @return ms until next update or `null` if no update should occur\n */\nexport function nextFuzzyUpdate(date, now) {\n  if (!date || !isDateValid(date) || !isDateValid(now)) {\n    return null;\n  }\n  let nextUpdate = getBreakpoint(date, now).nextUpdate;\n  if (nextUpdate === null) {\n    return null;\n  }\n\n  // We don't want to refresh anything more often than 5 seconds\n  nextUpdate = Math.max(nextUpdate, 5 * SECOND);\n\n  // setTimeout limit is MAX_INT32=(2^31-1) (in ms),\n  // which is about 24.8 days. So we don't set up any timeouts\n  // longer than 24 days, that is, 2073600 seconds.\n  nextUpdate = Math.min(nextUpdate, 2073600 * SECOND);\n  return nextUpdate;\n}\n\n/**\n * Start an interval whose frequency depends on the age of a timestamp.\n *\n * This is useful for refreshing UI components displaying timestamps generated\n * by `formatRelativeDate`, since the output changes less often for older timestamps.\n *\n * @param date - Date string to use to determine the interval frequency\n * @param callback - Interval callback\n * @return A function that cancels the interval\n */\nexport function decayingInterval(date, callback) {\n  let timer;\n  const timestamp = new Date(date);\n  const update = () => {\n    const fuzzyUpdate = nextFuzzyUpdate(timestamp, new Date());\n    if (fuzzyUpdate === null) {\n      return;\n    }\n    const nextUpdate = fuzzyUpdate + 500;\n    timer = setTimeout(() => {\n      callback();\n      update();\n    }, nextUpdate);\n  };\n  update();\n  return () => clearTimeout(timer);\n}\n\n/**\n * Formats a date as a short approximate string relative to the current date.\n *\n * The level of precision is proportional to how recent the date is.\n *\n * For example:\n *\n *  - \"Just now\"\n *  - \"5 minutes ago\"\n *  - \"25 Oct 2018\"\n *\n * @param date - The date to consider as the timestamp to format.\n * @param now - The date to consider as the current time.\n * @param Intl - Test seam. JS `Intl` API implementation.\n * @return A 'fuzzy' string describing the relative age of the date.\n */\nexport function formatRelativeDate(date, now, Intl) {\n  if (!date) {\n    return '';\n  }\n  return getBreakpoint(date, now).formatter(date, now, Intl);\n}\n/**\n * Formats a date as an absolute string in a human-readable format.\n *\n * The exact format will vary depending on the locale, but the verbosity will\n * be consistent across locales. In en-US for example this will look like:\n *\n *  \"Dec 17, 2017, 10:00 AM\"\n */\nexport function formatDateTime(date, {\n  includeWeekday = false,\n  includeTime = true\n} = {}, /* istanbul ignore next - Test seam. JS `Intl` API implementation. */\nIntl) {\n  return format(typeof date === 'string' ? new Date(date) : date, {\n    year: 'numeric',\n    month: 'short',\n    day: '2-digit',\n    weekday: includeWeekday ? 'long' : undefined,\n    hour: includeTime ? '2-digit' : undefined,\n    minute: includeTime ? '2-digit' : undefined\n  }, Intl);\n}\n//# sourceMappingURL=date-and-time.js.map","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = '';\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (arg) {\n\t\t\t\tclasses = appendClass(classes, parseValue(arg));\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction parseValue (arg) {\n\t\tif (typeof arg === 'string' || typeof arg === 'number') {\n\t\t\treturn arg;\n\t\t}\n\n\t\tif (typeof arg !== 'object') {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (Array.isArray(arg)) {\n\t\t\treturn classNames.apply(null, arg);\n\t\t}\n\n\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\treturn arg.toString();\n\t\t}\n\n\t\tvar classes = '';\n\n\t\tfor (var key in arg) {\n\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\tclasses = appendClass(classes, key);\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction appendClass (value, newClass) {\n\t\tif (!newClass) {\n\t\t\treturn value;\n\t\t}\n\t\n\t\tif (value) {\n\t\t\treturn value + ' ' + newClass;\n\t\t}\n\t\n\t\treturn value + newClass;\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","import { useEffect, useRef } from 'preact/hooks';\nimport { ListenerCollection } from '../util/listener-collection';\nfunction isElementDisabled(element) {\n  return typeof element.disabled === 'boolean' && element.disabled;\n}\nfunction isElementVisible(element) {\n  return element.offsetParent !== null;\n}\n/**\n * Trap focus within a modal dialog and support roving tabindex with 'Tab' and\n * 'Shift-Tab' keys to navigate through interactive descendants. See [1] for\n * reference for how keyboard navigation should work within modal dialogs.\n *\n * Note that this hook does not set initial focus: routing initial focus\n * appropriately is the responsibility of the consuming component.\n *\n * NB: This hook should be removed/disused once we migrate to using native\n * <dialog> elements. The hook duplicates some logic in `useArrowKeyNavigation`.\n *\n * @example\n *   function MyModalDialog() {\n *     const container = useRef();\n *\n *     // Enable tab key navigation between interactive elements in the\n *     // modal-dialog container.\n *     useTabKeyNavigation(container);\n *\n *     return (\n *       <div ref={container} role=\"dialog\" aria-modal>\n *         <button>Bold</bold>\n *         <button>Italic</bold>\n *         <a href=\"https://example.com/help\">Help</a>\n *       </div>\n *     )\n *   }\n *\n * [1] https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/#keyboardinteraction\n *\n */\n\n// By default, include standard browser focus-able, tab-sequence elements (links, buttons,\n// inputs). Also include the containers for ARIA interactive widgets `grid` and\n// `tablist`. Internal keyboard navigation for those widgets should be handled\n// separately: exclude `tab`-role buttons from this hook's navigation sequence.\nconst defaultSelector = 'a,button:not([role=\"tab\"]),input,select,textarea,[role=\"grid\"],[role=\"tablist\"]';\nexport function useTabKeyNavigation(containerRef, {\n  enabled = true,\n  selector = defaultSelector\n} = {}) {\n  const lastFocusedItem = useRef(null);\n  useEffect(() => {\n    if (!enabled) {\n      return () => {};\n    }\n    if (!containerRef.current) {\n      throw new Error('Container ref not set');\n    }\n    const container = containerRef.current;\n    const getNavigableElements = () => {\n      const elements = Array.from(container.querySelectorAll(selector));\n      const filtered = elements.filter(el => isElementVisible(el) && !isElementDisabled(el));\n      // Include the container itself in the set of navigable elements if it\n      // is currently focused. It will not be part of the tab sequence once it\n      // loses focus. This allows, e.g., a modal container to be focused when\n      // opened but not be part of the subsequent trapped tab sequence.\n      if (document.activeElement === container) {\n        filtered.unshift(container);\n      }\n      return filtered;\n    };\n\n    /**\n     * Update the `tabindex` attribute of navigable elements.\n     *\n     * Exactly one element will have `tabindex=0` and all others will have\n     * `tabindex=1`.\n      * @param currentIndex - Index of element in `elements` to make current.\n     *   Defaults to the current element if there is one, or the first element\n     *   otherwise.\n     * @param setFocus - Whether to focus the current element\n     */\n    const updateTabIndexes = (elements = getNavigableElements(), currentIndex = -1, setFocus = false) => {\n      if (currentIndex < 0) {\n        currentIndex = elements.findIndex(el => el.tabIndex === 0);\n        if (currentIndex < 0) {\n          currentIndex = 0;\n        }\n      }\n      for (const [index, element] of elements.entries()) {\n        element.tabIndex = index === currentIndex ? 0 : -1;\n        if (index === currentIndex && setFocus) {\n          lastFocusedItem.current = element;\n          element.focus();\n        }\n      }\n    };\n    const onKeyDown = event => {\n      const elements = getNavigableElements();\n      let currentIndex = elements.findIndex(item => item.tabIndex === 0);\n      if ((currentIndex === -1 || elements[currentIndex] === container) && lastFocusedItem.current) {\n        // Focus is moving back to/into the container after having left (or\n        // active tabindex is a non-navigable element). Restore previous active\n        // tabindex. This allows the user to exit and re-enter the widget\n        // without losing tab-sequence position.\n        currentIndex = elements.indexOf(lastFocusedItem.current);\n      }\n      let handled = false;\n      if (event.key === 'Tab' && event.shiftKey) {\n        if (currentIndex === 0) {\n          currentIndex = elements.length - 1;\n        } else {\n          --currentIndex;\n        }\n        handled = true;\n      } else if (event.key === 'Tab') {\n        if (currentIndex === elements.length - 1) {\n          currentIndex = 0;\n        } else {\n          ++currentIndex;\n        }\n        handled = true;\n      }\n      if (!handled) {\n        return;\n      }\n      updateTabIndexes(elements, currentIndex, true);\n      event.preventDefault();\n      event.stopPropagation();\n    };\n    const elements = getNavigableElements();\n    // One of the navigable elements may already have focus\n    const focusedIndex = elements.indexOf(document.activeElement);\n    updateTabIndexes(elements, focusedIndex);\n    const listeners = new ListenerCollection();\n\n    // Set an element as current when it gains focus. In Safari this event\n    // may not be received if the element immediately loses focus after it\n    // is triggered.\n    listeners.add(container, 'focusin', event => {\n      const elements = getNavigableElements();\n      const targetIndex = elements.indexOf(event.target);\n      if (targetIndex >= 0) {\n        updateTabIndexes(elements, targetIndex);\n      }\n    });\n    listeners.add(container, 'keydown', onKeyDown);\n\n    // Update the tab indexes of elements as they are added, removed, enabled\n    // or disabled.\n    const mo = new MutationObserver(() => {\n      updateTabIndexes();\n    });\n    mo.observe(container, {\n      subtree: true,\n      attributes: true,\n      attributeFilter: ['disabled'],\n      childList: true\n    });\n    return () => {\n      listeners.removeAll();\n      mo.disconnect();\n    };\n  }, [containerRef, enabled, selector]);\n}\n//# sourceMappingURL=use-tab-key-navigation.js.map","import{options as r,Fragment as e}from\"preact\";export{Fragment}from\"preact\";var t=/[\"&<]/;function n(r){if(0===r.length||!1===t.test(r))return r;for(var e=0,n=0,o=\"\",f=\"\";n<r.length;n++){switch(r.charCodeAt(n)){case 34:f=\"&quot;\";break;case 38:f=\"&amp;\";break;case 60:f=\"&lt;\";break;default:continue}n!==e&&(o+=r.slice(e,n)),o+=f,e=n+1}return n!==e&&(o+=r.slice(e,n)),o}var o=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,f=0,i=Array.isArray;function u(e,t,n,o,i,u){t||(t={});var a,c,p=t;if(\"ref\"in p)for(c in p={},t)\"ref\"==c?a=t[c]:p[c]=t[c];var l={type:e,props:p,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:i,__self:u};if(\"function\"==typeof e&&(a=e.defaultProps))for(c in a)void 0===p[c]&&(p[c]=a[c]);return r.vnode&&r.vnode(l),l}function a(r){var t=u(e,{tpl:r,exprs:[].slice.call(arguments,1)});return t.key=t.__v,t}var c={},p=/[A-Z]/g;function l(e,t){if(r.attr){var f=r.attr(e,t);if(\"string\"==typeof f)return f}if(\"ref\"===e||\"key\"===e)return\"\";if(\"style\"===e&&\"object\"==typeof t){var i=\"\";for(var u in t){var a=t[u];if(null!=a&&\"\"!==a){var l=\"-\"==u[0]?u:c[u]||(c[u]=u.replace(p,\"-$&\").toLowerCase()),s=\";\";\"number\"!=typeof a||l.startsWith(\"--\")||o.test(l)||(s=\"px;\"),i=i+l+\":\"+a+s}}return e+'=\"'+i+'\"'}return null==t||!1===t||\"function\"==typeof t||\"object\"==typeof t?\"\":!0===t?e:e+'=\"'+n(t)+'\"'}function s(r){if(null==r||\"boolean\"==typeof r||\"function\"==typeof r)return null;if(\"object\"==typeof r){if(void 0===r.constructor)return r;if(i(r)){for(var e=0;e<r.length;e++)r[e]=s(r[e]);return r}}return n(\"\"+r)}export{u as jsx,l as jsxAttr,u as jsxDEV,s as jsxEscape,a as jsxTemplate,u as jsxs};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/Overlay.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * A full-screen fixed backdrop overlay\n */\nexport default function Overlay({\n  children,\n  classes,\n  elementRef,\n  open = true,\n  variant = 'dark',\n  ...htmlAttributes\n}) {\n  if (!open) {\n    return null;\n  }\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"Overlay\",\n    ...htmlAttributes,\n    ref: downcastRef(elementRef),\n    className: classnames('fixed top-0 left-0 w-full h-full z-10 flex items-center justify-center', {\n      'bg-black/50': variant === 'dark',\n      // default\n      'bg-white/50': variant === 'light'\n    }, classes),\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Overlay.js.map","import { createContext } from 'preact';\nconst CloseableContext = createContext({});\nexport default CloseableContext;\n//# sourceMappingURL=CloseableContext.js.map","import { createContext } from 'preact';\nconst ScrollContext = createContext({});\nexport default ScrollContext;\n//# sourceMappingURL=ScrollContext.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/data/Scroll.tsx\";\nimport classnames from 'classnames';\nimport { useMemo } from 'preact/hooks';\nimport { useSyncedRef } from '../../hooks/use-synced-ref';\nimport { downcastRef } from '../../util/typing';\nimport ScrollContext from './ScrollContext';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a fluid container that scrolls on overflow.\n */\nexport default function Scroll({\n  children,\n  classes,\n  elementRef,\n  variant = 'raised',\n  ...htmlAttributes\n}) {\n  const ref = useSyncedRef(elementRef);\n  const scrollContext = useMemo(() => ({\n    scrollRef: ref\n  }), [ref]);\n  return _jsxDEV(ScrollContext.Provider, {\n    value: scrollContext,\n    children: _jsxDEV(\"div\", {\n      \"data-component\": \"Scroll\",\n      ...htmlAttributes,\n      ref: downcastRef(ref),\n      className: classnames(\n      // Prevent overflow by overriding `min-height: auto`.\n      // See https://stackoverflow.com/a/66689926/434243.\n      'min-h-0', 'h-full w-full overflow-auto', {\n        'scroll-shadows': variant === 'raised'\n      }, classes),\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Scroll.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/Card.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render content in a card-like frame\n */\nexport default function Card({\n  children,\n  classes,\n  elementRef,\n  active = false,\n  variant = 'raised',\n  width = 'full',\n  ...htmlAttributes\n}) {\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"Card\",\n    ...htmlAttributes,\n    ref: downcastRef(elementRef),\n    className: classnames('rounded-lg border bg-white', {\n      'shadow hover:shadow-md': variant === 'raised',\n      // default\n      'shadow-md': active && variant === 'raised'\n    }, {\n      'w-full': width === 'full',\n      // default\n      'w-auto': width === 'auto'\n      // No width is set if `width === 'custom'`\n    }, classes),\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Card.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/CardActions.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a group of buttons or interactive elements inside a Card\n */\nexport default function CardActions({\n  children,\n  classes,\n  elementRef,\n  ...htmlAttributes\n}) {\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"CardActions\",\n    ...htmlAttributes,\n    className: classnames('flex items-center justify-end space-x-3', classes),\n    ref: downcastRef(elementRef),\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 21,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CardActions.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/CardContent.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Apply consistent spacing and padding for actions content inside a Card\n */\nexport default function CardContent({\n  children,\n  classes,\n  elementRef,\n  size = 'md',\n  ...htmlAttributes\n}) {\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"CardContent\",\n    ...htmlAttributes,\n    ref: downcastRef(elementRef),\n    className: classnames({\n      'p-3 space-y-4': size === 'md',\n      // Default\n      'p-2 space-y-3': size === 'sm',\n      'p-4 space-y-6': size === 'lg'\n    }, classes),\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CardContent.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Annotate.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from annotate.svg\n */\nexport default function AnnotateIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"AnnotateIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M14 0a2 2 0 0 1 2 2v13a1 1 0 0 1-1.555.832l-4.262-1.757A1 1 0 0 0 9.802 14H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm-2.109 3.5h-.484l-.14.006-.122.018a.7.7 0 0 0-.2.071l-.076.054-.108.1-.097.1-1.632 1.999-.091.12-.084.129a2.6 2.6 0 0 0-.291.722l-.03.142-.027.218-.009.223v2.646l.01.086.027.08a.54.54 0 0 0 .236.236l.067.028.07.017.074.005h2.907l.074-.005.094-.025a.5.5 0 0 0 .169-.108.5.5 0 0 0 .082-.096l.029-.051.027-.081.01-.086V7.336l-.006-.073-.018-.068a.44.44 0 0 0-.124-.178.6.6 0 0 0-.103-.074l-.055-.026-.087-.024-.092-.009h-.579l-.057-.006-.054-.017a.3.3 0 0 1-.096-.07.2.2 0 0 1-.045-.078l-.004-.04.01-.043.022-.043 1.311-2.227.047-.09.037-.106a.5.5 0 0 0-.06-.394.53.53 0 0 0-.255-.22l-.084-.028-.092-.016zm-5.924 0h-.424l-.121.006-.108.018a.6.6 0 0 0-.174.071l-.067.054-.095.1-.084.1-1.429 1.999-.08.12-.096.174a2.8 2.8 0 0 0-.232.677l-.025.142-.024.218L3 7.402v2.646l.008.086.024.08a.5.5 0 0 0 .097.148q.052.055.11.088l.058.028.062.017.065.005h2.543l.065-.005.082-.025a.515.515 0 0 0 .22-.204l.025-.051.024-.081.008-.086V7.336l-.005-.073-.023-.09a.487.487 0 0 0-.191-.23l-.048-.026-.076-.024-.08-.009H5.46l-.05-.006-.047-.017a.3.3 0 0 1-.084-.07.2.2 0 0 1-.04-.078l-.003-.04.008-.043.02-.043L6.411 4.36l.04-.09.033-.106a.55.55 0 0 0-.053-.394.5.5 0 0 0-.222-.22l-.074-.028-.08-.016z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Annotate.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/ArrowLeft.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from arrow-left.svg\n */\nexport default function ArrowLeftIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ArrowLeftIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M7.707 3.293a1 1 0 0 1 .083 1.32l-.083.094L5.415 7H13a1 1 0 0 1 .117 1.993L13 9H5.415l2.292 2.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083-4-4a1 1 0 0 1-.083-1.32l.083-.094 4-4a1 1 0 0 1 1.414 0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=ArrowLeft.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/ArrowRight.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from arrow-right.svg\n */\nexport default function ArrowRightIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ArrowRightIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"m9.613 3.21.094.083 4 4a1 1 0 0 1 .083 1.32l-.083.094-4 4a1 1 0 0 1-1.497-1.32l.083-.094L10.585 9H3a1 1 0 0 1-.117-1.993L3 7h7.585L8.293 4.707a1 1 0 0 1-.083-1.32l.083-.094a1 1 0 0 1 1.32-.083\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=ArrowRight.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Cancel.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from cancel.svg\n */\nexport default function CancelIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CancelIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"m12.322 5.085-.08.087-2.828 2.827 2.829 2.83a1 1 0 0 1-1.32 1.497l-.095-.083L8 9.414l-2.828 2.829c-.915.914-2.272-.388-1.494-1.328l.08-.087L6.584 8 3.757 5.172a1 1 0 0 1 1.32-1.498l.095.083L8 6.585l2.828-2.828c.886-.885 2.188.309 1.56 1.239z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Cancel.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/CaretRight.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from caret-right.svg\n */\nexport default function CaretRightIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CaretRightIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M5.293 3.293a1 1 0 0 1 1.32-.083l.094.083 4 4a1 1 0 0 1 .083 1.32l-.083.094-4 4a1 1 0 0 1-1.497-1.32l.083-.094L8.585 8 5.293 4.707a1 1 0 0 1-.083-1.32z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CaretRight.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Caution.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from caution.svg\n */\nexport default function CautionIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CautionIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8 0c.767 0 1.432.455 1.794 1.148l5.917 11.326c.386.738.36 1.573.071 2.23-.286.651-.926 1.296-1.864 1.296H2.082c-.938 0-1.578-.645-1.864-1.295a2.6 2.6 0 0 1 .07-2.23L6.207 1.147C6.568.455 7.233 0 8 0m0 2.038-.021.036L2.06 13.4a.6.6 0 0 0-.012.5.3.3 0 0 0 .062.1H13.89a.3.3 0 0 0 .061-.1.6.6 0 0 0-.012-.5L8.02 2.074zm5.874 11.972q0 0 .01-.006-.01.007-.01.006m-11.748 0q0 .002-.01-.006z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8 5a1 1 0 0 1 1 1v3a1 1 0 0 1-2 0V6a1 1 0 0 1 1-1M9 12a1 1 0 1 1-2 0 1 1 0 0 1 2 0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Caution.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/CcStd.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from cc-std.svg\n */\nexport default function CcStdIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CcStdIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M13.7 2.343Q11.342 0 7.985 0 4.657 0 2.371 2.329A8 8 0 0 0 .607 4.95 7.9 7.9 0 0 0 0 8a7.85 7.85 0 0 0 2.35 5.636 8.05 8.05 0 0 0 2.6 1.757A7.8 7.8 0 0 0 7.986 16a8 8 0 0 0 3.071-.614q1.486-.615 2.657-1.772a7.35 7.35 0 0 0 1.707-2.536A8.2 8.2 0 0 0 16 8a8.15 8.15 0 0 0-.586-3.078A7.7 7.7 0 0 0 13.7 2.343M3.4 3.357q1.872-1.914 4.614-1.914 2.714 0 4.644 1.929a6.4 6.4 0 0 1 1.413 2.114q.486 1.185.486 2.515 0 2.757-1.871 4.586a6.9 6.9 0 0 1-2.178 1.443q-1.209.5-2.494.5a6.4 6.4 0 0 1-2.485-.493 6.6 6.6 0 0 1-2.13-1.43 6.6 6.6 0 0 1-1.45-2.128A6.3 6.3 0 0 1 1.444 8q0-1.299.507-2.493a6.9 6.9 0 0 1 1.45-2.15m4.514 3.315-1.072.557q-.171-.357-.42-.5a.95.95 0 0 0-.465-.143q-1.072 0-1.072 1.415 0 .642.271 1.028.272.386.8.386.7 0 .987-.686l.985.5a2.35 2.35 0 0 1-2.1 1.257q-1.07 0-1.729-.657-.657-.657-.657-1.828 0-1.143.665-1.814.664-.672 1.678-.672 1.486 0 2.13 1.157m3.557.557 1.057-.557q-.628-1.157-2.114-1.157-1.015 0-1.678.672Q8.07 6.857 8.07 8q0 1.17.65 1.828t1.736.657q.657 0 1.214-.335.557-.336.885-.922l-1-.5q-.285.686-.985.686-.53 0-.8-.386Q9.5 8.643 9.499 8q0-1.415 1.072-1.415.228 0 .479.143.25.143.421.5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CcStd.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/CcZero.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from cc-zero.svg\n */\nexport default function CcZeroIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CcZeroIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M7.983 0c2.238 0 4.148.78 5.72 2.342a7.7 7.7 0 0 1 1.715 2.582c.39.962.582 1.99.582 3.076a8.1 8.1 0 0 1-.583 3.087 7.3 7.3 0 0 1-1.703 2.526 8.2 8.2 0 0 1-2.655 1.77Q9.572 16 7.983 16a7.9 7.9 0 0 1-3.042-.6 8.3 8.3 0 0 1-2.6-1.759A8.1 8.1 0 0 1 .6 11.042 7.8 7.8 0 0 1 0 8q0-1.585.6-3.042a8.1 8.1 0 0 1 1.77-2.633C3.893.772 5.764 0 7.983 0m.034 1.44Q5.272 1.44 3.4 3.355a7 7 0 0 0-1.457 2.157 6.387 6.387 0 0 0 0 4.969 6.83 6.83 0 0 0 3.585 3.558q1.186.486 2.488.487a6.4 6.4 0 0 0 2.482-.498 6.9 6.9 0 0 0 2.185-1.446C13.93 11.364 14.56 9.839 14.56 8a6.6 6.6 0 0 0-.487-2.515 6.4 6.4 0 0 0-1.418-2.118Q10.73 1.439 8.017 1.44M11.305 8c0-2.113-.664-4.605-3.305-4.605-2.495 0-3.226 2.223-3.3 4.25L4.695 8c0 2.113.665 4.605 3.306 4.605S11.305 10.113 11.305 8M9.316 6.622 7.35 10.017c-.274.412-.083.645.219.774l.135.044q.137.033.297.034c1.358 0 1.422-1.938 1.422-2.869l-.007-.409a7 7 0 0 0-.06-.72zM6.58 7.778c.015-.985.163-2.646 1.421-2.646.107 0 .205.016.297.039.19.164.283.39.1.705L6.64 9.11l-.027-.244A10 10 0 0 1 6.577 8z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CcZero.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Check.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from check.svg\n */\nexport default function CheckIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CheckIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M12.18 2.427a1 1 0 0 1 1.705 1.04l-.066.106-7 10a1 1 0 0 1-1.606.045l-.07-.104-3-5A1 1 0 0 1 3.792 7.39l.065.097 2.207 3.677z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Check.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Checkbox.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from checkbox.svg\n */\nexport default function CheckboxIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CheckboxIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M0 2.5A2.5 2.5 0 0 1 2.5 0h11A2.5 2.5 0 0 1 16 2.5v11a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 13.5zM2.5 1A1.5 1.5 0 0 0 1 2.5v11A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-11A1.5 1.5 0 0 0 13.5 1z\",\n        \"clip-rule\": \"evenodd\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Checkbox.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/CheckboxCheckedFilled.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from checkbox-checked-filled.svg\n */\nexport default function CheckboxCheckedFilledIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CheckboxCheckedFilledIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 23,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm10.18 3.636a.75.75 0 0 0-1.044.184l-4.588 6.552-1.655-2.758-.05-.072a.75.75 0 0 0-1.236.844l2.25 3.75.053.078a.75.75 0 0 0 1.204-.034l5.25-7.5.05-.08a.75.75 0 0 0-.234-.964\",\n        \"clip-rule\": \"evenodd\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CheckboxCheckedFilled.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Collapse.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from collapse.svg\n */\nexport default function CollapseIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CollapseIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M15.79 1.613a1 1 0 0 0-1.497-1.32L11 3.584V2l-.007-.117A1 1 0 0 0 9 2v4l.007.117A1 1 0 0 0 10 7h4l.117-.007A1 1 0 0 0 15 6l-.007-.117A1 1 0 0 0 14 5h-1.586l3.293-3.293zm-8.797 8.27A1 1 0 0 0 6 9H2l-.117.007A1 1 0 0 0 1 10l.007.117A1 1 0 0 0 2 11h1.584L.293 14.293l-.083.094a1 1 0 0 0 1.497 1.32L5 12.414V14l.007.117A1 1 0 0 0 7 14v-4z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Collapse.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Copy.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from copy.svg\n */\nexport default function CopyIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"CopyIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M15 0a1 1 0 0 1 .993.883L16 1v10a1 1 0 0 1-.883.993L15 12H7a1 1 0 0 1-.993-.883L6 11V1a1 1 0 0 1 .883-.993L7 0zM4 4a1 1 0 0 1 .117 1.993L4 6H2v8h7a1 1 0 0 1 .993.883L10 15a1 1 0 0 1-.883.993L9 16H1a1 1 0 0 1-.993-.883L0 15V5a1 1 0 0 1 .883-.993L1 4zm4-2h6v8H8z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Copy.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Download.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from download.svg\n */\nexport default function DownloadIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"DownloadIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"m8.707 11.707-.094.083-.102.07a1 1 0 0 1-1.218-.153l-4-4-.083-.094a1 1 0 0 1 .083-1.32l.094-.083a1 1 0 0 1 1.32.083L7 8.585V1l.007-.117A1 1 0 0 1 9 1v7.585l2.293-2.292.094-.083a1 1 0 0 1 1.32 1.497zm7.286-1.824A1 1 0 0 0 15 9l-.117.007A1 1 0 0 0 14 10v4H2v-4l-.007-.117A1 1 0 0 0 0 10v5l.007.117A1 1 0 0 0 1 16h14l.117-.007A1 1 0 0 0 16 15v-5z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Download.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Edit.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from edit.svg\n */\nexport default function EditIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"EditIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M14.613.21a1 1 0 0 0-1.32.083l-1 1-.083.094a1 1 0 0 0 .083 1.32l1 1 .094.083a1 1 0 0 0 1.32-.083l1-1 .083-.094a1 1 0 0 0-.083-1.32l-1-1zm-3 3a1 1 0 0 0-1.32.083l-9 9-.072.08a1 1 0 0 0-.115.18l-1 2-.044.1c-.316.827.559 1.655 1.385 1.241l2-1 .093-.053a1 1 0 0 0 .167-.134l9-9 .083-.094a1 1 0 0 0-.083-1.32l-1-1z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Edit.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/EditorLatex.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from editor-latex.svg\n */\nexport default function EditorLatexIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"EditorLatexIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M13.392 16q.237 0 .423-.108.185-.109.185-.248v-1.778q0-.149-.185-.252a.85.85 0 0 0-.423-.104H6.85q-.207 0-.267-.083-.06-.082 0-.152l5.533-5.101q.238-.21.193-.378a.75.75 0 0 0-.193-.325L6.88 2.707q-.06-.07-.007-.143.05-.075.289-.074h6.17a.8.8 0 0 0 .416-.108q.178-.109.178-.248V.356q0-.139-.178-.248A.8.8 0 0 0 13.333 0H2.904q-.238 0-.423.108-.185.109-.185.248v1.943q0 .192.11.326l.171.204 5.31 4.815q.06.07.075.178a.22.22 0 0 1-.074.195l-5.622 5.154a8 8 0 0 0-.163.2.5.5 0 0 0-.104.33v1.943q0 .139.185.248a.8.8 0 0 0 .423.108z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=EditorLatex.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/EditorQuote.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from editor-quote.svg\n */\nexport default function EditorQuoteIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"EditorQuoteIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M3.538 13.745Q3.27 14 2.7 14h-.754q-.57 0-.827-.463-.258-.463.037-1.011l2.04-3.817q.111-.19-.027-.35a.41.41 0 0 0-.322-.16h-.9a.73.73 0 0 1-.525-.227.74.74 0 0 1-.23-.548v-4.65q0-.3.23-.538A.71.71 0 0 1 1.947 2H6.47q.293 0 .524.236.23.236.23.539V7.31a4.7 4.7 0 0 1-.23 1.474 4.1 4.1 0 0 1-.598 1.19l-2.408 3.251q-.184.265-.45.52m7.776 0q-.267.255-.818.255h-.754q-.57 0-.836-.463-.267-.463.045-1.011l2.023-3.817q.11-.19-.019-.35a.39.39 0 0 0-.312-.16h-.901a.73.73 0 0 1-.524-.227.74.74 0 0 1-.23-.548v-4.65q0-.3.22-.538A.7.7 0 0 1 9.743 2h4.504q.294 0 .524.236t.23.539V7.31a4.9 4.9 0 0 1-.22 1.474q-.222.7-.607 1.19l-2.409 3.251q-.183.265-.45.52\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=EditorQuote.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/EditorTextBold.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from editor-text-bold.svg\n */\nexport default function EditorTextBoldIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"EditorTextBoldIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8.661 16q1.207 0 2.193-.351a5 5 0 0 0 1.69-.993q.706-.642 1.081-1.557t.375-2.03q0-.435-.114-.893a4 4 0 0 0-.325-.87 4 4 0 0 0-.495-.754 4.4 4.4 0 0 0-.604-.597q-.255-.19 0-.412.572-.503.953-1.311.382-.81.382-1.568 0-.96-.395-1.813a4.6 4.6 0 0 0-1.08-1.484q-.687-.63-1.627-.999A5.5 5.5 0 0 0 8.66 0h-6.14a.53.53 0 0 0-.362.14A.42.42 0 0 0 2 .456v15.086q0 .178.159.318.16.139.362.139zm-.127-9.852H5.826q-.255 0-.254-.223V3.437q0-.235.254-.235h2.708q.673 0 1.195.435.52.435.521 1.027 0 .591-.521 1.038a1.78 1.78 0 0 1-1.195.446m-2.708 6.65h2.708q.84 0 1.335-.525.495-.524.495-1.205 0-.658-.495-1.188-.496-.53-1.335-.53H5.826q-.255 0-.254.234v2.99q0 .224.254.224\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=EditorTextBold.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/EditorTextItalic.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from editor-text-italic.svg\n */\nexport default function EditorTextItalicIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"EditorTextItalicIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M10.61 16q.18 0 .329-.14a.63.63 0 0 0 .191-.317l.457-2.176a.35.35 0 0 0-.063-.313.34.34 0 0 0-.277-.133H8.845q-.213-.012-.17-.235l1.892-9.372q.053-.223.266-.223H13a.5.5 0 0 0 .335-.14.6.6 0 0 0 .196-.318L13.99.457a.5.5 0 0 0 .011-.1.34.34 0 0 0-.085-.223.34.34 0 0 0-.276-.134H5.805a.5.5 0 0 0-.335.14.62.62 0 0 0-.196.317l-.457 2.176a.35.35 0 0 0 .069.318q.111.14.281.14h2.18q.212 0 .17.223l-1.893 9.372q-.042.235-.255.235H2.967a.5.5 0 0 0-.324.133.6.6 0 0 0-.197.313l-.435 2.175a.5.5 0 0 0-.011.101q0 .123.074.223.107.134.266.134z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=EditorTextItalic.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Email.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from email.svg\n */\nexport default function EmailIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"EmailIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M16 12a2 2 0 0 1-1.85 1.995L14 14H2a2 2 0 0 1-1.995-1.85L0 12V4a2 2 0 0 1 1.85-1.995L2 2h12a2 2 0 0 1 1.995 1.85l.005.138zm-2-6.058L8.581 9.814a1 1 0 0 1-1.055.067l-.107-.067L2 5.943V12h12zM2.721 4h10.558L8 7.771z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Email.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Expand.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from expand.svg\n */\nexport default function ExpandIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ExpandIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M15.993.883A1 1 0 0 0 15 0h-4l-.117.007A1 1 0 0 0 10 1l.007.117A1 1 0 0 0 11 2h1.584L9.293 5.293l-.083.094a1 1 0 0 0 1.497 1.32L14 3.414V5l.007.117A1 1 0 0 0 16 5V1zm-9.203 9.73a1 1 0 0 0-1.497-1.32L2 12.584V11l-.007-.117A1 1 0 0 0 0 11v4l.007.117A1 1 0 0 0 1 16h4l.117-.007A1 1 0 0 0 6 15l-.007-.117A1 1 0 0 0 5 14H3.414l3.293-3.293z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Expand.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/External.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from external.svg\n */\nexport default function ExternalIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ExternalIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M13 2a1 1 0 0 1 .993.883L14 3v6a1 1 0 0 1-1.993.117L12 9V5.414l-8.293 8.293a1 1 0 0 1-1.497-1.32l.083-.094L10.584 4H7a1 1 0 0 1-.993-.883L6 3a1 1 0 0 1 .883-.993L7 2z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=External.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/FileGeneric.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from file-generic.svg\n */\nexport default function FileGenericIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"FileGenericIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M12.333 0a.5.5 0 0 1 .352.144l2.167 2.143a.5.5 0 0 1 .148.356V15.5a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zM11 1H2v14h12V4h-2.5a.5.5 0 0 1-.5-.5zM8 11.25a.75.75 0 0 0-.75-.75h-2.5a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 .75-.75m3.25-3.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1 0-1.5zm.75-2a.75.75 0 0 0-.75-.75h-6.5a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 .75-.75\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=FileGeneric.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Flag.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from flag.svg\n */\nexport default function FlagIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"FlagIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M2.883.007A1 1 0 0 0 2 1v14l.007.117A1 1 0 0 0 4 15v-5h11l.114-.006.108-.017c.738-.16 1.06-1.109.485-1.684L12.415 5l3.292-3.293.076-.084C16.297.986 15.853 0 15 0H3zM4 2h8.584l-2.291 2.293-.083.094-.07.102a1 1 0 0 0 .153 1.218L12.585 8H4z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Flag.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/FlagFilled.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from flag-filled.svg\n */\nexport default function FlagFilledIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"FlagFilledIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M2 1a1 1 0 0 1 .883-.993L3 0h12c.852 0 1.297.986.783 1.623l-.076.084L12.415 5l3.292 3.293c.575.575.253 1.523-.485 1.684l-.108.017L15 10H4v5a1 1 0 0 1-1.993.117L2 15z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=FlagFilled.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Globe.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from globe.svg\n */\nexport default function GlobeIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"GlobeIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0m-8.86 2.516a23 23 0 0 1 1.72.002c-.093.809-.232 1.543-.407 2.157l-.06.198-.073.222a5 5 0 0 1-.229.55L8 13.81l-.078-.138-.078-.16a6 6 0 0 1-.297-.836 13.7 13.7 0 0 1-.407-2.16m-4.06.604-.17.058a6.02 6.02 0 0 0 2.8 2.37 12.6 12.6 0 0 1-.467-2.03l-.054-.383-.054-.451a13 13 0 0 0-1.807.36zm7.731.016.055-.452.323.046c.741.115 1.39.268 1.902.447a6.02 6.02 0 0 1-2.8 2.37c.228-.693.402-1.508.52-2.411M2.146 6.673l-.001.012a6 6 0 0 0 .003 2.643c.781-.285 1.761-.504 2.86-.645l-.006-.38v-.606l.006-.378c-1.099-.141-2.079-.36-2.862-.646m11.578.046.129-.046Q13.999 7.314 14 8q-.002.687-.146 1.328c-.783-.285-1.763-.504-2.862-.645l.006-.38L11 8q0-.305-.006-.603l-.002-.078c1.039-.134 1.972-.337 2.732-.6m-4.73.762-.259.01a26 26 0 0 1-1.73-.009L7 8q0 .262.006.52a24 24 0 0 1 1.988 0L9 8zM7.922 2.33l.077-.14.08.14.077.16c.102.227.203.508.297.835.175.614.314 1.349.407 2.16a23 23 0 0 1-1.72-.002c.093-.81.232-1.544.407-2.158a5.6 5.6 0 0 1 .375-.995m-2.212.123-.045.019a6.02 6.02 0 0 0-2.756 2.351c.584.206 1.348.376 2.225.494l.055-.453c.118-.903.292-1.718.52-2.411m4.63.157-.05-.158.265.118a6.03 6.03 0 0 1 2.537 2.254c-.585.205-1.35.375-2.227.494l-.054-.454-.058-.411a13 13 0 0 0-.412-1.843\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Globe.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/GlobeLock.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from globe-lock.svg\n */\nexport default function GlobeLockIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"GlobeLockIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M15.372 10.303c-.07-1.663-.816-2.364-2.497-2.364-1.726 0-2.5.774-2.5 2.5v.312c0 .173.14.313.313.313h.624c.173 0 .313-.14.313-.313v-.312l.003-.11c.057-.985.248-1.14 1.247-1.14 1.036 0 1.25.214 1.25 1.25v.312c0 .173.14.313.313.313h.624c.173 0 .313-.14.313-.313v-.312zm.624 1.938a.625.625 0 0 0-.621-.552h-5l-.073.004a.625.625 0 0 0-.552.62v3.75l.004.074c.036.31.3.552.621.552h5l.073-.004c.31-.036.552-.3.552-.621v-3.75z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8.342 16.682a8 8 0 1 1 7.582-9.105 3 3 0 0 0-.166-.17c-.807-.762-1.871-.968-2.883-.968-1.053 0-2.148.233-2.958 1.042-.81.81-1.042 1.905-1.042 2.958v.369a2 2 0 0 0-.308.388 21 21 0 0 0-1.427.009c.093.81.232 1.545.407 2.159.094.327.195.608.297.835l.078.16.078.139c.053-.106.198.61.25.476v1.133l.01.16.004.043q.023.192.078.372M2.91 11.867l.17-.059.248-.075a13 13 0 0 1 1.807-.36l.054.451.054.382a12.6 12.6 0 0 0 .467 2.03 6.02 6.02 0 0 1-2.8-2.37m-.765-4.493.001-.012c.783.285 1.763.504 2.862.645l-.006.379v.606l.006.38c-1.099.14-2.079.36-2.86.645a6 6 0 0 1-.003-2.643m6.59.806.26-.01.005.519-.006.52a26 26 0 0 0-1.988 0A24 24 0 0 1 7 8.69l.006-.518a26 26 0 0 0 1.73.009M8 2.879l-.077.14a5.6 5.6 0 0 0-.375.995 14 14 0 0 0-.408 2.158q.425.019.861.018.436 0 .86-.016a13.7 13.7 0 0 0-.407-2.16 6 6 0 0 0-.297-.835l-.078-.16zm-2.334.281.045-.019c-.23.694-.403 1.51-.521 2.412l-.055.453c-.877-.118-1.641-.288-2.225-.494A6.02 6.02 0 0 1 5.665 3.16m4.625-.019.05.158c.17.548.308 1.168.413 1.843l.058.411.054.453c.877-.118 1.642-.288 2.226-.493a6.03 6.03 0 0 0-2.536-2.254z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=GlobeLock.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Groups.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from groups.svg\n */\nexport default function GroupsIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"GroupsIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M2 14a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3v1a1 1 0 1 1-2 0v-1a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v1a1 1 0 1 1-2 0zM0 8a2.5 2.5 0 0 1 2.5-2.5H3a1 1 0 0 1 0 2h-.5A.5.5 0 0 0 2 8v1.5a1 1 0 1 1-2 0zM16 8a2.5 2.5 0 0 0-2.5-2.5H13a1 1 0 1 0 0 2h.5a.5.5 0 0 1 .5.5v1.5a1 1 0 1 0 2 0zM8 8.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m0 2a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7M12.5 4.25a2 2 0 1 0 0-4 2 2 0 0 0 0 4M3.5 4.25a2 2 0 1 0 0-4 2 2 0 0 0 0 4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Groups.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Help.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from help.svg\n */\nexport default function HelpIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"HelpIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M13 4.5C13 1.983 10.734 0 8 0S3 1.983 3 4.5a1 1 0 0 0 2 0C5 3.151 6.316 2 8 2s3 1.151 3 2.5S9.684 7 8 7a1 1 0 0 0-1 1v1.5l.007.117A1 1 0 0 0 9 9.5v-.59c2.265-.415 4-2.208 4-4.41M10 14a2 2 0 1 0-4 0 2 2 0 0 0 4 0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Help.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Hide.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from hide.svg\n */\nexport default function HideIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"HideIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"m1.613.21.094.083 14 14a1 1 0 0 1-1.32 1.497l-.094-.083-14-14A1 1 0 0 1 1.613.21m.583 4.845a1 1 0 0 1 .292 1.384C2.165 6.935 2 7.46 2 8c0 2.123 2.628 4 6 4q.33 0 .657-.024a1 1 0 0 1 .147 1.994Q8.405 14 8 14c-4.36 0-8-2.6-8-6 0-.937.283-1.84.812-2.653a1 1 0 0 1 1.384-.292M16 8c0-3.4-3.64-6-8-6q-.405 0-.804.03a1 1 0 1 0 .147 1.994Q7.668 4 8 4c3.372 0 6 1.877 6 4 0 .539-.165 1.065-.488 1.561a1 1 0 1 0 1.676 1.092C15.718 9.84 16 8.937 16 8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Hide.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Highlight.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from highlight.svg\n */\nexport default function HighlightIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"HighlightIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M13 1a1 1 0 0 0-1-1h-2l-.117.007a1 1 0 0 0-.75 1.493A1 1 0 0 0 9 2v6l.009.134a1 1 0 0 0 .125.365.996.996 0 0 0 .374 1.37A1 1 0 0 0 9.5 10v2l.006.114c.087.814 1.098 1.196 1.701.593l1-1 .087-.099A1 1 0 0 0 12.5 11l.001-1.134a1 1 0 0 0 .365-1.366A1 1 0 0 0 13 8V2l-.009-.134a1 1 0 0 0-.125-.365A1 1 0 0 0 13 1m0 14a1 1 0 0 0-1-1H1l-.117.007A1 1 0 0 0 1 16h11l.117-.007A1 1 0 0 0 13 15\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Highlight.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Image.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from image.svg\n */\nexport default function ImageIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ImageIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M15.995 1.85A2 2 0 0 0 14 0H2l-.15.005A2 2 0 0 0 0 2v12l.005.15A2 2 0 0 0 2 16h12l.15-.005A2 2 0 0 0 16 14V2zM2 2h12v12H2zm7.541 3.122.055.069 3.333 5.143a.432.432 0 0 1-.266.658l-.08.008H9.23a.93.93 0 0 0-.076-.98l-1.79-2.456 1.54-2.373a.41.41 0 0 1 .637-.069m-3.29 1.764-.062-.068a.41.41 0 0 0-.605.068l-2.5 3.428-.04.067c-.135.275.056.619.373.619h5l.076-.007a.432.432 0 0 0 .257-.679z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Image.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Info.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from info.svg\n */\nexport default function InfoIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"InfoIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M8 5.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3M8 7a1 1 0 0 0-1 1v4a1 1 0 1 0 2 0V8a1 1 0 0 0-1-1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Info.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Leave.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from leave.svg\n */\nexport default function LeaveIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"LeaveIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8 0c4.052 0 8 3.948 8 8s-3.948 8-8 8-8-3.948-8-8 3.948-8 8-8m0 2C5.052 2 2 5.052 2 8s3.052 6 6 6 6-3.052 6-6-3.052-6-6-6m2.707 4.707.08-.087c.778-.94-.58-2.241-1.494-1.327L8 6.585 6.707 5.293l-.094-.083a1 1 0 0 0-1.32 1.497L6.585 8 5.293 9.293l-.08.087c-.778.94.58 2.241 1.494 1.327L8 9.415l1.293 1.292.094.083a1 1 0 0 0 1.32-1.497L9.415 8z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Leave.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Link.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from link.svg\n */\nexport default function LinkIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"LinkIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M15.004 6.108c1.412-1.466 1.29-3.735-.152-5.073-1.45-1.346-3.88-1.415-5.406 0l-.09.095L8.3 2.404l-.074.101a1 1 0 0 0 .205 1.307l.102.074a1 1 0 0 0 1.306-.205l1.005-1.211.091-.076c.748-.573 1.896-.507 2.558.107.66.613.694 1.645 0 2.29l-.08.082-3.077 3.592c-.805.723-1.856.713-2.655-.028a1 1 0 0 0-1.36 1.466c1.576 1.463 3.83 1.463 5.406 0l.06-.06 3.118-3.638zM9.733 7.51a1 1 0 0 0-.053-1.413c-1.576-1.463-3.83-1.463-5.406 0l-.08.082-3.099 3.615-.099.098c-1.412 1.466-1.29 3.735.152 5.073 1.45 1.346 3.88 1.415 5.406 0l.09-.095L7.7 13.596l.074-.101a1 1 0 0 0-.205-1.307l-.102-.074a1 1 0 0 0-1.306.205l-1.006 1.21-.09.077c-.748.573-1.896.507-2.558-.107a1.544 1.544 0 0 1 0-2.29l.08-.082 3.077-3.592c.805-.723 1.856-.713 2.655.028a1 1 0 0 0 1.413-.053\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Link.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/ListOrdered.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from list-ordered.svg\n */\nexport default function ListOrderedIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ListOrderedIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"m3.237 0 .052.008q.066.015.12.061a.25.25 0 0 1 .083.132l.006.052-.004 3.167.744.001.051.007a.3.3 0 0 1 .119.058q.067.054.086.132l.006.053-.001.595-.01.05a.278.278 0 0 1-.197.176l-.07.008H1.29l-.051-.008a.3.3 0 0 1-.12-.061.25.25 0 0 1-.084-.132l-.006-.052.001-.596.01-.05a.25.25 0 0 1 .077-.113.3.3 0 0 1 .12-.06l.069-.008.932.002.003-1.959-.796.629-.068.037a.3.3 0 0 1-.196-.002.25.25 0 0 1-.172-.179L1 1.881v-.587l.007-.089.015-.075a.35.35 0 0 1 .073-.132l.06-.059.83-.758.04-.036A1 1 0 0 1 2.139.07a.5.5 0 0 1 .183-.062L2.428 0zm-.46 5.5q.351 0 .66.101.311.102.544.288t.372.437q.14.256.14.551 0 .284-.145.542-.105.185-.258.34l-.108.1L2.71 8.932l1.52.001.053.006q.066.015.12.056.071.054.091.132l.007.054-.002.59-.01.05a.25.25 0 0 1-.083.113.3.3 0 0 1-.121.059L4.216 10H1.27l-.053-.007a.3.3 0 0 1-.122-.059.25.25 0 0 1-.089-.132L1 9.748v-.711l.004-.05a.3.3 0 0 1 .04-.115l.034-.043.035-.033L3.04 7.167l.036-.036a1 1 0 0 0 .08-.114.3.3 0 0 0 .055-.145.27.27 0 0 0-.099-.21q-.1-.093-.303-.094-.244 0-.369.093a.24.24 0 0 0-.103.147l-.006.064-.002.123-.01.052a.25.25 0 0 1-.084.112.3.3 0 0 1-.12.058l-.069.008h-.726l-.053-.007a.3.3 0 0 1-.121-.059.25.25 0 0 1-.09-.132l-.006-.054V6.87l.01-.137q.026-.216.135-.407.14-.25.379-.437.236-.185.544-.287.309-.1.658-.101m.617 6.103a2 2 0 0 0-.646-.103q-.34 0-.645.103a1.7 1.7 0 0 0-.533.286 1.5 1.5 0 0 0-.366.43q-.105.19-.132.402l-.008.135v.097l.006.052q.02.076.087.131a.3.3 0 0 0 .12.059l.052.006.712.001.067-.007a.3.3 0 0 0 .119-.059.25.25 0 0 0 .081-.111l.01-.051.002-.11.006-.065a.24.24 0 0 1 .098-.148q.12-.09.324-.09.212 0 .329.09c.07.053.103.12.103.213a.26.26 0 0 1-.104.222.45.45 0 0 1-.224.086l-.112.006h-.077l-.069.008a.3.3 0 0 0-.12.06.25.25 0 0 0-.079.111l-.01.05-.001.57.006.053q.02.077.087.132a.3.3 0 0 0 .12.058l.051.007h.1l.114.007a.54.54 0 0 1 .262.095c.08.06.12.14.12.253a.29.29 0 0 1-.12.252.6.6 0 0 1-.376.102q-.247-.001-.378-.101a.28.28 0 0 1-.112-.186l-.005-.077v-.047l-.006-.054a.24.24 0 0 0-.09-.133.3.3 0 0 0-.118-.056l-.051-.006-.708-.001-.07.007a.3.3 0 0 0-.12.06.25.25 0 0 0-.079.112l-.01.05-.001.078.009.148q.027.22.132.418.14.259.382.45.24.187.555.294.316.108.67.108t.67-.107.555-.296q.243-.19.384-.449.143-.264.143-.566 0-.28-.14-.538l-.075-.122-.057-.075a1 1 0 0 0-.131-.134l-.047-.035.063-.061q.11-.122.189-.269.123-.228.124-.484 0-.29-.134-.543a1.4 1.4 0 0 0-.364-.432 1.8 1.8 0 0 0-.534-.286M16 14a1 1 0 0 0-1-1H7l-.117.007A1 1 0 0 0 7 15h8l.117-.007A1 1 0 0 0 16 14m0-6a1 1 0 0 0-1-1H7l-.117.007A1 1 0 0 0 7 9h8l.117-.007A1 1 0 0 0 16 8m0-6a1 1 0 0 0-1-1H7l-.117.007A1 1 0 0 0 7 3h8l.117-.007A1 1 0 0 0 16 2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=ListOrdered.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/ListUnordered.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from list-unordered.svg\n */\nexport default function ListUnorderedIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ListUnorderedIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M2 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4m0 6a2 2 0 1 1 0 4 2 2 0 0 1 0-4m2 8a2 2 0 1 0-4 0 2 2 0 0 0 4 0m12 0a1 1 0 0 0-1-1H7l-.117.007A1 1 0 0 0 7 15h8l.117-.007A1 1 0 0 0 16 14m0-6a1 1 0 0 0-1-1H7l-.117.007A1 1 0 0 0 7 9h8l.117-.007A1 1 0 0 0 16 8m0-6a1 1 0 0 0-1-1H7l-.117.007A1 1 0 0 0 7 3h8l.117-.007A1 1 0 0 0 16 2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=ListUnordered.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/LockFilled.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from lock-filled.svg\n */\nexport default function LockFilledIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"LockFilledIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M11.995 4.783C11.882 2.123 10.69 1 8 1 5.239 1 4 2.239 4 5v.5a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5V5l.005-.176C6.096 3.249 6.402 3 8 3c1.657 0 2 .343 2 2v.5a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5V5zm.998 3.1A1 1 0 0 0 12 7H4l-.117.007A1 1 0 0 0 3 8v6l.007.117A1 1 0 0 0 4 15h8l.117-.007A1 1 0 0 0 13 14V8z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=LockFilled.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Logo.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from logo.svg\n */\nexport default function LogoIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"LogoIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M13.83 0C14.476 0 15 .53 15 1.185V12.69c0 .654-.524 1.185-1.17 1.185H9.75L8 16l-1.75-2.125H2.17c-.646 0-1.17-.53-1.17-1.185V1.186C1 .53 1.524 0 2.17 0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"#fff\",\n        d: \"M4.785 2.133h-1.71v9.6h1.71V8.735c0-1.522.473-1.754.905-1.793l.228-.009.17.003c.51.02.979.15.979 1.199v3.598h1.71V7.598c0-1.865-1.152-2.463-2.29-2.463l-.39.003c-.753.017-.822.154-1.312 1.197zM11.889 9.6c-.573 0-1.037.477-1.037 1.067 0 .589.464 1.066 1.037 1.066s1.037-.477 1.037-1.066S12.462 9.6 11.889 9.6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Logo.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Mention.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from mention.svg\n */\nexport default function MentionIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"MentionIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8.195 16q-1.95 0-3.47-.53-1.522-.523-2.574-1.54-1.05-1.01-1.601-2.47T0 8.137q0-1.838.55-3.335.555-1.497 1.62-2.568Q3.232 1.156 4.767.578 6.307 0 8.275 0q1.821 0 3.251.53 1.436.529 2.433 1.509a6.4 6.4 0 0 1 1.521 2.319q.526 1.338.52 2.963a9.5 9.5 0 0 1-.196 2.057 5.1 5.1 0 0 1-.635 1.638q-.428.694-1.125 1.101-.697.402-1.687.457-.708.055-1.149-.104-.44-.158-.672-.469a1.7 1.7 0 0 1-.293-.736h-.074q-.146.366-.574.663a3.4 3.4 0 0 1-1.045.457 4.2 4.2 0 0 1-1.302.116 3.9 3.9 0 0 1-1.369-.335 3.5 3.5 0 0 1-1.143-.846q-.495-.554-.782-1.37-.28-.815-.287-1.886.006-1.058.3-1.844.299-.786.788-1.32.494-.537 1.1-.84a3.9 3.9 0 0 1 1.216-.39q.69-.105 1.308 0 .617.103 1.039.335.427.23.531.499h.086v-.682h1.913v5.94q.006.42.19.651a.6.6 0 0 0 .494.231q.423 0 .703-.37.287-.372.428-1.139.147-.766.147-1.954 0-1.144-.306-2.008-.3-.87-.843-1.479a4.4 4.4 0 0 0-1.253-.998 5.8 5.8 0 0 0-1.552-.56 8.2 8.2 0 0 0-1.712-.176q-1.521 0-2.658.462-1.137.458-1.895 1.284a5.4 5.4 0 0 0-1.136 1.942 7.7 7.7 0 0 0-.38 2.416q.008 1.442.404 2.556.403 1.108 1.186 1.862.782.755 1.93 1.145 1.15.39 2.641.389.703 0 1.375-.104.672-.097 1.216-.243.544-.14.874-.274l.605 1.765q-.385.219-1.045.408-.654.195-1.479.31Q9.063 16 8.195 16m-.28-5.502q.745 0 1.185-.286.446-.285.636-.846.195-.566.183-1.393-.006-.731-.19-1.236a1.4 1.4 0 0 0-.617-.773q-.434-.267-1.21-.268-.678 0-1.155.287a1.87 1.87 0 0 0-.721.803q-.245.51-.25 1.205.005.645.207 1.223.202.573.666.931.465.354 1.265.353\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Mention.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/MenuCollapse.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from menu-collapse.svg\n */\nexport default function MenuCollapseIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"data-component\": \"MenuCollapseIcon\",\n    ...props,\n    children: _jsxDEV(\"path\", {\n      fill: \"currentColor\",\n      d: \"m8.54 4.205 6.23 5.87a.69.69 0 0 1 0 1.03l-.72.68a.8.8 0 0 1-1.09 0L8 7.135l-4.96 4.65a.8.8 0 0 1-1.09 0l-.73-.69a.69.69 0 0 1 0-1.02l6.24-5.87a.8.8 0 0 1 1.08 0\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=MenuCollapse.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/MenuExpand.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from menu-expand.svg\n */\nexport default function MenuExpandIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"MenuExpandIcon\",\n    ...props,\n    children: _jsxDEV(\"path\", {\n      fill: \"currentColor\",\n      d: \"M7.456 11.788 1.226 5.92a.695.695 0 0 1 0-1.025l.726-.684a.804.804 0 0 1 1.087-.001L8 8.861l4.961-4.65a.804.804 0 0 1 1.087.001l.727.684c.3.283.3.742 0 1.025l-6.23 5.867a.804.804 0 0 1-1.09 0z\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=MenuExpand.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Minus.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from minus.svg\n */\nexport default function MinusIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"MinusIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M14 8a1 1 0 0 0-1-1H3l-.117.007A1 1 0 0 0 3 9h10l.117-.007A1 1 0 0 0 14 8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Minus.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Plus.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from plus.svg\n */\nexport default function PlusIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"PlusIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8.993 2.867 9 3v3.999L13 7a1 1 0 0 1 .117 1.993L13 9H9v4c0 1.287-1.864 1.332-1.993.133L7 13V9H3a1 1 0 0 1-.117-1.993L3 7h4V3c0-1.287 1.864-1.332 1.993-.133\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Plus.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/PointerDown.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from pointer-down.svg\n */\nexport default function PointerDownIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"9\",\n    \"data-component\": \"PointerDownIcon\",\n    ...props,\n    children: _jsxDEV(\"path\", {\n      stroke: \"currentColor\",\n      d: \"m15.5 0-7 8-8-8\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=PointerDown.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/PointerUp.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from pointer-up.svg\n */\nexport default function PointerUpIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"9\",\n    \"data-component\": \"PointerUpIcon\",\n    ...props,\n    children: _jsxDEV(\"path\", {\n      stroke: \"currentColor\",\n      d: \"m.5 9 7-8 8 8\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=PointerUp.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Profile.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from profile.svg\n */\nexport default function ProfileIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ProfileIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8 0a4 4 0 1 1 0 8 4 4 0 0 1 0-8m0 9c4.36 0 8 2.6 8 6a1 1 0 0 1-1.993.117L14 15c0-2.123-2.628-4-6-4s-6 1.877-6 4a1 1 0 1 1-2 0c0-3.4 3.64-6 8-6M6 4a2 2 0 1 1 4 0 2 2 0 0 1-4 0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Profile.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Radio.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from radio.svg\n */\nexport default function RadioIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"RadioIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8\",\n        \"clip-rule\": \"evenodd\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Radio.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/RadioChecked.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from radio-checked.svg\n */\nexport default function RadioCheckedIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"RadioCheckedIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8\",\n        \"clip-rule\": \"evenodd\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M14 8A6 6 0 1 1 2 8a6 6 0 0 1 12 0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=RadioChecked.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Reply.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from reply.svg\n */\nexport default function ReplyIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ReplyIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M7.707.293a1 1 0 0 1 .083 1.32l-.083.094L5.415 4H8a6 6 0 0 1 0 12 1 1 0 1 1 0-2 4 4 0 0 0 0-8H5.415l2.292 2.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083-4-4a1 1 0 0 1-.083-1.32l.083-.094 4-4a1 1 0 0 1 1.414 0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Reply.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Restricted.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from restricted.svg\n */\nexport default function RestrictedIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"RestrictedIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8 0c1.682 0 3.346.68 4.717 1.766l.08.063.285.241.31.285.128.125.16.165.243.265.311.373C15.32 4.653 16 6.318 16 8c0 4.052-3.948 8-8 8-1.682 0-3.346-.68-4.717-1.766l-.056-.044a9 9 0 0 1-.322-.272l-.131-.118-.167-.156-.132-.13-.152-.156-.253-.276-.304-.365C.68 11.347 0 9.682 0 8c0-4.052 3.948-8 8-8m4.765 4.651L4.65 12.765C5.654 13.523 6.835 14 8 14c2.948 0 6-3.052 6-6 0-1.165-.477-2.346-1.235-3.349M2 8c0-2.948 3.052-6 6-6 1.165 0 2.347.477 3.35 1.236L3.236 11.35C2.476 10.347 2 9.165 2 8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Restricted.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Search.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from search.svg\n */\nexport default function SearchIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"SearchIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M12 6a6 6 0 1 0-2.525 4.892l4.818 4.815.094.083a1 1 0 0 0 1.32-1.497L10.89 9.474A5.97 5.97 0 0 0 12 6M2 6a4 4 0 1 1 6.961 2.69l-.15.155-.16.152A3.98 3.98 0 0 1 6 10a4 4 0 0 1-4-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Search.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Share.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from share.svg\n */\nexport default function ShareIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"ShareIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M8.707.293 8.613.21 8.51.14a1 1 0 0 0-1.218.153l-4 4-.083.094a1 1 0 0 0 .083 1.32l.094.083a1 1 0 0 0 1.32-.083L7 3.415V11l.007.117A1 1 0 0 0 9 11V3.415l2.293 2.292.094.083a1 1 0 0 0 1.32-1.497zm7.286 9.59A1 1 0 0 0 15 9l-.117.007A1 1 0 0 0 14 10v4H2v-4l-.007-.117A1 1 0 0 0 0 10v5l.007.117A1 1 0 0 0 1 16h14l.117-.007A1 1 0 0 0 16 15v-5z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Share.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/SocialFacebook.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from social-facebook.svg\n */\nexport default function SocialFacebookIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"SocialFacebookIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M15.999 8.049c0-4.445-3.582-8.049-8-8.049S0 3.604 0 8.049C0 12.066 2.925 15.396 6.75 16v-5.624H4.717V8.049H6.75V6.276c0-2.018 1.195-3.132 3.022-3.132.875 0 1.79.157 1.79.157v1.981h-1.008c-.994 0-1.304.62-1.304 1.257v1.51h2.219l-.355 2.327H9.25V16c3.825-.604 6.75-3.934 6.75-7.951z\",\n        \"clip-rule\": \"evenodd\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=SocialFacebook.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/SocialTwitter.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from social-twitter.svg\n */\nexport default function SocialTwitterIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"SocialTwitterIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M15.969 3.049c-.59.259-1.22.436-1.884.516a3.3 3.3 0 0 0 1.442-1.815c-.634.37-1.336.64-2.084.79a3.28 3.28 0 0 0-5.59 2.988 9.3 9.3 0 0 1-6.76-3.418C.799 2.61.646 3.18.65 3.76c0 1.14.58 2.142 1.459 2.73a3.3 3.3 0 0 1-1.485-.41v.04a3.28 3.28 0 0 0 2.63 3.218 3.3 3.3 0 0 1-1.474.057 3.29 3.29 0 0 0 3.069 2.278A6.58 6.58 0 0 1 .78 13.076q-.39 0-.78-.044a9.33 9.33 0 0 0 5.038 1.472c6.036 0 9.332-4.997 9.332-9.323 0-.14 0-.28-.01-.42a6.6 6.6 0 0 0 1.64-1.7z\",\n        \"clip-rule\": \"evenodd\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=SocialTwitter.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Sort.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from sort.svg\n */\nexport default function SortIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"SortIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M4.707.293 4.613.21a1 1 0 0 0-1.32.083l-3 3-.083.094a1 1 0 0 0 .083 1.32l.094.083a1 1 0 0 0 1.32-.083L3 3.415V8a1 1 0 1 0 2 0V3.415l1.293 1.292.094.083a1 1 0 0 0 1.32-1.497zM13 8a1 1 0 1 0-2 0v4.585l-1.293-1.292-.094-.083a1 1 0 0 0-1.32 1.497l3 3 .094.083a1 1 0 0 0 1.32-.083l3-3 .083-.094a1 1 0 0 0-.083-1.32l-.094-.083a1 1 0 0 0-1.32.083L13 12.585z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Sort.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/SpinnerSpokes.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from spinner--spokes.svg\n */\nexport default function SpinnerSpokesIcon(props) {\n  return _jsxDEV(\"svg\", {\n    width: \"16\",\n    height: \"16\",\n    viewBox: \"0 0 64 64\",\n    \"data-component\": \"SpinnerSpokesIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      stroke: \"currentColor\",\n      \"stroke-linecap\": \"round\",\n      \"stroke-width\": \"6\",\n      children: [_jsxDEV(\"path\", {\n        d: \"M32 16V4\",\n        children: _jsxDEV(\"animate\", {\n          attributeName: \"stroke-opacity\",\n          dur: \"750ms\",\n          repeatCount: \"indefinite\",\n          values: \"0;1;.8;.65;.45;.3;.15;0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 20,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 19,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        d: \"m43.314 20.686 8.485-8.485\",\n        children: _jsxDEV(\"animate\", {\n          attributeName: \"stroke-opacity\",\n          dur: \"750ms\",\n          repeatCount: \"indefinite\",\n          values: \".15;0;1;.8;.65;.45;.3;.15\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 28,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        d: \"M48 32h12\",\n        children: _jsxDEV(\"animate\", {\n          attributeName: \"stroke-opacity\",\n          dur: \"750ms\",\n          repeatCount: \"indefinite\",\n          values: \".3;.15;0;1;.8;.65;.45;.3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        d: \"m43.314 43.314 8.485 8.485\",\n        children: _jsxDEV(\"animate\", {\n          attributeName: \"stroke-opacity\",\n          dur: \"750ms\",\n          repeatCount: \"indefinite\",\n          values: \".45;.3;.15;0;1;.85;.65;.45\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        d: \"M32 48v12\",\n        children: _jsxDEV(\"animate\", {\n          attributeName: \"stroke-opacity\",\n          dur: \"750ms\",\n          repeatCount: \"indefinite\",\n          values: \".65;.45;.3;.15;0;1;.8;.65;\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        d: \"m20.686 43.314-8.485 8.485\",\n        children: _jsxDEV(\"animate\", {\n          attributeName: \"stroke-opacity\",\n          dur: \"750ms\",\n          repeatCount: \"indefinite\",\n          values: \".8;.65;.45;.3;.15;0;1;.8\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        d: \"M16 32H4\",\n        children: _jsxDEV(\"animate\", {\n          attributeName: \"stroke-opacity\",\n          dur: \"750ms\",\n          repeatCount: \"indefinite\",\n          values: \"1;.85;.6;.45;.3;.15;0;1;\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        d: \"m20.686 20.686-8.485-8.485\",\n        children: _jsxDEV(\"animate\", {\n          attributeName: \"stroke-opacity\",\n          dur: \"750ms\",\n          repeatCount: \"indefinite\",\n          values: \"0;1;.8;.65;.45;.3;.15;0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=SpinnerSpokes.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Trash.tsx\"; // This file was auto-generated using scripts/generate-icons.js\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Icon generated from trash.svg\n */\nexport default function TrashIcon(props) {\n  return _jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    \"aria-hidden\": \"true\",\n    viewBox: \"0 0 16 16\",\n    \"data-component\": \"TrashIcon\",\n    ...props,\n    children: _jsxDEV(\"g\", {\n      \"fill-rule\": \"evenodd\",\n      children: [_jsxDEV(\"path\", {\n        fill: \"none\",\n        d: \"M0 0h16v16H0z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), _jsxDEV(\"path\", {\n        fill: \"currentColor\",\n        d: \"M16 1a1 1 0 0 0-1-1H1a1 1 0 1 0 0 2h14a1 1 0 0 0 1-1M14 4H2a1 1 0 0 0-.98 1.196l2 10A1 1 0 0 0 4 16h8a1 1 0 0 0 .98-.804l2-10A1 1 0 0 0 14 4m-1.22 2-1.6 8H4.819l-1.6-8z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Trash.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/Button.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a button with optional icon\n */\nexport default function Button({\n  children,\n  classes,\n  elementRef,\n  expanded,\n  pressed,\n  title,\n  icon: Icon,\n  size = 'md',\n  variant = 'secondary',\n  unstyled = false,\n  role,\n  ...htmlAttributes\n}) {\n  const styled = !unstyled;\n  const themed = styled && variant !== 'custom';\n  const sized = styled && size !== 'custom';\n  const ariaProps = {\n    'aria-label': title\n  };\n\n  // aria-pressed and aria-expanded are not allowed for buttons with\n  // an aria role of `tab`. Instead, the aria-selected attribute is expected.\n  if (role === 'tab') {\n    ariaProps['aria-selected'] = pressed;\n  } else {\n    ariaProps['aria-pressed'] = pressed;\n    ariaProps['aria-expanded'] = expanded;\n  }\n  return _jsxDEV(\"button\", {\n    role: role !== null && role !== void 0 ? role : 'button',\n    \"data-component\": \"Button\"\n    // Setting a default `type` can prevent undesired form submissions in\n    // certain cases\n    ,\n    type: \"button\",\n    ...ariaProps,\n    ...htmlAttributes,\n    className: classnames({\n      'focus-visible-ring transition-colors whitespace-nowrap flex items-center': styled\n    }, themed && {\n      'font-semibold rounded': true,\n      'text-grey-7 bg-grey-1 enabled:hover:text-grey-9 enabled:hover:bg-grey-2 aria-pressed:text-grey-9 aria-expanded:text-grey-9': variant === 'secondary',\n      // default\n      'text-grey-1 bg-grey-7 enabled:hover:bg-grey-8 disabled:text-grey-4': variant === 'primary'\n    }, sized && {\n      'p-2 gap-x-2': size === 'md',\n      // default\n      'p-1 gap-x-1': size === 'xs',\n      'p-1.5 gap-x-1.5': size === 'sm',\n      'p-2.5 gap-x-1.5': size === 'lg'\n    }, classes),\n    ref: downcastRef(elementRef),\n    title: title,\n    children: [Icon && _jsxDEV(Icon, {\n      className: \"w-em h-em\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 16\n    }, this), children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Button.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/InputGroup.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\n\n// These styles may be applied to input components to adapt them when in\n// an InputGroup\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\nexport const inputGroupStyles = classnames(\n// All inputs within an InputGroup should have a border. Turn off border-radius\n'input-group:border input-group:rounded-none',\n// Restore border-radius on the leftmost and rightmost components in the group\n'input-group:first:rounded-l input-group:last:rounded-r',\n// \"Collapse\" borders between input components\n'input-group:ml-[-1px] input-group:first:ml-0',\n// Make sure focused element appears on top, preventing a cropped focus ring\n'focus:z-1');\n/**\n * Render a container that lays out a group of input components\n */\nexport default function InputGroup({\n  children,\n  classes,\n  elementRef,\n  ...htmlAttributes\n}) {\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"InputGroup\",\n    ...htmlAttributes,\n    ref: downcastRef(elementRef),\n    className: classnames(\n    // Set the `.input-group` class so that children may\n    // use the `input-group:` variant in their styles\n    'input-group', 'flex items-stretch w-full justify-center', classes),\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=InputGroup.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/IconButton.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport Button from './Button';\nimport { inputGroupStyles } from './InputGroup';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a button that only contains an icon.\n */\nexport default function IconButton({\n  children,\n  classes,\n  elementRef,\n  pressed,\n  expanded,\n  icon: Icon,\n  size = 'md',\n  title,\n  variant = 'secondary',\n  unstyled = false,\n  ...htmlAttributes\n}) {\n  const styled = !unstyled;\n  const themed = styled && variant !== 'custom';\n  const sized = styled && size !== 'custom';\n  return _jsxDEV(Button, {\n    \"data-component\": \"IconButton\",\n    ...htmlAttributes,\n    classes: classnames({\n      'focus-visible-ring transition-colors rounded whitespace-nowrap': styled,\n      'flex items-center justify-center': styled\n    },\n    // Adapt styles when in an InputGroup\n    styled && inputGroupStyles, themed && {\n      // variant\n      'text-grey-7 bg-transparent enabled:hover:text-grey-9 aria-pressed:text-brand aria-expanded:text-brand': variant === 'secondary',\n      //default\n      'text-brand bg-transparent enabled:hover:text-grey-9 disabled:text-grey-7': variant === 'primary',\n      'text-grey-7 bg-grey-2 enabled:hover:text-grey-9 enabled:hover:bg-grey-3 disabled:text-grey-5 aria-pressed:bg-grey-3 aria-expanded:bg-grey-3': variant === 'dark'\n    }, sized && {\n      'gap-x-2 touch:min-w-touch-minimum touch:min-h-touch-minimum': true,\n      'p-2': size === 'md',\n      // Default\n      'p-1': size === 'xs',\n      'p-1.5': size === 'sm',\n      'p-2.5': size === 'lg'\n    }, classes),\n    elementRef: downcastRef(elementRef),\n    title: title,\n    pressed: pressed,\n    expanded: expanded,\n    unstyled: true,\n    children: [Icon && _jsxDEV(Icon, {\n      className: \"w-em h-em\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 16\n    }, this), children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=IconButton.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/CloseButton.tsx\";\nimport { useContext } from 'preact/hooks';\nimport { downcastRef } from '../../util/typing';\nimport CloseableContext from '../CloseableContext';\nimport { CancelIcon } from '../icons';\nimport IconButton from './IconButton';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a close button. Use provided `onClick` or check for a CloseableContext\n * with a close handler.\n */\nexport default function CloseButton({\n  children,\n  classes,\n  elementRef,\n  title,\n  onClick,\n  ...iconButtonProps\n}) {\n  var _ref;\n  const closeableContext = useContext(CloseableContext);\n  // Provided `title` and `onClick` are prioritized, but fall back to values\n  // from the `CloseableContext`\n  const buttonTitle = (_ref = title !== null && title !== void 0 ? title : closeableContext === null || closeableContext === void 0 ? void 0 : closeableContext.title) !== null && _ref !== void 0 ? _ref : 'Close';\n  const closeHandler = onClick !== null && onClick !== void 0 ? onClick : closeableContext === null || closeableContext === void 0 ? void 0 : closeableContext.onClose;\n  return _jsxDEV(IconButton, {\n    \"data-component\": \"CloseButton\",\n    elementRef: downcastRef(elementRef),\n    icon: CancelIcon,\n    title: buttonTitle,\n    classes: classes,\n    ...iconButtonProps,\n    onClick: closeHandler,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 36,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CloseButton.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/CardTitle.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Style a title for a Card\n */\nexport default function CardTitle({\n  children,\n  classes,\n  elementRef,\n  tagName = 'h1',\n  variant = 'primary',\n  ...htmlAttributes\n}) {\n  const WrapperElement = tagName;\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"CardTitle\",\n    ...htmlAttributes,\n    className: classnames({\n      'text-lg text-brand font-semibold': variant === 'primary',\n      'text-xl text-slate-7 font-normal': variant === 'secondary'\n    }, classes),\n    ref: downcastRef(elementRef),\n    children: _jsxDEV(WrapperElement, {\n      \"data-testid\": \"card-title-heading\",\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CardTitle.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/CardHeader.tsx\";\nimport classnames from 'classnames';\nimport { useContext } from 'preact/hooks';\nimport { downcastRef } from '../../util/typing';\nimport CloseableContext from '../CloseableContext';\nimport CloseButton from '../input/CloseButton';\nimport CardTitle from './CardTitle';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a header area in a Card with optional title and/or close button\n */\nexport default function CardHeader({\n  children,\n  classes,\n  elementRef,\n  fullWidth = false,\n  onClose,\n  title,\n  variant = 'primary',\n  ...htmlAttributes\n}) {\n  const closeableContext = useContext(CloseableContext);\n  // Provided `onClose` is prioritized, but also check to see if there is\n  // a close handler provided by a `CloseableContext`\n  const closeHandler = onClose !== null && onClose !== void 0 ? onClose : closeableContext === null || closeableContext === void 0 ? void 0 : closeableContext.onClose;\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"CardHeader\",\n    ...htmlAttributes,\n    className: classnames('flex items-center gap-x-2 border-b py-2', {\n      'bg-slate-0 border-slate-5 rounded-t-[inherit]': variant === 'secondary',\n      'mx-3': !fullWidth && variant === 'primary',\n      'px-3': fullWidth || variant === 'secondary'\n    }, classes),\n    ref: downcastRef(elementRef),\n    children: [title && _jsxDEV(CardTitle, {\n      variant: variant,\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 17\n    }, this), children, _jsxDEV(\"div\", {\n      className: \"grow\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), closeHandler && _jsxDEV(CloseButton, {\n      onClick: closeHandler,\n      classes: classnames(\n      // Pull button right such that its icon right-aligns with the\n      // header's bottom border\n      '-mr-2.5',\n      // Button icons render at 1em square. In this context, the icon\n      // should always be exactly 16px square, so set font size to make\n      // this happen.\n      'text-[16px]')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=CardHeader.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/Panel.tsx\";\nimport classNames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport Scroll from '../data/Scroll';\nimport Card from './Card';\nimport CardActions from './CardActions';\nimport CardContent from './CardContent';\nimport CardHeader from './CardHeader';\nimport CardTitle from './CardTitle';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"preact/jsx-dev-runtime\";\n/**\n * Render a composed set of Card components in a panel-like interface.\n *\n * If the total height of the Panel exceeds any height constraints set on the\n * Panel's immediate parent element, content (`children`) will scroll. The\n * header and any buttons will not scroll.\n */\nexport default function Panel({\n  children,\n  elementRef,\n  buttons,\n  fullWidthHeader = false,\n  icon: Icon,\n  onClose,\n  paddingSize = 'md',\n  scrollable = false,\n  title,\n  ...htmlAttributes\n}) {\n  // These classes are set on the content container hierarchy in this component\n  // to ensure that the overall height is constrained to height rules set on\n  // parent elements. This allows for control over scrolling content,\n  // specifically.\n  const heightConstraintClasses = 'flex flex-col min-h-0 h-full';\n  const panelContent = paddingSize === 'none' ? children : _jsxDEV(CardContent, {\n    classes: heightConstraintClasses,\n    \"data-testid\": \"panel-content-wrapper\",\n    size: paddingSize,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 7\n  }, this);\n  return _jsxDEV(Card, {\n    \"data-composite-component\": \"Panel\",\n    ...htmlAttributes,\n    classes: heightConstraintClasses,\n    elementRef: downcastRef(elementRef),\n    children: [_jsxDEV(CardHeader, {\n      onClose: onClose,\n      fullWidth: scrollable || fullWidthHeader,\n      children: [Icon && _jsxDEV(Icon, {\n        className: \"w-em h-em\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 18\n      }, this), _jsxDEV(CardTitle, {\n        children: title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this), scrollable ? _jsxDEV(Scroll, {\n      classes: classNames({\n        // When no buttons are provided (which means this is the last children),\n        // inherit the bottom border radius from Card.\n        'rounded-b-[inherit]': !buttons\n      }),\n      children: panelContent\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }, this) : _jsxDEV(_Fragment, {\n      children: panelContent\n    }, void 0, false), buttons && _jsxDEV(CardContent, {\n      \"data-testid\": \"panel-buttons\",\n      children: _jsxDEV(CardActions, {\n        children: buttons\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Panel.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/feedback/Dialog.tsx\";\nimport classnames from 'classnames';\nimport { Fragment } from 'preact';\nimport { useCallback, useEffect, useId, useLayoutEffect, useMemo, useRef, useState } from 'preact/hooks';\nimport { useClickAway } from '../../hooks/use-click-away';\nimport { useFocusAway } from '../../hooks/use-focus-away';\nimport { useKeyPress } from '../../hooks/use-key-press';\nimport { useSyncedRef } from '../../hooks/use-synced-ref';\nimport { downcastRef } from '../../util/typing';\nimport CloseableContext from '../CloseableContext';\nimport Panel from '../layout/Panel';\n\n// This component forwards a number of props on to `Panel` but always sets the\n// `fullWidthHeader` prop to `true`.\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"preact/jsx-dev-runtime\";\nfunction isPanelProps(props) {\n  return props.variant !== 'custom';\n}\n\n/**\n * Show a dialog\n */\nexport default function Dialog({\n  closeOnClickAway = false,\n  closeOnEscape = false,\n  closeOnFocusAway = false,\n  children,\n  initialFocus = 'auto',\n  restoreFocus = false,\n  transitionComponent: TransitionComponent,\n  classes,\n  elementRef,\n  onClose,\n  closeTitle,\n  ...rest\n}) {\n  const isPanel = isPanelProps(rest);\n  const {\n    buttons,\n    icon,\n    paddingSize = 'md',\n    title = '',\n    scrollable = true,\n    ...htmlAttributes\n  } = isPanel ? rest : {\n    buttons: undefined,\n    icon: undefined,\n    paddingSize: undefined,\n    title: undefined,\n    scrollable: undefined,\n    ...rest\n  };\n  const modalRef = useSyncedRef(elementRef);\n  const restoreFocusEl = useRef(document.activeElement);\n  const [transitionComponentVisible, setTransitionComponentVisible] = useState(false);\n  const closeHandler = useCallback(() => {\n    if (TransitionComponent) {\n      // When a TransitionComponent is provided, the actual \"onClose\" will be\n      // called by that component, once the \"out\" transition has finished\n      setTransitionComponentVisible(false);\n    } else {\n      onClose === null || onClose === void 0 || onClose();\n    }\n  }, [onClose, TransitionComponent]);\n  const initializeDialog = useCallback(() => {\n    if (initialFocus === 'manual') {\n      return;\n    }\n    if (initialFocus === 'auto') {\n      var _modalRef$current;\n      // An explicit `initialFocus` has not been set, so use automatic focus\n      // handling. Modern accessibility guidance is to focus the dialog itself\n      // rather than trying to be smart about focusing a particular control\n      // within the dialog.\n      (_modalRef$current = modalRef.current) === null || _modalRef$current === void 0 || _modalRef$current.focus();\n      return;\n    }\n    const focusEl = initialFocus === null || initialFocus === void 0 ? void 0 : initialFocus.current;\n    if (focusEl && !focusEl.disabled) {\n      focusEl.focus();\n    } else {\n      var _modalRef$current2;\n      // Fall back to focusing the modal itself\n      (_modalRef$current2 = modalRef.current) === null || _modalRef$current2 === void 0 || _modalRef$current2.focus();\n    }\n  }, [initialFocus, modalRef]);\n  const onTransitionEnd = direction => {\n    if (direction === 'in') {\n      initializeDialog();\n    } else {\n      onClose === null || onClose === void 0 || onClose();\n    }\n  };\n  useClickAway(modalRef, closeHandler, {\n    enabled: closeOnClickAway\n  });\n  useKeyPress(['Escape'], closeHandler, {\n    enabled: closeOnEscape\n  });\n  useFocusAway(modalRef, closeHandler, {\n    enabled: closeOnFocusAway\n  });\n  const dialogDescriptionId = useId();\n  const Wrapper = useMemo(() => TransitionComponent !== null && TransitionComponent !== void 0 ? TransitionComponent : Fragment, [TransitionComponent]);\n  useEffect(() => {\n    setTransitionComponentVisible(true);\n    if (!TransitionComponent) {\n      initializeDialog();\n    }\n\n    // We only want to run this effect once when the dialog is mounted.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useLayoutEffect(\n  /**\n   * Restore focus when component is unmounted, if `restoreFocus` is set.\n   */\n  () => {\n    const restoreFocusTo = restoreFocusEl.current;\n    return () => {\n      if (restoreFocus && restoreFocusTo) {\n        restoreFocusTo.focus();\n      }\n    };\n  },\n  // We only want to run this effect once when the dialog is mounted.\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  useLayoutEffect(\n  /**\n   * Try to assign the dialog an accessible description, using the content of\n   * the first paragraph of text within it.\n   *\n   * A limitation of this approach is that it doesn't update if the dialog's\n   * content changes after the initial render.\n   */\n  () => {\n    var _modalRef$current3;\n    const description = modalRef === null || modalRef === void 0 || (_modalRef$current3 = modalRef.current) === null || _modalRef$current3 === void 0 ? void 0 : _modalRef$current3.querySelector('p');\n    if (description) {\n      description.id = dialogDescriptionId;\n      modalRef.current.setAttribute('aria-describedby', dialogDescriptionId);\n    }\n  }, [dialogDescriptionId, modalRef]);\n\n  // Provide a close handler to descendant components\n  const closeableContext = {\n    onClose: onClose ? closeHandler : undefined,\n    title: closeTitle\n  };\n  return _jsxDEV(CloseableContext.Provider, {\n    value: closeableContext,\n    children: _jsxDEV(Wrapper, {\n      direction: transitionComponentVisible ? 'in' : 'out',\n      onTransitionEnd: onTransitionEnd,\n      children: _jsxDEV(\"div\", {\n        \"data-component\": \"Dialog\",\n        tabIndex: -1\n        // NB: Role can be overridden with an HTML attribute; this is purposeful\n        ,\n        role: \"dialog\",\n        ...htmlAttributes,\n        className: classnames(\n        // Column-flex layout to constrain content to max-height\n        'flex flex-col', classes),\n        ref: downcastRef(modalRef),\n        children: isPanel ? _jsxDEV(Panel, {\n          buttons: buttons,\n          fullWidthHeader: true,\n          icon: icon,\n          paddingSize: paddingSize,\n          title: title,\n          scrollable: scrollable,\n          children: children\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 13\n        }, this) : _jsxDEV(_Fragment, {\n          children: children\n        }, void 0, false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 238,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Dialog.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/feedback/ModalDialog.tsx\";\nimport classnames from 'classnames';\nimport { useSyncedRef } from '../../hooks/use-synced-ref';\nimport { useTabKeyNavigation } from '../../hooks/use-tab-key-navigation';\nimport { downcastRef } from '../../util/typing';\nimport Overlay from '../layout/Overlay';\nimport Dialog from './Dialog';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Show a modal dialog\n */\nexport default function ModalDialog({\n  children,\n  disableCloseOnEscape = false,\n  disableFocusTrap = false,\n  disableRestoreFocus = false,\n  size = 'md',\n  classes,\n  elementRef,\n  // Forwarded to Dialog\n  closeOnClickAway = false,\n  closeOnFocusAway = false,\n  initialFocus = 'auto',\n  ...htmlAndPanelAttributes\n}) {\n  const modalRef = useSyncedRef(elementRef);\n  useTabKeyNavigation(modalRef, {\n    enabled: !disableFocusTrap\n  });\n  return _jsxDEV(Overlay, {\n    \"data-composite-component\": \"ModalDialog\",\n    children: _jsxDEV(Dialog\n    // Attribute defaults; can be overridden\n    , {\n      \"aria-modal\": true,\n      ...htmlAndPanelAttributes,\n      // Dialog props\n      closeOnClickAway: closeOnClickAway,\n      closeOnFocusAway: closeOnFocusAway,\n      closeOnEscape: !disableCloseOnEscape,\n      initialFocus: initialFocus,\n      restoreFocus: !disableRestoreFocus,\n      classes: classnames(\n      // Column-flex layout to constrain content to max-height\n      'flex flex-col', size !== 'custom' && 'max-w-[90vw] max-h-[90vh]',\n      // Overlay sets up a flex layout centered on both axes. For taller\n      // viewports, remove this modal container from the flex flow with\n      // fixed positioning and position it 10vh from the top of the\n      // viewport. This feels more balanced on taller screens. Ensure an\n      // equal 10vh gap at the bottom of the screen by adjusting max-height\n      // to `80vh`.\n      size !== 'custom' && 'tall:fixed tall:max-h-[80vh] tall:top-[10vh]', {\n        // Max-width rules will ensure actual width never exceeds 90vw\n        'w-[30rem]': size === 'sm',\n        'w-[36rem]': size === 'md',\n        // default\n        'w-[42rem]': size === 'lg'\n        // No width classes are added if `size` is 'custom'\n      }, classes),\n      elementRef: downcastRef(modalRef),\n      \"data-modal-size\": size,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=ModalDialog.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/util/prompts.tsx\";\nimport { render } from 'preact';\nimport { createRef } from 'preact';\nimport ModalDialog from '../components/feedback/ModalDialog';\nimport Button from '../components/input/Button';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"preact/jsx-dev-runtime\";\n/**\n * Show the user a prompt asking them to confirm an action.\n *\n * This is like an async version of `window.confirm` except that:\n *\n *  - It can be used inside iframes (browsers are starting to prevent this for\n *    the native `window.confirm` dialog)\n *  - The visual style of the dialog matches the Hypothesis design system\n *\n * @return - Promise that resolves with `true` if the user confirmed the action\n *   or `false` if they canceled it.\n */\nexport async function confirm({\n  title = 'Confirm',\n  message,\n  confirmAction = 'Yes',\n  cancelAction = 'Cancel',\n  initialFocus = 'cancel'\n}) {\n  const cancelButton = createRef();\n  const confirmButton = createRef();\n  const initialFocusRef = initialFocus === 'cancel' ? cancelButton : confirmButton;\n  const container = document.createElement('div');\n  container.setAttribute('data-testid', 'confirm-container');\n\n  // Ensure dialog appears above any existing content. The Z-index value here\n  // is Good Enough™ for current usage.\n  container.style.position = 'relative';\n  container.style.zIndex = '10';\n  document.body.appendChild(container);\n  return new Promise(resolve => {\n    const close = result => {\n      render(null, container);\n      container.remove();\n      resolve(result);\n    };\n    render(_jsxDEV(ModalDialog, {\n      buttons: _jsxDEV(_Fragment, {\n        children: [_jsxDEV(Button, {\n          elementRef: cancelButton,\n          \"data-testid\": \"cancel-button\",\n          onClick: () => close(false),\n          children: cancelAction\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, this), _jsxDEV(Button, {\n          variant: \"primary\",\n          elementRef: confirmButton,\n          \"data-testid\": \"confirm-button\",\n          onClick: () => close(true),\n          children: confirmAction\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true),\n      initialFocus: initialFocusRef,\n      title: title,\n      onClose: () => close(false),\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), container);\n  });\n}\n//# sourceMappingURL=prompts.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/ToggleInput.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a labeled checkbox or radio input. The input is styled with two icons:\n * one for the unchecked state and one for the checked state. The input itself\n * is positioned exactly on top of the icon, but is non-visible.\n */\nexport default function ToggleInput({\n  children,\n  elementRef,\n  containerRef,\n  checked,\n  icon: UncheckedIcon,\n  checkedIcon: CheckedIcon,\n  disabled,\n  onChange,\n  id,\n  type,\n  containerClasses,\n  ...htmlAttributes\n}) {\n  const Icon = checked ? CheckedIcon : UncheckedIcon;\n  return _jsxDEV(\"label\", {\n    className: classnames('relative flex items-center gap-x-1.5', {\n      'cursor-pointer': !disabled,\n      'opacity-70': disabled\n    }, containerClasses),\n    htmlFor: id,\n    \"data-composite-component\": type === 'checkbox' ? 'Checkbox' : 'RadioButton',\n    ref: downcastRef(containerRef),\n    children: [_jsxDEV(\"input\", {\n      ...htmlAttributes,\n      type: type,\n      ref: downcastRef(elementRef),\n      className: classnames(\n      // Set the special Tailwind peer class to allow sibling elements\n      // to style themselves based on the state of this element\n      'peer',\n      // Position this atop the icon and size it to the same dimensions\n      'absolute w-em h-em',\n      // Make input visually hidden, but some screen readers won't read out\n      // elements with 0 opacity\n      'opacity-[.00001]', {\n        'cursor-pointer': !disabled\n      }),\n      checked: checked,\n      disabled: disabled,\n      id: id,\n      onChange: onChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), _jsxDEV(Icon, {\n      className: classnames(\n      // Add an outline ring to the icon when the input is focus-visible.\n      // The ring needs to be applied here because the `input` has an\n      // effectively-0 opacity.\n      'peer-focus-visible:ring', 'w-em h-em')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=ToggleInput.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/Checkbox.tsx\";\nimport { useState } from 'preact/hooks';\nimport { CheckboxCheckedFilledIcon, CheckboxIcon } from '../icons';\nimport ToggleInput from './ToggleInput';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a labeled checkbox input. The checkbox is styled with two icons:\n * one for the unchecked state and one for the checked state. The input itself\n * is positioned exactly on top of the icon, but is non-visible.\n */\nexport default function Checkbox({\n  checked,\n  defaultChecked = false,\n  icon = CheckboxIcon,\n  checkedIcon = CheckboxCheckedFilledIcon,\n  onChange,\n  ...rest\n}) {\n  // If `checked` is present, treat this as a controlled component\n  const isControlled = typeof checked === 'boolean';\n  // Only use this local state if checkbox is uncontrolled\n  const [uncontrolledChecked, setUncontrolledChecked] = useState(defaultChecked);\n  const isChecked = isControlled ? checked : uncontrolledChecked;\n  function handleChange(event) {\n    onChange === null || onChange === void 0 || onChange.call(this, event);\n    if (!isControlled) {\n      setUncontrolledChecked(event.target.checked);\n    }\n  }\n  return _jsxDEV(ToggleInput, {\n    icon: icon,\n    checkedIcon: checkedIcon,\n    type: \"checkbox\",\n    checked: isChecked,\n    onChange: handleChange,\n    ...rest\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Checkbox.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/Input.tsx\";\nimport classnames from 'classnames';\nimport { useSyncedRef } from '../../hooks/use-synced-ref';\nimport { useValidationError } from '../../hooks/use-validation-error';\nimport { downcastRef } from '../../util/typing';\nimport { inputGroupStyles } from './InputGroup';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\nexport function inputStyles({\n  classes,\n  feedback\n}) {\n  return classnames('focus-visible-ring ring-inset border rounded w-full p-2', 'bg-grey-0 focus:bg-white disabled:bg-grey-1', 'placeholder:text-grey-6 disabled:placeholder:text-grey-7',\n  // On iOS, the input font size must be at least 16px to prevent the browser\n  // from zooming into it on touch.\n  'touch:text-at-least-16px', {\n    'ring-2': !!feedback,\n    'ring-red-error': feedback === 'error',\n    'ring-yellow-notice': feedback === 'warning'\n  },\n  // Adapt styles when this component is inside an InputGroup\n  inputGroupStyles, classes);\n}\n/**\n * Render a text field input\n */\nexport default function Input({\n  elementRef,\n  type = 'text',\n  classes,\n  error,\n  feedback,\n  ...htmlAttributes\n}) {\n  if (!htmlAttributes.id && !htmlAttributes['aria-label']) {\n    console.warn('`Input` component should have either an `id` or an `aria-label` attribute');\n  }\n  const inputRef = downcastRef(elementRef);\n  const ref = useSyncedRef(inputRef);\n  if (error) {\n    feedback = 'error';\n  }\n  useValidationError(ref, error);\n  return _jsxDEV(\"input\", {\n    \"data-component\": \"Input\",\n    ...htmlAttributes,\n    ref: ref,\n    type: type,\n    className: inputStyles({\n      classes,\n      feedback\n    }),\n    \"aria-invalid\": feedback === 'error'\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Input.js.map","import { useLayoutEffect } from 'preact/hooks';\n/**\n * Sync custom validation error messages to the browser's native validation\n * state.\n *\n * @param ref - An `HTMLInputElement` or other element that supports the\n *   Constraint Validation API\n * @param error - The current error or undefined if the field input is valid\n */\nexport function useValidationError(ref, error) {\n  // Sync errors to native form validation API. This will prevent submission\n  // of the form until the error is resolved.\n  useLayoutEffect(() => {\n    var _ref$current;\n    (_ref$current = ref.current) === null || _ref$current === void 0 || _ref$current.setCustomValidity(error !== null && error !== void 0 ? error : '');\n  }, [error, ref]);\n}\n//# sourceMappingURL=use-validation-error.js.map","import { createContext } from 'preact';\nconst RadioGroupContext = createContext(null);\nexport default RadioGroupContext;\n//# sourceMappingURL=RadioGroupContext.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/RadioGroup.tsx\";\nimport classnames from 'classnames';\nimport { useContext, useRef } from 'preact/hooks';\nimport { useArrowKeyNavigation } from '../../hooks/use-arrow-key-navigation';\nimport { RadioCheckedIcon, RadioIcon } from '../icons';\nimport RadioGroupContext from './RadioGroupContext';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\nfunction Radio({\n  value,\n  children,\n  subtitle,\n  disabled: radioDisabled\n}) {\n  const radioGroupContext = useContext(RadioGroupContext);\n  if (!radioGroupContext) {\n    throw new Error('RadioGroup.Radio can only be used as RadioGroup child');\n  }\n  const {\n    selected,\n    disabled = radioDisabled,\n    onChange\n  } = radioGroupContext;\n  const isSelected = !disabled && selected === value;\n  return _jsxDEV(\"div\", {\n    role: \"radio\",\n    \"aria-checked\": isSelected,\n    \"aria-disabled\": disabled,\n    className: classnames('focus-visible-ring rounded-lg px-3 py-2 flex-1 group', {\n      'bg-grey-3/50': isSelected,\n      'hover:bg-grey-3/25': !isSelected && !disabled,\n      'opacity-70': disabled,\n      'cursor-pointer': !disabled\n    }),\n    \"data-value\": value,\n    onClick: !disabled ? () => onChange(value) : undefined,\n    onKeyDown: disabled ? undefined : e => {\n      if (['Enter', ' '].includes(e.key)) {\n        e.preventDefault();\n        onChange(value);\n      }\n    },\n    tabIndex: -1,\n    children: [_jsxDEV(\"div\", {\n      className: \"flex items-center gap-x-1.5\",\n      children: [isSelected ? _jsxDEV(RadioCheckedIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 23\n      }, this) : _jsxDEV(RadioIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 46\n      }, this), children]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), subtitle && _jsxDEV(\"div\", {\n      className: classnames('pl-4 ml-1.5 mt-1 text-sm', {\n        'text-grey-7': isSelected,\n        'text-grey-6 group-hover:text-grey-7': !isSelected && !disabled\n      }),\n      children: subtitle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, this);\n}\nRadio.displayName = 'RadioGroup.Radio';\nfunction RadioGroupMain({\n  direction = 'horizontal',\n  children,\n  selected,\n  onChange,\n  disabled,\n  'aria-label': label,\n  'aria-labelledby': labelledBy,\n  name\n}) {\n  const containerRef = useRef(null);\n  useArrowKeyNavigation(containerRef, {\n    loop: false,\n    selector: '[role=\"radio\"]:not([aria-disabled=\"true\"])',\n    focusElement: el => {\n      onChange(el.dataset.value);\n      el.focus();\n    }\n  });\n  return _jsxDEV(RadioGroupContext.Provider, {\n    value: {\n      selected,\n      disabled,\n      onChange: onChange\n    },\n    children: [_jsxDEV(\"div\", {\n      \"aria-label\": label,\n      \"aria-labelledby\": labelledBy,\n      ref: containerRef,\n      role: \"radiogroup\",\n      className: classnames('w-full flex gap-1.5', {\n        'flex-col': direction === 'vertical'\n      }),\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), name && _jsxDEV(\"input\", {\n      type: \"hidden\",\n      \"data-testid\": \"hidden-input\",\n      name: name,\n      value: selected,\n      disabled: disabled\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n}\nconst RadioGroup = Object.assign(RadioGroupMain, {\n  Radio,\n  displayName: 'RadioGroup'\n});\nexport default RadioGroup;\n//# sourceMappingURL=RadioGroup.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/feedback/Popover.tsx\";\nimport classnames from 'classnames';\nimport { useCallback, useEffect, useLayoutEffect } from 'preact/hooks';\nimport { useClickAway } from '../../hooks/use-click-away';\nimport { useKeyPress } from '../../hooks/use-key-press';\nimport { useSyncedRef } from '../../hooks/use-synced-ref';\nimport { ListenerCollection } from '../../util/listener-collection';\nimport { downcastRef } from '../../util/typing';\n\n/** Small space to apply between the anchor element and the popover */\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\nconst POPOVER_ANCHOR_EL_GAP = '.15rem';\n\n/**\n * Space in pixels to apply between the popover and the viewport sides to\n * prevent it from growing to the very edges.\n */\nexport const POPOVER_VIEWPORT_HORIZONTAL_GAP = 8;\n/**\n * Manages the popover position manually to make sure it renders \"next\" to the\n * anchor element (above or below). This is mainly needed when using the\n * popover API, as that makes it render in the top layer, making it impossible\n * to position it relative to the anchor element via regular CSS.\n *\n * @param asNativePopover - Native popover API is used to toggle the popover\n * @param alignToRight - Whether the popover should be aligned to the right side\n *                       of the anchor element or not\n */\nfunction usePopoverPositioning(anchorElementRef, popoverRef, popoverOpen, asNativePopover, alignToRight) {\n  const adjustPopoverPositioning = useCallback(() => {\n    const popoverEl = popoverRef.current;\n    const anchorEl = anchorElementRef.current;\n\n    /**\n     * Set the positioning styles synchronously (not via <div style={computedStyles} />),\n     * to make sure positioning happens before other side effects.\n     * @return - A callback that undoes the property assignments\n     */\n    const setPopoverCSSProps = props => {\n      Object.assign(popoverEl.style, props);\n      const keys = Object.keys(props);\n      return () => keys.map(prop => popoverEl.style[prop] = '');\n    };\n    const viewportHeight = window.innerHeight;\n    const {\n      top: anchorElDistanceToTop,\n      bottom: anchorElBottom,\n      left: anchorElLeft,\n      height: anchorElHeight,\n      width: anchorElWidth\n    } = anchorEl.getBoundingClientRect();\n    const anchorElDistanceToBottom = viewportHeight - anchorElBottom;\n    const {\n      height: popoverHeight,\n      width: popoverWidth\n    } = popoverEl.getBoundingClientRect();\n\n    // The popover should render above only if there's not enough space below to\n    // fit it and there's more absolute space above than below\n    const shouldBeAbove = anchorElDistanceToBottom < popoverHeight && anchorElDistanceToTop > anchorElDistanceToBottom;\n    if (!asNativePopover) {\n      // Set styles for non-popover mode\n      if (shouldBeAbove) {\n        return setPopoverCSSProps({\n          bottom: '100%',\n          marginBottom: POPOVER_ANCHOR_EL_GAP\n        });\n      }\n      return setPopoverCSSProps({\n        top: '100%',\n        marginTop: POPOVER_ANCHOR_EL_GAP\n      });\n    }\n    const {\n      top: bodyTop,\n      width: bodyWidth\n    } = document.body.getBoundingClientRect();\n    const absBodyTop = Math.abs(bodyTop);\n\n    // The available space is:\n    // - left-aligned popovers: distance from left side of anchor element to\n    //   right side of viewport\n    // - right-aligned popovers: distance from right side of anchor element to\n    //   left side of viewport\n    const availableSpace = (alignToRight ? anchorElLeft + anchorElWidth : bodyWidth - anchorElLeft) - POPOVER_VIEWPORT_HORIZONTAL_GAP;\n    let left = anchorElLeft;\n    if (popoverWidth > availableSpace) {\n      // If the popover is not going to fit the available space, let it \"grow\"\n      // in the opposite direction\n      left = alignToRight ? POPOVER_VIEWPORT_HORIZONTAL_GAP : left - (popoverWidth - availableSpace);\n    } else if (alignToRight && popoverWidth > anchorElWidth) {\n      // If a right-aligned popover fits the available space, but it's bigger\n      // than the anchor element, move it to the left so that it is aligned with\n      // the right side of the element\n      left -= popoverWidth - anchorElWidth;\n    }\n    return setPopoverCSSProps({\n      minWidth: `${anchorElWidth}px`,\n      top: shouldBeAbove ? `calc(${absBodyTop + anchorElDistanceToTop - popoverHeight}px - ${POPOVER_ANCHOR_EL_GAP})` : `calc(${absBodyTop + anchorElDistanceToTop + anchorElHeight}px + ${POPOVER_ANCHOR_EL_GAP})`,\n      left: `${Math.max(POPOVER_VIEWPORT_HORIZONTAL_GAP, left)}px`\n    });\n  }, [asNativePopover, anchorElementRef, popoverRef, alignToRight]);\n  useLayoutEffect(() => {\n    if (!popoverOpen) {\n      return () => {};\n    }\n\n    // First of all, open popover if it's using the native API, otherwise its\n    // size is 0x0 and positioning calculations won't work.\n    const popover = popoverRef.current;\n    if (asNativePopover) {\n      popover.togglePopover(true);\n    }\n    const cleanup = adjustPopoverPositioning();\n    if (!asNativePopover) {\n      return cleanup;\n    }\n\n    // Readjust popover position when any element scrolls, just in case that\n    // affected the anchor element position.\n    const listeners = new ListenerCollection();\n    listeners.add(document.body, 'scroll', adjustPopoverPositioning, {\n      capture: true\n    });\n\n    // Readjust popover positioning if its resized, in case it dropped-up, and\n    // it needs to be moved down\n    const observer = new ResizeObserver(adjustPopoverPositioning);\n    observer.observe(popover);\n    return () => {\n      if (asNativePopover) {\n        popover === null || popover === void 0 || popover.togglePopover(false);\n      }\n      cleanup();\n      listeners.removeAll();\n      observer.disconnect();\n    };\n  }, [adjustPopoverPositioning, asNativePopover, popoverOpen, popoverRef]);\n}\n\n/**\n * Add the right listeners to the popover so that `onClose` is called when\n * clicking away or pressing `Escape`.\n */\nfunction useOnClose(popoverRef, anchorElementRef, onClose, popoverOpen, asNativePopover) {\n  // When the popover API is used, listen for the `toggle` event and call\n  // onClose() when transitioning from `open` to `closed`.\n  // This happens when clicking away or pressing `Escape` key.\n  useEffect(() => {\n    if (!asNativePopover) {\n      return () => {};\n    }\n    const popover = popoverRef.current;\n    const toggleListener = e => {\n      if (e.oldState === 'open' && e.newState === 'closed') {\n        onClose();\n      }\n    };\n    popover.addEventListener('toggle', toggleListener);\n    return () => popover.removeEventListener('toggle', toggleListener);\n  }, [asNativePopover, onClose, popoverRef]);\n\n  // When the popover API is not used, manually add listeners for Escape key\n  // press and click away, to mimic the native popover behavior.\n  // Disable these while the popover is closed, otherwise trying to open it\n  // by interacting with some other element will trigger a click-away and\n  // immediately close the popover after it opens..\n  const enabled = popoverOpen && !asNativePopover;\n  useClickAway(popoverRef, e => {\n    // Ignore clicking \"away\" when the target is the anchor element.\n    // In most cases, popovers will be anchored to a \"toggle\" which is\n    // supposed to open/close the popover on click, so closing-on-click-away\n    // when they are the target will cause the popover to close and\n    // immediately open again.\n    if (!e.composedPath().includes(anchorElementRef.current)) {\n      onClose();\n    }\n  }, {\n    enabled\n  });\n  useKeyPress(['Escape'], onClose, {\n    enabled\n  });\n}\n/**\n * Restore focus to the previously active element when a popover is closed.\n */\nfunction useRestoreFocusOnClose({\n  popoverRef,\n  open\n}) {\n  useLayoutEffect(() => {\n    const container = popoverRef.current;\n    const restoreFocusTo = open ? document.activeElement : null;\n    if (!container || !restoreFocusTo) {\n      return () => {};\n    }\n    return () => {\n      // When a popover is opened and then closed, there are several\n      // possibilities for what happens to the focus:\n      //\n      // 1. The focus may be unchanged from before the popover was opened.\n      //\n      // 2. The focus may have moved into the popover when it was opened, and\n      //    then back to either the previously focused element or the body when\n      //    it was closed.\n      //\n      //    When a native popover is closed via `togglePopover` or `hidePopover`,\n      //    focus will revert to the element that was focused at the time the\n      //    popover was shown. See https://html.spec.whatwg.org/multipage/popover.html#dom-hidepopover.\n      //\n      // 3. The user may have clicked an element outside the popover, focusing\n      //    that element and causing the popover to close.\n      //\n      // From the above cases, we only need to restore focus if it is still\n      // inside the popover, or focus reverted to the document body.\n      const currentFocus = document.activeElement;\n      if (currentFocus && !container.contains(currentFocus) && currentFocus !== document.body) {\n        return;\n      }\n      restoreFocusTo.focus();\n    };\n  }, [popoverRef, open]);\n}\nexport default function Popover({\n  anchorElementRef,\n  children,\n  open,\n  onClose,\n  align = 'left',\n  classes,\n  variant = 'panel',\n  onScroll,\n  elementRef,\n  /* eslint-disable-next-line no-prototype-builtins */\n  asNativePopover = HTMLElement.prototype.hasOwnProperty('popover')\n}) {\n  const popoverRef = useSyncedRef(elementRef);\n  usePopoverPositioning(anchorElementRef, popoverRef, open, asNativePopover, align === 'right');\n  useOnClose(popoverRef, anchorElementRef, onClose, open, asNativePopover);\n  useRestoreFocusOnClose({\n    open,\n    popoverRef: popoverRef\n  });\n  return _jsxDEV(\"div\", {\n    className: classnames('absolute z-5', variant === 'panel' && ['max-h-80 overflow-y-auto overflow-x-hidden', 'rounded border bg-white shadow hover:shadow-md focus-within:shadow-md'], asNativePopover && [\n    // We don't want the popover to ever render outside the viewport,\n    // and we give it a 16px gap\n    'max-w-[calc(100%-16px)]',\n    // Overwrite [popover] default styles\n    'p-0 m-0'], !asNativePopover && {\n      // Hiding instead of unmounting so that popover size can be computed\n      // to position it above or below\n      hidden: !open,\n      'right-0': align === 'right',\n      'min-w-full': true\n    }, classes),\n    ref: downcastRef(popoverRef),\n    popover: asNativePopover && 'auto',\n    onScroll: onScroll,\n    \"data-testid\": \"popover\",\n    \"data-component\": \"Popover\",\n    children: open && children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 356,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Popover.js.map","import { createContext } from 'preact';\nconst SelectContext = createContext(null);\nexport default SelectContext;\n//# sourceMappingURL=SelectContext.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/input/Select.tsx\";\nimport classnames from 'classnames';\nimport { useCallback, useContext, useId, useMemo, useRef, useState } from 'preact/hooks';\nimport { useArrowKeyNavigation } from '../../hooks/use-arrow-key-navigation';\nimport { useFocusAway } from '../../hooks/use-focus-away';\nimport { useSyncedRef } from '../../hooks/use-synced-ref';\nimport { downcastRef } from '../../util/typing';\nimport Popover from '../feedback/Popover';\nimport { CheckboxCheckedFilledIcon, CheckIcon, MenuCollapseIcon, MenuExpandIcon } from '../icons';\nimport Checkbox from './Checkbox';\nimport { inputGroupStyles } from './InputGroup';\nimport SelectContext from './SelectContext';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\nfunction optionChildren(children, status) {\n  if (typeof children === 'function') {\n    return children(status);\n  }\n  return children;\n}\nfunction SelectOption({\n  value,\n  children,\n  disabled = false,\n  classes,\n  elementRef,\n  title\n}) {\n  const checkboxRef = useRef(null);\n  const checkboxContainerRef = useRef(null);\n  const optionRef = useSyncedRef(elementRef);\n  const eventTriggeredInCheckbox = e => e.target === checkboxRef.current || e.target === checkboxContainerRef.current;\n  const selectContext = useContext(SelectContext);\n  if (!selectContext) {\n    throw new Error('Select.Option can only be used as Select or MultiSelect child');\n  }\n  const {\n    selectValue,\n    value: currentValue,\n    multiple\n  } = selectContext;\n  const selected = useMemo(() => {\n    if (disabled) {\n      return false;\n    }\n    if (!multiple) {\n      return currentValue === value;\n    }\n\n    // In multi-select, the option should be marked as selected for values\n    // which are explicitly part of the array, or for `undefined` values if the\n    // array is empty\n    return currentValue.includes(value) || currentValue.length === 0 && value === undefined;\n  }, [currentValue, disabled, multiple, value]);\n  const selectOneValue = useCallback(() => {\n    const options = {\n      closeListbox: true\n    };\n    if (!multiple) {\n      selectValue(value, options);\n    } else {\n      selectValue(value !== undefined ? [value] : [], options);\n    }\n  }, [multiple, selectValue, value]);\n  const toggleValue = useCallback(() => {\n    /* istanbul ignore next - This will never be invoked in single-select, but TS doesn't know it */\n    if (!multiple) {\n      return;\n    }\n    const options = {\n      // Close listbox only if selected value is a \"clear\" option. Clear options\n      // are those with `undefined` value\n      closeListbox: value === undefined\n    };\n\n    // In multi-select, clear selection for `undefined` values\n    if (value === undefined) {\n      selectValue([], options);\n      return;\n    }\n\n    // In multi-select, toggle clicked items\n    const index = currentValue.indexOf(value);\n    if (index === -1) {\n      selectValue([...currentValue, value], options);\n    } else {\n      const copy = [...currentValue];\n      copy.splice(index, 1);\n      selectValue(copy, options);\n    }\n  }, [currentValue, multiple, selectValue, value]);\n  return _jsxDEV(\"li\", {\n    className: classnames('w-full ring-inset outline-none rounded-none select-none', 'px-1 mb-1 first:mt-1 whitespace-nowrap group', {\n      'text-grey-4': disabled,\n      'cursor-pointer': !disabled\n    }, classes),\n    onClick: e => {\n      if (!disabled &&\n      // Do not invoke callback if clicked element is the checkbox or its\n      // container, as it has its own event handler.\n      !eventTriggeredInCheckbox(e)) {\n        selectOneValue();\n      }\n    },\n    onKeyDown: e => {\n      if (disabled) {\n        return;\n      }\n      if (['Enter', ' '].includes(e.key) &&\n      // Do not invoke callback if event triggered in the checkbox or its\n      // container, as it has its own event handler.\n      !eventTriggeredInCheckbox(e)) {\n        e.preventDefault();\n        selectOneValue();\n      } else if (checkboxRef.current && e.key === 'ArrowRight') {\n        e.preventDefault();\n        checkboxRef.current.focus();\n      }\n    },\n    role: \"option\",\n    \"aria-disabled\": disabled,\n    \"aria-selected\": selected\n    // Set tabIndex to 0 for selected option, so that useArrowKeyNavigation\n    // initially focuses it\n    ,\n    tabIndex: selected ? 0 : -1,\n    ref: downcastRef(optionRef),\n    title: title,\n    children: _jsxDEV(\"div\", {\n      className: classnames('flex justify-between items-center', 'w-full rounded', {\n        'hover:bg-grey-1 group-focus-visible:ring': !disabled,\n        'bg-grey-1 hover:bg-grey-2': selected\n      }),\n      children: [_jsxDEV(\"div\", {\n        className: classnames('py-2 pl-3', {\n          truncate: selectContext.listboxOverflow === 'truncate',\n          'whitespace-normal': selectContext.listboxOverflow === 'wrap'\n        }),\n        children: optionChildren(children, {\n          selected,\n          disabled\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), !multiple && _jsxDEV(\"div\", {\n        className: \"px-3\",\n        children: _jsxDEV(CheckIcon, {\n          className: classnames('text-grey-6 scale-125', {\n            // Make the icon visible/invisible, instead of conditionally\n            // rendering it, to ensure consistent spacing among selected and\n            // non-selected options\n            'opacity-0': !selected\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 11\n      }, this), multiple && _jsxDEV(Checkbox, {\n        containerClasses: classnames(\n        // Make the checkbox stretch, so that its actionable surface spans\n        // to the very edges of the option containing it.\n        'self-stretch px-3',\n        // The checkbox is sized based on the container's font size. Make\n        // it a bit larger.\n        'text-lg', {\n          'text-grey-6': selected,\n          'text-grey-3 hover:text-grey-6': !selected\n        }),\n        checked: selected,\n        checkedIcon: CheckboxCheckedFilledIcon,\n        elementRef: checkboxRef,\n        containerRef: checkboxContainerRef,\n        onChange: toggleValue,\n        onKeyDown: e => {\n          if (e.key === 'ArrowLeft') {\n            var _optionRef$current;\n            e.preventDefault();\n            (_optionRef$current = optionRef.current) === null || _optionRef$current === void 0 || _optionRef$current.focus();\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 146,\n    columnNumber: 5\n  }, this);\n}\nSelectOption.displayName = 'Select.Option';\nfunction SelectMain({\n  buttonContent,\n  value,\n  onChange,\n  children,\n  disabled,\n  elementRef,\n  buttonId,\n  buttonClasses,\n  popoverClasses,\n  containerClasses,\n  onPopoverScroll,\n  alignListbox = 'left',\n  multiple,\n  listboxOverflow = 'truncate',\n  'aria-label': ariaLabel,\n  'aria-labelledby': ariaLabelledBy,\n  listboxAsPopover\n}) {\n  const wrapperRef = useRef(null);\n  const listboxRef = useRef(null);\n  const [listboxOpen, setListboxOpen] = useState(false);\n  const closeListbox = useCallback(() => setListboxOpen(false), [setListboxOpen]);\n  const listboxId = useId();\n  const buttonRef = useSyncedRef(elementRef);\n  const defaultButtonId = useId();\n  const selectValue = useCallback((value, options) => {\n    onChange(value);\n    if (options.closeListbox) {\n      closeListbox();\n    }\n  }, [onChange, closeListbox]);\n\n  // Close the listbox when focusing away\n  useFocusAway(wrapperRef, closeListbox);\n\n  // Vertical arrow key for options in the listbox\n  useArrowKeyNavigation(listboxRef, {\n    horizontal: false,\n    loop: false,\n    autofocus: true,\n    containerVisible: listboxOpen,\n    selector: '[role=\"option\"]:not([aria-disabled=\"true\"])'\n  });\n  return _jsxDEV(\"div\", {\n    className: classnames('relative w-full border rounded', {\n      'border-grey-5': listboxOpen\n    }, inputGroupStyles, containerClasses),\n    ref: wrapperRef,\n    children: [_jsxDEV(\"button\", {\n      id: buttonId !== null && buttonId !== void 0 ? buttonId : defaultButtonId,\n      className: classnames('focus-visible-ring transition-colors whitespace-nowrap', 'w-full flex items-center justify-between gap-x-2', 'bg-grey-0 disabled:bg-grey-1 disabled:text-grey-6',\n      // Buttons are center-aligned by default. Overwrite it.\n      'text-left',\n      // Add inherited rounded corners so that the toggle is consistent with\n      // the wrapper, which is the element rendering borders.\n      // Using overflow-hidden in the parent is not an option here, because\n      // that would hide the listbox\n      'rounded-[inherit]', buttonClasses),\n      type: \"button\",\n      role: \"combobox\",\n      disabled: disabled,\n      \"aria-expanded\": listboxOpen,\n      \"aria-haspopup\": \"listbox\",\n      \"aria-controls\": listboxId,\n      \"aria-label\": ariaLabel,\n      \"aria-labelledby\": ariaLabelledBy,\n      ref: downcastRef(buttonRef),\n      onClick: () => setListboxOpen(prev => !prev),\n      onKeyDown: e => {\n        if (e.key === 'ArrowDown' && !listboxOpen) {\n          e.preventDefault();\n          setListboxOpen(true);\n        }\n      },\n      \"data-testid\": \"select-toggle-button\",\n      children: [_jsxDEV(\"div\", {\n        className: \"pl-2 py-2 truncate grow\",\n        children: buttonContent\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 9\n      }, this), _jsxDEV(\"div\", {\n        className: \"pr-2 py-2 text-grey-6\",\n        children: listboxOpen ? _jsxDEV(MenuCollapseIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 26\n        }, this) : _jsxDEV(MenuExpandIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 49\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 7\n    }, this), _jsxDEV(SelectContext.Provider, {\n      value: {\n        // Explicit type casting needed here\n        value: value,\n        selectValue,\n        multiple,\n        listboxOverflow\n      },\n      children: _jsxDEV(Popover, {\n        anchorElementRef: wrapperRef,\n        open: listboxOpen,\n        onClose: closeListbox,\n        asNativePopover: listboxAsPopover,\n        align: alignListbox,\n        classes: popoverClasses,\n        onScroll: onPopoverScroll,\n        children: _jsxDEV(\"ul\", {\n          role: \"listbox\",\n          id: listboxId,\n          ref: listboxRef,\n          \"aria-multiselectable\": multiple,\n          \"aria-labelledby\": buttonId !== null && buttonId !== void 0 ? buttonId : defaultButtonId,\n          \"aria-orientation\": \"vertical\",\n          children: children\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 387,\n    columnNumber: 5\n  }, this);\n}\nexport const Select = Object.assign(\n// eslint-disable-next-line prefer-arrow-callback\nfunction (props) {\n  // Calling the function directly instead of returning a JSX element, to\n  // avoid an unnecessary extra layer in the component tree\n  // eslint-disable-next-line new-cap\n  return SelectMain({\n    ...props,\n    multiple: false\n  });\n}, {\n  Option: SelectOption,\n  displayName: 'Select'\n});\nexport const MultiSelect = Object.assign(\n// eslint-disable-next-line prefer-arrow-callback\nfunction (props) {\n  // Calling the function directly instead of returning a JSX element, to\n  // avoid an unnecessary extra layer in the component tree\n  // eslint-disable-next-line new-cap\n  return SelectMain({\n    ...props,\n    multiple: true\n  });\n}, {\n  Option: SelectOption,\n  displayName: 'MultiSelect'\n});\n//# sourceMappingURL=Select.js.map","import { createContext } from 'preact';\nconst TableContext = createContext({});\nexport default TableContext;\n//# sourceMappingURL=TableContext.js.map","import { createContext } from 'preact';\nconst TableSectionContext = createContext(null);\nexport default TableSectionContext;\n//# sourceMappingURL=TableSectionContext.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/feedback/Spinner.tsx\";\nimport classnames from 'classnames';\nimport { SpinnerSpokesIcon } from '../icons';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Style a spinner icon.\n */\nexport default function Spinner({\n  size = 'sm',\n  color = 'text-light'\n}) {\n  return _jsxDEV(SpinnerSpokesIcon, {\n    className: classnames({\n      'text-color-text-light': color === 'text-light',\n      // default\n      'text-color-text': color === 'text',\n      'text-color-text-inverted': color === 'text-inverted'\n    }, {\n      'w-em h-em': size === 'sm',\n      // default\n      'w-2em h-2em': size === 'md',\n      'w-4em h-4em': size === 'lg'\n    }),\n    \"data-component\": \"Spinner\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 18,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Spinner.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/feedback/Callout.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { CautionIcon, CheckIcon, CancelIcon } from '../icons';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a banner-like alert message with corresponding icon and coloring\n */\nexport default function Callout({\n  children,\n  classes,\n  elementRef,\n  icon: Icon,\n  status = 'notice',\n  size = 'md',\n  variant = 'outlined',\n  unstyled = false,\n  ...htmlAttributes\n}) {\n  const styled = !unstyled;\n  const themed = styled && variant !== 'custom';\n  const sized = styled && size !== 'custom';\n  let StatusIcon = Icon;\n  if (!StatusIcon) {\n    switch (status) {\n      case 'success':\n        StatusIcon = CheckIcon;\n        break;\n      case 'error':\n        StatusIcon = CancelIcon;\n        break;\n      default:\n        StatusIcon = CautionIcon;\n        break;\n    }\n  }\n\n  // Only render an icon if no custom styling API props have been set.\n  const withIcon = themed && sized;\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"Callout\",\n    ...htmlAttributes,\n    ref: downcastRef(elementRef),\n    className: classnames(styled && 'flex items-center border', themed && {\n      'rounded border': true,\n      'shadow hover:shadow-md cursor-pointer': variant === 'raised',\n      'border-yellow-notice': status === 'notice',\n      'border-green-success': status === 'success',\n      'border-red-error': status === 'error'\n    },\n    // Set background color, but only if rendering an icon\n    themed && {\n      'bg-yellow-notice': status === 'notice' && withIcon,\n      'bg-green-success': status === 'success' && withIcon,\n      'bg-red-error': status === 'error' && withIcon,\n      'bg-white': !withIcon\n    }, classes),\n    children: [withIcon && _jsxDEV(\"div\", {\n      className: classnames({\n        'p-2': size === 'md',\n        'p-1.5': size === 'sm',\n        'p-3': size === 'lg'\n      }),\n      children: _jsxDEV(StatusIcon, {\n        \"data-testid\": \"callout-icon\",\n        className: classnames('text-white', {\n          'w-[1.25em] h-[1.25em]': size === 'md',\n          // default\n          'w-[0.85em] h-[0.85em]': size === 'sm',\n          'w-[1.5em] h-[1.5em]': size === 'lg'\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this), _jsxDEV(\"div\", {\n      className: classnames(sized && {\n        'p-2': size === 'md',\n        // default\n        'py-1.5 px-2': size === 'sm',\n        'p-3': size === 'lg'\n      }, styled && 'grow', themed && 'bg-white rounded-r'),\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Callout.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/feedback/ToastMessages.tsx\";\nimport classnames from 'classnames';\nimport { useCallback, useLayoutEffect, useMemo, useRef, useState } from 'preact/hooks';\nimport Callout from './Callout';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * An individual toast message: a brief and transient success or error message.\n * The message may be dismissed by clicking on it. `visuallyHidden` toast\n * messages will not be visible but are still available to screen readers.\n */\nfunction ToastMessageItem({\n  message,\n  onDismiss\n}) {\n  return _jsxDEV(Callout, {\n    classes: classnames({\n      'sr-only': message.visuallyHidden\n    }),\n    status: message.type,\n    onClick: () => onDismiss(message.id),\n    variant: \"raised\",\n    children: message.message\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n}\nconst ToastMessageTransition = ({\n  direction,\n  onTransitionEnd,\n  children,\n  transitionClasses = {}\n}) => {\n  const isDismissed = direction === 'out';\n  const containerRef = useRef(null);\n  const handleAnimation = e => {\n    // Ignore animations happening on child elements\n    if (e.target !== containerRef.current) {\n      return;\n    }\n    onTransitionEnd === null || onTransitionEnd === void 0 || onTransitionEnd(direction !== null && direction !== void 0 ? direction : 'in');\n  };\n  const classes = useMemo(() => {\n    const {\n      transitionIn = 'animate-fade-in',\n      transitionOut = 'animate-fade-out'\n    } = transitionClasses;\n    return {\n      [transitionIn]: !isDismissed,\n      [transitionOut]: isDismissed\n    };\n  }, [isDismissed, transitionClasses]);\n  return _jsxDEV(\"div\", {\n    \"data-testid\": \"animation-container\",\n    onAnimationEnd: handleAnimation,\n    ref: containerRef,\n    className: classnames('relative w-full container', classes),\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n/**\n * A collection of toast messages. These are rendered within an `aria-live`\n * region for accessibility with screen readers.\n */\nexport default function ToastMessages({\n  messages,\n  onMessageDismiss,\n  transitionClasses,\n  /* istanbul ignore next - test seam */\n  setTimeout_ = setTimeout\n}) {\n  // List of IDs of toast messages that have been dismissed and have an\n  // in-progress 'out' transition\n  const [dismissedMessages, setDismissedMessages] = useState([]);\n  // Tracks not finished timeouts for auto-dismiss toast messages\n  const messageSchedules = useRef(new Map());\n  const dismissMessage = useCallback(id => setDismissedMessages(ids => [...ids, id]), []);\n  const scheduleMessageDismiss = useCallback(id => {\n    const timeout = setTimeout_(() => {\n      dismissMessage(id);\n      messageSchedules.current.delete(id);\n    }, 5000);\n    messageSchedules.current.set(id, timeout);\n  }, [dismissMessage, setTimeout_]);\n  const onTransitionEnd = useCallback((direction, message) => {\n    var _message$autoDismiss;\n    const autoDismiss = (_message$autoDismiss = message.autoDismiss) !== null && _message$autoDismiss !== void 0 ? _message$autoDismiss : true;\n    if (direction === 'in' && autoDismiss) {\n      scheduleMessageDismiss(message.id);\n    }\n    if (direction === 'out') {\n      onMessageDismiss(message.id);\n      setDismissedMessages(ids => ids.filter(id => id !== message.id));\n    }\n  }, [scheduleMessageDismiss, onMessageDismiss]);\n  useLayoutEffect(() => {\n    // Clear all pending timeouts for not yet dismissed toast messages when the\n    // component is unmounted\n    const pendingTimeouts = messageSchedules.current;\n    return () => {\n      pendingTimeouts.forEach(timeout => clearTimeout(timeout));\n    };\n  }, []);\n  return _jsxDEV(\"ul\", {\n    \"aria-live\": \"polite\",\n    \"aria-relevant\": \"additions\",\n    className: \"w-full space-y-2\",\n    \"data-component\": \"ToastMessages\",\n    children: messages.map(message => {\n      const isDismissed = dismissedMessages.includes(message.id);\n      return _jsxDEV(\"li\", {\n        className: classnames({\n          // Add a bottom margin to visible messages only. Typically, we'd\n          // use a `space-y-2` class on the parent to space children.\n          // Doing that here could cause an undesired top margin on\n          // the first visible message in a list that contains (only)\n          // visually-hidden messages before it.\n          // See https://tailwindcss.com/docs/space#limitations\n          'mb-2': !message.visuallyHidden\n        }),\n        children: _jsxDEV(ToastMessageTransition, {\n          direction: isDismissed ? 'out' : 'in',\n          onTransitionEnd: direction => onTransitionEnd(direction, message),\n          transitionClasses: transitionClasses,\n          children: _jsxDEV(ToastMessageItem, {\n            message: message,\n            onDismiss: dismissMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 13\n        }, this)\n      }, message.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 180,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=ToastMessages.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/navigation/Link.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Styled component for a link (`<a>` element).\n */\nexport default function Link({\n  children,\n  classes,\n  elementRef,\n  underline = 'none',\n  unstyled = false,\n  variant = 'brand',\n  ...htmlAttributes\n}) {\n  const styled = !unstyled;\n  const themed = styled && variant !== 'custom';\n  return _jsxDEV(\"a\", {\n    \"data-component\": \"Link\",\n    rel: \"noopener noreferrer\",\n    ...htmlAttributes,\n    className: classnames(styled && {\n      'focus-visible-ring rounded': true,\n      // underline\n      // TODO: Underline should be controlled by `variant` and should default\n      // to `always`\n      'no-underline hover:no-underline': underline === 'none',\n      // default\n      'underline hover:underline': underline === 'always',\n      'no-underline hover:underline': underline === 'hover'\n    }, themed && {\n      // color\n      'text-brand hover:text-brand-dark': variant === 'brand',\n      // default\n      'text-color-text-light hover:text-brand': variant === 'text-light',\n      'text-color-text hover:text-brand-dark': variant === 'text'\n    }, classes),\n    ref: downcastRef(elementRef),\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 37,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Link.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/navigation/LinkButton.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport Button from '../input/Button';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Style a button as a link\n */\nexport default function LinkButton({\n  children,\n  classes,\n  elementRef,\n  inline = false,\n  underline = 'none',\n  variant = 'brand',\n  unstyled = false,\n  ...htmlAttributes\n}) {\n  const styled = !unstyled;\n  const themed = styled && variant !== 'custom';\n  return _jsxDEV(Button, {\n    \"data-component\": \"LinkButton\",\n    ...htmlAttributes,\n    elementRef: downcastRef(elementRef),\n    classes: classnames(styled && {\n      'focus-visible-ring transition-colors whitespace-nowrap rounded': true,\n      inline: inline,\n      'flex items-center': !inline\n    }, styled && {\n      // underline\n      'no-underline hover:no-underline': underline === 'none',\n      // default\n      'underline enabled:hover:underline': underline === 'always',\n      'no-underline enabled:hover:underline': underline === 'hover'\n    }, themed && {\n      'aria-pressed:font-semibold aria-expanded:font-semibold': true,\n      'text-brand enabled:hover:text-brand-dark': variant === 'brand',\n      // default\n      'text-color-text enabled:hover:text-brand-dark': variant === 'text',\n      'text-color-text-light enabled:hover:text-brand': variant === 'text-light'\n    }, classes),\n    unstyled: true,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=LinkButton.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/navigation/Pagination.tsx\";\nimport classnames from 'classnames';\nimport { paginationItems } from '../../util/pagination';\nimport { ArrowLeftIcon, ArrowRightIcon } from '../icons';\nimport Button from '../input/Button';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\nfunction NavigationButton({\n  children,\n  invisible = false,\n  pressed = false,\n  onClick,\n  title\n}) {\n  return _jsxDEV(Button, {\n    classes: classnames('px-3.5 py-2.5 gap-x-1', 'font-semibold rounded',\n    // These colors are the same as the \"dark\" variant of IconButton\n    'text-grey-7 enabled:hover:text-grey-9 enabled:hover:bg-grey-3', 'disabled:text-grey-5 aria-pressed:bg-grey-3 aria-expanded:bg-grey-3',\n    // Disabled navigation buttons are rendered as invisible and disabled\n    // rather than removed so that the overall width of the component and\n    // positions of child controls doesn't change too much when navigating\n    // between pages.\n    invisible && 'invisible'),\n    disabled: invisible,\n    onClick: onClick,\n    pressed: pressed,\n    size: \"custom\",\n    title: title,\n    variant: \"custom\",\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 24,\n    columnNumber: 5\n  }, this);\n}\n/**\n * Render controls for navigating between pages in a paginated list of items.\n *\n * Buttons corresponding to nearby pages are shown on wider screens; for narrow\n * screens only Prev and Next buttons are shown.\n */\nexport default function Pagination({\n  currentPage,\n  onChangePage,\n  totalPages\n}) {\n  // Pages are 1-indexed\n  const hasNextPage = currentPage < totalPages;\n  const hasPreviousPage = currentPage > 1;\n  const pageNumbers = paginationItems(currentPage, totalPages);\n  const changePageTo = (pageNumber, element) => {\n    onChangePage(pageNumber);\n    // Because changing pagination page doesn't reload the page (as it would\n    // in a \"traditional\" HTML context), the clicked-upon navigation button\n    // will awkwardly retain focus unless it is actively removed.\n    // TODO: Evaluate this for a11y issues\n    element.blur();\n  };\n  return _jsxDEV(\"div\", {\n    className: \"flex items-center text-md select-none\",\n    \"data-testid\": \"pagination-navigation\",\n    children: [_jsxDEV(\"div\", {\n      className: \"mr-2\",\n      children: _jsxDEV(NavigationButton, {\n        invisible: !hasPreviousPage,\n        title: \"Go to previous page\",\n        onClick: e => changePageTo(currentPage - 1, e.target),\n        children: [_jsxDEV(ArrowLeftIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this), \"prev\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), _jsxDEV(\"ul\", {\n      className: classnames(\n      // Where there's enough horizontal space,\n      // lay out page navigation buttons horizontally between prev/next:\n      // | prevPage  |       numberedPages          | nextPage\n      //\n      // e.g.\n      // | [<- prev] | [2] ... [5] [6] [7] ... [10] | [next ->] |\n      //\n      // These page buttons are hidden on narrow screens\n      'hidden',\n      // For slightly wider screens, they are shown in a horizontal row\n      'md:flex md:items-center md:justify-center md:gap-x-2',\n      // when visible, this element should stretch to fill available space\n      'md:grow'),\n      children: pageNumbers.map((page, idx) => _jsxDEV(\"li\", {\n        children: page === null ?\n        // Indicator for elided pages. Should be approximately the same\n        // width as a small page number. This reduces the variation of\n        // the component's width as the current page is advanced.\n        //\n        // Navigation buttons have `px-3.5`. This uses `px-3` since\n        // an ellipsis is slightly wider than a digit.\n        _jsxDEV(\"div\", {\n          className: \"px-3 text-center\",\n          \"data-testid\": \"pagination-gap\",\n          children: \"\\u2026\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 15\n        }, this) : _jsxDEV(NavigationButton, {\n          title: `Go to page ${page}`,\n          pressed: page === currentPage,\n          onClick: e => changePageTo(page, e.target),\n          children: page.toString()\n        }, `page-${idx}`, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 15\n        }, this)\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), _jsxDEV(\"div\", {\n      className: classnames('ml-2 flex justify-end',\n      // When page buttons are not shown, this element should grow to fill\n      // available space. But when page buttons are shown, it should not.\n      'grow md:grow-0'),\n      children: _jsxDEV(NavigationButton, {\n        invisible: !hasNextPage,\n        title: \"Go to next page\",\n        onClick: e => changePageTo(currentPage + 1, e.target),\n        children: [\"next\", _jsxDEV(ArrowRightIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Pagination.js.map","/**\n * The number of an available pagination page, or `null`, indicating a gap\n * between sequential numbered pages.\n */\n\n/**\n * Determine the set of (pagination) page numbers that should be provided to\n * a user.\n *\n * The result includes a mixture of page numbers that should be shown, plus\n * `null` values indicating elided page numbers. The goals of the selection\n * are:\n *\n * - To always provide page numbers for the first, last and current pages.\n *   Additional adjacent pages are provided according to the `boundaryCount`\n *   and `siblingCount` options.\n * - To try and keep the number of pagination items consistent as the current\n *   page changes. If each item is rendered with approximately the same width,\n *   this keeps the overall width of the pagination component and the location\n *   of child controls consistent as the user navigates. This helps to avoid\n *   mis-clicks due to controls moving around under the cursor.\n *\n * @param currentPage - The 1-based currently-visible/-active page number.\n * @param totalPages - The total number of pages\n * @param options - Options for the number of pages to show at the boundary and\n *   around the current page.\n */\nexport function paginationItems(currentPage, totalPages, /* istanbul ignore next */\n{\n  boundaryCount = 1,\n  siblingCount = 1\n} = {}) {\n  if (totalPages <= 1) {\n    return [];\n  }\n  currentPage = Math.max(1, Math.min(currentPage, totalPages));\n  boundaryCount = Math.max(boundaryCount, 1);\n  siblingCount = Math.max(siblingCount, 0);\n  const pageNumbers = [];\n  const beforeCurrent = currentPage - 1;\n  const afterCurrent = totalPages - currentPage;\n  const elideBeforeCurrent = boundaryCount + siblingCount < beforeCurrent;\n  let elideBefore = null;\n  if (elideBeforeCurrent) {\n    for (let page = 1; page <= boundaryCount; page++) {\n      pageNumbers.push(page);\n    }\n    elideBefore = {\n      index: pageNumbers.length,\n      count: currentPage - siblingCount - boundaryCount,\n      // Last value in elided range, as we expand backwards\n      value: currentPage - siblingCount - 1\n    };\n    pageNumbers.push(null);\n    for (let page = currentPage - siblingCount; page < currentPage; page++) {\n      pageNumbers.push(page);\n    }\n  } else {\n    for (let page = 1; page < currentPage; page++) {\n      pageNumbers.push(page);\n    }\n  }\n  pageNumbers.push(currentPage);\n  const elideAfterCurrent = boundaryCount + siblingCount < afterCurrent;\n  let elideAfter = null;\n  if (elideAfterCurrent) {\n    for (let page = currentPage + 1; page <= currentPage + siblingCount; page++) {\n      pageNumbers.push(page);\n    }\n    elideAfter = {\n      index: pageNumbers.length,\n      count: totalPages - boundaryCount + 1 - (currentPage + siblingCount),\n      // First value in elided range, as we expand forwards\n      value: currentPage + siblingCount + 1\n    };\n    pageNumbers.push(null);\n    for (let page = totalPages - boundaryCount + 1; page <= totalPages; page++) {\n      pageNumbers.push(page);\n    }\n  } else {\n    for (let page = currentPage + 1; page <= totalPages; page++) {\n      pageNumbers.push(page);\n    }\n  }\n\n  // Calculate the maximum number of items we will show for the total number\n  // of pages and options.\n  const maxItems = Math.min(\n  // First and last pages\n  2 * boundaryCount +\n  // Pages adjacent to current page\n  2 * siblingCount +\n  // Current page, indicators for elided pages before and after current.\n  3, totalPages);\n\n  // To keep the number of items consistent as the current page changes,\n  // expand the elided ranges until we reach the maximum.\n  while (pageNumbers.length < maxItems && ((_elideAfter = elideAfter) !== null && _elideAfter !== void 0 && _elideAfter.count || (_elideBefore = elideBefore) !== null && _elideBefore !== void 0 && _elideBefore.count)) {\n    var _elideAfter, _elideBefore;\n    if (elideAfter && elideAfter.count > 0) {\n      // Expand ahead of current page if possible, starting with numbers closest\n      // to current page.\n      pageNumbers.splice(elideAfter.index, 0, elideAfter.value);\n      ++elideAfter.index;\n      ++elideAfter.value;\n      --elideAfter.count;\n    } else if (elideBefore) {\n      // Otherwise expand behind, starting with numbers closest to current page.\n      pageNumbers.splice(elideBefore.index + 1, 0, elideBefore.value);\n      --elideBefore.value;\n      --elideBefore.count;\n    }\n  }\n  return pageNumbers;\n}\n//# sourceMappingURL=pagination.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/navigation/Tab.tsx\";\nimport classnames from 'classnames';\nimport { downcastRef } from '../../util/typing';\nimport Button from '../input/Button';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a button with appropriate ARIA tab affordances\n */\nexport default function Tab({\n  children,\n  classes,\n  elementRef,\n  icon: Icon,\n  textContent,\n  selected = false,\n  size = 'md',\n  variant = 'text',\n  unstyled = false,\n  ...htmlAttributes\n}) {\n  const styled = !unstyled;\n  const themed = styled && variant !== 'custom';\n  const sized = styled && size !== 'custom';\n  return _jsxDEV(Button, {\n    \"data-component\": \"Tab\",\n    ...htmlAttributes,\n    classes: classnames(\n    // Buttons have a flex layout. Add a horizontal gap.\n    sized && 'gap-x-1.5', themed && {\n      'px-4 py-2': variant === 'tab' && sized,\n      'font-semibold text-grey-7 rounded-t-lg border border-transparent border-b-0': variant === 'tab',\n      'aria-selected:text-color-text aria-selected:bg-white': variant === 'tab',\n      'aria-selected:border aria-selected:border-grey-3 aria-selected:border-b-0': variant === 'tab',\n      'enabled:hover:text-color-text disabled:text-grey-7/50': variant === 'tab',\n      'enabled:hover:text-brand-dark': variant === 'text',\n      'aria-selected:font-bold': variant === 'text'\n    }, classes),\n    elementRef: downcastRef(elementRef),\n    \"aria-selected\": selected,\n    role: \"tab\",\n    variant: \"custom\",\n    size: \"custom\",\n    unstyled: unstyled,\n    children: [Icon && _jsxDEV(Icon, {\n      className: classnames(\n      // A small padding value here sizes the icon down slightly in relation\n      // to the tab text, which results in nicer proportions.\n      'p-[0.125em] w-em h-em')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }, this), _jsxDEV(\"span\", {\n      \"data-content\": textContent,\n      \"data-testid\": \"sizing-wrapper\",\n      className: classnames({\n        // Set the content of this span's ::before pseudo-element to\n        // `textContent` and make it bold.\n        'before:content-[attr(data-content)] before:font-bold': textContent,\n        // Make the ::before occupy space within the button, but make it\n        // invisible. This ensures that the tab button is wide enough to show\n        // bolded text even if the visible text is not currently bold. See\n        // https://css-tricks.com/bold-on-hover-without-the-layout-shift/\n        'before:block before:invisible before:h-0 before:overflow-hidden': textContent\n      }),\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=Tab.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/navigation/TabList.tsx\";\nimport classnames from 'classnames';\nimport { useArrowKeyNavigation } from '../../hooks/use-arrow-key-navigation';\nimport { useSyncedRef } from '../../hooks/use-synced-ref';\nimport { downcastRef } from '../../util/typing';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\n/**\n * Render a tablist container for a set of tabs, with arrow key navigation per\n * https://www.w3.org/WAI/ARIA/apg/patterns/tabpanel/\n */\nexport default function TabList({\n  children,\n  classes,\n  elementRef,\n  vertical = false,\n  ...htmlAttributes\n}) {\n  const tabListRef = useSyncedRef(elementRef);\n  useArrowKeyNavigation(tabListRef, {\n    selector: 'button',\n    horizontal: true,\n    vertical\n  });\n  return _jsxDEV(\"div\", {\n    \"data-component\": \"TabList\",\n    ...htmlAttributes,\n    ref: downcastRef(tabListRef),\n    className: classnames('flex focus-visible-ring', {\n      'flex-col': vertical\n    }, classes),\n    role: \"tablist\",\n    \"aria-orientation\": vertical ? 'vertical' : 'horizontal',\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 45,\n    columnNumber: 5\n  }, this);\n}\n//# sourceMappingURL=TabList.js.map","var _jsxFileName = \"/home/runner/work/frontend-shared/frontend-shared/src/components/transition/Slider.tsx\";\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks';\nimport { jsxDEV as _jsxDEV } from \"preact/jsx-dev-runtime\";\nconst Slider = ({\n  children,\n  direction = 'in',\n  onTransitionEnd\n}) => {\n  const visible = direction === 'in';\n  const containerRef = useRef(null);\n  const [containerHeight, setContainerHeight] = useState(visible ? 'auto' : 0);\n\n  // Whether the content is currently partially or wholly visible. This is\n  // different from `visible` when collapsing as it is true until the collapse\n  // animation completes.\n  const [contentVisible, setContentVisible] = useState(visible);\n\n  // Adjust the container height when the `visible` prop changes.\n  useEffect(() => {\n    const isVisible = containerHeight !== 0;\n    if (visible === isVisible) {\n      // Do nothing after the initial mount.\n      return;\n    }\n    const el = containerRef.current;\n    if (visible) {\n      // Show the content synchronously so that we can measure it here.\n      el.style.display = '';\n\n      // Make content visible in future renders.\n      setContentVisible(true);\n\n      // When expanding, transition the container to the current fixed height\n      // of the content. After the transition completes, we'll reset to \"auto\"\n      // height to adapt to future content changes.\n      setContainerHeight(el.scrollHeight);\n    } else {\n      // When collapsing, immediately change the current height to a fixed height\n      // (in case it is currently \"auto\"), force a synchronous layout,\n      // then transition to 0.\n      //\n      // These steps are needed because browsers will not animate transitions\n      // from \"auto\" => \"0\" and may not animate \"auto\" => fixed height => 0\n      // if the layout tree transitions directly from \"auto\" => 0.\n      el.style.height = `${el.scrollHeight}px`;\n\n      // Force a sync layout.\n      el.getBoundingClientRect();\n      setContainerHeight(0);\n    }\n  }, [containerHeight, visible]);\n  const handleTransitionEnd = useCallback(e => {\n    // Only transitions on the actual component and for the \"height\" property\n    // are relevant \"in\"/\"out\" transitions.\n    if (e.target !== containerRef.current || e.propertyName !== 'height') {\n      return;\n    }\n    if (visible) {\n      setContainerHeight('auto');\n    } else {\n      // When the collapse animation completes, stop rendering the content so\n      // that the browser has fewer nodes to render and the content is removed\n      // from keyboard navigation.\n      setContentVisible(false);\n    }\n    onTransitionEnd === null || onTransitionEnd === void 0 || onTransitionEnd(direction);\n  }, [setContainerHeight, visible, onTransitionEnd, direction]);\n  const isFullyVisible = containerHeight === 'auto';\n  return _jsxDEV(\"div\", {\n    // nb. Preact uses \"ontransitionend\" rather than \"onTransitionEnd\".\n    // See https://bugs.chromium.org/p/chromium/issues/detail?id=961193\n    //\n    // @ts-ignore\n    ontransitionend: handleTransitionEnd,\n    ref: containerRef,\n    style: {\n      display: contentVisible ? '' : 'none',\n      height: containerHeight,\n      // When the Slider is fully open, overflow is made visible so that\n      // focus rings, which may extend outside the bounds of the Slider content,\n      // are visible.\n      overflow: isFullyVisible ? 'visible' : 'hidden',\n      transition: `height 0.15s ease-in`\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n};\nexport default Slider;\n//# sourceMappingURL=Slider.js.map","import type { SidebarSettings, Service } from '../../types/config';\n\n/**\n * Return the configuration for the annotation service which the client would retrieve\n * annotations from which may contain the authority, grantToken and icon.\n */\n\nexport function serviceConfig({ services }: SidebarSettings): Service | null {\n  if (Array.isArray(services) && services[0]) {\n    return services[0];\n  }\n  return null;\n}\n","import type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\n\n/**\n * Return `true` if the first configured service is a \"third-party\" service.\n *\n * Return `true` if the first custom annotation service configured in the\n * services array in the host page is a third-party service, `false` otherwise.\n *\n * If no custom annotation services are configured then return `false`.\n */\nexport function isThirdPartyService(settings: SidebarSettings): boolean {\n  const service = serviceConfig(settings);\n\n  if (service?.authority) {\n    return service.authority !== settings.authDomain;\n  }\n  return false;\n}\n","import type { ThemeProperty } from '../../types/config';\n\nconst supportedThemeProperties: Record<ThemeProperty, string> = {\n  accentColor: 'color',\n  appBackgroundColor: 'backgroundColor',\n  ctaBackgroundColor: 'backgroundColor',\n  ctaTextColor: 'color',\n  selectionFontFamily: 'fontFamily',\n  annotationFontFamily: 'fontFamily',\n};\n\n/**\n * Subset of the config from the host page which includes theme configuration.\n */\nexport type Settings = {\n  branding?: Record<ThemeProperty, string>;\n};\n\n/**\n * Return a React `style` object suitable for use as the value of the `style`\n * attr in a React element, with styling rules for the requested set of\n * `themeProperties`.\n *\n * `supportedThemeProperties` defines a whitelist of properties that may be\n * set by a partner's configuration for theme customization. For a given theme\n * property's styling to be present in the returned style object, all of the\n * following must be true:\n *\n * - The theme property is present in the `supportedThemeProperties` whitelist\n * - `settings.branding` (derived from client configuration) has an entry\n *    for this theme property\n *\n * See https://reactjs.org/docs/dom-elements.html#style\n *\n * @param themeProperties - Which of the supported theme properties should have\n *   applied rules in the `style` object\n * @return Object that can be passed as the `style` prop\n *\n * @example\n * let themeProperties = ['accentColor', 'ctaTextColor', 'foo'];\n * let settings = { branding: {\n *     accentColor: '#ffc',\n *     selectionFontFamily: 'Times New Roman'\n *   }\n * };\n * // Only two of the `themeProperties` are whitelisted and\n * // only one of those has a value in the `settings` object, so:\n * applyTheme(themeProperties, settings); // -> { color: '#ffc '}\n */\nexport function applyTheme(\n  themeProperties: ThemeProperty[],\n  settings: Settings,\n): Record<string, string> {\n  const style: Record<string, string> = {};\n  if (!settings.branding) {\n    return style;\n  }\n  const { branding } = settings;\n  themeProperties.forEach(themeProp => {\n    const propertyName = supportedThemeProperties[themeProp];\n    const propertyValue = branding[themeProp];\n    if (propertyName && propertyValue) {\n      style[propertyName] = propertyValue;\n    }\n  });\n\n  return style;\n}\n","/* global process */\n/**\n * This module provides dependency injection of services into React\n * components via React's \"context\" API [1].\n *\n * [1] See https://reactjs.org/docs/context.html#api and\n *     https://reactjs.org/docs/hooks-reference.html#usecontext\n */\nimport { createContext } from 'preact';\nimport type { ComponentType } from 'preact';\nimport { useContext } from 'preact/hooks';\n\ntype ServiceProvider = {\n  get: (serviceName: string) => unknown;\n};\n\nconst fallbackInjector: ServiceProvider = {\n  get(service) {\n    throw new Error(\n      `Missing ServiceContext provider to provide \"${service}\" prop`,\n    );\n  },\n};\n\n/**\n * Context type for a service dependency injector.\n *\n * The value should be an object with a `get(serviceName)` method which returns\n * the instance of the named value or service.\n *\n * Consumers will either use this directly via `useContext` or use the\n * `withServices` wrapper.\n */\nexport const ServiceContext = createContext(fallbackInjector);\n\n/**\n * Wrap a Preact component to inject specified props using a dependency injector.\n *\n * The returned component accepts the same props as the input component, except\n * for those listed in the `serviceNames` argument. When the component is rendered\n * the dependency injector is looked up using `useContext(ServiceContext)` and\n * values for these props are obtained from the injector.\n *\n * As a convenience for testing, the props specified by `serviceNames` can still\n * be passed to the returned component. In this case they will override the\n * injected values.\n *\n * @example\n *   function MyComponent({ settings }) {\n *     return ...\n *   }\n *\n *   // Wrap `MyComponent` to inject \"settings\" service from context.\n *   export default withServices(MyComponent, ['settings']);\n *\n * @param serviceNames - List of prop names that should be injected\n */\nexport function withServices<\n  Props extends Record<string, unknown>,\n  ServiceName extends string & keyof Props,\n>(\n  Component: ComponentType<Props>,\n  serviceNames: ServiceName[],\n): ComponentType<Omit<Props, ServiceName>> {\n  function Wrapper(props: Omit<Props, ServiceName>) {\n    // Get the current dependency injector instance that is provided by a\n    // `ServiceContext.Provider` somewhere higher up the component tree.\n    const injector = useContext(ServiceContext);\n\n    // Inject services, unless they have been overridden by props passed from\n    // the parent component.\n\n    const services: Partial<Record<ServiceName, unknown>> = {};\n    for (const service of serviceNames) {\n      // Debugging check to make sure the store is used correctly.\n      if (process.env.NODE_ENV !== 'production' && service === 'store') {\n        /* istanbul ignore next - Ignore debug code */\n        throw new Error(\n          'Do not use `withServices` to inject the `store` service. Use the `useStore` hook instead',\n        );\n      }\n\n      if (!(service in props)) {\n        services[service] = injector.get(service);\n      }\n    }\n\n    const propsWithServices = { ...services, ...props } as Props;\n    return <Component {...propsWithServices} />;\n  }\n\n  // Set the name of the wrapper for use in debug tools and queries in Enzyme\n  // tests.\n  const wrappedName = Component.displayName || Component.name;\n  Wrapper.displayName = `withServices(${wrappedName})`;\n\n  return Wrapper;\n}\n\n/**\n * Hook for looking up a service within a component or a custom hook.\n *\n * This is an alternative to `withServices` that is mainly useful in the\n * context of custom hooks.\n *\n * @param service - Name of the service to look up\n */\nexport function useService(service: string) {\n  const injector = useContext(ServiceContext);\n  return injector.get(service);\n}\n","// src/utils/formatProdErrorMessage.ts\nfunction formatProdErrorMessage(code) {\n  return `Minified Redux error #${code}; visit https://redux.js.org/Errors?code=${code} for the full message or use the non-minified dev environment for full errors. `;\n}\n\n// src/utils/symbol-observable.ts\nvar $$observable = /* @__PURE__ */ (() => typeof Symbol === \"function\" && Symbol.observable || \"@@observable\")();\nvar symbol_observable_default = $$observable;\n\n// src/utils/actionTypes.ts\nvar randomString = () => Math.random().toString(36).substring(7).split(\"\").join(\".\");\nvar ActionTypes = {\n  INIT: `@@redux/INIT${/* @__PURE__ */ randomString()}`,\n  REPLACE: `@@redux/REPLACE${/* @__PURE__ */ randomString()}`,\n  PROBE_UNKNOWN_ACTION: () => `@@redux/PROBE_UNKNOWN_ACTION${randomString()}`\n};\nvar actionTypes_default = ActionTypes;\n\n// src/utils/isPlainObject.ts\nfunction isPlainObject(obj) {\n  if (typeof obj !== \"object\" || obj === null)\n    return false;\n  let proto = obj;\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n  return Object.getPrototypeOf(obj) === proto || Object.getPrototypeOf(obj) === null;\n}\n\n// src/utils/kindOf.ts\nfunction miniKindOf(val) {\n  if (val === void 0)\n    return \"undefined\";\n  if (val === null)\n    return \"null\";\n  const type = typeof val;\n  switch (type) {\n    case \"boolean\":\n    case \"string\":\n    case \"number\":\n    case \"symbol\":\n    case \"function\": {\n      return type;\n    }\n  }\n  if (Array.isArray(val))\n    return \"array\";\n  if (isDate(val))\n    return \"date\";\n  if (isError(val))\n    return \"error\";\n  const constructorName = ctorName(val);\n  switch (constructorName) {\n    case \"Symbol\":\n    case \"Promise\":\n    case \"WeakMap\":\n    case \"WeakSet\":\n    case \"Map\":\n    case \"Set\":\n      return constructorName;\n  }\n  return Object.prototype.toString.call(val).slice(8, -1).toLowerCase().replace(/\\s/g, \"\");\n}\nfunction ctorName(val) {\n  return typeof val.constructor === \"function\" ? val.constructor.name : null;\n}\nfunction isError(val) {\n  return val instanceof Error || typeof val.message === \"string\" && val.constructor && typeof val.constructor.stackTraceLimit === \"number\";\n}\nfunction isDate(val) {\n  if (val instanceof Date)\n    return true;\n  return typeof val.toDateString === \"function\" && typeof val.getDate === \"function\" && typeof val.setDate === \"function\";\n}\nfunction kindOf(val) {\n  let typeOfVal = typeof val;\n  if (process.env.NODE_ENV !== \"production\") {\n    typeOfVal = miniKindOf(val);\n  }\n  return typeOfVal;\n}\n\n// src/createStore.ts\nfunction createStore(reducer, preloadedState, enhancer) {\n  if (typeof reducer !== \"function\") {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(2) : `Expected the root reducer to be a function. Instead, received: '${kindOf(reducer)}'`);\n  }\n  if (typeof preloadedState === \"function\" && typeof enhancer === \"function\" || typeof enhancer === \"function\" && typeof arguments[3] === \"function\") {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(0) : \"It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.\");\n  }\n  if (typeof preloadedState === \"function\" && typeof enhancer === \"undefined\") {\n    enhancer = preloadedState;\n    preloadedState = void 0;\n  }\n  if (typeof enhancer !== \"undefined\") {\n    if (typeof enhancer !== \"function\") {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(1) : `Expected the enhancer to be a function. Instead, received: '${kindOf(enhancer)}'`);\n    }\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n  let currentReducer = reducer;\n  let currentState = preloadedState;\n  let currentListeners = /* @__PURE__ */ new Map();\n  let nextListeners = currentListeners;\n  let listenerIdCounter = 0;\n  let isDispatching = false;\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = /* @__PURE__ */ new Map();\n      currentListeners.forEach((listener, key) => {\n        nextListeners.set(key, listener);\n      });\n    }\n  }\n  function getState() {\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(3) : \"You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.\");\n    }\n    return currentState;\n  }\n  function subscribe(listener) {\n    if (typeof listener !== \"function\") {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(4) : `Expected the listener to be a function. Instead, received: '${kindOf(listener)}'`);\n    }\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(5) : \"You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.\");\n    }\n    let isSubscribed = true;\n    ensureCanMutateNextListeners();\n    const listenerId = listenerIdCounter++;\n    nextListeners.set(listenerId, listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n      if (isDispatching) {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(6) : \"You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.\");\n      }\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      nextListeners.delete(listenerId);\n      currentListeners = null;\n    };\n  }\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(7) : `Actions must be plain objects. Instead, the actual type was: '${kindOf(action)}'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.`);\n    }\n    if (typeof action.type === \"undefined\") {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(8) : 'Actions may not have an undefined \"type\" property. You may have misspelled an action type string constant.');\n    }\n    if (typeof action.type !== \"string\") {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(17) : `Action \"type\" property must be a string. Instead, the actual type was: '${kindOf(action.type)}'. Value was: '${action.type}' (stringified)`);\n    }\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(9) : \"Reducers may not dispatch actions.\");\n    }\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n    const listeners = currentListeners = nextListeners;\n    listeners.forEach((listener) => {\n      listener();\n    });\n    return action;\n  }\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== \"function\") {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(10) : `Expected the nextReducer to be a function. Instead, received: '${kindOf(nextReducer)}`);\n    }\n    currentReducer = nextReducer;\n    dispatch({\n      type: actionTypes_default.REPLACE\n    });\n  }\n  function observable() {\n    const outerSubscribe = subscribe;\n    return {\n      /**\n       * The minimal observable subscription method.\n       * @param observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe(observer) {\n        if (typeof observer !== \"object\" || observer === null) {\n          throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(11) : `Expected the observer to be an object. Instead, received: '${kindOf(observer)}'`);\n        }\n        function observeState() {\n          const observerAsObserver = observer;\n          if (observerAsObserver.next) {\n            observerAsObserver.next(getState());\n          }\n        }\n        observeState();\n        const unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe\n        };\n      },\n      [symbol_observable_default]() {\n        return this;\n      }\n    };\n  }\n  dispatch({\n    type: actionTypes_default.INIT\n  });\n  const store = {\n    dispatch,\n    subscribe,\n    getState,\n    replaceReducer,\n    [symbol_observable_default]: observable\n  };\n  return store;\n}\nfunction legacy_createStore(reducer, preloadedState, enhancer) {\n  return createStore(reducer, preloadedState, enhancer);\n}\n\n// src/utils/warning.ts\nfunction warning(message) {\n  if (typeof console !== \"undefined\" && typeof console.error === \"function\") {\n    console.error(message);\n  }\n  try {\n    throw new Error(message);\n  } catch (e) {\n  }\n}\n\n// src/combineReducers.ts\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  const reducerKeys = Object.keys(reducers);\n  const argumentName = action && action.type === actionTypes_default.INIT ? \"preloadedState argument passed to createStore\" : \"previous state received by the reducer\";\n  if (reducerKeys.length === 0) {\n    return \"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.\";\n  }\n  if (!isPlainObject(inputState)) {\n    return `The ${argumentName} has unexpected type of \"${kindOf(inputState)}\". Expected argument to be an object with the following keys: \"${reducerKeys.join('\", \"')}\"`;\n  }\n  const unexpectedKeys = Object.keys(inputState).filter((key) => !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key]);\n  unexpectedKeys.forEach((key) => {\n    unexpectedKeyCache[key] = true;\n  });\n  if (action && action.type === actionTypes_default.REPLACE)\n    return;\n  if (unexpectedKeys.length > 0) {\n    return `Unexpected ${unexpectedKeys.length > 1 ? \"keys\" : \"key\"} \"${unexpectedKeys.join('\", \"')}\" found in ${argumentName}. Expected to find one of the known reducer keys instead: \"${reducerKeys.join('\", \"')}\". Unexpected keys will be ignored.`;\n  }\n}\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach((key) => {\n    const reducer = reducers[key];\n    const initialState = reducer(void 0, {\n      type: actionTypes_default.INIT\n    });\n    if (typeof initialState === \"undefined\") {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(12) : `The slice reducer for key \"${key}\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);\n    }\n    if (typeof reducer(void 0, {\n      type: actionTypes_default.PROBE_UNKNOWN_ACTION()\n    }) === \"undefined\") {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(13) : `The slice reducer for key \"${key}\" returned undefined when probed with a random type. Don't try to handle '${actionTypes_default.INIT}' or other actions in \"redux/*\" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.`);\n    }\n  });\n}\nfunction combineReducers(reducers) {\n  const reducerKeys = Object.keys(reducers);\n  const finalReducers = {};\n  for (let i = 0; i < reducerKeys.length; i++) {\n    const key = reducerKeys[i];\n    if (process.env.NODE_ENV !== \"production\") {\n      if (typeof reducers[key] === \"undefined\") {\n        warning(`No reducer provided for key \"${key}\"`);\n      }\n    }\n    if (typeof reducers[key] === \"function\") {\n      finalReducers[key] = reducers[key];\n    }\n  }\n  const finalReducerKeys = Object.keys(finalReducers);\n  let unexpectedKeyCache;\n  if (process.env.NODE_ENV !== \"production\") {\n    unexpectedKeyCache = {};\n  }\n  let shapeAssertionError;\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n  return function combination(state = {}, action) {\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n    if (process.env.NODE_ENV !== \"production\") {\n      const warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n    let hasChanged = false;\n    const nextState = {};\n    for (let i = 0; i < finalReducerKeys.length; i++) {\n      const key = finalReducerKeys[i];\n      const reducer = finalReducers[key];\n      const previousStateForKey = state[key];\n      const nextStateForKey = reducer(previousStateForKey, action);\n      if (typeof nextStateForKey === \"undefined\") {\n        const actionType = action && action.type;\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(14) : `When called with an action of type ${actionType ? `\"${String(actionType)}\"` : \"(unknown type)\"}, the slice reducer for key \"${key}\" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.`);\n      }\n      nextState[key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n    hasChanged = hasChanged || finalReducerKeys.length !== Object.keys(state).length;\n    return hasChanged ? nextState : state;\n  };\n}\n\n// src/bindActionCreators.ts\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function(...args) {\n    return dispatch(actionCreator.apply(this, args));\n  };\n}\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === \"function\") {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n  if (typeof actionCreators !== \"object\" || actionCreators === null) {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(16) : `bindActionCreators expected an object or a function, but instead received: '${kindOf(actionCreators)}'. Did you write \"import ActionCreators from\" instead of \"import * as ActionCreators from\"?`);\n  }\n  const boundActionCreators = {};\n  for (const key in actionCreators) {\n    const actionCreator = actionCreators[key];\n    if (typeof actionCreator === \"function\") {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n  return boundActionCreators;\n}\n\n// src/compose.ts\nfunction compose(...funcs) {\n  if (funcs.length === 0) {\n    return (arg) => arg;\n  }\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n  return funcs.reduce((a, b) => (...args) => a(b(...args)));\n}\n\n// src/applyMiddleware.ts\nfunction applyMiddleware(...middlewares) {\n  return (createStore2) => (reducer, preloadedState) => {\n    const store = createStore2(reducer, preloadedState);\n    let dispatch = () => {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(15) : \"Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.\");\n    };\n    const middlewareAPI = {\n      getState: store.getState,\n      dispatch: (action, ...args) => dispatch(action, ...args)\n    };\n    const chain = middlewares.map((middleware) => middleware(middlewareAPI));\n    dispatch = compose(...chain)(store.dispatch);\n    return {\n      ...store,\n      dispatch\n    };\n  };\n}\n\n// src/utils/isAction.ts\nfunction isAction(action) {\n  return isPlainObject(action) && \"type\" in action && typeof action.type === \"string\";\n}\nexport {\n  actionTypes_default as __DO_NOT_USE__ActionTypes,\n  applyMiddleware,\n  bindActionCreators,\n  combineReducers,\n  compose,\n  createStore,\n  isAction,\n  isPlainObject,\n  legacy_createStore\n};\n//# sourceMappingURL=redux.mjs.map","// src/index.ts\nfunction createThunkMiddleware(extraArgument) {\n  const middleware = ({ dispatch, getState }) => (next) => (action) => {\n    if (typeof action === \"function\") {\n      return action(dispatch, getState, extraArgument);\n    }\n    return next(action);\n  };\n  return middleware;\n}\nvar thunk = createThunkMiddleware();\nvar withExtraArgument = createThunkMiddleware;\nexport {\n  thunk,\n  withExtraArgument\n};\n","/* global process */\nimport * as redux from 'redux';\nimport { thunk } from 'redux-thunk';\n\nimport { immutable } from '../util/immutable';\nimport type { OmitFirstArg, TupleToIntersection } from './type-utils';\n\n/**\n * Helper that converts an object of selector functions, which take a `state`\n * parameter plus zero or more arguments, into selector methods, with no `state` parameter.\n */\ntype SelectorMethods<T> = { [K in keyof T]: OmitFirstArg<T[K]> };\n\n/** Map of action type to reducer function. */\ntype ReducerMap<State> = {\n  [action: string]: (s: State, action: any) => Partial<State>;\n};\n\n/** Map of selector name to selector function. */\ntype SelectorMap<State> = { [name: string]: (s: State, ...args: any[]) => any };\n\n/**\n * Type of a store module returned by `createStoreModule`. See {@link ModuleConfig}.\n */\ntype Module<\n  State,\n  Actions extends object,\n  Selectors extends Record<string, unknown>,\n  RootSelectors extends Record<string, unknown>,\n> = {\n  namespace: string;\n  initialState: (...args: any[]) => State;\n  reducers: ReducerMap<State>;\n  actionCreators: Actions;\n  selectors: Selectors;\n  rootSelectors?: RootSelectors;\n};\n\n/**\n * Helper for getting the type of store produced by `createStore` when\n * passed a given module.\n *\n * To get the type for a store created from several modules, use `&`:\n *\n * `StoreFromModule<firstModule> & StoreFromModule<secondModule>`\n */\ntype StoreFromModule<T> =\n  T extends Module<any, infer Actions, infer Selectors, infer RootSelectors>\n    ? Store<Actions, Selectors, RootSelectors>\n    : never;\n\n/**\n * Redux store augmented with selector methods to query specific state and\n * action methods that dispatch specific actions.\n */\nexport type Store<\n  Actions extends object,\n  Selectors extends object,\n  RootSelectors extends object,\n> = redux.Store &\n  Actions &\n  SelectorMethods<Selectors> &\n  SelectorMethods<RootSelectors>;\n\n/** Create a Redux reducer from a store module's reducer map. */\nfunction createReducer<State>(reducers: ReducerMap<State>) {\n  return (state = {} as State, action: redux.Action) => {\n    const reducer = reducers[action.type];\n    if (!reducer) {\n      return state;\n    }\n    const stateChanges = reducer(state, action);\n    return {\n      ...state,\n      ...stateChanges,\n    };\n  };\n}\n\n/**\n * Convert a map of selector functions, which take a state value as their\n * first argument, to a map of selector methods, which pre-fill the first\n * argument by calling `getState()`.\n */\nfunction bindSelectors<State, Selectors extends SelectorMap<State>>(\n  selectors: Selectors,\n  getState: () => State,\n): SelectorMethods<Selectors> {\n  const boundSelectors: Record<string, () => unknown> = {};\n  for (const [name, selector] of Object.entries(selectors)) {\n    boundSelectors[name] = (...args: any[]) => selector(getState(), ...args);\n  }\n  return boundSelectors as SelectorMethods<Selectors>;\n}\n\n/**\n * `Object.assign` wrapper that checks for overwriting properties in debug builds.\n */\nfunction assignOnce<T extends object, U extends object>(target: T, source: U) {\n  if (process.env.NODE_ENV !== 'production') {\n    for (const key of Object.keys(source)) {\n      if (key in target) {\n        throw new Error(`Cannot add duplicate '${key}' property to object`);\n      }\n    }\n  }\n  return Object.assign(target, source);\n}\n\n/**\n * Create a Redux store from a set of modules.\n *\n * Each module defines the logic related to a subset of the application state.\n * This includes:\n *\n *  - The initial value of the state. This should always be an object.\n *  - Actions that can change the state\n *  - Selectors for extracting information from the state\n *\n * In addition to the standard Redux store interface, the returned store also exposes\n * each action creator and selector from the input modules as a method. For example, if\n * a store is created from a module that has a `getWidget(<id>)` selector and\n * an `addWidget(<object>)` action, a consumer would use `store.getWidget(<id>)`\n * to fetch an item and `store.addWidget(<object>)` to dispatch an action that\n * adds an item. External consumers of the store should in most cases use these\n * selector and action methods rather than `getState` or `dispatch`. This\n * makes it easier to refactor the internal state structure.\n *\n * Preact UI components access stores via the `useStore` hook. This returns a\n * proxy which enables UI components to observe what store state a component\n * depends upon and re-render when it changes.\n */\nexport function createStore<\n  Modules extends readonly Module<any, any, any, any>[],\n>(\n  modules: Modules,\n  initArgs: any[] = [],\n  middleware: any[] = [],\n): StoreFromModule<TupleToIntersection<Modules>> {\n  const initialState: Record<string, unknown> = {};\n  for (const module of modules) {\n    initialState[module.namespace] = module.initialState(...initArgs);\n  }\n\n  const allReducers: redux.ReducersMapObject = {};\n  for (const module of modules) {\n    allReducers[module.namespace] = createReducer(module.reducers);\n  }\n\n  const defaultMiddleware = [\n    // The `thunk` middleware handles actions which are functions.\n    // This is used to implement actions which have side effects or are\n    // asynchronous (see https://github.com/gaearon/redux-thunk#motivation)\n    thunk,\n  ];\n\n  const enhancer = redux.applyMiddleware(...defaultMiddleware, ...middleware);\n\n  // Combine the reducers for all modules\n  let reducer = redux.combineReducers(allReducers);\n\n  // In debug builds, freeze the new state after each action to catch any attempts\n  // to mutate it, which indicates a bug since it is supposed to be immutable.\n  if (process.env.NODE_ENV !== 'production') {\n    const originalReducer = reducer;\n    reducer = (state, action) => immutable(originalReducer(state, action));\n  }\n\n  const store = redux.createStore(reducer, initialState, enhancer);\n\n  // Add action creators as methods to the store.\n  const actionCreators: Record<string, (...args: any[]) => redux.Action> = {};\n  for (const module of modules) {\n    assignOnce(actionCreators, module.actionCreators);\n  }\n  const actionMethods = redux.bindActionCreators(\n    actionCreators,\n    store.dispatch,\n  );\n  Object.assign(store, actionMethods);\n\n  // Add selectors as methods to the store.\n  const selectorMethods = {};\n  for (const module of modules) {\n    const { namespace, selectors, rootSelectors } = module;\n    const boundSelectors = bindSelectors(\n      selectors,\n      () => store.getState()[namespace],\n    );\n    assignOnce(selectorMethods, boundSelectors);\n\n    if (rootSelectors) {\n      const boundRootSelectors = bindSelectors(rootSelectors, store.getState);\n      assignOnce(selectorMethods, boundRootSelectors);\n    }\n  }\n  Object.assign(store, selectorMethods);\n\n  return store as any;\n}\n\n/**\n * Helper for creating an action which checks that the type of the action's\n * payload is compatible with what the reducer expects.\n *\n * @param reducers - The map of reducer functions from a store module\n * @param type - The name of a specific reducer in `reducers`\n * @param payload - The fields of the action\n *   except for `type`. Pass `undefined` if the reducer doesn't need an action payload.\n */\nexport function makeAction<\n  Reducers extends ReducerMap<any>,\n  Type extends keyof Reducers,\n>(reducers: Reducers, type: Type, payload: Parameters<Reducers[Type]>[1]) {\n  if (payload && 'type' in payload) {\n    throw new Error('Payload cannot contain a `type` field');\n  }\n  // nb. `reducers` is not used here. It exists purely for type inference.\n  return { type, ...payload };\n}\n\n/**\n * Configuration for a store module.\n *\n * This specifies everything about the contents of a store module, except the\n * initial state. The initial state is passed separately to {@link createStoreModule}\n * to aid type inference.\n */\ntype ModuleConfig<\n  State,\n  Actions,\n  Selectors extends SelectorMap<State>,\n  RootSelectors = Record<string, unknown>,\n> = {\n  /** The key under which this module's state will live in the store's root state. */\n  namespace: string;\n\n  /**\n   * Map of action types to \"reducer\" functions that process an action and return\n   * the changes to the state\n   */\n  reducers: ReducerMap<State>;\n\n  /**\n   * Map of functions which create actions that alter state in this module.\n   *\n   * These actions may also be handled by other modules.\n   */\n  actionCreators: Actions;\n\n  /** Map of functions which compute information from this module's state. */\n  selectors: Selectors;\n\n  /**\n   * Map of functions which compute information from state in this module and\n   * other modules.\n   */\n  rootSelectors?: RootSelectors;\n};\n\n/**\n * Create a store module that can be passed to {@link createStore}.\n *\n * @param initialState - Initial state for the module, specified either as a\n *   value or a function which computes it. If a function is passed, it is\n *   provided the arguments from the {@link createStore} call\n * @param config - Namespace and contents (actions, selectors, reducers etc.)\n *   of the module\n */\nexport function createStoreModule<\n  State,\n  Actions extends Record<string, unknown>,\n  Selectors extends SelectorMap<State>,\n  RootSelectors extends Record<string, unknown> = Record<string, unknown>,\n>(\n  initialState: State | ((...args: any[]) => State),\n  config: ModuleConfig<State, Actions, Selectors, RootSelectors>,\n): Module<State, Actions, Selectors, RootSelectors> {\n  if (!(initialState instanceof Function)) {\n    const state = initialState;\n    initialState = () => state;\n  }\n\n  return {\n    initialState,\n    ...config,\n  };\n}\n","import type { Action, Store } from 'redux';\n\n/**\n * A debug utility that prints information about internal application state\n * changes to the console.\n *\n * Debugging is enabled by setting `window.debug` to a truthy value.\n *\n * When enabled, every action that changes application state will be printed\n * to the console, along with the application state before and after the action\n * was handled.\n */\nexport function debugMiddleware(store: Store) {\n  /* eslint-disable no-console */\n  let serial = 0;\n\n  return (next: (a: Action) => void) => {\n    return (action: Action) => {\n      // @ts-ignore The window interface needs to be expanded to include this property\n      if (!window.debug) {\n        next(action);\n        return;\n      }\n\n      ++serial;\n\n      const groupTitle = action.type + ' (' + serial.toString() + ')';\n      console.group(groupTitle);\n      console.log('Prev State:', store.getState());\n      console.log('Action:', action);\n\n      next(action);\n\n      console.log('Next State:', store.getState());\n      console.groupEnd();\n    };\n  };\n  /* eslint-enable no-console */\n}\n","/**\n * Store module which tracks activity happening in the application that may\n * need to be reflected in the UI.\n */\nimport type { Annotation } from '../../../types/api';\nimport { createStoreModule, makeAction } from '../create-store';\n\nexport type State = {\n  /**\n   * Annotation `$tag`s that correspond to annotations with active API requests\n   */\n  activeAnnotationSaveRequests: string[];\n\n  /** The number of API requests that have started and not yet completed. */\n  activeApiRequests: number;\n  /** The number of annotation fetches that have started and not yet completed. */\n  activeAnnotationFetches: number;\n  /** Have annotations ever been fetched? */\n  hasFetchedAnnotations: boolean;\n\n  /**\n   * The number of total annotation results the service reported as\n   * matching the most recent load/search request\n   */\n  annotationResultCount: number | null;\n\n  /** Count of remaining annotation imports. */\n  importsPending: number;\n\n  /** Total number of imports in active import tasks. */\n  importsTotal: number;\n};\n\nconst initialState: State = {\n  activeAnnotationSaveRequests: [],\n  activeApiRequests: 0,\n  activeAnnotationFetches: 0,\n  hasFetchedAnnotations: false,\n  annotationResultCount: null,\n  importsPending: 0,\n  importsTotal: 0,\n};\n\nconst reducers = {\n  API_REQUEST_STARTED(state: State) {\n    return {\n      ...state,\n      activeApiRequests: state.activeApiRequests + 1,\n    };\n  },\n\n  API_REQUEST_FINISHED(state: State) {\n    if (state.activeApiRequests === 0) {\n      throw new Error(\n        'API_REQUEST_FINISHED action when no requests were active',\n      );\n    }\n\n    return {\n      ...state,\n      activeApiRequests: state.activeApiRequests - 1,\n    };\n  },\n\n  ANNOTATION_SAVE_STARTED(state: State, action: { annotation: Annotation }) {\n    const addToStarted = [];\n    if (\n      action.annotation.$tag &&\n      !state.activeAnnotationSaveRequests.includes(action.annotation.$tag)\n    ) {\n      addToStarted.push(action.annotation.$tag);\n    }\n    const updatedSaves =\n      state.activeAnnotationSaveRequests.concat(addToStarted);\n    return {\n      ...state,\n      activeAnnotationSaveRequests: updatedSaves,\n    };\n  },\n\n  ANNOTATION_SAVE_FINISHED(state: State, action: { annotation: Annotation }) {\n    const updatedSaves = state.activeAnnotationSaveRequests.filter(\n      $tag => $tag !== action.annotation.$tag,\n    );\n    return {\n      ...state,\n      activeAnnotationSaveRequests: updatedSaves,\n    };\n  },\n\n  ANNOTATION_FETCH_STARTED(state: State) {\n    return {\n      ...state,\n      activeAnnotationFetches: state.activeAnnotationFetches + 1,\n    };\n  },\n\n  ANNOTATION_FETCH_FINISHED(state: State) {\n    if (state.activeAnnotationFetches === 0) {\n      throw new Error(\n        'ANNOTATION_FETCH_FINISHED action when no annotation fetches were active',\n      );\n    }\n\n    return {\n      ...state,\n      hasFetchedAnnotations: true,\n      activeAnnotationFetches: state.activeAnnotationFetches - 1,\n    };\n  },\n\n  SET_ANNOTATION_RESULT_COUNT(state: State, action: { resultCount: number }) {\n    return {\n      annotationResultCount: action.resultCount,\n    };\n  },\n\n  BEGIN_IMPORT(state: State, action: { count: number }) {\n    return {\n      importsPending: state.importsPending + action.count,\n      importsTotal: state.importsTotal + action.count,\n    };\n  },\n\n  COMPLETE_IMPORT(state: State, action: { count: number }) {\n    if (!state.importsPending) {\n      return state;\n    }\n    const importsPending = Math.max(state.importsPending - action.count, 0);\n    const importsTotal = importsPending > 0 ? state.importsTotal : 0;\n\n    return {\n      importsPending,\n      importsTotal,\n    };\n  },\n};\n\nfunction annotationFetchStarted() {\n  return makeAction(reducers, 'ANNOTATION_FETCH_STARTED', undefined);\n}\n\nfunction annotationFetchFinished() {\n  return makeAction(reducers, 'ANNOTATION_FETCH_FINISHED', undefined);\n}\n\nfunction annotationSaveStarted(annotation: Annotation) {\n  return makeAction(reducers, 'ANNOTATION_SAVE_STARTED', { annotation });\n}\n\nfunction annotationSaveFinished(annotation: Annotation) {\n  return makeAction(reducers, 'ANNOTATION_SAVE_FINISHED', { annotation });\n}\n\nfunction apiRequestStarted() {\n  return makeAction(reducers, 'API_REQUEST_STARTED', undefined);\n}\n\nfunction apiRequestFinished() {\n  return makeAction(reducers, 'API_REQUEST_FINISHED', undefined);\n}\n\nfunction setAnnotationResultCount(resultCount: number) {\n  return makeAction(reducers, 'SET_ANNOTATION_RESULT_COUNT', { resultCount });\n}\n\nfunction beginImport(count: number) {\n  return makeAction(reducers, 'BEGIN_IMPORT', { count });\n}\n\nfunction completeImport(count: number) {\n  return makeAction(reducers, 'COMPLETE_IMPORT', { count });\n}\n\n/** Selectors */\n\nfunction annotationResultCount(state: State) {\n  return state.annotationResultCount;\n}\n\nfunction hasFetchedAnnotations(state: State) {\n  return state.hasFetchedAnnotations;\n}\n\nfunction importsPending(state: State) {\n  return state.importsPending;\n}\n\nfunction importsTotal(state: State) {\n  return state.importsTotal;\n}\n\n/**\n * Return true when annotations are actively being fetched.\n */\nfunction isFetchingAnnotations(state: State) {\n  return state.activeAnnotationFetches > 0;\n}\n\n/**\n * Return true when any activity is happening in the app that needs to complete\n * before the UI is ready for interactivity with annotations.\n */\nfunction isLoading(state: State) {\n  return state.activeApiRequests > 0 || !state.hasFetchedAnnotations;\n}\n\n/**\n * Return `true` if `$tag` exists in the array of annotation `$tag`s that\n * have in-flight save requests, i.e. the annotation in question is actively\n * being saved to a remote service.\n */\nfunction isSavingAnnotation(state: State, annotation: Annotation) {\n  if (!annotation.$tag) {\n    return false;\n  }\n  return state.activeAnnotationSaveRequests.includes(annotation.$tag);\n}\n\nexport const activityModule = createStoreModule(initialState, {\n  reducers,\n  namespace: 'activity',\n\n  actionCreators: {\n    annotationFetchStarted,\n    annotationFetchFinished,\n    annotationSaveStarted,\n    annotationSaveFinished,\n    apiRequestStarted,\n    apiRequestFinished,\n    beginImport,\n    completeImport,\n    setAnnotationResultCount,\n  },\n\n  selectors: {\n    hasFetchedAnnotations,\n    importsPending,\n    importsTotal,\n    isLoading,\n    isFetchingAnnotations,\n    isSavingAnnotation,\n    annotationResultCount,\n  },\n});\n","// src/devModeChecks/identityFunctionCheck.ts\nvar runIdentityFunctionCheck = (resultFunc, inputSelectorsResults, outputSelectorResult) => {\n  if (inputSelectorsResults.length === 1 && inputSelectorsResults[0] === outputSelectorResult) {\n    let isInputSameAsOutput = false;\n    try {\n      const emptyObject = {};\n      if (resultFunc(emptyObject) === emptyObject)\n        isInputSameAsOutput = true;\n    } catch {\n    }\n    if (isInputSameAsOutput) {\n      let stack = void 0;\n      try {\n        throw new Error();\n      } catch (e) {\n        ;\n        ({ stack } = e);\n      }\n      console.warn(\n        \"The result function returned its own inputs without modification. e.g\\n`createSelector([state => state.todos], todos => todos)`\\nThis could lead to inefficient memoization and unnecessary re-renders.\\nEnsure transformation logic is in the result function, and extraction logic is in the input selectors.\",\n        { stack }\n      );\n    }\n  }\n};\n\n// src/devModeChecks/inputStabilityCheck.ts\nvar runInputStabilityCheck = (inputSelectorResultsObject, options, inputSelectorArgs) => {\n  const { memoize, memoizeOptions } = options;\n  const { inputSelectorResults, inputSelectorResultsCopy } = inputSelectorResultsObject;\n  const createAnEmptyObject = memoize(() => ({}), ...memoizeOptions);\n  const areInputSelectorResultsEqual = createAnEmptyObject.apply(null, inputSelectorResults) === createAnEmptyObject.apply(null, inputSelectorResultsCopy);\n  if (!areInputSelectorResultsEqual) {\n    let stack = void 0;\n    try {\n      throw new Error();\n    } catch (e) {\n      ;\n      ({ stack } = e);\n    }\n    console.warn(\n      \"An input selector returned a different result when passed same arguments.\\nThis means your output selector will likely run more frequently than intended.\\nAvoid returning a new reference inside your input selector, e.g.\\n`createSelector([state => state.todos.map(todo => todo.id)], todoIds => todoIds.length)`\",\n      {\n        arguments: inputSelectorArgs,\n        firstInputs: inputSelectorResults,\n        secondInputs: inputSelectorResultsCopy,\n        stack\n      }\n    );\n  }\n};\n\n// src/devModeChecks/setGlobalDevModeChecks.ts\nvar globalDevModeChecks = {\n  inputStabilityCheck: \"once\",\n  identityFunctionCheck: \"once\"\n};\nvar setGlobalDevModeChecks = (devModeChecks) => {\n  Object.assign(globalDevModeChecks, devModeChecks);\n};\n\n// src/utils.ts\nvar NOT_FOUND = /* @__PURE__ */ Symbol(\"NOT_FOUND\");\nfunction assertIsFunction(func, errorMessage = `expected a function, instead received ${typeof func}`) {\n  if (typeof func !== \"function\") {\n    throw new TypeError(errorMessage);\n  }\n}\nfunction assertIsObject(object, errorMessage = `expected an object, instead received ${typeof object}`) {\n  if (typeof object !== \"object\") {\n    throw new TypeError(errorMessage);\n  }\n}\nfunction assertIsArrayOfFunctions(array, errorMessage = `expected all items to be functions, instead received the following types: `) {\n  if (!array.every((item) => typeof item === \"function\")) {\n    const itemTypes = array.map(\n      (item) => typeof item === \"function\" ? `function ${item.name || \"unnamed\"}()` : typeof item\n    ).join(\", \");\n    throw new TypeError(`${errorMessage}[${itemTypes}]`);\n  }\n}\nvar ensureIsArray = (item) => {\n  return Array.isArray(item) ? item : [item];\n};\nfunction getDependencies(createSelectorArgs) {\n  const dependencies = Array.isArray(createSelectorArgs[0]) ? createSelectorArgs[0] : createSelectorArgs;\n  assertIsArrayOfFunctions(\n    dependencies,\n    `createSelector expects all input-selectors to be functions, but received the following types: `\n  );\n  return dependencies;\n}\nfunction collectInputSelectorResults(dependencies, inputSelectorArgs) {\n  const inputSelectorResults = [];\n  const { length } = dependencies;\n  for (let i = 0; i < length; i++) {\n    inputSelectorResults.push(dependencies[i].apply(null, inputSelectorArgs));\n  }\n  return inputSelectorResults;\n}\nvar getDevModeChecksExecutionInfo = (firstRun, devModeChecks) => {\n  const { identityFunctionCheck, inputStabilityCheck } = {\n    ...globalDevModeChecks,\n    ...devModeChecks\n  };\n  return {\n    identityFunctionCheck: {\n      shouldRun: identityFunctionCheck === \"always\" || identityFunctionCheck === \"once\" && firstRun,\n      run: runIdentityFunctionCheck\n    },\n    inputStabilityCheck: {\n      shouldRun: inputStabilityCheck === \"always\" || inputStabilityCheck === \"once\" && firstRun,\n      run: runInputStabilityCheck\n    }\n  };\n};\n\n// src/autotrackMemoize/autotracking.ts\nvar $REVISION = 0;\nvar CURRENT_TRACKER = null;\nvar Cell = class {\n  revision = $REVISION;\n  _value;\n  _lastValue;\n  _isEqual = tripleEq;\n  constructor(initialValue, isEqual = tripleEq) {\n    this._value = this._lastValue = initialValue;\n    this._isEqual = isEqual;\n  }\n  // Whenever a storage value is read, it'll add itself to the current tracker if\n  // one exists, entangling its state with that cache.\n  get value() {\n    CURRENT_TRACKER?.add(this);\n    return this._value;\n  }\n  // Whenever a storage value is updated, we bump the global revision clock,\n  // assign the revision for this storage to the new value, _and_ we schedule a\n  // rerender. This is important, and it's what makes autotracking  _pull_\n  // based. We don't actively tell the caches which depend on the storage that\n  // anything has happened. Instead, we recompute the caches when needed.\n  set value(newValue) {\n    if (this.value === newValue)\n      return;\n    this._value = newValue;\n    this.revision = ++$REVISION;\n  }\n};\nfunction tripleEq(a, b) {\n  return a === b;\n}\nvar TrackingCache = class {\n  _cachedValue;\n  _cachedRevision = -1;\n  _deps = [];\n  hits = 0;\n  fn;\n  constructor(fn) {\n    this.fn = fn;\n  }\n  clear() {\n    this._cachedValue = void 0;\n    this._cachedRevision = -1;\n    this._deps = [];\n    this.hits = 0;\n  }\n  get value() {\n    if (this.revision > this._cachedRevision) {\n      const { fn } = this;\n      const currentTracker = /* @__PURE__ */ new Set();\n      const prevTracker = CURRENT_TRACKER;\n      CURRENT_TRACKER = currentTracker;\n      this._cachedValue = fn();\n      CURRENT_TRACKER = prevTracker;\n      this.hits++;\n      this._deps = Array.from(currentTracker);\n      this._cachedRevision = this.revision;\n    }\n    CURRENT_TRACKER?.add(this);\n    return this._cachedValue;\n  }\n  get revision() {\n    return Math.max(...this._deps.map((d) => d.revision), 0);\n  }\n};\nfunction getValue(cell) {\n  if (!(cell instanceof Cell)) {\n    console.warn(\"Not a valid cell! \", cell);\n  }\n  return cell.value;\n}\nfunction setValue(storage, value) {\n  if (!(storage instanceof Cell)) {\n    throw new TypeError(\n      \"setValue must be passed a tracked store created with `createStorage`.\"\n    );\n  }\n  storage.value = storage._lastValue = value;\n}\nfunction createCell(initialValue, isEqual = tripleEq) {\n  return new Cell(initialValue, isEqual);\n}\nfunction createCache(fn) {\n  assertIsFunction(\n    fn,\n    \"the first parameter to `createCache` must be a function\"\n  );\n  return new TrackingCache(fn);\n}\n\n// src/autotrackMemoize/tracking.ts\nvar neverEq = (a, b) => false;\nfunction createTag() {\n  return createCell(null, neverEq);\n}\nfunction dirtyTag(tag, value) {\n  setValue(tag, value);\n}\nvar consumeCollection = (node) => {\n  let tag = node.collectionTag;\n  if (tag === null) {\n    tag = node.collectionTag = createTag();\n  }\n  getValue(tag);\n};\nvar dirtyCollection = (node) => {\n  const tag = node.collectionTag;\n  if (tag !== null) {\n    dirtyTag(tag, null);\n  }\n};\n\n// src/autotrackMemoize/proxy.ts\nvar REDUX_PROXY_LABEL = Symbol();\nvar nextId = 0;\nvar proto = Object.getPrototypeOf({});\nvar ObjectTreeNode = class {\n  constructor(value) {\n    this.value = value;\n    this.value = value;\n    this.tag.value = value;\n  }\n  proxy = new Proxy(this, objectProxyHandler);\n  tag = createTag();\n  tags = {};\n  children = {};\n  collectionTag = null;\n  id = nextId++;\n};\nvar objectProxyHandler = {\n  get(node, key) {\n    function calculateResult() {\n      const { value } = node;\n      const childValue = Reflect.get(value, key);\n      if (typeof key === \"symbol\") {\n        return childValue;\n      }\n      if (key in proto) {\n        return childValue;\n      }\n      if (typeof childValue === \"object\" && childValue !== null) {\n        let childNode = node.children[key];\n        if (childNode === void 0) {\n          childNode = node.children[key] = createNode(childValue);\n        }\n        if (childNode.tag) {\n          getValue(childNode.tag);\n        }\n        return childNode.proxy;\n      } else {\n        let tag = node.tags[key];\n        if (tag === void 0) {\n          tag = node.tags[key] = createTag();\n          tag.value = childValue;\n        }\n        getValue(tag);\n        return childValue;\n      }\n    }\n    const res = calculateResult();\n    return res;\n  },\n  ownKeys(node) {\n    consumeCollection(node);\n    return Reflect.ownKeys(node.value);\n  },\n  getOwnPropertyDescriptor(node, prop) {\n    return Reflect.getOwnPropertyDescriptor(node.value, prop);\n  },\n  has(node, prop) {\n    return Reflect.has(node.value, prop);\n  }\n};\nvar ArrayTreeNode = class {\n  constructor(value) {\n    this.value = value;\n    this.value = value;\n    this.tag.value = value;\n  }\n  proxy = new Proxy([this], arrayProxyHandler);\n  tag = createTag();\n  tags = {};\n  children = {};\n  collectionTag = null;\n  id = nextId++;\n};\nvar arrayProxyHandler = {\n  get([node], key) {\n    if (key === \"length\") {\n      consumeCollection(node);\n    }\n    return objectProxyHandler.get(node, key);\n  },\n  ownKeys([node]) {\n    return objectProxyHandler.ownKeys(node);\n  },\n  getOwnPropertyDescriptor([node], prop) {\n    return objectProxyHandler.getOwnPropertyDescriptor(node, prop);\n  },\n  has([node], prop) {\n    return objectProxyHandler.has(node, prop);\n  }\n};\nfunction createNode(value) {\n  if (Array.isArray(value)) {\n    return new ArrayTreeNode(value);\n  }\n  return new ObjectTreeNode(value);\n}\nfunction updateNode(node, newValue) {\n  const { value, tags, children } = node;\n  node.value = newValue;\n  if (Array.isArray(value) && Array.isArray(newValue) && value.length !== newValue.length) {\n    dirtyCollection(node);\n  } else {\n    if (value !== newValue) {\n      let oldKeysSize = 0;\n      let newKeysSize = 0;\n      let anyKeysAdded = false;\n      for (const _key in value) {\n        oldKeysSize++;\n      }\n      for (const key in newValue) {\n        newKeysSize++;\n        if (!(key in value)) {\n          anyKeysAdded = true;\n          break;\n        }\n      }\n      const isDifferent = anyKeysAdded || oldKeysSize !== newKeysSize;\n      if (isDifferent) {\n        dirtyCollection(node);\n      }\n    }\n  }\n  for (const key in tags) {\n    const childValue = value[key];\n    const newChildValue = newValue[key];\n    if (childValue !== newChildValue) {\n      dirtyCollection(node);\n      dirtyTag(tags[key], newChildValue);\n    }\n    if (typeof newChildValue === \"object\" && newChildValue !== null) {\n      delete tags[key];\n    }\n  }\n  for (const key in children) {\n    const childNode = children[key];\n    const newChildValue = newValue[key];\n    const childValue = childNode.value;\n    if (childValue === newChildValue) {\n      continue;\n    } else if (typeof newChildValue === \"object\" && newChildValue !== null) {\n      updateNode(childNode, newChildValue);\n    } else {\n      deleteNode(childNode);\n      delete children[key];\n    }\n  }\n}\nfunction deleteNode(node) {\n  if (node.tag) {\n    dirtyTag(node.tag, null);\n  }\n  dirtyCollection(node);\n  for (const key in node.tags) {\n    dirtyTag(node.tags[key], null);\n  }\n  for (const key in node.children) {\n    deleteNode(node.children[key]);\n  }\n}\n\n// src/lruMemoize.ts\nfunction createSingletonCache(equals) {\n  let entry;\n  return {\n    get(key) {\n      if (entry && equals(entry.key, key)) {\n        return entry.value;\n      }\n      return NOT_FOUND;\n    },\n    put(key, value) {\n      entry = { key, value };\n    },\n    getEntries() {\n      return entry ? [entry] : [];\n    },\n    clear() {\n      entry = void 0;\n    }\n  };\n}\nfunction createLruCache(maxSize, equals) {\n  let entries = [];\n  function get(key) {\n    const cacheIndex = entries.findIndex((entry) => equals(key, entry.key));\n    if (cacheIndex > -1) {\n      const entry = entries[cacheIndex];\n      if (cacheIndex > 0) {\n        entries.splice(cacheIndex, 1);\n        entries.unshift(entry);\n      }\n      return entry.value;\n    }\n    return NOT_FOUND;\n  }\n  function put(key, value) {\n    if (get(key) === NOT_FOUND) {\n      entries.unshift({ key, value });\n      if (entries.length > maxSize) {\n        entries.pop();\n      }\n    }\n  }\n  function getEntries() {\n    return entries;\n  }\n  function clear() {\n    entries = [];\n  }\n  return { get, put, getEntries, clear };\n}\nvar referenceEqualityCheck = (a, b) => a === b;\nfunction createCacheKeyComparator(equalityCheck) {\n  return function areArgumentsShallowlyEqual(prev, next) {\n    if (prev === null || next === null || prev.length !== next.length) {\n      return false;\n    }\n    const { length } = prev;\n    for (let i = 0; i < length; i++) {\n      if (!equalityCheck(prev[i], next[i])) {\n        return false;\n      }\n    }\n    return true;\n  };\n}\nfunction lruMemoize(func, equalityCheckOrOptions) {\n  const providedOptions = typeof equalityCheckOrOptions === \"object\" ? equalityCheckOrOptions : { equalityCheck: equalityCheckOrOptions };\n  const {\n    equalityCheck = referenceEqualityCheck,\n    maxSize = 1,\n    resultEqualityCheck\n  } = providedOptions;\n  const comparator = createCacheKeyComparator(equalityCheck);\n  let resultsCount = 0;\n  const cache = maxSize <= 1 ? createSingletonCache(comparator) : createLruCache(maxSize, comparator);\n  function memoized() {\n    let value = cache.get(arguments);\n    if (value === NOT_FOUND) {\n      value = func.apply(null, arguments);\n      resultsCount++;\n      if (resultEqualityCheck) {\n        const entries = cache.getEntries();\n        const matchingEntry = entries.find(\n          (entry) => resultEqualityCheck(entry.value, value)\n        );\n        if (matchingEntry) {\n          value = matchingEntry.value;\n          resultsCount !== 0 && resultsCount--;\n        }\n      }\n      cache.put(arguments, value);\n    }\n    return value;\n  }\n  memoized.clearCache = () => {\n    cache.clear();\n    memoized.resetResultsCount();\n  };\n  memoized.resultsCount = () => resultsCount;\n  memoized.resetResultsCount = () => {\n    resultsCount = 0;\n  };\n  return memoized;\n}\n\n// src/autotrackMemoize/autotrackMemoize.ts\nfunction autotrackMemoize(func) {\n  const node = createNode(\n    []\n  );\n  let lastArgs = null;\n  const shallowEqual = createCacheKeyComparator(referenceEqualityCheck);\n  const cache = createCache(() => {\n    const res = func.apply(null, node.proxy);\n    return res;\n  });\n  function memoized() {\n    if (!shallowEqual(lastArgs, arguments)) {\n      updateNode(node, arguments);\n      lastArgs = arguments;\n    }\n    return cache.value;\n  }\n  memoized.clearCache = () => {\n    return cache.clear();\n  };\n  return memoized;\n}\n\n// src/weakMapMemoize.ts\nvar StrongRef = class {\n  constructor(value) {\n    this.value = value;\n  }\n  deref() {\n    return this.value;\n  }\n};\nvar Ref = typeof WeakRef !== \"undefined\" ? WeakRef : StrongRef;\nvar UNTERMINATED = 0;\nvar TERMINATED = 1;\nfunction createCacheNode() {\n  return {\n    s: UNTERMINATED,\n    v: void 0,\n    o: null,\n    p: null\n  };\n}\nfunction weakMapMemoize(func, options = {}) {\n  let fnNode = createCacheNode();\n  const { resultEqualityCheck } = options;\n  let lastResult;\n  let resultsCount = 0;\n  function memoized() {\n    let cacheNode = fnNode;\n    const { length } = arguments;\n    for (let i = 0, l = length; i < l; i++) {\n      const arg = arguments[i];\n      if (typeof arg === \"function\" || typeof arg === \"object\" && arg !== null) {\n        let objectCache = cacheNode.o;\n        if (objectCache === null) {\n          cacheNode.o = objectCache = /* @__PURE__ */ new WeakMap();\n        }\n        const objectNode = objectCache.get(arg);\n        if (objectNode === void 0) {\n          cacheNode = createCacheNode();\n          objectCache.set(arg, cacheNode);\n        } else {\n          cacheNode = objectNode;\n        }\n      } else {\n        let primitiveCache = cacheNode.p;\n        if (primitiveCache === null) {\n          cacheNode.p = primitiveCache = /* @__PURE__ */ new Map();\n        }\n        const primitiveNode = primitiveCache.get(arg);\n        if (primitiveNode === void 0) {\n          cacheNode = createCacheNode();\n          primitiveCache.set(arg, cacheNode);\n        } else {\n          cacheNode = primitiveNode;\n        }\n      }\n    }\n    const terminatedNode = cacheNode;\n    let result;\n    if (cacheNode.s === TERMINATED) {\n      result = cacheNode.v;\n    } else {\n      result = func.apply(null, arguments);\n      resultsCount++;\n      if (resultEqualityCheck) {\n        const lastResultValue = lastResult?.deref?.() ?? lastResult;\n        if (lastResultValue != null && resultEqualityCheck(lastResultValue, result)) {\n          result = lastResultValue;\n          resultsCount !== 0 && resultsCount--;\n        }\n        const needsWeakRef = typeof result === \"object\" && result !== null || typeof result === \"function\";\n        lastResult = needsWeakRef ? new Ref(result) : result;\n      }\n    }\n    terminatedNode.s = TERMINATED;\n    terminatedNode.v = result;\n    return result;\n  }\n  memoized.clearCache = () => {\n    fnNode = createCacheNode();\n    memoized.resetResultsCount();\n  };\n  memoized.resultsCount = () => resultsCount;\n  memoized.resetResultsCount = () => {\n    resultsCount = 0;\n  };\n  return memoized;\n}\n\n// src/createSelectorCreator.ts\nfunction createSelectorCreator(memoizeOrOptions, ...memoizeOptionsFromArgs) {\n  const createSelectorCreatorOptions = typeof memoizeOrOptions === \"function\" ? {\n    memoize: memoizeOrOptions,\n    memoizeOptions: memoizeOptionsFromArgs\n  } : memoizeOrOptions;\n  const createSelector2 = (...createSelectorArgs) => {\n    let recomputations = 0;\n    let dependencyRecomputations = 0;\n    let lastResult;\n    let directlyPassedOptions = {};\n    let resultFunc = createSelectorArgs.pop();\n    if (typeof resultFunc === \"object\") {\n      directlyPassedOptions = resultFunc;\n      resultFunc = createSelectorArgs.pop();\n    }\n    assertIsFunction(\n      resultFunc,\n      `createSelector expects an output function after the inputs, but received: [${typeof resultFunc}]`\n    );\n    const combinedOptions = {\n      ...createSelectorCreatorOptions,\n      ...directlyPassedOptions\n    };\n    const {\n      memoize,\n      memoizeOptions = [],\n      argsMemoize = weakMapMemoize,\n      argsMemoizeOptions = [],\n      devModeChecks = {}\n    } = combinedOptions;\n    const finalMemoizeOptions = ensureIsArray(memoizeOptions);\n    const finalArgsMemoizeOptions = ensureIsArray(argsMemoizeOptions);\n    const dependencies = getDependencies(createSelectorArgs);\n    const memoizedResultFunc = memoize(function recomputationWrapper() {\n      recomputations++;\n      return resultFunc.apply(\n        null,\n        arguments\n      );\n    }, ...finalMemoizeOptions);\n    let firstRun = true;\n    const selector = argsMemoize(function dependenciesChecker() {\n      dependencyRecomputations++;\n      const inputSelectorResults = collectInputSelectorResults(\n        dependencies,\n        arguments\n      );\n      lastResult = memoizedResultFunc.apply(null, inputSelectorResults);\n      if (process.env.NODE_ENV !== \"production\") {\n        const { identityFunctionCheck, inputStabilityCheck } = getDevModeChecksExecutionInfo(firstRun, devModeChecks);\n        if (identityFunctionCheck.shouldRun) {\n          identityFunctionCheck.run(\n            resultFunc,\n            inputSelectorResults,\n            lastResult\n          );\n        }\n        if (inputStabilityCheck.shouldRun) {\n          const inputSelectorResultsCopy = collectInputSelectorResults(\n            dependencies,\n            arguments\n          );\n          inputStabilityCheck.run(\n            { inputSelectorResults, inputSelectorResultsCopy },\n            { memoize, memoizeOptions: finalMemoizeOptions },\n            arguments\n          );\n        }\n        if (firstRun)\n          firstRun = false;\n      }\n      return lastResult;\n    }, ...finalArgsMemoizeOptions);\n    return Object.assign(selector, {\n      resultFunc,\n      memoizedResultFunc,\n      dependencies,\n      dependencyRecomputations: () => dependencyRecomputations,\n      resetDependencyRecomputations: () => {\n        dependencyRecomputations = 0;\n      },\n      lastResult: () => lastResult,\n      recomputations: () => recomputations,\n      resetRecomputations: () => {\n        recomputations = 0;\n      },\n      memoize,\n      argsMemoize\n    });\n  };\n  Object.assign(createSelector2, {\n    withTypes: () => createSelector2\n  });\n  return createSelector2;\n}\nvar createSelector = /* @__PURE__ */ createSelectorCreator(weakMapMemoize);\n\n// src/createStructuredSelector.ts\nvar createStructuredSelector = Object.assign(\n  (inputSelectorsObject, selectorCreator = createSelector) => {\n    assertIsObject(\n      inputSelectorsObject,\n      `createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof inputSelectorsObject}`\n    );\n    const inputSelectorKeys = Object.keys(inputSelectorsObject);\n    const dependencies = inputSelectorKeys.map(\n      (key) => inputSelectorsObject[key]\n    );\n    const structuredSelector = selectorCreator(\n      dependencies,\n      (...inputSelectorResults) => {\n        return inputSelectorResults.reduce((composition, value, index) => {\n          composition[inputSelectorKeys[index]] = value;\n          return composition;\n        }, {});\n      }\n    );\n    return structuredSelector;\n  },\n  { withTypes: () => createStructuredSelector }\n);\nexport {\n  createSelector,\n  createSelectorCreator,\n  createStructuredSelector,\n  lruMemoize,\n  referenceEqualityCheck,\n  setGlobalDevModeChecks,\n  autotrackMemoize as unstable_autotrackMemoize,\n  weakMapMemoize\n};\n//# sourceMappingURL=reselect.mjs.map","/**\n * Polyfill for `Object.hasOwn`.\n *\n * `hasOwn(someObject, property)` should be used instead of\n * `someObject.hasOwnProperty(name)`.\n */\nexport function hasOwn(object: object, property: string): boolean {\n  return Object.prototype.hasOwnProperty.call(object, property);\n}\n","/**\n * Parses H account names of the form 'acct:<username>@<provider>'\n * into a {username, provider} object or null if the input does not\n * match the expected form.\n */\nexport function parseAccountID(user: string | null) {\n  if (!user) {\n    return null;\n  }\n  const match = user.match(/^acct:([^@]+)@(.+)/);\n  if (!match) {\n    return null;\n  }\n  return {\n    username: match[1],\n    provider: match[2],\n  };\n}\n\n/**\n * Build H account names of the form 'acct:<username>@<provider>'\n * from a username and provider.\n */\nexport function buildAccountID(username: string, provider: string): string {\n  return `acct:${username}@${provider}`;\n}\n\n/**\n * Returns the username part of an account ID or an empty string.\n */\nexport function username(user: string | null) {\n  const account = parseAccountID(user);\n  if (!account) {\n    return '';\n  }\n  return account.username;\n}\n\n/**\n * Returns true if the user's provider (authority) differs from the default\n * authority for the application.\n *\n * @param defaultAuthority - The application's default authority (user identity provider)\n */\nexport function isThirdPartyUser(\n  user: string | null,\n  defaultAuthority: string,\n) {\n  const account = parseAccountID(user);\n\n  if (!account) {\n    return false;\n  }\n\n  return account.provider !== defaultAuthority;\n}\n","import type {\n  APIAnnotationData,\n  Annotation,\n  EPUBContentSelector,\n  PageSelector,\n  SavedAnnotation,\n  Shape,\n  ShapeSelector,\n  TextQuoteSelector,\n} from '../../types/api';\n\n/**\n * Utility functions for querying annotation metadata.\n */\n\nexport type DocumentMetadata = {\n  uri: string;\n  domain: string;\n  title: string;\n};\n\n/**\n * Extract document metadata from an annotation.\n */\nexport function documentMetadata(\n  annotation: APIAnnotationData,\n): DocumentMetadata {\n  const uri = annotation.uri;\n\n  let domain;\n  try {\n    domain = new URL(uri).hostname;\n  } catch {\n    // Annotation URI parsing on the backend is very liberal compared to the URL\n    // constructor. There is also some historic invalid data in h (eg [1]).\n    // Hence, we must handle URL parsing failures in the client.\n    //\n    // [1] https://github.com/hypothesis/client/issues/3666\n    domain = '';\n  }\n  if (domain === 'localhost') {\n    domain = '';\n  }\n\n  let title = domain;\n  if (annotation.document && annotation.document.title) {\n    title = annotation.document.title[0];\n  }\n\n  return {\n    uri,\n    domain,\n    title,\n  };\n}\n\nexport type DomainAndTitle = {\n  domain: string;\n  titleText: string;\n  titleLink: string | null;\n};\n\n/**\n * Return the domain and title of an annotation for display on an annotation\n * card.\n */\nexport function domainAndTitle(annotation: Annotation): DomainAndTitle {\n  return {\n    domain: domainTextFromAnnotation(annotation),\n    titleText: titleTextFromAnnotation(annotation),\n    titleLink: titleLinkFromAnnotation(annotation),\n  };\n}\n\nfunction titleLinkFromAnnotation(annotation: Annotation): string | null {\n  let titleLink: string | null = annotation.uri;\n\n  if (\n    titleLink &&\n    !(titleLink.indexOf('http://') === 0 || titleLink.indexOf('https://') === 0)\n  ) {\n    // We only link to http(s) URLs.\n    titleLink = null;\n  }\n\n  if (annotation.links && annotation.links.incontext) {\n    titleLink = annotation.links.incontext;\n  }\n\n  return titleLink;\n}\n/**\n * Returns the domain text from an annotation.\n */\nfunction domainTextFromAnnotation(annotation: Annotation): string {\n  const document = documentMetadata(annotation);\n\n  let domainText = '';\n  if (document.uri && document.uri.indexOf('file://') === 0 && document.title) {\n    const parts = document.uri.split('/');\n    const filename = parts[parts.length - 1];\n    if (filename) {\n      domainText = filename;\n    }\n  } else if (document.domain && document.domain !== document.title) {\n    domainText = document.domain;\n  }\n\n  return domainText;\n}\n\n/**\n * Returns the title text from an annotation and crops it to 30 chars\n * if needed.\n */\nfunction titleTextFromAnnotation(annotation: Annotation): string {\n  const document = documentMetadata(annotation);\n\n  let titleText = document.title;\n  if (titleText.length > 30) {\n    titleText = titleText.slice(0, 30) + '…';\n  }\n\n  return titleText;\n}\n\n/**\n * Return `true` if the given annotation is a reply, `false` otherwise.\n */\nexport function isReply(annotation: APIAnnotationData): boolean {\n  return (annotation.references || []).length > 0;\n}\n\n/**\n * Return true if the given annotation has been saved to the backend and assigned\n * an ID.\n */\nexport function isSaved(annotation: Annotation): annotation is SavedAnnotation {\n  return !!annotation.id;\n}\n\n/**\n * Return true if an annotation has not been saved to the backend.\n *\n * @deprecated - Use {@link isSaved} instead\n */\nexport function isNew(annotation: APIAnnotationData): boolean {\n  return !annotation.id;\n}\n\n/**\n * Return `true` if the given annotation is public, `false` otherwise.\n */\nexport function isPublic(annotation: Annotation): boolean {\n  let isPublic = false;\n\n  if (!annotation.permissions) {\n    return isPublic;\n  }\n\n  annotation.permissions.read.forEach(perm => {\n    const readPermArr = perm.split(':');\n    if (readPermArr.length === 2 && readPermArr[0] === 'group') {\n      isPublic = true;\n    }\n  });\n\n  return isPublic;\n}\n\n/**\n * Return `true` if `annotation` has a selector.\n *\n * An annotation which has a selector refers to a specific part of a document,\n * as opposed to a Page Note which refers to the whole document or a reply,\n * which refers to another annotation.\n */\nfunction hasSelector(annotation: APIAnnotationData): boolean {\n  return !!(\n    annotation.target &&\n    annotation.target.length > 0 &&\n    annotation.target[0].selector\n  );\n}\n\n/**\n * Return `true` if the given annotation is not yet anchored.\n *\n * Returns false if anchoring is still in process but the flag indicating that\n * the initial timeout allowed for anchoring has expired.\n */\nexport function isWaitingToAnchor(annotation: Annotation): boolean {\n  return (\n    hasSelector(annotation) &&\n    typeof annotation.$orphan === 'undefined' &&\n    !annotation.$anchorTimeout\n  );\n}\n\n/**\n * Has this annotation hidden by moderators?\n */\nexport function isHidden(annotation: Annotation): boolean {\n  return !!annotation.hidden;\n}\n\n/**\n * Is this annotation a highlight?\n *\n * Highlights are generally identifiable by having no text content AND no tags,\n * but there is some nuance.\n */\nexport function isHighlight(\n  annotation: Annotation | APIAnnotationData,\n): boolean {\n  // `$highlight` is an ephemeral attribute set by the `annotator` on new\n  // annotation objects (created by clicking the \"highlight\" button).\n  // It is not persisted and cannot be relied upon, but if it IS present,\n  // this is definitely a highlight (one which is not yet saved).\n  if ('$highlight' in annotation && annotation.$highlight) {\n    return true;\n  }\n\n  if (isNew(annotation)) {\n    // For new (unsaved-to-service) annotations, unless they have a truthy\n    // `$highlight` attribute, we don't know yet if they are a highlight.\n    return false;\n  }\n\n  // Note that it is possible to end up with an empty (no `text`) annotation\n  // that is not a highlight by adding at least one tag—thus, it is necessary\n  // to check for the existence of tags as well as text content.\n\n  return (\n    !isPageNote(annotation) &&\n    !isReply(annotation) &&\n    !annotation.hidden && // A hidden annotation has some form of objectionable content\n    !annotation.text &&\n    !(annotation.tags && annotation.tags.length)\n  );\n}\n\n/**\n * Return `true` if the given annotation is an orphan.\n */\nexport function isOrphan(annotation: Annotation): boolean {\n  return hasSelector(annotation) && annotation.$orphan === true;\n}\n\n/**\n * Return `true` if the given annotation is a page note.\n */\nexport function isPageNote(annotation: APIAnnotationData): boolean {\n  return !hasSelector(annotation) && !isReply(annotation);\n}\n\n/**\n * Return `true` if the given annotation is a top level annotation, `false` otherwise.\n */\nexport function isAnnotation(annotation: Annotation): boolean {\n  return !!(hasSelector(annotation) && !isOrphan(annotation));\n}\n\n/**\n * Return a human-readable string describing the annotation's role.\n */\nexport function annotationRole(annotation: APIAnnotationData): string {\n  if (isReply(annotation)) {\n    return 'Reply';\n  } else if (isHighlight(annotation)) {\n    return 'Highlight';\n  } else if (isPageNote(annotation)) {\n    return 'Page note';\n  }\n  return 'Annotation';\n}\n\n/**\n * Key containing information needed to sort annotations based on their\n * associated position within the document.\n */\ntype LocationKey = {\n  /**\n   * EPUB Canonical Fragment Identifier.\n   *\n   * For annotations on EPUBs, this identifies the location of the chapter\n   * within the book's table of contents.\n   */\n  cfi?: string;\n\n  /**\n   * Text offset within the document segment, in UTF-16 code units.\n   *\n   * For web pages and PDFs this refers to the offset from the start of the\n   * document. In EPUBs this refers to the offset from the start of the Content\n   * Document (ie. chapter).\n   */\n  charOffset?: number;\n\n  /** Zero-based page index within the document. */\n  pageIndex?: number;\n\n  /**\n   * Distance from the top of the page or image.\n   *\n   * This is based on a comparison of the shape and anchor bounding boxes in\n   * a {@link ShapeSelector}.\n   */\n  top?: number;\n};\n\n/**\n * Return a key that can be used to sort annotations by document position.\n *\n * Note that the key may not have any fields set if the annotation is a page\n * note or was created via the Hypothesis API without providing the selectors\n * that this function uses.\n */\nexport function location(annotation: Annotation): LocationKey {\n  // We only consider the first target, since h and the client only support\n  // a single target.\n  const target = annotation.target[0];\n  if (!target?.selector) {\n    return {};\n  }\n\n  let cfi;\n  let charOffset;\n  let pageIndex;\n  let top;\n\n  // nb. We ignore the possibility of an annotation having multiple targets here.\n  // h and the client only support one.\n  for (const selector of target.selector) {\n    switch (selector.type) {\n      case 'TextPositionSelector':\n        charOffset = selector.start;\n        break;\n      case 'EPUBContentSelector':\n        cfi = selector.cfi;\n        break;\n      case 'PageSelector':\n        pageIndex = selector.index;\n        break;\n      case 'ShapeSelector':\n        top = distanceFromTopOfView(selector);\n        break;\n    }\n  }\n\n  return { cfi, charOffset, pageIndex, top };\n}\n\n/**\n * Return the distance of the top of a shape from the top of the containing\n * page, image or document.\n */\nfunction distanceFromTopOfView(selector: ShapeSelector): number | undefined {\n  const pageTop = selector.view?.top ?? 0;\n  switch (selector.shape.type) {\n    case 'rect':\n      return Math.abs(pageTop - selector.shape.top);\n    case 'point':\n      return Math.abs(pageTop - selector.shape.y);\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Return the number of times the annotation has been flagged\n * by other users. If moderation metadata is not present, returns `null`.\n */\nexport function flagCount(annotation: Annotation): number | null {\n  if (!annotation.moderation) {\n    return null;\n  }\n  return annotation.moderation.flagCount;\n}\n\n/**\n * Return the text quote that an annotation refers to.\n */\nexport function quote(annotation: APIAnnotationData): string | null {\n  if (annotation.target.length === 0) {\n    return null;\n  }\n  const target = annotation.target[0];\n  if (!target.selector) {\n    return null;\n  }\n  const quoteSel = target.selector.find(s => s.type === 'TextQuoteSelector') as\n    | TextQuoteSelector\n    | undefined;\n  return quoteSel ? quoteSel.exact : null;\n}\n\n/**\n * Return the shape of an annotation's target, if there is one.\n *\n * This will return `null` if the annotation is associated with a text\n * selection instead of a shape.\n */\nexport function shape(annotation: APIAnnotationData): Shape | null {\n  const shapeSelector = annotation.target[0]?.selector?.find(\n    s => s.type === 'ShapeSelector',\n  ) as ShapeSelector | undefined;\n  return shapeSelector?.shape ?? null;\n}\n\n/**\n * Return the EPUB Canonical Fragment Identifier for the table of contents entry\n * associated with the part of the book / document that an annotation was made\n * on.\n *\n * See {@link EPUBContentSelector}.\n */\nexport function cfi(annotation: APIAnnotationData): string | undefined {\n  const epubSel = annotation.target[0]?.selector?.find(\n    s => s.type === 'EPUBContentSelector',\n  ) as EPUBContentSelector | undefined;\n  return epubSel?.cfi;\n}\n\n/**\n * Return the label of the page that an annotation comes from.\n *\n * This is usually a 1-based page number, but can also be roman numerals etc.\n */\nexport function pageLabel(annotation: APIAnnotationData): string | undefined {\n  const pageSel = annotation.target[0]?.selector?.find(\n    s => s.type === 'PageSelector',\n  ) as PageSelector | undefined;\n  return pageSel?.label;\n}\n\n/**\n * Has this annotation been edited subsequent to its creation?\n */\nexport function hasBeenEdited(annotation: Annotation): boolean {\n  // New annotations created with the current `h` API service will have\n  // equivalent (string) values for `created` and `updated` datetimes.\n  // However, in the past, these values could have sub-second differences,\n  // which can make them appear as having been edited when they have not\n  // been. Only consider an annotation as \"edited\" if its creation time is\n  // more than 2 seconds before its updated time.\n  const UPDATED_THRESHOLD = 2000;\n\n  // If either time string is non-extant or they are equivalent...\n  if (\n    !annotation.updated ||\n    !annotation.created ||\n    annotation.updated === annotation.created\n  ) {\n    return false;\n  }\n\n  // Both updated and created SHOULD be ISO-8601-formatted strings\n  // with microsecond resolution; (NB: Date.prototype.getTime() returns\n  // milliseconds since epoch, so we're dealing in ms after this)\n  const created = new Date(annotation.created).getTime();\n  const updated = new Date(annotation.updated).getTime();\n  if (isNaN(created) || isNaN(updated)) {\n    // If either is not a valid date...\n    return false;\n  }\n  return updated - created > UPDATED_THRESHOLD;\n}\n","/**\n * Utility functions for collections: Sets, Maps, Arrays and Map-like objects\n */\n\n/**\n * Return the number of elements in `ary` for which `predicate` returns true.\n */\nexport function countIf<T>(ary: T[], predicate: (item: T) => boolean): number {\n  return ary.reduce((count, item) => {\n    return predicate(item) ? count + 1 : count;\n  }, 0);\n}\n\n/**\n * Convert an array of strings into an object mapping each array entry\n * to `true`.\n */\nexport function toTrueMap(arr: string[]): Record<string, true> {\n  const obj: Record<string, true> = {};\n  arr.forEach(key => (obj[key] = true));\n  return obj;\n}\n\n/**\n * Utility function that returns all the properties of an object whose\n * value is `true`.\n */\nexport function trueKeys(obj: Record<string, boolean>): string[] {\n  return Object.keys(obj).filter(key => obj[key] === true);\n}\n\n/**\n * Typed version of `Object.entries` for use with objects typed as\n * `Record<Key, Value>`.\n *\n * Unlike `Object.entries`, this preserves the type of the key.\n */\nexport function entries<Key extends string | number | symbol, Value>(\n  object: Record<Key, Value>,\n): [Key, Value][] {\n  return Object.entries(object) as [Key, Value][];\n}\n","import { createStoreModule, makeAction } from '../create-store';\n\nexport type RouteName =\n  | 'annotation'\n  | 'notebook'\n  | 'profile'\n  | 'sidebar'\n  | 'stream';\n\nexport type State = {\n  /** The current route. */\n  name: RouteName | null;\n\n  /**\n   * Parameters of the current route.\n   *\n   * - The \"annotation\" route has an \"id\" (annotation ID) parameter.\n   * - The \"stream\" route has a \"q\" (query) parameter.\n   * - The \"sidebar\" route has no parameters.\n   */\n  params: Record<string, string | undefined>;\n};\n\nconst initialState: State = {\n  name: null,\n  params: {},\n};\n\nconst reducers = {\n  CHANGE_ROUTE(\n    state: State,\n    { name, params }: { name: RouteName; params: Record<string, string> },\n  ) {\n    return { name, params };\n  },\n};\n\n/**\n * Change the active route.\n *\n * @param name - Name of the route to activate. See `initialState` for possible values\n * @param params - Parameters associated with the route\n */\nfunction changeRoute(name: RouteName, params: Record<string, string> = {}) {\n  return makeAction(reducers, 'CHANGE_ROUTE', { name, params });\n}\n\n/**\n * Return the name of the current route.\n */\nfunction route(state: State) {\n  return state.name;\n}\n\n/**\n * Return any parameters for the current route, extracted from the path and\n * query string.\n */\nfunction routeParams(state: State) {\n  return state.params;\n}\n\nexport const routeModule = createStoreModule(initialState, {\n  namespace: 'route',\n  reducers,\n  actionCreators: {\n    changeRoute,\n  },\n  selectors: {\n    route,\n    routeParams,\n  },\n});\n","import { createSelector } from 'reselect';\n\nimport type { Profile } from '../../../types/api';\nimport type { SidebarSettings } from '../../../types/config';\nimport { createStoreModule, makeAction } from '../create-store';\n\nexport type State = {\n  /**\n   * The app's default authority (user identity provider), from settings,\n   * e.g. `hypothes.is` or `localhost`\n   *\n   * FIXME: This is an empty string when `authDomain` is missing\n   * because other app logic has long assumed its string-y presence:\n   * behavior when it's missing is undefined. This setting should be\n   * enforced similarly to how `apiUrl` is enforced.\n   */\n  defaultAuthority: string;\n\n  /**\n   * Feature flags to enable, in addition to those that are enabled in the\n   * user's profile.\n   *\n   * This is used in the LMS app for example to enable features based on the\n   * LMS app installation in use, rather than the active H user account.\n   */\n  features: string[];\n\n  /**\n   * Profile object fetched from the `/api/profile` endpoint.\n   */\n  profile: Profile;\n};\n\n/**\n * A dummy profile returned by the `profile` selector before the real profile\n * is fetched.\n */\nconst initialProfile: Profile = {\n  /** A map of features that are enabled for the current user. */\n  features: {},\n  /** A map of preference names and values. */\n  preferences: {},\n  /**\n   * The authenticated user ID or null if the user is not logged in.\n   */\n  userid: null,\n};\n\nfunction initialState(settings: SidebarSettings): State {\n  return {\n    defaultAuthority: settings?.authDomain ?? '',\n    features: settings.features ?? [],\n    profile: initialProfile,\n  };\n}\n\nconst reducers = {\n  UPDATE_PROFILE(state: State, action: { profile: Profile }) {\n    return {\n      profile: { ...action.profile },\n    };\n  },\n};\n\n/**\n * Update the profile information for the current user.\n */\nfunction updateProfile(profile: Profile) {\n  return makeAction(reducers, 'UPDATE_PROFILE', { profile });\n}\n\nfunction defaultAuthority(state: State) {\n  return state.defaultAuthority;\n}\n\n/**\n * Return true if a user is logged in and false otherwise.\n */\nfunction isLoggedIn(state: State) {\n  return state.profile.userid !== null;\n}\n\n/**\n * Return the effective set of feature flags. This combines feature flags from\n * the profile with those from other sources.\n */\nconst features = createSelector(\n  (state: State) => state.profile,\n  (state: State) => state.features,\n  (profile: Profile, features: string[]): Record<string, boolean> => {\n    const combinedFeatures = { ...profile.features };\n    for (const feat of features) {\n      combinedFeatures[feat] = true;\n    }\n    return combinedFeatures;\n  },\n);\n\n/**\n * Return true if a given feature flag is enabled for the current user.\n *\n * @param feature - The name of the feature flag. This matches the name of the\n *   feature flag as declared in the Hypothesis service.\n */\nfunction isFeatureEnabled(state: State, feature: string) {\n  return Boolean(features(state)[feature]);\n}\n\n/**\n * Return true if the user's profile has been fetched. This can be used to\n * distinguish the dummy profile returned by `profile()` on startup from a\n * logged-out user profile returned by the server.\n */\nfunction hasFetchedProfile(state: State) {\n  return state.profile !== initialProfile;\n}\n\n/**\n * Return the user's profile.\n *\n * Returns the current user's profile fetched from the `/api/profile` endpoint.\n *\n * If the profile has not yet been fetched yet, a dummy logged-out profile is\n * returned. This allows code to skip a null check.\n *\n * NOTE: To check the set of enabled features, use the {@link features} selector\n * instead, since it combines features from the profile and other sources.\n */\nfunction profile(state: State) {\n  return state.profile;\n}\n\nexport const sessionModule = createStoreModule(initialState, {\n  namespace: 'session',\n  reducers,\n\n  actionCreators: {\n    updateProfile,\n  },\n\n  selectors: {\n    defaultAuthority,\n    features,\n    hasFetchedProfile,\n    isFeatureEnabled,\n    isLoggedIn,\n    profile,\n  },\n});\n","/**\n * State management for the set of annotations currently loaded into the\n * sidebar.\n */\nimport type { Dispatch } from 'redux';\nimport { createSelector } from 'reselect';\n\nimport { hasOwn } from '../../../shared/has-own';\nimport type { Annotation, SavedAnnotation } from '../../../types/api';\nimport type { HighlightCluster } from '../../../types/shared';\nimport { username as getUsername } from '../../helpers/account-id';\nimport * as metadata from '../../helpers/annotation-metadata';\nimport { isHighlight, isSaved } from '../../helpers/annotation-metadata';\nimport { countIf, toTrueMap, trueKeys } from '../../util/collections';\nimport { createStoreModule, makeAction } from '../create-store';\nimport { routeModule } from './route';\nimport type { State as RouteState } from './route';\nimport { sessionModule } from './session';\nimport type { State as SessionState } from './session';\n\ntype AnchorStatus = 'anchored' | 'orphan' | 'timeout';\n\ntype AnchorStatusUpdates = {\n  [$tag: string]: AnchorStatus;\n};\n\ntype AnnotationStub = {\n  /**\n   * Service-provided identifier if annotation has been\n   * persisted to the service\n   */\n  id?: string;\n\n  /** Local-generated identifier */\n  $tag?: string;\n};\n\nconst initialState = {\n  annotations: [],\n  highlighted: {},\n  hovered: {},\n  nextTag: 1,\n} as {\n  /** Set of currently-loaded annotations */\n  annotations: Annotation[];\n\n  /**\n   * The $tags of annotations that should appear as \"highlighted\", e.g. the\n   * target of a single-annotation view. NB: This feature is currently not\n   * supported in the application UI.\n   */\n  highlighted: { [$tag: string]: boolean };\n\n  /**\n   * The $tags of annotations whose cards or highlights are currently hovered.\n   * The styling of the highlights/cards of these annotations are adjusted to\n   * show the correspondence between the two.\n   */\n  hovered: { [$tag: string]: boolean };\n\n  /**\n   * The local tag to assign to the next annotation that is loaded into the app\n   */\n  nextTag: number;\n};\n\nexport type State = typeof initialState;\n\n/**\n * Return a copy of `current` with all matching annotations in `annotations`\n * removed (matched on identifier—`id` or `$tag`)\n *\n * Annotations in `annotations` may be complete annotations or \"stubs\" with only\n * the `id` field set.\n */\nfunction excludeAnnotations(\n  current: Annotation[],\n  annotations: AnnotationStub[],\n) {\n  const ids = new Set();\n  const tags = new Set();\n  for (const annot of annotations) {\n    if (annot.id) {\n      ids.add(annot.id);\n    }\n    if (annot.$tag) {\n      tags.add(annot.$tag);\n    }\n  }\n  return current.filter(annot => {\n    const shouldRemove =\n      (annot.id && ids.has(annot.id)) || (annot.$tag && tags.has(annot.$tag));\n    return !shouldRemove;\n  });\n}\n\nfunction findByID(annotations: Annotation[], id: string) {\n  return annotations.find(a => a.id === id);\n}\n\nfunction findByTag(annotations: Annotation[], tag: string) {\n  return annotations.find(a => a.$tag === tag);\n}\n\n/**\n * Merge client annotation data into the annotation object about to be added to\n * the store's collection of `annotations`.\n *\n * `annotation` may either be new (unsaved) or a persisted annotation retrieved\n * from the service.\n *\n * @param tag - The `$tag` value that should be used for this if it doesn't have\n * a `$tag` already\n * @return - API annotation data with client annotation data merged\n */\nfunction initializeAnnotation(\n  annotation: Omit<Annotation, '$anchorTimeout'>,\n  tag: string,\n  currentUserId: string | null,\n): Annotation {\n  let orphan = annotation.$orphan;\n\n  if (!annotation.id) {\n    // Unsaved (new) annotations must be anchored\n    orphan = false;\n  }\n\n  let $cluster: HighlightCluster = 'other-content';\n  if (annotation.user === currentUserId) {\n    $cluster = isHighlight(annotation) ? 'user-highlights' : 'user-annotations';\n  }\n\n  return Object.assign({}, annotation, {\n    $anchorTimeout: false,\n    $cluster,\n    $tag: annotation.$tag || tag,\n    $orphan: orphan,\n  });\n}\n\nconst reducers = {\n  ADD_ANNOTATIONS(\n    state: State,\n    action: {\n      annotations: Annotation[];\n      currentAnnotationCount: number;\n      currentUserId: string | null;\n    },\n  ): Partial<State> {\n    const updatedIDs = new Set();\n    const updatedTags = new Set();\n\n    const added = [];\n    const unchanged = [];\n    const updated = [];\n    let nextTag = state.nextTag;\n\n    for (const annot of action.annotations) {\n      let existing;\n      if (annot.id) {\n        existing = findByID(state.annotations, annot.id);\n      }\n      if (!existing && annot.$tag) {\n        existing = findByTag(state.annotations, annot.$tag);\n      }\n\n      if (existing) {\n        // Merge the updated annotation with the private fields from the local\n        // annotation\n        updated.push(Object.assign({}, existing, annot));\n        if (annot.id) {\n          updatedIDs.add(annot.id);\n        }\n        if (existing.$tag) {\n          updatedTags.add(existing.$tag);\n        }\n      } else {\n        added.push(\n          initializeAnnotation(annot, 't' + nextTag, action.currentUserId),\n        );\n        ++nextTag;\n      }\n    }\n\n    for (const annot of state.annotations) {\n      if (!updatedIDs.has(annot.id) && !updatedTags.has(annot.$tag)) {\n        unchanged.push(annot);\n      }\n    }\n\n    return {\n      annotations: added.concat(updated).concat(unchanged),\n      nextTag,\n    };\n  },\n\n  CLEAR_ANNOTATIONS(): Partial<State> {\n    return { annotations: [], highlighted: {}, hovered: {} };\n  },\n\n  HOVER_ANNOTATIONS(state: State, action: { tags: string[] }): Partial<State> {\n    return { hovered: toTrueMap(action.tags) };\n  },\n\n  HIDE_ANNOTATION(state: State, action: { id: string }): Partial<State> {\n    const anns = state.annotations.map(ann => {\n      if (ann.id !== action.id) {\n        return ann;\n      }\n      return { ...ann, hidden: true };\n    });\n    return { annotations: anns };\n  },\n\n  HIGHLIGHT_ANNOTATIONS(\n    state: State,\n    action: Pick<State, 'highlighted'>,\n  ): Partial<State> {\n    return { highlighted: action.highlighted };\n  },\n\n  REMOVE_ANNOTATIONS(\n    state: State,\n    action: {\n      annotationsToRemove: AnnotationStub[];\n      remainingAnnotations: Annotation[];\n    },\n  ): Partial<State> {\n    return {\n      annotations: [...action.remainingAnnotations],\n    };\n  },\n\n  UNHIDE_ANNOTATION(state: State, action: { id: string }): Partial<State> {\n    const anns = state.annotations.map(ann => {\n      if (ann.id !== action.id) {\n        return ann;\n      }\n      return Object.assign({}, ann, { hidden: false });\n    });\n    return { annotations: anns };\n  },\n\n  UPDATE_ANCHOR_STATUS(\n    state: State,\n    action: { statusUpdates: AnchorStatusUpdates },\n  ): Partial<State> {\n    const annotations = state.annotations.map(annot => {\n      if (!hasOwn(action.statusUpdates, annot.$tag)) {\n        return annot;\n      }\n\n      const state = action.statusUpdates[annot.$tag];\n      if (state === 'timeout') {\n        return Object.assign({}, annot, { $anchorTimeout: true });\n      } else {\n        return Object.assign({}, annot, { $orphan: state === 'orphan' });\n      }\n    });\n    return { annotations };\n  },\n\n  UPDATE_FLAG_STATUS(\n    state: State,\n    action: { id: string; isFlagged: boolean },\n  ): Partial<State> {\n    const annotations = state.annotations.map(annot => {\n      const match = annot.id && annot.id === action.id;\n      if (match) {\n        if (annot.flagged === action.isFlagged) {\n          return annot;\n        }\n\n        const newAnn = Object.assign({}, annot, {\n          flagged: action.isFlagged,\n        });\n        if (newAnn.moderation) {\n          const countDelta = action.isFlagged ? 1 : -1;\n          newAnn.moderation = {\n            ...newAnn.moderation,\n            flagCount: newAnn.moderation.flagCount + countDelta,\n          };\n        }\n        return newAnn;\n      } else {\n        return annot;\n      }\n    });\n    return { annotations };\n  },\n};\n\n/* Action creators */\n\n/**\n * Add these `annotations` to the current collection of annotations in the\n * store.\n */\nfunction addAnnotations(annotations: Annotation[]) {\n  return function (\n    dispatch: Dispatch,\n    getState: () => {\n      annotations: State;\n      route: RouteState;\n      session: SessionState;\n    },\n  ) {\n    const added = annotations.filter(annot => {\n      return (\n        !annot.id || !findByID(getState().annotations.annotations, annot.id)\n      );\n    });\n\n    const profile = sessionModule.selectors.profile(getState().session);\n\n    dispatch(\n      makeAction(reducers, 'ADD_ANNOTATIONS', {\n        annotations,\n        currentAnnotationCount: getState().annotations.annotations.length,\n        currentUserId: profile.userid,\n      }),\n    );\n\n    // If we're not in the sidebar, we're done here.\n    // FIXME Split the annotation-adding from the anchoring code; possibly\n    // move into service\n    if (routeModule.selectors.route(getState().route) !== 'sidebar') {\n      return;\n    }\n\n    // If anchoring fails to complete in a reasonable amount of time, then\n    // we assume that the annotation failed to anchor. If it does later\n    // successfully anchor then the status will be updated.\n    const ANCHORING_TIMEOUT = 500;\n\n    const anchoringIds = added\n      .filter(metadata.isWaitingToAnchor)\n      .map(ann => ann.id);\n\n    if (anchoringIds.length > 0) {\n      setTimeout(() => {\n        // Find annotations which haven't yet been anchored in the document.\n        const anns = getState().annotations.annotations;\n        const annsStillAnchoring = anchoringIds\n          .map(id => (id ? findByID(anns, id) : null))\n          .filter(ann => ann && metadata.isWaitingToAnchor(ann));\n\n        // Mark anchoring as timed-out for these annotations.\n        const anchorStatusUpdates = annsStillAnchoring.reduce(\n          (updates, ann) => {\n            updates[ann!.$tag] = 'timeout';\n            return updates;\n          },\n          {} as AnchorStatusUpdates,\n        );\n        dispatch(updateAnchorStatus(anchorStatusUpdates));\n      }, ANCHORING_TIMEOUT);\n    }\n  };\n}\n\n/** Set the currently displayed annotations to the empty set. */\nfunction clearAnnotations() {\n  return makeAction(reducers, 'CLEAR_ANNOTATIONS', undefined);\n}\n\n/**\n * Replace the current set of hovered annotations with the annotations\n * identified by `tags`.\n */\nfunction hoverAnnotations(tags: string[]) {\n  return makeAction(reducers, 'HOVER_ANNOTATIONS', { tags });\n}\n\n/**\n * Update the local hidden state of an annotation.\n *\n * This updates an annotation to reflect the fact that it has been hidden from\n * non-moderators.\n */\nfunction hideAnnotation(id: string) {\n  return makeAction(reducers, 'HIDE_ANNOTATION', { id });\n}\n\n/**\n * Highlight annotations with the given `ids`.\n *\n * This is used to add a visual indicator to specific annotation cards, like a\n * thread that was linked or annotations from pending updates that were applied.\n * Replaces the current map of highlighted annotations.\n * All provided annotations (`ids`) will be set to `true` in the `highlighted`\n * map.\n */\nfunction highlightAnnotations(ids: string[]) {\n  return makeAction(reducers, 'HIGHLIGHT_ANNOTATIONS', {\n    highlighted: toTrueMap(ids),\n  });\n}\n\n/**\n * Remove annotations from the currently displayed set.\n *\n * @param annotations - Annotations to remove. These may be complete annotations\n *   or stubs which only contain an `id` property.\n */\nexport function removeAnnotations(annotations: AnnotationStub[]) {\n  return (dispatch: Dispatch, getState: () => { annotations: State }) => {\n    const remainingAnnotations = excludeAnnotations(\n      getState().annotations.annotations,\n      annotations,\n    );\n    dispatch(\n      makeAction(reducers, 'REMOVE_ANNOTATIONS', {\n        annotationsToRemove: annotations,\n        remainingAnnotations,\n      }),\n    );\n  };\n}\n\n/**\n * Update the local hidden state of an annotation.\n *\n * This updates an annotation to reflect the fact that it has been made visible\n * to non-moderators.\n */\nfunction unhideAnnotation(id: string) {\n  return makeAction(reducers, 'UNHIDE_ANNOTATION', { id });\n}\n\n/**\n * Update the anchoring status of an annotation\n */\nfunction updateAnchorStatus(statusUpdates: AnchorStatusUpdates) {\n  return makeAction(reducers, 'UPDATE_ANCHOR_STATUS', { statusUpdates });\n}\n\n/**\n * Updating the flagged status of an annotation.\n */\nfunction updateFlagStatus(id: string, isFlagged: boolean) {\n  return makeAction(reducers, 'UPDATE_FLAG_STATUS', { id, isFlagged });\n}\n\n/* Selectors */\n\n/**\n * Count the number of annotations (as opposed to notes or orphans)\n */\nconst annotationCount = createSelector(\n  (state: State) => state.annotations,\n  annotations => countIf(annotations, metadata.isAnnotation),\n);\n\nfunction allAnnotations(state: State) {\n  return state.annotations;\n}\n\n/**\n * Does the annotation indicated by `id` exist in the collection?\n */\nfunction annotationExists(state: State, id: string) {\n  return state.annotations.some(annot => annot.id === id);\n}\n\nfunction findAnnotationByID(state: State, id: string) {\n  return findByID(state.annotations, id);\n}\n\n/**\n * Return the IDs of annotations that correspond to `tags`.\n *\n * If an annotation does not have an ID because it has not been created on\n * the server, there will be no entry for it in the returned array.\n */\nfunction findIDsForTags(state: State, tags: string[]) {\n  const ids = [];\n  for (const tag of tags) {\n    const annot = findByTag(state.annotations, tag);\n    if (annot && annot.id) {\n      ids.push(annot.id);\n    }\n  }\n  return ids;\n}\n\n/**\n * Retrieve currently-hovered annotation identifiers\n */\nconst hoveredAnnotations = createSelector(\n  (state: State) => state.hovered,\n  hovered => trueKeys(hovered),\n);\n\n/**\n * Retrieve currently-highlighted annotation identifiers\n */\nconst highlightedAnnotations = createSelector(\n  (state: State) => state.highlighted,\n  highlighted => trueKeys(highlighted),\n);\n\n/**\n * Is the annotation currently highlighted?\n */\nfunction isAnnotationHighlighted(state: State, annotation?: Annotation) {\n  return !!annotation?.id && state.highlighted[annotation.id] === true;\n}\n\n/**\n * Is the annotation identified by `$tag` currently hovered?\n */\nfunction isAnnotationHovered(state: State, $tag: string) {\n  return state.hovered[$tag] === true;\n}\n\n/**\n * Are there any annotations still waiting to anchor?\n */\nconst isWaitingToAnchorAnnotations = createSelector(\n  (state: State) => state.annotations,\n  annotations => annotations.some(metadata.isWaitingToAnchor),\n);\n\n/**\n * Return all loaded annotations that are not highlights and have not been saved\n * to the server\n */\nconst newAnnotations = createSelector(\n  (state: State) => state.annotations,\n  annotations =>\n    annotations.filter(\n      ann => metadata.isNew(ann) && !metadata.isHighlight(ann),\n    ),\n);\n\n/**\n * Return all loaded annotations that are highlights and have not been saved\n * to the server\n */\nconst newHighlights = createSelector(\n  (state: State) => state.annotations,\n  annotations =>\n    annotations.filter(ann => metadata.isNew(ann) && metadata.isHighlight(ann)),\n);\n\n/**\n * Count the number of page notes currently in the collection\n */\nconst noteCount = createSelector(\n  (state: State) => state.annotations,\n  annotations => countIf(annotations, metadata.isPageNote),\n);\n\n/**\n * Count the number of orphans currently in the collection\n */\nconst orphanCount = createSelector(\n  (state: State) => state.annotations,\n  annotations => countIf(annotations, metadata.isOrphan),\n);\n\n/**\n * Return all loaded annotations which have been saved to the server\n */\nconst savedAnnotations = createSelector(\n  (state: State) => state.annotations,\n  annotations => annotations.filter(ann => isSaved(ann)) as SavedAnnotation[],\n);\n\n/**\n * Return the list of unique users who authored any annotation, ordered by username.\n */\nconst usersWhoAnnotated = createSelector(\n  (state: State) => state.annotations,\n  annotations => {\n    const usersMap = new Map<\n      string,\n      { userid: string; username: string; displayName: string | null }\n    >();\n    annotations.forEach(anno => {\n      const { user: userid } = anno;\n\n      // Keep a unique list of users\n      if (usersMap.has(userid)) {\n        return;\n      }\n\n      const username = getUsername(userid);\n      const displayName = anno.user_info?.display_name ?? null;\n      usersMap.set(userid, { userid, username, displayName });\n    });\n\n    // Sort users by username\n    return [...usersMap.values()].sort((a, b) => {\n      const aUsername = a.username;\n      const bUsername = b.username;\n\n      return aUsername.localeCompare(bUsername, undefined, {\n        sensitivity: 'base',\n      });\n    });\n  },\n);\n\n/**\n * Return the list of unique users who have been mentioned in currently loaded\n * annotations.\n */\nconst usersWhoWereMentioned = createSelector(\n  (state: State) => state.annotations,\n  annotations => {\n    const mentions = annotations.flatMap(anno => anno.mentions ?? []);\n    const addedUserIds = new Set<string>();\n\n    return mentions\n      .filter(({ userid }) => {\n        const userAlreadyAdded = addedUserIds.has(userid);\n        addedUserIds.add(userid);\n        return !userAlreadyAdded;\n      })\n      .map(({ display_name: displayName, ...rest }) => ({\n        displayName,\n        ...rest,\n      }));\n  },\n);\n\nexport const annotationsModule = createStoreModule(initialState, {\n  namespace: 'annotations',\n  reducers,\n  actionCreators: {\n    addAnnotations,\n    clearAnnotations,\n    hoverAnnotations,\n    hideAnnotation,\n    highlightAnnotations,\n    removeAnnotations,\n    unhideAnnotation,\n    updateAnchorStatus,\n    updateFlagStatus,\n  },\n  selectors: {\n    allAnnotations,\n    annotationCount,\n    annotationExists,\n    findAnnotationByID,\n    findIDsForTags,\n    hoveredAnnotations,\n    highlightedAnnotations,\n    isAnnotationHighlighted,\n    isAnnotationHovered,\n    isWaitingToAnchorAnnotations,\n    newAnnotations,\n    newHighlights,\n    noteCount,\n    orphanCount,\n    savedAnnotations,\n    usersWhoAnnotated,\n    usersWhoWereMentioned,\n  },\n});\n","import { createStoreModule, makeAction } from '../create-store';\n\n/**\n * A store module for managing client-side user-convenience defaults.\n *\n * Example: the default privacy level for newly-created annotations\n * (`private` or `shared`). This default is updated when a user selects a\n * different publishing destination (e.g. `Post to [group name]` versus\n * `Post to Only Me`) from the menu rendered by the `AnnotationPublishControl`\n * component.\n *\n * At present, these defaults are persisted between app sessions in `localStorage`,\n * and their retrieval and re-persistence on change is handled in the\n * `persistedDefaults` service.\n */\n\nexport type State = {\n  annotationPrivacy: 'private' | 'shared' | null;\n  focusedGroup: string | null;\n};\n\nexport type Key = keyof State;\n\nconst initialState: State = {\n  annotationPrivacy: null,\n  focusedGroup: null,\n};\n\nconst reducers = {\n  SET_DEFAULT(state: State, action: { defaultKey: Key; value: string | null }) {\n    return { [action.defaultKey]: action.value };\n  },\n};\n\nfunction setDefault(defaultKey: Key, value: string | null) {\n  return makeAction(reducers, 'SET_DEFAULT', { defaultKey, value });\n}\n\n/** Selectors */\n\n/**\n * Retrieve the state's current value for `defaultKey`.\n */\nfunction getDefault(state: State, defaultKey: Key) {\n  return state[defaultKey];\n}\n\nfunction getDefaults(state: State) {\n  return state;\n}\n\nexport const defaultsModule = createStoreModule(initialState, {\n  namespace: 'defaults',\n  reducers,\n  actionCreators: {\n    setDefault,\n  },\n  selectors: {\n    getDefault,\n    getDefaults,\n  },\n});\n","import type { SidebarSettings } from '../../../types/config';\nimport { createStoreModule, makeAction } from '../create-store';\n\nexport type State = {\n  /**\n   * The ID of the direct-linked group.\n   *\n   * This ID is initialized from the client's configuration to indicate that\n   * the client should focus on a particular group initially. The user may\n   * need to log in for this step to complete. When the user navigates away\n   * from the group or clears the selection, the direct link is \"consumed\"\n   * and no longer used.\n   */\n  directLinkedGroupId: string | null;\n\n  /**\n   * The ID of the direct-linked annotation.\n   *\n   * This ID is initialized from the client's configuration to indicate that\n   * the client should focus on a particular annotation. The user may need to\n   * log in to see the annotation. When the user clears the selection or\n   * switches to a different group manually, the direct link is \"consumed\"\n   * and no longer used.\n   */\n  directLinkedAnnotationId: string | null;\n\n  /**\n   * Indicates that an error occurred in retrieving/showing the direct linked group.\n   * This could be because:\n   * - the group does not exist\n   * - the user does not have permission\n   * - the group is out of scope for the given page\n   */\n  directLinkedGroupFetchFailed: boolean;\n};\n\nfunction initialState(settings: SidebarSettings): State {\n  return {\n    directLinkedGroupId: settings.group || null,\n    directLinkedAnnotationId: settings.annotations || null,\n    directLinkedGroupFetchFailed: false,\n  };\n}\n\nconst reducers = {\n  UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED(\n    state: State,\n    action: { directLinkedGroupFetchFailed: boolean },\n  ) {\n    return {\n      directLinkedGroupFetchFailed: action.directLinkedGroupFetchFailed,\n    };\n  },\n\n  UPDATE_DIRECT_LINKED_GROUP_ID(\n    state: State,\n    action: { directLinkedGroupId: string },\n  ) {\n    return {\n      directLinkedGroupId: action.directLinkedGroupId,\n    };\n  },\n\n  UPDATE_DIRECT_LINKED_ANNOTATION_ID(\n    state: State,\n    action: { directLinkedAnnotationId: string },\n  ) {\n    return {\n      directLinkedAnnotationId: action.directLinkedAnnotationId,\n    };\n  },\n\n  CLEAR_DIRECT_LINKED_IDS() {\n    return {\n      directLinkedAnnotationId: null,\n      directLinkedGroupId: null,\n    };\n  },\n\n  CLEAR_SELECTION() {\n    return {\n      directLinkedAnnotationId: null,\n      directLinkedGroupId: null,\n      directLinkedGroupFetchFailed: false,\n    };\n  },\n};\n\nfunction setDirectLinkedGroupId(groupId: string) {\n  return makeAction(reducers, 'UPDATE_DIRECT_LINKED_GROUP_ID', {\n    directLinkedGroupId: groupId,\n  });\n}\n\nfunction setDirectLinkedAnnotationId(annId: string) {\n  return makeAction(reducers, 'UPDATE_DIRECT_LINKED_ANNOTATION_ID', {\n    directLinkedAnnotationId: annId,\n  });\n}\n\n/**\n * Set the direct linked group fetch failure to true.\n */\nfunction setDirectLinkedGroupFetchFailed() {\n  return makeAction(reducers, 'UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED', {\n    directLinkedGroupFetchFailed: true,\n  });\n}\n\nfunction clearDirectLinkedGroupFetchFailed() {\n  return makeAction(reducers, 'UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED', {\n    directLinkedGroupFetchFailed: false,\n  });\n}\n\n/**\n * Clear the direct linked annotations and group IDs.\n *\n * This action indicates that the direct link has been \"consumed\" and should\n * not affect future group/annotation etc. fetches.\n */\nfunction clearDirectLinkedIds() {\n  return makeAction(reducers, 'CLEAR_DIRECT_LINKED_IDS', undefined);\n}\n\nfunction directLinkedAnnotationId(state: State) {\n  return state.directLinkedAnnotationId;\n}\n\nfunction directLinkedGroupId(state: State) {\n  return state.directLinkedGroupId;\n}\n\nfunction directLinkedGroupFetchFailed(state: State) {\n  return state.directLinkedGroupFetchFailed;\n}\n\nexport const directLinkedModule = createStoreModule(initialState, {\n  namespace: 'directLinked',\n  reducers,\n  actionCreators: {\n    setDirectLinkedGroupFetchFailed,\n    setDirectLinkedGroupId,\n    setDirectLinkedAnnotationId,\n    clearDirectLinkedGroupFetchFailed,\n    clearDirectLinkedIds,\n  },\n  selectors: {\n    directLinkedAnnotationId,\n    directLinkedGroupFetchFailed,\n    directLinkedGroupId,\n  },\n});\n","/**\n * The drafts store provides temporary storage for unsaved edits to new or\n * existing annotations.\n */\nimport type { ThunkDispatch } from 'redux-thunk';\nimport { createSelector } from 'reselect';\n\nimport type { Annotation } from '../../../types/api';\nimport { createStoreModule, makeAction } from '../create-store';\nimport { removeAnnotations } from './annotations';\n\ntype AnnotationID = Pick<Annotation, 'id' | '$tag'>;\n\n/**\n * Edits made to a new or existing annotation by a user.\n *\n */\ntype DraftChanges = {\n  isPrivate: boolean;\n  tags: string[];\n  text: string;\n};\n\n/**\n * An unsaved set of changes to an annotation.\n *\n * This consists of an annotation ID ({@link AnnotationID}) and the edits\n * ({@link DraftChanges}) made by the user.\n */\nexport class Draft {\n  annotation: AnnotationID;\n  isPrivate: boolean;\n  tags: string[];\n  text: string;\n\n  constructor(annotation: AnnotationID, changes: DraftChanges) {\n    this.annotation = { id: annotation.id, $tag: annotation.$tag };\n    this.isPrivate = changes.isPrivate;\n    this.tags = changes.tags;\n    this.text = changes.text;\n  }\n  /**\n   * Returns true if this draft matches a given annotation.\n   *\n   * Annotations are matched by ID or local tag.\n   */\n  match(annotation: AnnotationID) {\n    return (\n      (this.annotation.$tag && annotation.$tag === this.annotation.$tag) ||\n      (this.annotation.id && annotation.id === this.annotation.id)\n    );\n  }\n  /**\n   * Return true if this draft is empty and can be discarded without losing\n   * any user input.\n   */\n  isEmpty() {\n    return !this.text && this.tags.length === 0;\n  }\n}\n\nexport type State = {\n  drafts: Draft[];\n};\n\nconst initialState: State = {\n  drafts: [],\n};\n\nconst reducers = {\n  DISCARD_ALL_DRAFTS() {\n    return { drafts: [] };\n  },\n\n  REMOVE_DRAFT(state: State, action: { annotation: AnnotationID }) {\n    const drafts = state.drafts.filter(draft => {\n      return !draft.match(action.annotation);\n    });\n    return { drafts };\n  },\n\n  UPDATE_DRAFT(state: State, action: { draft: Draft }) {\n    // removes a matching existing draft, then adds\n    const drafts = state.drafts.filter(draft => {\n      return !draft.match(action.draft.annotation);\n    });\n    drafts.push(action.draft); // push ok since it's a copy\n    return { drafts };\n  },\n};\n\n/**\n * Create or update the draft version for a given annotation by\n * replacing any existing draft or simply creating a new one.\n */\nfunction createDraft(annotation: AnnotationID, changes: DraftChanges) {\n  return makeAction(reducers, 'UPDATE_DRAFT', {\n    draft: new Draft(annotation, changes),\n  });\n}\n\n/**\n * Remove any drafts that are empty.\n *\n * An empty draft has no text and no reference tags.\n */\nfunction deleteNewAndEmptyDrafts() {\n  return (\n    dispatch: ThunkDispatch<{ drafts: State }, void, any>,\n    getState: () => { drafts: State },\n  ) => {\n    const newDrafts = getState().drafts.drafts.filter(draft => {\n      return (\n        !draft.annotation.id &&\n        !getDraftIfNotEmpty(getState().drafts, draft.annotation)\n      );\n    });\n    const removedAnnotations = newDrafts.map(draft => {\n      dispatch(removeDraft(draft.annotation));\n      return draft.annotation;\n    });\n    dispatch(removeAnnotations(removedAnnotations));\n  };\n}\n\n/**\n * Remove all drafts.\n */\nfunction discardAllDrafts() {\n  return makeAction(reducers, 'DISCARD_ALL_DRAFTS', undefined);\n}\n\n/**\n * Remove the draft version of an annotation.\n */\nfunction removeDraft(annotation: AnnotationID) {\n  return makeAction(reducers, 'REMOVE_DRAFT', { annotation });\n}\n\n/**\n * Returns the number of drafts - both unsaved new annotations, and unsaved\n * edits to saved annotations - currently stored.\n */\nfunction countDrafts(state: State) {\n  return state.drafts.length;\n}\n\n/**\n * Retrieve the draft changes for an annotation.\n */\nfunction getDraft(state: State, annotation: AnnotationID) {\n  const drafts = state.drafts;\n  for (let i = 0; i < drafts.length; i++) {\n    const draft = drafts[i];\n    if (draft.match(annotation)) {\n      return draft;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Returns the draft changes for an annotation, or null if no draft exists\n * or the draft is empty.\n */\nfunction getDraftIfNotEmpty(state: State, annotation: AnnotationID) {\n  const draft = getDraft(state, annotation);\n  if (!draft) {\n    return null;\n  }\n  return draft.isEmpty() ? null : draft;\n}\n\n/**\n * Returns a list of draft annotations which have no id.\n */\nconst unsavedAnnotations = createSelector(\n  (state: State) => state.drafts,\n  (drafts: Draft[]) =>\n    drafts.filter(d => !d.annotation.id).map(d => d.annotation),\n);\n\nexport const draftsModule = createStoreModule(initialState, {\n  namespace: 'drafts',\n  reducers,\n  actionCreators: {\n    createDraft,\n    deleteNewAndEmptyDrafts,\n    discardAllDrafts,\n    removeDraft,\n  },\n\n  selectors: {\n    countDrafts,\n    getDraft,\n    getDraftIfNotEmpty,\n    unsavedAnnotations,\n  },\n});\n","import type { Dispatch } from 'redux';\nimport { createSelector } from 'reselect';\n\nimport type { FocusConfig, SidebarSettings } from '../../../types/config';\nimport type { FocusUserInfo } from '../../../types/rpc';\nimport { createStoreModule, makeAction } from '../create-store';\n\nexport type FilterOption = {\n  /** The machine-readable value of the option */\n  value: string;\n  /** The human-facing \"pretty\" value of the option */\n  display: string;\n};\n\n/**\n * Supported filters. This should be a subset of the filters supported by the\n * `filterAnnotations` function that filters annotations in the sidebar.\n */\nexport type FilterKey = 'cfi' | 'page' | 'user';\n\nexport type Filters = Partial<Record<FilterKey, FilterOption | undefined>>;\n\n/**\n * Summary of the state of focus filters.\n */\nexport type FocusState = {\n  active: boolean;\n  configured: boolean;\n\n  /** Display name of the user that is focused. */\n  displayName?: string;\n\n  /** Page range that is focused. */\n  pageRange?: string;\n\n  /**\n   * Description of content this is focused.\n   *\n   * This is used in ebooks if the content is e.g. a chapter rather than page\n   * range.\n   */\n  contentRange?: string;\n};\n\n/**\n * State related to filtering of annotations in the UI.\n *\n * There are several layers of filters:\n *\n * - Filter/search queries entered by the user via the search UI\n *\n * - Focus filters which are filters supplied in the Hypothesis configuration.\n *   This is for contexts where there is some default filter that should be\n *   applied when the client loads. For example when grading a student's work,\n *   the client can be configured to start up showing only that user's annotations.\n *\n * - Filters/facets set via UI controls other than the search box.\n *   For example the Notebook has a user selection dropdown.\n */\nexport type State = {\n  /** Facet filters (eg. selected user) */\n  filters: Filters;\n\n  /** Active filter/search query. */\n  query: string | null;\n\n  /** Configuration for focus filters imported from client configuration. */\n  focusFilters: Filters;\n\n  /** Which filters from `focusFilters` are currently active. */\n  focusActive: Set<FilterKey>;\n};\n\nfunction initialState(settings: SidebarSettings): State {\n  const focusConfig = settings.focus || {};\n  const focusFilters = focusFiltersFromConfig(focusConfig);\n\n  return {\n    filters: {},\n    focusActive: new Set(Object.keys(focusFilters) as FilterKey[]),\n    focusFilters,\n    query: settings.query || null,\n  };\n}\n\n/**\n * Map focus filter configuration from settings to `focusFilters` state.\n */\nfunction focusFiltersFromConfig(focusConfig: FocusConfig): Filters {\n  const filters: Filters = {};\n\n  const user = focusConfig.user;\n  const userFilterValue = user?.username || user?.userid || '';\n\n  if (user && userFilterValue) {\n    filters.user = {\n      value: userFilterValue,\n      display: user.displayName || userFilterValue,\n    };\n  }\n\n  if (focusConfig.pages) {\n    filters.page = {\n      value: focusConfig.pages,\n      display: focusConfig.pages,\n    };\n  }\n\n  if (focusConfig.cfi) {\n    filters.cfi = {\n      value: focusConfig.cfi.range,\n      display: focusConfig.cfi.label,\n    };\n  }\n\n  return filters;\n}\n\nconst reducers = {\n  CHANGE_FOCUS_MODE_USER(state: State, action: { user: FocusUserInfo }) {\n    const focusFilters = { ...state.focusFilters };\n    const { user } = focusFiltersFromConfig({ user: action.user });\n\n    const focusActive = new Set(state.focusActive);\n    if (user !== undefined) {\n      focusActive.add('user');\n      focusFilters.user = user;\n    } else {\n      focusActive.delete('user');\n      delete focusFilters.user;\n    }\n\n    return {\n      focusActive,\n      focusFilters,\n    };\n  },\n\n  SET_FILTER(\n    state: State,\n    action: { filterName: FilterKey; filterOption: FilterOption },\n  ) {\n    const updatedFilters: Filters = {\n      ...state.filters,\n      [action.filterName]: action.filterOption,\n    };\n    // If the filter's value is empty, remove the filter\n    if (action.filterOption?.value === '') {\n      delete updatedFilters[action.filterName];\n    }\n    return { filters: updatedFilters };\n  },\n\n  SET_FILTER_QUERY(state: State, action: { query: string | null }) {\n    return { query: action.query };\n  },\n\n  SET_FOCUS_MODE(state: State, action: { key?: FilterKey; active?: boolean }) {\n    let focusActive = new Set(state.focusActive);\n    if (action.key !== undefined) {\n      // Toggle specific filter.\n      const active = action.active ?? !focusActive.has(action.key);\n      if (active) {\n        focusActive.add(action.key);\n      } else {\n        focusActive.delete(action.key);\n      }\n    } else {\n      // Toggle all configured filters.\n      const active = action.active ?? focusActive.size === 0;\n      if (active) {\n        focusActive = new Set(Object.keys(state.focusFilters) as FilterKey[]);\n      } else {\n        focusActive = new Set();\n      }\n    }\n    return {\n      focusActive,\n    };\n  },\n};\n\n// Action creators\n\n/**\n * Change the focused user filter and activate focus\n *\n * @param user - The user to focus on\n */\nfunction changeFocusModeUser(user: FocusUserInfo) {\n  return makeAction(reducers, 'CHANGE_FOCUS_MODE_USER', { user });\n}\n\nfunction setFilter(filterName: FilterKey, filterOption: FilterOption) {\n  return (dispatch: Dispatch, getState: () => { filters: State }) => {\n    // If there is a filter conflict with focusFilters, deactivate focus\n    // mode to prevent unintended collisions and let the new filter value\n    // take precedence.\n    if (getState().filters.focusFilters?.[filterName]) {\n      dispatch(\n        makeAction(reducers, 'SET_FOCUS_MODE', {\n          active: false,\n          key: filterName,\n        }),\n      );\n    }\n    dispatch(makeAction(reducers, 'SET_FILTER', { filterName, filterOption }));\n  };\n}\n\n/**\n * Set the query used to filter displayed annotations or `null` to clear the\n * filter.\n */\nfunction setFilterQuery(query: string | null) {\n  return makeAction(reducers, 'SET_FILTER_QUERY', { query });\n}\n\nexport type ToggleFocusModeArgs = {\n  /** Whether to activate or deactivate the focus mode, or toggle it (if undefined) */\n  active?: boolean;\n\n  /** Which focus filter to toggle. If undefined, all configured focus modes are toggled. */\n  key?: FilterKey;\n};\n\n/**\n * Toggle whether a given focus mode is applied.\n */\nfunction toggleFocusMode({ active, key }: ToggleFocusModeArgs = {}) {\n  return makeAction(reducers, 'SET_FOCUS_MODE', { active, key });\n}\n\n// Selectors\n\nfunction filterQuery(state: State) {\n  return state.query;\n}\n\n/**\n * Summary of focus state\n */\nconst focusState = createSelector(\n  (state: State) => state.focusActive,\n  (state: State) => state.focusFilters,\n  (focusActive, focusFilters): FocusState => {\n    return {\n      active: focusActive.size > 0,\n      // Check for filter with non-empty value.\n      configured: Object.values(focusFilters ?? {}).some(\n        val => typeof val !== 'undefined',\n      ),\n      displayName: focusFilters?.user?.display ?? '',\n      contentRange: focusFilters?.cfi?.display,\n      pageRange: focusFilters?.page?.display,\n    };\n  },\n);\n\n/**\n * Get all currently-applied filters. If focus is active, will also return\n * `focusFilters`, though `filters` will supersede in the case of key collisions.\n * `query` is not considered a \"filter\" in this context.\n */\nconst getFilters = createSelector(\n  (state: State) => state.filters,\n  (state: State) => state.focusActive,\n  (state: State) => state.focusFilters,\n  (filters, focusActive, focusFilters) => {\n    const mergedFilters: Filters = {};\n\n    // Add focus filters which are configured and active.\n    for (const key of focusActive) {\n      const focusFilter = focusFilters[key];\n\n      // nb. It _should_ always be the case that focus filters marked as active\n      // have a filter configuration in `focusFilters`.\n      if (focusFilter) {\n        mergedFilters[key] = focusFilter;\n      }\n    }\n\n    // Add other filters.\n    Object.assign(mergedFilters, filters);\n\n    return mergedFilters;\n  },\n);\n\n/**\n * Retrieve an applied filter by name/key\n */\nfunction getFilter(state: State, filterName: FilterKey) {\n  const filters = getFilters(state);\n  return filters[filterName];\n}\n\n/**\n * Retrieve the (string) values of all currently-applied filters.\n */\nconst getFilterValues = createSelector(\n  (state: State) => getFilters(state),\n  allFilters => {\n    const filterValues: Partial<Record<FilterKey, string>> = {};\n    for (const [key, options] of Object.entries(allFilters)) {\n      if (options) {\n        filterValues[key as FilterKey] = options.value;\n      }\n    }\n    return filterValues;\n  },\n);\n\nfunction getFocusFilters(state: State): Filters {\n  return state.focusFilters;\n}\n\n/** Return the set of active focus filters. */\nfunction getFocusActive(state: State): Set<FilterKey> {\n  return state.focusActive;\n}\n\n/**\n * Are there currently any active (applied) filters?\n */\nfunction hasAppliedFilter(state: State) {\n  const filters = getFilters(state);\n  return Boolean(state.query || Object.keys(filters).length);\n}\n\nexport const filtersModule = createStoreModule(initialState, {\n  namespace: 'filters',\n  reducers,\n  actionCreators: {\n    changeFocusModeUser,\n    setFilter,\n    setFilterQuery,\n    toggleFocusMode,\n  },\n  selectors: {\n    filterQuery,\n    focusState,\n    getFilter,\n    getFilters,\n    getFilterValues,\n    getFocusActive,\n    getFocusFilters,\n    hasAppliedFilter,\n  },\n});\n","//\n\nmodule.exports = function shallowEqual(objA, objB, compare, compareContext) {\n  var ret = compare ? compare.call(compareContext, objA, objB) : void 0;\n\n  if (ret !== void 0) {\n    return !!ret;\n  }\n\n  if (objA === objB) {\n    return true;\n  }\n\n  if (typeof objA !== \"object\" || !objA || typeof objB !== \"object\" || !objB) {\n    return false;\n  }\n\n  var keysA = Object.keys(objA);\n  var keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  var bHasOwnProperty = Object.prototype.hasOwnProperty.bind(objB);\n\n  // Test for A's keys different from B.\n  for (var idx = 0; idx < keysA.length; idx++) {\n    var key = keysA[idx];\n\n    if (!bHasOwnProperty(key)) {\n      return false;\n    }\n\n    var valueA = objA[key];\n    var valueB = objB[key];\n\n    ret = compare ? compare.call(compareContext, valueA, valueB, key) : void 0;\n\n    if (ret === false || (ret === void 0 && valueA !== valueB)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n","import { createSelector, createSelectorCreator, lruMemoize } from 'reselect';\nimport shallowEqual from 'shallowequal';\n\nimport type {\n  ContentInfoConfig,\n  DocumentMetadata,\n  SegmentInfo,\n} from '../../../types/annotator';\nimport { createStoreModule, makeAction } from '../create-store';\n\nexport type Frame = {\n  /**\n   * Sub-frames will all have a id (frame identifier) set. The main frame's id\n   * is always `null`\n   */\n  id: string | null;\n\n  /** Metadata about the document currently loaded in this frame */\n  metadata: DocumentMetadata;\n  /** Current primary URI of the document being displayed */\n  uri: string;\n  isAnnotationFetchComplete?: boolean;\n  /** Should this frame be retained in the sidebar if the guest disconnects? */\n  persistent: boolean;\n\n  /**\n   * Information about the section of a document that is currently loaded.\n   * This is for content such as EPUBs, where the content displayed in a guest\n   * frame is only part of the whole document.\n   */\n  segment?: SegmentInfo;\n};\n\nexport type State = {\n  frames: Frame[];\n\n  /**\n   * Data for the content information banner shown above the content in the main\n   * guest frame.\n   */\n  contentInfo: ContentInfoConfig | null;\n};\n\nconst initialState: State = {\n  frames: [],\n  contentInfo: null,\n};\n\nconst reducers = {\n  CONNECT_FRAME(state: State, action: { frame: Frame }) {\n    const frameIndex = state.frames.findIndex(\n      frame => frame.id === action.frame.id,\n    );\n    const newFrames = [...state.frames];\n    if (frameIndex !== -1) {\n      newFrames[frameIndex] = action.frame;\n    } else {\n      newFrames.push(action.frame);\n    }\n    return { frames: newFrames };\n  },\n\n  DESTROY_FRAME(state: State, action: { frame: Frame }) {\n    const frames = state.frames.filter(f => f !== action.frame);\n    return { frames };\n  },\n\n  UPDATE_FRAME_ANNOTATION_FETCH_STATUS(\n    state: State,\n    action: { uri: string; isAnnotationFetchComplete: boolean },\n  ) {\n    const frames = state.frames.map(frame => {\n      const match = frame.uri && frame.uri === action.uri;\n      if (match) {\n        return Object.assign({}, frame, {\n          isAnnotationFetchComplete: action.isAnnotationFetchComplete,\n        });\n      } else {\n        return frame;\n      }\n    });\n    return { frames };\n  },\n\n  SET_CONTENT_INFO(state: State, action: { info: ContentInfoConfig }) {\n    return { contentInfo: action.info };\n  },\n};\n\n/**\n * Add or replace a frame in the list of connected frames.\n *\n * If a frame exists with the same ID as `frame` it is replaced, otherwise\n * a new frame is added.\n */\nfunction connectFrame(frame: Frame) {\n  return makeAction(reducers, 'CONNECT_FRAME', { frame });\n}\n\n/**\n * Remove a frame from the list of connected frames.\n */\nfunction destroyFrame(frame: Frame) {\n  return makeAction(reducers, 'DESTROY_FRAME', { frame });\n}\n\n/**\n * Update the `isAnnotationFetchComplete` flag of the frame.\n */\nfunction updateFrameAnnotationFetchStatus(\n  uri: string,\n  isFetchComplete: boolean,\n) {\n  return makeAction(reducers, 'UPDATE_FRAME_ANNOTATION_FETCH_STATUS', {\n    uri,\n    isAnnotationFetchComplete: isFetchComplete,\n  });\n}\n\nfunction setContentInfo(info: ContentInfoConfig) {\n  return makeAction(reducers, 'SET_CONTENT_INFO', { info });\n}\n\n/**\n * Return the list of frames currently connected to the sidebar app.\n */\nfunction frames(state: State) {\n  return state.frames;\n}\n\nconst firstFrameWithoutId = (frames: Frame[]) =>\n  frames.find(f => !f.id) || null;\n\n/**\n * Return the \"main\" frame that the sidebar is connected to.\n *\n * The sidebar may be connected to multiple frames from different URLs.\n * For some purposes, the main frame (typically the top-level one that contains\n * the sidebar) needs to be distinguished. This selector returns the main frame\n * for that purpose.\n *\n * This may be `null` during startup.\n */\nconst mainFrame = createSelector(\n  (state: State) => state.frames,\n\n  // Sub-frames will all have a \"frame identifier\" set. The main frame is the\n  // one with a `null` id.\n  firstFrameWithoutId,\n);\n\n/**\n * Return the default frame that annotations are assumed to be associated with,\n * if they can't be matched to a more specific frame.\n *\n * For most document types this is the same as ({@see mainFrame}), but for\n * eg. VitalSource books there is no main frame, but instead only a frame with\n * the current chapter content.\n */\nconst defaultContentFrame = createSelector(\n  (state: State) => state.frames,\n  frames => {\n    const mainFrame = firstFrameWithoutId(frames);\n    if (mainFrame) {\n      return mainFrame;\n    } else if (frames.length > 0) {\n      return frames[0];\n    } else {\n      return null;\n    }\n  },\n);\n\nfunction searchUrisForFrame(frame: Frame): string[] {\n  let uris = [frame.uri];\n\n  if (frame.metadata && frame.metadata.documentFingerprint) {\n    uris = frame.metadata.link.map(link => {\n      return link.href;\n    });\n  }\n\n  if (frame.metadata && frame.metadata.link) {\n    frame.metadata.link.forEach(link => {\n      if (link.href.startsWith('doi:')) {\n        uris.push(link.href);\n      }\n    });\n  }\n\n  return uris;\n}\n\n// \"selector creator\" that uses `shallowEqual` instead of `===` for memoization\nconst createShallowEqualSelector = createSelectorCreator(\n  lruMemoize,\n  shallowEqual,\n);\n\n/**\n * Memoized selector will return the same array (of URIs) reference unless the\n * values of the array change (are not shallow-equal).\n */\nconst searchUris = createShallowEqualSelector(\n  (state: State) =>\n    state.frames.reduce<string[]>(\n      (uris, frame) => uris.concat(searchUrisForFrame(frame)),\n      [],\n    ),\n  uris => uris,\n  {\n    // This selector does the actual work in its \"input\" functions and then\n    // relies on Reselect not to call the identity result function if the\n    // result of the input function is value-equal to the previous result.\n    //\n    // This is not really how Reselect is supposed to be used, but it works.\n    //\n    // What we want to achieve is that the output doesn't change if the result\n    // is value-equal to the previous result (ie. the `state.frames` might\n    // have changed, but if the search URL array produced from them hasn't\n    // changed, the output reference should stay the same).\n    devModeChecks: { identityFunctionCheck: 'never' },\n  },\n);\n\nfunction getContentInfo(state: State) {\n  return state.contentInfo;\n}\n\nexport const framesModule = createStoreModule(initialState, {\n  namespace: 'frames',\n  reducers,\n\n  actionCreators: {\n    connectFrame,\n    destroyFrame,\n    setContentInfo,\n    updateFrameAnnotationFetchStatus,\n  },\n\n  selectors: {\n    getContentInfo,\n    frames,\n    mainFrame,\n    defaultContentFrame,\n    searchUris,\n  },\n});\n","import { createSelector } from 'reselect';\n\nimport type { Group, GroupMember } from '../../../types/api';\nimport { createStoreModule, makeAction } from '../create-store';\nimport { sessionModule } from './session';\nimport type { State as SessionState } from './session';\n\ntype GroupID = Group['id'];\n\nexport type FocusedGroupMembers =\n  | { status: 'not-loaded' }\n  | { status: 'loading' }\n  | { status: 'loaded'; members: GroupMember[] };\n\nexport type State = {\n  /**\n   * When there are entries, only `groups` with `id`s included in this list\n   * of will be displayed in the sidebar.\n   */\n  filteredGroupIds: GroupID[] | null;\n\n  /** List of groups. */\n  groups: Group[];\n  /** ID of currently selected group. */\n  focusedGroupId: string | null;\n\n  /** Members of currently selected group */\n  focusedGroupMembers: FocusedGroupMembers;\n};\n\nconst initialState: State = {\n  filteredGroupIds: null,\n  groups: [],\n  focusedGroupId: null,\n  focusedGroupMembers: {\n    status: 'not-loaded' as const,\n  },\n};\n\nconst reducers = {\n  FILTER_GROUPS(state: State, action: { filteredGroupIds: string[] }) {\n    if (!action.filteredGroupIds?.length) {\n      return {\n        filteredGroupIds: null,\n      };\n    }\n    const filteredGroups = state.groups.filter(g =>\n      action.filteredGroupIds.includes(g.id),\n    );\n    if (!filteredGroups.length) {\n      // If there are no matches in the full set of groups for any of the\n      // provided `filteredGroupIds`, don't set the filter.\n      return {\n        filteredGroupIds: null,\n      };\n    }\n    // Ensure we have a focused group that is in the set of filtered groups\n    let focusedGroupId = state.focusedGroupId;\n    if (!focusedGroupId || !action.filteredGroupIds.includes(focusedGroupId)) {\n      focusedGroupId = filteredGroups[0].id;\n    }\n    return {\n      filteredGroupIds: action.filteredGroupIds,\n      focusedGroupId,\n    };\n  },\n\n  FOCUS_GROUP(state: State, action: { id: string }) {\n    const group = state.groups.find(g => g.id === action.id);\n    if (!group) {\n      console.error(\n        `Attempted to focus group ${action.id} which is not loaded`,\n      );\n      return {};\n    }\n\n    const prevFocusedGroup = state.focusedGroupId;\n    if (prevFocusedGroup === action.id) {\n      return { focusedGroupId: action.id };\n    }\n\n    // Reset focused group members if focused group changed\n    return {\n      focusedGroupId: action.id,\n      focusedGroupMembers: { status: 'not-loaded' as const },\n    };\n  },\n\n  LOAD_GROUPS(state: State, action: { groups: Group[] }) {\n    const groups = action.groups;\n    let focusedGroupId = state.focusedGroupId;\n\n    // Reset focused group if not in the new set of groups.\n    if (\n      state.focusedGroupId === null ||\n      !groups.find(g => g.id === state.focusedGroupId)\n    ) {\n      if (groups.length > 0) {\n        focusedGroupId = groups[0].id;\n      } else {\n        focusedGroupId = null;\n      }\n    }\n\n    return {\n      focusedGroupId,\n      groups: action.groups,\n    };\n  },\n\n  LOAD_FOCUSED_GROUP_MEMBERS(\n    state: State,\n    action: { focusedGroupMembers: FocusedGroupMembers },\n  ) {\n    if (!state.focusedGroupId) {\n      throw new Error('A group needs to be focused before loading its members');\n    }\n\n    const { focusedGroupMembers } = action;\n    return { focusedGroupMembers };\n  },\n\n  CLEAR_GROUPS() {\n    return {\n      filteredGroupIds: null,\n      focusedGroupId: null,\n      groups: [],\n      focusedGroupMembers: { status: 'not-loaded' as const },\n    };\n  },\n};\n\nfunction clearGroups() {\n  return makeAction(reducers, 'CLEAR_GROUPS', undefined);\n}\n\n/**\n * Set filtered groups.\n */\nfunction filterGroups(filteredGroupIds: GroupID[]) {\n  return makeAction(reducers, 'FILTER_GROUPS', { filteredGroupIds });\n}\n\n/**\n * Set the current focused group.\n */\nfunction focusGroup(id: string) {\n  return makeAction(reducers, 'FOCUS_GROUP', { id });\n}\n\n/**\n * Update the set of loaded groups.\n */\nfunction loadGroups(groups: Group[]) {\n  return makeAction(reducers, 'LOAD_GROUPS', { groups });\n}\n\n/**\n * Indicate lading members for focused group has started.\n */\nfunction startLoadingFocusedGroupMembers() {\n  return makeAction(reducers, 'LOAD_FOCUSED_GROUP_MEMBERS', {\n    focusedGroupMembers: { status: 'loading' },\n  });\n}\n\n/**\n * Update members for focused group.\n */\nfunction loadFocusedGroupMembers(members: GroupMember[] | null) {\n  return makeAction(reducers, 'LOAD_FOCUSED_GROUP_MEMBERS', {\n    focusedGroupMembers:\n      members === null\n        ? { status: 'not-loaded' }\n        : {\n            status: 'loaded',\n            members,\n          },\n  });\n}\n\n/**\n * Return list of members for focused group.\n * Null is returned if members are being loaded or a group is not focused.\n */\nfunction getFocusedGroupMembers(state: State): FocusedGroupMembers {\n  return state.focusedGroupMembers;\n}\n\n/**\n * Return the currently focused group.\n */\nfunction focusedGroup(state: State): Group | null {\n  if (!state.focusedGroupId) {\n    return null;\n  }\n  return getGroup(state, state.focusedGroupId) ?? null;\n}\n\n/**\n * Return the current focused group ID or `null`.\n */\nfunction focusedGroupId(state: State) {\n  return state.focusedGroupId;\n}\n\n/**\n * Return the list of all groups, ignoring any filter present.\n */\nfunction allGroups(state: State) {\n  return state.groups;\n}\n\n/**\n * Return a list of groups filtered by any values in `filteredGroupIds`\n */\nfunction filteredGroups(state: State) {\n  if (!state.filteredGroupIds) {\n    return state.groups;\n  }\n  return state.groups.filter(g => state.filteredGroupIds?.includes(g.id));\n}\n\nfunction filteredGroupIds(state: State) {\n  return state.filteredGroupIds;\n}\n\n/**\n * Return the group with the given ID.\n */\nfunction getGroup(state: State, id: string): Group | undefined {\n  return state.groups.find(g => g.id === id);\n}\n\n/**\n * Return groups the user isn't a member of that are scoped to the URI.\n */\nconst getFeaturedGroups = createSelector(\n  (state: State) => filteredGroups(state),\n  groups => groups.filter(group => !group.isMember && group.isScopedToUri),\n);\n\n/**\n * Return groups that are scoped to the uri. This is used to return the groups\n * that show up in the old groups menu. This should be removed once the new groups\n * menu is permanent.\n */\nconst getInScopeGroups = createSelector(\n  (state: State) => filteredGroups(state),\n  groups => groups.filter(g => g.isScopedToUri),\n);\n\n// Selectors that receive root state.\n\ntype RootState = {\n  groups: State;\n  session: SessionState;\n};\n\n/**\n * Return groups the logged-in user is a member of.\n */\nconst getMyGroups = createSelector(\n  (rootState: RootState) => filteredGroups(rootState.groups),\n  (rootState: RootState) =>\n    sessionModule.selectors.isLoggedIn(rootState.session),\n  (groups, loggedIn) => {\n    // If logged out, the Public group still has isMember set to true so only\n    // return groups with membership in logged in state.\n    if (loggedIn) {\n      return groups.filter(g => g.isMember);\n    }\n    return [];\n  },\n);\n\n/**\n * Return groups that don't show up in Featured and My Groups.\n */\nconst getCurrentlyViewingGroups = createSelector(\n  (rootState: RootState) => filteredGroups(rootState.groups),\n  (rootState: RootState) => getMyGroups(rootState),\n  (rootState: RootState) => getFeaturedGroups(rootState.groups),\n  (allGroups, myGroups, featuredGroups) => {\n    return allGroups.filter(\n      g => !myGroups.includes(g) && !featuredGroups.includes(g),\n    );\n  },\n);\n\nexport const groupsModule = createStoreModule(initialState, {\n  namespace: 'groups',\n  reducers,\n  actionCreators: {\n    filterGroups,\n    focusGroup,\n    loadGroups,\n    startLoadingFocusedGroupMembers,\n    loadFocusedGroupMembers,\n    clearGroups,\n  },\n  selectors: {\n    allGroups,\n    filteredGroups,\n    filteredGroupIds,\n    focusedGroup,\n    focusedGroupId,\n    getFocusedGroupMembers,\n    getFeaturedGroups,\n    getGroup,\n    getInScopeGroups,\n  },\n  rootSelectors: {\n    getCurrentlyViewingGroups,\n    getMyGroups,\n  },\n});\n","import { hasOwn } from '../../shared/has-own';\n\n/**\n * Replace parameters in a URL template with values from a `params` object.\n *\n * Returns an object containing the expanded URL and a dictionary of unused\n * parameters.\n *\n *   replaceURLParams('/things/:id', {id: 'foo', q: 'bar'}) =>\n *     {url: '/things/foo', unusedParams: {q: 'bar'}}\n */\nexport function replaceURLParams<Param>(\n  url: string,\n  params: Record<string, Param>,\n): { url: string; unusedParams: Record<string, Param> } {\n  const unusedParams: Record<string, Param> = {};\n  for (const param in params) {\n    if (hasOwn(params, param)) {\n      const value = params[param];\n      const urlParam = ':' + param;\n      if (url.indexOf(urlParam) !== -1) {\n        url = url.replace(urlParam, encodeURIComponent(String(value)));\n      } else {\n        unusedParams[param] = value;\n      }\n    }\n  }\n  return { url, unusedParams };\n}\n\n/**\n * Resolve a relative URL against a base URL to get an absolute URL.\n */\nexport function resolve(relativeURL: string, baseURL: string): string {\n  return new URL(relativeURL, baseURL).href;\n}\n","import { replaceURLParams } from '../../util/url';\nimport { createStoreModule, makeAction } from '../create-store';\n\nexport type State = Record<string, string> | null;\n\nconst initialState: State = null;\n\nconst reducers = {\n  UPDATE_LINKS(state: State, action: { links: Record<string, string> }) {\n    return {\n      ...action.links,\n    };\n  },\n};\n\n/**\n * Update the link map\n *\n * @param links - Link map fetched from the `/api/links` endpoint\n */\nfunction updateLinks(links: Record<string, string>) {\n  return makeAction(reducers, 'UPDATE_LINKS', { links });\n}\n\n/**\n * Render a service link (URL) using the given `params`\n *\n * Returns an empty string if links have not been fetched yet.\n */\nfunction getLink(\n  state: State,\n  linkName: string,\n  params: Record<string, string> = {},\n) {\n  if (!state) {\n    return '';\n  }\n  const template = state[linkName];\n  if (!template) {\n    throw new Error(`Unknown link \"${linkName}\"`);\n  }\n  const { url, unusedParams } = replaceURLParams(template, params);\n  const unusedKeys = Object.keys(unusedParams);\n  if (unusedKeys.length > 0) {\n    throw new Error(`Unused parameters: ${unusedKeys.join(', ')}`);\n  }\n  return url;\n}\n\nexport const linksModule = createStoreModule(initialState as State, {\n  namespace: 'links',\n  reducers,\n  actionCreators: {\n    updateLinks,\n  },\n  selectors: {\n    getLink,\n  },\n});\n","/**\n * This module contains state related to real-time updates received via the\n * WebSocket connection to h's real-time API.\n */\nimport type { Dispatch } from 'redux';\nimport { createSelector } from 'reselect';\n\nimport { hasOwn } from '../../../shared/has-own';\nimport type { Annotation, Mention } from '../../../types/api';\nimport { createStoreModule, makeAction } from '../create-store';\nimport type { State as AnnotationsState } from './annotations';\nimport { annotationsModule } from './annotations';\nimport type { State as GroupsState } from './groups';\nimport { groupsModule } from './groups';\nimport type { State as RouteState } from './route';\nimport { routeModule } from './route';\nimport type { State as SessionState } from './session';\nimport { sessionModule } from './session';\n\nexport type AnnotationMap = Record<string, Annotation>;\nexport type BooleanMap = Record<string, boolean>;\n\nexport type State = {\n  /**\n   * Map of ID -> updated annotation for updates that have been received over\n   * the WebSocket but not yet applied (ie. saved to the \"annotations\" store\n   * module and shown in the UI).\n   */\n  pendingUpdates: AnnotationMap;\n\n  /**\n   * Set of IDs of annotations which have been deleted but for which the\n   * deletion has not yet been applied\n   */\n  pendingDeletions: BooleanMap;\n};\n\nconst initialState: State = {\n  pendingUpdates: {},\n  pendingDeletions: {},\n};\n\nconst reducers = {\n  RECEIVE_REAL_TIME_UPDATES(\n    state: State,\n    action: { pendingUpdates: AnnotationMap; pendingDeletions: BooleanMap },\n  ) {\n    return {\n      pendingUpdates: { ...action.pendingUpdates },\n      pendingDeletions: { ...action.pendingDeletions },\n    };\n  },\n\n  CLEAR_PENDING_UPDATES() {\n    return { pendingUpdates: {}, pendingDeletions: {} };\n  },\n\n  ADD_ANNOTATIONS(\n    state: State,\n    { annotations }: { annotations: Annotation[] },\n  ) {\n    // Discard any pending updates which conflict with an annotation added\n    // locally or fetched via an API call.\n    //\n    // If there is a conflicting local update/remote delete then we keep\n    // the pending delete. The UI should prevent the user from editing an\n    // annotation that has been deleted on the server.\n    const pendingUpdates = { ...state.pendingUpdates };\n\n    for (const ann of annotations) {\n      if (ann.id) {\n        delete pendingUpdates[ann.id];\n      }\n    }\n\n    return { pendingUpdates };\n  },\n\n  REMOVE_ANNOTATIONS(\n    state: State,\n    { annotationsToRemove }: { annotationsToRemove: Annotation[] },\n  ) {\n    // Discard any pending updates which conflict with an annotation removed\n    // locally.\n\n    const pendingUpdates = { ...state.pendingUpdates };\n    const pendingDeletions = { ...state.pendingDeletions };\n\n    for (const ann of annotationsToRemove) {\n      if (ann.id) {\n        delete pendingUpdates[ann.id];\n        delete pendingDeletions[ann.id];\n      }\n    }\n\n    return { pendingUpdates, pendingDeletions };\n  },\n\n  FOCUS_GROUP() {\n    // When switching groups we clear and re-fetch all annotations, so discard\n    // any pending updates.\n    return { pendingUpdates: {}, pendingDeletions: {} };\n  },\n};\n\n/**\n * Record pending updates representing changes on the server that the client\n * has been notified about but has not yet applied.\n */\nfunction receiveRealTimeUpdates({\n  updatedAnnotations = [],\n  deletedAnnotations = [],\n}: {\n  updatedAnnotations?: Annotation[];\n  deletedAnnotations?: Annotation[];\n}) {\n  return (\n    dispatch: Dispatch,\n    getState: () => {\n      realTimeUpdates: State;\n      annotations: AnnotationsState;\n      groups: GroupsState;\n      route: RouteState;\n    },\n  ) => {\n    const pendingUpdates = { ...getState().realTimeUpdates.pendingUpdates };\n    const pendingDeletions = { ...getState().realTimeUpdates.pendingDeletions };\n\n    updatedAnnotations.forEach(ann => {\n      // In the sidebar, only save pending updates for annotations in the\n      // focused group, since we only display annotations from the focused\n      // group and reload all annotations and discard pending updates\n      // when switching groups.\n      const groupState = getState().groups;\n      const routeState = getState().route;\n\n      if (\n        ann.group === groupsModule.selectors.focusedGroupId(groupState) ||\n        routeModule.selectors.route(routeState) !== 'sidebar'\n      ) {\n        pendingUpdates[ann.id!] = ann;\n      }\n    });\n    deletedAnnotations.forEach(ann => {\n      const id = ann.id!;\n      // Discard any pending but not-yet-applied updates for this annotation\n      delete pendingUpdates[id];\n\n      // If we already have this annotation loaded, then record a pending\n      // deletion. We do not check the group of the annotation here because a)\n      // that information is not included with deletion notifications and b)\n      // even if the annotation is from the current group, it might be for a\n      // new annotation (saved in pendingUpdates and removed above), that has\n      // not yet been loaded.\n      const annotationsState = getState().annotations;\n      if (annotationsModule.selectors.annotationExists(annotationsState, id)) {\n        pendingDeletions[id] = true;\n      }\n    });\n    dispatch(\n      makeAction(reducers, 'RECEIVE_REAL_TIME_UPDATES', {\n        pendingUpdates,\n        pendingDeletions,\n      }),\n    );\n  };\n}\n\n/**\n * Clear the queue of real-time updates which have been received but not applied.\n */\nfunction clearPendingUpdates() {\n  return makeAction(reducers, 'CLEAR_PENDING_UPDATES', undefined);\n}\n\n/**\n * Return added or updated annotations received via the WebSocket\n * which have not been applied to the local state.\n */\nfunction pendingUpdates(state: State) {\n  return state.pendingUpdates;\n}\n\n/**\n * Return IDs of annotations which have been deleted on the server but not\n * yet removed from the local state.\n */\nfunction pendingDeletions(state: State) {\n  return state.pendingDeletions;\n}\n\n/**\n * Return a total count of pending updates and deletions.\n */\nconst pendingUpdateCount = createSelector(\n  (state: State) => state.pendingUpdates,\n  (state: State) => state.pendingDeletions,\n  (pendingUpdates, pendingDeletions) =>\n    Object.keys(pendingUpdates).length + Object.keys(pendingDeletions).length,\n);\n\n/**\n * Return true if an annotation has been deleted on the server but the deletion\n * has not yet been applied.\n */\nfunction hasPendingDeletion(state: State, id: string) {\n  return hasOwn(state.pendingDeletions, id);\n}\n\n/**\n * Return true if an annotation has been created on the server, but it has not\n * yet been applied.\n */\nfunction hasPendingUpdates(state: State): boolean {\n  return Object.keys(state.pendingUpdates).length > 0;\n}\n\n/**\n * Return true if at least one annotation has been created or deleted on the\n * server, but it has not yet been applied.\n */\nfunction hasPendingUpdatesOrDeletions(state: State): boolean {\n  return pendingUpdateCount(state) > 0;\n}\n\ntype RootState = {\n  realTimeUpdates: State;\n  session: SessionState;\n  annotations: AnnotationsState;\n};\n\n/**\n * Return a total count of pending updates containing mentions for current user.\n * This includes any new annotation where current user was mentioned, or any\n * existing annotation which was edited to add a new mention to current user.\n */\nconst pendingMentionCount = createSelector(\n  (rootState: RootState) => rootState.realTimeUpdates.pendingUpdates,\n  (rootState: RootState) => sessionModule.selectors.profile(rootState.session),\n  (rootState: RootState) =>\n    annotationsModule.selectors.allAnnotations(rootState.annotations),\n  (pendingUpdates, { userid: currentUserId }, allAnnotations) => {\n    const pendingAnnotations = Object.values(pendingUpdates);\n    const mentionsIncludeCurrentUser = (mentions?: Mention[]) =>\n      !!mentions?.some(mention => mention.userid === currentUserId);\n\n    return pendingAnnotations.filter(({ mentions, id }) => {\n      const mentionsCurrentUser = mentionsIncludeCurrentUser(mentions);\n      const prevAnnotation = allAnnotations.find(a => a.id === id);\n\n      // For new annotations, we just need to check if they include a mention of\n      // current user\n      if (!prevAnnotation) {\n        return mentionsCurrentUser;\n      }\n\n      // For existing annotations, we also need to check that they did not\n      // already include mentions of current user.\n      return (\n        mentionsCurrentUser &&\n        !mentionsIncludeCurrentUser(prevAnnotation.mentions)\n      );\n    }).length;\n  },\n);\n\nexport const realTimeUpdatesModule = createStoreModule(initialState, {\n  namespace: 'realTimeUpdates',\n  reducers,\n  actionCreators: {\n    receiveRealTimeUpdates,\n    clearPendingUpdates,\n  },\n  selectors: {\n    hasPendingDeletion,\n    hasPendingUpdates,\n    hasPendingUpdatesOrDeletions,\n    pendingDeletions,\n    pendingUpdates,\n    pendingUpdateCount,\n  },\n  rootSelectors: {\n    pendingMentionCount,\n  },\n});\n","import type { Dispatch } from 'redux';\nimport { createSelector } from 'reselect';\n\nimport type { Annotation } from '../../../types/api';\nimport type { SidebarSettings } from '../../../types/config';\nimport type { TabName } from '../../../types/sidebar';\nimport * as metadata from '../../helpers/annotation-metadata';\nimport { countIf, trueKeys, toTrueMap } from '../../util/collections';\nimport { createStoreModule, makeAction } from '../create-store';\n\ntype BooleanMap = Record<string, boolean>;\nexport type SortKey = 'location' | 'newest' | 'oldest';\n\n/**\n * Default sort keys for each tab.\n */\nconst TAB_SORTKEY_DEFAULT: Record<TabName, SortKey> = {\n  annotation: 'location',\n  note: 'oldest',\n  orphan: 'location',\n};\n\nfunction initialSelection(settings: SidebarSettings): BooleanMap {\n  const selection: BooleanMap = {};\n  // TODO: Do not take into account existence of `settings.query` here\n  // once root-thread-building is fully updated: the decision of whether\n  // selection trumps any query is not one for the store to make\n  if (settings.annotations && !settings.query) {\n    selection[settings.annotations] = true;\n  }\n  return selection;\n}\n\nexport type State = {\n  /**\n   * A set of annotations that are currently \"selected\" by the user —\n   * these will supersede other filters/selections.\n   */\n  selected: BooleanMap;\n\n  /**\n   * Explicitly-expanded or -collapsed annotations (threads). A collapsed\n   * annotation thread will not show its replies; an expanded thread will\n   * show its replies. Note that there are other factors affecting\n   * collapsed states, e.g., top-level threads are collapsed by default\n   * until explicitly expanded.\n   */\n  expanded: BooleanMap;\n\n  /**\n   * Set of threads that have been \"forced\" visible by the user\n   * (e.g. by clicking on \"Show x more\" button) even though they may not\n   * match the currently-applied filters.\n   */\n  forcedVisible: BooleanMap;\n\n  selectedTab: TabName;\n\n  /**\n   * Sort order for annotations.\n   */\n  sortKey: SortKey;\n\n  /**\n   * ID or tag of an annotation that should be given keyboard focus.\n   */\n  focusRequest: string | null;\n};\n\nfunction initialState(settings: SidebarSettings): State {\n  return {\n    selected: initialSelection(settings),\n    expanded: initialSelection(settings),\n    forcedVisible: {},\n    selectedTab: 'annotation',\n    sortKey: TAB_SORTKEY_DEFAULT.annotation,\n    focusRequest: null,\n  };\n}\n\nfunction setTab(newTab: TabName, oldTab: TabName) {\n  // Do nothing if the \"new tab\" is the same as the tab already selected.\n  // This will avoid resetting the `sortKey`, too.\n  if (oldTab === newTab) {\n    return {};\n  }\n  return {\n    selectedTab: newTab,\n    sortKey: TAB_SORTKEY_DEFAULT[newTab],\n  };\n}\n\nconst resetSelection = () => {\n  return {\n    forcedVisible: {},\n    selected: {},\n  };\n};\n\nconst reducers = {\n  CLEAR_ANNOTATION_FOCUS_REQUEST() {\n    return { focusRequest: null };\n  },\n\n  CLEAR_SELECTION() {\n    return resetSelection();\n  },\n\n  SELECT_ANNOTATIONS(state: State, action: { selection: BooleanMap }) {\n    return { selected: action.selection };\n  },\n\n  SELECT_TAB(state: State, action: { tab: TabName }) {\n    return setTab(action.tab, state.selectedTab);\n  },\n\n  SET_EXPANDED(state: State, action: { id: string; expanded: boolean }) {\n    const newExpanded = { ...state.expanded };\n    newExpanded[action.id] = action.expanded;\n    return { expanded: newExpanded };\n  },\n\n  SET_ANNOTATION_FOCUS_REQUEST(state: State, action: { id: string }) {\n    return { focusRequest: action.id };\n  },\n\n  SET_FORCED_VISIBLE(state: State, action: { id: string; visible: boolean }) {\n    return {\n      forcedVisible: { ...state.forcedVisible, [action.id]: action.visible },\n    };\n  },\n\n  SET_SORT_KEY(state: State, action: { key: SortKey }) {\n    return { sortKey: action.key };\n  },\n\n  TOGGLE_SELECTED_ANNOTATIONS(state: State, action: { toggleIds: string[] }) {\n    const selection = { ...state.selected };\n    action.toggleIds.forEach(id => {\n      selection[id] = !selection[id];\n    });\n    return { selected: selection };\n  },\n\n  /** Actions defined in other modules */\n\n  /**\n   * Automatically select the Page Notes tab, for convenience, if all of the\n   * top-level annotations in `action.annotations` are Page Notes and the\n   * previous annotation count was 0 (i.e. collection empty).\n   */\n  ADD_ANNOTATIONS(\n    state: State,\n    action: { annotations: Annotation[]; currentAnnotationCount: number },\n  ) {\n    const topLevelAnnotations = action.annotations.filter(\n      annotation => !metadata.isReply(annotation),\n    );\n    const noteCount = countIf(action.annotations, metadata.isPageNote);\n\n    const haveOnlyPageNotes = noteCount === topLevelAnnotations.length;\n    if (action.currentAnnotationCount === 0 && haveOnlyPageNotes) {\n      return setTab('note', state.selectedTab);\n    }\n    return {};\n  },\n\n  CHANGE_FOCUS_MODE_USER() {\n    return resetSelection();\n  },\n\n  SET_FILTER() {\n    return { ...resetSelection(), expanded: {} };\n  },\n\n  SET_FILTER_QUERY() {\n    return { ...resetSelection(), expanded: {} };\n  },\n\n  SET_FOCUS_MODE() {\n    return resetSelection();\n  },\n\n  REMOVE_ANNOTATIONS(\n    state: State,\n    action: {\n      annotationsToRemove: Annotation[];\n      remainingAnnotations: Annotation[];\n    },\n  ) {\n    let newTab = state.selectedTab;\n    // If the orphans tab is selected but no remaining annotations are orphans,\n    // switch back to annotations tab\n    if (\n      newTab === 'orphan' &&\n      countIf(action.remainingAnnotations, metadata.isOrphan) === 0\n    ) {\n      newTab = 'annotation';\n    }\n\n    const removeAnns = (collection: BooleanMap) => {\n      action.annotationsToRemove.forEach(annotation => {\n        if (annotation.id) {\n          delete collection[annotation.id];\n        }\n        if (annotation.$tag) {\n          delete collection[annotation.$tag];\n        }\n      });\n      return collection;\n    };\n    return {\n      ...setTab(newTab, state.selectedTab),\n      expanded: removeAnns({ ...state.expanded }),\n      forcedVisible: removeAnns({ ...state.forcedVisible }),\n      selected: removeAnns({ ...state.selected }),\n    };\n  },\n};\n\n/**\n * Clear all selected annotations and filters. This will leave user-focus\n * alone, however.\n */\nfunction clearSelection() {\n  return makeAction(reducers, 'CLEAR_SELECTION', undefined);\n}\n\n/**\n * Set the currently selected annotation IDs. This will replace the current\n * selection. All provided annotation ids will be set to `true` in the selection.\n *\n * @param ids - Identifiers of annotations to select\n */\nfunction selectAnnotations(ids: string[]) {\n  return (dispatch: Dispatch) => {\n    dispatch(clearSelection());\n    dispatch(\n      makeAction(reducers, 'SELECT_ANNOTATIONS', { selection: toTrueMap(ids) }),\n    );\n  };\n}\n\n/**\n * Request the UI to give keyboard focus to a given annotation.\n *\n * Once the UI has processed this request, it should be cleared with\n * {@link clearAnnotationFocusRequest}.\n */\nfunction setAnnotationFocusRequest(id: string) {\n  return makeAction(reducers, 'SET_ANNOTATION_FOCUS_REQUEST', { id });\n}\n\n/**\n * Clear an annotation focus request created with {@link setAnnotationFocusRequest}.\n */\nfunction clearAnnotationFocusRequest() {\n  return makeAction(reducers, 'CLEAR_ANNOTATION_FOCUS_REQUEST', undefined);\n}\n\n/**\n * Set the currently-selected tab to `tabKey`.\n */\nfunction selectTab(tabKey: TabName) {\n  return makeAction(reducers, 'SELECT_TAB', { tab: tabKey });\n}\n\n/**\n * Set the expanded state for a single annotation/thread.\n *\n * @param id - annotation (or thread) id\n * @param expanded - `true` for expanded replies, `false` to collapse\n */\nfunction setExpanded(id: string, expanded: boolean) {\n  return makeAction(reducers, 'SET_EXPANDED', { id, expanded });\n}\n\n/**\n * A user may \"force\" an thread to be visible, even if it would be otherwise\n * not be visible because of applied filters. Set the force-visibility for a\n * single thread, without affecting other forced-visible threads.\n *\n * @param id - Thread id\n * @param visible - Should this annotation be visible, even if it conflicts\n *   with current filters?\n */\nfunction setForcedVisible(id: string, visible: boolean) {\n  return makeAction(reducers, 'SET_FORCED_VISIBLE', { id, visible });\n}\n\n/**\n * Sets the sort key for the annotation list.\n */\nfunction setSortKey(key: SortKey) {\n  return makeAction(reducers, 'SET_SORT_KEY', { key });\n}\n\n/**\n * Toggle the selected state for the annotations in `toggledAnnotations`:\n * unselect any that are selected; select any that are unselected.\n *\n * @param toggleIds - identifiers of annotations to toggle\n */\nfunction toggleSelectedAnnotations(toggleIds: string[]) {\n  return makeAction(reducers, 'TOGGLE_SELECTED_ANNOTATIONS', { toggleIds });\n}\n\n/**\n * Retrieve map of expanded/collapsed annotations (threads)\n */\nfunction expandedMap(state: State) {\n  return state.expanded;\n}\n\nfunction annotationFocusRequest(state: State) {\n  return state.focusRequest;\n}\n\nconst forcedVisibleThreads = createSelector(\n  (state: State) => state.forcedVisible,\n  forcedVisible => trueKeys(forcedVisible),\n);\n\n/**\n * Are any annotations currently selected?\n */\nconst hasSelectedAnnotations = createSelector(\n  (state: State) => state.selected,\n  selection => trueKeys(selection).length > 0,\n);\n\nconst selectedAnnotations = createSelector(\n  (state: State) => state.selected,\n  selection => trueKeys(selection),\n);\n\n/**\n * Return the currently-selected tab\n */\nfunction selectedTab(state: State) {\n  return state.selectedTab;\n}\n\nconst selectionState = createSelector(\n  (state: State) => state,\n  selection => {\n    return {\n      expanded: expandedMap(selection),\n      forcedVisible: forcedVisibleThreads(selection),\n      selected: selectedAnnotations(selection),\n      sortKey: sortKey(selection),\n      selectedTab: selectedTab(selection),\n    };\n  },\n);\n\n/**\n * Retrieve the current sort option key.\n */\nfunction sortKey(state: State) {\n  return state.sortKey;\n}\n\n/**\n * Retrieve applicable sort options for the currently-selected tab.\n */\nconst sortKeys = createSelector(\n  (state: State) => state.selectedTab,\n  selectedTab => {\n    const sortKeysForTab: SortKey[] = ['newest', 'oldest'];\n    if (selectedTab !== 'note') {\n      // Location is inapplicable to Notes tab\n      sortKeysForTab.push('location');\n    }\n    return sortKeysForTab;\n  },\n);\n\nexport const selectionModule = createStoreModule(initialState, {\n  namespace: 'selection',\n  reducers,\n\n  actionCreators: {\n    clearAnnotationFocusRequest,\n    clearSelection,\n    selectAnnotations,\n    selectTab,\n    setAnnotationFocusRequest,\n    setExpanded,\n    setForcedVisible,\n    setSortKey,\n    toggleSelectedAnnotations,\n  },\n\n  selectors: {\n    expandedMap,\n    annotationFocusRequest,\n    forcedVisibleThreads,\n    hasSelectedAnnotations,\n    selectedAnnotations,\n    selectedTab,\n    selectionState,\n    sortKey,\n    sortKeys,\n  },\n});\n","/**\n * This module handles the state for `SidebarPanel` components used in the app.\n * It keeps track of the \"active\" `panelName` (simple string) and allows the\n * opening, closing or toggling of panels via their `panelName`. It merely\n * retains the `panelName` state as a string: it has no understanding nor\n * opinions about whether a given `panelName` corresponds to one or more\n * extant `SidebarPanel` components. Only one panel (as keyed by `panelName`)\n * may be \"active\" (open) at one time.\n */\nimport type { PanelName } from '../../../types/sidebar';\nimport { createStoreModule, makeAction } from '../create-store';\n\nexport type State = {\n  /**\n   * The `panelName` of the currently-active sidebar panel.\n   * Only one `panelName` may be active at a time, but it is valid (though not\n   * the standard use case) for multiple `SidebarPanel` components to share\n   * the same `panelName`—`panelName` is not intended as a unique ID/key.\n   *\n   * e.g. If `activePanelName` were `foobar`, all `SidebarPanel` components\n   * with `panelName` of `foobar` would be active, and thus visible.\n   */\n  activePanelName: PanelName | null;\n};\n\nconst initialState: State = {\n  activePanelName: null,\n};\n\nconst reducers = {\n  OPEN_SIDEBAR_PANEL(state: State, action: { panelName: PanelName }) {\n    return { activePanelName: action.panelName };\n  },\n\n  CLOSE_SIDEBAR_PANEL(state: State, action: { panelName: PanelName }) {\n    let activePanelName = state.activePanelName;\n    if (action.panelName === activePanelName) {\n      // `action.panelName` is indeed the currently-active panel; deactivate\n      activePanelName = null;\n    }\n    // `action.panelName` is not the active panel; nothing to do here\n    return {\n      activePanelName,\n    };\n  },\n\n  TOGGLE_SIDEBAR_PANEL(\n    state: State,\n    action: { panelName: PanelName; panelState?: boolean },\n  ) {\n    let activePanelName;\n    // Is the panel in question currently the active panel?\n    const panelIsActive = state.activePanelName === action.panelName;\n    // What state should the panel in question move to next?\n    const panelShouldBeActive =\n      typeof action.panelState !== 'undefined'\n        ? action.panelState\n        : !panelIsActive;\n\n    if (panelShouldBeActive) {\n      // If the specified panel should be open (active), set it as active\n      activePanelName = action.panelName;\n    } else if (panelIsActive && !panelShouldBeActive) {\n      // If the specified panel is currently open (active), but it shouldn't be anymore\n      activePanelName = null;\n    } else {\n      // This panel is already inactive; do nothing\n      activePanelName = state.activePanelName;\n    }\n\n    return {\n      activePanelName,\n    };\n  },\n};\n\n/**\n * Designate `panelName` as the currently-active panel name\n */\nfunction openSidebarPanel(panelName: PanelName) {\n  return makeAction(reducers, 'OPEN_SIDEBAR_PANEL', { panelName });\n}\n\n/**\n * `panelName` should not be the active panel\n */\nfunction closeSidebarPanel(panelName: PanelName) {\n  return makeAction(reducers, 'CLOSE_SIDEBAR_PANEL', { panelName });\n}\n\n/**\n * Toggle a sidebar panel from its current state, or set it to the\n * designated `panelState`.\n *\n * @param panelState -\n *   Should the panel be active? Omit this prop to simply toggle the value.\n */\nfunction toggleSidebarPanel(panelName: PanelName, panelState?: boolean) {\n  return makeAction(reducers, 'TOGGLE_SIDEBAR_PANEL', {\n    panelName,\n    panelState,\n  });\n}\n\n/**\n * Is the panel indicated by `panelName` currently active (open)?\n */\nfunction isSidebarPanelOpen(state: State, panelName: PanelName) {\n  return state.activePanelName === panelName;\n}\n\nexport const sidebarPanelsModule = createStoreModule(initialState, {\n  namespace: 'sidebarPanels',\n  reducers,\n\n  actionCreators: {\n    openSidebarPanel,\n    closeSidebarPanel,\n    toggleSidebarPanel,\n  },\n\n  selectors: {\n    isSidebarPanelOpen,\n  },\n});\n","import type { ToastMessage } from '@hypothesis/frontend-shared';\n\nimport { createStoreModule, makeAction } from '../create-store';\n\n/**\n * A store module for managing a collection of toast messages. This module\n * maintains state only; it's up to other layers to handle the management\n * and interactions with these messages.\n */\n\nexport type State = {\n  messages: ToastMessage[];\n};\n\nconst initialState: State = {\n  messages: [],\n};\n\nconst reducers = {\n  ADD_MESSAGE(state: State, action: { message: ToastMessage }) {\n    return {\n      messages: state.messages.concat({ ...action.message }),\n    };\n  },\n\n  REMOVE_MESSAGE(state: State, action: { id: string }) {\n    const updatedMessages = state.messages.filter(\n      message => message.id !== action.id,\n    );\n    return { messages: updatedMessages };\n  },\n};\n\n/** Actions */\n\nfunction addMessage(message: ToastMessage) {\n  return makeAction(reducers, 'ADD_MESSAGE', { message });\n}\n\n/**\n * Remove the `message` with the corresponding `id` property value.\n */\nfunction removeMessage(id: string) {\n  return makeAction(reducers, 'REMOVE_MESSAGE', { id });\n}\n\n/** Selectors */\n\n/**\n * Retrieve a message by `id`\n */\nfunction getMessage(state: State, id: string) {\n  return state.messages.find(message => message.id === id);\n}\n\n/**\n * Retrieve all current messages\n */\nfunction getMessages(state: State) {\n  return state.messages;\n}\n\n/**\n * Return boolean indicating whether a message with the same type and message\n * text exists in the state's collection of messages. This matches messages\n * by content, not by ID (true uniqueness).\n */\nfunction hasMessage(state: State, type: ToastMessage['type'], text: string) {\n  return state.messages.some(message => {\n    return message.type === type && message.message === text;\n  });\n}\n\nexport const toastMessagesModule = createStoreModule(initialState, {\n  namespace: 'toastMessages',\n  reducers,\n  actionCreators: {\n    addToastMessage: addMessage,\n    removeToastMessage: removeMessage,\n  },\n  selectors: {\n    getToastMessage: getMessage,\n    getToastMessages: getMessages,\n    hasToastMessage: hasMessage,\n  },\n});\n","import { createStoreModule, makeAction } from '../create-store';\n\n/**\n * This module defines actions and state related to the display mode of the\n * sidebar.\n */\n\nexport type State = {\n  /**\n   * Has the sidebar ever been opened? NB: This is not necessarily the\n   * current state of the sidebar, but tracks whether it has ever been open\n   */\n  sidebarHasOpened: boolean;\n};\n\nconst initialState: State = {\n  sidebarHasOpened: false,\n};\n\nconst reducers = {\n  SET_SIDEBAR_OPENED(state: State, action: { opened: boolean }) {\n    if (action.opened === true) {\n      // If the sidebar is open, track that it has ever been opened\n      return { sidebarHasOpened: true };\n    }\n    // Otherwise, nothing to do here\n    return {};\n  },\n};\n\nfunction setSidebarOpened(opened: boolean) {\n  return makeAction(reducers, 'SET_SIDEBAR_OPENED', { opened });\n}\n\nfunction hasSidebarOpened(state: State) {\n  return state.sidebarHasOpened;\n}\n\nexport const viewerModule = createStoreModule(initialState, {\n  namespace: 'viewer',\n  reducers,\n  actionCreators: {\n    setSidebarOpened,\n  },\n  selectors: {\n    hasSidebarOpened,\n  },\n});\n","import { useLayoutEffect, useRef, useReducer } from 'preact/hooks';\n\nimport type { Store } from './create-store';\n\n/**\n * Result of a cached store selector method call.\n */\nclass CacheEntry<Args extends any[], Result> {\n  name: string;\n  method: (...args: Args) => Result;\n  args: Args;\n  result: Result;\n\n  /**\n   * @param name - Method name\n   * @param method - Method implementation\n   * @param args - Arguments to the selector\n   * @param result - Result of the invocation\n   */\n  constructor(\n    name: string,\n    method: (...args: Args) => Result,\n    args: Args,\n    result: Result,\n  ) {\n    this.name = name;\n    this.method = method;\n    this.args = args;\n    this.result = result;\n  }\n\n  matches(name: string, args: Args): boolean {\n    return (\n      this.name === name && this.args.every((value, i) => args[i] === value)\n    );\n  }\n}\n\n/**\n * Return a wrapper around a store that UI components can use to read from and\n * modify data in it.\n *\n * Unlike using the store directly, the wrapper tracks what data from\n * the store the current component uses, by recording calls to selector methods,\n * and re-renders the components when the results of those calls change.\n *\n * The returned wrapper has the same API as the store itself.\n *\n * The returned wrapper does not change its identity if the store updates. This\n * means you need to be careful when using it with hooks that have dependencies,\n * such as `useMemo`, `useEffect` or `useCallback`. Given code like this:\n *\n * ```\n * const calculatedValue = useMemo(() => calculateSomething(store.getSomeValue()), [store]);\n * ```\n *\n * `calulatedValue` will not be recalculated if the result of\n * `store.getSomeValue()` changes, because the `store` reference itself does not\n * change. A workaround is to extract the values from the store and pass those\n * into the closure:\n *\n * ```\n * const someValue = store.getSomeValue();\n * const calculatedValue = useMemo(() => calculateSomething(someValue), [someValue]);\n * ```\n *\n * @example\n *   // A hook which encapsulates looking up the specific store instance,\n *   // eg. via `useContext`.\n *   function useAppStore() {\n *     // Get the store from somewhere, eg. a prop or context.\n *     const appStore = ...;\n *     return useStore(appStore);\n *   }\n *\n *   function MyComponent() {\n *     const store = useAppStore();\n *     const currentUser = store.currentUser();\n *\n *     return (\n *       <div>\n *         Current user: {currentUser}.\n *         <button onClick={() => store.logOut()}>Log out</button>\n *       </div>\n *     );\n *   }\n *\n * @param store - The store to wrap\n * @return A proxy with the same API as `store`\n */\nexport function useStore<S extends Store<object, object, object>>(store: S): S {\n  // Hack to trigger a component re-render.\n  const [, forceUpdate] = useReducer(x => x + 1, 0);\n\n  // Cache of store method calls made by the current UI component and associated\n  // results. There is one entry per combination of method and arguments.\n  //\n  // This is currently just an array on the assumption that it will\n  // only have a small number of entries. It could be changed to a map keyed\n  // by method to handle many entries better.\n  const cacheRef = useRef<Array<CacheEntry<unknown[], unknown>>>([]);\n  const cache = cacheRef.current;\n\n  // Create the wrapper around the store.\n  const proxy = useRef<S | null>(null);\n  if (!proxy.current) {\n    // Cached method wrappers.\n    const wrappedMethods = new Map<string, (...args: unknown[]) => unknown>();\n\n    const get = <StoreType extends S>(\n      store: StoreType,\n      prop: keyof StoreType & string,\n    ) => {\n      const method = store[prop] as (...args: unknown[]) => unknown;\n      if (typeof method !== 'function') {\n        return method;\n      }\n\n      // Check for pre-existing method wrapper.\n      let wrapped = wrappedMethods.get(prop);\n      if (wrapped) {\n        return wrapped;\n      }\n\n      // Create method wrapper.\n      wrapped = (...args: unknown[]) => {\n        const cacheEntry = cache.find(entry => entry.matches(prop, args));\n        if (cacheEntry) {\n          return cacheEntry.result;\n        }\n\n        // Call the original method. It may be a selector that does not modify\n        // the store but returns a result, or an action that modifies the state.\n        const prevState = store.getState();\n        const result = method.apply(store, args);\n        const newState = store.getState();\n\n        if (prevState === newState) {\n          cache.push(new CacheEntry(prop, method, args, result));\n        }\n        return result;\n      };\n      wrappedMethods.set(prop, wrapped);\n\n      return wrapped;\n    };\n\n    proxy.current = new Proxy(store, { get });\n  }\n\n  // Register a subscriber which clears cache and re-renders component when\n  // relevant store state changes.\n  useLayoutEffect(() => {\n    const cleanup = store.subscribe(() => {\n      const invalidEntry = cache.find(\n        // nb. A potential problem here is that the method arguments may refer\n        // to things which no longer exist (for example, an object ID for an object\n        // which has been unloaded). It is assumed that store selector methods are\n        // robust to this.\n        entry => entry.method.apply(store, entry.args) !== entry.result,\n      );\n\n      if (invalidEntry) {\n        // We currently just invalidate the entire cache when any entry becomes\n        // invalid, but we could do more fine-grained checks.\n        cache.splice(0, cache.length);\n        forceUpdate(0);\n      }\n    });\n    return cleanup;\n  }, [cache, store]);\n\n  return proxy.current as S;\n}\n","import type { SidebarSettings } from '../../types/config';\nimport { useService } from '../service-context';\nimport { createStore } from './create-store';\nimport { debugMiddleware } from './debug-middleware';\nimport { activityModule } from './modules/activity';\nimport { annotationsModule } from './modules/annotations';\nimport { defaultsModule } from './modules/defaults';\nimport { directLinkedModule } from './modules/direct-linked';\nimport { draftsModule } from './modules/drafts';\nimport { filtersModule } from './modules/filters';\nimport { framesModule } from './modules/frames';\nimport { groupsModule } from './modules/groups';\nimport { linksModule } from './modules/links';\nimport { realTimeUpdatesModule } from './modules/real-time-updates';\nimport { routeModule } from './modules/route';\nimport { selectionModule } from './modules/selection';\nimport { sessionModule } from './modules/session';\nimport { sidebarPanelsModule } from './modules/sidebar-panels';\nimport { toastMessagesModule } from './modules/toast-messages';\nimport { viewerModule } from './modules/viewer';\nimport { useStore } from './use-store';\n\nexport type SidebarStore = ReturnType<typeof createSidebarStore>;\n\n/**\n * Create the central state store for the sidebar application.\n *\n * This is a Redux [1] store composed of several modules, augmented with\n * _selector_ methods for querying it and _action_ methods for applying updates.\n * See the `createStore` documentation for API and usage details.\n *\n * [1] https://redux.js.org\n *\n * @inject\n */\nexport function createSidebarStore(settings: SidebarSettings) {\n  const middleware = [debugMiddleware];\n\n  // `const` type gives `modules` a tuple type, which allows `createStore`\n  // to infer properties (eg. action and selector methods) of returned store.\n  const modules = [\n    activityModule,\n    annotationsModule,\n    defaultsModule,\n    directLinkedModule,\n    draftsModule,\n    filtersModule,\n    framesModule,\n    linksModule,\n    groupsModule,\n    realTimeUpdatesModule,\n    routeModule,\n    selectionModule,\n    sessionModule,\n    sidebarPanelsModule,\n    toastMessagesModule,\n    viewerModule,\n  ] as const;\n  return createStore(modules, [settings], middleware);\n}\n\n/**\n * Hook for accessing the sidebar's store in UI components.\n *\n * Returns a wrapper around the store which tracks its usage by the component\n * and re-renders the component when relevant data in the store changes. See\n * {@link useStore}.\n */\nexport function useSidebarStore(): SidebarStore {\n  const store = useService('store') as SidebarStore;\n  return useStore(store);\n}\n","import { Button, Panel, RestrictedIcon } from '@hypothesis/frontend-shared';\n\nimport { useSidebarStore } from '../store';\n\nexport type SidebarContentErrorProps = {\n  errorType: 'annotation' | 'group';\n\n  /** Whether or not to render a \"Clear selection\" button */\n  showClearSelection?: boolean;\n\n  /** A function that will launch the login flow for the user */\n  onLoginRequest: () => void;\n};\n\n/**\n * Show an error indicating that an annotation or group referenced in the URL\n * could not be fetched.\n */\nexport default function SidebarContentError({\n  errorType,\n  onLoginRequest,\n  showClearSelection = false,\n}: SidebarContentErrorProps) {\n  const store = useSidebarStore();\n  const isLoggedIn = store.isLoggedIn();\n\n  const errorTitle =\n    errorType === 'annotation' ? 'Annotation unavailable' : 'Group unavailable';\n\n  const errorMessage = (() => {\n    if (!isLoggedIn) {\n      return `The ${errorType} associated with the current URL is unavailable.\n        You may need to log in to see it.`;\n    }\n    if (errorType === 'group') {\n      return `The current URL links to a group, but that group cannot be found,\n        or you do not have permission to view the annotations in that group.`;\n    }\n    return `The current URL links to an annotation, but that annotation\n      cannot be found, or you do not have permission to view it.`;\n  })();\n\n  return (\n    <div className=\"mb-4\">\n      <Panel icon={RestrictedIcon} title={errorTitle}>\n        <p>{errorMessage}</p>\n        <div className=\"flex justify-end space-x-2\">\n          {showClearSelection && (\n            <Button\n              variant={isLoggedIn ? 'primary' : undefined}\n              onClick={() => store.clearSelection()}\n            >\n              Show all annotations\n            </Button>\n          )}\n          {!isLoggedIn && (\n            <Button variant=\"primary\" onClick={onLoginRequest}>\n              Log in\n            </Button>\n          )}\n        </div>\n      </Panel>\n    </div>\n  );\n}\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n","import type { Thread } from './build-thread';\n\nexport const THREAD_DIMENSION_DEFAULTS = {\n  // When we don't have a real measurement of a thread card's height (yet)\n  // from the browser, use this as an approximate value, in pixels.\n  defaultHeight: 200,\n  // Space above the viewport in pixels which should be considered 'on-screen'\n  // when calculating the set of visible threads\n  marginAbove: 800,\n  // Same as MARGIN_ABOVE but for the space below the viewport\n  marginBelow: 800,\n};\n\ntype VisibleThreads = {\n  visibleThreads: Thread[];\n  offscreenUpperHeight: number;\n  offscreenLowerHeight: number;\n};\n\n/**\n * Calculate the set of `ThreadCard`s that should be rendered by\n * estimating which of the threads are within or near the viewport.\n *\n * @param threads - List of threads in the order they appear\n * @param threadHeights - Map of thread ID to measured height\n * @param scrollPos - Vertical scroll offset of scrollable container\n * @param windowHeight - Height of the visible area of the scrollable container.\n * @param options - Dimensional overrides (in px) for defaults\n */\nexport function calculateVisibleThreads(\n  threads: Thread[],\n  threadHeights: Map<string, number>,\n  scrollPos: number,\n  windowHeight: number,\n  options: typeof THREAD_DIMENSION_DEFAULTS = THREAD_DIMENSION_DEFAULTS,\n): VisibleThreads {\n  const { defaultHeight, marginAbove, marginBelow } = options;\n  const visibleThreads: Thread[] = [];\n\n  // Total height used up by the top-level thread cards\n  let totalHeight = 0;\n  // Estimated height, in px, of the thread cards above and below the viewport\n  let offscreenUpperHeight = 0;\n  let offscreenLowerHeight = 0;\n\n  threads.forEach(thread => {\n    const threadHeight = threadHeights.get(thread.id) || defaultHeight;\n\n    const threadIsAboveViewport =\n      totalHeight + threadHeight < scrollPos - marginAbove;\n    const threadIsVisible =\n      totalHeight < scrollPos + windowHeight + marginBelow;\n\n    if (threadIsAboveViewport) {\n      offscreenUpperHeight += threadHeight;\n    } else if (threadIsVisible) {\n      visibleThreads.push(thread);\n    } else {\n      // thread is below visible viewport\n      offscreenLowerHeight += threadHeight;\n    }\n    totalHeight += threadHeight;\n  });\n\n  return {\n    visibleThreads,\n    offscreenUpperHeight,\n    offscreenLowerHeight,\n  };\n}\n","/**\n * Obtain the pixel height of the provided DOM element, including\n * top and bottom margins.\n *\n * Note that this function *only* accounts for margins on `element`, not any\n * descendants which may contribute to the effective margin due to CSS \"margin\n * collapsing\".\n *\n * @param element - DOM element to measure\n * @return The element's height in pixels\n */\nexport function getElementHeightWithMargins(element: Element): number {\n  const style = window.getComputedStyle(element);\n  // Get the height of the element inside the border-box, excluding\n  // top and bottom margins.\n  const elementHeight = element.getBoundingClientRect().height;\n\n  // Get the bottom margin of the element. style.margin{Side} will return\n  // values of the form 'Npx', from which we extract 'N'.\n  const marginHeight =\n    parseFloat(style.marginTop) + parseFloat(style.marginBottom);\n\n  return elementHeight + marginHeight;\n}\n","import type { Annotation } from '../../types/api';\nimport type { Thread } from './build-thread';\n\n/**\n * Count the number of annotations/replies in the `thread` whose `visible`\n * property matches `visibility`.\n *\n * @param visibility — `true`: count visible annotations\n *                     `false`: count hidden annotations\n */\nfunction countByVisibility(thread: Thread, visibility: boolean): number {\n  const matchesVisibility = thread.visible === visibility;\n  return thread.children.reduce(\n    (count, reply) => count + countByVisibility(reply, visibility),\n    matchesVisibility ? 1 : 0,\n  );\n}\n\n/**\n * Count the hidden annotations/replies in the `thread`\n */\nexport function countHidden(thread: Thread): number {\n  return countByVisibility(thread, false);\n}\n\n/**\n * Count the visible annotations/replies in the `thread`\n */\nexport function countVisible(thread: Thread): number {\n  return countByVisibility(thread, true);\n}\n\n/**\n * Find the topmost annotations in a thread.\n *\n * For the (vast) majority of threads, this is the single annotation at the\n * top level of the thread hierarchy.\n *\n * However, when the top-level thread lacks\n * an annotation, as is the case if that annotation has been deleted but still\n * has replies, find the first level of descendants that has at least one\n * annotation (reply) and return the set of annotations (replies) at that level.\n *\n * For example, given the (overly-complex) thread-annotation structure of:\n *\n * [missing]\n *   - [missing]\n *       - reply 1\n *            - reply 2\n *            - reply 3\n *       - reply 4\n *   - [missing]\n *       - reply 5\n *   - [missing]\n *      - [missing]\n *          - reply 6\n *\n * Return [reply 1, reply 4, reply 5]\n */\nexport function rootAnnotations(threads: Thread[]): Annotation[] {\n  // If there are any threads at this level with extant annotations, return\n  // those annotations\n  const threadAnnotations = threads\n    .filter(thread => !!thread.annotation)\n    .map(thread => thread.annotation!);\n\n  if (threadAnnotations.length) {\n    return threadAnnotations;\n  }\n\n  // Else, search across all children at once (an entire hierarchical level)\n  const allChildren: Thread[] = [];\n  threads.forEach(thread => {\n    if (thread.children) {\n      allChildren.push(...thread.children);\n    }\n  });\n  if (allChildren.length) {\n    return rootAnnotations(allChildren);\n  }\n\n  throw new Error('Thread contains no annotations');\n}\n","import type { Annotation } from '../../types/api';\nimport type { SidebarSettings } from '../../types/config';\nimport { isThirdPartyUser, username } from './account-id';\n\n/**\n * What string should we use to represent the author (user) of a given\n * annotation: a display name or a username?\n *\n * The nice, human-readable display name should be used when a display_name\n * is available on the annotation AND:\n * - The author (user) associated with the annotation is a third-party user, OR\n * - The `client_display_names` feature flag is enabled\n *\n * Return the string that should be used for display on an annotation: either the\n * username or the display name.\n */\nexport function annotationDisplayName(\n  annotation: Pick<Annotation, 'user' | 'user_info'>,\n  defaultAuthority: string,\n  displayNamesEnabled: boolean,\n): string {\n  const isThirdParty = isThirdPartyUser(annotation.user, defaultAuthority);\n\n  const useDisplayName = displayNamesEnabled || isThirdParty;\n  return useDisplayName && annotation.user_info?.display_name\n    ? annotation.user_info.display_name\n    : username(annotation.user);\n}\n\n/**\n * Return a URL to the annotation author's user page, when available. Author\n * links for third-party users are only available if a `usernameUrl` is\n * provided in `settings`.\n */\nexport function annotationAuthorLink(\n  annotation: Pick<Annotation, 'user'>,\n  settings: SidebarSettings,\n  defaultAuthority: string,\n  userLink?: string,\n): string | undefined {\n  const isThirdParty = isThirdPartyUser(annotation.user, defaultAuthority);\n\n  if (!isThirdParty && userLink) {\n    return userLink;\n  }\n\n  return (\n    (settings.usernameUrl &&\n      `${settings.usernameUrl}${username(annotation.user)}`) ??\n    undefined\n  );\n}\n","import type { Annotation } from '../../types/api';\nimport type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\n\n/**\n * Retrieve an appropriate sharing link for this annotation.\n *\n * If the annotation is on a shareable document (i.e. its document is\n * web-accessible), prefer the `incontext` (bouncer) link, but fallback to the\n * `html` (single-annotation `h` web view) link if needed.\n *\n * If the annotation is not on a shareable document, don't use the `incontext`\n * link as that won't work; only use the single-annotation-view `html` link.\n *\n * Note that `html` links are not provided by the service for third-party\n * annotations.\n */\nexport function annotationSharingLink(annotation: Annotation): string | null {\n  if (isShareableURI(annotation.uri)) {\n    return annotation.links?.incontext ?? annotation.links?.html ?? null;\n  } else {\n    return annotation.links?.html ?? null;\n  }\n}\n\n/**\n * Generate a URI for sharing: a bouncer link built to share annotations in\n * a specific group (groupID) on a specific document (documentURI). If the\n * `documentURI` provided is not a web-accessible URL, no link is generated.\n */\nexport function pageSharingLink(\n  documentURI: string,\n  groupId: string,\n): string | null {\n  if (!isShareableURI(documentURI)) {\n    return null;\n  }\n  return `https://hyp.is/go?url=${encodeURIComponent(\n    documentURI,\n  )}&group=${groupId}`;\n}\n\n/**\n * Are annotations made against `uri` meaningfully shareable? The\n * target URI needs to be available on the web, which here is determined by\n * a protocol of `http` or `https`.\n */\nexport function isShareableURI(uri: string): boolean {\n  return /^http(s?):/i.test(uri);\n}\n\n/**\n * Is the sharing of annotations enabled? Check for any defined `serviceConfig`,\n * but default to `true` if none found.\n */\nexport function sharingEnabled(settings: SidebarSettings): boolean {\n  const service = serviceConfig(settings);\n  return service?.enableShareLinks !== false;\n}\n","/**\n * Utils for working with permissions principals on annotations.\n *\n * This is the same as the `permissions` field retrieved on an annotation via\n * the API.\n *\n * Principals are strings of the form `type:id` where `type` is `'acct'` (for a\n * specific user) or `'group'` (for a group).\n */\n\nexport type Permissions = {\n  /** List of principals that can read the annotation */\n  read: string[];\n  /** List of principals that can edit the annotation */\n  update: string[];\n  /** List of principals that can delete the annotation */\n  delete: string[];\n};\n\nfunction defaultLevel(savedLevel: string | null): string {\n  switch (savedLevel) {\n    case 'private':\n    case 'shared':\n      return savedLevel;\n    default:\n      return 'shared';\n  }\n}\n\n/**\n * Return the permissions for a private annotation.\n *\n * A private annotation is one which is readable only by its author.\n *\n * @param userid - User ID of the author\n */\nexport function privatePermissions(userid: string): Permissions {\n  return {\n    read: [userid],\n    update: [userid],\n    delete: [userid],\n  };\n}\n\n/**\n * Return the permissions for an annotation that is shared with the given\n * group.\n *\n * @param userid - User ID of the author\n * @param groupid - ID of the group the annotation is being shared with\n */\nexport function sharedPermissions(\n  userid: string,\n  groupid: string,\n): Permissions {\n  return Object.assign(privatePermissions(userid), {\n    read: ['group:' + groupid],\n  });\n}\n\n/**\n * Return the default permissions for an annotation in a given group.\n *\n * @param userid - User ID of the author\n * @param groupid - ID of the group the annotation is being shared with\n */\nexport function defaultPermissions(\n  userid: string,\n  groupid: string,\n  savedLevel: string | null,\n): Permissions {\n  if (defaultLevel(savedLevel) === 'private' && userid) {\n    return privatePermissions(userid);\n  } else {\n    return sharedPermissions(userid, groupid);\n  }\n}\n\n/**\n * Return true if an annotation with the given permissions is shared with any\n * group.\n */\nexport function isShared(perms: Permissions): boolean {\n  return perms.read.some(principal => {\n    return principal.indexOf('group:') === 0;\n  });\n}\n\n/**\n * Return true if an annotation with the given permissions is private.\n */\nexport function isPrivate(perms: Permissions): boolean {\n  return !isShared(perms);\n}\n\n/**\n * Return true if a user can perform the given `action` on an annotation.\n */\nexport function permits(\n  perms: Permissions,\n  action: 'update' | 'delete',\n  userid: string | null,\n): boolean {\n  return perms[action].indexOf(userid || '') !== -1;\n}\n","/**\n * Helper methods to identify browser versions and os types\n */\n\n/**\n * Returns true when the OS is Mac OS.\n *\n * @param _userAgent - Test seam\n */\nexport const isMacOS = (_userAgent: string = window.navigator.userAgent) => {\n  return _userAgent.indexOf('Mac OS') >= 0;\n};\n\n/**\n * Returns true when device is iOS.\n * https://stackoverflow.com/a/9039885/14463679\n */\nexport const isIOS = (\n  _navigator: { platform: string; userAgent: string } = window.navigator,\n  _ontouchend: boolean = 'ontouchend' in document,\n): boolean => {\n  return (\n    [\n      'iPad Simulator',\n      'iPhone Simulator',\n      'iPod Simulator',\n      'iPad',\n      'iPhone',\n      'iPod',\n    ].includes(_navigator.platform) ||\n    // iPad on iOS 13 detection\n    (_navigator.userAgent.includes('Mac') && _ontouchend)\n  );\n};\n\n/**\n * Returns true when the device is a touch device such\n * as android or iOS.\n * https://developer.mozilla.org/en-US/docs/Web/CSS/@media/pointer#browser_compatibility\n */\nexport const isTouchDevice = (_window: Window = window): boolean => {\n  return _window.matchMedia('(pointer: coarse)').matches;\n};\n","/**\n * Copy the string `text` to the clipboard verbatim.\n *\n * @throws {Error}\n *   This function may throw an error if the `clipboard-write` permission was\n *   not allowed.\n */\nexport async function copyPlainText(text: string, navigator_ = navigator) {\n  await navigator_.clipboard.writeText(text);\n}\n\n/**\n * Copy the string `text` to the clipboard with an HTML media type.\n *\n * @throws {Error}\n *   This function may throw an error if the `clipboard-write` permission was\n *   not allowed.\n */\nexport async function copyHTML(\n  text: string,\n  /* istanbul ignore next - test seam */\n  navigator_ = navigator,\n  /* istanbul ignore next - test seam */\n  document_ = document,\n) {\n  // We want to copy the `text` both with plain and html media types, to make\n  // sure it is possible to paste in both rich text and plain text contexts.\n  // For the second one, the raw HTML markup will be pasted.\n  const types = ['text/html', 'text/plain'];\n\n  if (navigator_.clipboard.write) {\n    const blobs = types.reduce<Record<string, Blob>>((acc, type) => {\n      acc[type] = new Blob([text], { type });\n      return acc;\n    }, {});\n    await navigator_.clipboard.write([new ClipboardItem(blobs)]);\n  } else {\n    // Fallback to deprecated document.execCommand('copy') on the assumptions\n    // that all browsers will implement the new clipboard API before removing\n    // the deprecated one.\n    const copyHandler = (e: ClipboardEvent) => {\n      types.forEach(type => e.clipboardData?.setData(type, text));\n      e.preventDefault();\n    };\n\n    document_.addEventListener('copy', copyHandler);\n    try {\n      document_.execCommand('copy');\n    } finally {\n      document_.removeEventListener('copy', copyHandler);\n    }\n  }\n}\n","import { PointerDownIcon, PointerUpIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\ntype MenuArrowProps = {\n  classes?: string;\n  direction?: 'up' | 'down';\n};\n\n/**\n * Render a white-filled \"pointer\" arrow for use in menus and menu-like\n * elements\n *\n * This will set up absolute positioning for this arrow, but the vertical and\n * horizontal positioning will need to be tuned in the component using the\n * arrow by adding additional utility classes (`classes` prop here).\n */\nexport default function MenuArrow({\n  classes,\n  direction = 'up',\n}: MenuArrowProps) {\n  const Icon = direction === 'up' ? PointerUpIcon : PointerDownIcon;\n  return (\n    <Icon\n      className={classnames(\n        'absolute inline z-2 text-grey-3 fill-white',\n        classes,\n      )}\n    />\n  );\n}\n","import {\n  Link,\n  EmailIcon,\n  SocialFacebookIcon,\n  SocialTwitterIcon,\n} from '@hypothesis/frontend-shared';\nimport type { IconComponent } from '@hypothesis/frontend-shared/lib/types';\n\ntype ShareLinkProps = {\n  /** The SVG icon component to use for this link */\n  icon: IconComponent;\n\n  /** Accessible label/tooltip for link */\n  label: string;\n\n  /** URI for sharing this annotation */\n  uri: string;\n};\n\n/**\n * A single sharing link as a list item\n */\nfunction ShareLink({ label, icon: Icon, uri }: ShareLinkProps) {\n  return (\n    <li>\n      <Link\n        aria-label={label}\n        classes=\"text-grey-6 hover:text-color-text\"\n        href={uri}\n        title={label}\n        target=\"_blank\"\n        variant=\"custom\"\n        underline=\"none\"\n      >\n        <Icon\n          // Make the icons sized to the current text size to allow for\n          // differently-sized sharing icon links\n          className=\"w-em h-em\"\n        />\n      </Link>\n    </li>\n  );\n}\n\nexport type ShareLinksProps = {\n  shareURI: string;\n};\n\n/**\n * A list of share links to social-media platforms.\n */\nexport default function ShareLinks({ shareURI }: ShareLinksProps) {\n  const encodedURI = encodeURIComponent(shareURI);\n\n  return (\n    <div className=\"pt-2 border-t\">\n      <ul className=\"flex flex-row gap-x-4 items-center justify-center\">\n        <ShareLink\n          icon={SocialTwitterIcon}\n          label=\"Tweet share link\"\n          uri={`https://twitter.com/intent/tweet?url=${encodedURI}&hashtags=annotated`}\n        />\n\n        <ShareLink\n          icon={SocialFacebookIcon}\n          label=\"Share on Facebook\"\n          uri={`https://www.facebook.com/sharer/sharer.php?u=${encodedURI}`}\n        />\n\n        <ShareLink\n          icon={EmailIcon}\n          label=\"Share via email\"\n          uri={`mailto:?subject=${encodeURIComponent(\n            \"Let's Annotate\",\n          )}&body=${encodedURI}`}\n        />\n      </ul>\n    </div>\n  );\n}\n","import { usePopoverShouldClose } from '@hypothesis/frontend-shared';\nimport {\n  Card,\n  IconButton,\n  Input,\n  InputGroup,\n  CopyIcon,\n  ShareIcon,\n} from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useEffect, useRef, useState } from 'preact/hooks';\n\nimport { isIOS } from '../../../shared/user-agent';\nimport type { Annotation } from '../../../types/api';\nimport { isShareableURI } from '../../helpers/annotation-sharing';\nimport { isPrivate } from '../../helpers/permissions';\nimport { withServices } from '../../service-context';\nimport type { ToastMessengerService } from '../../services/toast-messenger';\nimport { useSidebarStore } from '../../store';\nimport { copyPlainText } from '../../util/copy-to-clipboard';\nimport MenuArrow from '../MenuArrow';\nimport ShareLinks from '../ShareLinks';\n\nexport type AnnotationShareControlProps = {\n  /** The annotation in question */\n  annotation: Annotation;\n\n  /** The URI to view the annotation on its own */\n  shareUri: string;\n\n  // Injected\n  toastMessenger: ToastMessengerService;\n};\n\nfunction selectionOverflowsInputElement() {\n  // On iOS the selection overflows the input element\n  // See: https://github.com/hypothesis/client/pull/2799\n  return isIOS();\n}\n\n/**\n * \"Popup\"-style component for sharing a single annotation.\n *\n * @param {AnnotationShareControlProps} props\n */\nfunction AnnotationShareControl({\n  annotation,\n  toastMessenger,\n  shareUri,\n}: AnnotationShareControlProps) {\n  const store = useSidebarStore();\n  const group = store.getGroup(annotation.group);\n\n  const annotationIsPrivate = isPrivate(annotation.permissions);\n  const inContextAvailable = isShareableURI(annotation.uri);\n  const inputRef = useRef<HTMLInputElement | null>(null);\n  const shareRef = useRef<HTMLDivElement | null>(null);\n\n  const [isOpen, setOpen] = useState(false);\n  const wasOpen = useRef(isOpen);\n\n  const toggleSharePanel = () => setOpen(!isOpen);\n  const closePanel = () => setOpen(false);\n\n  usePopoverShouldClose(shareRef, closePanel, { enabled: isOpen });\n\n  useEffect(() => {\n    if (wasOpen.current !== isOpen) {\n      wasOpen.current = isOpen;\n\n      if (isOpen && !selectionOverflowsInputElement()) {\n        // Panel was just opened: select and focus the share URI for convenience\n        inputRef.current?.focus();\n        inputRef.current?.select();\n      }\n    }\n  }, [isOpen]);\n\n  if (!group) {\n    // This can happen if groups have just been unloaded but annotations have\n    // not yet been unloaded, e.g. on logout if a private group was focused\n    return null;\n  }\n\n  // NB: Sharing links (social media/email) are not currently shown for `html`\n  // links. There are two reasons for this:\n  // - Lack of vertical real estate available. The explanatory text about `html`\n  //   links takes up several lines. Adding the sharing links below this runs\n  //   the risk of interfering with the top bar or other elements outside of the\n  //   annotation's card. This may be rectified with a design tweak, perhaps.\n  // - Possible confusion about what the sharing link does. The difference\n  //   between an `incontext` and `html` link likely isn't clear to users. This\n  //   bears further discussion.\n  const showShareLinks = inContextAvailable;\n\n  const copyShareLink = async () => {\n    try {\n      await copyPlainText(shareUri);\n      toastMessenger.success('Copied share link to clipboard');\n    } catch {\n      toastMessenger.error('Unable to copy link');\n    }\n  };\n\n  // Generate some descriptive text about who may see the annotation if they\n  // follow the share link.\n  // First: Based on the type of the group the annotation is in, who would\n  // be able to view it?\n  const groupSharingInfo =\n    group.type === 'private' ? (\n      <span>\n        Only members of the group <em>{group.name}</em> may view this\n        annotation.\n      </span>\n    ) : (\n      <span>Anyone using this link may view this annotation.</span>\n    );\n\n  // However, if the annotation is marked as \"only me\" (`annotationIsPrivate` is `true`),\n  // then group sharing settings are irrelevant—only the author may view the\n  // annotation.\n  const annotationSharingInfo = annotationIsPrivate ? (\n    <span>Only you may view this annotation.</span>\n  ) : (\n    groupSharingInfo\n  );\n\n  return (\n    // Make the container div focusable by setting a non-null `tabIndex`.\n    // This prevents clicks on non-focusable contents from \"leaking out\" and\n    // focusing a focusable ancester. If something outside of the panel gains\n    // focus, `usePopoverShouldClose`'s focus listener will close the panel.\n    // \"Catch focus\" here to prevent this.\n    // See https://github.com/hypothesis/client/issues/5196\n    <div className=\"relative\" ref={shareRef} tabIndex={-1}>\n      <IconButton\n        icon={ShareIcon}\n        title=\"Share\"\n        onClick={toggleSharePanel}\n        expanded={isOpen}\n      />\n      {isOpen && (\n        <div\n          // Position this Card above its IconButton. Account for larger\n          // IconButtons in touch interfaces\n          className=\"absolute bottom-8 right-0 touch:bottom-touch-minimum\"\n        >\n          <Card\n            classes={classnames(\n              // Prefer width 96 (24rem) but ensure that component isn't wider\n              // than 85vw\n              'w-96 max-w-[85vw]',\n              'space-y-2 p-2',\n            )}\n            width=\"custom\"\n          >\n            <h2 className=\"text-brand text-md font-medium\">\n              Share this annotation\n            </h2>\n            <div\n              className={classnames(\n                // Slightly larger font size for touch devices to correspond with\n                // larger button and input sizes\n                'flex w-full text-xs touch:text-base',\n              )}\n            >\n              <InputGroup>\n                <Input\n                  aria-label=\"Use this URL to share this annotation\"\n                  type=\"text\"\n                  value={shareUri}\n                  readOnly\n                  elementRef={inputRef}\n                />\n                <IconButton\n                  icon={CopyIcon}\n                  title=\"Copy share link to clipboard\"\n                  onClick={copyShareLink}\n                  variant=\"dark\"\n                />\n              </InputGroup>\n            </div>\n            <div className=\"text-base font-normal\" data-testid=\"share-details\">\n              {inContextAvailable ? (\n                <>{annotationSharingInfo}</>\n              ) : (\n                <>\n                  This annotation cannot be shared in its original context\n                  because it was made on a document that is not available on the\n                  web. This link shares the annotation by itself.\n                </>\n              )}\n            </div>\n            {showShareLinks && <ShareLinks shareURI={shareUri} />}\n            <MenuArrow\n              direction=\"down\"\n              classes=\"bottom-[-8px] right-2 touch:right-[9px]\"\n            />\n          </Card>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default withServices(AnnotationShareControl, ['toastMessenger']);\n","import {\n  confirm,\n  IconButton,\n  EditIcon,\n  FlagIcon,\n  FlagFilledIcon,\n  ReplyIcon,\n  TrashIcon,\n} from '@hypothesis/frontend-shared';\n\nimport type { SavedAnnotation } from '../../../types/api';\nimport type { SidebarSettings } from '../../../types/config';\nimport { serviceConfig } from '../../config/service-config';\nimport { annotationRole } from '../../helpers/annotation-metadata';\nimport {\n  sharingEnabled,\n  annotationSharingLink,\n} from '../../helpers/annotation-sharing';\nimport { isPrivate, permits } from '../../helpers/permissions';\nimport { withServices } from '../../service-context';\nimport type { AnnotationsService } from '../../services/annotations';\nimport type { ToastMessengerService } from '../../services/toast-messenger';\nimport { useSidebarStore } from '../../store';\nimport AnnotationShareControl from './AnnotationShareControl';\n\nfunction flaggingEnabled(settings: SidebarSettings) {\n  const service = serviceConfig(settings);\n  if (service?.allowFlagging === false) {\n    return false;\n  }\n  return true;\n}\n\nexport type AnnotationActionBarProps = {\n  annotation: SavedAnnotation;\n  onReply: () => void;\n\n  // injected\n  annotationsService: AnnotationsService;\n  settings: SidebarSettings;\n  toastMessenger: ToastMessengerService;\n};\n\n/**\n * A collection of buttons in the footer area of an annotation that take\n * actions on the annotation.\n *\n * @param {AnnotationActionBarProps} props\n */\nfunction AnnotationActionBar({\n  annotation,\n  annotationsService,\n  onReply,\n  settings,\n  toastMessenger,\n}: AnnotationActionBarProps) {\n  const store = useSidebarStore();\n  const userProfile = store.profile();\n  const isLoggedIn = store.isLoggedIn();\n\n  // Is the current user allowed to take the given `action` on this annotation?\n  const userIsAuthorizedTo = (action: 'update' | 'delete') => {\n    return permits(annotation.permissions, action, userProfile.userid);\n  };\n\n  const showDeleteAction = userIsAuthorizedTo('delete');\n  const showEditAction = userIsAuthorizedTo('update');\n\n  //  Only authenticated users can flag an annotation, except the annotation's author.\n  const showFlagAction =\n    flaggingEnabled(settings) &&\n    !!userProfile.userid &&\n    userProfile.userid !== annotation.user;\n\n  const shareLink =\n    sharingEnabled(settings) && annotationSharingLink(annotation);\n\n  const onDelete = async () => {\n    const annType = annotationRole(annotation);\n    if (\n      await confirm({\n        title: `Delete ${annType.toLowerCase()}?`,\n        message: `Are you sure you want to delete this ${annType.toLowerCase()}?`,\n        confirmAction: 'Delete',\n      })\n    ) {\n      try {\n        await annotationsService.delete(annotation);\n        toastMessenger.success(`${annType} deleted`, { visuallyHidden: true });\n      } catch (err) {\n        toastMessenger.error(err.message);\n      }\n    }\n  };\n\n  const onEdit = () => {\n    store.createDraft(annotation, {\n      tags: annotation.tags,\n      text: annotation.text,\n      isPrivate: isPrivate(annotation.permissions),\n    });\n  };\n\n  const onFlag = () => {\n    annotationsService\n      .flag(annotation)\n      .catch(() => toastMessenger.error('Flagging annotation failed'));\n  };\n\n  const onReplyClick = () => {\n    if (!isLoggedIn) {\n      store.openSidebarPanel('loginPrompt');\n      return;\n    }\n    onReply();\n  };\n\n  return (\n    <div className=\"flex text-[16px]\" data-testid=\"annotation-action-bar\">\n      {showEditAction && (\n        <IconButton icon={EditIcon} title=\"Edit\" onClick={onEdit} />\n      )}\n      {showDeleteAction && (\n        <IconButton icon={TrashIcon} title=\"Delete\" onClick={onDelete} />\n      )}\n      <IconButton icon={ReplyIcon} title=\"Reply\" onClick={onReplyClick} />\n      {shareLink && (\n        <AnnotationShareControl annotation={annotation} shareUri={shareLink} />\n      )}\n      {showFlagAction && !annotation.flagged && (\n        <IconButton\n          icon={FlagIcon}\n          title=\"Report this annotation to moderators\"\n          onClick={onFlag}\n        />\n      )}\n      {showFlagAction && annotation.flagged && (\n        <IconButton\n          pressed={true}\n          icon={FlagFilledIcon}\n          title=\"Annotation has been reported to the moderators\"\n        />\n      )}\n    </div>\n  );\n}\n\nexport default withServices(AnnotationActionBar, [\n  'annotationsService',\n  'settings',\n  'toastMessenger',\n]);\n","import { LinkButton } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport type { ComponentChildren } from 'preact';\nimport { useCallback, useLayoutEffect, useRef, useState } from 'preact/hooks';\n\nimport { applyTheme } from '../helpers/theme';\nimport { withServices } from '../service-context';\nimport { observeElementSize } from '../util/observe-element-size';\n\ntype InlineControlsProps = {\n  isCollapsed: boolean;\n  setCollapsed: (collapsed: boolean) => void;\n  linkStyle: Record<string, string>;\n};\n\n/**\n * An optional toggle link at the bottom of an excerpt which controls whether\n * it is expanded or collapsed.\n */\nfunction InlineControls({\n  isCollapsed,\n  setCollapsed,\n  linkStyle,\n}: InlineControlsProps) {\n  return (\n    <div\n      className={classnames(\n        // Position these controls at the bottom right of the excerpt\n        'absolute block right-0 bottom-0',\n        // Give extra width for larger tap target and gradient fade\n        // Fade transparent-to-white left-to-right to make the toggle\n        // control text (More/Less) more readable above other text.\n        // This gradient is implemented to-left to take advantage of Tailwind's\n        // automatic to-transparent calculation: this avoids Safari's problem\n        // with transparents in gradients:\n        // https://bugs.webkit.org/show_bug.cgi?id=150940\n        // https://tailwindcss.com/docs/gradient-color-stops#fading-to-transparent\n        'w-20 bg-gradient-to-l from-white',\n      )}\n    >\n      <div className=\"flex justify-end\">\n        <LinkButton\n          variant=\"text\"\n          onClick={() => setCollapsed(!isCollapsed)}\n          expanded={!isCollapsed}\n          title=\"Toggle visibility of full excerpt text\"\n          style={linkStyle}\n          underline=\"always\"\n          inline\n        >\n          {isCollapsed ? 'More' : 'Less'}\n        </LinkButton>\n      </div>\n    </div>\n  );\n}\n\nconst noop = () => {};\n\ntype ExcerptProps = {\n  children?: ComponentChildren;\n  /**\n   * If `true`, the excerpt provides internal controls to expand and collapse\n   * the content. If `false`, the caller sets the collapsed state via the\n   * `collapse` prop.  When using inline controls, the excerpt is initially\n   * collapsed.\n   */\n  inlineControls?: boolean;\n  /**\n   * If the content should be truncated if its height exceeds\n   * `collapsedHeight + overflowThreshold`. This prop is only used if\n   * `inlineControls` is false.\n   */\n  collapse?: boolean;\n  /**\n   * Maximum height of the container, in pixels, when it is collapsed.\n   */\n  collapsedHeight: number;\n  /**\n   * An additional margin of pixels by which the content height can exceed\n   * `collapsedHeight` before it becomes collapsible.\n   */\n  overflowThreshold?: number;\n  /**\n   * Called when the content height exceeds or falls below\n   * `collapsedHeight + overflowThreshold`.\n   */\n  onCollapsibleChanged?: (isCollapsible: boolean) => void;\n  /**\n   * When `inlineControls` is `false`, this function is called when the user\n   * requests to expand the content by clicking a zone at the bottom of the\n   * container.\n   */\n  onToggleCollapsed?: (collapsed: boolean) => void;\n\n  // Injected\n  settings: object;\n};\n\n/**\n * A container which truncates its content when they exceed a specified height.\n *\n * The collapsed state of the container can be handled either via internal\n * controls (if `inlineControls` is `true`) or by the caller using the\n * `collapse` prop.\n */\nfunction Excerpt({\n  children,\n  collapse = false,\n  collapsedHeight,\n  inlineControls = true,\n  onCollapsibleChanged = noop,\n  onToggleCollapsed = noop,\n  overflowThreshold = 0,\n  settings = {},\n}: ExcerptProps) {\n  const [collapsedByInlineControls, setCollapsedByInlineControls] =\n    useState(true);\n\n  const contentElement = useRef<HTMLDivElement | null>(null);\n\n  // Measured height of `contentElement` in pixels\n  const [contentHeight, setContentHeight] = useState(0);\n\n  // Update the measured height of the content container after initial render,\n  // and when the size of the content element changes.\n  const updateContentHeight = useCallback(() => {\n    const newContentHeight = contentElement.current!.clientHeight;\n    setContentHeight(newContentHeight);\n\n    // prettier-ignore\n    const isCollapsible =\n      newContentHeight > (collapsedHeight + overflowThreshold);\n    onCollapsibleChanged(isCollapsible);\n  }, [collapsedHeight, onCollapsibleChanged, overflowThreshold]);\n\n  useLayoutEffect(() => {\n    const cleanup = observeElementSize(\n      contentElement.current!,\n      updateContentHeight,\n    );\n    updateContentHeight();\n    return cleanup;\n  }, [updateContentHeight]);\n\n  // Render the (possibly truncated) content and controls for\n  // expanding/collapsing the content.\n  // prettier-ignore\n  const isOverflowing = contentHeight > (collapsedHeight + overflowThreshold);\n  const isCollapsed = inlineControls ? collapsedByInlineControls : collapse;\n  const isExpandable = isOverflowing && isCollapsed;\n\n  const contentStyle: Record<string, number> = {};\n  if (contentHeight !== 0) {\n    contentStyle['max-height'] = isExpandable ? collapsedHeight : contentHeight;\n  }\n\n  const setCollapsed = (collapsed: boolean) =>\n    inlineControls\n      ? setCollapsedByInlineControls(collapsed)\n      : onToggleCollapsed(collapsed);\n\n  return (\n    <div\n      data-testid=\"excerpt-container\"\n      className={classnames(\n        'relative overflow-hidden',\n        'transition-[max-height] ease-in duration-150',\n      )}\n      style={contentStyle}\n    >\n      <div\n        className={classnames(\n          // Establish new block-formatting context to prevent margin-collapsing\n          // in descendent elements from potentially \"leaking out\" and pushing\n          // this element down from the top of the container.\n          // See https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Block_formatting_context\n          // See https://github.com/hypothesis/client/issues/1518\n          'inline-block w-full',\n        )}\n        data-testid=\"excerpt-content\"\n        ref={contentElement}\n      >\n        {children}\n      </div>\n      <div\n        data-testid=\"excerpt-expand\"\n        role=\"presentation\"\n        onClick={() => setCollapsed(false)}\n        className={classnames(\n          // This element provides a clickable area at the bottom of an\n          // expandable excerpt to expand it.\n          'transition-[opacity] duration-150 ease-linear',\n          'absolute w-full bottom-0 h-touch-minimum',\n          {\n            // For expandable excerpts not using inlineControls, style this\n            // element with a custom shadow-like gradient\n            'bg-gradient-to-b from-excerpt-stop-1 via-excerpt-stop-2 to-excerpt-stop-3':\n              !inlineControls && isExpandable,\n            'bg-none': inlineControls,\n            // Don't make this shadow visible OR clickable if there's nothing\n            // to do here (the excerpt isn't expandable)\n            'opacity-0 pointer-events-none': !isExpandable,\n          },\n        )}\n        title=\"Show the full excerpt\"\n      />\n      {isOverflowing && inlineControls && (\n        <InlineControls\n          isCollapsed={collapsedByInlineControls}\n          setCollapsed={setCollapsed}\n          linkStyle={applyTheme(['selectionFontFamily'], settings)}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default withServices(Excerpt, ['settings']);\n","/**\n * Watch for changes in the size (`clientWidth` and `clientHeight`) of\n * an element.\n *\n * Returns a cleanup function which should be called to remove observers when\n * updates are no longer needed.\n *\n * @param element - HTML element to watch\n * @param onSizeChanged - Callback to invoke with the `clientWidth` and\n *   `clientHeight` of the element when a change in its size is detected.\n */\nexport function observeElementSize(\n  element: Element,\n  onSizeChanged: (width: number, height: number) => void,\n): () => void {\n  const observer = new ResizeObserver(() =>\n    onSizeChanged(element.clientWidth, element.clientHeight),\n  );\n  observer.observe(element);\n  return () => observer.disconnect();\n}\n","import type { Mention } from '../../types/api';\nimport { buildAccountID } from './account-id';\nimport type { UserItem } from './mention-suggestions';\n\n// Pattern that matches characters treated as the boundary of a mention.\nconst BOUNDARY_CHARS = String.raw`[\\s,.;:|?!'\"\\-()[\\]{}]`;\n\n// Pattern that matches Hypothesis usernames.\n// See https://github.com/hypothesis/h/blob/797d9a4/h/models/user.py#L25\nconst USERNAME_PAT = '[A-Za-z0-9_][A-Za-z0-9._]+[A-Za-z0-9_]';\n\n// Pattern that finds username-based mentions in text.\nconst USERNAME_MENTIONS_PAT = new RegExp(\n  `(^|${BOUNDARY_CHARS})@(${USERNAME_PAT})(?=${BOUNDARY_CHARS}|$)`,\n  'g',\n);\n\n// Pattern that matches display names.\n// Display names can have any amount of characters, except opening or closing\n// square brackets, which are used to delimit the display name itself.\nconst DISPLAY_NAME_PAT = String.raw`[^\\]^[]*`;\n\n// Pattern that finds display-name-based mentions in text.\nconst DISPLAY_NAME_MENTIONS_PAT = new RegExp(\n  `(^|${BOUNDARY_CHARS})@\\\\[(${DISPLAY_NAME_PAT})](?=${BOUNDARY_CHARS}|$)`,\n  'g',\n);\n\n/**\n * Create a mention tag for provided userid and content.\n *\n * `<a data-hyp-mention=\"\" data-userid={userid}>{content}</a>`\n */\nfunction buildMentionTag(userid: string, content: string): string {\n  const tag = document.createElement('a');\n\n  tag.setAttribute('data-hyp-mention', '');\n  tag.setAttribute('data-userid', userid);\n  tag.textContent = content;\n\n  return tag.outerHTML;\n}\n\n/**\n * Wrap all occurrences of @mention in provided text into the corresponding\n * special tag, as long as they are surrounded by boundary chars.\n *\n * For example: `@someuser` with the `hypothes.is` authority would become\n *  `<a data-hyp-mention data-userid=\"acct:someuser@hypothes.is\">@someuser</a>`\n */\nexport function wrapMentions(text: string, authority: string): string {\n  return text.replace(\n    USERNAME_MENTIONS_PAT,\n    (match, precedingChar, username) => {\n      const mentionTag = buildMentionTag(\n        buildAccountID(username, authority),\n        `@${username}`,\n      );\n      return `${precedingChar}${mentionTag}`;\n    },\n  );\n}\n\n/**\n * Wrap all occurrences of @[Display Name] in provided text into the\n * corresponding mention tag, as long as they are surrounded by boundary chars.\n *\n * Every matched plain-text mention will need a corresponding entry in the\n * users map to produce a valid mention tag.\n * Non-matching ones will be kept as plain-text.\n */\nexport function wrapDisplayNameMentions(\n  text: string,\n  usersMap: Map<string, UserItem>,\n): string {\n  return text.replace(\n    DISPLAY_NAME_MENTIONS_PAT,\n    (match, precedingChar, displayName) => {\n      const suggestion = usersMap.get(displayName);\n      if (!suggestion) {\n        return `${precedingChar}${displayNameMention(displayName)}`;\n      }\n\n      const mentionTag = buildMentionTag(suggestion.userid, `@${displayName}`);\n      return `${precedingChar}${mentionTag}`;\n    },\n  );\n}\n\n// Pattern that matches the special tag used to wrap mentions.\n//\n// Attempting to parse HTML with a regex is usually problematic, but we make\n// some assumptions about the tag content in order to be able to get away\n// with it. Specifically we assume that these tags will not contain `<` or\n// `>` in attribute values or the HTML content of the tag.\nconst MENTION_TAG_RE = /<a[^>]\\bdata-hyp-mention\\b[^>]*>@([^<]+)<\\/a>/g;\n\nexport type UnwrapMentionsOptions = {\n  text: string;\n  mentionMode: MentionMode;\n  mentions?: Mention[];\n};\n\n/**\n * Replace all mentions wrapped in the special `<a data-hyp-mention />` tag with\n * their plain-text representation.\n *\n * The plain-text representation depends on the mention mode:\n * - `username`: @username\n * - `display-name`: @[Display Name]\n *\n * If a list of mentions is provided, the tag's userid will be matched against\n * it, so that the plain-text version uses the most recent username or display\n * name, in case they have changed since the mention was created.\n * If a list is not provided or the mention is not found, the tag's content will\n * be used as username or display name.\n */\nexport function unwrapMentions({\n  text,\n  mentionMode,\n  mentions = [],\n}: UnwrapMentionsOptions) {\n  // Use a regex rather than HTML parser to replace the mentions in order\n  // to avoid modifying any of the content outside of the replaced tags. This\n  // includes avoiding modifications such as encoding characters that will\n  // happen when parsing and re-serializing HTML via eg. `innerHTML`.\n  return text.replace(MENTION_TAG_RE, (match, tagContent) => {\n    // Even though we need to capture the tag content via a regex for the\n    // reasons explained above, we can use regular DOM APIs to get the userid\n    const tempElement = document.createElement('div');\n    tempElement.innerHTML = match;\n    const userid = tempElement\n      .querySelector('a[data-hyp-mention]')\n      ?.getAttribute('data-userid');\n\n    const mention = mentions.find(\n      ({ original_userid }) => original_userid === userid,\n    );\n\n    return mentionMode === 'username'\n      ? `@${mention?.username ?? tagContent}`\n      : // Using || rather than ?? for the display name, to avoid setting an\n        // empty string if the user used to have a display name and has been\n        // removed since the mention was created\n        displayNameMention(mention?.display_name || tagContent);\n  });\n}\n\n/**\n * The content of a mention tag that the backend \"discarded\" as invalid.\n * Possible reasons are: the user does not exist, belongs to a different group,\n * is nipsa'd, etc.\n */\nexport type InvalidMentionContent = string;\n\n/**\n * Replace an unprocessed mention tag with another element that represents the\n * proper type of mention ('link', 'no-link' or 'invalid').\n */\nfunction processAndReplaceMention(\n  unprocessedMention: HTMLElement,\n  mention: Mention | undefined,\n  mentionMode: MentionMode,\n): [HTMLElement, Mention | InvalidMentionContent] {\n  const originalTagContent = unprocessedMention.textContent ?? '';\n  const mentionOrInvalidContent = mention ?? originalTagContent;\n\n  // If this mention element has already been processed, return as is\n  if (unprocessedMention.hasAttribute('data-hyp-mention-type')) {\n    return [unprocessedMention, mentionOrInvalidContent];\n  }\n\n  const type =\n    mention && mention.link ? 'link' : mention ? 'no-link' : 'invalid';\n  const processedMention = document.createElement(\n    type === 'link' ? 'a' : 'span',\n  );\n\n  processedMention.setAttribute('data-hyp-mention', '');\n  processedMention.setAttribute('data-hyp-mention-type', type);\n\n  // For valid mentions, resolve the most recent username or display name, in\n  // case it has changed since the mention was created.\n  // The only exception is when a valid mention with an empty display name is\n  // resolved, in which case we fall back to the original tag content.\n  if (!mention) {\n    processedMention.textContent = originalTagContent;\n  } else if (mentionMode === 'username') {\n    processedMention.textContent = `@${mention.username}`;\n  } else {\n    processedMention.textContent = mention.display_name\n      ? `@${mention.display_name}`\n      : originalTagContent;\n  }\n\n  if (type === 'link') {\n    // If the mention exists in the list of mentions and contains a link, render\n    // it as an anchor pointing to that link\n    processedMention.setAttribute('href', mention?.link ?? '');\n    processedMention.setAttribute('target', '_blank');\n  }\n\n  if (type !== 'invalid') {\n    processedMention.setAttribute(\n      'data-userid',\n      unprocessedMention.dataset.userid ?? '',\n    );\n  }\n\n  unprocessedMention.replaceWith(processedMention);\n  return [processedMention, mentionOrInvalidContent];\n}\n\n/**\n * Search for mention tags inside an HTML element, and try to match them with a\n * provided list of mentions. Every matched element will be replaced with\n * another one that represents the proper type of mention ('link', 'no-link' or\n * 'invalid').\n *\n * @return - Map of HTML elements that matched a mention tag, with their\n *           corresponding mention or invalid username\n */\nexport function processAndReplaceMentionElements(\n  element: HTMLElement,\n  mentions: Mention[],\n  mentionMode: MentionMode,\n): Map<HTMLElement, Mention | InvalidMentionContent> {\n  const mentionElements = element.querySelectorAll('[data-hyp-mention]');\n  const foundMentions = new Map<HTMLElement, Mention | string>();\n\n  for (const mentionElement of mentionElements) {\n    const htmlMentionElement = mentionElement as HTMLElement;\n    const mentionUserId = htmlMentionElement.dataset.userid;\n    const mention = mentionUserId\n      ? mentions.find(m => m.userid === mentionUserId)\n      : undefined;\n\n    foundMentions.set(\n      ...processAndReplaceMention(htmlMentionElement, mention, mentionMode),\n    );\n  }\n\n  return foundMentions;\n}\n\n/**\n * Returns the word at a specific position in a string, surrounded by empty\n * characters or punctuation characters.\n */\nexport function termBeforePosition(text: string, position: number): string {\n  const { start } = getContainingMentionOffsets(text, position);\n  return text.slice(start, position);\n}\n\nexport type WordOffsets = {\n  start: number;\n  end: number;\n};\n\n/**\n * Returns the `start` and `end` positions for the word or mention that overlaps\n * with provided reference position.\n *\n * For example, given the text \"hello @hypothesis\", and the reference position 9\n * (which corresponds to the `y` character) it will return the start and end of\n * the `@hypothesis` mention, hence { start: 6, end: 17 }.\n *\n * Useful to get the offsets of the mention matching the caret position in text\n * inputs and textareas.\n */\nexport function getContainingMentionOffsets(\n  text: string,\n  referencePosition: number,\n): WordOffsets {\n  const precedingText = text.slice(0, referencePosition);\n  const matches = [...precedingText.matchAll(new RegExp(BOUNDARY_CHARS, 'g'))];\n  const precedingCharPos =\n    matches.length > 0 ? Math.max(...matches.map(match => match.index)) : -1;\n\n  const subsequentCharPos = text\n    .slice(referencePosition)\n    .search(new RegExp(BOUNDARY_CHARS));\n\n  return {\n    start: precedingCharPos + 1,\n    end:\n      subsequentCharPos === -1\n        ? text.length\n        : referencePosition + subsequentCharPos,\n  };\n}\n\n/**\n * Whether mentions should be done via username (`@username`) or display name\n * (`@[Display Name]`).\n *\n * This also affects the information displayed in suggestions, which will not\n * include the username in the second case.\n */\nexport type MentionMode = 'username' | 'display-name';\n\n/**\n * Converts provided user into a plain-text mention (not wrapped in a mention\n * tag).\n *\n * Depending on the mention mode it will return `@username` or `@[Display Name]`.\n */\nexport function toPlainTextMention(\n  user: UserItem,\n  mentionMode: MentionMode,\n): string {\n  return mentionMode === 'display-name'\n    ? displayNameMention(user.displayName ?? '')\n    : `@${user.username}`;\n}\n\n/**\n * Convert a display name into a plain-text mention.\n * `Display Name` -> `@[Display Name]`\n *\n * Square brackets are removed from it, as they are reserved to delimit the\n * beginning and end of the display name itself.\n * `Foo [Bar]` -> `@[Foo Bar]`\n */\nfunction displayNameMention(displayName: string): string {\n  return `@[${displayName.replace(/[[\\]]/g, '')}]`;\n}\n","/**\n * Return an HTML5 audio player with the given src URL.\n */\nfunction audioElement(src: string): HTMLAudioElement {\n  const html5audio = document.createElement('audio');\n  html5audio.controls = true;\n  html5audio.src = src;\n  return html5audio;\n}\n\n/**\n * Wrap an element in a container that causes the element to be displayed at\n * a given aspect ratio.\n *\n * See https://css-tricks.com/aspect-ratio-boxes/.\n *\n * @param element\n * @param aspectRatio - Aspect ratio as `width/height`\n * @return - A container element which wraps `element`\n */\nfunction wrapInAspectRatioContainer(\n  element: HTMLElement,\n  aspectRatio: number,\n): HTMLElement {\n  element.style.position = 'absolute';\n  element.style.top = '0';\n  element.style.left = '0';\n  element.style.width = '100%';\n  element.style.height = '100%';\n\n  const container = document.createElement('div');\n  container.style.paddingBottom = `${(1 / aspectRatio) * 100}%`;\n  container.style.position = 'relative';\n  container.appendChild(element);\n\n  return container;\n}\n\n/**\n * Return an iframe DOM element with the given src URL.\n */\nfunction iframe(src: string, aspectRatio = 16 / 9): HTMLElement {\n  const iframe_ = document.createElement('iframe');\n  iframe_.src = src;\n  iframe_.setAttribute('frameborder', '0');\n  iframe_.setAttribute('allowfullscreen', '');\n\n  return wrapInAspectRatioContainer(iframe_, aspectRatio);\n}\n\n/**\n * Return timeValue as a value in seconds, supporting `t` param's optional\n * '\\dh\\dm\\ds' format. If `timeValue` is numeric (only),\n * it's assumed to be seconds and is left alone.\n *\n * @param timeValue - value of `t` or `start` param in YouTube URL\n * @return timeValue in seconds\n * @example\n * formatYouTubeTime('5m'); // returns '300'\n * formatYouTubeTime('20m10s'); // returns '1210'\n * formatYouTubeTime('1h1s'); // returns '3601'\n * formatYouTubeTime('10'); // returns '10'\n **/\nfunction parseTimeString(timeValue: string): string {\n  const timePattern = /(\\d+)([hms]?)/g;\n  const multipliers = {\n    h: 60 * 60,\n    m: 60,\n    s: 1,\n  };\n  let seconds = 0;\n  let match;\n  // match[1] - Numeric value\n  // match[2] - Unit (e.g. 'h','m','s', or empty)\n  while ((match = timePattern.exec(timeValue)) !== null) {\n    if (match[2]) {\n      const unit = match[2] as keyof typeof multipliers;\n      seconds += Number(match[1]) * multipliers[unit];\n    } else {\n      seconds += +match[1]; // Treat values missing units as seconds\n    }\n  }\n  return seconds.toString();\n}\n\n/**\n * Return a YouTube URL query string containing (only) whitelisted params.\n * See https://developers.google.com/youtube/player_parameters for\n * all parameter possibilities.\n *\n * @return Formatted filtered URL query string, e.g. '?start=90' or\n *   an empty string if the filtered query is empty.\n * @example\n * // returns '?end=10&start=5'\n * youTubeQueryParams(link); // where `link.search` = '?t=5&baz=foo&end=10'\n * // - `t` is translated to `start`\n * // - `baz` is not allowed param\n * // - param keys are sorted\n */\nfunction youTubeQueryParams(link: HTMLAnchorElement): string {\n  const allowedParams = [\n    'end',\n    'start',\n    't', // will be translated to `start`\n  ];\n  const linkParams = new URLSearchParams(link.search);\n  const filteredQuery = new URLSearchParams();\n\n  // Copy allowed params into `filteredQuery`.\n  for (const [key, value] of linkParams) {\n    if (!allowedParams.includes(key)) {\n      continue;\n    }\n    if (key === 't') {\n      // `t` is not supported in embeds; `start` is\n      // `t` accepts more formats than `start`; start must be in seconds\n      // so, format it as seconds first\n      filteredQuery.append('start', parseTimeString(value));\n    } else {\n      filteredQuery.append(key, value);\n    }\n  }\n\n  // Tests currently expect sorted parameters.\n  filteredQuery.sort();\n\n  let query = filteredQuery.toString();\n  if (query) {\n    query = `?${query}`;\n  }\n  return query;\n}\n\n/**\n * Return a YouTube embed (<iframe>) DOM element for the given video ID.\n */\nfunction youTubeEmbed(id: string, link: HTMLAnchorElement): HTMLElement {\n  const query = youTubeQueryParams(link);\n  return iframe(`https://www.youtube.com/embed/${id}${query}`);\n}\n\n/**\n * Create an iframe embed generator for links that have the form\n * `https://<hostname>/<path containing a video ID>`\n *\n * @param pathPattern -\n *   Pattern to match against the pathname part of the link. This regex should\n *   contain a single capture group which matches the video ID within the path.\n * @param iframeUrlGenerator -\n *   Generate the URL for an embedded video iframe from a video ID\n * @return Function that takes an `<a>` element and returns the embedded iframe\n *   for that link, or `null` if we don't have a matching embed generator.\n */\nfunction createEmbedGenerator(\n  hostname: string,\n  pathPattern: RegExp,\n  iframeUrlGenerator: (videoId: string) => string,\n  { aspectRatio }: { aspectRatio?: number } = {},\n): (link: HTMLAnchorElement) => HTMLElement | null {\n  const generator = (link: HTMLAnchorElement) => {\n    if (link.hostname !== hostname) {\n      return null;\n    }\n\n    const groups = pathPattern.exec(link.pathname);\n    if (!groups) {\n      return null;\n    }\n\n    const id = groups[1];\n    return iframe(iframeUrlGenerator(id), aspectRatio);\n  };\n\n  return generator;\n}\n\n/**\n * A list of functions that return an \"embed\" DOM element (e.g. an <iframe> or\n * an html5 <audio> element) for a given link.\n *\n * Each function either returns `undefined` if it can't generate an embed for\n * the link, or a DOM element if it can.\n */\nconst embedGenerators: Array<(link: HTMLAnchorElement) => HTMLElement | null> =\n  [\n    // Matches URLs like https://www.youtube.com/watch?v=rw6oWkCojpw\n    function iframeFromYouTubeWatchURL(link) {\n      if (link.hostname !== 'www.youtube.com') {\n        return null;\n      }\n\n      if (!/\\/watch\\/?/.test(link.pathname)) {\n        return null;\n      }\n\n      const groups = /[&?]v=([^&#]+)/.exec(link.search);\n      if (groups) {\n        return youTubeEmbed(groups[1], link);\n      }\n      return null;\n    },\n\n    // Matches URLs like https://youtu.be/rw6oWkCojpw\n    function iframeFromYouTubeShareURL(link) {\n      if (link.hostname !== 'youtu.be') {\n        return null;\n      }\n\n      // extract video ID from URL\n      const groups = /^\\/([^/]+)\\/?$/.exec(link.pathname);\n      if (groups) {\n        return youTubeEmbed(groups[1], link);\n      }\n      return null;\n    },\n\n    // Matches URLs like https://vimeo.com/149000090\n    createEmbedGenerator(\n      'vimeo.com',\n      /^\\/([^/?#]+)\\/?$/,\n      id => `https://player.vimeo.com/video/${id}`,\n    ),\n\n    // Matches URLs like https://vimeo.com/channels/staffpicks/148845534\n    createEmbedGenerator(\n      'vimeo.com',\n      /^\\/channels\\/[^/]+\\/([^/?#]+)\\/?$/,\n      id => `https://player.vimeo.com/video/${id}`,\n    ),\n\n    /**\n     * Match Internet Archive URLs\n     *\n     *  The patterns are:\n     *\n     *  1. https://archive.org/embed/{slug}?start={startTime}&end={endTime}\n     *     (Embed links)\n     *\n     *  2. https://archive.org/details/{slug}?start={startTime}&end={endTime}\n     *     (Video page links for most videos)\n     *\n     *  3. https://archive.org/details/{slug}/start/{startTime}/end/{endTime}\n     *     (Video page links for the TV News Archive [1])\n     *\n     *  (2) and (3) allow users to copy and paste URLs from archive.org video\n     *  details pages directly into the sidebar to generate video embeds.\n     *\n     *  [1] https://archive.org/details/tv\n     */\n    function iFrameFromInternetArchiveLink(link: HTMLAnchorElement) {\n      if (link.hostname !== 'archive.org') {\n        return null;\n      }\n\n      // Extract the unique slug from the path.\n      const slugMatch = /^\\/(embed|details)\\/(.+)/.exec(link.pathname);\n      if (!slugMatch) {\n        return null;\n      }\n\n      // Extract start and end times, which may appear either as query string\n      // params or path params.\n      let slug = slugMatch[2];\n      const linkParams = new URLSearchParams(link.search);\n      let startTime = linkParams.get('start');\n      let endTime = linkParams.get('end');\n\n      if (!startTime) {\n        const startPathParam = slug.match(/\\/start\\/([^/]+)/);\n        if (startPathParam) {\n          startTime = startPathParam[1];\n          slug = slug.replace(startPathParam[0], '');\n        }\n      }\n\n      if (!endTime) {\n        const endPathParam = slug.match(/\\/end\\/([^/]+)/);\n        if (endPathParam) {\n          endTime = endPathParam[1];\n          slug = slug.replace(endPathParam[0], '');\n        }\n      }\n\n      // Generate embed URL.\n      const iframeUrl = new URL(`https://archive.org/embed/${slug}`);\n      if (startTime) {\n        iframeUrl.searchParams.append('start', startTime);\n      }\n      if (endTime) {\n        iframeUrl.searchParams.append('end', endTime);\n      }\n      return iframe(iframeUrl.href);\n    },\n\n    // Matches URLs that end with .mp3, .ogg, or .wav (assumed to be audio files)\n    function html5audioFromMp3Link(link: HTMLAnchorElement) {\n      if (\n        link.pathname.endsWith('.mp3') ||\n        link.pathname.endsWith('.ogg') ||\n        link.pathname.endsWith('.wav')\n      ) {\n        return audioElement(link.href);\n      }\n      return null;\n    },\n  ];\n\n/**\n * Return an embed element for the given link if it's an embeddable link.\n *\n * If the link is a link for a YouTube video or other embeddable media then\n * return an embed DOM element (for example an <iframe>) for that media.\n */\nfunction embedForLink(link: HTMLAnchorElement): HTMLElement | null {\n  let embed;\n  let j;\n  for (j = 0; j < embedGenerators.length; j++) {\n    embed = embedGenerators[j](link);\n    if (embed) {\n      return embed;\n    }\n  }\n  return null;\n}\n\n/**\n * Replace the given link element with an embed.\n *\n * If the given link element is a link to an embeddable media and if its link\n * text is the same as its href then it will be replaced in the DOM with an\n * embed (e.g. an <iframe> or html5 <audio> element) of the same media.\n *\n * If the link text is different from the href, then the link will be left\n * untouched. We want to convert links like these from the Markdown source into\n * embeds:\n *\n *     https://vimeo.com/channels/staffpicks/148845534\n *     <https://vimeo.com/channels/staffpicks/148845534>\n *\n * But we don't want to convert links like this:\n *\n *     [Custom link text](https://vimeo.com/channels/staffpicks/148845534)\n *\n * because doing so would destroy the user's custom link text, and leave users\n * with no way to just insert a media link without it being embedded.\n *\n * If the link is not a link to an embeddable media it will be left untouched.\n */\nfunction replaceLinkWithEmbed(link: HTMLAnchorElement): HTMLElement | null {\n  // The link's text may or may not be percent encoded. The `link.href` property\n  // will always be percent encoded. When comparing the two we need to be\n  // agnostic as to which representation is used.\n  if (link.href !== link.textContent) {\n    try {\n      const encodedText = encodeURI(link.textContent!);\n      if (link.href !== encodedText) {\n        return null;\n      }\n    } catch {\n      return null;\n    }\n  }\n\n  const embed = embedForLink(link);\n  if (embed) {\n    link.parentElement!.replaceChild(embed, link);\n  }\n  return embed;\n}\n\nexport type EmbedOptions = {\n  /**\n   * Class name to apply to embed containers. An important function of this\n   * class is to set the width of the embed.\n   */\n  className?: string;\n};\n\n/**\n * Replace all embeddable link elements beneath the given element with embeds.\n *\n * All links to YouTube videos or other embeddable media will be replaced with\n * embeds of the same media.\n *\n * @param element - Root element to search for links\n */\nexport function replaceLinksWithEmbeds(\n  element: HTMLElement,\n  { className }: EmbedOptions = {},\n) {\n  // Get a static (non-live) list of <a> children of `element`.\n  // It needs to be static because we may replace these elements as we iterate over them.\n  const links = Array.from(element.getElementsByTagName('a'));\n\n  for (const link of links) {\n    const embed = replaceLinkWithEmbed(link);\n    if (embed) {\n      if (className) {\n        embed.className = className;\n      } else {\n        // Default width.\n        embed.style.width = '350px';\n      }\n    }\n  }\n}\n","/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */\n\nconst {\n  entries,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor\n} = Object;\nlet {\n  freeze,\n  seal,\n  create\n} = Object; // eslint-disable-line import/no-mutable-exports\nlet {\n  apply,\n  construct\n} = typeof Reflect !== 'undefined' && Reflect;\nif (!freeze) {\n  freeze = function freeze(x) {\n    return x;\n  };\n}\nif (!seal) {\n  seal = function seal(x) {\n    return x;\n  };\n}\nif (!apply) {\n  apply = function apply(fun, thisValue, args) {\n    return fun.apply(thisValue, args);\n  };\n}\nif (!construct) {\n  construct = function construct(Func, args) {\n    return new Func(...args);\n  };\n}\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayLastIndexOf = unapply(Array.prototype.lastIndexOf);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst arraySplice = unapply(Array.prototype.splice);\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\nconst objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);\nconst regExpTest = unapply(RegExp.prototype.test);\nconst typeErrorCreate = unconstruct(TypeError);\n/**\n * Creates a new function that calls the given function with a specified thisArg and arguments.\n *\n * @param func - The function to be wrapped and called.\n * @returns A new function that calls the given function with a specified thisArg and arguments.\n */\nfunction unapply(func) {\n  return function (thisArg) {\n    if (thisArg instanceof RegExp) {\n      thisArg.lastIndex = 0;\n    }\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    return apply(func, thisArg, args);\n  };\n}\n/**\n * Creates a new function that constructs an instance of the given constructor function with the provided arguments.\n *\n * @param func - The constructor function to be wrapped and called.\n * @returns A new function that constructs an instance of the given constructor function with the provided arguments.\n */\nfunction unconstruct(func) {\n  return function () {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return construct(func, args);\n  };\n}\n/**\n * Add properties to a lookup table\n *\n * @param set - The set to which elements will be added.\n * @param array - The array containing elements to be added to the set.\n * @param transformCaseFunc - An optional function to transform the case of each element before adding to the set.\n * @returns The modified set with added elements.\n */\nfunction addToSet(set, array) {\n  let transformCaseFunc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : stringToLowerCase;\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          array[l] = lcElement;\n        }\n        element = lcElement;\n      }\n    }\n    set[element] = true;\n  }\n  return set;\n}\n/**\n * Clean up an array to harden against CSPP\n *\n * @param array - The array to be cleaned.\n * @returns The cleaned version of the array\n */\nfunction cleanArray(array) {\n  for (let index = 0; index < array.length; index++) {\n    const isPropertyExist = objectHasOwnProperty(array, index);\n    if (!isPropertyExist) {\n      array[index] = null;\n    }\n  }\n  return array;\n}\n/**\n * Shallow clone an object\n *\n * @param object - The object to be cloned.\n * @returns A new object that copies the original.\n */\nfunction clone(object) {\n  const newObject = create(null);\n  for (const [property, value] of entries(object)) {\n    const isPropertyExist = objectHasOwnProperty(object, property);\n    if (isPropertyExist) {\n      if (Array.isArray(value)) {\n        newObject[property] = cleanArray(value);\n      } else if (value && typeof value === 'object' && value.constructor === Object) {\n        newObject[property] = clone(value);\n      } else {\n        newObject[property] = value;\n      }\n    }\n  }\n  return newObject;\n}\n/**\n * This method automatically checks if the prop is function or getter and behaves accordingly.\n *\n * @param object - The object to look up the getter function in its prototype chain.\n * @param prop - The property name for which to find the getter function.\n * @returns The getter function found in the prototype chain or a fallback function.\n */\nfunction lookupGetter(object, prop) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n    object = getPrototypeOf(object);\n  }\n  function fallbackValue() {\n    return null;\n  }\n  return fallbackValue;\n}\n\nconst html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']);\nconst svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\nconst svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']);\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nconst svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\nconst mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover', 'mprescripts']);\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nconst mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\nconst text = freeze(['#text']);\n\nconst html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'pattern', 'placeholder', 'playsinline', 'popover', 'popovertarget', 'popovertargetaction', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'wrap', 'xmlns', 'slot']);\nconst svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'amplitude', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'exponent', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'intercept', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'slope', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'tablevalues', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\nconst mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\nconst xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\n// eslint-disable-next-line unicorn/better-regex\nconst MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nconst ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nconst TMPLIT_EXPR = seal(/\\$\\{[\\w\\W]*/gm); // eslint-disable-line unicorn/better-regex\nconst DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]+$/); // eslint-disable-line no-useless-escape\nconst ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nconst IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nconst IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nconst ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nconst DOCTYPE_NAME = seal(/^html$/i);\nconst CUSTOM_ELEMENT = seal(/^[a-z][.\\w]*(-[.\\w]+)+$/i);\n\nvar EXPRESSIONS = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  ARIA_ATTR: ARIA_ATTR,\n  ATTR_WHITESPACE: ATTR_WHITESPACE,\n  CUSTOM_ELEMENT: CUSTOM_ELEMENT,\n  DATA_ATTR: DATA_ATTR,\n  DOCTYPE_NAME: DOCTYPE_NAME,\n  ERB_EXPR: ERB_EXPR,\n  IS_ALLOWED_URI: IS_ALLOWED_URI,\n  IS_SCRIPT_OR_DATA: IS_SCRIPT_OR_DATA,\n  MUSTACHE_EXPR: MUSTACHE_EXPR,\n  TMPLIT_EXPR: TMPLIT_EXPR\n});\n\n/* eslint-disable @typescript-eslint/indent */\n// https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\nconst NODE_TYPE = {\n  element: 1,\n  attribute: 2,\n  text: 3,\n  cdataSection: 4,\n  entityReference: 5,\n  // Deprecated\n  entityNode: 6,\n  // Deprecated\n  progressingInstruction: 7,\n  comment: 8,\n  document: 9,\n  documentType: 10,\n  documentFragment: 11,\n  notation: 12 // Deprecated\n};\nconst getGlobal = function getGlobal() {\n  return typeof window === 'undefined' ? null : window;\n};\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param trustedTypes The policy factory.\n * @param purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n * @return The policy created (or null, if Trusted Types\n * are not supported or creating the policy failed).\n */\nconst _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, purifyHostElement) {\n  if (typeof trustedTypes !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n    return null;\n  }\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n    suffix = purifyHostElement.getAttribute(ATTR_NAME);\n  }\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      }\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n    return null;\n  }\n};\nconst _createHooksMap = function _createHooksMap() {\n  return {\n    afterSanitizeAttributes: [],\n    afterSanitizeElements: [],\n    afterSanitizeShadowDOM: [],\n    beforeSanitizeAttributes: [],\n    beforeSanitizeElements: [],\n    beforeSanitizeShadowDOM: [],\n    uponSanitizeAttribute: [],\n    uponSanitizeElement: [],\n    uponSanitizeShadowNode: []\n  };\n};\nfunction createDOMPurify() {\n  let window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n  const DOMPurify = root => createDOMPurify(root);\n  DOMPurify.version = '3.2.5';\n  DOMPurify.removed = [];\n  if (!window || !window.document || window.document.nodeType !== NODE_TYPE.document || !window.Element) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n    return DOMPurify;\n  }\n  let {\n    document\n  } = window;\n  const originalDocument = document;\n  const currentScript = originalDocument.currentScript;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes\n  } = window;\n  const ElementPrototype = Element.prototype;\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const remove = lookupGetter(ElementPrototype, 'remove');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n  let trustedTypesPolicy;\n  let emptyHTML = '';\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName\n  } = document;\n  const {\n    importNode\n  } = originalDocument;\n  let hooks = _createHooksMap();\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported = typeof entries === 'function' && typeof getParentNode === 'function' && implementation && implementation.createHTMLDocument !== undefined;\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n    CUSTOM_ELEMENT\n  } = EXPRESSIONS;\n  let {\n    IS_ALLOWED_URI: IS_ALLOWED_URI$1\n  } = EXPRESSIONS;\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [...html$1, ...svg$1, ...svgFilters, ...mathMl$1, ...text]);\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [...html, ...svg, ...mathMl, ...xml]);\n  /*\n   * Configure how DOMPurify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(create(null, {\n    tagNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    attributeNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    allowCustomizedBuiltInElements: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: false\n    }\n  }));\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n  /* Output should be safe even for XML used within HTML and alike.\n   * This means, DOMPurify removes comments when containing risky content.\n   */\n  let SAFE_FOR_XML = true;\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES = {};\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);\n  let MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n  let HTML_INTEGRATION_POINTS = addToSet({}, ['annotation-xml']);\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE = null;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc = null;\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG = null;\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n  const formElement = document.createElement('form');\n  const isRegexOrFunction = function isRegexOrFunction(testValue) {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n  /**\n   * _parseConfig\n   *\n   * @param cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function _parseConfig() {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n    PARSER_MEDIA_TYPE =\n    // eslint-disable-next-line unicorn/prefer-includes\n    SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? DEFAULT_PARSER_MEDIA_TYPE : cfg.PARSER_MEDIA_TYPE;\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? stringToString : stringToLowerCase;\n    /* Set configuration parameters */\n    ALLOWED_TAGS = objectHasOwnProperty(cfg, 'ALLOWED_TAGS') ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = objectHasOwnProperty(cfg, 'ALLOWED_ATTR') ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, 'ALLOWED_NAMESPACES') ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, 'ADD_URI_SAFE_ATTR') ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), cfg.ADD_URI_SAFE_ATTR, transformCaseFunc) : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = objectHasOwnProperty(cfg, 'ADD_DATA_URI_TAGS') ? addToSet(clone(DEFAULT_DATA_URI_TAGS), cfg.ADD_DATA_URI_TAGS, transformCaseFunc) : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = objectHasOwnProperty(cfg, 'FORBID_CONTENTS') ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = objectHasOwnProperty(cfg, 'FORBID_TAGS') ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : {};\n    FORBID_ATTR = objectHasOwnProperty(cfg, 'FORBID_ATTR') ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : {};\n    USE_PROFILES = objectHasOwnProperty(cfg, 'USE_PROFILES') ? cfg.USE_PROFILES : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    SAFE_FOR_XML = cfg.SAFE_FOR_XML !== false; // Default true\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    MATHML_TEXT_INTEGRATION_POINTS = cfg.MATHML_TEXT_INTEGRATION_POINTS || MATHML_TEXT_INTEGRATION_POINTS;\n    HTML_INTEGRATION_POINTS = cfg.HTML_INTEGRATION_POINTS || HTML_INTEGRATION_POINTS;\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, text);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, html$1);\n        addToSet(ALLOWED_ATTR, html);\n      }\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, svg$1);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, svgFilters);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, mathMl$1);\n        addToSet(ALLOWED_ATTR, mathMl);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n    }\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n        ALLOWED_TAGS = clone(ALLOWED_TAGS);\n      }\n      addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n    }\n    if (cfg.ADD_ATTR) {\n      if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n        ALLOWED_ATTR = clone(ALLOWED_ATTR);\n      }\n      addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n    }\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n    if (cfg.TRUSTED_TYPES_POLICY) {\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.');\n      }\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.');\n      }\n      // Overwrite existing TrustedTypes policy.\n      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;\n      // Sign local variables required by `sanitize`.\n      emptyHTML = trustedTypesPolicy.createHTML('');\n    } else {\n      // Uninitialized policy, attempt to initialize the internal dompurify policy.\n      if (trustedTypesPolicy === undefined) {\n        trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, currentScript);\n      }\n      // If creating the internal policy succeeded sign internal variables.\n      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      }\n    }\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n    CONFIG = cfg;\n  };\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, [...svg$1, ...svgFilters, ...svgDisallowed]);\n  const ALL_MATHML_TAGS = addToSet({}, [...mathMl$1, ...mathMlDisallowed]);\n  /**\n   * @param element a DOM element whose namespace is being checked\n   * @returns Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function _checkValidNamespace(element) {\n    let parent = getParentNode(element);\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template'\n      };\n    }\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n      }\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);\n    }\n    // For XHTML and XML documents that support custom namespaces\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return true;\n    }\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n  /**\n   * _forceRemove\n   *\n   * @param node a DOM node\n   */\n  const _forceRemove = function _forceRemove(node) {\n    arrayPush(DOMPurify.removed, {\n      element: node\n    });\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      getParentNode(node).removeChild(node);\n    } catch (_) {\n      remove(node);\n    }\n  };\n  /**\n   * _removeAttribute\n   *\n   * @param name an Attribute name\n   * @param element a DOM node\n   */\n  const _removeAttribute = function _removeAttribute(name, element) {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: element.getAttributeNode(name),\n        from: element\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: element\n      });\n    }\n    element.removeAttribute(name);\n    // We void attribute values for unremovable \"is\" attributes\n    if (name === 'is') {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(element);\n        } catch (_) {}\n      } else {\n        try {\n          element.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n  /**\n   * _initDocument\n   *\n   * @param dirty - a string of dirty markup\n   * @return a DOM, filled with the dirty markup\n   */\n  const _initDocument = function _initDocument(dirty) {\n    /* Create a HTML document */\n    let doc = null;\n    let leadingWhitespace = null;\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && NAMESPACE === HTML_NAMESPACE) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty = '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' + dirty + '</body></html>';\n    }\n    const dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n    const body = doc.body || doc.documentElement;\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n    }\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n    }\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n  /**\n   * Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\n   *\n   * @param root The root element or node to start traversing on.\n   * @return The created NodeIterator\n   */\n  const _createNodeIterator = function _createNodeIterator(root) {\n    return createNodeIterator.call(root.ownerDocument || root, root,\n    // eslint-disable-next-line no-bitwise\n    NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT | NodeFilter.SHOW_PROCESSING_INSTRUCTION | NodeFilter.SHOW_CDATA_SECTION, null);\n  };\n  /**\n   * _isClobbered\n   *\n   * @param element element to check for clobbering attacks\n   * @return true if clobbered, false if safe\n   */\n  const _isClobbered = function _isClobbered(element) {\n    return element instanceof HTMLFormElement && (typeof element.nodeName !== 'string' || typeof element.textContent !== 'string' || typeof element.removeChild !== 'function' || !(element.attributes instanceof NamedNodeMap) || typeof element.removeAttribute !== 'function' || typeof element.setAttribute !== 'function' || typeof element.namespaceURI !== 'string' || typeof element.insertBefore !== 'function' || typeof element.hasChildNodes !== 'function');\n  };\n  /**\n   * Checks whether the given object is a DOM node.\n   *\n   * @param value object to check whether it's a DOM node\n   * @return true is object is a DOM node\n   */\n  const _isNode = function _isNode(value) {\n    return typeof Node === 'function' && value instanceof Node;\n  };\n  function _executeHooks(hooks, currentNode, data) {\n    arrayForEach(hooks, hook => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  }\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   * @param currentNode to check for permission to exist\n   * @return true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function _sanitizeElements(currentNode) {\n    let content = null;\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeElements, currentNode, null);\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n    /* Execute a hook if present */\n    _executeHooks(hooks.uponSanitizeElement, currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS\n    });\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && regExpTest(/<[/\\w!]/g, currentNode.innerHTML) && regExpTest(/<[/\\w!]/g, currentNode.textContent)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove any occurrence of processing instructions */\n    if (currentNode.nodeType === NODE_TYPE.progressingInstruction) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove any kind of possibly harmful comments */\n    if (SAFE_FOR_XML && currentNode.nodeType === NODE_TYPE.comment && regExpTest(/<[/\\w]/g, currentNode.data)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove element if anything forbids its presence */\n    if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) {\n          return false;\n        }\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) {\n          return false;\n        }\n      }\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n          for (let i = childCount - 1; i >= 0; --i) {\n            const childClone = cloneNode(childNodes[i], true);\n            childClone.__removalCount = (currentNode.__removalCount || 0) + 1;\n            parentNode.insertBefore(childClone, getNextSibling(currentNode));\n          }\n        }\n      }\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if ((tagName === 'noscript' || tagName === 'noembed' || tagName === 'noframes') && regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === NODE_TYPE.text) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        content = stringReplace(content, expr, ' ');\n      });\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, {\n          element: currentNode.cloneNode()\n        });\n        currentNode.textContent = content;\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeElements, currentNode, null);\n    return false;\n  };\n  /**\n   * _isValidAttribute\n   *\n   * @param lcTag Lowercase tag name of containing element.\n   * @param lcName Lowercase attribute name.\n   * @param value Attribute value.\n   * @return Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n    /* Make sure attribute cannot clobber */\n    if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n      return false;\n    }\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n      // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n      // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n      _isBasicCustomElement(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) ||\n      // Alternative, second condition checks if it's an `is`-attribute, AND\n      // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ; else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if (value) {\n      return false;\n    } else ;\n    return true;\n  };\n  /**\n   * _isBasicCustomElement\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   *\n   * @param tagName name of the tag of the node to sanitize\n   * @returns Returns true if the tag name meets the basic criteria for a custom element, otherwise false.\n   */\n  const _isBasicCustomElement = function _isBasicCustomElement(tagName) {\n    return tagName !== 'annotation-xml' && stringMatch(tagName, CUSTOM_ELEMENT);\n  };\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param currentNode to sanitize\n   */\n  const _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeAttributes, currentNode, null);\n    const {\n      attributes\n    } = currentNode;\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes || _isClobbered(currentNode)) {\n      return;\n    }\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR,\n      forceKeepAttr: undefined\n    };\n    let l = attributes.length;\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      const attr = attributes[l];\n      const {\n        name,\n        namespaceURI,\n        value: attrValue\n      } = attr;\n      const lcName = transformCaseFunc(name);\n      let value = name === 'value' ? attrValue : stringTrim(attrValue);\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHooks(hooks.uponSanitizeAttribute, currentNode, hookEvent);\n      value = hookEvent.attrValue;\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n      /* Work around a security issue with comments inside attributes */\n      if (SAFE_FOR_XML && regExpTest(/((--!?|])>)|<\\/(style|title)/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n      /* Remove attribute */\n      _removeAttribute(name, currentNode);\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        continue;\n      }\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n          value = stringReplace(value, expr, ' ');\n        });\n      }\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        continue;\n      }\n      /* Handle attributes that require Trusted Types */\n      if (trustedTypesPolicy && typeof trustedTypes === 'object' && typeof trustedTypes.getAttributeType === 'function') {\n        if (namespaceURI) ; else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML':\n              {\n                value = trustedTypesPolicy.createHTML(value);\n                break;\n              }\n            case 'TrustedScriptURL':\n              {\n                value = trustedTypesPolicy.createScriptURL(value);\n                break;\n              }\n          }\n        }\n      }\n      /* Handle invalid data-* attribute set by try-catching it */\n      try {\n        if (namespaceURI) {\n          currentNode.setAttributeNS(namespaceURI, name, value);\n        } else {\n          /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n          currentNode.setAttribute(name, value);\n        }\n        if (_isClobbered(currentNode)) {\n          _forceRemove(currentNode);\n        } else {\n          arrayPop(DOMPurify.removed);\n        }\n      } catch (_) {}\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeAttributes, currentNode, null);\n  };\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n    let shadowNode = null;\n    const shadowIterator = _createNodeIterator(fragment);\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeShadowDOM, fragment, null);\n    while (shadowNode = shadowIterator.nextNode()) {\n      /* Execute a hook if present */\n      _executeHooks(hooks.uponSanitizeShadowNode, shadowNode, null);\n      /* Sanitize tags and elements */\n      _sanitizeElements(shadowNode);\n      /* Check attributes next */\n      _sanitizeAttributes(shadowNode);\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeShadowDOM, fragment, null);\n  };\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty) {\n    let cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let body = null;\n    let importedNode = null;\n    let currentNode = null;\n    let returnNode = null;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n    /* Return dirty HTML if DOMPurify cannot run */\n    if (!DOMPurify.isSupported) {\n      return dirty;\n    }\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if (dirty.nodeName) {\n        const tagName = transformCaseFunc(dirty.nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (importedNode.nodeType === NODE_TYPE.element && importedNode.nodeName === 'BODY') {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT &&\n      // eslint-disable-next-line unicorn/prefer-includes\n      dirty.indexOf('<') === -1) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      }\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n    /* Get node iterator */\n    const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);\n    /* Now start iterating over the created document */\n    while (currentNode = nodeIterator.nextNode()) {\n      /* Sanitize tags and elements */\n      _sanitizeElements(currentNode);\n      /* Check attributes next */\n      _sanitizeAttributes(currentNode);\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n    }\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n      return returnNode;\n    }\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n    /* Serialize doctype if allowed */\n    if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {\n      serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        serializedHTML = stringReplace(serializedHTML, expr, ' ');\n      });\n    }\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n  };\n  DOMPurify.setConfig = function () {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n  DOMPurify.removeHook = function (entryPoint, hookFunction) {\n    if (hookFunction !== undefined) {\n      const index = arrayLastIndexOf(hooks[entryPoint], hookFunction);\n      return index === -1 ? undefined : arraySplice(hooks[entryPoint], index, 1)[0];\n    }\n    return arrayPop(hooks[entryPoint]);\n  };\n  DOMPurify.removeHooks = function (entryPoint) {\n    hooks[entryPoint] = [];\n  };\n  DOMPurify.removeAllHooks = function () {\n    hooks = _createHooksMap();\n  };\n  return DOMPurify;\n}\nvar purify = createDOMPurify();\n\nexport { purify as default };\n//# sourceMappingURL=purify.es.mjs.map\n","/*!\n * escape-html\n * Copyright(c) 2012-2013 TJ Holowaychuk\n * Copyright(c) 2015 Andreas Lubbe\n * Copyright(c) 2015 Tiancheng \"Timothy\" Gu\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module variables.\n * @private\n */\n\nvar matchHtmlRegExp = /[\"'&<>]/;\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = escapeHtml;\n\n/**\n * Escape special characters in the given string of html.\n *\n * @param  {string} string The string to escape for inserting into HTML\n * @return {string}\n * @public\n */\n\nfunction escapeHtml(string) {\n  var str = '' + string;\n  var match = matchHtmlRegExp.exec(str);\n\n  if (!match) {\n    return str;\n  }\n\n  var escape;\n  var html = '';\n  var index = 0;\n  var lastIndex = 0;\n\n  for (index = match.index; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34: // \"\n        escape = '&quot;';\n        break;\n      case 38: // &\n        escape = '&amp;';\n        break;\n      case 39: // '\n        escape = '&#39;';\n        break;\n      case 60: // <\n        escape = '&lt;';\n        break;\n      case 62: // >\n        escape = '&gt;';\n        break;\n      default:\n        continue;\n    }\n\n    if (lastIndex !== index) {\n      html += str.substring(lastIndex, index);\n    }\n\n    lastIndex = index + 1;\n    html += escape;\n  }\n\n  return lastIndex !== index\n    ? html + str.substring(lastIndex, index)\n    : html;\n}\n","/**\n * Lexing or parsing positional information for error reporting.\n * This object is immutable.\n */\nclass SourceLocation {\n  // The + prefix indicates that these fields aren't writeable\n  // Lexer holding the input string.\n  // Start offset, zero-based inclusive.\n  // End offset, zero-based exclusive.\n  constructor(lexer, start, end) {\n    this.lexer = void 0;\n    this.start = void 0;\n    this.end = void 0;\n    this.lexer = lexer;\n    this.start = start;\n    this.end = end;\n  }\n  /**\n   * Merges two `SourceLocation`s from location providers, given they are\n   * provided in order of appearance.\n   * - Returns the first one's location if only the first is provided.\n   * - Returns a merged range of the first and the last if both are provided\n   *   and their lexers match.\n   * - Otherwise, returns null.\n   */\n\n\n  static range(first, second) {\n    if (!second) {\n      return first && first.loc;\n    } else if (!first || !first.loc || !second.loc || first.loc.lexer !== second.loc.lexer) {\n      return null;\n    } else {\n      return new SourceLocation(first.loc.lexer, first.loc.start, second.loc.end);\n    }\n  }\n\n}\n\n/**\n * Interface required to break circular dependency between Token, Lexer, and\n * ParseError.\n */\n\n/**\n * The resulting token returned from `lex`.\n *\n * It consists of the token text plus some position information.\n * The position information is essentially a range in an input string,\n * but instead of referencing the bare input string, we refer to the lexer.\n * That way it is possible to attach extra metadata to the input string,\n * like for example a file name or similar.\n *\n * The position information is optional, so it is OK to construct synthetic\n * tokens if appropriate. Not providing available position information may\n * lead to degraded error reporting, though.\n */\nclass Token {\n  // don't expand the token\n  // used in \\noexpand\n  constructor(text, // the text of this token\n  loc) {\n    this.text = void 0;\n    this.loc = void 0;\n    this.noexpand = void 0;\n    this.treatAsRelax = void 0;\n    this.text = text;\n    this.loc = loc;\n  }\n  /**\n   * Given a pair of tokens (this and endToken), compute a `Token` encompassing\n   * the whole input range enclosed by these two.\n   */\n\n\n  range(endToken, // last token of the range, inclusive\n  text // the text of the newly constructed token\n  ) {\n    return new Token(text, SourceLocation.range(this, endToken));\n  }\n\n}\n\n/**\n * This is the ParseError class, which is the main error thrown by KaTeX\n * functions when something has gone wrong. This is used to distinguish internal\n * errors from errors in the expression that the user provided.\n *\n * If possible, a caller should provide a Token or ParseNode with information\n * about where in the source string the problem occurred.\n */\nclass ParseError {\n  // Error start position based on passed-in Token or ParseNode.\n  // Length of affected text based on passed-in Token or ParseNode.\n  // The underlying error message without any context added.\n  constructor(message, // The error message\n  token // An object providing position information\n  ) {\n    this.name = void 0;\n    this.position = void 0;\n    this.length = void 0;\n    this.rawMessage = void 0;\n    var error = \"KaTeX parse error: \" + message;\n    var start;\n    var end;\n    var loc = token && token.loc;\n\n    if (loc && loc.start <= loc.end) {\n      // If we have the input and a position, make the error a bit fancier\n      // Get the input\n      var input = loc.lexer.input; // Prepend some information\n\n      start = loc.start;\n      end = loc.end;\n\n      if (start === input.length) {\n        error += \" at end of input: \";\n      } else {\n        error += \" at position \" + (start + 1) + \": \";\n      } // Underline token in question using combining underscores\n\n\n      var underlined = input.slice(start, end).replace(/[^]/g, \"$&\\u0332\"); // Extract some context from the input and add it to the error\n\n      var left;\n\n      if (start > 15) {\n        left = \"…\" + input.slice(start - 15, start);\n      } else {\n        left = input.slice(0, start);\n      }\n\n      var right;\n\n      if (end + 15 < input.length) {\n        right = input.slice(end, end + 15) + \"…\";\n      } else {\n        right = input.slice(end);\n      }\n\n      error += left + underlined + right;\n    } // Some hackery to make ParseError a prototype of Error\n    // See http://stackoverflow.com/a/8460753\n    // $FlowFixMe\n\n\n    var self = new Error(error);\n    self.name = \"ParseError\"; // $FlowFixMe\n\n    self.__proto__ = ParseError.prototype;\n    self.position = start;\n\n    if (start != null && end != null) {\n      self.length = end - start;\n    }\n\n    self.rawMessage = message;\n    return self;\n  }\n\n} // $FlowFixMe More hackery\n\n\nParseError.prototype.__proto__ = Error.prototype;\n\n/**\n * This file contains a list of utility functions which are useful in other\n * files.\n */\n\n/**\n * Return whether an element is contained in a list\n */\nvar contains = function contains(list, elem) {\n  return list.indexOf(elem) !== -1;\n};\n/**\n * Provide a default value if a setting is undefined\n * NOTE: Couldn't use `T` as the output type due to facebook/flow#5022.\n */\n\n\nvar deflt = function deflt(setting, defaultIfUndefined) {\n  return setting === undefined ? defaultIfUndefined : setting;\n}; // hyphenate and escape adapted from Facebook's React under Apache 2 license\n\n\nvar uppercase = /([A-Z])/g;\n\nvar hyphenate = function hyphenate(str) {\n  return str.replace(uppercase, \"-$1\").toLowerCase();\n};\n\nvar ESCAPE_LOOKUP = {\n  \"&\": \"&amp;\",\n  \">\": \"&gt;\",\n  \"<\": \"&lt;\",\n  \"\\\"\": \"&quot;\",\n  \"'\": \"&#x27;\"\n};\nvar ESCAPE_REGEX = /[&><\"']/g;\n/**\n * Escapes text to prevent scripting attacks.\n */\n\nfunction escape(text) {\n  return String(text).replace(ESCAPE_REGEX, match => ESCAPE_LOOKUP[match]);\n}\n/**\n * Sometimes we want to pull out the innermost element of a group. In most\n * cases, this will just be the group itself, but when ordgroups and colors have\n * a single element, we want to pull that out.\n */\n\n\nvar getBaseElem = function getBaseElem(group) {\n  if (group.type === \"ordgroup\") {\n    if (group.body.length === 1) {\n      return getBaseElem(group.body[0]);\n    } else {\n      return group;\n    }\n  } else if (group.type === \"color\") {\n    if (group.body.length === 1) {\n      return getBaseElem(group.body[0]);\n    } else {\n      return group;\n    }\n  } else if (group.type === \"font\") {\n    return getBaseElem(group.body);\n  } else {\n    return group;\n  }\n};\n/**\n * TeXbook algorithms often reference \"character boxes\", which are simply groups\n * with a single character in them. To decide if something is a character box,\n * we find its innermost group, and see if it is a single character.\n */\n\n\nvar isCharacterBox = function isCharacterBox(group) {\n  var baseElem = getBaseElem(group); // These are all they types of groups which hold single characters\n\n  return baseElem.type === \"mathord\" || baseElem.type === \"textord\" || baseElem.type === \"atom\";\n};\n\nvar assert = function assert(value) {\n  if (!value) {\n    throw new Error('Expected non-null, but got ' + String(value));\n  }\n\n  return value;\n};\n/**\n * Return the protocol of a URL, or \"_relative\" if the URL does not specify a\n * protocol (and thus is relative), or `null` if URL has invalid protocol\n * (so should be outright rejected).\n */\n\nvar protocolFromUrl = function protocolFromUrl(url) {\n  // Check for possible leading protocol.\n  // https://url.spec.whatwg.org/#url-parsing strips leading whitespace\n  // (U+20) or C0 control (U+00-U+1F) characters.\n  // eslint-disable-next-line no-control-regex\n  var protocol = /^[\\x00-\\x20]*([^\\\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(url);\n\n  if (!protocol) {\n    return \"_relative\";\n  } // Reject weird colons\n\n\n  if (protocol[2] !== \":\") {\n    return null;\n  } // Reject invalid characters in scheme according to\n  // https://datatracker.ietf.org/doc/html/rfc3986#section-3.1\n\n\n  if (!/^[a-zA-Z][a-zA-Z0-9+\\-.]*$/.test(protocol[1])) {\n    return null;\n  } // Lowercase the protocol\n\n\n  return protocol[1].toLowerCase();\n};\nvar utils = {\n  contains,\n  deflt,\n  escape,\n  hyphenate,\n  getBaseElem,\n  isCharacterBox,\n  protocolFromUrl\n};\n\n/* eslint no-console:0 */\n// TODO: automatically generate documentation\n// TODO: check all properties on Settings exist\n// TODO: check the type of a property on Settings matches\nvar SETTINGS_SCHEMA = {\n  displayMode: {\n    type: \"boolean\",\n    description: \"Render math in display mode, which puts the math in \" + \"display style (so \\\\int and \\\\sum are large, for example), and \" + \"centers the math on the page on its own line.\",\n    cli: \"-d, --display-mode\"\n  },\n  output: {\n    type: {\n      enum: [\"htmlAndMathml\", \"html\", \"mathml\"]\n    },\n    description: \"Determines the markup language of the output.\",\n    cli: \"-F, --format <type>\"\n  },\n  leqno: {\n    type: \"boolean\",\n    description: \"Render display math in leqno style (left-justified tags).\"\n  },\n  fleqn: {\n    type: \"boolean\",\n    description: \"Render display math flush left.\"\n  },\n  throwOnError: {\n    type: \"boolean\",\n    default: true,\n    cli: \"-t, --no-throw-on-error\",\n    cliDescription: \"Render errors (in the color given by --error-color) ins\" + \"tead of throwing a ParseError exception when encountering an error.\"\n  },\n  errorColor: {\n    type: \"string\",\n    default: \"#cc0000\",\n    cli: \"-c, --error-color <color>\",\n    cliDescription: \"A color string given in the format 'rgb' or 'rrggbb' \" + \"(no #). This option determines the color of errors rendered by the \" + \"-t option.\",\n    cliProcessor: color => \"#\" + color\n  },\n  macros: {\n    type: \"object\",\n    cli: \"-m, --macro <def>\",\n    cliDescription: \"Define custom macro of the form '\\\\foo:expansion' (use \" + \"multiple -m arguments for multiple macros).\",\n    cliDefault: [],\n    cliProcessor: (def, defs) => {\n      defs.push(def);\n      return defs;\n    }\n  },\n  minRuleThickness: {\n    type: \"number\",\n    description: \"Specifies a minimum thickness, in ems, for fraction lines,\" + \" `\\\\sqrt` top lines, `{array}` vertical lines, `\\\\hline`, \" + \"`\\\\hdashline`, `\\\\underline`, `\\\\overline`, and the borders of \" + \"`\\\\fbox`, `\\\\boxed`, and `\\\\fcolorbox`.\",\n    processor: t => Math.max(0, t),\n    cli: \"--min-rule-thickness <size>\",\n    cliProcessor: parseFloat\n  },\n  colorIsTextColor: {\n    type: \"boolean\",\n    description: \"Makes \\\\color behave like LaTeX's 2-argument \\\\textcolor, \" + \"instead of LaTeX's one-argument \\\\color mode change.\",\n    cli: \"-b, --color-is-text-color\"\n  },\n  strict: {\n    type: [{\n      enum: [\"warn\", \"ignore\", \"error\"]\n    }, \"boolean\", \"function\"],\n    description: \"Turn on strict / LaTeX faithfulness mode, which throws an \" + \"error if the input uses features that are not supported by LaTeX.\",\n    cli: \"-S, --strict\",\n    cliDefault: false\n  },\n  trust: {\n    type: [\"boolean\", \"function\"],\n    description: \"Trust the input, enabling all HTML features such as \\\\url.\",\n    cli: \"-T, --trust\"\n  },\n  maxSize: {\n    type: \"number\",\n    default: Infinity,\n    description: \"If non-zero, all user-specified sizes, e.g. in \" + \"\\\\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, \" + \"elements and spaces can be arbitrarily large\",\n    processor: s => Math.max(0, s),\n    cli: \"-s, --max-size <n>\",\n    cliProcessor: parseInt\n  },\n  maxExpand: {\n    type: \"number\",\n    default: 1000,\n    description: \"Limit the number of macro expansions to the specified \" + \"number, to prevent e.g. infinite macro loops. If set to Infinity, \" + \"the macro expander will try to fully expand as in LaTeX.\",\n    processor: n => Math.max(0, n),\n    cli: \"-e, --max-expand <n>\",\n    cliProcessor: n => n === \"Infinity\" ? Infinity : parseInt(n)\n  },\n  globalGroup: {\n    type: \"boolean\",\n    cli: false\n  }\n};\n\nfunction getDefaultValue(schema) {\n  if (schema.default) {\n    return schema.default;\n  }\n\n  var type = schema.type;\n  var defaultType = Array.isArray(type) ? type[0] : type;\n\n  if (typeof defaultType !== 'string') {\n    return defaultType.enum[0];\n  }\n\n  switch (defaultType) {\n    case 'boolean':\n      return false;\n\n    case 'string':\n      return '';\n\n    case 'number':\n      return 0;\n\n    case 'object':\n      return {};\n  }\n}\n/**\n * The main Settings object\n *\n * The current options stored are:\n *  - displayMode: Whether the expression should be typeset as inline math\n *                 (false, the default), meaning that the math starts in\n *                 \\textstyle and is placed in an inline-block); or as display\n *                 math (true), meaning that the math starts in \\displaystyle\n *                 and is placed in a block with vertical margin.\n */\n\n\nclass Settings {\n  constructor(options) {\n    this.displayMode = void 0;\n    this.output = void 0;\n    this.leqno = void 0;\n    this.fleqn = void 0;\n    this.throwOnError = void 0;\n    this.errorColor = void 0;\n    this.macros = void 0;\n    this.minRuleThickness = void 0;\n    this.colorIsTextColor = void 0;\n    this.strict = void 0;\n    this.trust = void 0;\n    this.maxSize = void 0;\n    this.maxExpand = void 0;\n    this.globalGroup = void 0;\n    // allow null options\n    options = options || {};\n\n    for (var prop in SETTINGS_SCHEMA) {\n      if (SETTINGS_SCHEMA.hasOwnProperty(prop)) {\n        // $FlowFixMe\n        var schema = SETTINGS_SCHEMA[prop]; // TODO: validate options\n        // $FlowFixMe\n\n        this[prop] = options[prop] !== undefined ? schema.processor ? schema.processor(options[prop]) : options[prop] : getDefaultValue(schema);\n      }\n    }\n  }\n  /**\n   * Report nonstrict (non-LaTeX-compatible) input.\n   * Can safely not be called if `this.strict` is false in JavaScript.\n   */\n\n\n  reportNonstrict(errorCode, errorMsg, token) {\n    var strict = this.strict;\n\n    if (typeof strict === \"function\") {\n      // Allow return value of strict function to be boolean or string\n      // (or null/undefined, meaning no further processing).\n      strict = strict(errorCode, errorMsg, token);\n    }\n\n    if (!strict || strict === \"ignore\") {\n      return;\n    } else if (strict === true || strict === \"error\") {\n      throw new ParseError(\"LaTeX-incompatible input and strict mode is set to 'error': \" + (errorMsg + \" [\" + errorCode + \"]\"), token);\n    } else if (strict === \"warn\") {\n      typeof console !== \"undefined\" && console.warn(\"LaTeX-incompatible input and strict mode is set to 'warn': \" + (errorMsg + \" [\" + errorCode + \"]\"));\n    } else {\n      // won't happen in type-safe code\n      typeof console !== \"undefined\" && console.warn(\"LaTeX-incompatible input and strict mode is set to \" + (\"unrecognized '\" + strict + \"': \" + errorMsg + \" [\" + errorCode + \"]\"));\n    }\n  }\n  /**\n   * Check whether to apply strict (LaTeX-adhering) behavior for unusual\n   * input (like `\\\\`).  Unlike `nonstrict`, will not throw an error;\n   * instead, \"error\" translates to a return value of `true`, while \"ignore\"\n   * translates to a return value of `false`.  May still print a warning:\n   * \"warn\" prints a warning and returns `false`.\n   * This is for the second category of `errorCode`s listed in the README.\n   */\n\n\n  useStrictBehavior(errorCode, errorMsg, token) {\n    var strict = this.strict;\n\n    if (typeof strict === \"function\") {\n      // Allow return value of strict function to be boolean or string\n      // (or null/undefined, meaning no further processing).\n      // But catch any exceptions thrown by function, treating them\n      // like \"error\".\n      try {\n        strict = strict(errorCode, errorMsg, token);\n      } catch (error) {\n        strict = \"error\";\n      }\n    }\n\n    if (!strict || strict === \"ignore\") {\n      return false;\n    } else if (strict === true || strict === \"error\") {\n      return true;\n    } else if (strict === \"warn\") {\n      typeof console !== \"undefined\" && console.warn(\"LaTeX-incompatible input and strict mode is set to 'warn': \" + (errorMsg + \" [\" + errorCode + \"]\"));\n      return false;\n    } else {\n      // won't happen in type-safe code\n      typeof console !== \"undefined\" && console.warn(\"LaTeX-incompatible input and strict mode is set to \" + (\"unrecognized '\" + strict + \"': \" + errorMsg + \" [\" + errorCode + \"]\"));\n      return false;\n    }\n  }\n  /**\n   * Check whether to test potentially dangerous input, and return\n   * `true` (trusted) or `false` (untrusted).  The sole argument `context`\n   * should be an object with `command` field specifying the relevant LaTeX\n   * command (as a string starting with `\\`), and any other arguments, etc.\n   * If `context` has a `url` field, a `protocol` field will automatically\n   * get added by this function (changing the specified object).\n   */\n\n\n  isTrusted(context) {\n    if (context.url && !context.protocol) {\n      var protocol = utils.protocolFromUrl(context.url);\n\n      if (protocol == null) {\n        return false;\n      }\n\n      context.protocol = protocol;\n    }\n\n    var trust = typeof this.trust === \"function\" ? this.trust(context) : this.trust;\n    return Boolean(trust);\n  }\n\n}\n\n/**\n * This file contains information and classes for the various kinds of styles\n * used in TeX. It provides a generic `Style` class, which holds information\n * about a specific style. It then provides instances of all the different kinds\n * of styles possible, and provides functions to move between them and get\n * information about them.\n */\n\n/**\n * The main style class. Contains a unique id for the style, a size (which is\n * the same for cramped and uncramped version of a style), and a cramped flag.\n */\nclass Style {\n  constructor(id, size, cramped) {\n    this.id = void 0;\n    this.size = void 0;\n    this.cramped = void 0;\n    this.id = id;\n    this.size = size;\n    this.cramped = cramped;\n  }\n  /**\n   * Get the style of a superscript given a base in the current style.\n   */\n\n\n  sup() {\n    return styles[sup[this.id]];\n  }\n  /**\n   * Get the style of a subscript given a base in the current style.\n   */\n\n\n  sub() {\n    return styles[sub[this.id]];\n  }\n  /**\n   * Get the style of a fraction numerator given the fraction in the current\n   * style.\n   */\n\n\n  fracNum() {\n    return styles[fracNum[this.id]];\n  }\n  /**\n   * Get the style of a fraction denominator given the fraction in the current\n   * style.\n   */\n\n\n  fracDen() {\n    return styles[fracDen[this.id]];\n  }\n  /**\n   * Get the cramped version of a style (in particular, cramping a cramped style\n   * doesn't change the style).\n   */\n\n\n  cramp() {\n    return styles[cramp[this.id]];\n  }\n  /**\n   * Get a text or display version of this style.\n   */\n\n\n  text() {\n    return styles[text$1[this.id]];\n  }\n  /**\n   * Return true if this style is tightly spaced (scriptstyle/scriptscriptstyle)\n   */\n\n\n  isTight() {\n    return this.size >= 2;\n  }\n\n} // Export an interface for type checking, but don't expose the implementation.\n// This way, no more styles can be generated.\n\n\n// IDs of the different styles\nvar D = 0;\nvar Dc = 1;\nvar T = 2;\nvar Tc = 3;\nvar S = 4;\nvar Sc = 5;\nvar SS = 6;\nvar SSc = 7; // Instances of the different styles\n\nvar styles = [new Style(D, 0, false), new Style(Dc, 0, true), new Style(T, 1, false), new Style(Tc, 1, true), new Style(S, 2, false), new Style(Sc, 2, true), new Style(SS, 3, false), new Style(SSc, 3, true)]; // Lookup tables for switching from one style to another\n\nvar sup = [S, Sc, S, Sc, SS, SSc, SS, SSc];\nvar sub = [Sc, Sc, Sc, Sc, SSc, SSc, SSc, SSc];\nvar fracNum = [T, Tc, S, Sc, SS, SSc, SS, SSc];\nvar fracDen = [Tc, Tc, Sc, Sc, SSc, SSc, SSc, SSc];\nvar cramp = [Dc, Dc, Tc, Tc, Sc, Sc, SSc, SSc];\nvar text$1 = [D, Dc, T, Tc, T, Tc, T, Tc]; // We only export some of the styles.\n\nvar Style$1 = {\n  DISPLAY: styles[D],\n  TEXT: styles[T],\n  SCRIPT: styles[S],\n  SCRIPTSCRIPT: styles[SS]\n};\n\n/*\n * This file defines the Unicode scripts and script families that we\n * support. To add new scripts or families, just add a new entry to the\n * scriptData array below. Adding scripts to the scriptData array allows\n * characters from that script to appear in \\text{} environments.\n */\n\n/**\n * Each script or script family has a name and an array of blocks.\n * Each block is an array of two numbers which specify the start and\n * end points (inclusive) of a block of Unicode codepoints.\n */\n\n/**\n * Unicode block data for the families of scripts we support in \\text{}.\n * Scripts only need to appear here if they do not have font metrics.\n */\nvar scriptData = [{\n  // Latin characters beyond the Latin-1 characters we have metrics for.\n  // Needed for Czech, Hungarian and Turkish text, for example.\n  name: 'latin',\n  blocks: [[0x0100, 0x024f], // Latin Extended-A and Latin Extended-B\n  [0x0300, 0x036f] // Combining Diacritical marks\n  ]\n}, {\n  // The Cyrillic script used by Russian and related languages.\n  // A Cyrillic subset used to be supported as explicitly defined\n  // symbols in symbols.js\n  name: 'cyrillic',\n  blocks: [[0x0400, 0x04ff]]\n}, {\n  // Armenian\n  name: 'armenian',\n  blocks: [[0x0530, 0x058F]]\n}, {\n  // The Brahmic scripts of South and Southeast Asia\n  // Devanagari (0900–097F)\n  // Bengali (0980–09FF)\n  // Gurmukhi (0A00–0A7F)\n  // Gujarati (0A80–0AFF)\n  // Oriya (0B00–0B7F)\n  // Tamil (0B80–0BFF)\n  // Telugu (0C00–0C7F)\n  // Kannada (0C80–0CFF)\n  // Malayalam (0D00–0D7F)\n  // Sinhala (0D80–0DFF)\n  // Thai (0E00–0E7F)\n  // Lao (0E80–0EFF)\n  // Tibetan (0F00–0FFF)\n  // Myanmar (1000–109F)\n  name: 'brahmic',\n  blocks: [[0x0900, 0x109F]]\n}, {\n  name: 'georgian',\n  blocks: [[0x10A0, 0x10ff]]\n}, {\n  // Chinese and Japanese.\n  // The \"k\" in cjk is for Korean, but we've separated Korean out\n  name: \"cjk\",\n  blocks: [[0x3000, 0x30FF], // CJK symbols and punctuation, Hiragana, Katakana\n  [0x4E00, 0x9FAF], // CJK ideograms\n  [0xFF00, 0xFF60] // Fullwidth punctuation\n  // TODO: add halfwidth Katakana and Romanji glyphs\n  ]\n}, {\n  // Korean\n  name: 'hangul',\n  blocks: [[0xAC00, 0xD7AF]]\n}];\n/**\n * Given a codepoint, return the name of the script or script family\n * it is from, or null if it is not part of a known block\n */\n\nfunction scriptFromCodepoint(codepoint) {\n  for (var i = 0; i < scriptData.length; i++) {\n    var script = scriptData[i];\n\n    for (var _i = 0; _i < script.blocks.length; _i++) {\n      var block = script.blocks[_i];\n\n      if (codepoint >= block[0] && codepoint <= block[1]) {\n        return script.name;\n      }\n    }\n  }\n\n  return null;\n}\n/**\n * A flattened version of all the supported blocks in a single array.\n * This is an optimization to make supportedCodepoint() fast.\n */\n\nvar allBlocks = [];\nscriptData.forEach(s => s.blocks.forEach(b => allBlocks.push(...b)));\n/**\n * Given a codepoint, return true if it falls within one of the\n * scripts or script families defined above and false otherwise.\n *\n * Micro benchmarks shows that this is faster than\n * /[\\u3000-\\u30FF\\u4E00-\\u9FAF\\uFF00-\\uFF60\\uAC00-\\uD7AF\\u0900-\\u109F]/.test()\n * in Firefox, Chrome and Node.\n */\n\nfunction supportedCodepoint(codepoint) {\n  for (var i = 0; i < allBlocks.length; i += 2) {\n    if (codepoint >= allBlocks[i] && codepoint <= allBlocks[i + 1]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * This file provides support to domTree.js and delimiter.js.\n * It's a storehouse of path geometry for SVG images.\n */\n// In all paths below, the viewBox-to-em scale is 1000:1.\nvar hLinePad = 80; // padding above a sqrt vinculum. Prevents image cropping.\n// The vinculum of a \\sqrt can be made thicker by a KaTeX rendering option.\n// Think of variable extraVinculum as two detours in the SVG path.\n// The detour begins at the lower left of the area labeled extraVinculum below.\n// The detour proceeds one extraVinculum distance up and slightly to the right,\n// displacing the radiused corner between surd and vinculum. The radius is\n// traversed as usual, then the detour resumes. It goes right, to the end of\n// the very long vinculum, then down one extraVinculum distance,\n// after which it resumes regular path geometry for the radical.\n\n/*                                                  vinculum\n                                                   /\n         /▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒←extraVinculum\n        / █████████████████████←0.04em (40 unit) std vinculum thickness\n       / /\n      / /\n     / /\\\n    / / surd\n*/\n\nvar sqrtMain = function sqrtMain(extraVinculum, hLinePad) {\n  // sqrtMain path geometry is from glyph U221A in the font KaTeX Main\n  return \"M95,\" + (622 + extraVinculum + hLinePad) + \"\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl\" + extraVinculum / 2.075 + \" -\" + extraVinculum + \"\\nc5.3,-9.3,12,-14,20,-14\\nH400000v\" + (40 + extraVinculum) + \"H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM\" + (834 + extraVinculum) + \" \" + hLinePad + \"h400000v\" + (40 + extraVinculum) + \"h-400000z\";\n};\n\nvar sqrtSize1 = function sqrtSize1(extraVinculum, hLinePad) {\n  // size1 is from glyph U221A in the font KaTeX_Size1-Regular\n  return \"M263,\" + (601 + extraVinculum + hLinePad) + \"c0.7,0,18,39.7,52,119\\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\\nc340,-704.7,510.7,-1060.3,512,-1067\\nl\" + extraVinculum / 2.084 + \" -\" + extraVinculum + \"\\nc4.7,-7.3,11,-11,19,-11\\nH40000v\" + (40 + extraVinculum) + \"H1012.3\\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\\nM\" + (1001 + extraVinculum) + \" \" + hLinePad + \"h400000v\" + (40 + extraVinculum) + \"h-400000z\";\n};\n\nvar sqrtSize2 = function sqrtSize2(extraVinculum, hLinePad) {\n  // size2 is from glyph U221A in the font KaTeX_Size2-Regular\n  return \"M983 \" + (10 + extraVinculum + hLinePad) + \"\\nl\" + extraVinculum / 3.13 + \" -\" + extraVinculum + \"\\nc4,-6.7,10,-10,18,-10 H400000v\" + (40 + extraVinculum) + \"\\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\\nM\" + (1001 + extraVinculum) + \" \" + hLinePad + \"h400000v\" + (40 + extraVinculum) + \"h-400000z\";\n};\n\nvar sqrtSize3 = function sqrtSize3(extraVinculum, hLinePad) {\n  // size3 is from glyph U221A in the font KaTeX_Size3-Regular\n  return \"M424,\" + (2398 + extraVinculum + hLinePad) + \"\\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\\nl\" + extraVinculum / 4.223 + \" -\" + extraVinculum + \"c4,-6.7,10,-10,18,-10 H400000\\nv\" + (40 + extraVinculum) + \"H1014.6\\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\\nc-2,6,-10,9,-24,9\\nc-8,0,-12,-0.7,-12,-2z M\" + (1001 + extraVinculum) + \" \" + hLinePad + \"\\nh400000v\" + (40 + extraVinculum) + \"h-400000z\";\n};\n\nvar sqrtSize4 = function sqrtSize4(extraVinculum, hLinePad) {\n  // size4 is from glyph U221A in the font KaTeX_Size4-Regular\n  return \"M473,\" + (2713 + extraVinculum + hLinePad) + \"\\nc339.3,-1799.3,509.3,-2700,510,-2702 l\" + extraVinculum / 5.298 + \" -\" + extraVinculum + \"\\nc3.3,-7.3,9.3,-11,18,-11 H400000v\" + (40 + extraVinculum) + \"H1017.7\\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\\n606zM\" + (1001 + extraVinculum) + \" \" + hLinePad + \"h400000v\" + (40 + extraVinculum) + \"H1017.7z\";\n};\n\nvar phasePath = function phasePath(y) {\n  var x = y / 2; // x coordinate at top of angle\n\n  return \"M400000 \" + y + \" H0 L\" + x + \" 0 l65 45 L145 \" + (y - 80) + \" H400000z\";\n};\n\nvar sqrtTall = function sqrtTall(extraVinculum, hLinePad, viewBoxHeight) {\n  // sqrtTall is from glyph U23B7 in the font KaTeX_Size4-Regular\n  // One path edge has a variable length. It runs vertically from the vinculum\n  // to a point near (14 units) the bottom of the surd. The vinculum\n  // is normally 40 units thick. So the length of the line in question is:\n  var vertSegment = viewBoxHeight - 54 - hLinePad - extraVinculum;\n  return \"M702 \" + (extraVinculum + hLinePad) + \"H400000\" + (40 + extraVinculum) + \"\\nH742v\" + vertSegment + \"l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\\n219 661 l218 661zM702 \" + hLinePad + \"H400000v\" + (40 + extraVinculum) + \"H742z\";\n};\n\nvar sqrtPath = function sqrtPath(size, extraVinculum, viewBoxHeight) {\n  extraVinculum = 1000 * extraVinculum; // Convert from document ems to viewBox.\n\n  var path = \"\";\n\n  switch (size) {\n    case \"sqrtMain\":\n      path = sqrtMain(extraVinculum, hLinePad);\n      break;\n\n    case \"sqrtSize1\":\n      path = sqrtSize1(extraVinculum, hLinePad);\n      break;\n\n    case \"sqrtSize2\":\n      path = sqrtSize2(extraVinculum, hLinePad);\n      break;\n\n    case \"sqrtSize3\":\n      path = sqrtSize3(extraVinculum, hLinePad);\n      break;\n\n    case \"sqrtSize4\":\n      path = sqrtSize4(extraVinculum, hLinePad);\n      break;\n\n    case \"sqrtTall\":\n      path = sqrtTall(extraVinculum, hLinePad, viewBoxHeight);\n  }\n\n  return path;\n};\nvar innerPath = function innerPath(name, height) {\n  // The inner part of stretchy tall delimiters\n  switch (name) {\n    case \"\\u239c\":\n      return \"M291 0 H417 V\" + height + \" H291z M291 0 H417 V\" + height + \" H291z\";\n\n    case \"\\u2223\":\n      return \"M145 0 H188 V\" + height + \" H145z M145 0 H188 V\" + height + \" H145z\";\n\n    case \"\\u2225\":\n      return \"M145 0 H188 V\" + height + \" H145z M145 0 H188 V\" + height + \" H145z\" + (\"M367 0 H410 V\" + height + \" H367z M367 0 H410 V\" + height + \" H367z\");\n\n    case \"\\u239f\":\n      return \"M457 0 H583 V\" + height + \" H457z M457 0 H583 V\" + height + \" H457z\";\n\n    case \"\\u23a2\":\n      return \"M319 0 H403 V\" + height + \" H319z M319 0 H403 V\" + height + \" H319z\";\n\n    case \"\\u23a5\":\n      return \"M263 0 H347 V\" + height + \" H263z M263 0 H347 V\" + height + \" H263z\";\n\n    case \"\\u23aa\":\n      return \"M384 0 H504 V\" + height + \" H384z M384 0 H504 V\" + height + \" H384z\";\n\n    case \"\\u23d0\":\n      return \"M312 0 H355 V\" + height + \" H312z M312 0 H355 V\" + height + \" H312z\";\n\n    case \"\\u2016\":\n      return \"M257 0 H300 V\" + height + \" H257z M257 0 H300 V\" + height + \" H257z\" + (\"M478 0 H521 V\" + height + \" H478z M478 0 H521 V\" + height + \" H478z\");\n\n    default:\n      return \"\";\n  }\n};\nvar path = {\n  // The doubleleftarrow geometry is from glyph U+21D0 in the font KaTeX Main\n  doubleleftarrow: \"M262 157\\nl10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3\\n 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28\\n 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5\\nc2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5\\n 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87\\n-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7\\n-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z\\nm8 0v40h399730v-40zm0 194v40h399730v-40z\",\n  // doublerightarrow is from glyph U+21D2 in font KaTeX Main\n  doublerightarrow: \"M399738 392l\\n-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5\\n 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88\\n-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68\\n-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18\\n-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782\\nc-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3\\n-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z\",\n  // leftarrow is from glyph U+2190 in font KaTeX Main\n  leftarrow: \"M400000 241H110l3-3c68.7-52.7 113.7-120\\n 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8\\n-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247\\nc-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208\\n 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3\\n 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202\\n l-3-3h399890zM100 241v40h399900v-40z\",\n  // overbrace is from glyphs U+23A9/23A8/23A7 in font KaTeX_Size4-Regular\n  leftbrace: \"M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z\",\n  leftbraceunder: \"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z\",\n  // overgroup is from the MnSymbol package (public domain)\n  leftgroup: \"M400000 80\\nH435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0\\n 435 0h399565z\",\n  leftgroupunder: \"M400000 262\\nH435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219\\n 435 219h399565z\",\n  // Harpoons are from glyph U+21BD in font KaTeX Main\n  leftharpoon: \"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3\\n-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5\\n-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7\\n-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z\",\n  leftharpoonplus: \"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5\\n 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3\\n-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7\\n-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z\\nm0 0v40h400000v-40z\",\n  leftharpoondown: \"M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333\\n 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5\\n 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667\\n-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z\",\n  leftharpoondownplus: \"M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12\\n 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7\\n-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0\\nv40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z\",\n  // hook is from glyph U+21A9 in font KaTeX Main\n  lefthook: \"M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5\\n-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3\\n-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21\\n 71.5 23h399859zM103 281v-40h399897v40z\",\n  leftlinesegment: \"M40 281 V428 H0 V94 H40 V241 H400000 v40z\\nM40 281 V428 H0 V94 H40 V241 H400000 v40z\",\n  leftmapsto: \"M40 281 V448H0V74H40V241H400000v40z\\nM40 281 V448H0V74H40V241H400000v40z\",\n  // tofrom is from glyph U+21C4 in font KaTeX AMS Regular\n  leftToFrom: \"M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23\\n-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8\\nc28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3\\n 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z\",\n  longequal: \"M0 50 h400000 v40H0z m0 194h40000v40H0z\\nM0 50 h400000 v40H0z m0 194h40000v40H0z\",\n  midbrace: \"M200428 334\\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z\",\n  midbraceunder: \"M199572 214\\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z\",\n  oiintSize1: \"M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6\\n-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z\\nm368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8\\n60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z\",\n  oiintSize2: \"M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8\\n-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z\\nm502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2\\nc0 110 84 276 504 276s502.4-166 502.4-276z\",\n  oiiintSize1: \"M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6\\n-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z\\nm525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0\\n85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z\",\n  oiiintSize2: \"M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8\\n-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z\\nm770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1\\nc0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z\",\n  rightarrow: \"M0 241v40h399891c-47.3 35.3-84 78-110 128\\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n 151.7 139 205zm0 0v40h399900v-40z\",\n  rightbrace: \"M400000 542l\\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z\",\n  rightbraceunder: \"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z\",\n  rightgroup: \"M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0\\n 3-1 3-3v-38c-76-158-257-219-435-219H0z\",\n  rightgroupunder: \"M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18\\n 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z\",\n  rightharpoon: \"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3\\n-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2\\n-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58\\n 69.2 92 94.5zm0 0v40h399900v-40z\",\n  rightharpoonplus: \"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11\\n-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7\\n 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z\\nm0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z\",\n  rightharpoondown: \"M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8\\n 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5\\n-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95\\n-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z\",\n  rightharpoondownplus: \"M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8\\n 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3\\n 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3\\n-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z\\nm0-194v40h400000v-40zm0 0v40h400000v-40z\",\n  righthook: \"M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3\\n 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0\\n-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21\\n 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z\",\n  rightlinesegment: \"M399960 241 V94 h40 V428 h-40 V281 H0 v-40z\\nM399960 241 V94 h40 V428 h-40 V281 H0 v-40z\",\n  rightToFrom: \"M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23\\n 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32\\n-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142\\n-167z M100 147v40h399900v-40zM0 341v40h399900v-40z\",\n  // twoheadleftarrow is from glyph U+219E in font KaTeX AMS Regular\n  twoheadleftarrow: \"M0 167c68 40\\n 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69\\n-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3\\n-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19\\n-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101\\n 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z\",\n  twoheadrightarrow: \"M400000 167\\nc-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3\\n 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42\\n 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333\\n-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70\\n 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z\",\n  // tilde1 is a modified version of a glyph from the MnSymbol package\n  tilde1: \"M200 55.538c-77 0-168 73.953-177 73.953-3 0-7\\n-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0\\n 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0\\n 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128\\n-68.267.847-113-73.952-191-73.952z\",\n  // ditto tilde2, tilde3, & tilde4\n  tilde2: \"M344 55.266c-142 0-300.638 81.316-311.5 86.418\\n-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9\\n 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114\\nc1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751\\n 181.476 676 181.476c-149 0-189-126.21-332-126.21z\",\n  tilde3: \"M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457\\n-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0\\n 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697\\n 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696\\n -338 0-409-156.573-744-156.573z\",\n  tilde4: \"M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345\\n-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409\\n 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9\\n 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409\\n -175.236-744-175.236z\",\n  // vec is from glyph U+20D7 in font KaTeX Main\n  vec: \"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\\nc-16-25.333-24-45-24-59z\",\n  // widehat1 is a modified version of a glyph from the MnSymbol package\n  widehat1: \"M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z\",\n  // ditto widehat2, widehat3, & widehat4\n  widehat2: \"M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10\\n-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z\",\n  widehat3: \"M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10\\n-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z\",\n  widehat4: \"M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10\\n-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z\",\n  // widecheck paths are all inverted versions of widehat\n  widecheck1: \"M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,\\n-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z\",\n  widecheck2: \"M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\\n-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z\",\n  widecheck3: \"M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\\n-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z\",\n  widecheck4: \"M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\\n-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z\",\n  // The next ten paths support reaction arrows from the mhchem package.\n  // Arrows for \\ce{<-->} are offset from xAxis by 0.22ex, per mhchem in LaTeX\n  // baraboveleftarrow is mostly from glyph U+2190 in font KaTeX Main\n  baraboveleftarrow: \"M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202\\nc4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5\\nc-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130\\ns-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47\\n121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6\\ns2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11\\nc0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z\\nM100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z\",\n  // rightarrowabovebar is mostly from glyph U+2192, KaTeX Main\n  rightarrowabovebar: \"M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32\\n-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0\\n13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39\\n-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5\\n-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z\",\n  // The short left harpoon has 0.5em (i.e. 500 units) kern on the left end.\n  // Ref from mhchem.sty: \\rlap{\\raisebox{-.22ex}{$\\kern0.5em\n  baraboveshortleftharpoon: \"M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17\\nc2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21\\nc-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40\\nc-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z\\nM0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z\",\n  rightharpoonaboveshortbar: \"M0,241 l0,40c399126,0,399993,0,399993,0\\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\\nM0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z\",\n  shortbaraboveleftharpoon: \"M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,\\n1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,\\n-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z\\nM93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z\",\n  shortrightharpoonabovebar: \"M53,241l0,40c398570,0,399437,0,399437,0\\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\\nM500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z\"\n};\nvar tallDelim = function tallDelim(label, midHeight) {\n  switch (label) {\n    case \"lbrack\":\n      return \"M403 1759 V84 H666 V0 H319 V1759 v\" + midHeight + \" v1759 h347 v-84\\nH403z M403 1759 V0 H319 V1759 v\" + midHeight + \" v1759 h84z\";\n\n    case \"rbrack\":\n      return \"M347 1759 V0 H0 V84 H263 V1759 v\" + midHeight + \" v1759 H0 v84 H347z\\nM347 1759 V0 H263 V1759 v\" + midHeight + \" v1759 h84z\";\n\n    case \"vert\":\n      return \"M145 15 v585 v\" + midHeight + \" v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v\" + -midHeight + \" v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v\" + midHeight + \" v585 h43z\";\n\n    case \"doublevert\":\n      return \"M145 15 v585 v\" + midHeight + \" v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v\" + -midHeight + \" v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v\" + midHeight + \" v585 h43z\\nM367 15 v585 v\" + midHeight + \" v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v\" + -midHeight + \" v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M410 15 H367 v585 v\" + midHeight + \" v585 h43z\";\n\n    case \"lfloor\":\n      return \"M319 602 V0 H403 V602 v\" + midHeight + \" v1715 h263 v84 H319z\\nMM319 602 V0 H403 V602 v\" + midHeight + \" v1715 H319z\";\n\n    case \"rfloor\":\n      return \"M319 602 V0 H403 V602 v\" + midHeight + \" v1799 H0 v-84 H319z\\nMM319 602 V0 H403 V602 v\" + midHeight + \" v1715 H319z\";\n\n    case \"lceil\":\n      return \"M403 1759 V84 H666 V0 H319 V1759 v\" + midHeight + \" v602 h84z\\nM403 1759 V0 H319 V1759 v\" + midHeight + \" v602 h84z\";\n\n    case \"rceil\":\n      return \"M347 1759 V0 H0 V84 H263 V1759 v\" + midHeight + \" v602 h84z\\nM347 1759 V0 h-84 V1759 v\" + midHeight + \" v602 h84z\";\n\n    case \"lparen\":\n      return \"M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\\n-36,557 l0,\" + (midHeight + 84) + \"c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\\nl0,-\" + (midHeight + 92) + \"c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z\";\n\n    case \"rparen\":\n      return \"M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,\" + (midHeight + 9) + \"\\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\\nl0,-\" + (midHeight + 144) + \"c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z\";\n\n    default:\n      // We should not ever get here.\n      throw new Error(\"Unknown stretchy delimiter.\");\n  }\n};\n\n/**\n * This node represents a document fragment, which contains elements, but when\n * placed into the DOM doesn't have any representation itself. It only contains\n * children and doesn't have any DOM node properties.\n */\nclass DocumentFragment {\n  // HtmlDomNode\n  // Never used; needed for satisfying interface.\n  constructor(children) {\n    this.children = void 0;\n    this.classes = void 0;\n    this.height = void 0;\n    this.depth = void 0;\n    this.maxFontSize = void 0;\n    this.style = void 0;\n    this.children = children;\n    this.classes = [];\n    this.height = 0;\n    this.depth = 0;\n    this.maxFontSize = 0;\n    this.style = {};\n  }\n\n  hasClass(className) {\n    return utils.contains(this.classes, className);\n  }\n  /** Convert the fragment into a node. */\n\n\n  toNode() {\n    var frag = document.createDocumentFragment();\n\n    for (var i = 0; i < this.children.length; i++) {\n      frag.appendChild(this.children[i].toNode());\n    }\n\n    return frag;\n  }\n  /** Convert the fragment into HTML markup. */\n\n\n  toMarkup() {\n    var markup = \"\"; // Simply concatenate the markup for the children together.\n\n    for (var i = 0; i < this.children.length; i++) {\n      markup += this.children[i].toMarkup();\n    }\n\n    return markup;\n  }\n  /**\n   * Converts the math node into a string, similar to innerText. Applies to\n   * MathDomNode's only.\n   */\n\n\n  toText() {\n    // To avoid this, we would subclass documentFragment separately for\n    // MathML, but polyfills for subclassing is expensive per PR 1469.\n    // $FlowFixMe: Only works for ChildType = MathDomNode.\n    var toText = child => child.toText();\n\n    return this.children.map(toText).join(\"\");\n  }\n\n}\n\n// This file is GENERATED by buildMetrics.sh. DO NOT MODIFY.\nvar fontMetricsData = {\n  \"AMS-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"65\": [0, 0.68889, 0, 0, 0.72222],\n    \"66\": [0, 0.68889, 0, 0, 0.66667],\n    \"67\": [0, 0.68889, 0, 0, 0.72222],\n    \"68\": [0, 0.68889, 0, 0, 0.72222],\n    \"69\": [0, 0.68889, 0, 0, 0.66667],\n    \"70\": [0, 0.68889, 0, 0, 0.61111],\n    \"71\": [0, 0.68889, 0, 0, 0.77778],\n    \"72\": [0, 0.68889, 0, 0, 0.77778],\n    \"73\": [0, 0.68889, 0, 0, 0.38889],\n    \"74\": [0.16667, 0.68889, 0, 0, 0.5],\n    \"75\": [0, 0.68889, 0, 0, 0.77778],\n    \"76\": [0, 0.68889, 0, 0, 0.66667],\n    \"77\": [0, 0.68889, 0, 0, 0.94445],\n    \"78\": [0, 0.68889, 0, 0, 0.72222],\n    \"79\": [0.16667, 0.68889, 0, 0, 0.77778],\n    \"80\": [0, 0.68889, 0, 0, 0.61111],\n    \"81\": [0.16667, 0.68889, 0, 0, 0.77778],\n    \"82\": [0, 0.68889, 0, 0, 0.72222],\n    \"83\": [0, 0.68889, 0, 0, 0.55556],\n    \"84\": [0, 0.68889, 0, 0, 0.66667],\n    \"85\": [0, 0.68889, 0, 0, 0.72222],\n    \"86\": [0, 0.68889, 0, 0, 0.72222],\n    \"87\": [0, 0.68889, 0, 0, 1.0],\n    \"88\": [0, 0.68889, 0, 0, 0.72222],\n    \"89\": [0, 0.68889, 0, 0, 0.72222],\n    \"90\": [0, 0.68889, 0, 0, 0.66667],\n    \"107\": [0, 0.68889, 0, 0, 0.55556],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"165\": [0, 0.675, 0.025, 0, 0.75],\n    \"174\": [0.15559, 0.69224, 0, 0, 0.94666],\n    \"240\": [0, 0.68889, 0, 0, 0.55556],\n    \"295\": [0, 0.68889, 0, 0, 0.54028],\n    \"710\": [0, 0.825, 0, 0, 2.33334],\n    \"732\": [0, 0.9, 0, 0, 2.33334],\n    \"770\": [0, 0.825, 0, 0, 2.33334],\n    \"771\": [0, 0.9, 0, 0, 2.33334],\n    \"989\": [0.08167, 0.58167, 0, 0, 0.77778],\n    \"1008\": [0, 0.43056, 0.04028, 0, 0.66667],\n    \"8245\": [0, 0.54986, 0, 0, 0.275],\n    \"8463\": [0, 0.68889, 0, 0, 0.54028],\n    \"8487\": [0, 0.68889, 0, 0, 0.72222],\n    \"8498\": [0, 0.68889, 0, 0, 0.55556],\n    \"8502\": [0, 0.68889, 0, 0, 0.66667],\n    \"8503\": [0, 0.68889, 0, 0, 0.44445],\n    \"8504\": [0, 0.68889, 0, 0, 0.66667],\n    \"8513\": [0, 0.68889, 0, 0, 0.63889],\n    \"8592\": [-0.03598, 0.46402, 0, 0, 0.5],\n    \"8594\": [-0.03598, 0.46402, 0, 0, 0.5],\n    \"8602\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8603\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8606\": [0.01354, 0.52239, 0, 0, 1.0],\n    \"8608\": [0.01354, 0.52239, 0, 0, 1.0],\n    \"8610\": [0.01354, 0.52239, 0, 0, 1.11111],\n    \"8611\": [0.01354, 0.52239, 0, 0, 1.11111],\n    \"8619\": [0, 0.54986, 0, 0, 1.0],\n    \"8620\": [0, 0.54986, 0, 0, 1.0],\n    \"8621\": [-0.13313, 0.37788, 0, 0, 1.38889],\n    \"8622\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8624\": [0, 0.69224, 0, 0, 0.5],\n    \"8625\": [0, 0.69224, 0, 0, 0.5],\n    \"8630\": [0, 0.43056, 0, 0, 1.0],\n    \"8631\": [0, 0.43056, 0, 0, 1.0],\n    \"8634\": [0.08198, 0.58198, 0, 0, 0.77778],\n    \"8635\": [0.08198, 0.58198, 0, 0, 0.77778],\n    \"8638\": [0.19444, 0.69224, 0, 0, 0.41667],\n    \"8639\": [0.19444, 0.69224, 0, 0, 0.41667],\n    \"8642\": [0.19444, 0.69224, 0, 0, 0.41667],\n    \"8643\": [0.19444, 0.69224, 0, 0, 0.41667],\n    \"8644\": [0.1808, 0.675, 0, 0, 1.0],\n    \"8646\": [0.1808, 0.675, 0, 0, 1.0],\n    \"8647\": [0.1808, 0.675, 0, 0, 1.0],\n    \"8648\": [0.19444, 0.69224, 0, 0, 0.83334],\n    \"8649\": [0.1808, 0.675, 0, 0, 1.0],\n    \"8650\": [0.19444, 0.69224, 0, 0, 0.83334],\n    \"8651\": [0.01354, 0.52239, 0, 0, 1.0],\n    \"8652\": [0.01354, 0.52239, 0, 0, 1.0],\n    \"8653\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8654\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8655\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8666\": [0.13667, 0.63667, 0, 0, 1.0],\n    \"8667\": [0.13667, 0.63667, 0, 0, 1.0],\n    \"8669\": [-0.13313, 0.37788, 0, 0, 1.0],\n    \"8672\": [-0.064, 0.437, 0, 0, 1.334],\n    \"8674\": [-0.064, 0.437, 0, 0, 1.334],\n    \"8705\": [0, 0.825, 0, 0, 0.5],\n    \"8708\": [0, 0.68889, 0, 0, 0.55556],\n    \"8709\": [0.08167, 0.58167, 0, 0, 0.77778],\n    \"8717\": [0, 0.43056, 0, 0, 0.42917],\n    \"8722\": [-0.03598, 0.46402, 0, 0, 0.5],\n    \"8724\": [0.08198, 0.69224, 0, 0, 0.77778],\n    \"8726\": [0.08167, 0.58167, 0, 0, 0.77778],\n    \"8733\": [0, 0.69224, 0, 0, 0.77778],\n    \"8736\": [0, 0.69224, 0, 0, 0.72222],\n    \"8737\": [0, 0.69224, 0, 0, 0.72222],\n    \"8738\": [0.03517, 0.52239, 0, 0, 0.72222],\n    \"8739\": [0.08167, 0.58167, 0, 0, 0.22222],\n    \"8740\": [0.25142, 0.74111, 0, 0, 0.27778],\n    \"8741\": [0.08167, 0.58167, 0, 0, 0.38889],\n    \"8742\": [0.25142, 0.74111, 0, 0, 0.5],\n    \"8756\": [0, 0.69224, 0, 0, 0.66667],\n    \"8757\": [0, 0.69224, 0, 0, 0.66667],\n    \"8764\": [-0.13313, 0.36687, 0, 0, 0.77778],\n    \"8765\": [-0.13313, 0.37788, 0, 0, 0.77778],\n    \"8769\": [-0.13313, 0.36687, 0, 0, 0.77778],\n    \"8770\": [-0.03625, 0.46375, 0, 0, 0.77778],\n    \"8774\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8776\": [-0.01688, 0.48312, 0, 0, 0.77778],\n    \"8778\": [0.08167, 0.58167, 0, 0, 0.77778],\n    \"8782\": [0.06062, 0.54986, 0, 0, 0.77778],\n    \"8783\": [0.06062, 0.54986, 0, 0, 0.77778],\n    \"8785\": [0.08198, 0.58198, 0, 0, 0.77778],\n    \"8786\": [0.08198, 0.58198, 0, 0, 0.77778],\n    \"8787\": [0.08198, 0.58198, 0, 0, 0.77778],\n    \"8790\": [0, 0.69224, 0, 0, 0.77778],\n    \"8791\": [0.22958, 0.72958, 0, 0, 0.77778],\n    \"8796\": [0.08198, 0.91667, 0, 0, 0.77778],\n    \"8806\": [0.25583, 0.75583, 0, 0, 0.77778],\n    \"8807\": [0.25583, 0.75583, 0, 0, 0.77778],\n    \"8808\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"8809\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"8812\": [0.25583, 0.75583, 0, 0, 0.5],\n    \"8814\": [0.20576, 0.70576, 0, 0, 0.77778],\n    \"8815\": [0.20576, 0.70576, 0, 0, 0.77778],\n    \"8816\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8817\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8818\": [0.22958, 0.72958, 0, 0, 0.77778],\n    \"8819\": [0.22958, 0.72958, 0, 0, 0.77778],\n    \"8822\": [0.1808, 0.675, 0, 0, 0.77778],\n    \"8823\": [0.1808, 0.675, 0, 0, 0.77778],\n    \"8828\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"8829\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"8830\": [0.22958, 0.72958, 0, 0, 0.77778],\n    \"8831\": [0.22958, 0.72958, 0, 0, 0.77778],\n    \"8832\": [0.20576, 0.70576, 0, 0, 0.77778],\n    \"8833\": [0.20576, 0.70576, 0, 0, 0.77778],\n    \"8840\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8841\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8842\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"8843\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"8847\": [0.03517, 0.54986, 0, 0, 0.77778],\n    \"8848\": [0.03517, 0.54986, 0, 0, 0.77778],\n    \"8858\": [0.08198, 0.58198, 0, 0, 0.77778],\n    \"8859\": [0.08198, 0.58198, 0, 0, 0.77778],\n    \"8861\": [0.08198, 0.58198, 0, 0, 0.77778],\n    \"8862\": [0, 0.675, 0, 0, 0.77778],\n    \"8863\": [0, 0.675, 0, 0, 0.77778],\n    \"8864\": [0, 0.675, 0, 0, 0.77778],\n    \"8865\": [0, 0.675, 0, 0, 0.77778],\n    \"8872\": [0, 0.69224, 0, 0, 0.61111],\n    \"8873\": [0, 0.69224, 0, 0, 0.72222],\n    \"8874\": [0, 0.69224, 0, 0, 0.88889],\n    \"8876\": [0, 0.68889, 0, 0, 0.61111],\n    \"8877\": [0, 0.68889, 0, 0, 0.61111],\n    \"8878\": [0, 0.68889, 0, 0, 0.72222],\n    \"8879\": [0, 0.68889, 0, 0, 0.72222],\n    \"8882\": [0.03517, 0.54986, 0, 0, 0.77778],\n    \"8883\": [0.03517, 0.54986, 0, 0, 0.77778],\n    \"8884\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"8885\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"8888\": [0, 0.54986, 0, 0, 1.11111],\n    \"8890\": [0.19444, 0.43056, 0, 0, 0.55556],\n    \"8891\": [0.19444, 0.69224, 0, 0, 0.61111],\n    \"8892\": [0.19444, 0.69224, 0, 0, 0.61111],\n    \"8901\": [0, 0.54986, 0, 0, 0.27778],\n    \"8903\": [0.08167, 0.58167, 0, 0, 0.77778],\n    \"8905\": [0.08167, 0.58167, 0, 0, 0.77778],\n    \"8906\": [0.08167, 0.58167, 0, 0, 0.77778],\n    \"8907\": [0, 0.69224, 0, 0, 0.77778],\n    \"8908\": [0, 0.69224, 0, 0, 0.77778],\n    \"8909\": [-0.03598, 0.46402, 0, 0, 0.77778],\n    \"8910\": [0, 0.54986, 0, 0, 0.76042],\n    \"8911\": [0, 0.54986, 0, 0, 0.76042],\n    \"8912\": [0.03517, 0.54986, 0, 0, 0.77778],\n    \"8913\": [0.03517, 0.54986, 0, 0, 0.77778],\n    \"8914\": [0, 0.54986, 0, 0, 0.66667],\n    \"8915\": [0, 0.54986, 0, 0, 0.66667],\n    \"8916\": [0, 0.69224, 0, 0, 0.66667],\n    \"8918\": [0.0391, 0.5391, 0, 0, 0.77778],\n    \"8919\": [0.0391, 0.5391, 0, 0, 0.77778],\n    \"8920\": [0.03517, 0.54986, 0, 0, 1.33334],\n    \"8921\": [0.03517, 0.54986, 0, 0, 1.33334],\n    \"8922\": [0.38569, 0.88569, 0, 0, 0.77778],\n    \"8923\": [0.38569, 0.88569, 0, 0, 0.77778],\n    \"8926\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"8927\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"8928\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8929\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8934\": [0.23222, 0.74111, 0, 0, 0.77778],\n    \"8935\": [0.23222, 0.74111, 0, 0, 0.77778],\n    \"8936\": [0.23222, 0.74111, 0, 0, 0.77778],\n    \"8937\": [0.23222, 0.74111, 0, 0, 0.77778],\n    \"8938\": [0.20576, 0.70576, 0, 0, 0.77778],\n    \"8939\": [0.20576, 0.70576, 0, 0, 0.77778],\n    \"8940\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8941\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"8994\": [0.19444, 0.69224, 0, 0, 0.77778],\n    \"8995\": [0.19444, 0.69224, 0, 0, 0.77778],\n    \"9416\": [0.15559, 0.69224, 0, 0, 0.90222],\n    \"9484\": [0, 0.69224, 0, 0, 0.5],\n    \"9488\": [0, 0.69224, 0, 0, 0.5],\n    \"9492\": [0, 0.37788, 0, 0, 0.5],\n    \"9496\": [0, 0.37788, 0, 0, 0.5],\n    \"9585\": [0.19444, 0.68889, 0, 0, 0.88889],\n    \"9586\": [0.19444, 0.74111, 0, 0, 0.88889],\n    \"9632\": [0, 0.675, 0, 0, 0.77778],\n    \"9633\": [0, 0.675, 0, 0, 0.77778],\n    \"9650\": [0, 0.54986, 0, 0, 0.72222],\n    \"9651\": [0, 0.54986, 0, 0, 0.72222],\n    \"9654\": [0.03517, 0.54986, 0, 0, 0.77778],\n    \"9660\": [0, 0.54986, 0, 0, 0.72222],\n    \"9661\": [0, 0.54986, 0, 0, 0.72222],\n    \"9664\": [0.03517, 0.54986, 0, 0, 0.77778],\n    \"9674\": [0.11111, 0.69224, 0, 0, 0.66667],\n    \"9733\": [0.19444, 0.69224, 0, 0, 0.94445],\n    \"10003\": [0, 0.69224, 0, 0, 0.83334],\n    \"10016\": [0, 0.69224, 0, 0, 0.83334],\n    \"10731\": [0.11111, 0.69224, 0, 0, 0.66667],\n    \"10846\": [0.19444, 0.75583, 0, 0, 0.61111],\n    \"10877\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"10878\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"10885\": [0.25583, 0.75583, 0, 0, 0.77778],\n    \"10886\": [0.25583, 0.75583, 0, 0, 0.77778],\n    \"10887\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"10888\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"10889\": [0.26167, 0.75726, 0, 0, 0.77778],\n    \"10890\": [0.26167, 0.75726, 0, 0, 0.77778],\n    \"10891\": [0.48256, 0.98256, 0, 0, 0.77778],\n    \"10892\": [0.48256, 0.98256, 0, 0, 0.77778],\n    \"10901\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"10902\": [0.13667, 0.63667, 0, 0, 0.77778],\n    \"10933\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"10934\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"10935\": [0.26167, 0.75726, 0, 0, 0.77778],\n    \"10936\": [0.26167, 0.75726, 0, 0, 0.77778],\n    \"10937\": [0.26167, 0.75726, 0, 0, 0.77778],\n    \"10938\": [0.26167, 0.75726, 0, 0, 0.77778],\n    \"10949\": [0.25583, 0.75583, 0, 0, 0.77778],\n    \"10950\": [0.25583, 0.75583, 0, 0, 0.77778],\n    \"10955\": [0.28481, 0.79383, 0, 0, 0.77778],\n    \"10956\": [0.28481, 0.79383, 0, 0, 0.77778],\n    \"57350\": [0.08167, 0.58167, 0, 0, 0.22222],\n    \"57351\": [0.08167, 0.58167, 0, 0, 0.38889],\n    \"57352\": [0.08167, 0.58167, 0, 0, 0.77778],\n    \"57353\": [0, 0.43056, 0.04028, 0, 0.66667],\n    \"57356\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"57357\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"57358\": [0.41951, 0.91951, 0, 0, 0.77778],\n    \"57359\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"57360\": [0.30274, 0.79383, 0, 0, 0.77778],\n    \"57361\": [0.41951, 0.91951, 0, 0, 0.77778],\n    \"57366\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"57367\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"57368\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"57369\": [0.25142, 0.75726, 0, 0, 0.77778],\n    \"57370\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"57371\": [0.13597, 0.63597, 0, 0, 0.77778]\n  },\n  \"Caligraphic-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"65\": [0, 0.68333, 0, 0.19445, 0.79847],\n    \"66\": [0, 0.68333, 0.03041, 0.13889, 0.65681],\n    \"67\": [0, 0.68333, 0.05834, 0.13889, 0.52653],\n    \"68\": [0, 0.68333, 0.02778, 0.08334, 0.77139],\n    \"69\": [0, 0.68333, 0.08944, 0.11111, 0.52778],\n    \"70\": [0, 0.68333, 0.09931, 0.11111, 0.71875],\n    \"71\": [0.09722, 0.68333, 0.0593, 0.11111, 0.59487],\n    \"72\": [0, 0.68333, 0.00965, 0.11111, 0.84452],\n    \"73\": [0, 0.68333, 0.07382, 0, 0.54452],\n    \"74\": [0.09722, 0.68333, 0.18472, 0.16667, 0.67778],\n    \"75\": [0, 0.68333, 0.01445, 0.05556, 0.76195],\n    \"76\": [0, 0.68333, 0, 0.13889, 0.68972],\n    \"77\": [0, 0.68333, 0, 0.13889, 1.2009],\n    \"78\": [0, 0.68333, 0.14736, 0.08334, 0.82049],\n    \"79\": [0, 0.68333, 0.02778, 0.11111, 0.79611],\n    \"80\": [0, 0.68333, 0.08222, 0.08334, 0.69556],\n    \"81\": [0.09722, 0.68333, 0, 0.11111, 0.81667],\n    \"82\": [0, 0.68333, 0, 0.08334, 0.8475],\n    \"83\": [0, 0.68333, 0.075, 0.13889, 0.60556],\n    \"84\": [0, 0.68333, 0.25417, 0, 0.54464],\n    \"85\": [0, 0.68333, 0.09931, 0.08334, 0.62583],\n    \"86\": [0, 0.68333, 0.08222, 0, 0.61278],\n    \"87\": [0, 0.68333, 0.08222, 0.08334, 0.98778],\n    \"88\": [0, 0.68333, 0.14643, 0.13889, 0.7133],\n    \"89\": [0.09722, 0.68333, 0.08222, 0.08334, 0.66834],\n    \"90\": [0, 0.68333, 0.07944, 0.13889, 0.72473],\n    \"160\": [0, 0, 0, 0, 0.25]\n  },\n  \"Fraktur-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"33\": [0, 0.69141, 0, 0, 0.29574],\n    \"34\": [0, 0.69141, 0, 0, 0.21471],\n    \"38\": [0, 0.69141, 0, 0, 0.73786],\n    \"39\": [0, 0.69141, 0, 0, 0.21201],\n    \"40\": [0.24982, 0.74947, 0, 0, 0.38865],\n    \"41\": [0.24982, 0.74947, 0, 0, 0.38865],\n    \"42\": [0, 0.62119, 0, 0, 0.27764],\n    \"43\": [0.08319, 0.58283, 0, 0, 0.75623],\n    \"44\": [0, 0.10803, 0, 0, 0.27764],\n    \"45\": [0.08319, 0.58283, 0, 0, 0.75623],\n    \"46\": [0, 0.10803, 0, 0, 0.27764],\n    \"47\": [0.24982, 0.74947, 0, 0, 0.50181],\n    \"48\": [0, 0.47534, 0, 0, 0.50181],\n    \"49\": [0, 0.47534, 0, 0, 0.50181],\n    \"50\": [0, 0.47534, 0, 0, 0.50181],\n    \"51\": [0.18906, 0.47534, 0, 0, 0.50181],\n    \"52\": [0.18906, 0.47534, 0, 0, 0.50181],\n    \"53\": [0.18906, 0.47534, 0, 0, 0.50181],\n    \"54\": [0, 0.69141, 0, 0, 0.50181],\n    \"55\": [0.18906, 0.47534, 0, 0, 0.50181],\n    \"56\": [0, 0.69141, 0, 0, 0.50181],\n    \"57\": [0.18906, 0.47534, 0, 0, 0.50181],\n    \"58\": [0, 0.47534, 0, 0, 0.21606],\n    \"59\": [0.12604, 0.47534, 0, 0, 0.21606],\n    \"61\": [-0.13099, 0.36866, 0, 0, 0.75623],\n    \"63\": [0, 0.69141, 0, 0, 0.36245],\n    \"65\": [0, 0.69141, 0, 0, 0.7176],\n    \"66\": [0, 0.69141, 0, 0, 0.88397],\n    \"67\": [0, 0.69141, 0, 0, 0.61254],\n    \"68\": [0, 0.69141, 0, 0, 0.83158],\n    \"69\": [0, 0.69141, 0, 0, 0.66278],\n    \"70\": [0.12604, 0.69141, 0, 0, 0.61119],\n    \"71\": [0, 0.69141, 0, 0, 0.78539],\n    \"72\": [0.06302, 0.69141, 0, 0, 0.7203],\n    \"73\": [0, 0.69141, 0, 0, 0.55448],\n    \"74\": [0.12604, 0.69141, 0, 0, 0.55231],\n    \"75\": [0, 0.69141, 0, 0, 0.66845],\n    \"76\": [0, 0.69141, 0, 0, 0.66602],\n    \"77\": [0, 0.69141, 0, 0, 1.04953],\n    \"78\": [0, 0.69141, 0, 0, 0.83212],\n    \"79\": [0, 0.69141, 0, 0, 0.82699],\n    \"80\": [0.18906, 0.69141, 0, 0, 0.82753],\n    \"81\": [0.03781, 0.69141, 0, 0, 0.82699],\n    \"82\": [0, 0.69141, 0, 0, 0.82807],\n    \"83\": [0, 0.69141, 0, 0, 0.82861],\n    \"84\": [0, 0.69141, 0, 0, 0.66899],\n    \"85\": [0, 0.69141, 0, 0, 0.64576],\n    \"86\": [0, 0.69141, 0, 0, 0.83131],\n    \"87\": [0, 0.69141, 0, 0, 1.04602],\n    \"88\": [0, 0.69141, 0, 0, 0.71922],\n    \"89\": [0.18906, 0.69141, 0, 0, 0.83293],\n    \"90\": [0.12604, 0.69141, 0, 0, 0.60201],\n    \"91\": [0.24982, 0.74947, 0, 0, 0.27764],\n    \"93\": [0.24982, 0.74947, 0, 0, 0.27764],\n    \"94\": [0, 0.69141, 0, 0, 0.49965],\n    \"97\": [0, 0.47534, 0, 0, 0.50046],\n    \"98\": [0, 0.69141, 0, 0, 0.51315],\n    \"99\": [0, 0.47534, 0, 0, 0.38946],\n    \"100\": [0, 0.62119, 0, 0, 0.49857],\n    \"101\": [0, 0.47534, 0, 0, 0.40053],\n    \"102\": [0.18906, 0.69141, 0, 0, 0.32626],\n    \"103\": [0.18906, 0.47534, 0, 0, 0.5037],\n    \"104\": [0.18906, 0.69141, 0, 0, 0.52126],\n    \"105\": [0, 0.69141, 0, 0, 0.27899],\n    \"106\": [0, 0.69141, 0, 0, 0.28088],\n    \"107\": [0, 0.69141, 0, 0, 0.38946],\n    \"108\": [0, 0.69141, 0, 0, 0.27953],\n    \"109\": [0, 0.47534, 0, 0, 0.76676],\n    \"110\": [0, 0.47534, 0, 0, 0.52666],\n    \"111\": [0, 0.47534, 0, 0, 0.48885],\n    \"112\": [0.18906, 0.52396, 0, 0, 0.50046],\n    \"113\": [0.18906, 0.47534, 0, 0, 0.48912],\n    \"114\": [0, 0.47534, 0, 0, 0.38919],\n    \"115\": [0, 0.47534, 0, 0, 0.44266],\n    \"116\": [0, 0.62119, 0, 0, 0.33301],\n    \"117\": [0, 0.47534, 0, 0, 0.5172],\n    \"118\": [0, 0.52396, 0, 0, 0.5118],\n    \"119\": [0, 0.52396, 0, 0, 0.77351],\n    \"120\": [0.18906, 0.47534, 0, 0, 0.38865],\n    \"121\": [0.18906, 0.47534, 0, 0, 0.49884],\n    \"122\": [0.18906, 0.47534, 0, 0, 0.39054],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"8216\": [0, 0.69141, 0, 0, 0.21471],\n    \"8217\": [0, 0.69141, 0, 0, 0.21471],\n    \"58112\": [0, 0.62119, 0, 0, 0.49749],\n    \"58113\": [0, 0.62119, 0, 0, 0.4983],\n    \"58114\": [0.18906, 0.69141, 0, 0, 0.33328],\n    \"58115\": [0.18906, 0.69141, 0, 0, 0.32923],\n    \"58116\": [0.18906, 0.47534, 0, 0, 0.50343],\n    \"58117\": [0, 0.69141, 0, 0, 0.33301],\n    \"58118\": [0, 0.62119, 0, 0, 0.33409],\n    \"58119\": [0, 0.47534, 0, 0, 0.50073]\n  },\n  \"Main-Bold\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"33\": [0, 0.69444, 0, 0, 0.35],\n    \"34\": [0, 0.69444, 0, 0, 0.60278],\n    \"35\": [0.19444, 0.69444, 0, 0, 0.95833],\n    \"36\": [0.05556, 0.75, 0, 0, 0.575],\n    \"37\": [0.05556, 0.75, 0, 0, 0.95833],\n    \"38\": [0, 0.69444, 0, 0, 0.89444],\n    \"39\": [0, 0.69444, 0, 0, 0.31944],\n    \"40\": [0.25, 0.75, 0, 0, 0.44722],\n    \"41\": [0.25, 0.75, 0, 0, 0.44722],\n    \"42\": [0, 0.75, 0, 0, 0.575],\n    \"43\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"44\": [0.19444, 0.15556, 0, 0, 0.31944],\n    \"45\": [0, 0.44444, 0, 0, 0.38333],\n    \"46\": [0, 0.15556, 0, 0, 0.31944],\n    \"47\": [0.25, 0.75, 0, 0, 0.575],\n    \"48\": [0, 0.64444, 0, 0, 0.575],\n    \"49\": [0, 0.64444, 0, 0, 0.575],\n    \"50\": [0, 0.64444, 0, 0, 0.575],\n    \"51\": [0, 0.64444, 0, 0, 0.575],\n    \"52\": [0, 0.64444, 0, 0, 0.575],\n    \"53\": [0, 0.64444, 0, 0, 0.575],\n    \"54\": [0, 0.64444, 0, 0, 0.575],\n    \"55\": [0, 0.64444, 0, 0, 0.575],\n    \"56\": [0, 0.64444, 0, 0, 0.575],\n    \"57\": [0, 0.64444, 0, 0, 0.575],\n    \"58\": [0, 0.44444, 0, 0, 0.31944],\n    \"59\": [0.19444, 0.44444, 0, 0, 0.31944],\n    \"60\": [0.08556, 0.58556, 0, 0, 0.89444],\n    \"61\": [-0.10889, 0.39111, 0, 0, 0.89444],\n    \"62\": [0.08556, 0.58556, 0, 0, 0.89444],\n    \"63\": [0, 0.69444, 0, 0, 0.54305],\n    \"64\": [0, 0.69444, 0, 0, 0.89444],\n    \"65\": [0, 0.68611, 0, 0, 0.86944],\n    \"66\": [0, 0.68611, 0, 0, 0.81805],\n    \"67\": [0, 0.68611, 0, 0, 0.83055],\n    \"68\": [0, 0.68611, 0, 0, 0.88194],\n    \"69\": [0, 0.68611, 0, 0, 0.75555],\n    \"70\": [0, 0.68611, 0, 0, 0.72361],\n    \"71\": [0, 0.68611, 0, 0, 0.90416],\n    \"72\": [0, 0.68611, 0, 0, 0.9],\n    \"73\": [0, 0.68611, 0, 0, 0.43611],\n    \"74\": [0, 0.68611, 0, 0, 0.59444],\n    \"75\": [0, 0.68611, 0, 0, 0.90138],\n    \"76\": [0, 0.68611, 0, 0, 0.69166],\n    \"77\": [0, 0.68611, 0, 0, 1.09166],\n    \"78\": [0, 0.68611, 0, 0, 0.9],\n    \"79\": [0, 0.68611, 0, 0, 0.86388],\n    \"80\": [0, 0.68611, 0, 0, 0.78611],\n    \"81\": [0.19444, 0.68611, 0, 0, 0.86388],\n    \"82\": [0, 0.68611, 0, 0, 0.8625],\n    \"83\": [0, 0.68611, 0, 0, 0.63889],\n    \"84\": [0, 0.68611, 0, 0, 0.8],\n    \"85\": [0, 0.68611, 0, 0, 0.88472],\n    \"86\": [0, 0.68611, 0.01597, 0, 0.86944],\n    \"87\": [0, 0.68611, 0.01597, 0, 1.18888],\n    \"88\": [0, 0.68611, 0, 0, 0.86944],\n    \"89\": [0, 0.68611, 0.02875, 0, 0.86944],\n    \"90\": [0, 0.68611, 0, 0, 0.70277],\n    \"91\": [0.25, 0.75, 0, 0, 0.31944],\n    \"92\": [0.25, 0.75, 0, 0, 0.575],\n    \"93\": [0.25, 0.75, 0, 0, 0.31944],\n    \"94\": [0, 0.69444, 0, 0, 0.575],\n    \"95\": [0.31, 0.13444, 0.03194, 0, 0.575],\n    \"97\": [0, 0.44444, 0, 0, 0.55902],\n    \"98\": [0, 0.69444, 0, 0, 0.63889],\n    \"99\": [0, 0.44444, 0, 0, 0.51111],\n    \"100\": [0, 0.69444, 0, 0, 0.63889],\n    \"101\": [0, 0.44444, 0, 0, 0.52708],\n    \"102\": [0, 0.69444, 0.10903, 0, 0.35139],\n    \"103\": [0.19444, 0.44444, 0.01597, 0, 0.575],\n    \"104\": [0, 0.69444, 0, 0, 0.63889],\n    \"105\": [0, 0.69444, 0, 0, 0.31944],\n    \"106\": [0.19444, 0.69444, 0, 0, 0.35139],\n    \"107\": [0, 0.69444, 0, 0, 0.60694],\n    \"108\": [0, 0.69444, 0, 0, 0.31944],\n    \"109\": [0, 0.44444, 0, 0, 0.95833],\n    \"110\": [0, 0.44444, 0, 0, 0.63889],\n    \"111\": [0, 0.44444, 0, 0, 0.575],\n    \"112\": [0.19444, 0.44444, 0, 0, 0.63889],\n    \"113\": [0.19444, 0.44444, 0, 0, 0.60694],\n    \"114\": [0, 0.44444, 0, 0, 0.47361],\n    \"115\": [0, 0.44444, 0, 0, 0.45361],\n    \"116\": [0, 0.63492, 0, 0, 0.44722],\n    \"117\": [0, 0.44444, 0, 0, 0.63889],\n    \"118\": [0, 0.44444, 0.01597, 0, 0.60694],\n    \"119\": [0, 0.44444, 0.01597, 0, 0.83055],\n    \"120\": [0, 0.44444, 0, 0, 0.60694],\n    \"121\": [0.19444, 0.44444, 0.01597, 0, 0.60694],\n    \"122\": [0, 0.44444, 0, 0, 0.51111],\n    \"123\": [0.25, 0.75, 0, 0, 0.575],\n    \"124\": [0.25, 0.75, 0, 0, 0.31944],\n    \"125\": [0.25, 0.75, 0, 0, 0.575],\n    \"126\": [0.35, 0.34444, 0, 0, 0.575],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"163\": [0, 0.69444, 0, 0, 0.86853],\n    \"168\": [0, 0.69444, 0, 0, 0.575],\n    \"172\": [0, 0.44444, 0, 0, 0.76666],\n    \"176\": [0, 0.69444, 0, 0, 0.86944],\n    \"177\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"184\": [0.17014, 0, 0, 0, 0.51111],\n    \"198\": [0, 0.68611, 0, 0, 1.04166],\n    \"215\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"216\": [0.04861, 0.73472, 0, 0, 0.89444],\n    \"223\": [0, 0.69444, 0, 0, 0.59722],\n    \"230\": [0, 0.44444, 0, 0, 0.83055],\n    \"247\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"248\": [0.09722, 0.54167, 0, 0, 0.575],\n    \"305\": [0, 0.44444, 0, 0, 0.31944],\n    \"338\": [0, 0.68611, 0, 0, 1.16944],\n    \"339\": [0, 0.44444, 0, 0, 0.89444],\n    \"567\": [0.19444, 0.44444, 0, 0, 0.35139],\n    \"710\": [0, 0.69444, 0, 0, 0.575],\n    \"711\": [0, 0.63194, 0, 0, 0.575],\n    \"713\": [0, 0.59611, 0, 0, 0.575],\n    \"714\": [0, 0.69444, 0, 0, 0.575],\n    \"715\": [0, 0.69444, 0, 0, 0.575],\n    \"728\": [0, 0.69444, 0, 0, 0.575],\n    \"729\": [0, 0.69444, 0, 0, 0.31944],\n    \"730\": [0, 0.69444, 0, 0, 0.86944],\n    \"732\": [0, 0.69444, 0, 0, 0.575],\n    \"733\": [0, 0.69444, 0, 0, 0.575],\n    \"915\": [0, 0.68611, 0, 0, 0.69166],\n    \"916\": [0, 0.68611, 0, 0, 0.95833],\n    \"920\": [0, 0.68611, 0, 0, 0.89444],\n    \"923\": [0, 0.68611, 0, 0, 0.80555],\n    \"926\": [0, 0.68611, 0, 0, 0.76666],\n    \"928\": [0, 0.68611, 0, 0, 0.9],\n    \"931\": [0, 0.68611, 0, 0, 0.83055],\n    \"933\": [0, 0.68611, 0, 0, 0.89444],\n    \"934\": [0, 0.68611, 0, 0, 0.83055],\n    \"936\": [0, 0.68611, 0, 0, 0.89444],\n    \"937\": [0, 0.68611, 0, 0, 0.83055],\n    \"8211\": [0, 0.44444, 0.03194, 0, 0.575],\n    \"8212\": [0, 0.44444, 0.03194, 0, 1.14999],\n    \"8216\": [0, 0.69444, 0, 0, 0.31944],\n    \"8217\": [0, 0.69444, 0, 0, 0.31944],\n    \"8220\": [0, 0.69444, 0, 0, 0.60278],\n    \"8221\": [0, 0.69444, 0, 0, 0.60278],\n    \"8224\": [0.19444, 0.69444, 0, 0, 0.51111],\n    \"8225\": [0.19444, 0.69444, 0, 0, 0.51111],\n    \"8242\": [0, 0.55556, 0, 0, 0.34444],\n    \"8407\": [0, 0.72444, 0.15486, 0, 0.575],\n    \"8463\": [0, 0.69444, 0, 0, 0.66759],\n    \"8465\": [0, 0.69444, 0, 0, 0.83055],\n    \"8467\": [0, 0.69444, 0, 0, 0.47361],\n    \"8472\": [0.19444, 0.44444, 0, 0, 0.74027],\n    \"8476\": [0, 0.69444, 0, 0, 0.83055],\n    \"8501\": [0, 0.69444, 0, 0, 0.70277],\n    \"8592\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8593\": [0.19444, 0.69444, 0, 0, 0.575],\n    \"8594\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8595\": [0.19444, 0.69444, 0, 0, 0.575],\n    \"8596\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8597\": [0.25, 0.75, 0, 0, 0.575],\n    \"8598\": [0.19444, 0.69444, 0, 0, 1.14999],\n    \"8599\": [0.19444, 0.69444, 0, 0, 1.14999],\n    \"8600\": [0.19444, 0.69444, 0, 0, 1.14999],\n    \"8601\": [0.19444, 0.69444, 0, 0, 1.14999],\n    \"8636\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8637\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8640\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8641\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8656\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8657\": [0.19444, 0.69444, 0, 0, 0.70277],\n    \"8658\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8659\": [0.19444, 0.69444, 0, 0, 0.70277],\n    \"8660\": [-0.10889, 0.39111, 0, 0, 1.14999],\n    \"8661\": [0.25, 0.75, 0, 0, 0.70277],\n    \"8704\": [0, 0.69444, 0, 0, 0.63889],\n    \"8706\": [0, 0.69444, 0.06389, 0, 0.62847],\n    \"8707\": [0, 0.69444, 0, 0, 0.63889],\n    \"8709\": [0.05556, 0.75, 0, 0, 0.575],\n    \"8711\": [0, 0.68611, 0, 0, 0.95833],\n    \"8712\": [0.08556, 0.58556, 0, 0, 0.76666],\n    \"8715\": [0.08556, 0.58556, 0, 0, 0.76666],\n    \"8722\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"8723\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"8725\": [0.25, 0.75, 0, 0, 0.575],\n    \"8726\": [0.25, 0.75, 0, 0, 0.575],\n    \"8727\": [-0.02778, 0.47222, 0, 0, 0.575],\n    \"8728\": [-0.02639, 0.47361, 0, 0, 0.575],\n    \"8729\": [-0.02639, 0.47361, 0, 0, 0.575],\n    \"8730\": [0.18, 0.82, 0, 0, 0.95833],\n    \"8733\": [0, 0.44444, 0, 0, 0.89444],\n    \"8734\": [0, 0.44444, 0, 0, 1.14999],\n    \"8736\": [0, 0.69224, 0, 0, 0.72222],\n    \"8739\": [0.25, 0.75, 0, 0, 0.31944],\n    \"8741\": [0.25, 0.75, 0, 0, 0.575],\n    \"8743\": [0, 0.55556, 0, 0, 0.76666],\n    \"8744\": [0, 0.55556, 0, 0, 0.76666],\n    \"8745\": [0, 0.55556, 0, 0, 0.76666],\n    \"8746\": [0, 0.55556, 0, 0, 0.76666],\n    \"8747\": [0.19444, 0.69444, 0.12778, 0, 0.56875],\n    \"8764\": [-0.10889, 0.39111, 0, 0, 0.89444],\n    \"8768\": [0.19444, 0.69444, 0, 0, 0.31944],\n    \"8771\": [0.00222, 0.50222, 0, 0, 0.89444],\n    \"8773\": [0.027, 0.638, 0, 0, 0.894],\n    \"8776\": [0.02444, 0.52444, 0, 0, 0.89444],\n    \"8781\": [0.00222, 0.50222, 0, 0, 0.89444],\n    \"8801\": [0.00222, 0.50222, 0, 0, 0.89444],\n    \"8804\": [0.19667, 0.69667, 0, 0, 0.89444],\n    \"8805\": [0.19667, 0.69667, 0, 0, 0.89444],\n    \"8810\": [0.08556, 0.58556, 0, 0, 1.14999],\n    \"8811\": [0.08556, 0.58556, 0, 0, 1.14999],\n    \"8826\": [0.08556, 0.58556, 0, 0, 0.89444],\n    \"8827\": [0.08556, 0.58556, 0, 0, 0.89444],\n    \"8834\": [0.08556, 0.58556, 0, 0, 0.89444],\n    \"8835\": [0.08556, 0.58556, 0, 0, 0.89444],\n    \"8838\": [0.19667, 0.69667, 0, 0, 0.89444],\n    \"8839\": [0.19667, 0.69667, 0, 0, 0.89444],\n    \"8846\": [0, 0.55556, 0, 0, 0.76666],\n    \"8849\": [0.19667, 0.69667, 0, 0, 0.89444],\n    \"8850\": [0.19667, 0.69667, 0, 0, 0.89444],\n    \"8851\": [0, 0.55556, 0, 0, 0.76666],\n    \"8852\": [0, 0.55556, 0, 0, 0.76666],\n    \"8853\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"8854\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"8855\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"8856\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"8857\": [0.13333, 0.63333, 0, 0, 0.89444],\n    \"8866\": [0, 0.69444, 0, 0, 0.70277],\n    \"8867\": [0, 0.69444, 0, 0, 0.70277],\n    \"8868\": [0, 0.69444, 0, 0, 0.89444],\n    \"8869\": [0, 0.69444, 0, 0, 0.89444],\n    \"8900\": [-0.02639, 0.47361, 0, 0, 0.575],\n    \"8901\": [-0.02639, 0.47361, 0, 0, 0.31944],\n    \"8902\": [-0.02778, 0.47222, 0, 0, 0.575],\n    \"8968\": [0.25, 0.75, 0, 0, 0.51111],\n    \"8969\": [0.25, 0.75, 0, 0, 0.51111],\n    \"8970\": [0.25, 0.75, 0, 0, 0.51111],\n    \"8971\": [0.25, 0.75, 0, 0, 0.51111],\n    \"8994\": [-0.13889, 0.36111, 0, 0, 1.14999],\n    \"8995\": [-0.13889, 0.36111, 0, 0, 1.14999],\n    \"9651\": [0.19444, 0.69444, 0, 0, 1.02222],\n    \"9657\": [-0.02778, 0.47222, 0, 0, 0.575],\n    \"9661\": [0.19444, 0.69444, 0, 0, 1.02222],\n    \"9667\": [-0.02778, 0.47222, 0, 0, 0.575],\n    \"9711\": [0.19444, 0.69444, 0, 0, 1.14999],\n    \"9824\": [0.12963, 0.69444, 0, 0, 0.89444],\n    \"9825\": [0.12963, 0.69444, 0, 0, 0.89444],\n    \"9826\": [0.12963, 0.69444, 0, 0, 0.89444],\n    \"9827\": [0.12963, 0.69444, 0, 0, 0.89444],\n    \"9837\": [0, 0.75, 0, 0, 0.44722],\n    \"9838\": [0.19444, 0.69444, 0, 0, 0.44722],\n    \"9839\": [0.19444, 0.69444, 0, 0, 0.44722],\n    \"10216\": [0.25, 0.75, 0, 0, 0.44722],\n    \"10217\": [0.25, 0.75, 0, 0, 0.44722],\n    \"10815\": [0, 0.68611, 0, 0, 0.9],\n    \"10927\": [0.19667, 0.69667, 0, 0, 0.89444],\n    \"10928\": [0.19667, 0.69667, 0, 0, 0.89444],\n    \"57376\": [0.19444, 0.69444, 0, 0, 0]\n  },\n  \"Main-BoldItalic\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"33\": [0, 0.69444, 0.11417, 0, 0.38611],\n    \"34\": [0, 0.69444, 0.07939, 0, 0.62055],\n    \"35\": [0.19444, 0.69444, 0.06833, 0, 0.94444],\n    \"37\": [0.05556, 0.75, 0.12861, 0, 0.94444],\n    \"38\": [0, 0.69444, 0.08528, 0, 0.88555],\n    \"39\": [0, 0.69444, 0.12945, 0, 0.35555],\n    \"40\": [0.25, 0.75, 0.15806, 0, 0.47333],\n    \"41\": [0.25, 0.75, 0.03306, 0, 0.47333],\n    \"42\": [0, 0.75, 0.14333, 0, 0.59111],\n    \"43\": [0.10333, 0.60333, 0.03306, 0, 0.88555],\n    \"44\": [0.19444, 0.14722, 0, 0, 0.35555],\n    \"45\": [0, 0.44444, 0.02611, 0, 0.41444],\n    \"46\": [0, 0.14722, 0, 0, 0.35555],\n    \"47\": [0.25, 0.75, 0.15806, 0, 0.59111],\n    \"48\": [0, 0.64444, 0.13167, 0, 0.59111],\n    \"49\": [0, 0.64444, 0.13167, 0, 0.59111],\n    \"50\": [0, 0.64444, 0.13167, 0, 0.59111],\n    \"51\": [0, 0.64444, 0.13167, 0, 0.59111],\n    \"52\": [0.19444, 0.64444, 0.13167, 0, 0.59111],\n    \"53\": [0, 0.64444, 0.13167, 0, 0.59111],\n    \"54\": [0, 0.64444, 0.13167, 0, 0.59111],\n    \"55\": [0.19444, 0.64444, 0.13167, 0, 0.59111],\n    \"56\": [0, 0.64444, 0.13167, 0, 0.59111],\n    \"57\": [0, 0.64444, 0.13167, 0, 0.59111],\n    \"58\": [0, 0.44444, 0.06695, 0, 0.35555],\n    \"59\": [0.19444, 0.44444, 0.06695, 0, 0.35555],\n    \"61\": [-0.10889, 0.39111, 0.06833, 0, 0.88555],\n    \"63\": [0, 0.69444, 0.11472, 0, 0.59111],\n    \"64\": [0, 0.69444, 0.09208, 0, 0.88555],\n    \"65\": [0, 0.68611, 0, 0, 0.86555],\n    \"66\": [0, 0.68611, 0.0992, 0, 0.81666],\n    \"67\": [0, 0.68611, 0.14208, 0, 0.82666],\n    \"68\": [0, 0.68611, 0.09062, 0, 0.87555],\n    \"69\": [0, 0.68611, 0.11431, 0, 0.75666],\n    \"70\": [0, 0.68611, 0.12903, 0, 0.72722],\n    \"71\": [0, 0.68611, 0.07347, 0, 0.89527],\n    \"72\": [0, 0.68611, 0.17208, 0, 0.8961],\n    \"73\": [0, 0.68611, 0.15681, 0, 0.47166],\n    \"74\": [0, 0.68611, 0.145, 0, 0.61055],\n    \"75\": [0, 0.68611, 0.14208, 0, 0.89499],\n    \"76\": [0, 0.68611, 0, 0, 0.69777],\n    \"77\": [0, 0.68611, 0.17208, 0, 1.07277],\n    \"78\": [0, 0.68611, 0.17208, 0, 0.8961],\n    \"79\": [0, 0.68611, 0.09062, 0, 0.85499],\n    \"80\": [0, 0.68611, 0.0992, 0, 0.78721],\n    \"81\": [0.19444, 0.68611, 0.09062, 0, 0.85499],\n    \"82\": [0, 0.68611, 0.02559, 0, 0.85944],\n    \"83\": [0, 0.68611, 0.11264, 0, 0.64999],\n    \"84\": [0, 0.68611, 0.12903, 0, 0.7961],\n    \"85\": [0, 0.68611, 0.17208, 0, 0.88083],\n    \"86\": [0, 0.68611, 0.18625, 0, 0.86555],\n    \"87\": [0, 0.68611, 0.18625, 0, 1.15999],\n    \"88\": [0, 0.68611, 0.15681, 0, 0.86555],\n    \"89\": [0, 0.68611, 0.19803, 0, 0.86555],\n    \"90\": [0, 0.68611, 0.14208, 0, 0.70888],\n    \"91\": [0.25, 0.75, 0.1875, 0, 0.35611],\n    \"93\": [0.25, 0.75, 0.09972, 0, 0.35611],\n    \"94\": [0, 0.69444, 0.06709, 0, 0.59111],\n    \"95\": [0.31, 0.13444, 0.09811, 0, 0.59111],\n    \"97\": [0, 0.44444, 0.09426, 0, 0.59111],\n    \"98\": [0, 0.69444, 0.07861, 0, 0.53222],\n    \"99\": [0, 0.44444, 0.05222, 0, 0.53222],\n    \"100\": [0, 0.69444, 0.10861, 0, 0.59111],\n    \"101\": [0, 0.44444, 0.085, 0, 0.53222],\n    \"102\": [0.19444, 0.69444, 0.21778, 0, 0.4],\n    \"103\": [0.19444, 0.44444, 0.105, 0, 0.53222],\n    \"104\": [0, 0.69444, 0.09426, 0, 0.59111],\n    \"105\": [0, 0.69326, 0.11387, 0, 0.35555],\n    \"106\": [0.19444, 0.69326, 0.1672, 0, 0.35555],\n    \"107\": [0, 0.69444, 0.11111, 0, 0.53222],\n    \"108\": [0, 0.69444, 0.10861, 0, 0.29666],\n    \"109\": [0, 0.44444, 0.09426, 0, 0.94444],\n    \"110\": [0, 0.44444, 0.09426, 0, 0.64999],\n    \"111\": [0, 0.44444, 0.07861, 0, 0.59111],\n    \"112\": [0.19444, 0.44444, 0.07861, 0, 0.59111],\n    \"113\": [0.19444, 0.44444, 0.105, 0, 0.53222],\n    \"114\": [0, 0.44444, 0.11111, 0, 0.50167],\n    \"115\": [0, 0.44444, 0.08167, 0, 0.48694],\n    \"116\": [0, 0.63492, 0.09639, 0, 0.385],\n    \"117\": [0, 0.44444, 0.09426, 0, 0.62055],\n    \"118\": [0, 0.44444, 0.11111, 0, 0.53222],\n    \"119\": [0, 0.44444, 0.11111, 0, 0.76777],\n    \"120\": [0, 0.44444, 0.12583, 0, 0.56055],\n    \"121\": [0.19444, 0.44444, 0.105, 0, 0.56166],\n    \"122\": [0, 0.44444, 0.13889, 0, 0.49055],\n    \"126\": [0.35, 0.34444, 0.11472, 0, 0.59111],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"168\": [0, 0.69444, 0.11473, 0, 0.59111],\n    \"176\": [0, 0.69444, 0, 0, 0.94888],\n    \"184\": [0.17014, 0, 0, 0, 0.53222],\n    \"198\": [0, 0.68611, 0.11431, 0, 1.02277],\n    \"216\": [0.04861, 0.73472, 0.09062, 0, 0.88555],\n    \"223\": [0.19444, 0.69444, 0.09736, 0, 0.665],\n    \"230\": [0, 0.44444, 0.085, 0, 0.82666],\n    \"248\": [0.09722, 0.54167, 0.09458, 0, 0.59111],\n    \"305\": [0, 0.44444, 0.09426, 0, 0.35555],\n    \"338\": [0, 0.68611, 0.11431, 0, 1.14054],\n    \"339\": [0, 0.44444, 0.085, 0, 0.82666],\n    \"567\": [0.19444, 0.44444, 0.04611, 0, 0.385],\n    \"710\": [0, 0.69444, 0.06709, 0, 0.59111],\n    \"711\": [0, 0.63194, 0.08271, 0, 0.59111],\n    \"713\": [0, 0.59444, 0.10444, 0, 0.59111],\n    \"714\": [0, 0.69444, 0.08528, 0, 0.59111],\n    \"715\": [0, 0.69444, 0, 0, 0.59111],\n    \"728\": [0, 0.69444, 0.10333, 0, 0.59111],\n    \"729\": [0, 0.69444, 0.12945, 0, 0.35555],\n    \"730\": [0, 0.69444, 0, 0, 0.94888],\n    \"732\": [0, 0.69444, 0.11472, 0, 0.59111],\n    \"733\": [0, 0.69444, 0.11472, 0, 0.59111],\n    \"915\": [0, 0.68611, 0.12903, 0, 0.69777],\n    \"916\": [0, 0.68611, 0, 0, 0.94444],\n    \"920\": [0, 0.68611, 0.09062, 0, 0.88555],\n    \"923\": [0, 0.68611, 0, 0, 0.80666],\n    \"926\": [0, 0.68611, 0.15092, 0, 0.76777],\n    \"928\": [0, 0.68611, 0.17208, 0, 0.8961],\n    \"931\": [0, 0.68611, 0.11431, 0, 0.82666],\n    \"933\": [0, 0.68611, 0.10778, 0, 0.88555],\n    \"934\": [0, 0.68611, 0.05632, 0, 0.82666],\n    \"936\": [0, 0.68611, 0.10778, 0, 0.88555],\n    \"937\": [0, 0.68611, 0.0992, 0, 0.82666],\n    \"8211\": [0, 0.44444, 0.09811, 0, 0.59111],\n    \"8212\": [0, 0.44444, 0.09811, 0, 1.18221],\n    \"8216\": [0, 0.69444, 0.12945, 0, 0.35555],\n    \"8217\": [0, 0.69444, 0.12945, 0, 0.35555],\n    \"8220\": [0, 0.69444, 0.16772, 0, 0.62055],\n    \"8221\": [0, 0.69444, 0.07939, 0, 0.62055]\n  },\n  \"Main-Italic\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"33\": [0, 0.69444, 0.12417, 0, 0.30667],\n    \"34\": [0, 0.69444, 0.06961, 0, 0.51444],\n    \"35\": [0.19444, 0.69444, 0.06616, 0, 0.81777],\n    \"37\": [0.05556, 0.75, 0.13639, 0, 0.81777],\n    \"38\": [0, 0.69444, 0.09694, 0, 0.76666],\n    \"39\": [0, 0.69444, 0.12417, 0, 0.30667],\n    \"40\": [0.25, 0.75, 0.16194, 0, 0.40889],\n    \"41\": [0.25, 0.75, 0.03694, 0, 0.40889],\n    \"42\": [0, 0.75, 0.14917, 0, 0.51111],\n    \"43\": [0.05667, 0.56167, 0.03694, 0, 0.76666],\n    \"44\": [0.19444, 0.10556, 0, 0, 0.30667],\n    \"45\": [0, 0.43056, 0.02826, 0, 0.35778],\n    \"46\": [0, 0.10556, 0, 0, 0.30667],\n    \"47\": [0.25, 0.75, 0.16194, 0, 0.51111],\n    \"48\": [0, 0.64444, 0.13556, 0, 0.51111],\n    \"49\": [0, 0.64444, 0.13556, 0, 0.51111],\n    \"50\": [0, 0.64444, 0.13556, 0, 0.51111],\n    \"51\": [0, 0.64444, 0.13556, 0, 0.51111],\n    \"52\": [0.19444, 0.64444, 0.13556, 0, 0.51111],\n    \"53\": [0, 0.64444, 0.13556, 0, 0.51111],\n    \"54\": [0, 0.64444, 0.13556, 0, 0.51111],\n    \"55\": [0.19444, 0.64444, 0.13556, 0, 0.51111],\n    \"56\": [0, 0.64444, 0.13556, 0, 0.51111],\n    \"57\": [0, 0.64444, 0.13556, 0, 0.51111],\n    \"58\": [0, 0.43056, 0.0582, 0, 0.30667],\n    \"59\": [0.19444, 0.43056, 0.0582, 0, 0.30667],\n    \"61\": [-0.13313, 0.36687, 0.06616, 0, 0.76666],\n    \"63\": [0, 0.69444, 0.1225, 0, 0.51111],\n    \"64\": [0, 0.69444, 0.09597, 0, 0.76666],\n    \"65\": [0, 0.68333, 0, 0, 0.74333],\n    \"66\": [0, 0.68333, 0.10257, 0, 0.70389],\n    \"67\": [0, 0.68333, 0.14528, 0, 0.71555],\n    \"68\": [0, 0.68333, 0.09403, 0, 0.755],\n    \"69\": [0, 0.68333, 0.12028, 0, 0.67833],\n    \"70\": [0, 0.68333, 0.13305, 0, 0.65277],\n    \"71\": [0, 0.68333, 0.08722, 0, 0.77361],\n    \"72\": [0, 0.68333, 0.16389, 0, 0.74333],\n    \"73\": [0, 0.68333, 0.15806, 0, 0.38555],\n    \"74\": [0, 0.68333, 0.14028, 0, 0.525],\n    \"75\": [0, 0.68333, 0.14528, 0, 0.76888],\n    \"76\": [0, 0.68333, 0, 0, 0.62722],\n    \"77\": [0, 0.68333, 0.16389, 0, 0.89666],\n    \"78\": [0, 0.68333, 0.16389, 0, 0.74333],\n    \"79\": [0, 0.68333, 0.09403, 0, 0.76666],\n    \"80\": [0, 0.68333, 0.10257, 0, 0.67833],\n    \"81\": [0.19444, 0.68333, 0.09403, 0, 0.76666],\n    \"82\": [0, 0.68333, 0.03868, 0, 0.72944],\n    \"83\": [0, 0.68333, 0.11972, 0, 0.56222],\n    \"84\": [0, 0.68333, 0.13305, 0, 0.71555],\n    \"85\": [0, 0.68333, 0.16389, 0, 0.74333],\n    \"86\": [0, 0.68333, 0.18361, 0, 0.74333],\n    \"87\": [0, 0.68333, 0.18361, 0, 0.99888],\n    \"88\": [0, 0.68333, 0.15806, 0, 0.74333],\n    \"89\": [0, 0.68333, 0.19383, 0, 0.74333],\n    \"90\": [0, 0.68333, 0.14528, 0, 0.61333],\n    \"91\": [0.25, 0.75, 0.1875, 0, 0.30667],\n    \"93\": [0.25, 0.75, 0.10528, 0, 0.30667],\n    \"94\": [0, 0.69444, 0.06646, 0, 0.51111],\n    \"95\": [0.31, 0.12056, 0.09208, 0, 0.51111],\n    \"97\": [0, 0.43056, 0.07671, 0, 0.51111],\n    \"98\": [0, 0.69444, 0.06312, 0, 0.46],\n    \"99\": [0, 0.43056, 0.05653, 0, 0.46],\n    \"100\": [0, 0.69444, 0.10333, 0, 0.51111],\n    \"101\": [0, 0.43056, 0.07514, 0, 0.46],\n    \"102\": [0.19444, 0.69444, 0.21194, 0, 0.30667],\n    \"103\": [0.19444, 0.43056, 0.08847, 0, 0.46],\n    \"104\": [0, 0.69444, 0.07671, 0, 0.51111],\n    \"105\": [0, 0.65536, 0.1019, 0, 0.30667],\n    \"106\": [0.19444, 0.65536, 0.14467, 0, 0.30667],\n    \"107\": [0, 0.69444, 0.10764, 0, 0.46],\n    \"108\": [0, 0.69444, 0.10333, 0, 0.25555],\n    \"109\": [0, 0.43056, 0.07671, 0, 0.81777],\n    \"110\": [0, 0.43056, 0.07671, 0, 0.56222],\n    \"111\": [0, 0.43056, 0.06312, 0, 0.51111],\n    \"112\": [0.19444, 0.43056, 0.06312, 0, 0.51111],\n    \"113\": [0.19444, 0.43056, 0.08847, 0, 0.46],\n    \"114\": [0, 0.43056, 0.10764, 0, 0.42166],\n    \"115\": [0, 0.43056, 0.08208, 0, 0.40889],\n    \"116\": [0, 0.61508, 0.09486, 0, 0.33222],\n    \"117\": [0, 0.43056, 0.07671, 0, 0.53666],\n    \"118\": [0, 0.43056, 0.10764, 0, 0.46],\n    \"119\": [0, 0.43056, 0.10764, 0, 0.66444],\n    \"120\": [0, 0.43056, 0.12042, 0, 0.46389],\n    \"121\": [0.19444, 0.43056, 0.08847, 0, 0.48555],\n    \"122\": [0, 0.43056, 0.12292, 0, 0.40889],\n    \"126\": [0.35, 0.31786, 0.11585, 0, 0.51111],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"168\": [0, 0.66786, 0.10474, 0, 0.51111],\n    \"176\": [0, 0.69444, 0, 0, 0.83129],\n    \"184\": [0.17014, 0, 0, 0, 0.46],\n    \"198\": [0, 0.68333, 0.12028, 0, 0.88277],\n    \"216\": [0.04861, 0.73194, 0.09403, 0, 0.76666],\n    \"223\": [0.19444, 0.69444, 0.10514, 0, 0.53666],\n    \"230\": [0, 0.43056, 0.07514, 0, 0.71555],\n    \"248\": [0.09722, 0.52778, 0.09194, 0, 0.51111],\n    \"338\": [0, 0.68333, 0.12028, 0, 0.98499],\n    \"339\": [0, 0.43056, 0.07514, 0, 0.71555],\n    \"710\": [0, 0.69444, 0.06646, 0, 0.51111],\n    \"711\": [0, 0.62847, 0.08295, 0, 0.51111],\n    \"713\": [0, 0.56167, 0.10333, 0, 0.51111],\n    \"714\": [0, 0.69444, 0.09694, 0, 0.51111],\n    \"715\": [0, 0.69444, 0, 0, 0.51111],\n    \"728\": [0, 0.69444, 0.10806, 0, 0.51111],\n    \"729\": [0, 0.66786, 0.11752, 0, 0.30667],\n    \"730\": [0, 0.69444, 0, 0, 0.83129],\n    \"732\": [0, 0.66786, 0.11585, 0, 0.51111],\n    \"733\": [0, 0.69444, 0.1225, 0, 0.51111],\n    \"915\": [0, 0.68333, 0.13305, 0, 0.62722],\n    \"916\": [0, 0.68333, 0, 0, 0.81777],\n    \"920\": [0, 0.68333, 0.09403, 0, 0.76666],\n    \"923\": [0, 0.68333, 0, 0, 0.69222],\n    \"926\": [0, 0.68333, 0.15294, 0, 0.66444],\n    \"928\": [0, 0.68333, 0.16389, 0, 0.74333],\n    \"931\": [0, 0.68333, 0.12028, 0, 0.71555],\n    \"933\": [0, 0.68333, 0.11111, 0, 0.76666],\n    \"934\": [0, 0.68333, 0.05986, 0, 0.71555],\n    \"936\": [0, 0.68333, 0.11111, 0, 0.76666],\n    \"937\": [0, 0.68333, 0.10257, 0, 0.71555],\n    \"8211\": [0, 0.43056, 0.09208, 0, 0.51111],\n    \"8212\": [0, 0.43056, 0.09208, 0, 1.02222],\n    \"8216\": [0, 0.69444, 0.12417, 0, 0.30667],\n    \"8217\": [0, 0.69444, 0.12417, 0, 0.30667],\n    \"8220\": [0, 0.69444, 0.1685, 0, 0.51444],\n    \"8221\": [0, 0.69444, 0.06961, 0, 0.51444],\n    \"8463\": [0, 0.68889, 0, 0, 0.54028]\n  },\n  \"Main-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"33\": [0, 0.69444, 0, 0, 0.27778],\n    \"34\": [0, 0.69444, 0, 0, 0.5],\n    \"35\": [0.19444, 0.69444, 0, 0, 0.83334],\n    \"36\": [0.05556, 0.75, 0, 0, 0.5],\n    \"37\": [0.05556, 0.75, 0, 0, 0.83334],\n    \"38\": [0, 0.69444, 0, 0, 0.77778],\n    \"39\": [0, 0.69444, 0, 0, 0.27778],\n    \"40\": [0.25, 0.75, 0, 0, 0.38889],\n    \"41\": [0.25, 0.75, 0, 0, 0.38889],\n    \"42\": [0, 0.75, 0, 0, 0.5],\n    \"43\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"44\": [0.19444, 0.10556, 0, 0, 0.27778],\n    \"45\": [0, 0.43056, 0, 0, 0.33333],\n    \"46\": [0, 0.10556, 0, 0, 0.27778],\n    \"47\": [0.25, 0.75, 0, 0, 0.5],\n    \"48\": [0, 0.64444, 0, 0, 0.5],\n    \"49\": [0, 0.64444, 0, 0, 0.5],\n    \"50\": [0, 0.64444, 0, 0, 0.5],\n    \"51\": [0, 0.64444, 0, 0, 0.5],\n    \"52\": [0, 0.64444, 0, 0, 0.5],\n    \"53\": [0, 0.64444, 0, 0, 0.5],\n    \"54\": [0, 0.64444, 0, 0, 0.5],\n    \"55\": [0, 0.64444, 0, 0, 0.5],\n    \"56\": [0, 0.64444, 0, 0, 0.5],\n    \"57\": [0, 0.64444, 0, 0, 0.5],\n    \"58\": [0, 0.43056, 0, 0, 0.27778],\n    \"59\": [0.19444, 0.43056, 0, 0, 0.27778],\n    \"60\": [0.0391, 0.5391, 0, 0, 0.77778],\n    \"61\": [-0.13313, 0.36687, 0, 0, 0.77778],\n    \"62\": [0.0391, 0.5391, 0, 0, 0.77778],\n    \"63\": [0, 0.69444, 0, 0, 0.47222],\n    \"64\": [0, 0.69444, 0, 0, 0.77778],\n    \"65\": [0, 0.68333, 0, 0, 0.75],\n    \"66\": [0, 0.68333, 0, 0, 0.70834],\n    \"67\": [0, 0.68333, 0, 0, 0.72222],\n    \"68\": [0, 0.68333, 0, 0, 0.76389],\n    \"69\": [0, 0.68333, 0, 0, 0.68056],\n    \"70\": [0, 0.68333, 0, 0, 0.65278],\n    \"71\": [0, 0.68333, 0, 0, 0.78472],\n    \"72\": [0, 0.68333, 0, 0, 0.75],\n    \"73\": [0, 0.68333, 0, 0, 0.36111],\n    \"74\": [0, 0.68333, 0, 0, 0.51389],\n    \"75\": [0, 0.68333, 0, 0, 0.77778],\n    \"76\": [0, 0.68333, 0, 0, 0.625],\n    \"77\": [0, 0.68333, 0, 0, 0.91667],\n    \"78\": [0, 0.68333, 0, 0, 0.75],\n    \"79\": [0, 0.68333, 0, 0, 0.77778],\n    \"80\": [0, 0.68333, 0, 0, 0.68056],\n    \"81\": [0.19444, 0.68333, 0, 0, 0.77778],\n    \"82\": [0, 0.68333, 0, 0, 0.73611],\n    \"83\": [0, 0.68333, 0, 0, 0.55556],\n    \"84\": [0, 0.68333, 0, 0, 0.72222],\n    \"85\": [0, 0.68333, 0, 0, 0.75],\n    \"86\": [0, 0.68333, 0.01389, 0, 0.75],\n    \"87\": [0, 0.68333, 0.01389, 0, 1.02778],\n    \"88\": [0, 0.68333, 0, 0, 0.75],\n    \"89\": [0, 0.68333, 0.025, 0, 0.75],\n    \"90\": [0, 0.68333, 0, 0, 0.61111],\n    \"91\": [0.25, 0.75, 0, 0, 0.27778],\n    \"92\": [0.25, 0.75, 0, 0, 0.5],\n    \"93\": [0.25, 0.75, 0, 0, 0.27778],\n    \"94\": [0, 0.69444, 0, 0, 0.5],\n    \"95\": [0.31, 0.12056, 0.02778, 0, 0.5],\n    \"97\": [0, 0.43056, 0, 0, 0.5],\n    \"98\": [0, 0.69444, 0, 0, 0.55556],\n    \"99\": [0, 0.43056, 0, 0, 0.44445],\n    \"100\": [0, 0.69444, 0, 0, 0.55556],\n    \"101\": [0, 0.43056, 0, 0, 0.44445],\n    \"102\": [0, 0.69444, 0.07778, 0, 0.30556],\n    \"103\": [0.19444, 0.43056, 0.01389, 0, 0.5],\n    \"104\": [0, 0.69444, 0, 0, 0.55556],\n    \"105\": [0, 0.66786, 0, 0, 0.27778],\n    \"106\": [0.19444, 0.66786, 0, 0, 0.30556],\n    \"107\": [0, 0.69444, 0, 0, 0.52778],\n    \"108\": [0, 0.69444, 0, 0, 0.27778],\n    \"109\": [0, 0.43056, 0, 0, 0.83334],\n    \"110\": [0, 0.43056, 0, 0, 0.55556],\n    \"111\": [0, 0.43056, 0, 0, 0.5],\n    \"112\": [0.19444, 0.43056, 0, 0, 0.55556],\n    \"113\": [0.19444, 0.43056, 0, 0, 0.52778],\n    \"114\": [0, 0.43056, 0, 0, 0.39167],\n    \"115\": [0, 0.43056, 0, 0, 0.39445],\n    \"116\": [0, 0.61508, 0, 0, 0.38889],\n    \"117\": [0, 0.43056, 0, 0, 0.55556],\n    \"118\": [0, 0.43056, 0.01389, 0, 0.52778],\n    \"119\": [0, 0.43056, 0.01389, 0, 0.72222],\n    \"120\": [0, 0.43056, 0, 0, 0.52778],\n    \"121\": [0.19444, 0.43056, 0.01389, 0, 0.52778],\n    \"122\": [0, 0.43056, 0, 0, 0.44445],\n    \"123\": [0.25, 0.75, 0, 0, 0.5],\n    \"124\": [0.25, 0.75, 0, 0, 0.27778],\n    \"125\": [0.25, 0.75, 0, 0, 0.5],\n    \"126\": [0.35, 0.31786, 0, 0, 0.5],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"163\": [0, 0.69444, 0, 0, 0.76909],\n    \"167\": [0.19444, 0.69444, 0, 0, 0.44445],\n    \"168\": [0, 0.66786, 0, 0, 0.5],\n    \"172\": [0, 0.43056, 0, 0, 0.66667],\n    \"176\": [0, 0.69444, 0, 0, 0.75],\n    \"177\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"182\": [0.19444, 0.69444, 0, 0, 0.61111],\n    \"184\": [0.17014, 0, 0, 0, 0.44445],\n    \"198\": [0, 0.68333, 0, 0, 0.90278],\n    \"215\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"216\": [0.04861, 0.73194, 0, 0, 0.77778],\n    \"223\": [0, 0.69444, 0, 0, 0.5],\n    \"230\": [0, 0.43056, 0, 0, 0.72222],\n    \"247\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"248\": [0.09722, 0.52778, 0, 0, 0.5],\n    \"305\": [0, 0.43056, 0, 0, 0.27778],\n    \"338\": [0, 0.68333, 0, 0, 1.01389],\n    \"339\": [0, 0.43056, 0, 0, 0.77778],\n    \"567\": [0.19444, 0.43056, 0, 0, 0.30556],\n    \"710\": [0, 0.69444, 0, 0, 0.5],\n    \"711\": [0, 0.62847, 0, 0, 0.5],\n    \"713\": [0, 0.56778, 0, 0, 0.5],\n    \"714\": [0, 0.69444, 0, 0, 0.5],\n    \"715\": [0, 0.69444, 0, 0, 0.5],\n    \"728\": [0, 0.69444, 0, 0, 0.5],\n    \"729\": [0, 0.66786, 0, 0, 0.27778],\n    \"730\": [0, 0.69444, 0, 0, 0.75],\n    \"732\": [0, 0.66786, 0, 0, 0.5],\n    \"733\": [0, 0.69444, 0, 0, 0.5],\n    \"915\": [0, 0.68333, 0, 0, 0.625],\n    \"916\": [0, 0.68333, 0, 0, 0.83334],\n    \"920\": [0, 0.68333, 0, 0, 0.77778],\n    \"923\": [0, 0.68333, 0, 0, 0.69445],\n    \"926\": [0, 0.68333, 0, 0, 0.66667],\n    \"928\": [0, 0.68333, 0, 0, 0.75],\n    \"931\": [0, 0.68333, 0, 0, 0.72222],\n    \"933\": [0, 0.68333, 0, 0, 0.77778],\n    \"934\": [0, 0.68333, 0, 0, 0.72222],\n    \"936\": [0, 0.68333, 0, 0, 0.77778],\n    \"937\": [0, 0.68333, 0, 0, 0.72222],\n    \"8211\": [0, 0.43056, 0.02778, 0, 0.5],\n    \"8212\": [0, 0.43056, 0.02778, 0, 1.0],\n    \"8216\": [0, 0.69444, 0, 0, 0.27778],\n    \"8217\": [0, 0.69444, 0, 0, 0.27778],\n    \"8220\": [0, 0.69444, 0, 0, 0.5],\n    \"8221\": [0, 0.69444, 0, 0, 0.5],\n    \"8224\": [0.19444, 0.69444, 0, 0, 0.44445],\n    \"8225\": [0.19444, 0.69444, 0, 0, 0.44445],\n    \"8230\": [0, 0.123, 0, 0, 1.172],\n    \"8242\": [0, 0.55556, 0, 0, 0.275],\n    \"8407\": [0, 0.71444, 0.15382, 0, 0.5],\n    \"8463\": [0, 0.68889, 0, 0, 0.54028],\n    \"8465\": [0, 0.69444, 0, 0, 0.72222],\n    \"8467\": [0, 0.69444, 0, 0.11111, 0.41667],\n    \"8472\": [0.19444, 0.43056, 0, 0.11111, 0.63646],\n    \"8476\": [0, 0.69444, 0, 0, 0.72222],\n    \"8501\": [0, 0.69444, 0, 0, 0.61111],\n    \"8592\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8593\": [0.19444, 0.69444, 0, 0, 0.5],\n    \"8594\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8595\": [0.19444, 0.69444, 0, 0, 0.5],\n    \"8596\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8597\": [0.25, 0.75, 0, 0, 0.5],\n    \"8598\": [0.19444, 0.69444, 0, 0, 1.0],\n    \"8599\": [0.19444, 0.69444, 0, 0, 1.0],\n    \"8600\": [0.19444, 0.69444, 0, 0, 1.0],\n    \"8601\": [0.19444, 0.69444, 0, 0, 1.0],\n    \"8614\": [0.011, 0.511, 0, 0, 1.0],\n    \"8617\": [0.011, 0.511, 0, 0, 1.126],\n    \"8618\": [0.011, 0.511, 0, 0, 1.126],\n    \"8636\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8637\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8640\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8641\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8652\": [0.011, 0.671, 0, 0, 1.0],\n    \"8656\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8657\": [0.19444, 0.69444, 0, 0, 0.61111],\n    \"8658\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8659\": [0.19444, 0.69444, 0, 0, 0.61111],\n    \"8660\": [-0.13313, 0.36687, 0, 0, 1.0],\n    \"8661\": [0.25, 0.75, 0, 0, 0.61111],\n    \"8704\": [0, 0.69444, 0, 0, 0.55556],\n    \"8706\": [0, 0.69444, 0.05556, 0.08334, 0.5309],\n    \"8707\": [0, 0.69444, 0, 0, 0.55556],\n    \"8709\": [0.05556, 0.75, 0, 0, 0.5],\n    \"8711\": [0, 0.68333, 0, 0, 0.83334],\n    \"8712\": [0.0391, 0.5391, 0, 0, 0.66667],\n    \"8715\": [0.0391, 0.5391, 0, 0, 0.66667],\n    \"8722\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"8723\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"8725\": [0.25, 0.75, 0, 0, 0.5],\n    \"8726\": [0.25, 0.75, 0, 0, 0.5],\n    \"8727\": [-0.03472, 0.46528, 0, 0, 0.5],\n    \"8728\": [-0.05555, 0.44445, 0, 0, 0.5],\n    \"8729\": [-0.05555, 0.44445, 0, 0, 0.5],\n    \"8730\": [0.2, 0.8, 0, 0, 0.83334],\n    \"8733\": [0, 0.43056, 0, 0, 0.77778],\n    \"8734\": [0, 0.43056, 0, 0, 1.0],\n    \"8736\": [0, 0.69224, 0, 0, 0.72222],\n    \"8739\": [0.25, 0.75, 0, 0, 0.27778],\n    \"8741\": [0.25, 0.75, 0, 0, 0.5],\n    \"8743\": [0, 0.55556, 0, 0, 0.66667],\n    \"8744\": [0, 0.55556, 0, 0, 0.66667],\n    \"8745\": [0, 0.55556, 0, 0, 0.66667],\n    \"8746\": [0, 0.55556, 0, 0, 0.66667],\n    \"8747\": [0.19444, 0.69444, 0.11111, 0, 0.41667],\n    \"8764\": [-0.13313, 0.36687, 0, 0, 0.77778],\n    \"8768\": [0.19444, 0.69444, 0, 0, 0.27778],\n    \"8771\": [-0.03625, 0.46375, 0, 0, 0.77778],\n    \"8773\": [-0.022, 0.589, 0, 0, 0.778],\n    \"8776\": [-0.01688, 0.48312, 0, 0, 0.77778],\n    \"8781\": [-0.03625, 0.46375, 0, 0, 0.77778],\n    \"8784\": [-0.133, 0.673, 0, 0, 0.778],\n    \"8801\": [-0.03625, 0.46375, 0, 0, 0.77778],\n    \"8804\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"8805\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"8810\": [0.0391, 0.5391, 0, 0, 1.0],\n    \"8811\": [0.0391, 0.5391, 0, 0, 1.0],\n    \"8826\": [0.0391, 0.5391, 0, 0, 0.77778],\n    \"8827\": [0.0391, 0.5391, 0, 0, 0.77778],\n    \"8834\": [0.0391, 0.5391, 0, 0, 0.77778],\n    \"8835\": [0.0391, 0.5391, 0, 0, 0.77778],\n    \"8838\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"8839\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"8846\": [0, 0.55556, 0, 0, 0.66667],\n    \"8849\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"8850\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"8851\": [0, 0.55556, 0, 0, 0.66667],\n    \"8852\": [0, 0.55556, 0, 0, 0.66667],\n    \"8853\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"8854\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"8855\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"8856\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"8857\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"8866\": [0, 0.69444, 0, 0, 0.61111],\n    \"8867\": [0, 0.69444, 0, 0, 0.61111],\n    \"8868\": [0, 0.69444, 0, 0, 0.77778],\n    \"8869\": [0, 0.69444, 0, 0, 0.77778],\n    \"8872\": [0.249, 0.75, 0, 0, 0.867],\n    \"8900\": [-0.05555, 0.44445, 0, 0, 0.5],\n    \"8901\": [-0.05555, 0.44445, 0, 0, 0.27778],\n    \"8902\": [-0.03472, 0.46528, 0, 0, 0.5],\n    \"8904\": [0.005, 0.505, 0, 0, 0.9],\n    \"8942\": [0.03, 0.903, 0, 0, 0.278],\n    \"8943\": [-0.19, 0.313, 0, 0, 1.172],\n    \"8945\": [-0.1, 0.823, 0, 0, 1.282],\n    \"8968\": [0.25, 0.75, 0, 0, 0.44445],\n    \"8969\": [0.25, 0.75, 0, 0, 0.44445],\n    \"8970\": [0.25, 0.75, 0, 0, 0.44445],\n    \"8971\": [0.25, 0.75, 0, 0, 0.44445],\n    \"8994\": [-0.14236, 0.35764, 0, 0, 1.0],\n    \"8995\": [-0.14236, 0.35764, 0, 0, 1.0],\n    \"9136\": [0.244, 0.744, 0, 0, 0.412],\n    \"9137\": [0.244, 0.745, 0, 0, 0.412],\n    \"9651\": [0.19444, 0.69444, 0, 0, 0.88889],\n    \"9657\": [-0.03472, 0.46528, 0, 0, 0.5],\n    \"9661\": [0.19444, 0.69444, 0, 0, 0.88889],\n    \"9667\": [-0.03472, 0.46528, 0, 0, 0.5],\n    \"9711\": [0.19444, 0.69444, 0, 0, 1.0],\n    \"9824\": [0.12963, 0.69444, 0, 0, 0.77778],\n    \"9825\": [0.12963, 0.69444, 0, 0, 0.77778],\n    \"9826\": [0.12963, 0.69444, 0, 0, 0.77778],\n    \"9827\": [0.12963, 0.69444, 0, 0, 0.77778],\n    \"9837\": [0, 0.75, 0, 0, 0.38889],\n    \"9838\": [0.19444, 0.69444, 0, 0, 0.38889],\n    \"9839\": [0.19444, 0.69444, 0, 0, 0.38889],\n    \"10216\": [0.25, 0.75, 0, 0, 0.38889],\n    \"10217\": [0.25, 0.75, 0, 0, 0.38889],\n    \"10222\": [0.244, 0.744, 0, 0, 0.412],\n    \"10223\": [0.244, 0.745, 0, 0, 0.412],\n    \"10229\": [0.011, 0.511, 0, 0, 1.609],\n    \"10230\": [0.011, 0.511, 0, 0, 1.638],\n    \"10231\": [0.011, 0.511, 0, 0, 1.859],\n    \"10232\": [0.024, 0.525, 0, 0, 1.609],\n    \"10233\": [0.024, 0.525, 0, 0, 1.638],\n    \"10234\": [0.024, 0.525, 0, 0, 1.858],\n    \"10236\": [0.011, 0.511, 0, 0, 1.638],\n    \"10815\": [0, 0.68333, 0, 0, 0.75],\n    \"10927\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"10928\": [0.13597, 0.63597, 0, 0, 0.77778],\n    \"57376\": [0.19444, 0.69444, 0, 0, 0]\n  },\n  \"Math-BoldItalic\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"48\": [0, 0.44444, 0, 0, 0.575],\n    \"49\": [0, 0.44444, 0, 0, 0.575],\n    \"50\": [0, 0.44444, 0, 0, 0.575],\n    \"51\": [0.19444, 0.44444, 0, 0, 0.575],\n    \"52\": [0.19444, 0.44444, 0, 0, 0.575],\n    \"53\": [0.19444, 0.44444, 0, 0, 0.575],\n    \"54\": [0, 0.64444, 0, 0, 0.575],\n    \"55\": [0.19444, 0.44444, 0, 0, 0.575],\n    \"56\": [0, 0.64444, 0, 0, 0.575],\n    \"57\": [0.19444, 0.44444, 0, 0, 0.575],\n    \"65\": [0, 0.68611, 0, 0, 0.86944],\n    \"66\": [0, 0.68611, 0.04835, 0, 0.8664],\n    \"67\": [0, 0.68611, 0.06979, 0, 0.81694],\n    \"68\": [0, 0.68611, 0.03194, 0, 0.93812],\n    \"69\": [0, 0.68611, 0.05451, 0, 0.81007],\n    \"70\": [0, 0.68611, 0.15972, 0, 0.68889],\n    \"71\": [0, 0.68611, 0, 0, 0.88673],\n    \"72\": [0, 0.68611, 0.08229, 0, 0.98229],\n    \"73\": [0, 0.68611, 0.07778, 0, 0.51111],\n    \"74\": [0, 0.68611, 0.10069, 0, 0.63125],\n    \"75\": [0, 0.68611, 0.06979, 0, 0.97118],\n    \"76\": [0, 0.68611, 0, 0, 0.75555],\n    \"77\": [0, 0.68611, 0.11424, 0, 1.14201],\n    \"78\": [0, 0.68611, 0.11424, 0, 0.95034],\n    \"79\": [0, 0.68611, 0.03194, 0, 0.83666],\n    \"80\": [0, 0.68611, 0.15972, 0, 0.72309],\n    \"81\": [0.19444, 0.68611, 0, 0, 0.86861],\n    \"82\": [0, 0.68611, 0.00421, 0, 0.87235],\n    \"83\": [0, 0.68611, 0.05382, 0, 0.69271],\n    \"84\": [0, 0.68611, 0.15972, 0, 0.63663],\n    \"85\": [0, 0.68611, 0.11424, 0, 0.80027],\n    \"86\": [0, 0.68611, 0.25555, 0, 0.67778],\n    \"87\": [0, 0.68611, 0.15972, 0, 1.09305],\n    \"88\": [0, 0.68611, 0.07778, 0, 0.94722],\n    \"89\": [0, 0.68611, 0.25555, 0, 0.67458],\n    \"90\": [0, 0.68611, 0.06979, 0, 0.77257],\n    \"97\": [0, 0.44444, 0, 0, 0.63287],\n    \"98\": [0, 0.69444, 0, 0, 0.52083],\n    \"99\": [0, 0.44444, 0, 0, 0.51342],\n    \"100\": [0, 0.69444, 0, 0, 0.60972],\n    \"101\": [0, 0.44444, 0, 0, 0.55361],\n    \"102\": [0.19444, 0.69444, 0.11042, 0, 0.56806],\n    \"103\": [0.19444, 0.44444, 0.03704, 0, 0.5449],\n    \"104\": [0, 0.69444, 0, 0, 0.66759],\n    \"105\": [0, 0.69326, 0, 0, 0.4048],\n    \"106\": [0.19444, 0.69326, 0.0622, 0, 0.47083],\n    \"107\": [0, 0.69444, 0.01852, 0, 0.6037],\n    \"108\": [0, 0.69444, 0.0088, 0, 0.34815],\n    \"109\": [0, 0.44444, 0, 0, 1.0324],\n    \"110\": [0, 0.44444, 0, 0, 0.71296],\n    \"111\": [0, 0.44444, 0, 0, 0.58472],\n    \"112\": [0.19444, 0.44444, 0, 0, 0.60092],\n    \"113\": [0.19444, 0.44444, 0.03704, 0, 0.54213],\n    \"114\": [0, 0.44444, 0.03194, 0, 0.5287],\n    \"115\": [0, 0.44444, 0, 0, 0.53125],\n    \"116\": [0, 0.63492, 0, 0, 0.41528],\n    \"117\": [0, 0.44444, 0, 0, 0.68102],\n    \"118\": [0, 0.44444, 0.03704, 0, 0.56666],\n    \"119\": [0, 0.44444, 0.02778, 0, 0.83148],\n    \"120\": [0, 0.44444, 0, 0, 0.65903],\n    \"121\": [0.19444, 0.44444, 0.03704, 0, 0.59028],\n    \"122\": [0, 0.44444, 0.04213, 0, 0.55509],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"915\": [0, 0.68611, 0.15972, 0, 0.65694],\n    \"916\": [0, 0.68611, 0, 0, 0.95833],\n    \"920\": [0, 0.68611, 0.03194, 0, 0.86722],\n    \"923\": [0, 0.68611, 0, 0, 0.80555],\n    \"926\": [0, 0.68611, 0.07458, 0, 0.84125],\n    \"928\": [0, 0.68611, 0.08229, 0, 0.98229],\n    \"931\": [0, 0.68611, 0.05451, 0, 0.88507],\n    \"933\": [0, 0.68611, 0.15972, 0, 0.67083],\n    \"934\": [0, 0.68611, 0, 0, 0.76666],\n    \"936\": [0, 0.68611, 0.11653, 0, 0.71402],\n    \"937\": [0, 0.68611, 0.04835, 0, 0.8789],\n    \"945\": [0, 0.44444, 0, 0, 0.76064],\n    \"946\": [0.19444, 0.69444, 0.03403, 0, 0.65972],\n    \"947\": [0.19444, 0.44444, 0.06389, 0, 0.59003],\n    \"948\": [0, 0.69444, 0.03819, 0, 0.52222],\n    \"949\": [0, 0.44444, 0, 0, 0.52882],\n    \"950\": [0.19444, 0.69444, 0.06215, 0, 0.50833],\n    \"951\": [0.19444, 0.44444, 0.03704, 0, 0.6],\n    \"952\": [0, 0.69444, 0.03194, 0, 0.5618],\n    \"953\": [0, 0.44444, 0, 0, 0.41204],\n    \"954\": [0, 0.44444, 0, 0, 0.66759],\n    \"955\": [0, 0.69444, 0, 0, 0.67083],\n    \"956\": [0.19444, 0.44444, 0, 0, 0.70787],\n    \"957\": [0, 0.44444, 0.06898, 0, 0.57685],\n    \"958\": [0.19444, 0.69444, 0.03021, 0, 0.50833],\n    \"959\": [0, 0.44444, 0, 0, 0.58472],\n    \"960\": [0, 0.44444, 0.03704, 0, 0.68241],\n    \"961\": [0.19444, 0.44444, 0, 0, 0.6118],\n    \"962\": [0.09722, 0.44444, 0.07917, 0, 0.42361],\n    \"963\": [0, 0.44444, 0.03704, 0, 0.68588],\n    \"964\": [0, 0.44444, 0.13472, 0, 0.52083],\n    \"965\": [0, 0.44444, 0.03704, 0, 0.63055],\n    \"966\": [0.19444, 0.44444, 0, 0, 0.74722],\n    \"967\": [0.19444, 0.44444, 0, 0, 0.71805],\n    \"968\": [0.19444, 0.69444, 0.03704, 0, 0.75833],\n    \"969\": [0, 0.44444, 0.03704, 0, 0.71782],\n    \"977\": [0, 0.69444, 0, 0, 0.69155],\n    \"981\": [0.19444, 0.69444, 0, 0, 0.7125],\n    \"982\": [0, 0.44444, 0.03194, 0, 0.975],\n    \"1009\": [0.19444, 0.44444, 0, 0, 0.6118],\n    \"1013\": [0, 0.44444, 0, 0, 0.48333],\n    \"57649\": [0, 0.44444, 0, 0, 0.39352],\n    \"57911\": [0.19444, 0.44444, 0, 0, 0.43889]\n  },\n  \"Math-Italic\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"48\": [0, 0.43056, 0, 0, 0.5],\n    \"49\": [0, 0.43056, 0, 0, 0.5],\n    \"50\": [0, 0.43056, 0, 0, 0.5],\n    \"51\": [0.19444, 0.43056, 0, 0, 0.5],\n    \"52\": [0.19444, 0.43056, 0, 0, 0.5],\n    \"53\": [0.19444, 0.43056, 0, 0, 0.5],\n    \"54\": [0, 0.64444, 0, 0, 0.5],\n    \"55\": [0.19444, 0.43056, 0, 0, 0.5],\n    \"56\": [0, 0.64444, 0, 0, 0.5],\n    \"57\": [0.19444, 0.43056, 0, 0, 0.5],\n    \"65\": [0, 0.68333, 0, 0.13889, 0.75],\n    \"66\": [0, 0.68333, 0.05017, 0.08334, 0.75851],\n    \"67\": [0, 0.68333, 0.07153, 0.08334, 0.71472],\n    \"68\": [0, 0.68333, 0.02778, 0.05556, 0.82792],\n    \"69\": [0, 0.68333, 0.05764, 0.08334, 0.7382],\n    \"70\": [0, 0.68333, 0.13889, 0.08334, 0.64306],\n    \"71\": [0, 0.68333, 0, 0.08334, 0.78625],\n    \"72\": [0, 0.68333, 0.08125, 0.05556, 0.83125],\n    \"73\": [0, 0.68333, 0.07847, 0.11111, 0.43958],\n    \"74\": [0, 0.68333, 0.09618, 0.16667, 0.55451],\n    \"75\": [0, 0.68333, 0.07153, 0.05556, 0.84931],\n    \"76\": [0, 0.68333, 0, 0.02778, 0.68056],\n    \"77\": [0, 0.68333, 0.10903, 0.08334, 0.97014],\n    \"78\": [0, 0.68333, 0.10903, 0.08334, 0.80347],\n    \"79\": [0, 0.68333, 0.02778, 0.08334, 0.76278],\n    \"80\": [0, 0.68333, 0.13889, 0.08334, 0.64201],\n    \"81\": [0.19444, 0.68333, 0, 0.08334, 0.79056],\n    \"82\": [0, 0.68333, 0.00773, 0.08334, 0.75929],\n    \"83\": [0, 0.68333, 0.05764, 0.08334, 0.6132],\n    \"84\": [0, 0.68333, 0.13889, 0.08334, 0.58438],\n    \"85\": [0, 0.68333, 0.10903, 0.02778, 0.68278],\n    \"86\": [0, 0.68333, 0.22222, 0, 0.58333],\n    \"87\": [0, 0.68333, 0.13889, 0, 0.94445],\n    \"88\": [0, 0.68333, 0.07847, 0.08334, 0.82847],\n    \"89\": [0, 0.68333, 0.22222, 0, 0.58056],\n    \"90\": [0, 0.68333, 0.07153, 0.08334, 0.68264],\n    \"97\": [0, 0.43056, 0, 0, 0.52859],\n    \"98\": [0, 0.69444, 0, 0, 0.42917],\n    \"99\": [0, 0.43056, 0, 0.05556, 0.43276],\n    \"100\": [0, 0.69444, 0, 0.16667, 0.52049],\n    \"101\": [0, 0.43056, 0, 0.05556, 0.46563],\n    \"102\": [0.19444, 0.69444, 0.10764, 0.16667, 0.48959],\n    \"103\": [0.19444, 0.43056, 0.03588, 0.02778, 0.47697],\n    \"104\": [0, 0.69444, 0, 0, 0.57616],\n    \"105\": [0, 0.65952, 0, 0, 0.34451],\n    \"106\": [0.19444, 0.65952, 0.05724, 0, 0.41181],\n    \"107\": [0, 0.69444, 0.03148, 0, 0.5206],\n    \"108\": [0, 0.69444, 0.01968, 0.08334, 0.29838],\n    \"109\": [0, 0.43056, 0, 0, 0.87801],\n    \"110\": [0, 0.43056, 0, 0, 0.60023],\n    \"111\": [0, 0.43056, 0, 0.05556, 0.48472],\n    \"112\": [0.19444, 0.43056, 0, 0.08334, 0.50313],\n    \"113\": [0.19444, 0.43056, 0.03588, 0.08334, 0.44641],\n    \"114\": [0, 0.43056, 0.02778, 0.05556, 0.45116],\n    \"115\": [0, 0.43056, 0, 0.05556, 0.46875],\n    \"116\": [0, 0.61508, 0, 0.08334, 0.36111],\n    \"117\": [0, 0.43056, 0, 0.02778, 0.57246],\n    \"118\": [0, 0.43056, 0.03588, 0.02778, 0.48472],\n    \"119\": [0, 0.43056, 0.02691, 0.08334, 0.71592],\n    \"120\": [0, 0.43056, 0, 0.02778, 0.57153],\n    \"121\": [0.19444, 0.43056, 0.03588, 0.05556, 0.49028],\n    \"122\": [0, 0.43056, 0.04398, 0.05556, 0.46505],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"915\": [0, 0.68333, 0.13889, 0.08334, 0.61528],\n    \"916\": [0, 0.68333, 0, 0.16667, 0.83334],\n    \"920\": [0, 0.68333, 0.02778, 0.08334, 0.76278],\n    \"923\": [0, 0.68333, 0, 0.16667, 0.69445],\n    \"926\": [0, 0.68333, 0.07569, 0.08334, 0.74236],\n    \"928\": [0, 0.68333, 0.08125, 0.05556, 0.83125],\n    \"931\": [0, 0.68333, 0.05764, 0.08334, 0.77986],\n    \"933\": [0, 0.68333, 0.13889, 0.05556, 0.58333],\n    \"934\": [0, 0.68333, 0, 0.08334, 0.66667],\n    \"936\": [0, 0.68333, 0.11, 0.05556, 0.61222],\n    \"937\": [0, 0.68333, 0.05017, 0.08334, 0.7724],\n    \"945\": [0, 0.43056, 0.0037, 0.02778, 0.6397],\n    \"946\": [0.19444, 0.69444, 0.05278, 0.08334, 0.56563],\n    \"947\": [0.19444, 0.43056, 0.05556, 0, 0.51773],\n    \"948\": [0, 0.69444, 0.03785, 0.05556, 0.44444],\n    \"949\": [0, 0.43056, 0, 0.08334, 0.46632],\n    \"950\": [0.19444, 0.69444, 0.07378, 0.08334, 0.4375],\n    \"951\": [0.19444, 0.43056, 0.03588, 0.05556, 0.49653],\n    \"952\": [0, 0.69444, 0.02778, 0.08334, 0.46944],\n    \"953\": [0, 0.43056, 0, 0.05556, 0.35394],\n    \"954\": [0, 0.43056, 0, 0, 0.57616],\n    \"955\": [0, 0.69444, 0, 0, 0.58334],\n    \"956\": [0.19444, 0.43056, 0, 0.02778, 0.60255],\n    \"957\": [0, 0.43056, 0.06366, 0.02778, 0.49398],\n    \"958\": [0.19444, 0.69444, 0.04601, 0.11111, 0.4375],\n    \"959\": [0, 0.43056, 0, 0.05556, 0.48472],\n    \"960\": [0, 0.43056, 0.03588, 0, 0.57003],\n    \"961\": [0.19444, 0.43056, 0, 0.08334, 0.51702],\n    \"962\": [0.09722, 0.43056, 0.07986, 0.08334, 0.36285],\n    \"963\": [0, 0.43056, 0.03588, 0, 0.57141],\n    \"964\": [0, 0.43056, 0.1132, 0.02778, 0.43715],\n    \"965\": [0, 0.43056, 0.03588, 0.02778, 0.54028],\n    \"966\": [0.19444, 0.43056, 0, 0.08334, 0.65417],\n    \"967\": [0.19444, 0.43056, 0, 0.05556, 0.62569],\n    \"968\": [0.19444, 0.69444, 0.03588, 0.11111, 0.65139],\n    \"969\": [0, 0.43056, 0.03588, 0, 0.62245],\n    \"977\": [0, 0.69444, 0, 0.08334, 0.59144],\n    \"981\": [0.19444, 0.69444, 0, 0.08334, 0.59583],\n    \"982\": [0, 0.43056, 0.02778, 0, 0.82813],\n    \"1009\": [0.19444, 0.43056, 0, 0.08334, 0.51702],\n    \"1013\": [0, 0.43056, 0, 0.05556, 0.4059],\n    \"57649\": [0, 0.43056, 0, 0.02778, 0.32246],\n    \"57911\": [0.19444, 0.43056, 0, 0.08334, 0.38403]\n  },\n  \"SansSerif-Bold\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"33\": [0, 0.69444, 0, 0, 0.36667],\n    \"34\": [0, 0.69444, 0, 0, 0.55834],\n    \"35\": [0.19444, 0.69444, 0, 0, 0.91667],\n    \"36\": [0.05556, 0.75, 0, 0, 0.55],\n    \"37\": [0.05556, 0.75, 0, 0, 1.02912],\n    \"38\": [0, 0.69444, 0, 0, 0.83056],\n    \"39\": [0, 0.69444, 0, 0, 0.30556],\n    \"40\": [0.25, 0.75, 0, 0, 0.42778],\n    \"41\": [0.25, 0.75, 0, 0, 0.42778],\n    \"42\": [0, 0.75, 0, 0, 0.55],\n    \"43\": [0.11667, 0.61667, 0, 0, 0.85556],\n    \"44\": [0.10556, 0.13056, 0, 0, 0.30556],\n    \"45\": [0, 0.45833, 0, 0, 0.36667],\n    \"46\": [0, 0.13056, 0, 0, 0.30556],\n    \"47\": [0.25, 0.75, 0, 0, 0.55],\n    \"48\": [0, 0.69444, 0, 0, 0.55],\n    \"49\": [0, 0.69444, 0, 0, 0.55],\n    \"50\": [0, 0.69444, 0, 0, 0.55],\n    \"51\": [0, 0.69444, 0, 0, 0.55],\n    \"52\": [0, 0.69444, 0, 0, 0.55],\n    \"53\": [0, 0.69444, 0, 0, 0.55],\n    \"54\": [0, 0.69444, 0, 0, 0.55],\n    \"55\": [0, 0.69444, 0, 0, 0.55],\n    \"56\": [0, 0.69444, 0, 0, 0.55],\n    \"57\": [0, 0.69444, 0, 0, 0.55],\n    \"58\": [0, 0.45833, 0, 0, 0.30556],\n    \"59\": [0.10556, 0.45833, 0, 0, 0.30556],\n    \"61\": [-0.09375, 0.40625, 0, 0, 0.85556],\n    \"63\": [0, 0.69444, 0, 0, 0.51945],\n    \"64\": [0, 0.69444, 0, 0, 0.73334],\n    \"65\": [0, 0.69444, 0, 0, 0.73334],\n    \"66\": [0, 0.69444, 0, 0, 0.73334],\n    \"67\": [0, 0.69444, 0, 0, 0.70278],\n    \"68\": [0, 0.69444, 0, 0, 0.79445],\n    \"69\": [0, 0.69444, 0, 0, 0.64167],\n    \"70\": [0, 0.69444, 0, 0, 0.61111],\n    \"71\": [0, 0.69444, 0, 0, 0.73334],\n    \"72\": [0, 0.69444, 0, 0, 0.79445],\n    \"73\": [0, 0.69444, 0, 0, 0.33056],\n    \"74\": [0, 0.69444, 0, 0, 0.51945],\n    \"75\": [0, 0.69444, 0, 0, 0.76389],\n    \"76\": [0, 0.69444, 0, 0, 0.58056],\n    \"77\": [0, 0.69444, 0, 0, 0.97778],\n    \"78\": [0, 0.69444, 0, 0, 0.79445],\n    \"79\": [0, 0.69444, 0, 0, 0.79445],\n    \"80\": [0, 0.69444, 0, 0, 0.70278],\n    \"81\": [0.10556, 0.69444, 0, 0, 0.79445],\n    \"82\": [0, 0.69444, 0, 0, 0.70278],\n    \"83\": [0, 0.69444, 0, 0, 0.61111],\n    \"84\": [0, 0.69444, 0, 0, 0.73334],\n    \"85\": [0, 0.69444, 0, 0, 0.76389],\n    \"86\": [0, 0.69444, 0.01528, 0, 0.73334],\n    \"87\": [0, 0.69444, 0.01528, 0, 1.03889],\n    \"88\": [0, 0.69444, 0, 0, 0.73334],\n    \"89\": [0, 0.69444, 0.0275, 0, 0.73334],\n    \"90\": [0, 0.69444, 0, 0, 0.67223],\n    \"91\": [0.25, 0.75, 0, 0, 0.34306],\n    \"93\": [0.25, 0.75, 0, 0, 0.34306],\n    \"94\": [0, 0.69444, 0, 0, 0.55],\n    \"95\": [0.35, 0.10833, 0.03056, 0, 0.55],\n    \"97\": [0, 0.45833, 0, 0, 0.525],\n    \"98\": [0, 0.69444, 0, 0, 0.56111],\n    \"99\": [0, 0.45833, 0, 0, 0.48889],\n    \"100\": [0, 0.69444, 0, 0, 0.56111],\n    \"101\": [0, 0.45833, 0, 0, 0.51111],\n    \"102\": [0, 0.69444, 0.07639, 0, 0.33611],\n    \"103\": [0.19444, 0.45833, 0.01528, 0, 0.55],\n    \"104\": [0, 0.69444, 0, 0, 0.56111],\n    \"105\": [0, 0.69444, 0, 0, 0.25556],\n    \"106\": [0.19444, 0.69444, 0, 0, 0.28611],\n    \"107\": [0, 0.69444, 0, 0, 0.53056],\n    \"108\": [0, 0.69444, 0, 0, 0.25556],\n    \"109\": [0, 0.45833, 0, 0, 0.86667],\n    \"110\": [0, 0.45833, 0, 0, 0.56111],\n    \"111\": [0, 0.45833, 0, 0, 0.55],\n    \"112\": [0.19444, 0.45833, 0, 0, 0.56111],\n    \"113\": [0.19444, 0.45833, 0, 0, 0.56111],\n    \"114\": [0, 0.45833, 0.01528, 0, 0.37222],\n    \"115\": [0, 0.45833, 0, 0, 0.42167],\n    \"116\": [0, 0.58929, 0, 0, 0.40417],\n    \"117\": [0, 0.45833, 0, 0, 0.56111],\n    \"118\": [0, 0.45833, 0.01528, 0, 0.5],\n    \"119\": [0, 0.45833, 0.01528, 0, 0.74445],\n    \"120\": [0, 0.45833, 0, 0, 0.5],\n    \"121\": [0.19444, 0.45833, 0.01528, 0, 0.5],\n    \"122\": [0, 0.45833, 0, 0, 0.47639],\n    \"126\": [0.35, 0.34444, 0, 0, 0.55],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"168\": [0, 0.69444, 0, 0, 0.55],\n    \"176\": [0, 0.69444, 0, 0, 0.73334],\n    \"180\": [0, 0.69444, 0, 0, 0.55],\n    \"184\": [0.17014, 0, 0, 0, 0.48889],\n    \"305\": [0, 0.45833, 0, 0, 0.25556],\n    \"567\": [0.19444, 0.45833, 0, 0, 0.28611],\n    \"710\": [0, 0.69444, 0, 0, 0.55],\n    \"711\": [0, 0.63542, 0, 0, 0.55],\n    \"713\": [0, 0.63778, 0, 0, 0.55],\n    \"728\": [0, 0.69444, 0, 0, 0.55],\n    \"729\": [0, 0.69444, 0, 0, 0.30556],\n    \"730\": [0, 0.69444, 0, 0, 0.73334],\n    \"732\": [0, 0.69444, 0, 0, 0.55],\n    \"733\": [0, 0.69444, 0, 0, 0.55],\n    \"915\": [0, 0.69444, 0, 0, 0.58056],\n    \"916\": [0, 0.69444, 0, 0, 0.91667],\n    \"920\": [0, 0.69444, 0, 0, 0.85556],\n    \"923\": [0, 0.69444, 0, 0, 0.67223],\n    \"926\": [0, 0.69444, 0, 0, 0.73334],\n    \"928\": [0, 0.69444, 0, 0, 0.79445],\n    \"931\": [0, 0.69444, 0, 0, 0.79445],\n    \"933\": [0, 0.69444, 0, 0, 0.85556],\n    \"934\": [0, 0.69444, 0, 0, 0.79445],\n    \"936\": [0, 0.69444, 0, 0, 0.85556],\n    \"937\": [0, 0.69444, 0, 0, 0.79445],\n    \"8211\": [0, 0.45833, 0.03056, 0, 0.55],\n    \"8212\": [0, 0.45833, 0.03056, 0, 1.10001],\n    \"8216\": [0, 0.69444, 0, 0, 0.30556],\n    \"8217\": [0, 0.69444, 0, 0, 0.30556],\n    \"8220\": [0, 0.69444, 0, 0, 0.55834],\n    \"8221\": [0, 0.69444, 0, 0, 0.55834]\n  },\n  \"SansSerif-Italic\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"33\": [0, 0.69444, 0.05733, 0, 0.31945],\n    \"34\": [0, 0.69444, 0.00316, 0, 0.5],\n    \"35\": [0.19444, 0.69444, 0.05087, 0, 0.83334],\n    \"36\": [0.05556, 0.75, 0.11156, 0, 0.5],\n    \"37\": [0.05556, 0.75, 0.03126, 0, 0.83334],\n    \"38\": [0, 0.69444, 0.03058, 0, 0.75834],\n    \"39\": [0, 0.69444, 0.07816, 0, 0.27778],\n    \"40\": [0.25, 0.75, 0.13164, 0, 0.38889],\n    \"41\": [0.25, 0.75, 0.02536, 0, 0.38889],\n    \"42\": [0, 0.75, 0.11775, 0, 0.5],\n    \"43\": [0.08333, 0.58333, 0.02536, 0, 0.77778],\n    \"44\": [0.125, 0.08333, 0, 0, 0.27778],\n    \"45\": [0, 0.44444, 0.01946, 0, 0.33333],\n    \"46\": [0, 0.08333, 0, 0, 0.27778],\n    \"47\": [0.25, 0.75, 0.13164, 0, 0.5],\n    \"48\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"49\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"50\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"51\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"52\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"53\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"54\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"55\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"56\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"57\": [0, 0.65556, 0.11156, 0, 0.5],\n    \"58\": [0, 0.44444, 0.02502, 0, 0.27778],\n    \"59\": [0.125, 0.44444, 0.02502, 0, 0.27778],\n    \"61\": [-0.13, 0.37, 0.05087, 0, 0.77778],\n    \"63\": [0, 0.69444, 0.11809, 0, 0.47222],\n    \"64\": [0, 0.69444, 0.07555, 0, 0.66667],\n    \"65\": [0, 0.69444, 0, 0, 0.66667],\n    \"66\": [0, 0.69444, 0.08293, 0, 0.66667],\n    \"67\": [0, 0.69444, 0.11983, 0, 0.63889],\n    \"68\": [0, 0.69444, 0.07555, 0, 0.72223],\n    \"69\": [0, 0.69444, 0.11983, 0, 0.59722],\n    \"70\": [0, 0.69444, 0.13372, 0, 0.56945],\n    \"71\": [0, 0.69444, 0.11983, 0, 0.66667],\n    \"72\": [0, 0.69444, 0.08094, 0, 0.70834],\n    \"73\": [0, 0.69444, 0.13372, 0, 0.27778],\n    \"74\": [0, 0.69444, 0.08094, 0, 0.47222],\n    \"75\": [0, 0.69444, 0.11983, 0, 0.69445],\n    \"76\": [0, 0.69444, 0, 0, 0.54167],\n    \"77\": [0, 0.69444, 0.08094, 0, 0.875],\n    \"78\": [0, 0.69444, 0.08094, 0, 0.70834],\n    \"79\": [0, 0.69444, 0.07555, 0, 0.73611],\n    \"80\": [0, 0.69444, 0.08293, 0, 0.63889],\n    \"81\": [0.125, 0.69444, 0.07555, 0, 0.73611],\n    \"82\": [0, 0.69444, 0.08293, 0, 0.64584],\n    \"83\": [0, 0.69444, 0.09205, 0, 0.55556],\n    \"84\": [0, 0.69444, 0.13372, 0, 0.68056],\n    \"85\": [0, 0.69444, 0.08094, 0, 0.6875],\n    \"86\": [0, 0.69444, 0.1615, 0, 0.66667],\n    \"87\": [0, 0.69444, 0.1615, 0, 0.94445],\n    \"88\": [0, 0.69444, 0.13372, 0, 0.66667],\n    \"89\": [0, 0.69444, 0.17261, 0, 0.66667],\n    \"90\": [0, 0.69444, 0.11983, 0, 0.61111],\n    \"91\": [0.25, 0.75, 0.15942, 0, 0.28889],\n    \"93\": [0.25, 0.75, 0.08719, 0, 0.28889],\n    \"94\": [0, 0.69444, 0.0799, 0, 0.5],\n    \"95\": [0.35, 0.09444, 0.08616, 0, 0.5],\n    \"97\": [0, 0.44444, 0.00981, 0, 0.48056],\n    \"98\": [0, 0.69444, 0.03057, 0, 0.51667],\n    \"99\": [0, 0.44444, 0.08336, 0, 0.44445],\n    \"100\": [0, 0.69444, 0.09483, 0, 0.51667],\n    \"101\": [0, 0.44444, 0.06778, 0, 0.44445],\n    \"102\": [0, 0.69444, 0.21705, 0, 0.30556],\n    \"103\": [0.19444, 0.44444, 0.10836, 0, 0.5],\n    \"104\": [0, 0.69444, 0.01778, 0, 0.51667],\n    \"105\": [0, 0.67937, 0.09718, 0, 0.23889],\n    \"106\": [0.19444, 0.67937, 0.09162, 0, 0.26667],\n    \"107\": [0, 0.69444, 0.08336, 0, 0.48889],\n    \"108\": [0, 0.69444, 0.09483, 0, 0.23889],\n    \"109\": [0, 0.44444, 0.01778, 0, 0.79445],\n    \"110\": [0, 0.44444, 0.01778, 0, 0.51667],\n    \"111\": [0, 0.44444, 0.06613, 0, 0.5],\n    \"112\": [0.19444, 0.44444, 0.0389, 0, 0.51667],\n    \"113\": [0.19444, 0.44444, 0.04169, 0, 0.51667],\n    \"114\": [0, 0.44444, 0.10836, 0, 0.34167],\n    \"115\": [0, 0.44444, 0.0778, 0, 0.38333],\n    \"116\": [0, 0.57143, 0.07225, 0, 0.36111],\n    \"117\": [0, 0.44444, 0.04169, 0, 0.51667],\n    \"118\": [0, 0.44444, 0.10836, 0, 0.46111],\n    \"119\": [0, 0.44444, 0.10836, 0, 0.68334],\n    \"120\": [0, 0.44444, 0.09169, 0, 0.46111],\n    \"121\": [0.19444, 0.44444, 0.10836, 0, 0.46111],\n    \"122\": [0, 0.44444, 0.08752, 0, 0.43472],\n    \"126\": [0.35, 0.32659, 0.08826, 0, 0.5],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"168\": [0, 0.67937, 0.06385, 0, 0.5],\n    \"176\": [0, 0.69444, 0, 0, 0.73752],\n    \"184\": [0.17014, 0, 0, 0, 0.44445],\n    \"305\": [0, 0.44444, 0.04169, 0, 0.23889],\n    \"567\": [0.19444, 0.44444, 0.04169, 0, 0.26667],\n    \"710\": [0, 0.69444, 0.0799, 0, 0.5],\n    \"711\": [0, 0.63194, 0.08432, 0, 0.5],\n    \"713\": [0, 0.60889, 0.08776, 0, 0.5],\n    \"714\": [0, 0.69444, 0.09205, 0, 0.5],\n    \"715\": [0, 0.69444, 0, 0, 0.5],\n    \"728\": [0, 0.69444, 0.09483, 0, 0.5],\n    \"729\": [0, 0.67937, 0.07774, 0, 0.27778],\n    \"730\": [0, 0.69444, 0, 0, 0.73752],\n    \"732\": [0, 0.67659, 0.08826, 0, 0.5],\n    \"733\": [0, 0.69444, 0.09205, 0, 0.5],\n    \"915\": [0, 0.69444, 0.13372, 0, 0.54167],\n    \"916\": [0, 0.69444, 0, 0, 0.83334],\n    \"920\": [0, 0.69444, 0.07555, 0, 0.77778],\n    \"923\": [0, 0.69444, 0, 0, 0.61111],\n    \"926\": [0, 0.69444, 0.12816, 0, 0.66667],\n    \"928\": [0, 0.69444, 0.08094, 0, 0.70834],\n    \"931\": [0, 0.69444, 0.11983, 0, 0.72222],\n    \"933\": [0, 0.69444, 0.09031, 0, 0.77778],\n    \"934\": [0, 0.69444, 0.04603, 0, 0.72222],\n    \"936\": [0, 0.69444, 0.09031, 0, 0.77778],\n    \"937\": [0, 0.69444, 0.08293, 0, 0.72222],\n    \"8211\": [0, 0.44444, 0.08616, 0, 0.5],\n    \"8212\": [0, 0.44444, 0.08616, 0, 1.0],\n    \"8216\": [0, 0.69444, 0.07816, 0, 0.27778],\n    \"8217\": [0, 0.69444, 0.07816, 0, 0.27778],\n    \"8220\": [0, 0.69444, 0.14205, 0, 0.5],\n    \"8221\": [0, 0.69444, 0.00316, 0, 0.5]\n  },\n  \"SansSerif-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"33\": [0, 0.69444, 0, 0, 0.31945],\n    \"34\": [0, 0.69444, 0, 0, 0.5],\n    \"35\": [0.19444, 0.69444, 0, 0, 0.83334],\n    \"36\": [0.05556, 0.75, 0, 0, 0.5],\n    \"37\": [0.05556, 0.75, 0, 0, 0.83334],\n    \"38\": [0, 0.69444, 0, 0, 0.75834],\n    \"39\": [0, 0.69444, 0, 0, 0.27778],\n    \"40\": [0.25, 0.75, 0, 0, 0.38889],\n    \"41\": [0.25, 0.75, 0, 0, 0.38889],\n    \"42\": [0, 0.75, 0, 0, 0.5],\n    \"43\": [0.08333, 0.58333, 0, 0, 0.77778],\n    \"44\": [0.125, 0.08333, 0, 0, 0.27778],\n    \"45\": [0, 0.44444, 0, 0, 0.33333],\n    \"46\": [0, 0.08333, 0, 0, 0.27778],\n    \"47\": [0.25, 0.75, 0, 0, 0.5],\n    \"48\": [0, 0.65556, 0, 0, 0.5],\n    \"49\": [0, 0.65556, 0, 0, 0.5],\n    \"50\": [0, 0.65556, 0, 0, 0.5],\n    \"51\": [0, 0.65556, 0, 0, 0.5],\n    \"52\": [0, 0.65556, 0, 0, 0.5],\n    \"53\": [0, 0.65556, 0, 0, 0.5],\n    \"54\": [0, 0.65556, 0, 0, 0.5],\n    \"55\": [0, 0.65556, 0, 0, 0.5],\n    \"56\": [0, 0.65556, 0, 0, 0.5],\n    \"57\": [0, 0.65556, 0, 0, 0.5],\n    \"58\": [0, 0.44444, 0, 0, 0.27778],\n    \"59\": [0.125, 0.44444, 0, 0, 0.27778],\n    \"61\": [-0.13, 0.37, 0, 0, 0.77778],\n    \"63\": [0, 0.69444, 0, 0, 0.47222],\n    \"64\": [0, 0.69444, 0, 0, 0.66667],\n    \"65\": [0, 0.69444, 0, 0, 0.66667],\n    \"66\": [0, 0.69444, 0, 0, 0.66667],\n    \"67\": [0, 0.69444, 0, 0, 0.63889],\n    \"68\": [0, 0.69444, 0, 0, 0.72223],\n    \"69\": [0, 0.69444, 0, 0, 0.59722],\n    \"70\": [0, 0.69444, 0, 0, 0.56945],\n    \"71\": [0, 0.69444, 0, 0, 0.66667],\n    \"72\": [0, 0.69444, 0, 0, 0.70834],\n    \"73\": [0, 0.69444, 0, 0, 0.27778],\n    \"74\": [0, 0.69444, 0, 0, 0.47222],\n    \"75\": [0, 0.69444, 0, 0, 0.69445],\n    \"76\": [0, 0.69444, 0, 0, 0.54167],\n    \"77\": [0, 0.69444, 0, 0, 0.875],\n    \"78\": [0, 0.69444, 0, 0, 0.70834],\n    \"79\": [0, 0.69444, 0, 0, 0.73611],\n    \"80\": [0, 0.69444, 0, 0, 0.63889],\n    \"81\": [0.125, 0.69444, 0, 0, 0.73611],\n    \"82\": [0, 0.69444, 0, 0, 0.64584],\n    \"83\": [0, 0.69444, 0, 0, 0.55556],\n    \"84\": [0, 0.69444, 0, 0, 0.68056],\n    \"85\": [0, 0.69444, 0, 0, 0.6875],\n    \"86\": [0, 0.69444, 0.01389, 0, 0.66667],\n    \"87\": [0, 0.69444, 0.01389, 0, 0.94445],\n    \"88\": [0, 0.69444, 0, 0, 0.66667],\n    \"89\": [0, 0.69444, 0.025, 0, 0.66667],\n    \"90\": [0, 0.69444, 0, 0, 0.61111],\n    \"91\": [0.25, 0.75, 0, 0, 0.28889],\n    \"93\": [0.25, 0.75, 0, 0, 0.28889],\n    \"94\": [0, 0.69444, 0, 0, 0.5],\n    \"95\": [0.35, 0.09444, 0.02778, 0, 0.5],\n    \"97\": [0, 0.44444, 0, 0, 0.48056],\n    \"98\": [0, 0.69444, 0, 0, 0.51667],\n    \"99\": [0, 0.44444, 0, 0, 0.44445],\n    \"100\": [0, 0.69444, 0, 0, 0.51667],\n    \"101\": [0, 0.44444, 0, 0, 0.44445],\n    \"102\": [0, 0.69444, 0.06944, 0, 0.30556],\n    \"103\": [0.19444, 0.44444, 0.01389, 0, 0.5],\n    \"104\": [0, 0.69444, 0, 0, 0.51667],\n    \"105\": [0, 0.67937, 0, 0, 0.23889],\n    \"106\": [0.19444, 0.67937, 0, 0, 0.26667],\n    \"107\": [0, 0.69444, 0, 0, 0.48889],\n    \"108\": [0, 0.69444, 0, 0, 0.23889],\n    \"109\": [0, 0.44444, 0, 0, 0.79445],\n    \"110\": [0, 0.44444, 0, 0, 0.51667],\n    \"111\": [0, 0.44444, 0, 0, 0.5],\n    \"112\": [0.19444, 0.44444, 0, 0, 0.51667],\n    \"113\": [0.19444, 0.44444, 0, 0, 0.51667],\n    \"114\": [0, 0.44444, 0.01389, 0, 0.34167],\n    \"115\": [0, 0.44444, 0, 0, 0.38333],\n    \"116\": [0, 0.57143, 0, 0, 0.36111],\n    \"117\": [0, 0.44444, 0, 0, 0.51667],\n    \"118\": [0, 0.44444, 0.01389, 0, 0.46111],\n    \"119\": [0, 0.44444, 0.01389, 0, 0.68334],\n    \"120\": [0, 0.44444, 0, 0, 0.46111],\n    \"121\": [0.19444, 0.44444, 0.01389, 0, 0.46111],\n    \"122\": [0, 0.44444, 0, 0, 0.43472],\n    \"126\": [0.35, 0.32659, 0, 0, 0.5],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"168\": [0, 0.67937, 0, 0, 0.5],\n    \"176\": [0, 0.69444, 0, 0, 0.66667],\n    \"184\": [0.17014, 0, 0, 0, 0.44445],\n    \"305\": [0, 0.44444, 0, 0, 0.23889],\n    \"567\": [0.19444, 0.44444, 0, 0, 0.26667],\n    \"710\": [0, 0.69444, 0, 0, 0.5],\n    \"711\": [0, 0.63194, 0, 0, 0.5],\n    \"713\": [0, 0.60889, 0, 0, 0.5],\n    \"714\": [0, 0.69444, 0, 0, 0.5],\n    \"715\": [0, 0.69444, 0, 0, 0.5],\n    \"728\": [0, 0.69444, 0, 0, 0.5],\n    \"729\": [0, 0.67937, 0, 0, 0.27778],\n    \"730\": [0, 0.69444, 0, 0, 0.66667],\n    \"732\": [0, 0.67659, 0, 0, 0.5],\n    \"733\": [0, 0.69444, 0, 0, 0.5],\n    \"915\": [0, 0.69444, 0, 0, 0.54167],\n    \"916\": [0, 0.69444, 0, 0, 0.83334],\n    \"920\": [0, 0.69444, 0, 0, 0.77778],\n    \"923\": [0, 0.69444, 0, 0, 0.61111],\n    \"926\": [0, 0.69444, 0, 0, 0.66667],\n    \"928\": [0, 0.69444, 0, 0, 0.70834],\n    \"931\": [0, 0.69444, 0, 0, 0.72222],\n    \"933\": [0, 0.69444, 0, 0, 0.77778],\n    \"934\": [0, 0.69444, 0, 0, 0.72222],\n    \"936\": [0, 0.69444, 0, 0, 0.77778],\n    \"937\": [0, 0.69444, 0, 0, 0.72222],\n    \"8211\": [0, 0.44444, 0.02778, 0, 0.5],\n    \"8212\": [0, 0.44444, 0.02778, 0, 1.0],\n    \"8216\": [0, 0.69444, 0, 0, 0.27778],\n    \"8217\": [0, 0.69444, 0, 0, 0.27778],\n    \"8220\": [0, 0.69444, 0, 0, 0.5],\n    \"8221\": [0, 0.69444, 0, 0, 0.5]\n  },\n  \"Script-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"65\": [0, 0.7, 0.22925, 0, 0.80253],\n    \"66\": [0, 0.7, 0.04087, 0, 0.90757],\n    \"67\": [0, 0.7, 0.1689, 0, 0.66619],\n    \"68\": [0, 0.7, 0.09371, 0, 0.77443],\n    \"69\": [0, 0.7, 0.18583, 0, 0.56162],\n    \"70\": [0, 0.7, 0.13634, 0, 0.89544],\n    \"71\": [0, 0.7, 0.17322, 0, 0.60961],\n    \"72\": [0, 0.7, 0.29694, 0, 0.96919],\n    \"73\": [0, 0.7, 0.19189, 0, 0.80907],\n    \"74\": [0.27778, 0.7, 0.19189, 0, 1.05159],\n    \"75\": [0, 0.7, 0.31259, 0, 0.91364],\n    \"76\": [0, 0.7, 0.19189, 0, 0.87373],\n    \"77\": [0, 0.7, 0.15981, 0, 1.08031],\n    \"78\": [0, 0.7, 0.3525, 0, 0.9015],\n    \"79\": [0, 0.7, 0.08078, 0, 0.73787],\n    \"80\": [0, 0.7, 0.08078, 0, 1.01262],\n    \"81\": [0, 0.7, 0.03305, 0, 0.88282],\n    \"82\": [0, 0.7, 0.06259, 0, 0.85],\n    \"83\": [0, 0.7, 0.19189, 0, 0.86767],\n    \"84\": [0, 0.7, 0.29087, 0, 0.74697],\n    \"85\": [0, 0.7, 0.25815, 0, 0.79996],\n    \"86\": [0, 0.7, 0.27523, 0, 0.62204],\n    \"87\": [0, 0.7, 0.27523, 0, 0.80532],\n    \"88\": [0, 0.7, 0.26006, 0, 0.94445],\n    \"89\": [0, 0.7, 0.2939, 0, 0.70961],\n    \"90\": [0, 0.7, 0.24037, 0, 0.8212],\n    \"160\": [0, 0, 0, 0, 0.25]\n  },\n  \"Size1-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"40\": [0.35001, 0.85, 0, 0, 0.45834],\n    \"41\": [0.35001, 0.85, 0, 0, 0.45834],\n    \"47\": [0.35001, 0.85, 0, 0, 0.57778],\n    \"91\": [0.35001, 0.85, 0, 0, 0.41667],\n    \"92\": [0.35001, 0.85, 0, 0, 0.57778],\n    \"93\": [0.35001, 0.85, 0, 0, 0.41667],\n    \"123\": [0.35001, 0.85, 0, 0, 0.58334],\n    \"125\": [0.35001, 0.85, 0, 0, 0.58334],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"710\": [0, 0.72222, 0, 0, 0.55556],\n    \"732\": [0, 0.72222, 0, 0, 0.55556],\n    \"770\": [0, 0.72222, 0, 0, 0.55556],\n    \"771\": [0, 0.72222, 0, 0, 0.55556],\n    \"8214\": [-0.00099, 0.601, 0, 0, 0.77778],\n    \"8593\": [1e-05, 0.6, 0, 0, 0.66667],\n    \"8595\": [1e-05, 0.6, 0, 0, 0.66667],\n    \"8657\": [1e-05, 0.6, 0, 0, 0.77778],\n    \"8659\": [1e-05, 0.6, 0, 0, 0.77778],\n    \"8719\": [0.25001, 0.75, 0, 0, 0.94445],\n    \"8720\": [0.25001, 0.75, 0, 0, 0.94445],\n    \"8721\": [0.25001, 0.75, 0, 0, 1.05556],\n    \"8730\": [0.35001, 0.85, 0, 0, 1.0],\n    \"8739\": [-0.00599, 0.606, 0, 0, 0.33333],\n    \"8741\": [-0.00599, 0.606, 0, 0, 0.55556],\n    \"8747\": [0.30612, 0.805, 0.19445, 0, 0.47222],\n    \"8748\": [0.306, 0.805, 0.19445, 0, 0.47222],\n    \"8749\": [0.306, 0.805, 0.19445, 0, 0.47222],\n    \"8750\": [0.30612, 0.805, 0.19445, 0, 0.47222],\n    \"8896\": [0.25001, 0.75, 0, 0, 0.83334],\n    \"8897\": [0.25001, 0.75, 0, 0, 0.83334],\n    \"8898\": [0.25001, 0.75, 0, 0, 0.83334],\n    \"8899\": [0.25001, 0.75, 0, 0, 0.83334],\n    \"8968\": [0.35001, 0.85, 0, 0, 0.47222],\n    \"8969\": [0.35001, 0.85, 0, 0, 0.47222],\n    \"8970\": [0.35001, 0.85, 0, 0, 0.47222],\n    \"8971\": [0.35001, 0.85, 0, 0, 0.47222],\n    \"9168\": [-0.00099, 0.601, 0, 0, 0.66667],\n    \"10216\": [0.35001, 0.85, 0, 0, 0.47222],\n    \"10217\": [0.35001, 0.85, 0, 0, 0.47222],\n    \"10752\": [0.25001, 0.75, 0, 0, 1.11111],\n    \"10753\": [0.25001, 0.75, 0, 0, 1.11111],\n    \"10754\": [0.25001, 0.75, 0, 0, 1.11111],\n    \"10756\": [0.25001, 0.75, 0, 0, 0.83334],\n    \"10758\": [0.25001, 0.75, 0, 0, 0.83334]\n  },\n  \"Size2-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"40\": [0.65002, 1.15, 0, 0, 0.59722],\n    \"41\": [0.65002, 1.15, 0, 0, 0.59722],\n    \"47\": [0.65002, 1.15, 0, 0, 0.81111],\n    \"91\": [0.65002, 1.15, 0, 0, 0.47222],\n    \"92\": [0.65002, 1.15, 0, 0, 0.81111],\n    \"93\": [0.65002, 1.15, 0, 0, 0.47222],\n    \"123\": [0.65002, 1.15, 0, 0, 0.66667],\n    \"125\": [0.65002, 1.15, 0, 0, 0.66667],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"710\": [0, 0.75, 0, 0, 1.0],\n    \"732\": [0, 0.75, 0, 0, 1.0],\n    \"770\": [0, 0.75, 0, 0, 1.0],\n    \"771\": [0, 0.75, 0, 0, 1.0],\n    \"8719\": [0.55001, 1.05, 0, 0, 1.27778],\n    \"8720\": [0.55001, 1.05, 0, 0, 1.27778],\n    \"8721\": [0.55001, 1.05, 0, 0, 1.44445],\n    \"8730\": [0.65002, 1.15, 0, 0, 1.0],\n    \"8747\": [0.86225, 1.36, 0.44445, 0, 0.55556],\n    \"8748\": [0.862, 1.36, 0.44445, 0, 0.55556],\n    \"8749\": [0.862, 1.36, 0.44445, 0, 0.55556],\n    \"8750\": [0.86225, 1.36, 0.44445, 0, 0.55556],\n    \"8896\": [0.55001, 1.05, 0, 0, 1.11111],\n    \"8897\": [0.55001, 1.05, 0, 0, 1.11111],\n    \"8898\": [0.55001, 1.05, 0, 0, 1.11111],\n    \"8899\": [0.55001, 1.05, 0, 0, 1.11111],\n    \"8968\": [0.65002, 1.15, 0, 0, 0.52778],\n    \"8969\": [0.65002, 1.15, 0, 0, 0.52778],\n    \"8970\": [0.65002, 1.15, 0, 0, 0.52778],\n    \"8971\": [0.65002, 1.15, 0, 0, 0.52778],\n    \"10216\": [0.65002, 1.15, 0, 0, 0.61111],\n    \"10217\": [0.65002, 1.15, 0, 0, 0.61111],\n    \"10752\": [0.55001, 1.05, 0, 0, 1.51112],\n    \"10753\": [0.55001, 1.05, 0, 0, 1.51112],\n    \"10754\": [0.55001, 1.05, 0, 0, 1.51112],\n    \"10756\": [0.55001, 1.05, 0, 0, 1.11111],\n    \"10758\": [0.55001, 1.05, 0, 0, 1.11111]\n  },\n  \"Size3-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"40\": [0.95003, 1.45, 0, 0, 0.73611],\n    \"41\": [0.95003, 1.45, 0, 0, 0.73611],\n    \"47\": [0.95003, 1.45, 0, 0, 1.04445],\n    \"91\": [0.95003, 1.45, 0, 0, 0.52778],\n    \"92\": [0.95003, 1.45, 0, 0, 1.04445],\n    \"93\": [0.95003, 1.45, 0, 0, 0.52778],\n    \"123\": [0.95003, 1.45, 0, 0, 0.75],\n    \"125\": [0.95003, 1.45, 0, 0, 0.75],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"710\": [0, 0.75, 0, 0, 1.44445],\n    \"732\": [0, 0.75, 0, 0, 1.44445],\n    \"770\": [0, 0.75, 0, 0, 1.44445],\n    \"771\": [0, 0.75, 0, 0, 1.44445],\n    \"8730\": [0.95003, 1.45, 0, 0, 1.0],\n    \"8968\": [0.95003, 1.45, 0, 0, 0.58334],\n    \"8969\": [0.95003, 1.45, 0, 0, 0.58334],\n    \"8970\": [0.95003, 1.45, 0, 0, 0.58334],\n    \"8971\": [0.95003, 1.45, 0, 0, 0.58334],\n    \"10216\": [0.95003, 1.45, 0, 0, 0.75],\n    \"10217\": [0.95003, 1.45, 0, 0, 0.75]\n  },\n  \"Size4-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.25],\n    \"40\": [1.25003, 1.75, 0, 0, 0.79167],\n    \"41\": [1.25003, 1.75, 0, 0, 0.79167],\n    \"47\": [1.25003, 1.75, 0, 0, 1.27778],\n    \"91\": [1.25003, 1.75, 0, 0, 0.58334],\n    \"92\": [1.25003, 1.75, 0, 0, 1.27778],\n    \"93\": [1.25003, 1.75, 0, 0, 0.58334],\n    \"123\": [1.25003, 1.75, 0, 0, 0.80556],\n    \"125\": [1.25003, 1.75, 0, 0, 0.80556],\n    \"160\": [0, 0, 0, 0, 0.25],\n    \"710\": [0, 0.825, 0, 0, 1.8889],\n    \"732\": [0, 0.825, 0, 0, 1.8889],\n    \"770\": [0, 0.825, 0, 0, 1.8889],\n    \"771\": [0, 0.825, 0, 0, 1.8889],\n    \"8730\": [1.25003, 1.75, 0, 0, 1.0],\n    \"8968\": [1.25003, 1.75, 0, 0, 0.63889],\n    \"8969\": [1.25003, 1.75, 0, 0, 0.63889],\n    \"8970\": [1.25003, 1.75, 0, 0, 0.63889],\n    \"8971\": [1.25003, 1.75, 0, 0, 0.63889],\n    \"9115\": [0.64502, 1.155, 0, 0, 0.875],\n    \"9116\": [1e-05, 0.6, 0, 0, 0.875],\n    \"9117\": [0.64502, 1.155, 0, 0, 0.875],\n    \"9118\": [0.64502, 1.155, 0, 0, 0.875],\n    \"9119\": [1e-05, 0.6, 0, 0, 0.875],\n    \"9120\": [0.64502, 1.155, 0, 0, 0.875],\n    \"9121\": [0.64502, 1.155, 0, 0, 0.66667],\n    \"9122\": [-0.00099, 0.601, 0, 0, 0.66667],\n    \"9123\": [0.64502, 1.155, 0, 0, 0.66667],\n    \"9124\": [0.64502, 1.155, 0, 0, 0.66667],\n    \"9125\": [-0.00099, 0.601, 0, 0, 0.66667],\n    \"9126\": [0.64502, 1.155, 0, 0, 0.66667],\n    \"9127\": [1e-05, 0.9, 0, 0, 0.88889],\n    \"9128\": [0.65002, 1.15, 0, 0, 0.88889],\n    \"9129\": [0.90001, 0, 0, 0, 0.88889],\n    \"9130\": [0, 0.3, 0, 0, 0.88889],\n    \"9131\": [1e-05, 0.9, 0, 0, 0.88889],\n    \"9132\": [0.65002, 1.15, 0, 0, 0.88889],\n    \"9133\": [0.90001, 0, 0, 0, 0.88889],\n    \"9143\": [0.88502, 0.915, 0, 0, 1.05556],\n    \"10216\": [1.25003, 1.75, 0, 0, 0.80556],\n    \"10217\": [1.25003, 1.75, 0, 0, 0.80556],\n    \"57344\": [-0.00499, 0.605, 0, 0, 1.05556],\n    \"57345\": [-0.00499, 0.605, 0, 0, 1.05556],\n    \"57680\": [0, 0.12, 0, 0, 0.45],\n    \"57681\": [0, 0.12, 0, 0, 0.45],\n    \"57682\": [0, 0.12, 0, 0, 0.45],\n    \"57683\": [0, 0.12, 0, 0, 0.45]\n  },\n  \"Typewriter-Regular\": {\n    \"32\": [0, 0, 0, 0, 0.525],\n    \"33\": [0, 0.61111, 0, 0, 0.525],\n    \"34\": [0, 0.61111, 0, 0, 0.525],\n    \"35\": [0, 0.61111, 0, 0, 0.525],\n    \"36\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"37\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"38\": [0, 0.61111, 0, 0, 0.525],\n    \"39\": [0, 0.61111, 0, 0, 0.525],\n    \"40\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"41\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"42\": [0, 0.52083, 0, 0, 0.525],\n    \"43\": [-0.08056, 0.53055, 0, 0, 0.525],\n    \"44\": [0.13889, 0.125, 0, 0, 0.525],\n    \"45\": [-0.08056, 0.53055, 0, 0, 0.525],\n    \"46\": [0, 0.125, 0, 0, 0.525],\n    \"47\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"48\": [0, 0.61111, 0, 0, 0.525],\n    \"49\": [0, 0.61111, 0, 0, 0.525],\n    \"50\": [0, 0.61111, 0, 0, 0.525],\n    \"51\": [0, 0.61111, 0, 0, 0.525],\n    \"52\": [0, 0.61111, 0, 0, 0.525],\n    \"53\": [0, 0.61111, 0, 0, 0.525],\n    \"54\": [0, 0.61111, 0, 0, 0.525],\n    \"55\": [0, 0.61111, 0, 0, 0.525],\n    \"56\": [0, 0.61111, 0, 0, 0.525],\n    \"57\": [0, 0.61111, 0, 0, 0.525],\n    \"58\": [0, 0.43056, 0, 0, 0.525],\n    \"59\": [0.13889, 0.43056, 0, 0, 0.525],\n    \"60\": [-0.05556, 0.55556, 0, 0, 0.525],\n    \"61\": [-0.19549, 0.41562, 0, 0, 0.525],\n    \"62\": [-0.05556, 0.55556, 0, 0, 0.525],\n    \"63\": [0, 0.61111, 0, 0, 0.525],\n    \"64\": [0, 0.61111, 0, 0, 0.525],\n    \"65\": [0, 0.61111, 0, 0, 0.525],\n    \"66\": [0, 0.61111, 0, 0, 0.525],\n    \"67\": [0, 0.61111, 0, 0, 0.525],\n    \"68\": [0, 0.61111, 0, 0, 0.525],\n    \"69\": [0, 0.61111, 0, 0, 0.525],\n    \"70\": [0, 0.61111, 0, 0, 0.525],\n    \"71\": [0, 0.61111, 0, 0, 0.525],\n    \"72\": [0, 0.61111, 0, 0, 0.525],\n    \"73\": [0, 0.61111, 0, 0, 0.525],\n    \"74\": [0, 0.61111, 0, 0, 0.525],\n    \"75\": [0, 0.61111, 0, 0, 0.525],\n    \"76\": [0, 0.61111, 0, 0, 0.525],\n    \"77\": [0, 0.61111, 0, 0, 0.525],\n    \"78\": [0, 0.61111, 0, 0, 0.525],\n    \"79\": [0, 0.61111, 0, 0, 0.525],\n    \"80\": [0, 0.61111, 0, 0, 0.525],\n    \"81\": [0.13889, 0.61111, 0, 0, 0.525],\n    \"82\": [0, 0.61111, 0, 0, 0.525],\n    \"83\": [0, 0.61111, 0, 0, 0.525],\n    \"84\": [0, 0.61111, 0, 0, 0.525],\n    \"85\": [0, 0.61111, 0, 0, 0.525],\n    \"86\": [0, 0.61111, 0, 0, 0.525],\n    \"87\": [0, 0.61111, 0, 0, 0.525],\n    \"88\": [0, 0.61111, 0, 0, 0.525],\n    \"89\": [0, 0.61111, 0, 0, 0.525],\n    \"90\": [0, 0.61111, 0, 0, 0.525],\n    \"91\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"92\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"93\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"94\": [0, 0.61111, 0, 0, 0.525],\n    \"95\": [0.09514, 0, 0, 0, 0.525],\n    \"96\": [0, 0.61111, 0, 0, 0.525],\n    \"97\": [0, 0.43056, 0, 0, 0.525],\n    \"98\": [0, 0.61111, 0, 0, 0.525],\n    \"99\": [0, 0.43056, 0, 0, 0.525],\n    \"100\": [0, 0.61111, 0, 0, 0.525],\n    \"101\": [0, 0.43056, 0, 0, 0.525],\n    \"102\": [0, 0.61111, 0, 0, 0.525],\n    \"103\": [0.22222, 0.43056, 0, 0, 0.525],\n    \"104\": [0, 0.61111, 0, 0, 0.525],\n    \"105\": [0, 0.61111, 0, 0, 0.525],\n    \"106\": [0.22222, 0.61111, 0, 0, 0.525],\n    \"107\": [0, 0.61111, 0, 0, 0.525],\n    \"108\": [0, 0.61111, 0, 0, 0.525],\n    \"109\": [0, 0.43056, 0, 0, 0.525],\n    \"110\": [0, 0.43056, 0, 0, 0.525],\n    \"111\": [0, 0.43056, 0, 0, 0.525],\n    \"112\": [0.22222, 0.43056, 0, 0, 0.525],\n    \"113\": [0.22222, 0.43056, 0, 0, 0.525],\n    \"114\": [0, 0.43056, 0, 0, 0.525],\n    \"115\": [0, 0.43056, 0, 0, 0.525],\n    \"116\": [0, 0.55358, 0, 0, 0.525],\n    \"117\": [0, 0.43056, 0, 0, 0.525],\n    \"118\": [0, 0.43056, 0, 0, 0.525],\n    \"119\": [0, 0.43056, 0, 0, 0.525],\n    \"120\": [0, 0.43056, 0, 0, 0.525],\n    \"121\": [0.22222, 0.43056, 0, 0, 0.525],\n    \"122\": [0, 0.43056, 0, 0, 0.525],\n    \"123\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"124\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"125\": [0.08333, 0.69444, 0, 0, 0.525],\n    \"126\": [0, 0.61111, 0, 0, 0.525],\n    \"127\": [0, 0.61111, 0, 0, 0.525],\n    \"160\": [0, 0, 0, 0, 0.525],\n    \"176\": [0, 0.61111, 0, 0, 0.525],\n    \"184\": [0.19445, 0, 0, 0, 0.525],\n    \"305\": [0, 0.43056, 0, 0, 0.525],\n    \"567\": [0.22222, 0.43056, 0, 0, 0.525],\n    \"711\": [0, 0.56597, 0, 0, 0.525],\n    \"713\": [0, 0.56555, 0, 0, 0.525],\n    \"714\": [0, 0.61111, 0, 0, 0.525],\n    \"715\": [0, 0.61111, 0, 0, 0.525],\n    \"728\": [0, 0.61111, 0, 0, 0.525],\n    \"730\": [0, 0.61111, 0, 0, 0.525],\n    \"770\": [0, 0.61111, 0, 0, 0.525],\n    \"771\": [0, 0.61111, 0, 0, 0.525],\n    \"776\": [0, 0.61111, 0, 0, 0.525],\n    \"915\": [0, 0.61111, 0, 0, 0.525],\n    \"916\": [0, 0.61111, 0, 0, 0.525],\n    \"920\": [0, 0.61111, 0, 0, 0.525],\n    \"923\": [0, 0.61111, 0, 0, 0.525],\n    \"926\": [0, 0.61111, 0, 0, 0.525],\n    \"928\": [0, 0.61111, 0, 0, 0.525],\n    \"931\": [0, 0.61111, 0, 0, 0.525],\n    \"933\": [0, 0.61111, 0, 0, 0.525],\n    \"934\": [0, 0.61111, 0, 0, 0.525],\n    \"936\": [0, 0.61111, 0, 0, 0.525],\n    \"937\": [0, 0.61111, 0, 0, 0.525],\n    \"8216\": [0, 0.61111, 0, 0, 0.525],\n    \"8217\": [0, 0.61111, 0, 0, 0.525],\n    \"8242\": [0, 0.61111, 0, 0, 0.525],\n    \"9251\": [0.11111, 0.21944, 0, 0, 0.525]\n  }\n};\n\n/**\n * This file contains metrics regarding fonts and individual symbols. The sigma\n * and xi variables, as well as the metricMap map contain data extracted from\n * TeX, TeX font metrics, and the TTF files. These data are then exposed via the\n * `metrics` variable and the getCharacterMetrics function.\n */\n// In TeX, there are actually three sets of dimensions, one for each of\n// textstyle (size index 5 and higher: >=9pt), scriptstyle (size index 3 and 4:\n// 7-8pt), and scriptscriptstyle (size index 1 and 2: 5-6pt).  These are\n// provided in the arrays below, in that order.\n//\n// The font metrics are stored in fonts cmsy10, cmsy7, and cmsy5 respectively.\n// This was determined by running the following script:\n//\n//     latex -interaction=nonstopmode \\\n//     '\\documentclass{article}\\usepackage{amsmath}\\begin{document}' \\\n//     '$a$ \\expandafter\\show\\the\\textfont2' \\\n//     '\\expandafter\\show\\the\\scriptfont2' \\\n//     '\\expandafter\\show\\the\\scriptscriptfont2' \\\n//     '\\stop'\n//\n// The metrics themselves were retrieved using the following commands:\n//\n//     tftopl cmsy10\n//     tftopl cmsy7\n//     tftopl cmsy5\n//\n// The output of each of these commands is quite lengthy.  The only part we\n// care about is the FONTDIMEN section. Each value is measured in EMs.\nvar sigmasAndXis = {\n  slant: [0.250, 0.250, 0.250],\n  // sigma1\n  space: [0.000, 0.000, 0.000],\n  // sigma2\n  stretch: [0.000, 0.000, 0.000],\n  // sigma3\n  shrink: [0.000, 0.000, 0.000],\n  // sigma4\n  xHeight: [0.431, 0.431, 0.431],\n  // sigma5\n  quad: [1.000, 1.171, 1.472],\n  // sigma6\n  extraSpace: [0.000, 0.000, 0.000],\n  // sigma7\n  num1: [0.677, 0.732, 0.925],\n  // sigma8\n  num2: [0.394, 0.384, 0.387],\n  // sigma9\n  num3: [0.444, 0.471, 0.504],\n  // sigma10\n  denom1: [0.686, 0.752, 1.025],\n  // sigma11\n  denom2: [0.345, 0.344, 0.532],\n  // sigma12\n  sup1: [0.413, 0.503, 0.504],\n  // sigma13\n  sup2: [0.363, 0.431, 0.404],\n  // sigma14\n  sup3: [0.289, 0.286, 0.294],\n  // sigma15\n  sub1: [0.150, 0.143, 0.200],\n  // sigma16\n  sub2: [0.247, 0.286, 0.400],\n  // sigma17\n  supDrop: [0.386, 0.353, 0.494],\n  // sigma18\n  subDrop: [0.050, 0.071, 0.100],\n  // sigma19\n  delim1: [2.390, 1.700, 1.980],\n  // sigma20\n  delim2: [1.010, 1.157, 1.420],\n  // sigma21\n  axisHeight: [0.250, 0.250, 0.250],\n  // sigma22\n  // These font metrics are extracted from TeX by using tftopl on cmex10.tfm;\n  // they correspond to the font parameters of the extension fonts (family 3).\n  // See the TeXbook, page 441. In AMSTeX, the extension fonts scale; to\n  // match cmex7, we'd use cmex7.tfm values for script and scriptscript\n  // values.\n  defaultRuleThickness: [0.04, 0.049, 0.049],\n  // xi8; cmex7: 0.049\n  bigOpSpacing1: [0.111, 0.111, 0.111],\n  // xi9\n  bigOpSpacing2: [0.166, 0.166, 0.166],\n  // xi10\n  bigOpSpacing3: [0.2, 0.2, 0.2],\n  // xi11\n  bigOpSpacing4: [0.6, 0.611, 0.611],\n  // xi12; cmex7: 0.611\n  bigOpSpacing5: [0.1, 0.143, 0.143],\n  // xi13; cmex7: 0.143\n  // The \\sqrt rule width is taken from the height of the surd character.\n  // Since we use the same font at all sizes, this thickness doesn't scale.\n  sqrtRuleThickness: [0.04, 0.04, 0.04],\n  // This value determines how large a pt is, for metrics which are defined\n  // in terms of pts.\n  // This value is also used in katex.scss; if you change it make sure the\n  // values match.\n  ptPerEm: [10.0, 10.0, 10.0],\n  // The space between adjacent `|` columns in an array definition. From\n  // `\\showthe\\doublerulesep` in LaTeX. Equals 2.0 / ptPerEm.\n  doubleRuleSep: [0.2, 0.2, 0.2],\n  // The width of separator lines in {array} environments. From\n  // `\\showthe\\arrayrulewidth` in LaTeX. Equals 0.4 / ptPerEm.\n  arrayRuleWidth: [0.04, 0.04, 0.04],\n  // Two values from LaTeX source2e:\n  fboxsep: [0.3, 0.3, 0.3],\n  //        3 pt / ptPerEm\n  fboxrule: [0.04, 0.04, 0.04] // 0.4 pt / ptPerEm\n\n}; // This map contains a mapping from font name and character code to character\n// should have Latin-1 and Cyrillic characters, but may not depending on the\n// operating system.  The metrics do not account for extra height from the\n// accents.  In the case of Cyrillic characters which have both ascenders and\n// descenders we prefer approximations with ascenders, primarily to prevent\n// the fraction bar or root line from intersecting the glyph.\n// TODO(kevinb) allow union of multiple glyph metrics for better accuracy.\n\nvar extraCharacterMap = {\n  // Latin-1\n  'Å': 'A',\n  'Ð': 'D',\n  'Þ': 'o',\n  'å': 'a',\n  'ð': 'd',\n  'þ': 'o',\n  // Cyrillic\n  'А': 'A',\n  'Б': 'B',\n  'В': 'B',\n  'Г': 'F',\n  'Д': 'A',\n  'Е': 'E',\n  'Ж': 'K',\n  'З': '3',\n  'И': 'N',\n  'Й': 'N',\n  'К': 'K',\n  'Л': 'N',\n  'М': 'M',\n  'Н': 'H',\n  'О': 'O',\n  'П': 'N',\n  'Р': 'P',\n  'С': 'C',\n  'Т': 'T',\n  'У': 'y',\n  'Ф': 'O',\n  'Х': 'X',\n  'Ц': 'U',\n  'Ч': 'h',\n  'Ш': 'W',\n  'Щ': 'W',\n  'Ъ': 'B',\n  'Ы': 'X',\n  'Ь': 'B',\n  'Э': '3',\n  'Ю': 'X',\n  'Я': 'R',\n  'а': 'a',\n  'б': 'b',\n  'в': 'a',\n  'г': 'r',\n  'д': 'y',\n  'е': 'e',\n  'ж': 'm',\n  'з': 'e',\n  'и': 'n',\n  'й': 'n',\n  'к': 'n',\n  'л': 'n',\n  'м': 'm',\n  'н': 'n',\n  'о': 'o',\n  'п': 'n',\n  'р': 'p',\n  'с': 'c',\n  'т': 'o',\n  'у': 'y',\n  'ф': 'b',\n  'х': 'x',\n  'ц': 'n',\n  'ч': 'n',\n  'ш': 'w',\n  'щ': 'w',\n  'ъ': 'a',\n  'ы': 'm',\n  'ь': 'a',\n  'э': 'e',\n  'ю': 'm',\n  'я': 'r'\n};\n\n/**\n * This function adds new font metrics to default metricMap\n * It can also override existing metrics\n */\nfunction setFontMetrics(fontName, metrics) {\n  fontMetricsData[fontName] = metrics;\n}\n/**\n * This function is a convenience function for looking up information in the\n * metricMap table. It takes a character as a string, and a font.\n *\n * Note: the `width` property may be undefined if fontMetricsData.js wasn't\n * built using `Make extended_metrics`.\n */\n\nfunction getCharacterMetrics(character, font, mode) {\n  if (!fontMetricsData[font]) {\n    throw new Error(\"Font metrics not found for font: \" + font + \".\");\n  }\n\n  var ch = character.charCodeAt(0);\n  var metrics = fontMetricsData[font][ch];\n\n  if (!metrics && character[0] in extraCharacterMap) {\n    ch = extraCharacterMap[character[0]].charCodeAt(0);\n    metrics = fontMetricsData[font][ch];\n  }\n\n  if (!metrics && mode === 'text') {\n    // We don't typically have font metrics for Asian scripts.\n    // But since we support them in text mode, we need to return\n    // some sort of metrics.\n    // So if the character is in a script we support but we\n    // don't have metrics for it, just use the metrics for\n    // the Latin capital letter M. This is close enough because\n    // we (currently) only care about the height of the glyph\n    // not its width.\n    if (supportedCodepoint(ch)) {\n      metrics = fontMetricsData[font][77]; // 77 is the charcode for 'M'\n    }\n  }\n\n  if (metrics) {\n    return {\n      depth: metrics[0],\n      height: metrics[1],\n      italic: metrics[2],\n      skew: metrics[3],\n      width: metrics[4]\n    };\n  }\n}\nvar fontMetricsBySizeIndex = {};\n/**\n * Get the font metrics for a given size.\n */\n\nfunction getGlobalMetrics(size) {\n  var sizeIndex;\n\n  if (size >= 5) {\n    sizeIndex = 0;\n  } else if (size >= 3) {\n    sizeIndex = 1;\n  } else {\n    sizeIndex = 2;\n  }\n\n  if (!fontMetricsBySizeIndex[sizeIndex]) {\n    var metrics = fontMetricsBySizeIndex[sizeIndex] = {\n      cssEmPerMu: sigmasAndXis.quad[sizeIndex] / 18\n    };\n\n    for (var key in sigmasAndXis) {\n      if (sigmasAndXis.hasOwnProperty(key)) {\n        metrics[key] = sigmasAndXis[key][sizeIndex];\n      }\n    }\n  }\n\n  return fontMetricsBySizeIndex[sizeIndex];\n}\n\n/**\n * This file contains information about the options that the Parser carries\n * around with it while parsing. Data is held in an `Options` object, and when\n * recursing, a new `Options` object can be created with the `.with*` and\n * `.reset` functions.\n */\nvar sizeStyleMap = [// Each element contains [textsize, scriptsize, scriptscriptsize].\n// The size mappings are taken from TeX with \\normalsize=10pt.\n[1, 1, 1], // size1: [5, 5, 5]              \\tiny\n[2, 1, 1], // size2: [6, 5, 5]\n[3, 1, 1], // size3: [7, 5, 5]              \\scriptsize\n[4, 2, 1], // size4: [8, 6, 5]              \\footnotesize\n[5, 2, 1], // size5: [9, 6, 5]              \\small\n[6, 3, 1], // size6: [10, 7, 5]             \\normalsize\n[7, 4, 2], // size7: [12, 8, 6]             \\large\n[8, 6, 3], // size8: [14.4, 10, 7]          \\Large\n[9, 7, 6], // size9: [17.28, 12, 10]        \\LARGE\n[10, 8, 7], // size10: [20.74, 14.4, 12]     \\huge\n[11, 10, 9] // size11: [24.88, 20.74, 17.28] \\HUGE\n];\nvar sizeMultipliers = [// fontMetrics.js:getGlobalMetrics also uses size indexes, so if\n// you change size indexes, change that function.\n0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.2, 1.44, 1.728, 2.074, 2.488];\n\nvar sizeAtStyle = function sizeAtStyle(size, style) {\n  return style.size < 2 ? size : sizeStyleMap[size - 1][style.size - 1];\n}; // In these types, \"\" (empty string) means \"no change\".\n\n\n/**\n * This is the main options class. It contains the current style, size, color,\n * and font.\n *\n * Options objects should not be modified. To create a new Options with\n * different properties, call a `.having*` method.\n */\nclass Options {\n  // A font family applies to a group of fonts (i.e. SansSerif), while a font\n  // represents a specific font (i.e. SansSerif Bold).\n  // See: https://tex.stackexchange.com/questions/22350/difference-between-textrm-and-mathrm\n\n  /**\n   * The base size index.\n   */\n  constructor(data) {\n    this.style = void 0;\n    this.color = void 0;\n    this.size = void 0;\n    this.textSize = void 0;\n    this.phantom = void 0;\n    this.font = void 0;\n    this.fontFamily = void 0;\n    this.fontWeight = void 0;\n    this.fontShape = void 0;\n    this.sizeMultiplier = void 0;\n    this.maxSize = void 0;\n    this.minRuleThickness = void 0;\n    this._fontMetrics = void 0;\n    this.style = data.style;\n    this.color = data.color;\n    this.size = data.size || Options.BASESIZE;\n    this.textSize = data.textSize || this.size;\n    this.phantom = !!data.phantom;\n    this.font = data.font || \"\";\n    this.fontFamily = data.fontFamily || \"\";\n    this.fontWeight = data.fontWeight || '';\n    this.fontShape = data.fontShape || '';\n    this.sizeMultiplier = sizeMultipliers[this.size - 1];\n    this.maxSize = data.maxSize;\n    this.minRuleThickness = data.minRuleThickness;\n    this._fontMetrics = undefined;\n  }\n  /**\n   * Returns a new options object with the same properties as \"this\".  Properties\n   * from \"extension\" will be copied to the new options object.\n   */\n\n\n  extend(extension) {\n    var data = {\n      style: this.style,\n      size: this.size,\n      textSize: this.textSize,\n      color: this.color,\n      phantom: this.phantom,\n      font: this.font,\n      fontFamily: this.fontFamily,\n      fontWeight: this.fontWeight,\n      fontShape: this.fontShape,\n      maxSize: this.maxSize,\n      minRuleThickness: this.minRuleThickness\n    };\n\n    for (var key in extension) {\n      if (extension.hasOwnProperty(key)) {\n        data[key] = extension[key];\n      }\n    }\n\n    return new Options(data);\n  }\n  /**\n   * Return an options object with the given style. If `this.style === style`,\n   * returns `this`.\n   */\n\n\n  havingStyle(style) {\n    if (this.style === style) {\n      return this;\n    } else {\n      return this.extend({\n        style: style,\n        size: sizeAtStyle(this.textSize, style)\n      });\n    }\n  }\n  /**\n   * Return an options object with a cramped version of the current style. If\n   * the current style is cramped, returns `this`.\n   */\n\n\n  havingCrampedStyle() {\n    return this.havingStyle(this.style.cramp());\n  }\n  /**\n   * Return an options object with the given size and in at least `\\textstyle`.\n   * Returns `this` if appropriate.\n   */\n\n\n  havingSize(size) {\n    if (this.size === size && this.textSize === size) {\n      return this;\n    } else {\n      return this.extend({\n        style: this.style.text(),\n        size: size,\n        textSize: size,\n        sizeMultiplier: sizeMultipliers[size - 1]\n      });\n    }\n  }\n  /**\n   * Like `this.havingSize(BASESIZE).havingStyle(style)`. If `style` is omitted,\n   * changes to at least `\\textstyle`.\n   */\n\n\n  havingBaseStyle(style) {\n    style = style || this.style.text();\n    var wantSize = sizeAtStyle(Options.BASESIZE, style);\n\n    if (this.size === wantSize && this.textSize === Options.BASESIZE && this.style === style) {\n      return this;\n    } else {\n      return this.extend({\n        style: style,\n        size: wantSize\n      });\n    }\n  }\n  /**\n   * Remove the effect of sizing changes such as \\Huge.\n   * Keep the effect of the current style, such as \\scriptstyle.\n   */\n\n\n  havingBaseSizing() {\n    var size;\n\n    switch (this.style.id) {\n      case 4:\n      case 5:\n        size = 3; // normalsize in scriptstyle\n\n        break;\n\n      case 6:\n      case 7:\n        size = 1; // normalsize in scriptscriptstyle\n\n        break;\n\n      default:\n        size = 6;\n      // normalsize in textstyle or displaystyle\n    }\n\n    return this.extend({\n      style: this.style.text(),\n      size: size\n    });\n  }\n  /**\n   * Create a new options object with the given color.\n   */\n\n\n  withColor(color) {\n    return this.extend({\n      color: color\n    });\n  }\n  /**\n   * Create a new options object with \"phantom\" set to true.\n   */\n\n\n  withPhantom() {\n    return this.extend({\n      phantom: true\n    });\n  }\n  /**\n   * Creates a new options object with the given math font or old text font.\n   * @type {[type]}\n   */\n\n\n  withFont(font) {\n    return this.extend({\n      font\n    });\n  }\n  /**\n   * Create a new options objects with the given fontFamily.\n   */\n\n\n  withTextFontFamily(fontFamily) {\n    return this.extend({\n      fontFamily,\n      font: \"\"\n    });\n  }\n  /**\n   * Creates a new options object with the given font weight\n   */\n\n\n  withTextFontWeight(fontWeight) {\n    return this.extend({\n      fontWeight,\n      font: \"\"\n    });\n  }\n  /**\n   * Creates a new options object with the given font weight\n   */\n\n\n  withTextFontShape(fontShape) {\n    return this.extend({\n      fontShape,\n      font: \"\"\n    });\n  }\n  /**\n   * Return the CSS sizing classes required to switch from enclosing options\n   * `oldOptions` to `this`. Returns an array of classes.\n   */\n\n\n  sizingClasses(oldOptions) {\n    if (oldOptions.size !== this.size) {\n      return [\"sizing\", \"reset-size\" + oldOptions.size, \"size\" + this.size];\n    } else {\n      return [];\n    }\n  }\n  /**\n   * Return the CSS sizing classes required to switch to the base size. Like\n   * `this.havingSize(BASESIZE).sizingClasses(this)`.\n   */\n\n\n  baseSizingClasses() {\n    if (this.size !== Options.BASESIZE) {\n      return [\"sizing\", \"reset-size\" + this.size, \"size\" + Options.BASESIZE];\n    } else {\n      return [];\n    }\n  }\n  /**\n   * Return the font metrics for this size.\n   */\n\n\n  fontMetrics() {\n    if (!this._fontMetrics) {\n      this._fontMetrics = getGlobalMetrics(this.size);\n    }\n\n    return this._fontMetrics;\n  }\n  /**\n   * Gets the CSS color of the current options object\n   */\n\n\n  getColor() {\n    if (this.phantom) {\n      return \"transparent\";\n    } else {\n      return this.color;\n    }\n  }\n\n}\n\nOptions.BASESIZE = 6;\n\n/**\n * This file does conversion between units.  In particular, it provides\n * calculateSize to convert other units into ems.\n */\n// Thus, multiplying a length by this number converts the length from units\n// into pts.  Dividing the result by ptPerEm gives the number of ems\n// *assuming* a font size of ptPerEm (normal size, normal style).\n\nvar ptPerUnit = {\n  // https://en.wikibooks.org/wiki/LaTeX/Lengths and\n  // https://tex.stackexchange.com/a/8263\n  \"pt\": 1,\n  // TeX point\n  \"mm\": 7227 / 2540,\n  // millimeter\n  \"cm\": 7227 / 254,\n  // centimeter\n  \"in\": 72.27,\n  // inch\n  \"bp\": 803 / 800,\n  // big (PostScript) points\n  \"pc\": 12,\n  // pica\n  \"dd\": 1238 / 1157,\n  // didot\n  \"cc\": 14856 / 1157,\n  // cicero (12 didot)\n  \"nd\": 685 / 642,\n  // new didot\n  \"nc\": 1370 / 107,\n  // new cicero (12 new didot)\n  \"sp\": 1 / 65536,\n  // scaled point (TeX's internal smallest unit)\n  // https://tex.stackexchange.com/a/41371\n  \"px\": 803 / 800 // \\pdfpxdimen defaults to 1 bp in pdfTeX and LuaTeX\n\n}; // Dictionary of relative units, for fast validity testing.\n\nvar relativeUnit = {\n  \"ex\": true,\n  \"em\": true,\n  \"mu\": true\n};\n\n/**\n * Determine whether the specified unit (either a string defining the unit\n * or a \"size\" parse node containing a unit field) is valid.\n */\nvar validUnit = function validUnit(unit) {\n  if (typeof unit !== \"string\") {\n    unit = unit.unit;\n  }\n\n  return unit in ptPerUnit || unit in relativeUnit || unit === \"ex\";\n};\n/*\n * Convert a \"size\" parse node (with numeric \"number\" and string \"unit\" fields,\n * as parsed by functions.js argType \"size\") into a CSS em value for the\n * current style/scale.  `options` gives the current options.\n */\n\nvar calculateSize = function calculateSize(sizeValue, options) {\n  var scale;\n\n  if (sizeValue.unit in ptPerUnit) {\n    // Absolute units\n    scale = ptPerUnit[sizeValue.unit] // Convert unit to pt\n    / options.fontMetrics().ptPerEm // Convert pt to CSS em\n    / options.sizeMultiplier; // Unscale to make absolute units\n  } else if (sizeValue.unit === \"mu\") {\n    // `mu` units scale with scriptstyle/scriptscriptstyle.\n    scale = options.fontMetrics().cssEmPerMu;\n  } else {\n    // Other relative units always refer to the *textstyle* font\n    // in the current size.\n    var unitOptions;\n\n    if (options.style.isTight()) {\n      // isTight() means current style is script/scriptscript.\n      unitOptions = options.havingStyle(options.style.text());\n    } else {\n      unitOptions = options;\n    } // TODO: In TeX these units are relative to the quad of the current\n    // *text* font, e.g. cmr10. KaTeX instead uses values from the\n    // comparably-sized *Computer Modern symbol* font. At 10pt, these\n    // match. At 7pt and 5pt, they differ: cmr7=1.138894, cmsy7=1.170641;\n    // cmr5=1.361133, cmsy5=1.472241. Consider $\\scriptsize a\\kern1emb$.\n    // TeX \\showlists shows a kern of 1.13889 * fontsize;\n    // KaTeX shows a kern of 1.171 * fontsize.\n\n\n    if (sizeValue.unit === \"ex\") {\n      scale = unitOptions.fontMetrics().xHeight;\n    } else if (sizeValue.unit === \"em\") {\n      scale = unitOptions.fontMetrics().quad;\n    } else {\n      throw new ParseError(\"Invalid unit: '\" + sizeValue.unit + \"'\");\n    }\n\n    if (unitOptions !== options) {\n      scale *= unitOptions.sizeMultiplier / options.sizeMultiplier;\n    }\n  }\n\n  return Math.min(sizeValue.number * scale, options.maxSize);\n};\n/**\n * Round `n` to 4 decimal places, or to the nearest 1/10,000th em. See\n * https://github.com/KaTeX/KaTeX/pull/2460.\n */\n\nvar makeEm = function makeEm(n) {\n  return +n.toFixed(4) + \"em\";\n};\n\n/**\n * These objects store the data about the DOM nodes we create, as well as some\n * extra data. They can then be transformed into real DOM nodes with the\n * `toNode` function or HTML markup using `toMarkup`. They are useful for both\n * storing extra properties on the nodes, as well as providing a way to easily\n * work with the DOM.\n *\n * Similar functions for working with MathML nodes exist in mathMLTree.js.\n *\n * TODO: refactor `span` and `anchor` into common superclass when\n * target environments support class inheritance\n */\n\n/**\n * Create an HTML className based on a list of classes. In addition to joining\n * with spaces, we also remove empty classes.\n */\nvar createClass = function createClass(classes) {\n  return classes.filter(cls => cls).join(\" \");\n};\n\nvar initNode = function initNode(classes, options, style) {\n  this.classes = classes || [];\n  this.attributes = {};\n  this.height = 0;\n  this.depth = 0;\n  this.maxFontSize = 0;\n  this.style = style || {};\n\n  if (options) {\n    if (options.style.isTight()) {\n      this.classes.push(\"mtight\");\n    }\n\n    var color = options.getColor();\n\n    if (color) {\n      this.style.color = color;\n    }\n  }\n};\n/**\n * Convert into an HTML node\n */\n\n\nvar toNode = function toNode(tagName) {\n  var node = document.createElement(tagName); // Apply the class\n\n  node.className = createClass(this.classes); // Apply inline styles\n\n  for (var style in this.style) {\n    if (this.style.hasOwnProperty(style)) {\n      // $FlowFixMe Flow doesn't seem to understand span.style's type.\n      node.style[style] = this.style[style];\n    }\n  } // Apply attributes\n\n\n  for (var attr in this.attributes) {\n    if (this.attributes.hasOwnProperty(attr)) {\n      node.setAttribute(attr, this.attributes[attr]);\n    }\n  } // Append the children, also as HTML nodes\n\n\n  for (var i = 0; i < this.children.length; i++) {\n    node.appendChild(this.children[i].toNode());\n  }\n\n  return node;\n};\n/**\n * https://w3c.github.io/html-reference/syntax.html#syntax-attributes\n *\n * > Attribute Names must consist of one or more characters\n * other than the space characters, U+0000 NULL,\n * '\"', \"'\", \">\", \"/\", \"=\", the control characters,\n * and any characters that are not defined by Unicode.\n */\n\n\nvar invalidAttributeNameRegex = /[\\s\"'>/=\\x00-\\x1f]/;\n/**\n * Convert into an HTML markup string\n */\n\nvar toMarkup = function toMarkup(tagName) {\n  var markup = \"<\" + tagName; // Add the class\n\n  if (this.classes.length) {\n    markup += \" class=\\\"\" + utils.escape(createClass(this.classes)) + \"\\\"\";\n  }\n\n  var styles = \"\"; // Add the styles, after hyphenation\n\n  for (var style in this.style) {\n    if (this.style.hasOwnProperty(style)) {\n      styles += utils.hyphenate(style) + \":\" + this.style[style] + \";\";\n    }\n  }\n\n  if (styles) {\n    markup += \" style=\\\"\" + utils.escape(styles) + \"\\\"\";\n  } // Add the attributes\n\n\n  for (var attr in this.attributes) {\n    if (this.attributes.hasOwnProperty(attr)) {\n      if (invalidAttributeNameRegex.test(attr)) {\n        throw new ParseError(\"Invalid attribute name '\" + attr + \"'\");\n      }\n\n      markup += \" \" + attr + \"=\\\"\" + utils.escape(this.attributes[attr]) + \"\\\"\";\n    }\n  }\n\n  markup += \">\"; // Add the markup of the children, also as markup\n\n  for (var i = 0; i < this.children.length; i++) {\n    markup += this.children[i].toMarkup();\n  }\n\n  markup += \"</\" + tagName + \">\";\n  return markup;\n}; // Making the type below exact with all optional fields doesn't work due to\n// - https://github.com/facebook/flow/issues/4582\n// - https://github.com/facebook/flow/issues/5688\n// However, since *all* fields are optional, $Shape<> works as suggested in 5688\n// above.\n// This type does not include all CSS properties. Additional properties should\n// be added as needed.\n\n\n/**\n * This node represents a span node, with a className, a list of children, and\n * an inline style. It also contains information about its height, depth, and\n * maxFontSize.\n *\n * Represents two types with different uses: SvgSpan to wrap an SVG and DomSpan\n * otherwise. This typesafety is important when HTML builders access a span's\n * children.\n */\nclass Span {\n  constructor(classes, children, options, style) {\n    this.children = void 0;\n    this.attributes = void 0;\n    this.classes = void 0;\n    this.height = void 0;\n    this.depth = void 0;\n    this.width = void 0;\n    this.maxFontSize = void 0;\n    this.style = void 0;\n    initNode.call(this, classes, options, style);\n    this.children = children || [];\n  }\n  /**\n   * Sets an arbitrary attribute on the span. Warning: use this wisely. Not\n   * all browsers support attributes the same, and having too many custom\n   * attributes is probably bad.\n   */\n\n\n  setAttribute(attribute, value) {\n    this.attributes[attribute] = value;\n  }\n\n  hasClass(className) {\n    return utils.contains(this.classes, className);\n  }\n\n  toNode() {\n    return toNode.call(this, \"span\");\n  }\n\n  toMarkup() {\n    return toMarkup.call(this, \"span\");\n  }\n\n}\n/**\n * This node represents an anchor (<a>) element with a hyperlink.  See `span`\n * for further details.\n */\n\nclass Anchor {\n  constructor(href, classes, children, options) {\n    this.children = void 0;\n    this.attributes = void 0;\n    this.classes = void 0;\n    this.height = void 0;\n    this.depth = void 0;\n    this.maxFontSize = void 0;\n    this.style = void 0;\n    initNode.call(this, classes, options);\n    this.children = children || [];\n    this.setAttribute('href', href);\n  }\n\n  setAttribute(attribute, value) {\n    this.attributes[attribute] = value;\n  }\n\n  hasClass(className) {\n    return utils.contains(this.classes, className);\n  }\n\n  toNode() {\n    return toNode.call(this, \"a\");\n  }\n\n  toMarkup() {\n    return toMarkup.call(this, \"a\");\n  }\n\n}\n/**\n * This node represents an image embed (<img>) element.\n */\n\nclass Img {\n  constructor(src, alt, style) {\n    this.src = void 0;\n    this.alt = void 0;\n    this.classes = void 0;\n    this.height = void 0;\n    this.depth = void 0;\n    this.maxFontSize = void 0;\n    this.style = void 0;\n    this.alt = alt;\n    this.src = src;\n    this.classes = [\"mord\"];\n    this.style = style;\n  }\n\n  hasClass(className) {\n    return utils.contains(this.classes, className);\n  }\n\n  toNode() {\n    var node = document.createElement(\"img\");\n    node.src = this.src;\n    node.alt = this.alt;\n    node.className = \"mord\"; // Apply inline styles\n\n    for (var style in this.style) {\n      if (this.style.hasOwnProperty(style)) {\n        // $FlowFixMe\n        node.style[style] = this.style[style];\n      }\n    }\n\n    return node;\n  }\n\n  toMarkup() {\n    var markup = \"<img src=\\\"\" + utils.escape(this.src) + \"\\\"\" + (\" alt=\\\"\" + utils.escape(this.alt) + \"\\\"\"); // Add the styles, after hyphenation\n\n    var styles = \"\";\n\n    for (var style in this.style) {\n      if (this.style.hasOwnProperty(style)) {\n        styles += utils.hyphenate(style) + \":\" + this.style[style] + \";\";\n      }\n    }\n\n    if (styles) {\n      markup += \" style=\\\"\" + utils.escape(styles) + \"\\\"\";\n    }\n\n    markup += \"'/>\";\n    return markup;\n  }\n\n}\nvar iCombinations = {\n  'î': '\\u0131\\u0302',\n  'ï': '\\u0131\\u0308',\n  'í': '\\u0131\\u0301',\n  // 'ī': '\\u0131\\u0304', // enable when we add Extended Latin\n  'ì': '\\u0131\\u0300'\n};\n/**\n * A symbol node contains information about a single symbol. It either renders\n * to a single text node, or a span with a single text node in it, depending on\n * whether it has CSS classes, styles, or needs italic correction.\n */\n\nclass SymbolNode {\n  constructor(text, height, depth, italic, skew, width, classes, style) {\n    this.text = void 0;\n    this.height = void 0;\n    this.depth = void 0;\n    this.italic = void 0;\n    this.skew = void 0;\n    this.width = void 0;\n    this.maxFontSize = void 0;\n    this.classes = void 0;\n    this.style = void 0;\n    this.text = text;\n    this.height = height || 0;\n    this.depth = depth || 0;\n    this.italic = italic || 0;\n    this.skew = skew || 0;\n    this.width = width || 0;\n    this.classes = classes || [];\n    this.style = style || {};\n    this.maxFontSize = 0; // Mark text from non-Latin scripts with specific classes so that we\n    // can specify which fonts to use.  This allows us to render these\n    // characters with a serif font in situations where the browser would\n    // either default to a sans serif or render a placeholder character.\n    // We use CSS class names like cjk_fallback, hangul_fallback and\n    // brahmic_fallback. See ./unicodeScripts.js for the set of possible\n    // script names\n\n    var script = scriptFromCodepoint(this.text.charCodeAt(0));\n\n    if (script) {\n      this.classes.push(script + \"_fallback\");\n    }\n\n    if (/[îïíì]/.test(this.text)) {\n      // add ī when we add Extended Latin\n      this.text = iCombinations[this.text];\n    }\n  }\n\n  hasClass(className) {\n    return utils.contains(this.classes, className);\n  }\n  /**\n   * Creates a text node or span from a symbol node. Note that a span is only\n   * created if it is needed.\n   */\n\n\n  toNode() {\n    var node = document.createTextNode(this.text);\n    var span = null;\n\n    if (this.italic > 0) {\n      span = document.createElement(\"span\");\n      span.style.marginRight = makeEm(this.italic);\n    }\n\n    if (this.classes.length > 0) {\n      span = span || document.createElement(\"span\");\n      span.className = createClass(this.classes);\n    }\n\n    for (var style in this.style) {\n      if (this.style.hasOwnProperty(style)) {\n        span = span || document.createElement(\"span\"); // $FlowFixMe Flow doesn't seem to understand span.style's type.\n\n        span.style[style] = this.style[style];\n      }\n    }\n\n    if (span) {\n      span.appendChild(node);\n      return span;\n    } else {\n      return node;\n    }\n  }\n  /**\n   * Creates markup for a symbol node.\n   */\n\n\n  toMarkup() {\n    // TODO(alpert): More duplication than I'd like from\n    // span.prototype.toMarkup and symbolNode.prototype.toNode...\n    var needsSpan = false;\n    var markup = \"<span\";\n\n    if (this.classes.length) {\n      needsSpan = true;\n      markup += \" class=\\\"\";\n      markup += utils.escape(createClass(this.classes));\n      markup += \"\\\"\";\n    }\n\n    var styles = \"\";\n\n    if (this.italic > 0) {\n      styles += \"margin-right:\" + this.italic + \"em;\";\n    }\n\n    for (var style in this.style) {\n      if (this.style.hasOwnProperty(style)) {\n        styles += utils.hyphenate(style) + \":\" + this.style[style] + \";\";\n      }\n    }\n\n    if (styles) {\n      needsSpan = true;\n      markup += \" style=\\\"\" + utils.escape(styles) + \"\\\"\";\n    }\n\n    var escaped = utils.escape(this.text);\n\n    if (needsSpan) {\n      markup += \">\";\n      markup += escaped;\n      markup += \"</span>\";\n      return markup;\n    } else {\n      return escaped;\n    }\n  }\n\n}\n/**\n * SVG nodes are used to render stretchy wide elements.\n */\n\nclass SvgNode {\n  constructor(children, attributes) {\n    this.children = void 0;\n    this.attributes = void 0;\n    this.children = children || [];\n    this.attributes = attributes || {};\n  }\n\n  toNode() {\n    var svgNS = \"http://www.w3.org/2000/svg\";\n    var node = document.createElementNS(svgNS, \"svg\"); // Apply attributes\n\n    for (var attr in this.attributes) {\n      if (Object.prototype.hasOwnProperty.call(this.attributes, attr)) {\n        node.setAttribute(attr, this.attributes[attr]);\n      }\n    }\n\n    for (var i = 0; i < this.children.length; i++) {\n      node.appendChild(this.children[i].toNode());\n    }\n\n    return node;\n  }\n\n  toMarkup() {\n    var markup = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\"\"; // Apply attributes\n\n    for (var attr in this.attributes) {\n      if (Object.prototype.hasOwnProperty.call(this.attributes, attr)) {\n        markup += \" \" + attr + \"=\\\"\" + utils.escape(this.attributes[attr]) + \"\\\"\";\n      }\n    }\n\n    markup += \">\";\n\n    for (var i = 0; i < this.children.length; i++) {\n      markup += this.children[i].toMarkup();\n    }\n\n    markup += \"</svg>\";\n    return markup;\n  }\n\n}\nclass PathNode {\n  constructor(pathName, alternate) {\n    this.pathName = void 0;\n    this.alternate = void 0;\n    this.pathName = pathName;\n    this.alternate = alternate; // Used only for \\sqrt, \\phase, & tall delims\n  }\n\n  toNode() {\n    var svgNS = \"http://www.w3.org/2000/svg\";\n    var node = document.createElementNS(svgNS, \"path\");\n\n    if (this.alternate) {\n      node.setAttribute(\"d\", this.alternate);\n    } else {\n      node.setAttribute(\"d\", path[this.pathName]);\n    }\n\n    return node;\n  }\n\n  toMarkup() {\n    if (this.alternate) {\n      return \"<path d=\\\"\" + utils.escape(this.alternate) + \"\\\"/>\";\n    } else {\n      return \"<path d=\\\"\" + utils.escape(path[this.pathName]) + \"\\\"/>\";\n    }\n  }\n\n}\nclass LineNode {\n  constructor(attributes) {\n    this.attributes = void 0;\n    this.attributes = attributes || {};\n  }\n\n  toNode() {\n    var svgNS = \"http://www.w3.org/2000/svg\";\n    var node = document.createElementNS(svgNS, \"line\"); // Apply attributes\n\n    for (var attr in this.attributes) {\n      if (Object.prototype.hasOwnProperty.call(this.attributes, attr)) {\n        node.setAttribute(attr, this.attributes[attr]);\n      }\n    }\n\n    return node;\n  }\n\n  toMarkup() {\n    var markup = \"<line\";\n\n    for (var attr in this.attributes) {\n      if (Object.prototype.hasOwnProperty.call(this.attributes, attr)) {\n        markup += \" \" + attr + \"=\\\"\" + utils.escape(this.attributes[attr]) + \"\\\"\";\n      }\n    }\n\n    markup += \"/>\";\n    return markup;\n  }\n\n}\nfunction assertSymbolDomNode(group) {\n  if (group instanceof SymbolNode) {\n    return group;\n  } else {\n    throw new Error(\"Expected symbolNode but got \" + String(group) + \".\");\n  }\n}\nfunction assertSpan(group) {\n  if (group instanceof Span) {\n    return group;\n  } else {\n    throw new Error(\"Expected span<HtmlDomNode> but got \" + String(group) + \".\");\n  }\n}\n\n/**\n * This file holds a list of all no-argument functions and single-character\n * symbols (like 'a' or ';').\n *\n * For each of the symbols, there are three properties they can have:\n * - font (required): the font to be used for this symbol. Either \"main\" (the\n     normal font), or \"ams\" (the ams fonts).\n * - group (required): the ParseNode group type the symbol should have (i.e.\n     \"textord\", \"mathord\", etc).\n     See https://github.com/KaTeX/KaTeX/wiki/Examining-TeX#group-types\n * - replace: the character that this symbol or function should be\n *   replaced with (i.e. \"\\phi\" has a replace value of \"\\u03d5\", the phi\n *   character in the main font).\n *\n * The outermost map in the table indicates what mode the symbols should be\n * accepted in (e.g. \"math\" or \"text\").\n */\n// Some of these have a \"-token\" suffix since these are also used as `ParseNode`\n// types for raw text tokens, and we want to avoid conflicts with higher-level\n// `ParseNode` types. These `ParseNode`s are constructed within `Parser` by\n// looking up the `symbols` map.\nvar ATOMS = {\n  \"bin\": 1,\n  \"close\": 1,\n  \"inner\": 1,\n  \"open\": 1,\n  \"punct\": 1,\n  \"rel\": 1\n};\nvar NON_ATOMS = {\n  \"accent-token\": 1,\n  \"mathord\": 1,\n  \"op-token\": 1,\n  \"spacing\": 1,\n  \"textord\": 1\n};\nvar symbols = {\n  \"math\": {},\n  \"text\": {}\n};\n/** `acceptUnicodeChar = true` is only applicable if `replace` is set. */\n\nfunction defineSymbol(mode, font, group, replace, name, acceptUnicodeChar) {\n  symbols[mode][name] = {\n    font,\n    group,\n    replace\n  };\n\n  if (acceptUnicodeChar && replace) {\n    symbols[mode][replace] = symbols[mode][name];\n  }\n} // Some abbreviations for commonly used strings.\n// This helps minify the code, and also spotting typos using jshint.\n// modes:\n\nvar math = \"math\";\nvar text = \"text\"; // fonts:\n\nvar main = \"main\";\nvar ams = \"ams\"; // groups:\n\nvar accent = \"accent-token\";\nvar bin = \"bin\";\nvar close = \"close\";\nvar inner = \"inner\";\nvar mathord = \"mathord\";\nvar op = \"op-token\";\nvar open = \"open\";\nvar punct = \"punct\";\nvar rel = \"rel\";\nvar spacing = \"spacing\";\nvar textord = \"textord\"; // Now comes the symbol table\n// Relation Symbols\n\ndefineSymbol(math, main, rel, \"\\u2261\", \"\\\\equiv\", true);\ndefineSymbol(math, main, rel, \"\\u227a\", \"\\\\prec\", true);\ndefineSymbol(math, main, rel, \"\\u227b\", \"\\\\succ\", true);\ndefineSymbol(math, main, rel, \"\\u223c\", \"\\\\sim\", true);\ndefineSymbol(math, main, rel, \"\\u22a5\", \"\\\\perp\");\ndefineSymbol(math, main, rel, \"\\u2aaf\", \"\\\\preceq\", true);\ndefineSymbol(math, main, rel, \"\\u2ab0\", \"\\\\succeq\", true);\ndefineSymbol(math, main, rel, \"\\u2243\", \"\\\\simeq\", true);\ndefineSymbol(math, main, rel, \"\\u2223\", \"\\\\mid\", true);\ndefineSymbol(math, main, rel, \"\\u226a\", \"\\\\ll\", true);\ndefineSymbol(math, main, rel, \"\\u226b\", \"\\\\gg\", true);\ndefineSymbol(math, main, rel, \"\\u224d\", \"\\\\asymp\", true);\ndefineSymbol(math, main, rel, \"\\u2225\", \"\\\\parallel\");\ndefineSymbol(math, main, rel, \"\\u22c8\", \"\\\\bowtie\", true);\ndefineSymbol(math, main, rel, \"\\u2323\", \"\\\\smile\", true);\ndefineSymbol(math, main, rel, \"\\u2291\", \"\\\\sqsubseteq\", true);\ndefineSymbol(math, main, rel, \"\\u2292\", \"\\\\sqsupseteq\", true);\ndefineSymbol(math, main, rel, \"\\u2250\", \"\\\\doteq\", true);\ndefineSymbol(math, main, rel, \"\\u2322\", \"\\\\frown\", true);\ndefineSymbol(math, main, rel, \"\\u220b\", \"\\\\ni\", true);\ndefineSymbol(math, main, rel, \"\\u221d\", \"\\\\propto\", true);\ndefineSymbol(math, main, rel, \"\\u22a2\", \"\\\\vdash\", true);\ndefineSymbol(math, main, rel, \"\\u22a3\", \"\\\\dashv\", true);\ndefineSymbol(math, main, rel, \"\\u220b\", \"\\\\owns\"); // Punctuation\n\ndefineSymbol(math, main, punct, \"\\u002e\", \"\\\\ldotp\");\ndefineSymbol(math, main, punct, \"\\u22c5\", \"\\\\cdotp\"); // Misc Symbols\n\ndefineSymbol(math, main, textord, \"\\u0023\", \"\\\\#\");\ndefineSymbol(text, main, textord, \"\\u0023\", \"\\\\#\");\ndefineSymbol(math, main, textord, \"\\u0026\", \"\\\\&\");\ndefineSymbol(text, main, textord, \"\\u0026\", \"\\\\&\");\ndefineSymbol(math, main, textord, \"\\u2135\", \"\\\\aleph\", true);\ndefineSymbol(math, main, textord, \"\\u2200\", \"\\\\forall\", true);\ndefineSymbol(math, main, textord, \"\\u210f\", \"\\\\hbar\", true);\ndefineSymbol(math, main, textord, \"\\u2203\", \"\\\\exists\", true);\ndefineSymbol(math, main, textord, \"\\u2207\", \"\\\\nabla\", true);\ndefineSymbol(math, main, textord, \"\\u266d\", \"\\\\flat\", true);\ndefineSymbol(math, main, textord, \"\\u2113\", \"\\\\ell\", true);\ndefineSymbol(math, main, textord, \"\\u266e\", \"\\\\natural\", true);\ndefineSymbol(math, main, textord, \"\\u2663\", \"\\\\clubsuit\", true);\ndefineSymbol(math, main, textord, \"\\u2118\", \"\\\\wp\", true);\ndefineSymbol(math, main, textord, \"\\u266f\", \"\\\\sharp\", true);\ndefineSymbol(math, main, textord, \"\\u2662\", \"\\\\diamondsuit\", true);\ndefineSymbol(math, main, textord, \"\\u211c\", \"\\\\Re\", true);\ndefineSymbol(math, main, textord, \"\\u2661\", \"\\\\heartsuit\", true);\ndefineSymbol(math, main, textord, \"\\u2111\", \"\\\\Im\", true);\ndefineSymbol(math, main, textord, \"\\u2660\", \"\\\\spadesuit\", true);\ndefineSymbol(math, main, textord, \"\\u00a7\", \"\\\\S\", true);\ndefineSymbol(text, main, textord, \"\\u00a7\", \"\\\\S\");\ndefineSymbol(math, main, textord, \"\\u00b6\", \"\\\\P\", true);\ndefineSymbol(text, main, textord, \"\\u00b6\", \"\\\\P\"); // Math and Text\n\ndefineSymbol(math, main, textord, \"\\u2020\", \"\\\\dag\");\ndefineSymbol(text, main, textord, \"\\u2020\", \"\\\\dag\");\ndefineSymbol(text, main, textord, \"\\u2020\", \"\\\\textdagger\");\ndefineSymbol(math, main, textord, \"\\u2021\", \"\\\\ddag\");\ndefineSymbol(text, main, textord, \"\\u2021\", \"\\\\ddag\");\ndefineSymbol(text, main, textord, \"\\u2021\", \"\\\\textdaggerdbl\"); // Large Delimiters\n\ndefineSymbol(math, main, close, \"\\u23b1\", \"\\\\rmoustache\", true);\ndefineSymbol(math, main, open, \"\\u23b0\", \"\\\\lmoustache\", true);\ndefineSymbol(math, main, close, \"\\u27ef\", \"\\\\rgroup\", true);\ndefineSymbol(math, main, open, \"\\u27ee\", \"\\\\lgroup\", true); // Binary Operators\n\ndefineSymbol(math, main, bin, \"\\u2213\", \"\\\\mp\", true);\ndefineSymbol(math, main, bin, \"\\u2296\", \"\\\\ominus\", true);\ndefineSymbol(math, main, bin, \"\\u228e\", \"\\\\uplus\", true);\ndefineSymbol(math, main, bin, \"\\u2293\", \"\\\\sqcap\", true);\ndefineSymbol(math, main, bin, \"\\u2217\", \"\\\\ast\");\ndefineSymbol(math, main, bin, \"\\u2294\", \"\\\\sqcup\", true);\ndefineSymbol(math, main, bin, \"\\u25ef\", \"\\\\bigcirc\", true);\ndefineSymbol(math, main, bin, \"\\u2219\", \"\\\\bullet\", true);\ndefineSymbol(math, main, bin, \"\\u2021\", \"\\\\ddagger\");\ndefineSymbol(math, main, bin, \"\\u2240\", \"\\\\wr\", true);\ndefineSymbol(math, main, bin, \"\\u2a3f\", \"\\\\amalg\");\ndefineSymbol(math, main, bin, \"\\u0026\", \"\\\\And\"); // from amsmath\n// Arrow Symbols\n\ndefineSymbol(math, main, rel, \"\\u27f5\", \"\\\\longleftarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21d0\", \"\\\\Leftarrow\", true);\ndefineSymbol(math, main, rel, \"\\u27f8\", \"\\\\Longleftarrow\", true);\ndefineSymbol(math, main, rel, \"\\u27f6\", \"\\\\longrightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21d2\", \"\\\\Rightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u27f9\", \"\\\\Longrightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u2194\", \"\\\\leftrightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u27f7\", \"\\\\longleftrightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21d4\", \"\\\\Leftrightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u27fa\", \"\\\\Longleftrightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21a6\", \"\\\\mapsto\", true);\ndefineSymbol(math, main, rel, \"\\u27fc\", \"\\\\longmapsto\", true);\ndefineSymbol(math, main, rel, \"\\u2197\", \"\\\\nearrow\", true);\ndefineSymbol(math, main, rel, \"\\u21a9\", \"\\\\hookleftarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21aa\", \"\\\\hookrightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u2198\", \"\\\\searrow\", true);\ndefineSymbol(math, main, rel, \"\\u21bc\", \"\\\\leftharpoonup\", true);\ndefineSymbol(math, main, rel, \"\\u21c0\", \"\\\\rightharpoonup\", true);\ndefineSymbol(math, main, rel, \"\\u2199\", \"\\\\swarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21bd\", \"\\\\leftharpoondown\", true);\ndefineSymbol(math, main, rel, \"\\u21c1\", \"\\\\rightharpoondown\", true);\ndefineSymbol(math, main, rel, \"\\u2196\", \"\\\\nwarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21cc\", \"\\\\rightleftharpoons\", true); // AMS Negated Binary Relations\n\ndefineSymbol(math, ams, rel, \"\\u226e\", \"\\\\nless\", true); // Symbol names preceded by \"@\" each have a corresponding macro.\n\ndefineSymbol(math, ams, rel, \"\\ue010\", \"\\\\@nleqslant\");\ndefineSymbol(math, ams, rel, \"\\ue011\", \"\\\\@nleqq\");\ndefineSymbol(math, ams, rel, \"\\u2a87\", \"\\\\lneq\", true);\ndefineSymbol(math, ams, rel, \"\\u2268\", \"\\\\lneqq\", true);\ndefineSymbol(math, ams, rel, \"\\ue00c\", \"\\\\@lvertneqq\");\ndefineSymbol(math, ams, rel, \"\\u22e6\", \"\\\\lnsim\", true);\ndefineSymbol(math, ams, rel, \"\\u2a89\", \"\\\\lnapprox\", true);\ndefineSymbol(math, ams, rel, \"\\u2280\", \"\\\\nprec\", true); // unicode-math maps \\u22e0 to \\npreccurlyeq. We'll use the AMS synonym.\n\ndefineSymbol(math, ams, rel, \"\\u22e0\", \"\\\\npreceq\", true);\ndefineSymbol(math, ams, rel, \"\\u22e8\", \"\\\\precnsim\", true);\ndefineSymbol(math, ams, rel, \"\\u2ab9\", \"\\\\precnapprox\", true);\ndefineSymbol(math, ams, rel, \"\\u2241\", \"\\\\nsim\", true);\ndefineSymbol(math, ams, rel, \"\\ue006\", \"\\\\@nshortmid\");\ndefineSymbol(math, ams, rel, \"\\u2224\", \"\\\\nmid\", true);\ndefineSymbol(math, ams, rel, \"\\u22ac\", \"\\\\nvdash\", true);\ndefineSymbol(math, ams, rel, \"\\u22ad\", \"\\\\nvDash\", true);\ndefineSymbol(math, ams, rel, \"\\u22ea\", \"\\\\ntriangleleft\");\ndefineSymbol(math, ams, rel, \"\\u22ec\", \"\\\\ntrianglelefteq\", true);\ndefineSymbol(math, ams, rel, \"\\u228a\", \"\\\\subsetneq\", true);\ndefineSymbol(math, ams, rel, \"\\ue01a\", \"\\\\@varsubsetneq\");\ndefineSymbol(math, ams, rel, \"\\u2acb\", \"\\\\subsetneqq\", true);\ndefineSymbol(math, ams, rel, \"\\ue017\", \"\\\\@varsubsetneqq\");\ndefineSymbol(math, ams, rel, \"\\u226f\", \"\\\\ngtr\", true);\ndefineSymbol(math, ams, rel, \"\\ue00f\", \"\\\\@ngeqslant\");\ndefineSymbol(math, ams, rel, \"\\ue00e\", \"\\\\@ngeqq\");\ndefineSymbol(math, ams, rel, \"\\u2a88\", \"\\\\gneq\", true);\ndefineSymbol(math, ams, rel, \"\\u2269\", \"\\\\gneqq\", true);\ndefineSymbol(math, ams, rel, \"\\ue00d\", \"\\\\@gvertneqq\");\ndefineSymbol(math, ams, rel, \"\\u22e7\", \"\\\\gnsim\", true);\ndefineSymbol(math, ams, rel, \"\\u2a8a\", \"\\\\gnapprox\", true);\ndefineSymbol(math, ams, rel, \"\\u2281\", \"\\\\nsucc\", true); // unicode-math maps \\u22e1 to \\nsucccurlyeq. We'll use the AMS synonym.\n\ndefineSymbol(math, ams, rel, \"\\u22e1\", \"\\\\nsucceq\", true);\ndefineSymbol(math, ams, rel, \"\\u22e9\", \"\\\\succnsim\", true);\ndefineSymbol(math, ams, rel, \"\\u2aba\", \"\\\\succnapprox\", true); // unicode-math maps \\u2246 to \\simneqq. We'll use the AMS synonym.\n\ndefineSymbol(math, ams, rel, \"\\u2246\", \"\\\\ncong\", true);\ndefineSymbol(math, ams, rel, \"\\ue007\", \"\\\\@nshortparallel\");\ndefineSymbol(math, ams, rel, \"\\u2226\", \"\\\\nparallel\", true);\ndefineSymbol(math, ams, rel, \"\\u22af\", \"\\\\nVDash\", true);\ndefineSymbol(math, ams, rel, \"\\u22eb\", \"\\\\ntriangleright\");\ndefineSymbol(math, ams, rel, \"\\u22ed\", \"\\\\ntrianglerighteq\", true);\ndefineSymbol(math, ams, rel, \"\\ue018\", \"\\\\@nsupseteqq\");\ndefineSymbol(math, ams, rel, \"\\u228b\", \"\\\\supsetneq\", true);\ndefineSymbol(math, ams, rel, \"\\ue01b\", \"\\\\@varsupsetneq\");\ndefineSymbol(math, ams, rel, \"\\u2acc\", \"\\\\supsetneqq\", true);\ndefineSymbol(math, ams, rel, \"\\ue019\", \"\\\\@varsupsetneqq\");\ndefineSymbol(math, ams, rel, \"\\u22ae\", \"\\\\nVdash\", true);\ndefineSymbol(math, ams, rel, \"\\u2ab5\", \"\\\\precneqq\", true);\ndefineSymbol(math, ams, rel, \"\\u2ab6\", \"\\\\succneqq\", true);\ndefineSymbol(math, ams, rel, \"\\ue016\", \"\\\\@nsubseteqq\");\ndefineSymbol(math, ams, bin, \"\\u22b4\", \"\\\\unlhd\");\ndefineSymbol(math, ams, bin, \"\\u22b5\", \"\\\\unrhd\"); // AMS Negated Arrows\n\ndefineSymbol(math, ams, rel, \"\\u219a\", \"\\\\nleftarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u219b\", \"\\\\nrightarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21cd\", \"\\\\nLeftarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21cf\", \"\\\\nRightarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21ae\", \"\\\\nleftrightarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21ce\", \"\\\\nLeftrightarrow\", true); // AMS Misc\n\ndefineSymbol(math, ams, rel, \"\\u25b3\", \"\\\\vartriangle\");\ndefineSymbol(math, ams, textord, \"\\u210f\", \"\\\\hslash\");\ndefineSymbol(math, ams, textord, \"\\u25bd\", \"\\\\triangledown\");\ndefineSymbol(math, ams, textord, \"\\u25ca\", \"\\\\lozenge\");\ndefineSymbol(math, ams, textord, \"\\u24c8\", \"\\\\circledS\");\ndefineSymbol(math, ams, textord, \"\\u00ae\", \"\\\\circledR\");\ndefineSymbol(text, ams, textord, \"\\u00ae\", \"\\\\circledR\");\ndefineSymbol(math, ams, textord, \"\\u2221\", \"\\\\measuredangle\", true);\ndefineSymbol(math, ams, textord, \"\\u2204\", \"\\\\nexists\");\ndefineSymbol(math, ams, textord, \"\\u2127\", \"\\\\mho\");\ndefineSymbol(math, ams, textord, \"\\u2132\", \"\\\\Finv\", true);\ndefineSymbol(math, ams, textord, \"\\u2141\", \"\\\\Game\", true);\ndefineSymbol(math, ams, textord, \"\\u2035\", \"\\\\backprime\");\ndefineSymbol(math, ams, textord, \"\\u25b2\", \"\\\\blacktriangle\");\ndefineSymbol(math, ams, textord, \"\\u25bc\", \"\\\\blacktriangledown\");\ndefineSymbol(math, ams, textord, \"\\u25a0\", \"\\\\blacksquare\");\ndefineSymbol(math, ams, textord, \"\\u29eb\", \"\\\\blacklozenge\");\ndefineSymbol(math, ams, textord, \"\\u2605\", \"\\\\bigstar\");\ndefineSymbol(math, ams, textord, \"\\u2222\", \"\\\\sphericalangle\", true);\ndefineSymbol(math, ams, textord, \"\\u2201\", \"\\\\complement\", true); // unicode-math maps U+F0 to \\matheth. We map to AMS function \\eth\n\ndefineSymbol(math, ams, textord, \"\\u00f0\", \"\\\\eth\", true);\ndefineSymbol(text, main, textord, \"\\u00f0\", \"\\u00f0\");\ndefineSymbol(math, ams, textord, \"\\u2571\", \"\\\\diagup\");\ndefineSymbol(math, ams, textord, \"\\u2572\", \"\\\\diagdown\");\ndefineSymbol(math, ams, textord, \"\\u25a1\", \"\\\\square\");\ndefineSymbol(math, ams, textord, \"\\u25a1\", \"\\\\Box\");\ndefineSymbol(math, ams, textord, \"\\u25ca\", \"\\\\Diamond\"); // unicode-math maps U+A5 to \\mathyen. We map to AMS function \\yen\n\ndefineSymbol(math, ams, textord, \"\\u00a5\", \"\\\\yen\", true);\ndefineSymbol(text, ams, textord, \"\\u00a5\", \"\\\\yen\", true);\ndefineSymbol(math, ams, textord, \"\\u2713\", \"\\\\checkmark\", true);\ndefineSymbol(text, ams, textord, \"\\u2713\", \"\\\\checkmark\"); // AMS Hebrew\n\ndefineSymbol(math, ams, textord, \"\\u2136\", \"\\\\beth\", true);\ndefineSymbol(math, ams, textord, \"\\u2138\", \"\\\\daleth\", true);\ndefineSymbol(math, ams, textord, \"\\u2137\", \"\\\\gimel\", true); // AMS Greek\n\ndefineSymbol(math, ams, textord, \"\\u03dd\", \"\\\\digamma\", true);\ndefineSymbol(math, ams, textord, \"\\u03f0\", \"\\\\varkappa\"); // AMS Delimiters\n\ndefineSymbol(math, ams, open, \"\\u250c\", \"\\\\@ulcorner\", true);\ndefineSymbol(math, ams, close, \"\\u2510\", \"\\\\@urcorner\", true);\ndefineSymbol(math, ams, open, \"\\u2514\", \"\\\\@llcorner\", true);\ndefineSymbol(math, ams, close, \"\\u2518\", \"\\\\@lrcorner\", true); // AMS Binary Relations\n\ndefineSymbol(math, ams, rel, \"\\u2266\", \"\\\\leqq\", true);\ndefineSymbol(math, ams, rel, \"\\u2a7d\", \"\\\\leqslant\", true);\ndefineSymbol(math, ams, rel, \"\\u2a95\", \"\\\\eqslantless\", true);\ndefineSymbol(math, ams, rel, \"\\u2272\", \"\\\\lesssim\", true);\ndefineSymbol(math, ams, rel, \"\\u2a85\", \"\\\\lessapprox\", true);\ndefineSymbol(math, ams, rel, \"\\u224a\", \"\\\\approxeq\", true);\ndefineSymbol(math, ams, bin, \"\\u22d6\", \"\\\\lessdot\");\ndefineSymbol(math, ams, rel, \"\\u22d8\", \"\\\\lll\", true);\ndefineSymbol(math, ams, rel, \"\\u2276\", \"\\\\lessgtr\", true);\ndefineSymbol(math, ams, rel, \"\\u22da\", \"\\\\lesseqgtr\", true);\ndefineSymbol(math, ams, rel, \"\\u2a8b\", \"\\\\lesseqqgtr\", true);\ndefineSymbol(math, ams, rel, \"\\u2251\", \"\\\\doteqdot\");\ndefineSymbol(math, ams, rel, \"\\u2253\", \"\\\\risingdotseq\", true);\ndefineSymbol(math, ams, rel, \"\\u2252\", \"\\\\fallingdotseq\", true);\ndefineSymbol(math, ams, rel, \"\\u223d\", \"\\\\backsim\", true);\ndefineSymbol(math, ams, rel, \"\\u22cd\", \"\\\\backsimeq\", true);\ndefineSymbol(math, ams, rel, \"\\u2ac5\", \"\\\\subseteqq\", true);\ndefineSymbol(math, ams, rel, \"\\u22d0\", \"\\\\Subset\", true);\ndefineSymbol(math, ams, rel, \"\\u228f\", \"\\\\sqsubset\", true);\ndefineSymbol(math, ams, rel, \"\\u227c\", \"\\\\preccurlyeq\", true);\ndefineSymbol(math, ams, rel, \"\\u22de\", \"\\\\curlyeqprec\", true);\ndefineSymbol(math, ams, rel, \"\\u227e\", \"\\\\precsim\", true);\ndefineSymbol(math, ams, rel, \"\\u2ab7\", \"\\\\precapprox\", true);\ndefineSymbol(math, ams, rel, \"\\u22b2\", \"\\\\vartriangleleft\");\ndefineSymbol(math, ams, rel, \"\\u22b4\", \"\\\\trianglelefteq\");\ndefineSymbol(math, ams, rel, \"\\u22a8\", \"\\\\vDash\", true);\ndefineSymbol(math, ams, rel, \"\\u22aa\", \"\\\\Vvdash\", true);\ndefineSymbol(math, ams, rel, \"\\u2323\", \"\\\\smallsmile\");\ndefineSymbol(math, ams, rel, \"\\u2322\", \"\\\\smallfrown\");\ndefineSymbol(math, ams, rel, \"\\u224f\", \"\\\\bumpeq\", true);\ndefineSymbol(math, ams, rel, \"\\u224e\", \"\\\\Bumpeq\", true);\ndefineSymbol(math, ams, rel, \"\\u2267\", \"\\\\geqq\", true);\ndefineSymbol(math, ams, rel, \"\\u2a7e\", \"\\\\geqslant\", true);\ndefineSymbol(math, ams, rel, \"\\u2a96\", \"\\\\eqslantgtr\", true);\ndefineSymbol(math, ams, rel, \"\\u2273\", \"\\\\gtrsim\", true);\ndefineSymbol(math, ams, rel, \"\\u2a86\", \"\\\\gtrapprox\", true);\ndefineSymbol(math, ams, bin, \"\\u22d7\", \"\\\\gtrdot\");\ndefineSymbol(math, ams, rel, \"\\u22d9\", \"\\\\ggg\", true);\ndefineSymbol(math, ams, rel, \"\\u2277\", \"\\\\gtrless\", true);\ndefineSymbol(math, ams, rel, \"\\u22db\", \"\\\\gtreqless\", true);\ndefineSymbol(math, ams, rel, \"\\u2a8c\", \"\\\\gtreqqless\", true);\ndefineSymbol(math, ams, rel, \"\\u2256\", \"\\\\eqcirc\", true);\ndefineSymbol(math, ams, rel, \"\\u2257\", \"\\\\circeq\", true);\ndefineSymbol(math, ams, rel, \"\\u225c\", \"\\\\triangleq\", true);\ndefineSymbol(math, ams, rel, \"\\u223c\", \"\\\\thicksim\");\ndefineSymbol(math, ams, rel, \"\\u2248\", \"\\\\thickapprox\");\ndefineSymbol(math, ams, rel, \"\\u2ac6\", \"\\\\supseteqq\", true);\ndefineSymbol(math, ams, rel, \"\\u22d1\", \"\\\\Supset\", true);\ndefineSymbol(math, ams, rel, \"\\u2290\", \"\\\\sqsupset\", true);\ndefineSymbol(math, ams, rel, \"\\u227d\", \"\\\\succcurlyeq\", true);\ndefineSymbol(math, ams, rel, \"\\u22df\", \"\\\\curlyeqsucc\", true);\ndefineSymbol(math, ams, rel, \"\\u227f\", \"\\\\succsim\", true);\ndefineSymbol(math, ams, rel, \"\\u2ab8\", \"\\\\succapprox\", true);\ndefineSymbol(math, ams, rel, \"\\u22b3\", \"\\\\vartriangleright\");\ndefineSymbol(math, ams, rel, \"\\u22b5\", \"\\\\trianglerighteq\");\ndefineSymbol(math, ams, rel, \"\\u22a9\", \"\\\\Vdash\", true);\ndefineSymbol(math, ams, rel, \"\\u2223\", \"\\\\shortmid\");\ndefineSymbol(math, ams, rel, \"\\u2225\", \"\\\\shortparallel\");\ndefineSymbol(math, ams, rel, \"\\u226c\", \"\\\\between\", true);\ndefineSymbol(math, ams, rel, \"\\u22d4\", \"\\\\pitchfork\", true);\ndefineSymbol(math, ams, rel, \"\\u221d\", \"\\\\varpropto\");\ndefineSymbol(math, ams, rel, \"\\u25c0\", \"\\\\blacktriangleleft\"); // unicode-math says that \\therefore is a mathord atom.\n// We kept the amssymb atom type, which is rel.\n\ndefineSymbol(math, ams, rel, \"\\u2234\", \"\\\\therefore\", true);\ndefineSymbol(math, ams, rel, \"\\u220d\", \"\\\\backepsilon\");\ndefineSymbol(math, ams, rel, \"\\u25b6\", \"\\\\blacktriangleright\"); // unicode-math says that \\because is a mathord atom.\n// We kept the amssymb atom type, which is rel.\n\ndefineSymbol(math, ams, rel, \"\\u2235\", \"\\\\because\", true);\ndefineSymbol(math, ams, rel, \"\\u22d8\", \"\\\\llless\");\ndefineSymbol(math, ams, rel, \"\\u22d9\", \"\\\\gggtr\");\ndefineSymbol(math, ams, bin, \"\\u22b2\", \"\\\\lhd\");\ndefineSymbol(math, ams, bin, \"\\u22b3\", \"\\\\rhd\");\ndefineSymbol(math, ams, rel, \"\\u2242\", \"\\\\eqsim\", true);\ndefineSymbol(math, main, rel, \"\\u22c8\", \"\\\\Join\");\ndefineSymbol(math, ams, rel, \"\\u2251\", \"\\\\Doteq\", true); // AMS Binary Operators\n\ndefineSymbol(math, ams, bin, \"\\u2214\", \"\\\\dotplus\", true);\ndefineSymbol(math, ams, bin, \"\\u2216\", \"\\\\smallsetminus\");\ndefineSymbol(math, ams, bin, \"\\u22d2\", \"\\\\Cap\", true);\ndefineSymbol(math, ams, bin, \"\\u22d3\", \"\\\\Cup\", true);\ndefineSymbol(math, ams, bin, \"\\u2a5e\", \"\\\\doublebarwedge\", true);\ndefineSymbol(math, ams, bin, \"\\u229f\", \"\\\\boxminus\", true);\ndefineSymbol(math, ams, bin, \"\\u229e\", \"\\\\boxplus\", true);\ndefineSymbol(math, ams, bin, \"\\u22c7\", \"\\\\divideontimes\", true);\ndefineSymbol(math, ams, bin, \"\\u22c9\", \"\\\\ltimes\", true);\ndefineSymbol(math, ams, bin, \"\\u22ca\", \"\\\\rtimes\", true);\ndefineSymbol(math, ams, bin, \"\\u22cb\", \"\\\\leftthreetimes\", true);\ndefineSymbol(math, ams, bin, \"\\u22cc\", \"\\\\rightthreetimes\", true);\ndefineSymbol(math, ams, bin, \"\\u22cf\", \"\\\\curlywedge\", true);\ndefineSymbol(math, ams, bin, \"\\u22ce\", \"\\\\curlyvee\", true);\ndefineSymbol(math, ams, bin, \"\\u229d\", \"\\\\circleddash\", true);\ndefineSymbol(math, ams, bin, \"\\u229b\", \"\\\\circledast\", true);\ndefineSymbol(math, ams, bin, \"\\u22c5\", \"\\\\centerdot\");\ndefineSymbol(math, ams, bin, \"\\u22ba\", \"\\\\intercal\", true);\ndefineSymbol(math, ams, bin, \"\\u22d2\", \"\\\\doublecap\");\ndefineSymbol(math, ams, bin, \"\\u22d3\", \"\\\\doublecup\");\ndefineSymbol(math, ams, bin, \"\\u22a0\", \"\\\\boxtimes\", true); // AMS Arrows\n// Note: unicode-math maps \\u21e2 to their own function \\rightdasharrow.\n// We'll map it to AMS function \\dashrightarrow. It produces the same atom.\n\ndefineSymbol(math, ams, rel, \"\\u21e2\", \"\\\\dashrightarrow\", true); // unicode-math maps \\u21e0 to \\leftdasharrow. We'll use the AMS synonym.\n\ndefineSymbol(math, ams, rel, \"\\u21e0\", \"\\\\dashleftarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21c7\", \"\\\\leftleftarrows\", true);\ndefineSymbol(math, ams, rel, \"\\u21c6\", \"\\\\leftrightarrows\", true);\ndefineSymbol(math, ams, rel, \"\\u21da\", \"\\\\Lleftarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u219e\", \"\\\\twoheadleftarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21a2\", \"\\\\leftarrowtail\", true);\ndefineSymbol(math, ams, rel, \"\\u21ab\", \"\\\\looparrowleft\", true);\ndefineSymbol(math, ams, rel, \"\\u21cb\", \"\\\\leftrightharpoons\", true);\ndefineSymbol(math, ams, rel, \"\\u21b6\", \"\\\\curvearrowleft\", true); // unicode-math maps \\u21ba to \\acwopencirclearrow. We'll use the AMS synonym.\n\ndefineSymbol(math, ams, rel, \"\\u21ba\", \"\\\\circlearrowleft\", true);\ndefineSymbol(math, ams, rel, \"\\u21b0\", \"\\\\Lsh\", true);\ndefineSymbol(math, ams, rel, \"\\u21c8\", \"\\\\upuparrows\", true);\ndefineSymbol(math, ams, rel, \"\\u21bf\", \"\\\\upharpoonleft\", true);\ndefineSymbol(math, ams, rel, \"\\u21c3\", \"\\\\downharpoonleft\", true);\ndefineSymbol(math, main, rel, \"\\u22b6\", \"\\\\origof\", true); // not in font\n\ndefineSymbol(math, main, rel, \"\\u22b7\", \"\\\\imageof\", true); // not in font\n\ndefineSymbol(math, ams, rel, \"\\u22b8\", \"\\\\multimap\", true);\ndefineSymbol(math, ams, rel, \"\\u21ad\", \"\\\\leftrightsquigarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21c9\", \"\\\\rightrightarrows\", true);\ndefineSymbol(math, ams, rel, \"\\u21c4\", \"\\\\rightleftarrows\", true);\ndefineSymbol(math, ams, rel, \"\\u21a0\", \"\\\\twoheadrightarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21a3\", \"\\\\rightarrowtail\", true);\ndefineSymbol(math, ams, rel, \"\\u21ac\", \"\\\\looparrowright\", true);\ndefineSymbol(math, ams, rel, \"\\u21b7\", \"\\\\curvearrowright\", true); // unicode-math maps \\u21bb to \\cwopencirclearrow. We'll use the AMS synonym.\n\ndefineSymbol(math, ams, rel, \"\\u21bb\", \"\\\\circlearrowright\", true);\ndefineSymbol(math, ams, rel, \"\\u21b1\", \"\\\\Rsh\", true);\ndefineSymbol(math, ams, rel, \"\\u21ca\", \"\\\\downdownarrows\", true);\ndefineSymbol(math, ams, rel, \"\\u21be\", \"\\\\upharpoonright\", true);\ndefineSymbol(math, ams, rel, \"\\u21c2\", \"\\\\downharpoonright\", true);\ndefineSymbol(math, ams, rel, \"\\u21dd\", \"\\\\rightsquigarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21dd\", \"\\\\leadsto\");\ndefineSymbol(math, ams, rel, \"\\u21db\", \"\\\\Rrightarrow\", true);\ndefineSymbol(math, ams, rel, \"\\u21be\", \"\\\\restriction\");\ndefineSymbol(math, main, textord, \"\\u2018\", \"`\");\ndefineSymbol(math, main, textord, \"$\", \"\\\\$\");\ndefineSymbol(text, main, textord, \"$\", \"\\\\$\");\ndefineSymbol(text, main, textord, \"$\", \"\\\\textdollar\");\ndefineSymbol(math, main, textord, \"%\", \"\\\\%\");\ndefineSymbol(text, main, textord, \"%\", \"\\\\%\");\ndefineSymbol(math, main, textord, \"_\", \"\\\\_\");\ndefineSymbol(text, main, textord, \"_\", \"\\\\_\");\ndefineSymbol(text, main, textord, \"_\", \"\\\\textunderscore\");\ndefineSymbol(math, main, textord, \"\\u2220\", \"\\\\angle\", true);\ndefineSymbol(math, main, textord, \"\\u221e\", \"\\\\infty\", true);\ndefineSymbol(math, main, textord, \"\\u2032\", \"\\\\prime\");\ndefineSymbol(math, main, textord, \"\\u25b3\", \"\\\\triangle\");\ndefineSymbol(math, main, textord, \"\\u0393\", \"\\\\Gamma\", true);\ndefineSymbol(math, main, textord, \"\\u0394\", \"\\\\Delta\", true);\ndefineSymbol(math, main, textord, \"\\u0398\", \"\\\\Theta\", true);\ndefineSymbol(math, main, textord, \"\\u039b\", \"\\\\Lambda\", true);\ndefineSymbol(math, main, textord, \"\\u039e\", \"\\\\Xi\", true);\ndefineSymbol(math, main, textord, \"\\u03a0\", \"\\\\Pi\", true);\ndefineSymbol(math, main, textord, \"\\u03a3\", \"\\\\Sigma\", true);\ndefineSymbol(math, main, textord, \"\\u03a5\", \"\\\\Upsilon\", true);\ndefineSymbol(math, main, textord, \"\\u03a6\", \"\\\\Phi\", true);\ndefineSymbol(math, main, textord, \"\\u03a8\", \"\\\\Psi\", true);\ndefineSymbol(math, main, textord, \"\\u03a9\", \"\\\\Omega\", true);\ndefineSymbol(math, main, textord, \"A\", \"\\u0391\");\ndefineSymbol(math, main, textord, \"B\", \"\\u0392\");\ndefineSymbol(math, main, textord, \"E\", \"\\u0395\");\ndefineSymbol(math, main, textord, \"Z\", \"\\u0396\");\ndefineSymbol(math, main, textord, \"H\", \"\\u0397\");\ndefineSymbol(math, main, textord, \"I\", \"\\u0399\");\ndefineSymbol(math, main, textord, \"K\", \"\\u039A\");\ndefineSymbol(math, main, textord, \"M\", \"\\u039C\");\ndefineSymbol(math, main, textord, \"N\", \"\\u039D\");\ndefineSymbol(math, main, textord, \"O\", \"\\u039F\");\ndefineSymbol(math, main, textord, \"P\", \"\\u03A1\");\ndefineSymbol(math, main, textord, \"T\", \"\\u03A4\");\ndefineSymbol(math, main, textord, \"X\", \"\\u03A7\");\ndefineSymbol(math, main, textord, \"\\u00ac\", \"\\\\neg\", true);\ndefineSymbol(math, main, textord, \"\\u00ac\", \"\\\\lnot\");\ndefineSymbol(math, main, textord, \"\\u22a4\", \"\\\\top\");\ndefineSymbol(math, main, textord, \"\\u22a5\", \"\\\\bot\");\ndefineSymbol(math, main, textord, \"\\u2205\", \"\\\\emptyset\");\ndefineSymbol(math, ams, textord, \"\\u2205\", \"\\\\varnothing\");\ndefineSymbol(math, main, mathord, \"\\u03b1\", \"\\\\alpha\", true);\ndefineSymbol(math, main, mathord, \"\\u03b2\", \"\\\\beta\", true);\ndefineSymbol(math, main, mathord, \"\\u03b3\", \"\\\\gamma\", true);\ndefineSymbol(math, main, mathord, \"\\u03b4\", \"\\\\delta\", true);\ndefineSymbol(math, main, mathord, \"\\u03f5\", \"\\\\epsilon\", true);\ndefineSymbol(math, main, mathord, \"\\u03b6\", \"\\\\zeta\", true);\ndefineSymbol(math, main, mathord, \"\\u03b7\", \"\\\\eta\", true);\ndefineSymbol(math, main, mathord, \"\\u03b8\", \"\\\\theta\", true);\ndefineSymbol(math, main, mathord, \"\\u03b9\", \"\\\\iota\", true);\ndefineSymbol(math, main, mathord, \"\\u03ba\", \"\\\\kappa\", true);\ndefineSymbol(math, main, mathord, \"\\u03bb\", \"\\\\lambda\", true);\ndefineSymbol(math, main, mathord, \"\\u03bc\", \"\\\\mu\", true);\ndefineSymbol(math, main, mathord, \"\\u03bd\", \"\\\\nu\", true);\ndefineSymbol(math, main, mathord, \"\\u03be\", \"\\\\xi\", true);\ndefineSymbol(math, main, mathord, \"\\u03bf\", \"\\\\omicron\", true);\ndefineSymbol(math, main, mathord, \"\\u03c0\", \"\\\\pi\", true);\ndefineSymbol(math, main, mathord, \"\\u03c1\", \"\\\\rho\", true);\ndefineSymbol(math, main, mathord, \"\\u03c3\", \"\\\\sigma\", true);\ndefineSymbol(math, main, mathord, \"\\u03c4\", \"\\\\tau\", true);\ndefineSymbol(math, main, mathord, \"\\u03c5\", \"\\\\upsilon\", true);\ndefineSymbol(math, main, mathord, \"\\u03d5\", \"\\\\phi\", true);\ndefineSymbol(math, main, mathord, \"\\u03c7\", \"\\\\chi\", true);\ndefineSymbol(math, main, mathord, \"\\u03c8\", \"\\\\psi\", true);\ndefineSymbol(math, main, mathord, \"\\u03c9\", \"\\\\omega\", true);\ndefineSymbol(math, main, mathord, \"\\u03b5\", \"\\\\varepsilon\", true);\ndefineSymbol(math, main, mathord, \"\\u03d1\", \"\\\\vartheta\", true);\ndefineSymbol(math, main, mathord, \"\\u03d6\", \"\\\\varpi\", true);\ndefineSymbol(math, main, mathord, \"\\u03f1\", \"\\\\varrho\", true);\ndefineSymbol(math, main, mathord, \"\\u03c2\", \"\\\\varsigma\", true);\ndefineSymbol(math, main, mathord, \"\\u03c6\", \"\\\\varphi\", true);\ndefineSymbol(math, main, bin, \"\\u2217\", \"*\", true);\ndefineSymbol(math, main, bin, \"+\", \"+\");\ndefineSymbol(math, main, bin, \"\\u2212\", \"-\", true);\ndefineSymbol(math, main, bin, \"\\u22c5\", \"\\\\cdot\", true);\ndefineSymbol(math, main, bin, \"\\u2218\", \"\\\\circ\", true);\ndefineSymbol(math, main, bin, \"\\u00f7\", \"\\\\div\", true);\ndefineSymbol(math, main, bin, \"\\u00b1\", \"\\\\pm\", true);\ndefineSymbol(math, main, bin, \"\\u00d7\", \"\\\\times\", true);\ndefineSymbol(math, main, bin, \"\\u2229\", \"\\\\cap\", true);\ndefineSymbol(math, main, bin, \"\\u222a\", \"\\\\cup\", true);\ndefineSymbol(math, main, bin, \"\\u2216\", \"\\\\setminus\", true);\ndefineSymbol(math, main, bin, \"\\u2227\", \"\\\\land\");\ndefineSymbol(math, main, bin, \"\\u2228\", \"\\\\lor\");\ndefineSymbol(math, main, bin, \"\\u2227\", \"\\\\wedge\", true);\ndefineSymbol(math, main, bin, \"\\u2228\", \"\\\\vee\", true);\ndefineSymbol(math, main, textord, \"\\u221a\", \"\\\\surd\");\ndefineSymbol(math, main, open, \"\\u27e8\", \"\\\\langle\", true);\ndefineSymbol(math, main, open, \"\\u2223\", \"\\\\lvert\");\ndefineSymbol(math, main, open, \"\\u2225\", \"\\\\lVert\");\ndefineSymbol(math, main, close, \"?\", \"?\");\ndefineSymbol(math, main, close, \"!\", \"!\");\ndefineSymbol(math, main, close, \"\\u27e9\", \"\\\\rangle\", true);\ndefineSymbol(math, main, close, \"\\u2223\", \"\\\\rvert\");\ndefineSymbol(math, main, close, \"\\u2225\", \"\\\\rVert\");\ndefineSymbol(math, main, rel, \"=\", \"=\");\ndefineSymbol(math, main, rel, \":\", \":\");\ndefineSymbol(math, main, rel, \"\\u2248\", \"\\\\approx\", true);\ndefineSymbol(math, main, rel, \"\\u2245\", \"\\\\cong\", true);\ndefineSymbol(math, main, rel, \"\\u2265\", \"\\\\ge\");\ndefineSymbol(math, main, rel, \"\\u2265\", \"\\\\geq\", true);\ndefineSymbol(math, main, rel, \"\\u2190\", \"\\\\gets\");\ndefineSymbol(math, main, rel, \">\", \"\\\\gt\", true);\ndefineSymbol(math, main, rel, \"\\u2208\", \"\\\\in\", true);\ndefineSymbol(math, main, rel, \"\\ue020\", \"\\\\@not\");\ndefineSymbol(math, main, rel, \"\\u2282\", \"\\\\subset\", true);\ndefineSymbol(math, main, rel, \"\\u2283\", \"\\\\supset\", true);\ndefineSymbol(math, main, rel, \"\\u2286\", \"\\\\subseteq\", true);\ndefineSymbol(math, main, rel, \"\\u2287\", \"\\\\supseteq\", true);\ndefineSymbol(math, ams, rel, \"\\u2288\", \"\\\\nsubseteq\", true);\ndefineSymbol(math, ams, rel, \"\\u2289\", \"\\\\nsupseteq\", true);\ndefineSymbol(math, main, rel, \"\\u22a8\", \"\\\\models\");\ndefineSymbol(math, main, rel, \"\\u2190\", \"\\\\leftarrow\", true);\ndefineSymbol(math, main, rel, \"\\u2264\", \"\\\\le\");\ndefineSymbol(math, main, rel, \"\\u2264\", \"\\\\leq\", true);\ndefineSymbol(math, main, rel, \"<\", \"\\\\lt\", true);\ndefineSymbol(math, main, rel, \"\\u2192\", \"\\\\rightarrow\", true);\ndefineSymbol(math, main, rel, \"\\u2192\", \"\\\\to\");\ndefineSymbol(math, ams, rel, \"\\u2271\", \"\\\\ngeq\", true);\ndefineSymbol(math, ams, rel, \"\\u2270\", \"\\\\nleq\", true);\ndefineSymbol(math, main, spacing, \"\\u00a0\", \"\\\\ \");\ndefineSymbol(math, main, spacing, \"\\u00a0\", \"\\\\space\"); // Ref: LaTeX Source 2e: \\DeclareRobustCommand{\\nobreakspace}{%\n\ndefineSymbol(math, main, spacing, \"\\u00a0\", \"\\\\nobreakspace\");\ndefineSymbol(text, main, spacing, \"\\u00a0\", \"\\\\ \");\ndefineSymbol(text, main, spacing, \"\\u00a0\", \" \");\ndefineSymbol(text, main, spacing, \"\\u00a0\", \"\\\\space\");\ndefineSymbol(text, main, spacing, \"\\u00a0\", \"\\\\nobreakspace\");\ndefineSymbol(math, main, spacing, null, \"\\\\nobreak\");\ndefineSymbol(math, main, spacing, null, \"\\\\allowbreak\");\ndefineSymbol(math, main, punct, \",\", \",\");\ndefineSymbol(math, main, punct, \";\", \";\");\ndefineSymbol(math, ams, bin, \"\\u22bc\", \"\\\\barwedge\", true);\ndefineSymbol(math, ams, bin, \"\\u22bb\", \"\\\\veebar\", true);\ndefineSymbol(math, main, bin, \"\\u2299\", \"\\\\odot\", true);\ndefineSymbol(math, main, bin, \"\\u2295\", \"\\\\oplus\", true);\ndefineSymbol(math, main, bin, \"\\u2297\", \"\\\\otimes\", true);\ndefineSymbol(math, main, textord, \"\\u2202\", \"\\\\partial\", true);\ndefineSymbol(math, main, bin, \"\\u2298\", \"\\\\oslash\", true);\ndefineSymbol(math, ams, bin, \"\\u229a\", \"\\\\circledcirc\", true);\ndefineSymbol(math, ams, bin, \"\\u22a1\", \"\\\\boxdot\", true);\ndefineSymbol(math, main, bin, \"\\u25b3\", \"\\\\bigtriangleup\");\ndefineSymbol(math, main, bin, \"\\u25bd\", \"\\\\bigtriangledown\");\ndefineSymbol(math, main, bin, \"\\u2020\", \"\\\\dagger\");\ndefineSymbol(math, main, bin, \"\\u22c4\", \"\\\\diamond\");\ndefineSymbol(math, main, bin, \"\\u22c6\", \"\\\\star\");\ndefineSymbol(math, main, bin, \"\\u25c3\", \"\\\\triangleleft\");\ndefineSymbol(math, main, bin, \"\\u25b9\", \"\\\\triangleright\");\ndefineSymbol(math, main, open, \"{\", \"\\\\{\");\ndefineSymbol(text, main, textord, \"{\", \"\\\\{\");\ndefineSymbol(text, main, textord, \"{\", \"\\\\textbraceleft\");\ndefineSymbol(math, main, close, \"}\", \"\\\\}\");\ndefineSymbol(text, main, textord, \"}\", \"\\\\}\");\ndefineSymbol(text, main, textord, \"}\", \"\\\\textbraceright\");\ndefineSymbol(math, main, open, \"{\", \"\\\\lbrace\");\ndefineSymbol(math, main, close, \"}\", \"\\\\rbrace\");\ndefineSymbol(math, main, open, \"[\", \"\\\\lbrack\", true);\ndefineSymbol(text, main, textord, \"[\", \"\\\\lbrack\", true);\ndefineSymbol(math, main, close, \"]\", \"\\\\rbrack\", true);\ndefineSymbol(text, main, textord, \"]\", \"\\\\rbrack\", true);\ndefineSymbol(math, main, open, \"(\", \"\\\\lparen\", true);\ndefineSymbol(math, main, close, \")\", \"\\\\rparen\", true);\ndefineSymbol(text, main, textord, \"<\", \"\\\\textless\", true); // in T1 fontenc\n\ndefineSymbol(text, main, textord, \">\", \"\\\\textgreater\", true); // in T1 fontenc\n\ndefineSymbol(math, main, open, \"\\u230a\", \"\\\\lfloor\", true);\ndefineSymbol(math, main, close, \"\\u230b\", \"\\\\rfloor\", true);\ndefineSymbol(math, main, open, \"\\u2308\", \"\\\\lceil\", true);\ndefineSymbol(math, main, close, \"\\u2309\", \"\\\\rceil\", true);\ndefineSymbol(math, main, textord, \"\\\\\", \"\\\\backslash\");\ndefineSymbol(math, main, textord, \"\\u2223\", \"|\");\ndefineSymbol(math, main, textord, \"\\u2223\", \"\\\\vert\");\ndefineSymbol(text, main, textord, \"|\", \"\\\\textbar\", true); // in T1 fontenc\n\ndefineSymbol(math, main, textord, \"\\u2225\", \"\\\\|\");\ndefineSymbol(math, main, textord, \"\\u2225\", \"\\\\Vert\");\ndefineSymbol(text, main, textord, \"\\u2225\", \"\\\\textbardbl\");\ndefineSymbol(text, main, textord, \"~\", \"\\\\textasciitilde\");\ndefineSymbol(text, main, textord, \"\\\\\", \"\\\\textbackslash\");\ndefineSymbol(text, main, textord, \"^\", \"\\\\textasciicircum\");\ndefineSymbol(math, main, rel, \"\\u2191\", \"\\\\uparrow\", true);\ndefineSymbol(math, main, rel, \"\\u21d1\", \"\\\\Uparrow\", true);\ndefineSymbol(math, main, rel, \"\\u2193\", \"\\\\downarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21d3\", \"\\\\Downarrow\", true);\ndefineSymbol(math, main, rel, \"\\u2195\", \"\\\\updownarrow\", true);\ndefineSymbol(math, main, rel, \"\\u21d5\", \"\\\\Updownarrow\", true);\ndefineSymbol(math, main, op, \"\\u2210\", \"\\\\coprod\");\ndefineSymbol(math, main, op, \"\\u22c1\", \"\\\\bigvee\");\ndefineSymbol(math, main, op, \"\\u22c0\", \"\\\\bigwedge\");\ndefineSymbol(math, main, op, \"\\u2a04\", \"\\\\biguplus\");\ndefineSymbol(math, main, op, \"\\u22c2\", \"\\\\bigcap\");\ndefineSymbol(math, main, op, \"\\u22c3\", \"\\\\bigcup\");\ndefineSymbol(math, main, op, \"\\u222b\", \"\\\\int\");\ndefineSymbol(math, main, op, \"\\u222b\", \"\\\\intop\");\ndefineSymbol(math, main, op, \"\\u222c\", \"\\\\iint\");\ndefineSymbol(math, main, op, \"\\u222d\", \"\\\\iiint\");\ndefineSymbol(math, main, op, \"\\u220f\", \"\\\\prod\");\ndefineSymbol(math, main, op, \"\\u2211\", \"\\\\sum\");\ndefineSymbol(math, main, op, \"\\u2a02\", \"\\\\bigotimes\");\ndefineSymbol(math, main, op, \"\\u2a01\", \"\\\\bigoplus\");\ndefineSymbol(math, main, op, \"\\u2a00\", \"\\\\bigodot\");\ndefineSymbol(math, main, op, \"\\u222e\", \"\\\\oint\");\ndefineSymbol(math, main, op, \"\\u222f\", \"\\\\oiint\");\ndefineSymbol(math, main, op, \"\\u2230\", \"\\\\oiiint\");\ndefineSymbol(math, main, op, \"\\u2a06\", \"\\\\bigsqcup\");\ndefineSymbol(math, main, op, \"\\u222b\", \"\\\\smallint\");\ndefineSymbol(text, main, inner, \"\\u2026\", \"\\\\textellipsis\");\ndefineSymbol(math, main, inner, \"\\u2026\", \"\\\\mathellipsis\");\ndefineSymbol(text, main, inner, \"\\u2026\", \"\\\\ldots\", true);\ndefineSymbol(math, main, inner, \"\\u2026\", \"\\\\ldots\", true);\ndefineSymbol(math, main, inner, \"\\u22ef\", \"\\\\@cdots\", true);\ndefineSymbol(math, main, inner, \"\\u22f1\", \"\\\\ddots\", true); // \\vdots is a macro that uses one of these two symbols (with made-up names):\n\ndefineSymbol(math, main, textord, \"\\u22ee\", \"\\\\varvdots\");\ndefineSymbol(text, main, textord, \"\\u22ee\", \"\\\\varvdots\");\ndefineSymbol(math, main, accent, \"\\u02ca\", \"\\\\acute\");\ndefineSymbol(math, main, accent, \"\\u02cb\", \"\\\\grave\");\ndefineSymbol(math, main, accent, \"\\u00a8\", \"\\\\ddot\");\ndefineSymbol(math, main, accent, \"\\u007e\", \"\\\\tilde\");\ndefineSymbol(math, main, accent, \"\\u02c9\", \"\\\\bar\");\ndefineSymbol(math, main, accent, \"\\u02d8\", \"\\\\breve\");\ndefineSymbol(math, main, accent, \"\\u02c7\", \"\\\\check\");\ndefineSymbol(math, main, accent, \"\\u005e\", \"\\\\hat\");\ndefineSymbol(math, main, accent, \"\\u20d7\", \"\\\\vec\");\ndefineSymbol(math, main, accent, \"\\u02d9\", \"\\\\dot\");\ndefineSymbol(math, main, accent, \"\\u02da\", \"\\\\mathring\"); // \\imath and \\jmath should be invariant to \\mathrm, \\mathbf, etc., so use PUA\n\ndefineSymbol(math, main, mathord, \"\\ue131\", \"\\\\@imath\");\ndefineSymbol(math, main, mathord, \"\\ue237\", \"\\\\@jmath\");\ndefineSymbol(math, main, textord, \"\\u0131\", \"\\u0131\");\ndefineSymbol(math, main, textord, \"\\u0237\", \"\\u0237\");\ndefineSymbol(text, main, textord, \"\\u0131\", \"\\\\i\", true);\ndefineSymbol(text, main, textord, \"\\u0237\", \"\\\\j\", true);\ndefineSymbol(text, main, textord, \"\\u00df\", \"\\\\ss\", true);\ndefineSymbol(text, main, textord, \"\\u00e6\", \"\\\\ae\", true);\ndefineSymbol(text, main, textord, \"\\u0153\", \"\\\\oe\", true);\ndefineSymbol(text, main, textord, \"\\u00f8\", \"\\\\o\", true);\ndefineSymbol(text, main, textord, \"\\u00c6\", \"\\\\AE\", true);\ndefineSymbol(text, main, textord, \"\\u0152\", \"\\\\OE\", true);\ndefineSymbol(text, main, textord, \"\\u00d8\", \"\\\\O\", true);\ndefineSymbol(text, main, accent, \"\\u02ca\", \"\\\\'\"); // acute\n\ndefineSymbol(text, main, accent, \"\\u02cb\", \"\\\\`\"); // grave\n\ndefineSymbol(text, main, accent, \"\\u02c6\", \"\\\\^\"); // circumflex\n\ndefineSymbol(text, main, accent, \"\\u02dc\", \"\\\\~\"); // tilde\n\ndefineSymbol(text, main, accent, \"\\u02c9\", \"\\\\=\"); // macron\n\ndefineSymbol(text, main, accent, \"\\u02d8\", \"\\\\u\"); // breve\n\ndefineSymbol(text, main, accent, \"\\u02d9\", \"\\\\.\"); // dot above\n\ndefineSymbol(text, main, accent, \"\\u00b8\", \"\\\\c\"); // cedilla\n\ndefineSymbol(text, main, accent, \"\\u02da\", \"\\\\r\"); // ring above\n\ndefineSymbol(text, main, accent, \"\\u02c7\", \"\\\\v\"); // caron\n\ndefineSymbol(text, main, accent, \"\\u00a8\", '\\\\\"'); // diaeresis\n\ndefineSymbol(text, main, accent, \"\\u02dd\", \"\\\\H\"); // double acute\n\ndefineSymbol(text, main, accent, \"\\u25ef\", \"\\\\textcircled\"); // \\bigcirc glyph\n// These ligatures are detected and created in Parser.js's `formLigatures`.\n\nvar ligatures = {\n  \"--\": true,\n  \"---\": true,\n  \"``\": true,\n  \"''\": true\n};\ndefineSymbol(text, main, textord, \"\\u2013\", \"--\", true);\ndefineSymbol(text, main, textord, \"\\u2013\", \"\\\\textendash\");\ndefineSymbol(text, main, textord, \"\\u2014\", \"---\", true);\ndefineSymbol(text, main, textord, \"\\u2014\", \"\\\\textemdash\");\ndefineSymbol(text, main, textord, \"\\u2018\", \"`\", true);\ndefineSymbol(text, main, textord, \"\\u2018\", \"\\\\textquoteleft\");\ndefineSymbol(text, main, textord, \"\\u2019\", \"'\", true);\ndefineSymbol(text, main, textord, \"\\u2019\", \"\\\\textquoteright\");\ndefineSymbol(text, main, textord, \"\\u201c\", \"``\", true);\ndefineSymbol(text, main, textord, \"\\u201c\", \"\\\\textquotedblleft\");\ndefineSymbol(text, main, textord, \"\\u201d\", \"''\", true);\ndefineSymbol(text, main, textord, \"\\u201d\", \"\\\\textquotedblright\"); //  \\degree from gensymb package\n\ndefineSymbol(math, main, textord, \"\\u00b0\", \"\\\\degree\", true);\ndefineSymbol(text, main, textord, \"\\u00b0\", \"\\\\degree\"); // \\textdegree from inputenc package\n\ndefineSymbol(text, main, textord, \"\\u00b0\", \"\\\\textdegree\", true); // TODO: In LaTeX, \\pounds can generate a different character in text and math\n// mode, but among our fonts, only Main-Regular defines this character \"163\".\n\ndefineSymbol(math, main, textord, \"\\u00a3\", \"\\\\pounds\");\ndefineSymbol(math, main, textord, \"\\u00a3\", \"\\\\mathsterling\", true);\ndefineSymbol(text, main, textord, \"\\u00a3\", \"\\\\pounds\");\ndefineSymbol(text, main, textord, \"\\u00a3\", \"\\\\textsterling\", true);\ndefineSymbol(math, ams, textord, \"\\u2720\", \"\\\\maltese\");\ndefineSymbol(text, ams, textord, \"\\u2720\", \"\\\\maltese\"); // There are lots of symbols which are the same, so we add them in afterwards.\n// All of these are textords in math mode\n\nvar mathTextSymbols = \"0123456789/@.\\\"\";\n\nfor (var i = 0; i < mathTextSymbols.length; i++) {\n  var ch = mathTextSymbols.charAt(i);\n  defineSymbol(math, main, textord, ch, ch);\n} // All of these are textords in text mode\n\n\nvar textSymbols = \"0123456789!@*()-=+\\\";:?/.,\";\n\nfor (var _i = 0; _i < textSymbols.length; _i++) {\n  var _ch = textSymbols.charAt(_i);\n\n  defineSymbol(text, main, textord, _ch, _ch);\n} // All of these are textords in text mode, and mathords in math mode\n\n\nvar letters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n\nfor (var _i2 = 0; _i2 < letters.length; _i2++) {\n  var _ch2 = letters.charAt(_i2);\n\n  defineSymbol(math, main, mathord, _ch2, _ch2);\n  defineSymbol(text, main, textord, _ch2, _ch2);\n} // Blackboard bold and script letters in Unicode range\n\n\ndefineSymbol(math, ams, textord, \"C\", \"\\u2102\"); // blackboard bold\n\ndefineSymbol(text, ams, textord, \"C\", \"\\u2102\");\ndefineSymbol(math, ams, textord, \"H\", \"\\u210D\");\ndefineSymbol(text, ams, textord, \"H\", \"\\u210D\");\ndefineSymbol(math, ams, textord, \"N\", \"\\u2115\");\ndefineSymbol(text, ams, textord, \"N\", \"\\u2115\");\ndefineSymbol(math, ams, textord, \"P\", \"\\u2119\");\ndefineSymbol(text, ams, textord, \"P\", \"\\u2119\");\ndefineSymbol(math, ams, textord, \"Q\", \"\\u211A\");\ndefineSymbol(text, ams, textord, \"Q\", \"\\u211A\");\ndefineSymbol(math, ams, textord, \"R\", \"\\u211D\");\ndefineSymbol(text, ams, textord, \"R\", \"\\u211D\");\ndefineSymbol(math, ams, textord, \"Z\", \"\\u2124\");\ndefineSymbol(text, ams, textord, \"Z\", \"\\u2124\");\ndefineSymbol(math, main, mathord, \"h\", \"\\u210E\"); // italic h, Planck constant\n\ndefineSymbol(text, main, mathord, \"h\", \"\\u210E\"); // The next loop loads wide (surrogate pair) characters.\n// We support some letters in the Unicode range U+1D400 to U+1D7FF,\n// Mathematical Alphanumeric Symbols.\n// Some editors do not deal well with wide characters. So don't write the\n// string into this file. Instead, create the string from the surrogate pair.\n\nvar wideChar = \"\";\n\nfor (var _i3 = 0; _i3 < letters.length; _i3++) {\n  var _ch3 = letters.charAt(_i3); // The hex numbers in the next line are a surrogate pair.\n  // 0xD835 is the high surrogate for all letters in the range we support.\n  // 0xDC00 is the low surrogate for bold A.\n\n\n  wideChar = String.fromCharCode(0xD835, 0xDC00 + _i3); // A-Z a-z bold\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDC34 + _i3); // A-Z a-z italic\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDC68 + _i3); // A-Z a-z bold italic\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDD04 + _i3); // A-Z a-z Fraktur\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDD6C + _i3); // A-Z a-z bold Fraktur\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDDA0 + _i3); // A-Z a-z sans-serif\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDDD4 + _i3); // A-Z a-z sans bold\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDE08 + _i3); // A-Z a-z sans italic\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDE70 + _i3); // A-Z a-z monospace\n\n  defineSymbol(math, main, mathord, _ch3, wideChar);\n  defineSymbol(text, main, textord, _ch3, wideChar);\n\n  if (_i3 < 26) {\n    // KaTeX fonts have only capital letters for blackboard bold and script.\n    // See exception for k below.\n    wideChar = String.fromCharCode(0xD835, 0xDD38 + _i3); // A-Z double struck\n\n    defineSymbol(math, main, mathord, _ch3, wideChar);\n    defineSymbol(text, main, textord, _ch3, wideChar);\n    wideChar = String.fromCharCode(0xD835, 0xDC9C + _i3); // A-Z script\n\n    defineSymbol(math, main, mathord, _ch3, wideChar);\n    defineSymbol(text, main, textord, _ch3, wideChar);\n  } // TODO: Add bold script when it is supported by a KaTeX font.\n\n} // \"k\" is the only double struck lower case letter in the KaTeX fonts.\n\n\nwideChar = String.fromCharCode(0xD835, 0xDD5C); // k double struck\n\ndefineSymbol(math, main, mathord, \"k\", wideChar);\ndefineSymbol(text, main, textord, \"k\", wideChar); // Next, some wide character numerals\n\nfor (var _i4 = 0; _i4 < 10; _i4++) {\n  var _ch4 = _i4.toString();\n\n  wideChar = String.fromCharCode(0xD835, 0xDFCE + _i4); // 0-9 bold\n\n  defineSymbol(math, main, mathord, _ch4, wideChar);\n  defineSymbol(text, main, textord, _ch4, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDFE2 + _i4); // 0-9 sans serif\n\n  defineSymbol(math, main, mathord, _ch4, wideChar);\n  defineSymbol(text, main, textord, _ch4, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDFEC + _i4); // 0-9 bold sans\n\n  defineSymbol(math, main, mathord, _ch4, wideChar);\n  defineSymbol(text, main, textord, _ch4, wideChar);\n  wideChar = String.fromCharCode(0xD835, 0xDFF6 + _i4); // 0-9 monospace\n\n  defineSymbol(math, main, mathord, _ch4, wideChar);\n  defineSymbol(text, main, textord, _ch4, wideChar);\n} // We add these Latin-1 letters as symbols for backwards-compatibility,\n// but they are not actually in the font, nor are they supported by the\n// Unicode accent mechanism, so they fall back to Times font and look ugly.\n// TODO(edemaine): Fix this.\n\n\nvar extraLatin = \"\\u00d0\\u00de\\u00fe\";\n\nfor (var _i5 = 0; _i5 < extraLatin.length; _i5++) {\n  var _ch5 = extraLatin.charAt(_i5);\n\n  defineSymbol(math, main, mathord, _ch5, _ch5);\n  defineSymbol(text, main, textord, _ch5, _ch5);\n}\n\n/**\n * This file provides support for Unicode range U+1D400 to U+1D7FF,\n * Mathematical Alphanumeric Symbols.\n *\n * Function wideCharacterFont takes a wide character as input and returns\n * the font information necessary to render it properly.\n */\n/**\n * Data below is from https://www.unicode.org/charts/PDF/U1D400.pdf\n * That document sorts characters into groups by font type, say bold or italic.\n *\n * In the arrays below, each subarray consists three elements:\n *      * The CSS class of that group when in math mode.\n *      * The CSS class of that group when in text mode.\n *      * The font name, so that KaTeX can get font metrics.\n */\n\nvar wideLatinLetterData = [[\"mathbf\", \"textbf\", \"Main-Bold\"], // A-Z bold upright\n[\"mathbf\", \"textbf\", \"Main-Bold\"], // a-z bold upright\n[\"mathnormal\", \"textit\", \"Math-Italic\"], // A-Z italic\n[\"mathnormal\", \"textit\", \"Math-Italic\"], // a-z italic\n[\"boldsymbol\", \"boldsymbol\", \"Main-BoldItalic\"], // A-Z bold italic\n[\"boldsymbol\", \"boldsymbol\", \"Main-BoldItalic\"], // a-z bold italic\n// Map fancy A-Z letters to script, not calligraphic.\n// This aligns with unicode-math and math fonts (except Cambria Math).\n[\"mathscr\", \"textscr\", \"Script-Regular\"], // A-Z script\n[\"\", \"\", \"\"], // a-z script.  No font\n[\"\", \"\", \"\"], // A-Z bold script. No font\n[\"\", \"\", \"\"], // a-z bold script. No font\n[\"mathfrak\", \"textfrak\", \"Fraktur-Regular\"], // A-Z Fraktur\n[\"mathfrak\", \"textfrak\", \"Fraktur-Regular\"], // a-z Fraktur\n[\"mathbb\", \"textbb\", \"AMS-Regular\"], // A-Z double-struck\n[\"mathbb\", \"textbb\", \"AMS-Regular\"], // k double-struck\n// Note that we are using a bold font, but font metrics for regular Fraktur.\n[\"mathboldfrak\", \"textboldfrak\", \"Fraktur-Regular\"], // A-Z bold Fraktur\n[\"mathboldfrak\", \"textboldfrak\", \"Fraktur-Regular\"], // a-z bold Fraktur\n[\"mathsf\", \"textsf\", \"SansSerif-Regular\"], // A-Z sans-serif\n[\"mathsf\", \"textsf\", \"SansSerif-Regular\"], // a-z sans-serif\n[\"mathboldsf\", \"textboldsf\", \"SansSerif-Bold\"], // A-Z bold sans-serif\n[\"mathboldsf\", \"textboldsf\", \"SansSerif-Bold\"], // a-z bold sans-serif\n[\"mathitsf\", \"textitsf\", \"SansSerif-Italic\"], // A-Z italic sans-serif\n[\"mathitsf\", \"textitsf\", \"SansSerif-Italic\"], // a-z italic sans-serif\n[\"\", \"\", \"\"], // A-Z bold italic sans. No font\n[\"\", \"\", \"\"], // a-z bold italic sans. No font\n[\"mathtt\", \"texttt\", \"Typewriter-Regular\"], // A-Z monospace\n[\"mathtt\", \"texttt\", \"Typewriter-Regular\"] // a-z monospace\n];\nvar wideNumeralData = [[\"mathbf\", \"textbf\", \"Main-Bold\"], // 0-9 bold\n[\"\", \"\", \"\"], // 0-9 double-struck. No KaTeX font.\n[\"mathsf\", \"textsf\", \"SansSerif-Regular\"], // 0-9 sans-serif\n[\"mathboldsf\", \"textboldsf\", \"SansSerif-Bold\"], // 0-9 bold sans-serif\n[\"mathtt\", \"texttt\", \"Typewriter-Regular\"] // 0-9 monospace\n];\nvar wideCharacterFont = function wideCharacterFont(wideChar, mode) {\n  // IE doesn't support codePointAt(). So work with the surrogate pair.\n  var H = wideChar.charCodeAt(0); // high surrogate\n\n  var L = wideChar.charCodeAt(1); // low surrogate\n\n  var codePoint = (H - 0xD800) * 0x400 + (L - 0xDC00) + 0x10000;\n  var j = mode === \"math\" ? 0 : 1; // column index for CSS class.\n\n  if (0x1D400 <= codePoint && codePoint < 0x1D6A4) {\n    // wideLatinLetterData contains exactly 26 chars on each row.\n    // So we can calculate the relevant row. No traverse necessary.\n    var i = Math.floor((codePoint - 0x1D400) / 26);\n    return [wideLatinLetterData[i][2], wideLatinLetterData[i][j]];\n  } else if (0x1D7CE <= codePoint && codePoint <= 0x1D7FF) {\n    // Numerals, ten per row.\n    var _i = Math.floor((codePoint - 0x1D7CE) / 10);\n\n    return [wideNumeralData[_i][2], wideNumeralData[_i][j]];\n  } else if (codePoint === 0x1D6A5 || codePoint === 0x1D6A6) {\n    // dotless i or j\n    return [wideLatinLetterData[0][2], wideLatinLetterData[0][j]];\n  } else if (0x1D6A6 < codePoint && codePoint < 0x1D7CE) {\n    // Greek letters. Not supported, yet.\n    return [\"\", \"\"];\n  } else {\n    // We don't support any wide characters outside 1D400–1D7FF.\n    throw new ParseError(\"Unsupported character: \" + wideChar);\n  }\n};\n\n/* eslint no-console:0 */\n\n/**\n * Looks up the given symbol in fontMetrics, after applying any symbol\n * replacements defined in symbol.js\n */\nvar lookupSymbol = function lookupSymbol(value, // TODO(#963): Use a union type for this.\nfontName, mode) {\n  // Replace the value with its replaced value from symbol.js\n  if (symbols[mode][value] && symbols[mode][value].replace) {\n    value = symbols[mode][value].replace;\n  }\n\n  return {\n    value: value,\n    metrics: getCharacterMetrics(value, fontName, mode)\n  };\n};\n/**\n * Makes a symbolNode after translation via the list of symbols in symbols.js.\n * Correctly pulls out metrics for the character, and optionally takes a list of\n * classes to be attached to the node.\n *\n * TODO: make argument order closer to makeSpan\n * TODO: add a separate argument for math class (e.g. `mop`, `mbin`), which\n * should if present come first in `classes`.\n * TODO(#953): Make `options` mandatory and always pass it in.\n */\n\n\nvar makeSymbol = function makeSymbol(value, fontName, mode, options, classes) {\n  var lookup = lookupSymbol(value, fontName, mode);\n  var metrics = lookup.metrics;\n  value = lookup.value;\n  var symbolNode;\n\n  if (metrics) {\n    var italic = metrics.italic;\n\n    if (mode === \"text\" || options && options.font === \"mathit\") {\n      italic = 0;\n    }\n\n    symbolNode = new SymbolNode(value, metrics.height, metrics.depth, italic, metrics.skew, metrics.width, classes);\n  } else {\n    // TODO(emily): Figure out a good way to only print this in development\n    typeof console !== \"undefined\" && console.warn(\"No character metrics \" + (\"for '\" + value + \"' in style '\" + fontName + \"' and mode '\" + mode + \"'\"));\n    symbolNode = new SymbolNode(value, 0, 0, 0, 0, 0, classes);\n  }\n\n  if (options) {\n    symbolNode.maxFontSize = options.sizeMultiplier;\n\n    if (options.style.isTight()) {\n      symbolNode.classes.push(\"mtight\");\n    }\n\n    var color = options.getColor();\n\n    if (color) {\n      symbolNode.style.color = color;\n    }\n  }\n\n  return symbolNode;\n};\n/**\n * Makes a symbol in Main-Regular or AMS-Regular.\n * Used for rel, bin, open, close, inner, and punct.\n */\n\n\nvar mathsym = function mathsym(value, mode, options, classes) {\n  if (classes === void 0) {\n    classes = [];\n  }\n\n  // Decide what font to render the symbol in by its entry in the symbols\n  // table.\n  // Have a special case for when the value = \\ because the \\ is used as a\n  // textord in unsupported command errors but cannot be parsed as a regular\n  // text ordinal and is therefore not present as a symbol in the symbols\n  // table for text, as well as a special case for boldsymbol because it\n  // can be used for bold + and -\n  if (options.font === \"boldsymbol\" && lookupSymbol(value, \"Main-Bold\", mode).metrics) {\n    return makeSymbol(value, \"Main-Bold\", mode, options, classes.concat([\"mathbf\"]));\n  } else if (value === \"\\\\\" || symbols[mode][value].font === \"main\") {\n    return makeSymbol(value, \"Main-Regular\", mode, options, classes);\n  } else {\n    return makeSymbol(value, \"AMS-Regular\", mode, options, classes.concat([\"amsrm\"]));\n  }\n};\n/**\n * Determines which of the two font names (Main-Bold and Math-BoldItalic) and\n * corresponding style tags (mathbf or boldsymbol) to use for font \"boldsymbol\",\n * depending on the symbol.  Use this function instead of fontMap for font\n * \"boldsymbol\".\n */\n\n\nvar boldsymbol = function boldsymbol(value, mode, options, classes, type) {\n  if (type !== \"textord\" && lookupSymbol(value, \"Math-BoldItalic\", mode).metrics) {\n    return {\n      fontName: \"Math-BoldItalic\",\n      fontClass: \"boldsymbol\"\n    };\n  } else {\n    // Some glyphs do not exist in Math-BoldItalic so we need to use\n    // Main-Bold instead.\n    return {\n      fontName: \"Main-Bold\",\n      fontClass: \"mathbf\"\n    };\n  }\n};\n/**\n * Makes either a mathord or textord in the correct font and color.\n */\n\n\nvar makeOrd = function makeOrd(group, options, type) {\n  var mode = group.mode;\n  var text = group.text;\n  var classes = [\"mord\"]; // Math mode or Old font (i.e. \\rm)\n\n  var isFont = mode === \"math\" || mode === \"text\" && options.font;\n  var fontOrFamily = isFont ? options.font : options.fontFamily;\n  var wideFontName = \"\";\n  var wideFontClass = \"\";\n\n  if (text.charCodeAt(0) === 0xD835) {\n    [wideFontName, wideFontClass] = wideCharacterFont(text, mode);\n  }\n\n  if (wideFontName.length > 0) {\n    // surrogate pairs get special treatment\n    return makeSymbol(text, wideFontName, mode, options, classes.concat(wideFontClass));\n  } else if (fontOrFamily) {\n    var fontName;\n    var fontClasses;\n\n    if (fontOrFamily === \"boldsymbol\") {\n      var fontData = boldsymbol(text, mode, options, classes, type);\n      fontName = fontData.fontName;\n      fontClasses = [fontData.fontClass];\n    } else if (isFont) {\n      fontName = fontMap[fontOrFamily].fontName;\n      fontClasses = [fontOrFamily];\n    } else {\n      fontName = retrieveTextFontName(fontOrFamily, options.fontWeight, options.fontShape);\n      fontClasses = [fontOrFamily, options.fontWeight, options.fontShape];\n    }\n\n    if (lookupSymbol(text, fontName, mode).metrics) {\n      return makeSymbol(text, fontName, mode, options, classes.concat(fontClasses));\n    } else if (ligatures.hasOwnProperty(text) && fontName.slice(0, 10) === \"Typewriter\") {\n      // Deconstruct ligatures in monospace fonts (\\texttt, \\tt).\n      var parts = [];\n\n      for (var i = 0; i < text.length; i++) {\n        parts.push(makeSymbol(text[i], fontName, mode, options, classes.concat(fontClasses)));\n      }\n\n      return makeFragment(parts);\n    }\n  } // Makes a symbol in the default font for mathords and textords.\n\n\n  if (type === \"mathord\") {\n    return makeSymbol(text, \"Math-Italic\", mode, options, classes.concat([\"mathnormal\"]));\n  } else if (type === \"textord\") {\n    var font = symbols[mode][text] && symbols[mode][text].font;\n\n    if (font === \"ams\") {\n      var _fontName = retrieveTextFontName(\"amsrm\", options.fontWeight, options.fontShape);\n\n      return makeSymbol(text, _fontName, mode, options, classes.concat(\"amsrm\", options.fontWeight, options.fontShape));\n    } else if (font === \"main\" || !font) {\n      var _fontName2 = retrieveTextFontName(\"textrm\", options.fontWeight, options.fontShape);\n\n      return makeSymbol(text, _fontName2, mode, options, classes.concat(options.fontWeight, options.fontShape));\n    } else {\n      // fonts added by plugins\n      var _fontName3 = retrieveTextFontName(font, options.fontWeight, options.fontShape); // We add font name as a css class\n\n\n      return makeSymbol(text, _fontName3, mode, options, classes.concat(_fontName3, options.fontWeight, options.fontShape));\n    }\n  } else {\n    throw new Error(\"unexpected type: \" + type + \" in makeOrd\");\n  }\n};\n/**\n * Returns true if subsequent symbolNodes have the same classes, skew, maxFont,\n * and styles.\n */\n\n\nvar canCombine = (prev, next) => {\n  if (createClass(prev.classes) !== createClass(next.classes) || prev.skew !== next.skew || prev.maxFontSize !== next.maxFontSize) {\n    return false;\n  } // If prev and next both are just \"mbin\"s or \"mord\"s we don't combine them\n  // so that the proper spacing can be preserved.\n\n\n  if (prev.classes.length === 1) {\n    var cls = prev.classes[0];\n\n    if (cls === \"mbin\" || cls === \"mord\") {\n      return false;\n    }\n  }\n\n  for (var style in prev.style) {\n    if (prev.style.hasOwnProperty(style) && prev.style[style] !== next.style[style]) {\n      return false;\n    }\n  }\n\n  for (var _style in next.style) {\n    if (next.style.hasOwnProperty(_style) && prev.style[_style] !== next.style[_style]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n/**\n * Combine consecutive domTree.symbolNodes into a single symbolNode.\n * Note: this function mutates the argument.\n */\n\n\nvar tryCombineChars = chars => {\n  for (var i = 0; i < chars.length - 1; i++) {\n    var prev = chars[i];\n    var next = chars[i + 1];\n\n    if (prev instanceof SymbolNode && next instanceof SymbolNode && canCombine(prev, next)) {\n      prev.text += next.text;\n      prev.height = Math.max(prev.height, next.height);\n      prev.depth = Math.max(prev.depth, next.depth); // Use the last character's italic correction since we use\n      // it to add padding to the right of the span created from\n      // the combined characters.\n\n      prev.italic = next.italic;\n      chars.splice(i + 1, 1);\n      i--;\n    }\n  }\n\n  return chars;\n};\n/**\n * Calculate the height, depth, and maxFontSize of an element based on its\n * children.\n */\n\n\nvar sizeElementFromChildren = function sizeElementFromChildren(elem) {\n  var height = 0;\n  var depth = 0;\n  var maxFontSize = 0;\n\n  for (var i = 0; i < elem.children.length; i++) {\n    var child = elem.children[i];\n\n    if (child.height > height) {\n      height = child.height;\n    }\n\n    if (child.depth > depth) {\n      depth = child.depth;\n    }\n\n    if (child.maxFontSize > maxFontSize) {\n      maxFontSize = child.maxFontSize;\n    }\n  }\n\n  elem.height = height;\n  elem.depth = depth;\n  elem.maxFontSize = maxFontSize;\n};\n/**\n * Makes a span with the given list of classes, list of children, and options.\n *\n * TODO(#953): Ensure that `options` is always provided (currently some call\n * sites don't pass it) and make the type below mandatory.\n * TODO: add a separate argument for math class (e.g. `mop`, `mbin`), which\n * should if present come first in `classes`.\n */\n\n\nvar makeSpan$2 = function makeSpan(classes, children, options, style) {\n  var span = new Span(classes, children, options, style);\n  sizeElementFromChildren(span);\n  return span;\n}; // SVG one is simpler -- doesn't require height, depth, max-font setting.\n// This is also a separate method for typesafety.\n\n\nvar makeSvgSpan = (classes, children, options, style) => new Span(classes, children, options, style);\n\nvar makeLineSpan = function makeLineSpan(className, options, thickness) {\n  var line = makeSpan$2([className], [], options);\n  line.height = Math.max(thickness || options.fontMetrics().defaultRuleThickness, options.minRuleThickness);\n  line.style.borderBottomWidth = makeEm(line.height);\n  line.maxFontSize = 1.0;\n  return line;\n};\n/**\n * Makes an anchor with the given href, list of classes, list of children,\n * and options.\n */\n\n\nvar makeAnchor = function makeAnchor(href, classes, children, options) {\n  var anchor = new Anchor(href, classes, children, options);\n  sizeElementFromChildren(anchor);\n  return anchor;\n};\n/**\n * Makes a document fragment with the given list of children.\n */\n\n\nvar makeFragment = function makeFragment(children) {\n  var fragment = new DocumentFragment(children);\n  sizeElementFromChildren(fragment);\n  return fragment;\n};\n/**\n * Wraps group in a span if it's a document fragment, allowing to apply classes\n * and styles\n */\n\n\nvar wrapFragment = function wrapFragment(group, options) {\n  if (group instanceof DocumentFragment) {\n    return makeSpan$2([], [group], options);\n  }\n\n  return group;\n}; // These are exact object types to catch typos in the names of the optional fields.\n\n\n// Computes the updated `children` list and the overall depth.\n//\n// This helper function for makeVList makes it easier to enforce type safety by\n// allowing early exits (returns) in the logic.\nvar getVListChildrenAndDepth = function getVListChildrenAndDepth(params) {\n  if (params.positionType === \"individualShift\") {\n    var oldChildren = params.children;\n    var children = [oldChildren[0]]; // Add in kerns to the list of params.children to get each element to be\n    // shifted to the correct specified shift\n\n    var _depth = -oldChildren[0].shift - oldChildren[0].elem.depth;\n\n    var currPos = _depth;\n\n    for (var i = 1; i < oldChildren.length; i++) {\n      var diff = -oldChildren[i].shift - currPos - oldChildren[i].elem.depth;\n      var size = diff - (oldChildren[i - 1].elem.height + oldChildren[i - 1].elem.depth);\n      currPos = currPos + diff;\n      children.push({\n        type: \"kern\",\n        size\n      });\n      children.push(oldChildren[i]);\n    }\n\n    return {\n      children,\n      depth: _depth\n    };\n  }\n\n  var depth;\n\n  if (params.positionType === \"top\") {\n    // We always start at the bottom, so calculate the bottom by adding up\n    // all the sizes\n    var bottom = params.positionData;\n\n    for (var _i = 0; _i < params.children.length; _i++) {\n      var child = params.children[_i];\n      bottom -= child.type === \"kern\" ? child.size : child.elem.height + child.elem.depth;\n    }\n\n    depth = bottom;\n  } else if (params.positionType === \"bottom\") {\n    depth = -params.positionData;\n  } else {\n    var firstChild = params.children[0];\n\n    if (firstChild.type !== \"elem\") {\n      throw new Error('First child must have type \"elem\".');\n    }\n\n    if (params.positionType === \"shift\") {\n      depth = -firstChild.elem.depth - params.positionData;\n    } else if (params.positionType === \"firstBaseline\") {\n      depth = -firstChild.elem.depth;\n    } else {\n      throw new Error(\"Invalid positionType \" + params.positionType + \".\");\n    }\n  }\n\n  return {\n    children: params.children,\n    depth\n  };\n};\n/**\n * Makes a vertical list by stacking elements and kerns on top of each other.\n * Allows for many different ways of specifying the positioning method.\n *\n * See VListParam documentation above.\n */\n\n\nvar makeVList = function makeVList(params, options) {\n  var {\n    children,\n    depth\n  } = getVListChildrenAndDepth(params); // Create a strut that is taller than any list item. The strut is added to\n  // each item, where it will determine the item's baseline. Since it has\n  // `overflow:hidden`, the strut's top edge will sit on the item's line box's\n  // top edge and the strut's bottom edge will sit on the item's baseline,\n  // with no additional line-height spacing. This allows the item baseline to\n  // be positioned precisely without worrying about font ascent and\n  // line-height.\n\n  var pstrutSize = 0;\n\n  for (var i = 0; i < children.length; i++) {\n    var child = children[i];\n\n    if (child.type === \"elem\") {\n      var elem = child.elem;\n      pstrutSize = Math.max(pstrutSize, elem.maxFontSize, elem.height);\n    }\n  }\n\n  pstrutSize += 2;\n  var pstrut = makeSpan$2([\"pstrut\"], []);\n  pstrut.style.height = makeEm(pstrutSize); // Create a new list of actual children at the correct offsets\n\n  var realChildren = [];\n  var minPos = depth;\n  var maxPos = depth;\n  var currPos = depth;\n\n  for (var _i2 = 0; _i2 < children.length; _i2++) {\n    var _child = children[_i2];\n\n    if (_child.type === \"kern\") {\n      currPos += _child.size;\n    } else {\n      var _elem = _child.elem;\n      var classes = _child.wrapperClasses || [];\n      var style = _child.wrapperStyle || {};\n      var childWrap = makeSpan$2(classes, [pstrut, _elem], undefined, style);\n      childWrap.style.top = makeEm(-pstrutSize - currPos - _elem.depth);\n\n      if (_child.marginLeft) {\n        childWrap.style.marginLeft = _child.marginLeft;\n      }\n\n      if (_child.marginRight) {\n        childWrap.style.marginRight = _child.marginRight;\n      }\n\n      realChildren.push(childWrap);\n      currPos += _elem.height + _elem.depth;\n    }\n\n    minPos = Math.min(minPos, currPos);\n    maxPos = Math.max(maxPos, currPos);\n  } // The vlist contents go in a table-cell with `vertical-align:bottom`.\n  // This cell's bottom edge will determine the containing table's baseline\n  // without overly expanding the containing line-box.\n\n\n  var vlist = makeSpan$2([\"vlist\"], realChildren);\n  vlist.style.height = makeEm(maxPos); // A second row is used if necessary to represent the vlist's depth.\n\n  var rows;\n\n  if (minPos < 0) {\n    // We will define depth in an empty span with display: table-cell.\n    // It should render with the height that we define. But Chrome, in\n    // contenteditable mode only, treats that span as if it contains some\n    // text content. And that min-height over-rides our desired height.\n    // So we put another empty span inside the depth strut span.\n    var emptySpan = makeSpan$2([], []);\n    var depthStrut = makeSpan$2([\"vlist\"], [emptySpan]);\n    depthStrut.style.height = makeEm(-minPos); // Safari wants the first row to have inline content; otherwise it\n    // puts the bottom of the *second* row on the baseline.\n\n    var topStrut = makeSpan$2([\"vlist-s\"], [new SymbolNode(\"\\u200b\")]);\n    rows = [makeSpan$2([\"vlist-r\"], [vlist, topStrut]), makeSpan$2([\"vlist-r\"], [depthStrut])];\n  } else {\n    rows = [makeSpan$2([\"vlist-r\"], [vlist])];\n  }\n\n  var vtable = makeSpan$2([\"vlist-t\"], rows);\n\n  if (rows.length === 2) {\n    vtable.classes.push(\"vlist-t2\");\n  }\n\n  vtable.height = maxPos;\n  vtable.depth = -minPos;\n  return vtable;\n}; // Glue is a concept from TeX which is a flexible space between elements in\n// either a vertical or horizontal list. In KaTeX, at least for now, it's\n// static space between elements in a horizontal layout.\n\n\nvar makeGlue = (measurement, options) => {\n  // Make an empty span for the space\n  var rule = makeSpan$2([\"mspace\"], [], options);\n  var size = calculateSize(measurement, options);\n  rule.style.marginRight = makeEm(size);\n  return rule;\n}; // Takes font options, and returns the appropriate fontLookup name\n\n\nvar retrieveTextFontName = function retrieveTextFontName(fontFamily, fontWeight, fontShape) {\n  var baseFontName = \"\";\n\n  switch (fontFamily) {\n    case \"amsrm\":\n      baseFontName = \"AMS\";\n      break;\n\n    case \"textrm\":\n      baseFontName = \"Main\";\n      break;\n\n    case \"textsf\":\n      baseFontName = \"SansSerif\";\n      break;\n\n    case \"texttt\":\n      baseFontName = \"Typewriter\";\n      break;\n\n    default:\n      baseFontName = fontFamily;\n    // use fonts added by a plugin\n  }\n\n  var fontStylesName;\n\n  if (fontWeight === \"textbf\" && fontShape === \"textit\") {\n    fontStylesName = \"BoldItalic\";\n  } else if (fontWeight === \"textbf\") {\n    fontStylesName = \"Bold\";\n  } else if (fontWeight === \"textit\") {\n    fontStylesName = \"Italic\";\n  } else {\n    fontStylesName = \"Regular\";\n  }\n\n  return baseFontName + \"-\" + fontStylesName;\n};\n/**\n * Maps TeX font commands to objects containing:\n * - variant: string used for \"mathvariant\" attribute in buildMathML.js\n * - fontName: the \"style\" parameter to fontMetrics.getCharacterMetrics\n */\n// A map between tex font commands an MathML mathvariant attribute values\n\n\nvar fontMap = {\n  // styles\n  \"mathbf\": {\n    variant: \"bold\",\n    fontName: \"Main-Bold\"\n  },\n  \"mathrm\": {\n    variant: \"normal\",\n    fontName: \"Main-Regular\"\n  },\n  \"textit\": {\n    variant: \"italic\",\n    fontName: \"Main-Italic\"\n  },\n  \"mathit\": {\n    variant: \"italic\",\n    fontName: \"Main-Italic\"\n  },\n  \"mathnormal\": {\n    variant: \"italic\",\n    fontName: \"Math-Italic\"\n  },\n  \"mathsfit\": {\n    variant: \"sans-serif-italic\",\n    fontName: \"SansSerif-Italic\"\n  },\n  // \"boldsymbol\" is missing because they require the use of multiple fonts:\n  // Math-BoldItalic and Main-Bold.  This is handled by a special case in\n  // makeOrd which ends up calling boldsymbol.\n  // families\n  \"mathbb\": {\n    variant: \"double-struck\",\n    fontName: \"AMS-Regular\"\n  },\n  \"mathcal\": {\n    variant: \"script\",\n    fontName: \"Caligraphic-Regular\"\n  },\n  \"mathfrak\": {\n    variant: \"fraktur\",\n    fontName: \"Fraktur-Regular\"\n  },\n  \"mathscr\": {\n    variant: \"script\",\n    fontName: \"Script-Regular\"\n  },\n  \"mathsf\": {\n    variant: \"sans-serif\",\n    fontName: \"SansSerif-Regular\"\n  },\n  \"mathtt\": {\n    variant: \"monospace\",\n    fontName: \"Typewriter-Regular\"\n  }\n};\nvar svgData = {\n  //   path, width, height\n  vec: [\"vec\", 0.471, 0.714],\n  // values from the font glyph\n  oiintSize1: [\"oiintSize1\", 0.957, 0.499],\n  // oval to overlay the integrand\n  oiintSize2: [\"oiintSize2\", 1.472, 0.659],\n  oiiintSize1: [\"oiiintSize1\", 1.304, 0.499],\n  oiiintSize2: [\"oiiintSize2\", 1.98, 0.659]\n};\n\nvar staticSvg = function staticSvg(value, options) {\n  // Create a span with inline SVG for the element.\n  var [pathName, width, height] = svgData[value];\n  var path = new PathNode(pathName);\n  var svgNode = new SvgNode([path], {\n    \"width\": makeEm(width),\n    \"height\": makeEm(height),\n    // Override CSS rule `.katex svg { width: 100% }`\n    \"style\": \"width:\" + makeEm(width),\n    \"viewBox\": \"0 0 \" + 1000 * width + \" \" + 1000 * height,\n    \"preserveAspectRatio\": \"xMinYMin\"\n  });\n  var span = makeSvgSpan([\"overlay\"], [svgNode], options);\n  span.height = height;\n  span.style.height = makeEm(height);\n  span.style.width = makeEm(width);\n  return span;\n};\n\nvar buildCommon = {\n  fontMap,\n  makeSymbol,\n  mathsym,\n  makeSpan: makeSpan$2,\n  makeSvgSpan,\n  makeLineSpan,\n  makeAnchor,\n  makeFragment,\n  wrapFragment,\n  makeVList,\n  makeOrd,\n  makeGlue,\n  staticSvg,\n  svgData,\n  tryCombineChars\n};\n\n/**\n * Describes spaces between different classes of atoms.\n */\nvar thinspace = {\n  number: 3,\n  unit: \"mu\"\n};\nvar mediumspace = {\n  number: 4,\n  unit: \"mu\"\n};\nvar thickspace = {\n  number: 5,\n  unit: \"mu\"\n}; // Making the type below exact with all optional fields doesn't work due to\n// - https://github.com/facebook/flow/issues/4582\n// - https://github.com/facebook/flow/issues/5688\n// However, since *all* fields are optional, $Shape<> works as suggested in 5688\n// above.\n\n// Spacing relationships for display and text styles\nvar spacings = {\n  mord: {\n    mop: thinspace,\n    mbin: mediumspace,\n    mrel: thickspace,\n    minner: thinspace\n  },\n  mop: {\n    mord: thinspace,\n    mop: thinspace,\n    mrel: thickspace,\n    minner: thinspace\n  },\n  mbin: {\n    mord: mediumspace,\n    mop: mediumspace,\n    mopen: mediumspace,\n    minner: mediumspace\n  },\n  mrel: {\n    mord: thickspace,\n    mop: thickspace,\n    mopen: thickspace,\n    minner: thickspace\n  },\n  mopen: {},\n  mclose: {\n    mop: thinspace,\n    mbin: mediumspace,\n    mrel: thickspace,\n    minner: thinspace\n  },\n  mpunct: {\n    mord: thinspace,\n    mop: thinspace,\n    mrel: thickspace,\n    mopen: thinspace,\n    mclose: thinspace,\n    mpunct: thinspace,\n    minner: thinspace\n  },\n  minner: {\n    mord: thinspace,\n    mop: thinspace,\n    mbin: mediumspace,\n    mrel: thickspace,\n    mopen: thinspace,\n    mpunct: thinspace,\n    minner: thinspace\n  }\n}; // Spacing relationships for script and scriptscript styles\n\nvar tightSpacings = {\n  mord: {\n    mop: thinspace\n  },\n  mop: {\n    mord: thinspace,\n    mop: thinspace\n  },\n  mbin: {},\n  mrel: {},\n  mopen: {},\n  mclose: {\n    mop: thinspace\n  },\n  mpunct: {},\n  minner: {\n    mop: thinspace\n  }\n};\n\n/** Context provided to function handlers for error messages. */\n// Note: reverse the order of the return type union will cause a flow error.\n// See https://github.com/facebook/flow/issues/3663.\n// More general version of `HtmlBuilder` for nodes (e.g. \\sum, accent types)\n// whose presence impacts super/subscripting. In this case, ParseNode<\"supsub\">\n// delegates its HTML building to the HtmlBuilder corresponding to these nodes.\n\n/**\n * Final function spec for use at parse time.\n * This is almost identical to `FunctionPropSpec`, except it\n * 1. includes the function handler, and\n * 2. requires all arguments except argTypes.\n * It is generated by `defineFunction()` below.\n */\n\n/**\n * All registered functions.\n * `functions.js` just exports this same dictionary again and makes it public.\n * `Parser.js` requires this dictionary.\n */\nvar _functions = {};\n/**\n * All HTML builders. Should be only used in the `define*` and the `build*ML`\n * functions.\n */\n\nvar _htmlGroupBuilders = {};\n/**\n * All MathML builders. Should be only used in the `define*` and the `build*ML`\n * functions.\n */\n\nvar _mathmlGroupBuilders = {};\nfunction defineFunction(_ref) {\n  var {\n    type,\n    names,\n    props,\n    handler,\n    htmlBuilder,\n    mathmlBuilder\n  } = _ref;\n  // Set default values of functions\n  var data = {\n    type,\n    numArgs: props.numArgs,\n    argTypes: props.argTypes,\n    allowedInArgument: !!props.allowedInArgument,\n    allowedInText: !!props.allowedInText,\n    allowedInMath: props.allowedInMath === undefined ? true : props.allowedInMath,\n    numOptionalArgs: props.numOptionalArgs || 0,\n    infix: !!props.infix,\n    primitive: !!props.primitive,\n    handler: handler\n  };\n\n  for (var i = 0; i < names.length; ++i) {\n    _functions[names[i]] = data;\n  }\n\n  if (type) {\n    if (htmlBuilder) {\n      _htmlGroupBuilders[type] = htmlBuilder;\n    }\n\n    if (mathmlBuilder) {\n      _mathmlGroupBuilders[type] = mathmlBuilder;\n    }\n  }\n}\n/**\n * Use this to register only the HTML and MathML builders for a function (e.g.\n * if the function's ParseNode is generated in Parser.js rather than via a\n * stand-alone handler provided to `defineFunction`).\n */\n\nfunction defineFunctionBuilders(_ref2) {\n  var {\n    type,\n    htmlBuilder,\n    mathmlBuilder\n  } = _ref2;\n  defineFunction({\n    type,\n    names: [],\n    props: {\n      numArgs: 0\n    },\n\n    handler() {\n      throw new Error('Should never be called.');\n    },\n\n    htmlBuilder,\n    mathmlBuilder\n  });\n}\nvar normalizeArgument = function normalizeArgument(arg) {\n  return arg.type === \"ordgroup\" && arg.body.length === 1 ? arg.body[0] : arg;\n}; // Since the corresponding buildHTML/buildMathML function expects a\n// list of elements, we normalize for different kinds of arguments\n\nvar ordargument = function ordargument(arg) {\n  return arg.type === \"ordgroup\" ? arg.body : [arg];\n};\n\n/**\n * This file does the main work of building a domTree structure from a parse\n * tree. The entry point is the `buildHTML` function, which takes a parse tree.\n * Then, the buildExpression, buildGroup, and various groupBuilders functions\n * are called, to produce a final HTML tree.\n */\nvar makeSpan$1 = buildCommon.makeSpan; // Binary atoms (first class `mbin`) change into ordinary atoms (`mord`)\n// depending on their surroundings. See TeXbook pg. 442-446, Rules 5 and 6,\n// and the text before Rule 19.\n\nvar binLeftCanceller = [\"leftmost\", \"mbin\", \"mopen\", \"mrel\", \"mop\", \"mpunct\"];\nvar binRightCanceller = [\"rightmost\", \"mrel\", \"mclose\", \"mpunct\"];\nvar styleMap$1 = {\n  \"display\": Style$1.DISPLAY,\n  \"text\": Style$1.TEXT,\n  \"script\": Style$1.SCRIPT,\n  \"scriptscript\": Style$1.SCRIPTSCRIPT\n};\nvar DomEnum = {\n  mord: \"mord\",\n  mop: \"mop\",\n  mbin: \"mbin\",\n  mrel: \"mrel\",\n  mopen: \"mopen\",\n  mclose: \"mclose\",\n  mpunct: \"mpunct\",\n  minner: \"minner\"\n};\n\n/**\n * Take a list of nodes, build them in order, and return a list of the built\n * nodes. documentFragments are flattened into their contents, so the\n * returned list contains no fragments. `isRealGroup` is true if `expression`\n * is a real group (no atoms will be added on either side), as opposed to\n * a partial group (e.g. one created by \\color). `surrounding` is an array\n * consisting type of nodes that will be added to the left and right.\n */\nvar buildExpression$1 = function buildExpression(expression, options, isRealGroup, surrounding) {\n  if (surrounding === void 0) {\n    surrounding = [null, null];\n  }\n\n  // Parse expressions into `groups`.\n  var groups = [];\n\n  for (var i = 0; i < expression.length; i++) {\n    var output = buildGroup$1(expression[i], options);\n\n    if (output instanceof DocumentFragment) {\n      var children = output.children;\n      groups.push(...children);\n    } else {\n      groups.push(output);\n    }\n  } // Combine consecutive domTree.symbolNodes into a single symbolNode.\n\n\n  buildCommon.tryCombineChars(groups); // If `expression` is a partial group, let the parent handle spacings\n  // to avoid processing groups multiple times.\n\n  if (!isRealGroup) {\n    return groups;\n  }\n\n  var glueOptions = options;\n\n  if (expression.length === 1) {\n    var node = expression[0];\n\n    if (node.type === \"sizing\") {\n      glueOptions = options.havingSize(node.size);\n    } else if (node.type === \"styling\") {\n      glueOptions = options.havingStyle(styleMap$1[node.style]);\n    }\n  } // Dummy spans for determining spacings between surrounding atoms.\n  // If `expression` has no atoms on the left or right, class \"leftmost\"\n  // or \"rightmost\", respectively, is used to indicate it.\n\n\n  var dummyPrev = makeSpan$1([surrounding[0] || \"leftmost\"], [], options);\n  var dummyNext = makeSpan$1([surrounding[1] || \"rightmost\"], [], options); // TODO: These code assumes that a node's math class is the first element\n  // of its `classes` array. A later cleanup should ensure this, for\n  // instance by changing the signature of `makeSpan`.\n  // Before determining what spaces to insert, perform bin cancellation.\n  // Binary operators change to ordinary symbols in some contexts.\n\n  var isRoot = isRealGroup === \"root\";\n  traverseNonSpaceNodes(groups, (node, prev) => {\n    var prevType = prev.classes[0];\n    var type = node.classes[0];\n\n    if (prevType === \"mbin\" && utils.contains(binRightCanceller, type)) {\n      prev.classes[0] = \"mord\";\n    } else if (type === \"mbin\" && utils.contains(binLeftCanceller, prevType)) {\n      node.classes[0] = \"mord\";\n    }\n  }, {\n    node: dummyPrev\n  }, dummyNext, isRoot);\n  traverseNonSpaceNodes(groups, (node, prev) => {\n    var prevType = getTypeOfDomTree(prev);\n    var type = getTypeOfDomTree(node); // 'mtight' indicates that the node is script or scriptscript style.\n\n    var space = prevType && type ? node.hasClass(\"mtight\") ? tightSpacings[prevType][type] : spacings[prevType][type] : null;\n\n    if (space) {\n      // Insert glue (spacing) after the `prev`.\n      return buildCommon.makeGlue(space, glueOptions);\n    }\n  }, {\n    node: dummyPrev\n  }, dummyNext, isRoot);\n  return groups;\n}; // Depth-first traverse non-space `nodes`, calling `callback` with the current and\n// previous node as arguments, optionally returning a node to insert after the\n// previous node. `prev` is an object with the previous node and `insertAfter`\n// function to insert after it. `next` is a node that will be added to the right.\n// Used for bin cancellation and inserting spacings.\n\nvar traverseNonSpaceNodes = function traverseNonSpaceNodes(nodes, callback, prev, next, isRoot) {\n  if (next) {\n    // temporarily append the right node, if exists\n    nodes.push(next);\n  }\n\n  var i = 0;\n\n  for (; i < nodes.length; i++) {\n    var node = nodes[i];\n    var partialGroup = checkPartialGroup(node);\n\n    if (partialGroup) {\n      // Recursive DFS\n      // $FlowFixMe: make nodes a $ReadOnlyArray by returning a new array\n      traverseNonSpaceNodes(partialGroup.children, callback, prev, null, isRoot);\n      continue;\n    } // Ignore explicit spaces (e.g., \\;, \\,) when determining what implicit\n    // spacing should go between atoms of different classes\n\n\n    var nonspace = !node.hasClass(\"mspace\");\n\n    if (nonspace) {\n      var result = callback(node, prev.node);\n\n      if (result) {\n        if (prev.insertAfter) {\n          prev.insertAfter(result);\n        } else {\n          // insert at front\n          nodes.unshift(result);\n          i++;\n        }\n      }\n    }\n\n    if (nonspace) {\n      prev.node = node;\n    } else if (isRoot && node.hasClass(\"newline\")) {\n      prev.node = makeSpan$1([\"leftmost\"]); // treat like beginning of line\n    }\n\n    prev.insertAfter = (index => n => {\n      nodes.splice(index + 1, 0, n);\n      i++;\n    })(i);\n  }\n\n  if (next) {\n    nodes.pop();\n  }\n}; // Check if given node is a partial group, i.e., does not affect spacing around.\n\n\nvar checkPartialGroup = function checkPartialGroup(node) {\n  if (node instanceof DocumentFragment || node instanceof Anchor || node instanceof Span && node.hasClass(\"enclosing\")) {\n    return node;\n  }\n\n  return null;\n}; // Return the outermost node of a domTree.\n\n\nvar getOutermostNode = function getOutermostNode(node, side) {\n  var partialGroup = checkPartialGroup(node);\n\n  if (partialGroup) {\n    var children = partialGroup.children;\n\n    if (children.length) {\n      if (side === \"right\") {\n        return getOutermostNode(children[children.length - 1], \"right\");\n      } else if (side === \"left\") {\n        return getOutermostNode(children[0], \"left\");\n      }\n    }\n  }\n\n  return node;\n}; // Return math atom class (mclass) of a domTree.\n// If `side` is given, it will get the type of the outermost node at given side.\n\n\nvar getTypeOfDomTree = function getTypeOfDomTree(node, side) {\n  if (!node) {\n    return null;\n  }\n\n  if (side) {\n    node = getOutermostNode(node, side);\n  } // This makes a lot of assumptions as to where the type of atom\n  // appears.  We should do a better job of enforcing this.\n\n\n  return DomEnum[node.classes[0]] || null;\n};\nvar makeNullDelimiter = function makeNullDelimiter(options, classes) {\n  var moreClasses = [\"nulldelimiter\"].concat(options.baseSizingClasses());\n  return makeSpan$1(classes.concat(moreClasses));\n};\n/**\n * buildGroup is the function that takes a group and calls the correct groupType\n * function for it. It also handles the interaction of size and style changes\n * between parents and children.\n */\n\nvar buildGroup$1 = function buildGroup(group, options, baseOptions) {\n  if (!group) {\n    return makeSpan$1();\n  }\n\n  if (_htmlGroupBuilders[group.type]) {\n    // Call the groupBuilders function\n    // $FlowFixMe\n    var groupNode = _htmlGroupBuilders[group.type](group, options); // If the size changed between the parent and the current group, account\n    // for that size difference.\n\n    if (baseOptions && options.size !== baseOptions.size) {\n      groupNode = makeSpan$1(options.sizingClasses(baseOptions), [groupNode], options);\n      var multiplier = options.sizeMultiplier / baseOptions.sizeMultiplier;\n      groupNode.height *= multiplier;\n      groupNode.depth *= multiplier;\n    }\n\n    return groupNode;\n  } else {\n    throw new ParseError(\"Got group of unknown type: '\" + group.type + \"'\");\n  }\n};\n/**\n * Combine an array of HTML DOM nodes (e.g., the output of `buildExpression`)\n * into an unbreakable HTML node of class .base, with proper struts to\n * guarantee correct vertical extent.  `buildHTML` calls this repeatedly to\n * make up the entire expression as a sequence of unbreakable units.\n */\n\nfunction buildHTMLUnbreakable(children, options) {\n  // Compute height and depth of this chunk.\n  var body = makeSpan$1([\"base\"], children, options); // Add strut, which ensures that the top of the HTML element falls at\n  // the height of the expression, and the bottom of the HTML element\n  // falls at the depth of the expression.\n\n  var strut = makeSpan$1([\"strut\"]);\n  strut.style.height = makeEm(body.height + body.depth);\n\n  if (body.depth) {\n    strut.style.verticalAlign = makeEm(-body.depth);\n  }\n\n  body.children.unshift(strut);\n  return body;\n}\n/**\n * Take an entire parse tree, and build it into an appropriate set of HTML\n * nodes.\n */\n\n\nfunction buildHTML(tree, options) {\n  // Strip off outer tag wrapper for processing below.\n  var tag = null;\n\n  if (tree.length === 1 && tree[0].type === \"tag\") {\n    tag = tree[0].tag;\n    tree = tree[0].body;\n  } // Build the expression contained in the tree\n\n\n  var expression = buildExpression$1(tree, options, \"root\");\n  var eqnNum;\n\n  if (expression.length === 2 && expression[1].hasClass(\"tag\")) {\n    // An environment with automatic equation numbers, e.g. {gather}.\n    eqnNum = expression.pop();\n  }\n\n  var children = []; // Create one base node for each chunk between potential line breaks.\n  // The TeXBook [p.173] says \"A formula will be broken only after a\n  // relation symbol like $=$ or $<$ or $\\rightarrow$, or after a binary\n  // operation symbol like $+$ or $-$ or $\\times$, where the relation or\n  // binary operation is on the ``outer level'' of the formula (i.e., not\n  // enclosed in {...} and not part of an \\over construction).\"\n\n  var parts = [];\n\n  for (var i = 0; i < expression.length; i++) {\n    parts.push(expression[i]);\n\n    if (expression[i].hasClass(\"mbin\") || expression[i].hasClass(\"mrel\") || expression[i].hasClass(\"allowbreak\")) {\n      // Put any post-operator glue on same line as operator.\n      // Watch for \\nobreak along the way, and stop at \\newline.\n      var nobreak = false;\n\n      while (i < expression.length - 1 && expression[i + 1].hasClass(\"mspace\") && !expression[i + 1].hasClass(\"newline\")) {\n        i++;\n        parts.push(expression[i]);\n\n        if (expression[i].hasClass(\"nobreak\")) {\n          nobreak = true;\n        }\n      } // Don't allow break if \\nobreak among the post-operator glue.\n\n\n      if (!nobreak) {\n        children.push(buildHTMLUnbreakable(parts, options));\n        parts = [];\n      }\n    } else if (expression[i].hasClass(\"newline\")) {\n      // Write the line except the newline\n      parts.pop();\n\n      if (parts.length > 0) {\n        children.push(buildHTMLUnbreakable(parts, options));\n        parts = [];\n      } // Put the newline at the top level\n\n\n      children.push(expression[i]);\n    }\n  }\n\n  if (parts.length > 0) {\n    children.push(buildHTMLUnbreakable(parts, options));\n  } // Now, if there was a tag, build it too and append it as a final child.\n\n\n  var tagChild;\n\n  if (tag) {\n    tagChild = buildHTMLUnbreakable(buildExpression$1(tag, options, true));\n    tagChild.classes = [\"tag\"];\n    children.push(tagChild);\n  } else if (eqnNum) {\n    children.push(eqnNum);\n  }\n\n  var htmlNode = makeSpan$1([\"katex-html\"], children);\n  htmlNode.setAttribute(\"aria-hidden\", \"true\"); // Adjust the strut of the tag to be the maximum height of all children\n  // (the height of the enclosing htmlNode) for proper vertical alignment.\n\n  if (tagChild) {\n    var strut = tagChild.children[0];\n    strut.style.height = makeEm(htmlNode.height + htmlNode.depth);\n\n    if (htmlNode.depth) {\n      strut.style.verticalAlign = makeEm(-htmlNode.depth);\n    }\n  }\n\n  return htmlNode;\n}\n\n/**\n * These objects store data about MathML nodes. This is the MathML equivalent\n * of the types in domTree.js. Since MathML handles its own rendering, and\n * since we're mainly using MathML to improve accessibility, we don't manage\n * any of the styling state that the plain DOM nodes do.\n *\n * The `toNode` and `toMarkup` functions work similarly to how they do in\n * domTree.js, creating namespaced DOM nodes and HTML text markup respectively.\n */\nfunction newDocumentFragment(children) {\n  return new DocumentFragment(children);\n}\n/**\n * This node represents a general purpose MathML node of any type. The\n * constructor requires the type of node to create (for example, `\"mo\"` or\n * `\"mspace\"`, corresponding to `<mo>` and `<mspace>` tags).\n */\n\nclass MathNode {\n  constructor(type, children, classes) {\n    this.type = void 0;\n    this.attributes = void 0;\n    this.children = void 0;\n    this.classes = void 0;\n    this.type = type;\n    this.attributes = {};\n    this.children = children || [];\n    this.classes = classes || [];\n  }\n  /**\n   * Sets an attribute on a MathML node. MathML depends on attributes to convey a\n   * semantic content, so this is used heavily.\n   */\n\n\n  setAttribute(name, value) {\n    this.attributes[name] = value;\n  }\n  /**\n   * Gets an attribute on a MathML node.\n   */\n\n\n  getAttribute(name) {\n    return this.attributes[name];\n  }\n  /**\n   * Converts the math node into a MathML-namespaced DOM element.\n   */\n\n\n  toNode() {\n    var node = document.createElementNS(\"http://www.w3.org/1998/Math/MathML\", this.type);\n\n    for (var attr in this.attributes) {\n      if (Object.prototype.hasOwnProperty.call(this.attributes, attr)) {\n        node.setAttribute(attr, this.attributes[attr]);\n      }\n    }\n\n    if (this.classes.length > 0) {\n      node.className = createClass(this.classes);\n    }\n\n    for (var i = 0; i < this.children.length; i++) {\n      // Combine multiple TextNodes into one TextNode, to prevent\n      // screen readers from reading each as a separate word [#3995]\n      if (this.children[i] instanceof TextNode && this.children[i + 1] instanceof TextNode) {\n        var text = this.children[i].toText() + this.children[++i].toText();\n\n        while (this.children[i + 1] instanceof TextNode) {\n          text += this.children[++i].toText();\n        }\n\n        node.appendChild(new TextNode(text).toNode());\n      } else {\n        node.appendChild(this.children[i].toNode());\n      }\n    }\n\n    return node;\n  }\n  /**\n   * Converts the math node into an HTML markup string.\n   */\n\n\n  toMarkup() {\n    var markup = \"<\" + this.type; // Add the attributes\n\n    for (var attr in this.attributes) {\n      if (Object.prototype.hasOwnProperty.call(this.attributes, attr)) {\n        markup += \" \" + attr + \"=\\\"\";\n        markup += utils.escape(this.attributes[attr]);\n        markup += \"\\\"\";\n      }\n    }\n\n    if (this.classes.length > 0) {\n      markup += \" class =\\\"\" + utils.escape(createClass(this.classes)) + \"\\\"\";\n    }\n\n    markup += \">\";\n\n    for (var i = 0; i < this.children.length; i++) {\n      markup += this.children[i].toMarkup();\n    }\n\n    markup += \"</\" + this.type + \">\";\n    return markup;\n  }\n  /**\n   * Converts the math node into a string, similar to innerText, but escaped.\n   */\n\n\n  toText() {\n    return this.children.map(child => child.toText()).join(\"\");\n  }\n\n}\n/**\n * This node represents a piece of text.\n */\n\nclass TextNode {\n  constructor(text) {\n    this.text = void 0;\n    this.text = text;\n  }\n  /**\n   * Converts the text node into a DOM text node.\n   */\n\n\n  toNode() {\n    return document.createTextNode(this.text);\n  }\n  /**\n   * Converts the text node into escaped HTML markup\n   * (representing the text itself).\n   */\n\n\n  toMarkup() {\n    return utils.escape(this.toText());\n  }\n  /**\n   * Converts the text node into a string\n   * (representing the text itself).\n   */\n\n\n  toText() {\n    return this.text;\n  }\n\n}\n/**\n * This node represents a space, but may render as <mspace.../> or as text,\n * depending on the width.\n */\n\nclass SpaceNode {\n  /**\n   * Create a Space node with width given in CSS ems.\n   */\n  constructor(width) {\n    this.width = void 0;\n    this.character = void 0;\n    this.width = width; // See https://www.w3.org/TR/2000/WD-MathML2-20000328/chapter6.html\n    // for a table of space-like characters.  We use Unicode\n    // representations instead of &LongNames; as it's not clear how to\n    // make the latter via document.createTextNode.\n\n    if (width >= 0.05555 && width <= 0.05556) {\n      this.character = \"\\u200a\"; // &VeryThinSpace;\n    } else if (width >= 0.1666 && width <= 0.1667) {\n      this.character = \"\\u2009\"; // &ThinSpace;\n    } else if (width >= 0.2222 && width <= 0.2223) {\n      this.character = \"\\u2005\"; // &MediumSpace;\n    } else if (width >= 0.2777 && width <= 0.2778) {\n      this.character = \"\\u2005\\u200a\"; // &ThickSpace;\n    } else if (width >= -0.05556 && width <= -0.05555) {\n      this.character = \"\\u200a\\u2063\"; // &NegativeVeryThinSpace;\n    } else if (width >= -0.1667 && width <= -0.1666) {\n      this.character = \"\\u2009\\u2063\"; // &NegativeThinSpace;\n    } else if (width >= -0.2223 && width <= -0.2222) {\n      this.character = \"\\u205f\\u2063\"; // &NegativeMediumSpace;\n    } else if (width >= -0.2778 && width <= -0.2777) {\n      this.character = \"\\u2005\\u2063\"; // &NegativeThickSpace;\n    } else {\n      this.character = null;\n    }\n  }\n  /**\n   * Converts the math node into a MathML-namespaced DOM element.\n   */\n\n\n  toNode() {\n    if (this.character) {\n      return document.createTextNode(this.character);\n    } else {\n      var node = document.createElementNS(\"http://www.w3.org/1998/Math/MathML\", \"mspace\");\n      node.setAttribute(\"width\", makeEm(this.width));\n      return node;\n    }\n  }\n  /**\n   * Converts the math node into an HTML markup string.\n   */\n\n\n  toMarkup() {\n    if (this.character) {\n      return \"<mtext>\" + this.character + \"</mtext>\";\n    } else {\n      return \"<mspace width=\\\"\" + makeEm(this.width) + \"\\\"/>\";\n    }\n  }\n  /**\n   * Converts the math node into a string, similar to innerText.\n   */\n\n\n  toText() {\n    if (this.character) {\n      return this.character;\n    } else {\n      return \" \";\n    }\n  }\n\n}\n\nvar mathMLTree = {\n  MathNode,\n  TextNode,\n  SpaceNode,\n  newDocumentFragment\n};\n\n/**\n * This file converts a parse tree into a corresponding MathML tree. The main\n * entry point is the `buildMathML` function, which takes a parse tree from the\n * parser.\n */\n\n/**\n * Takes a symbol and converts it into a MathML text node after performing\n * optional replacement from symbols.js.\n */\nvar makeText = function makeText(text, mode, options) {\n  if (symbols[mode][text] && symbols[mode][text].replace && text.charCodeAt(0) !== 0xD835 && !(ligatures.hasOwnProperty(text) && options && (options.fontFamily && options.fontFamily.slice(4, 6) === \"tt\" || options.font && options.font.slice(4, 6) === \"tt\"))) {\n    text = symbols[mode][text].replace;\n  }\n\n  return new mathMLTree.TextNode(text);\n};\n/**\n * Wrap the given array of nodes in an <mrow> node if needed, i.e.,\n * unless the array has length 1.  Always returns a single node.\n */\n\nvar makeRow = function makeRow(body) {\n  if (body.length === 1) {\n    return body[0];\n  } else {\n    return new mathMLTree.MathNode(\"mrow\", body);\n  }\n};\n/**\n * Returns the math variant as a string or null if none is required.\n */\n\nvar getVariant = function getVariant(group, options) {\n  // Handle \\text... font specifiers as best we can.\n  // MathML has a limited list of allowable mathvariant specifiers; see\n  // https://www.w3.org/TR/MathML3/chapter3.html#presm.commatt\n  if (options.fontFamily === \"texttt\") {\n    return \"monospace\";\n  } else if (options.fontFamily === \"textsf\") {\n    if (options.fontShape === \"textit\" && options.fontWeight === \"textbf\") {\n      return \"sans-serif-bold-italic\";\n    } else if (options.fontShape === \"textit\") {\n      return \"sans-serif-italic\";\n    } else if (options.fontWeight === \"textbf\") {\n      return \"bold-sans-serif\";\n    } else {\n      return \"sans-serif\";\n    }\n  } else if (options.fontShape === \"textit\" && options.fontWeight === \"textbf\") {\n    return \"bold-italic\";\n  } else if (options.fontShape === \"textit\") {\n    return \"italic\";\n  } else if (options.fontWeight === \"textbf\") {\n    return \"bold\";\n  }\n\n  var font = options.font;\n\n  if (!font || font === \"mathnormal\") {\n    return null;\n  }\n\n  var mode = group.mode;\n\n  if (font === \"mathit\") {\n    return \"italic\";\n  } else if (font === \"boldsymbol\") {\n    return group.type === \"textord\" ? \"bold\" : \"bold-italic\";\n  } else if (font === \"mathbf\") {\n    return \"bold\";\n  } else if (font === \"mathbb\") {\n    return \"double-struck\";\n  } else if (font === \"mathsfit\") {\n    return \"sans-serif-italic\";\n  } else if (font === \"mathfrak\") {\n    return \"fraktur\";\n  } else if (font === \"mathscr\" || font === \"mathcal\") {\n    // MathML makes no distinction between script and calligraphic\n    return \"script\";\n  } else if (font === \"mathsf\") {\n    return \"sans-serif\";\n  } else if (font === \"mathtt\") {\n    return \"monospace\";\n  }\n\n  var text = group.text;\n\n  if (utils.contains([\"\\\\imath\", \"\\\\jmath\"], text)) {\n    return null;\n  }\n\n  if (symbols[mode][text] && symbols[mode][text].replace) {\n    text = symbols[mode][text].replace;\n  }\n\n  var fontName = buildCommon.fontMap[font].fontName;\n\n  if (getCharacterMetrics(text, fontName, mode)) {\n    return buildCommon.fontMap[font].variant;\n  }\n\n  return null;\n};\n/**\n * Check for <mi>.</mi> which is how a dot renders in MathML,\n * or <mo separator=\"true\" lspace=\"0em\" rspace=\"0em\">,</mo>\n * which is how a braced comma {,} renders in MathML\n */\n\nfunction isNumberPunctuation(group) {\n  if (!group) {\n    return false;\n  }\n\n  if (group.type === 'mi' && group.children.length === 1) {\n    var child = group.children[0];\n    return child instanceof TextNode && child.text === '.';\n  } else if (group.type === 'mo' && group.children.length === 1 && group.getAttribute('separator') === 'true' && group.getAttribute('lspace') === '0em' && group.getAttribute('rspace') === '0em') {\n    var _child = group.children[0];\n    return _child instanceof TextNode && _child.text === ',';\n  } else {\n    return false;\n  }\n}\n/**\n * Takes a list of nodes, builds them, and returns a list of the generated\n * MathML nodes.  Also combine consecutive <mtext> outputs into a single\n * <mtext> tag.\n */\n\n\nvar buildExpression = function buildExpression(expression, options, isOrdgroup) {\n  if (expression.length === 1) {\n    var group = buildGroup(expression[0], options);\n\n    if (isOrdgroup && group instanceof MathNode && group.type === \"mo\") {\n      // When TeX writers want to suppress spacing on an operator,\n      // they often put the operator by itself inside braces.\n      group.setAttribute(\"lspace\", \"0em\");\n      group.setAttribute(\"rspace\", \"0em\");\n    }\n\n    return [group];\n  }\n\n  var groups = [];\n  var lastGroup;\n\n  for (var i = 0; i < expression.length; i++) {\n    var _group = buildGroup(expression[i], options);\n\n    if (_group instanceof MathNode && lastGroup instanceof MathNode) {\n      // Concatenate adjacent <mtext>s\n      if (_group.type === 'mtext' && lastGroup.type === 'mtext' && _group.getAttribute('mathvariant') === lastGroup.getAttribute('mathvariant')) {\n        lastGroup.children.push(..._group.children);\n        continue; // Concatenate adjacent <mn>s\n      } else if (_group.type === 'mn' && lastGroup.type === 'mn') {\n        lastGroup.children.push(..._group.children);\n        continue; // Concatenate <mn>...</mn> followed by <mi>.</mi>\n      } else if (isNumberPunctuation(_group) && lastGroup.type === 'mn') {\n        lastGroup.children.push(..._group.children);\n        continue; // Concatenate <mi>.</mi> followed by <mn>...</mn>\n      } else if (_group.type === 'mn' && isNumberPunctuation(lastGroup)) {\n        _group.children = [...lastGroup.children, ..._group.children];\n        groups.pop(); // Put preceding <mn>...</mn> or <mi>.</mi> inside base of\n        // <msup><mn>...base...</mn>...exponent...</msup> (or <msub>)\n      } else if ((_group.type === 'msup' || _group.type === 'msub') && _group.children.length >= 1 && (lastGroup.type === 'mn' || isNumberPunctuation(lastGroup))) {\n        var base = _group.children[0];\n\n        if (base instanceof MathNode && base.type === 'mn') {\n          base.children = [...lastGroup.children, ...base.children];\n          groups.pop();\n        } // \\not\n\n      } else if (lastGroup.type === 'mi' && lastGroup.children.length === 1) {\n        var lastChild = lastGroup.children[0];\n\n        if (lastChild instanceof TextNode && lastChild.text === '\\u0338' && (_group.type === 'mo' || _group.type === 'mi' || _group.type === 'mn')) {\n          var child = _group.children[0];\n\n          if (child instanceof TextNode && child.text.length > 0) {\n            // Overlay with combining character long solidus\n            child.text = child.text.slice(0, 1) + \"\\u0338\" + child.text.slice(1);\n            groups.pop();\n          }\n        }\n      }\n    }\n\n    groups.push(_group);\n    lastGroup = _group;\n  }\n\n  return groups;\n};\n/**\n * Equivalent to buildExpression, but wraps the elements in an <mrow>\n * if there's more than one.  Returns a single node instead of an array.\n */\n\nvar buildExpressionRow = function buildExpressionRow(expression, options, isOrdgroup) {\n  return makeRow(buildExpression(expression, options, isOrdgroup));\n};\n/**\n * Takes a group from the parser and calls the appropriate groupBuilders function\n * on it to produce a MathML node.\n */\n\nvar buildGroup = function buildGroup(group, options) {\n  if (!group) {\n    return new mathMLTree.MathNode(\"mrow\");\n  }\n\n  if (_mathmlGroupBuilders[group.type]) {\n    // Call the groupBuilders function\n    // $FlowFixMe\n    var result = _mathmlGroupBuilders[group.type](group, options); // $FlowFixMe\n\n    return result;\n  } else {\n    throw new ParseError(\"Got group of unknown type: '\" + group.type + \"'\");\n  }\n};\n/**\n * Takes a full parse tree and settings and builds a MathML representation of\n * it. In particular, we put the elements from building the parse tree into a\n * <semantics> tag so we can also include that TeX source as an annotation.\n *\n * Note that we actually return a domTree element with a `<math>` inside it so\n * we can do appropriate styling.\n */\n\nfunction buildMathML(tree, texExpression, options, isDisplayMode, forMathmlOnly) {\n  var expression = buildExpression(tree, options); // TODO: Make a pass thru the MathML similar to buildHTML.traverseNonSpaceNodes\n  // and add spacing nodes. This is necessary only adjacent to math operators\n  // like \\sin or \\lim or to subsup elements that contain math operators.\n  // MathML takes care of the other spacing issues.\n  // Wrap up the expression in an mrow so it is presented in the semantics\n  // tag correctly, unless it's a single <mrow> or <mtable>.\n\n  var wrapper;\n\n  if (expression.length === 1 && expression[0] instanceof MathNode && utils.contains([\"mrow\", \"mtable\"], expression[0].type)) {\n    wrapper = expression[0];\n  } else {\n    wrapper = new mathMLTree.MathNode(\"mrow\", expression);\n  } // Build a TeX annotation of the source\n\n\n  var annotation = new mathMLTree.MathNode(\"annotation\", [new mathMLTree.TextNode(texExpression)]);\n  annotation.setAttribute(\"encoding\", \"application/x-tex\");\n  var semantics = new mathMLTree.MathNode(\"semantics\", [wrapper, annotation]);\n  var math = new mathMLTree.MathNode(\"math\", [semantics]);\n  math.setAttribute(\"xmlns\", \"http://www.w3.org/1998/Math/MathML\");\n\n  if (isDisplayMode) {\n    math.setAttribute(\"display\", \"block\");\n  } // You can't style <math> nodes, so we wrap the node in a span.\n  // NOTE: The span class is not typed to have <math> nodes as children, and\n  // we don't want to make the children type more generic since the children\n  // of span are expected to have more fields in `buildHtml` contexts.\n\n\n  var wrapperClass = forMathmlOnly ? \"katex\" : \"katex-mathml\"; // $FlowFixMe\n\n  return buildCommon.makeSpan([wrapperClass], [math]);\n}\n\nvar optionsFromSettings = function optionsFromSettings(settings) {\n  return new Options({\n    style: settings.displayMode ? Style$1.DISPLAY : Style$1.TEXT,\n    maxSize: settings.maxSize,\n    minRuleThickness: settings.minRuleThickness\n  });\n};\n\nvar displayWrap = function displayWrap(node, settings) {\n  if (settings.displayMode) {\n    var classes = [\"katex-display\"];\n\n    if (settings.leqno) {\n      classes.push(\"leqno\");\n    }\n\n    if (settings.fleqn) {\n      classes.push(\"fleqn\");\n    }\n\n    node = buildCommon.makeSpan(classes, [node]);\n  }\n\n  return node;\n};\n\nvar buildTree = function buildTree(tree, expression, settings) {\n  var options = optionsFromSettings(settings);\n  var katexNode;\n\n  if (settings.output === \"mathml\") {\n    return buildMathML(tree, expression, options, settings.displayMode, true);\n  } else if (settings.output === \"html\") {\n    var htmlNode = buildHTML(tree, options);\n    katexNode = buildCommon.makeSpan([\"katex\"], [htmlNode]);\n  } else {\n    var mathMLNode = buildMathML(tree, expression, options, settings.displayMode, false);\n\n    var _htmlNode = buildHTML(tree, options);\n\n    katexNode = buildCommon.makeSpan([\"katex\"], [mathMLNode, _htmlNode]);\n  }\n\n  return displayWrap(katexNode, settings);\n};\nvar buildHTMLTree = function buildHTMLTree(tree, expression, settings) {\n  var options = optionsFromSettings(settings);\n  var htmlNode = buildHTML(tree, options);\n  var katexNode = buildCommon.makeSpan([\"katex\"], [htmlNode]);\n  return displayWrap(katexNode, settings);\n};\n\n/**\n * This file provides support to buildMathML.js and buildHTML.js\n * for stretchy wide elements rendered from SVG files\n * and other CSS trickery.\n */\nvar stretchyCodePoint = {\n  widehat: \"^\",\n  widecheck: \"ˇ\",\n  widetilde: \"~\",\n  utilde: \"~\",\n  overleftarrow: \"\\u2190\",\n  underleftarrow: \"\\u2190\",\n  xleftarrow: \"\\u2190\",\n  overrightarrow: \"\\u2192\",\n  underrightarrow: \"\\u2192\",\n  xrightarrow: \"\\u2192\",\n  underbrace: \"\\u23df\",\n  overbrace: \"\\u23de\",\n  overgroup: \"\\u23e0\",\n  undergroup: \"\\u23e1\",\n  overleftrightarrow: \"\\u2194\",\n  underleftrightarrow: \"\\u2194\",\n  xleftrightarrow: \"\\u2194\",\n  Overrightarrow: \"\\u21d2\",\n  xRightarrow: \"\\u21d2\",\n  overleftharpoon: \"\\u21bc\",\n  xleftharpoonup: \"\\u21bc\",\n  overrightharpoon: \"\\u21c0\",\n  xrightharpoonup: \"\\u21c0\",\n  xLeftarrow: \"\\u21d0\",\n  xLeftrightarrow: \"\\u21d4\",\n  xhookleftarrow: \"\\u21a9\",\n  xhookrightarrow: \"\\u21aa\",\n  xmapsto: \"\\u21a6\",\n  xrightharpoondown: \"\\u21c1\",\n  xleftharpoondown: \"\\u21bd\",\n  xrightleftharpoons: \"\\u21cc\",\n  xleftrightharpoons: \"\\u21cb\",\n  xtwoheadleftarrow: \"\\u219e\",\n  xtwoheadrightarrow: \"\\u21a0\",\n  xlongequal: \"=\",\n  xtofrom: \"\\u21c4\",\n  xrightleftarrows: \"\\u21c4\",\n  xrightequilibrium: \"\\u21cc\",\n  // Not a perfect match.\n  xleftequilibrium: \"\\u21cb\",\n  // None better available.\n  \"\\\\cdrightarrow\": \"\\u2192\",\n  \"\\\\cdleftarrow\": \"\\u2190\",\n  \"\\\\cdlongequal\": \"=\"\n};\n\nvar mathMLnode = function mathMLnode(label) {\n  var node = new mathMLTree.MathNode(\"mo\", [new mathMLTree.TextNode(stretchyCodePoint[label.replace(/^\\\\/, '')])]);\n  node.setAttribute(\"stretchy\", \"true\");\n  return node;\n}; // Many of the KaTeX SVG images have been adapted from glyphs in KaTeX fonts.\n// Copyright (c) 2009-2010, Design Science, Inc. (<www.mathjax.org>)\n// Copyright (c) 2014-2017 Khan Academy (<www.khanacademy.org>)\n// Licensed under the SIL Open Font License, Version 1.1.\n// See \\nhttp://scripts.sil.org/OFL\n// Very Long SVGs\n//    Many of the KaTeX stretchy wide elements use a long SVG image and an\n//    overflow: hidden tactic to achieve a stretchy image while avoiding\n//    distortion of arrowheads or brace corners.\n//    The SVG typically contains a very long (400 em) arrow.\n//    The SVG is in a container span that has overflow: hidden, so the span\n//    acts like a window that exposes only part of the  SVG.\n//    The SVG always has a longer, thinner aspect ratio than the container span.\n//    After the SVG fills 100% of the height of the container span,\n//    there is a long arrow shaft left over. That left-over shaft is not shown.\n//    Instead, it is sliced off because the span's CSS has overflow: hidden.\n//    Thus, the reader sees an arrow that matches the subject matter width\n//    without distortion.\n//    Some functions, such as \\cancel, need to vary their aspect ratio. These\n//    functions do not get the overflow SVG treatment.\n// Second Brush Stroke\n//    Low resolution monitors struggle to display images in fine detail.\n//    So browsers apply anti-aliasing. A long straight arrow shaft therefore\n//    will sometimes appear as if it has a blurred edge.\n//    To mitigate this, these SVG files contain a second \"brush-stroke\" on the\n//    arrow shafts. That is, a second long thin rectangular SVG path has been\n//    written directly on top of each arrow shaft. This reinforcement causes\n//    some of the screen pixels to display as black instead of the anti-aliased\n//    gray pixel that a  single path would generate. So we get arrow shafts\n//    whose edges appear to be sharper.\n// In the katexImagesData object just below, the dimensions all\n// correspond to path geometry inside the relevant SVG.\n// For example, \\overrightarrow uses the same arrowhead as glyph U+2192\n// from the KaTeX Main font. The scaling factor is 1000.\n// That is, inside the font, that arrowhead is 522 units tall, which\n// corresponds to 0.522 em inside the document.\n\n\nvar katexImagesData = {\n  //   path(s), minWidth, height, align\n  overrightarrow: [[\"rightarrow\"], 0.888, 522, \"xMaxYMin\"],\n  overleftarrow: [[\"leftarrow\"], 0.888, 522, \"xMinYMin\"],\n  underrightarrow: [[\"rightarrow\"], 0.888, 522, \"xMaxYMin\"],\n  underleftarrow: [[\"leftarrow\"], 0.888, 522, \"xMinYMin\"],\n  xrightarrow: [[\"rightarrow\"], 1.469, 522, \"xMaxYMin\"],\n  \"\\\\cdrightarrow\": [[\"rightarrow\"], 3.0, 522, \"xMaxYMin\"],\n  // CD minwwidth2.5pc\n  xleftarrow: [[\"leftarrow\"], 1.469, 522, \"xMinYMin\"],\n  \"\\\\cdleftarrow\": [[\"leftarrow\"], 3.0, 522, \"xMinYMin\"],\n  Overrightarrow: [[\"doublerightarrow\"], 0.888, 560, \"xMaxYMin\"],\n  xRightarrow: [[\"doublerightarrow\"], 1.526, 560, \"xMaxYMin\"],\n  xLeftarrow: [[\"doubleleftarrow\"], 1.526, 560, \"xMinYMin\"],\n  overleftharpoon: [[\"leftharpoon\"], 0.888, 522, \"xMinYMin\"],\n  xleftharpoonup: [[\"leftharpoon\"], 0.888, 522, \"xMinYMin\"],\n  xleftharpoondown: [[\"leftharpoondown\"], 0.888, 522, \"xMinYMin\"],\n  overrightharpoon: [[\"rightharpoon\"], 0.888, 522, \"xMaxYMin\"],\n  xrightharpoonup: [[\"rightharpoon\"], 0.888, 522, \"xMaxYMin\"],\n  xrightharpoondown: [[\"rightharpoondown\"], 0.888, 522, \"xMaxYMin\"],\n  xlongequal: [[\"longequal\"], 0.888, 334, \"xMinYMin\"],\n  \"\\\\cdlongequal\": [[\"longequal\"], 3.0, 334, \"xMinYMin\"],\n  xtwoheadleftarrow: [[\"twoheadleftarrow\"], 0.888, 334, \"xMinYMin\"],\n  xtwoheadrightarrow: [[\"twoheadrightarrow\"], 0.888, 334, \"xMaxYMin\"],\n  overleftrightarrow: [[\"leftarrow\", \"rightarrow\"], 0.888, 522],\n  overbrace: [[\"leftbrace\", \"midbrace\", \"rightbrace\"], 1.6, 548],\n  underbrace: [[\"leftbraceunder\", \"midbraceunder\", \"rightbraceunder\"], 1.6, 548],\n  underleftrightarrow: [[\"leftarrow\", \"rightarrow\"], 0.888, 522],\n  xleftrightarrow: [[\"leftarrow\", \"rightarrow\"], 1.75, 522],\n  xLeftrightarrow: [[\"doubleleftarrow\", \"doublerightarrow\"], 1.75, 560],\n  xrightleftharpoons: [[\"leftharpoondownplus\", \"rightharpoonplus\"], 1.75, 716],\n  xleftrightharpoons: [[\"leftharpoonplus\", \"rightharpoondownplus\"], 1.75, 716],\n  xhookleftarrow: [[\"leftarrow\", \"righthook\"], 1.08, 522],\n  xhookrightarrow: [[\"lefthook\", \"rightarrow\"], 1.08, 522],\n  overlinesegment: [[\"leftlinesegment\", \"rightlinesegment\"], 0.888, 522],\n  underlinesegment: [[\"leftlinesegment\", \"rightlinesegment\"], 0.888, 522],\n  overgroup: [[\"leftgroup\", \"rightgroup\"], 0.888, 342],\n  undergroup: [[\"leftgroupunder\", \"rightgroupunder\"], 0.888, 342],\n  xmapsto: [[\"leftmapsto\", \"rightarrow\"], 1.5, 522],\n  xtofrom: [[\"leftToFrom\", \"rightToFrom\"], 1.75, 528],\n  // The next three arrows are from the mhchem package.\n  // In mhchem.sty, min-length is 2.0em. But these arrows might appear in the\n  // document as \\xrightarrow or \\xrightleftharpoons. Those have\n  // min-length = 1.75em, so we set min-length on these next three to match.\n  xrightleftarrows: [[\"baraboveleftarrow\", \"rightarrowabovebar\"], 1.75, 901],\n  xrightequilibrium: [[\"baraboveshortleftharpoon\", \"rightharpoonaboveshortbar\"], 1.75, 716],\n  xleftequilibrium: [[\"shortbaraboveleftharpoon\", \"shortrightharpoonabovebar\"], 1.75, 716]\n};\n\nvar groupLength = function groupLength(arg) {\n  if (arg.type === \"ordgroup\") {\n    return arg.body.length;\n  } else {\n    return 1;\n  }\n};\n\nvar svgSpan = function svgSpan(group, options) {\n  // Create a span with inline SVG for the element.\n  function buildSvgSpan_() {\n    var viewBoxWidth = 400000; // default\n\n    var label = group.label.slice(1);\n\n    if (utils.contains([\"widehat\", \"widecheck\", \"widetilde\", \"utilde\"], label)) {\n      // Each type in the `if` statement corresponds to one of the ParseNode\n      // types below. This narrowing is required to access `grp.base`.\n      // $FlowFixMe\n      var grp = group; // There are four SVG images available for each function.\n      // Choose a taller image when there are more characters.\n\n      var numChars = groupLength(grp.base);\n      var viewBoxHeight;\n      var pathName;\n\n      var _height;\n\n      if (numChars > 5) {\n        if (label === \"widehat\" || label === \"widecheck\") {\n          viewBoxHeight = 420;\n          viewBoxWidth = 2364;\n          _height = 0.42;\n          pathName = label + \"4\";\n        } else {\n          viewBoxHeight = 312;\n          viewBoxWidth = 2340;\n          _height = 0.34;\n          pathName = \"tilde4\";\n        }\n      } else {\n        var imgIndex = [1, 1, 2, 2, 3, 3][numChars];\n\n        if (label === \"widehat\" || label === \"widecheck\") {\n          viewBoxWidth = [0, 1062, 2364, 2364, 2364][imgIndex];\n          viewBoxHeight = [0, 239, 300, 360, 420][imgIndex];\n          _height = [0, 0.24, 0.3, 0.3, 0.36, 0.42][imgIndex];\n          pathName = label + imgIndex;\n        } else {\n          viewBoxWidth = [0, 600, 1033, 2339, 2340][imgIndex];\n          viewBoxHeight = [0, 260, 286, 306, 312][imgIndex];\n          _height = [0, 0.26, 0.286, 0.3, 0.306, 0.34][imgIndex];\n          pathName = \"tilde\" + imgIndex;\n        }\n      }\n\n      var path = new PathNode(pathName);\n      var svgNode = new SvgNode([path], {\n        \"width\": \"100%\",\n        \"height\": makeEm(_height),\n        \"viewBox\": \"0 0 \" + viewBoxWidth + \" \" + viewBoxHeight,\n        \"preserveAspectRatio\": \"none\"\n      });\n      return {\n        span: buildCommon.makeSvgSpan([], [svgNode], options),\n        minWidth: 0,\n        height: _height\n      };\n    } else {\n      var spans = [];\n      var data = katexImagesData[label];\n      var [paths, _minWidth, _viewBoxHeight] = data;\n\n      var _height2 = _viewBoxHeight / 1000;\n\n      var numSvgChildren = paths.length;\n      var widthClasses;\n      var aligns;\n\n      if (numSvgChildren === 1) {\n        // $FlowFixMe: All these cases must be of the 4-tuple type.\n        var align1 = data[3];\n        widthClasses = [\"hide-tail\"];\n        aligns = [align1];\n      } else if (numSvgChildren === 2) {\n        widthClasses = [\"halfarrow-left\", \"halfarrow-right\"];\n        aligns = [\"xMinYMin\", \"xMaxYMin\"];\n      } else if (numSvgChildren === 3) {\n        widthClasses = [\"brace-left\", \"brace-center\", \"brace-right\"];\n        aligns = [\"xMinYMin\", \"xMidYMin\", \"xMaxYMin\"];\n      } else {\n        throw new Error(\"Correct katexImagesData or update code here to support\\n                    \" + numSvgChildren + \" children.\");\n      }\n\n      for (var i = 0; i < numSvgChildren; i++) {\n        var _path = new PathNode(paths[i]);\n\n        var _svgNode = new SvgNode([_path], {\n          \"width\": \"400em\",\n          \"height\": makeEm(_height2),\n          \"viewBox\": \"0 0 \" + viewBoxWidth + \" \" + _viewBoxHeight,\n          \"preserveAspectRatio\": aligns[i] + \" slice\"\n        });\n\n        var _span = buildCommon.makeSvgSpan([widthClasses[i]], [_svgNode], options);\n\n        if (numSvgChildren === 1) {\n          return {\n            span: _span,\n            minWidth: _minWidth,\n            height: _height2\n          };\n        } else {\n          _span.style.height = makeEm(_height2);\n          spans.push(_span);\n        }\n      }\n\n      return {\n        span: buildCommon.makeSpan([\"stretchy\"], spans, options),\n        minWidth: _minWidth,\n        height: _height2\n      };\n    }\n  } // buildSvgSpan_()\n\n\n  var {\n    span,\n    minWidth,\n    height\n  } = buildSvgSpan_(); // Note that we are returning span.depth = 0.\n  // Any adjustments relative to the baseline must be done in buildHTML.\n\n  span.height = height;\n  span.style.height = makeEm(height);\n\n  if (minWidth > 0) {\n    span.style.minWidth = makeEm(minWidth);\n  }\n\n  return span;\n};\n\nvar encloseSpan = function encloseSpan(inner, label, topPad, bottomPad, options) {\n  // Return an image span for \\cancel, \\bcancel, \\xcancel, \\fbox, or \\angl\n  var img;\n  var totalHeight = inner.height + inner.depth + topPad + bottomPad;\n\n  if (/fbox|color|angl/.test(label)) {\n    img = buildCommon.makeSpan([\"stretchy\", label], [], options);\n\n    if (label === \"fbox\") {\n      var color = options.color && options.getColor();\n\n      if (color) {\n        img.style.borderColor = color;\n      }\n    }\n  } else {\n    // \\cancel, \\bcancel, or \\xcancel\n    // Since \\cancel's SVG is inline and it omits the viewBox attribute,\n    // its stroke-width will not vary with span area.\n    var lines = [];\n\n    if (/^[bx]cancel$/.test(label)) {\n      lines.push(new LineNode({\n        \"x1\": \"0\",\n        \"y1\": \"0\",\n        \"x2\": \"100%\",\n        \"y2\": \"100%\",\n        \"stroke-width\": \"0.046em\"\n      }));\n    }\n\n    if (/^x?cancel$/.test(label)) {\n      lines.push(new LineNode({\n        \"x1\": \"0\",\n        \"y1\": \"100%\",\n        \"x2\": \"100%\",\n        \"y2\": \"0\",\n        \"stroke-width\": \"0.046em\"\n      }));\n    }\n\n    var svgNode = new SvgNode(lines, {\n      \"width\": \"100%\",\n      \"height\": makeEm(totalHeight)\n    });\n    img = buildCommon.makeSvgSpan([], [svgNode], options);\n  }\n\n  img.height = totalHeight;\n  img.style.height = makeEm(totalHeight);\n  return img;\n};\n\nvar stretchy = {\n  encloseSpan,\n  mathMLnode,\n  svgSpan\n};\n\n/**\n * Asserts that the node is of the given type and returns it with stricter\n * typing. Throws if the node's type does not match.\n */\nfunction assertNodeType(node, type) {\n  if (!node || node.type !== type) {\n    throw new Error(\"Expected node of type \" + type + \", but got \" + (node ? \"node of type \" + node.type : String(node)));\n  } // $FlowFixMe, >=0.125\n\n\n  return node;\n}\n/**\n * Returns the node more strictly typed iff it is of the given type. Otherwise,\n * returns null.\n */\n\nfunction assertSymbolNodeType(node) {\n  var typedNode = checkSymbolNodeType(node);\n\n  if (!typedNode) {\n    throw new Error(\"Expected node of symbol group type, but got \" + (node ? \"node of type \" + node.type : String(node)));\n  }\n\n  return typedNode;\n}\n/**\n * Returns the node more strictly typed iff it is of the given type. Otherwise,\n * returns null.\n */\n\nfunction checkSymbolNodeType(node) {\n  if (node && (node.type === \"atom\" || NON_ATOMS.hasOwnProperty(node.type))) {\n    // $FlowFixMe\n    return node;\n  }\n\n  return null;\n}\n\n// NOTE: Unlike most `htmlBuilder`s, this one handles not only \"accent\", but\n// also \"supsub\" since an accent can affect super/subscripting.\nvar htmlBuilder$a = (grp, options) => {\n  // Accents are handled in the TeXbook pg. 443, rule 12.\n  var base;\n  var group;\n  var supSubGroup;\n\n  if (grp && grp.type === \"supsub\") {\n    // If our base is a character box, and we have superscripts and\n    // subscripts, the supsub will defer to us. In particular, we want\n    // to attach the superscripts and subscripts to the inner body (so\n    // that the position of the superscripts and subscripts won't be\n    // affected by the height of the accent). We accomplish this by\n    // sticking the base of the accent into the base of the supsub, and\n    // rendering that, while keeping track of where the accent is.\n    // The real accent group is the base of the supsub group\n    group = assertNodeType(grp.base, \"accent\"); // The character box is the base of the accent group\n\n    base = group.base; // Stick the character box into the base of the supsub group\n\n    grp.base = base; // Rerender the supsub group with its new base, and store that\n    // result.\n\n    supSubGroup = assertSpan(buildGroup$1(grp, options)); // reset original base\n\n    grp.base = group;\n  } else {\n    group = assertNodeType(grp, \"accent\");\n    base = group.base;\n  } // Build the base group\n\n\n  var body = buildGroup$1(base, options.havingCrampedStyle()); // Does the accent need to shift for the skew of a character?\n\n  var mustShift = group.isShifty && utils.isCharacterBox(base); // Calculate the skew of the accent. This is based on the line \"If the\n  // nucleus is not a single character, let s = 0; otherwise set s to the\n  // kern amount for the nucleus followed by the \\skewchar of its font.\"\n  // Note that our skew metrics are just the kern between each character\n  // and the skewchar.\n\n  var skew = 0;\n\n  if (mustShift) {\n    // If the base is a character box, then we want the skew of the\n    // innermost character. To do that, we find the innermost character:\n    var baseChar = utils.getBaseElem(base); // Then, we render its group to get the symbol inside it\n\n    var baseGroup = buildGroup$1(baseChar, options.havingCrampedStyle()); // Finally, we pull the skew off of the symbol.\n\n    skew = assertSymbolDomNode(baseGroup).skew; // Note that we now throw away baseGroup, because the layers we\n    // removed with getBaseElem might contain things like \\color which\n    // we can't get rid of.\n    // TODO(emily): Find a better way to get the skew\n  }\n\n  var accentBelow = group.label === \"\\\\c\"; // calculate the amount of space between the body and the accent\n\n  var clearance = accentBelow ? body.height + body.depth : Math.min(body.height, options.fontMetrics().xHeight); // Build the accent\n\n  var accentBody;\n\n  if (!group.isStretchy) {\n    var accent;\n    var width;\n\n    if (group.label === \"\\\\vec\") {\n      // Before version 0.9, \\vec used the combining font glyph U+20D7.\n      // But browsers, especially Safari, are not consistent in how they\n      // render combining characters when not preceded by a character.\n      // So now we use an SVG.\n      // If Safari reforms, we should consider reverting to the glyph.\n      accent = buildCommon.staticSvg(\"vec\", options);\n      width = buildCommon.svgData.vec[1];\n    } else {\n      accent = buildCommon.makeOrd({\n        mode: group.mode,\n        text: group.label\n      }, options, \"textord\");\n      accent = assertSymbolDomNode(accent); // Remove the italic correction of the accent, because it only serves to\n      // shift the accent over to a place we don't want.\n\n      accent.italic = 0;\n      width = accent.width;\n\n      if (accentBelow) {\n        clearance += accent.depth;\n      }\n    }\n\n    accentBody = buildCommon.makeSpan([\"accent-body\"], [accent]); // \"Full\" accents expand the width of the resulting symbol to be\n    // at least the width of the accent, and overlap directly onto the\n    // character without any vertical offset.\n\n    var accentFull = group.label === \"\\\\textcircled\";\n\n    if (accentFull) {\n      accentBody.classes.push('accent-full');\n      clearance = body.height;\n    } // Shift the accent over by the skew.\n\n\n    var left = skew; // CSS defines `.katex .accent .accent-body:not(.accent-full) { width: 0 }`\n    // so that the accent doesn't contribute to the bounding box.\n    // We need to shift the character by its width (effectively half\n    // its width) to compensate.\n\n    if (!accentFull) {\n      left -= width / 2;\n    }\n\n    accentBody.style.left = makeEm(left); // \\textcircled uses the \\bigcirc glyph, so it needs some\n    // vertical adjustment to match LaTeX.\n\n    if (group.label === \"\\\\textcircled\") {\n      accentBody.style.top = \".2em\";\n    }\n\n    accentBody = buildCommon.makeVList({\n      positionType: \"firstBaseline\",\n      children: [{\n        type: \"elem\",\n        elem: body\n      }, {\n        type: \"kern\",\n        size: -clearance\n      }, {\n        type: \"elem\",\n        elem: accentBody\n      }]\n    }, options);\n  } else {\n    accentBody = stretchy.svgSpan(group, options);\n    accentBody = buildCommon.makeVList({\n      positionType: \"firstBaseline\",\n      children: [{\n        type: \"elem\",\n        elem: body\n      }, {\n        type: \"elem\",\n        elem: accentBody,\n        wrapperClasses: [\"svg-align\"],\n        wrapperStyle: skew > 0 ? {\n          width: \"calc(100% - \" + makeEm(2 * skew) + \")\",\n          marginLeft: makeEm(2 * skew)\n        } : undefined\n      }]\n    }, options);\n  }\n\n  var accentWrap = buildCommon.makeSpan([\"mord\", \"accent\"], [accentBody], options);\n\n  if (supSubGroup) {\n    // Here, we replace the \"base\" child of the supsub with our newly\n    // generated accent.\n    supSubGroup.children[0] = accentWrap; // Since we don't rerun the height calculation after replacing the\n    // accent, we manually recalculate height.\n\n    supSubGroup.height = Math.max(accentWrap.height, supSubGroup.height); // Accents should always be ords, even when their innards are not.\n\n    supSubGroup.classes[0] = \"mord\";\n    return supSubGroup;\n  } else {\n    return accentWrap;\n  }\n};\n\nvar mathmlBuilder$9 = (group, options) => {\n  var accentNode = group.isStretchy ? stretchy.mathMLnode(group.label) : new mathMLTree.MathNode(\"mo\", [makeText(group.label, group.mode)]);\n  var node = new mathMLTree.MathNode(\"mover\", [buildGroup(group.base, options), accentNode]);\n  node.setAttribute(\"accent\", \"true\");\n  return node;\n};\n\nvar NON_STRETCHY_ACCENT_REGEX = new RegExp([\"\\\\acute\", \"\\\\grave\", \"\\\\ddot\", \"\\\\tilde\", \"\\\\bar\", \"\\\\breve\", \"\\\\check\", \"\\\\hat\", \"\\\\vec\", \"\\\\dot\", \"\\\\mathring\"].map(accent => \"\\\\\" + accent).join(\"|\")); // Accents\n\ndefineFunction({\n  type: \"accent\",\n  names: [\"\\\\acute\", \"\\\\grave\", \"\\\\ddot\", \"\\\\tilde\", \"\\\\bar\", \"\\\\breve\", \"\\\\check\", \"\\\\hat\", \"\\\\vec\", \"\\\\dot\", \"\\\\mathring\", \"\\\\widecheck\", \"\\\\widehat\", \"\\\\widetilde\", \"\\\\overrightarrow\", \"\\\\overleftarrow\", \"\\\\Overrightarrow\", \"\\\\overleftrightarrow\", \"\\\\overgroup\", \"\\\\overlinesegment\", \"\\\\overleftharpoon\", \"\\\\overrightharpoon\"],\n  props: {\n    numArgs: 1\n  },\n  handler: (context, args) => {\n    var base = normalizeArgument(args[0]);\n    var isStretchy = !NON_STRETCHY_ACCENT_REGEX.test(context.funcName);\n    var isShifty = !isStretchy || context.funcName === \"\\\\widehat\" || context.funcName === \"\\\\widetilde\" || context.funcName === \"\\\\widecheck\";\n    return {\n      type: \"accent\",\n      mode: context.parser.mode,\n      label: context.funcName,\n      isStretchy: isStretchy,\n      isShifty: isShifty,\n      base: base\n    };\n  },\n  htmlBuilder: htmlBuilder$a,\n  mathmlBuilder: mathmlBuilder$9\n}); // Text-mode accents\n\ndefineFunction({\n  type: \"accent\",\n  names: [\"\\\\'\", \"\\\\`\", \"\\\\^\", \"\\\\~\", \"\\\\=\", \"\\\\u\", \"\\\\.\", '\\\\\"', \"\\\\c\", \"\\\\r\", \"\\\\H\", \"\\\\v\", \"\\\\textcircled\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true,\n    allowedInMath: true,\n    // unless in strict mode\n    argTypes: [\"primitive\"]\n  },\n  handler: (context, args) => {\n    var base = args[0];\n    var mode = context.parser.mode;\n\n    if (mode === \"math\") {\n      context.parser.settings.reportNonstrict(\"mathVsTextAccents\", \"LaTeX's accent \" + context.funcName + \" works only in text mode\");\n      mode = \"text\";\n    }\n\n    return {\n      type: \"accent\",\n      mode: mode,\n      label: context.funcName,\n      isStretchy: false,\n      isShifty: true,\n      base: base\n    };\n  },\n  htmlBuilder: htmlBuilder$a,\n  mathmlBuilder: mathmlBuilder$9\n});\n\n// Horizontal overlap functions\ndefineFunction({\n  type: \"accentUnder\",\n  names: [\"\\\\underleftarrow\", \"\\\\underrightarrow\", \"\\\\underleftrightarrow\", \"\\\\undergroup\", \"\\\\underlinesegment\", \"\\\\utilde\"],\n  props: {\n    numArgs: 1\n  },\n  handler: (_ref, args) => {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var base = args[0];\n    return {\n      type: \"accentUnder\",\n      mode: parser.mode,\n      label: funcName,\n      base: base\n    };\n  },\n  htmlBuilder: (group, options) => {\n    // Treat under accents much like underlines.\n    var innerGroup = buildGroup$1(group.base, options);\n    var accentBody = stretchy.svgSpan(group, options);\n    var kern = group.label === \"\\\\utilde\" ? 0.12 : 0; // Generate the vlist, with the appropriate kerns\n\n    var vlist = buildCommon.makeVList({\n      positionType: \"top\",\n      positionData: innerGroup.height,\n      children: [{\n        type: \"elem\",\n        elem: accentBody,\n        wrapperClasses: [\"svg-align\"]\n      }, {\n        type: \"kern\",\n        size: kern\n      }, {\n        type: \"elem\",\n        elem: innerGroup\n      }]\n    }, options);\n    return buildCommon.makeSpan([\"mord\", \"accentunder\"], [vlist], options);\n  },\n  mathmlBuilder: (group, options) => {\n    var accentNode = stretchy.mathMLnode(group.label);\n    var node = new mathMLTree.MathNode(\"munder\", [buildGroup(group.base, options), accentNode]);\n    node.setAttribute(\"accentunder\", \"true\");\n    return node;\n  }\n});\n\n// Helper function\nvar paddedNode = group => {\n  var node = new mathMLTree.MathNode(\"mpadded\", group ? [group] : []);\n  node.setAttribute(\"width\", \"+0.6em\");\n  node.setAttribute(\"lspace\", \"0.3em\");\n  return node;\n}; // Stretchy arrows with an optional argument\n\n\ndefineFunction({\n  type: \"xArrow\",\n  names: [\"\\\\xleftarrow\", \"\\\\xrightarrow\", \"\\\\xLeftarrow\", \"\\\\xRightarrow\", \"\\\\xleftrightarrow\", \"\\\\xLeftrightarrow\", \"\\\\xhookleftarrow\", \"\\\\xhookrightarrow\", \"\\\\xmapsto\", \"\\\\xrightharpoondown\", \"\\\\xrightharpoonup\", \"\\\\xleftharpoondown\", \"\\\\xleftharpoonup\", \"\\\\xrightleftharpoons\", \"\\\\xleftrightharpoons\", \"\\\\xlongequal\", \"\\\\xtwoheadrightarrow\", \"\\\\xtwoheadleftarrow\", \"\\\\xtofrom\", // The next 3 functions are here to support the mhchem extension.\n  // Direct use of these functions is discouraged and may break someday.\n  \"\\\\xrightleftarrows\", \"\\\\xrightequilibrium\", \"\\\\xleftequilibrium\", // The next 3 functions are here only to support the {CD} environment.\n  \"\\\\\\\\cdrightarrow\", \"\\\\\\\\cdleftarrow\", \"\\\\\\\\cdlongequal\"],\n  props: {\n    numArgs: 1,\n    numOptionalArgs: 1\n  },\n\n  handler(_ref, args, optArgs) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    return {\n      type: \"xArrow\",\n      mode: parser.mode,\n      label: funcName,\n      body: args[0],\n      below: optArgs[0]\n    };\n  },\n\n  // Flow is unable to correctly infer the type of `group`, even though it's\n  // unambiguously determined from the passed-in `type` above.\n  htmlBuilder(group, options) {\n    var style = options.style; // Build the argument groups in the appropriate style.\n    // Ref: amsmath.dtx:   \\hbox{$\\scriptstyle\\mkern#3mu{#6}\\mkern#4mu$}%\n    // Some groups can return document fragments.  Handle those by wrapping\n    // them in a span.\n\n    var newOptions = options.havingStyle(style.sup());\n    var upperGroup = buildCommon.wrapFragment(buildGroup$1(group.body, newOptions, options), options);\n    var arrowPrefix = group.label.slice(0, 2) === \"\\\\x\" ? \"x\" : \"cd\";\n    upperGroup.classes.push(arrowPrefix + \"-arrow-pad\");\n    var lowerGroup;\n\n    if (group.below) {\n      // Build the lower group\n      newOptions = options.havingStyle(style.sub());\n      lowerGroup = buildCommon.wrapFragment(buildGroup$1(group.below, newOptions, options), options);\n      lowerGroup.classes.push(arrowPrefix + \"-arrow-pad\");\n    }\n\n    var arrowBody = stretchy.svgSpan(group, options); // Re shift: Note that stretchy.svgSpan returned arrowBody.depth = 0.\n    // The point we want on the math axis is at 0.5 * arrowBody.height.\n\n    var arrowShift = -options.fontMetrics().axisHeight + 0.5 * arrowBody.height; // 2 mu kern. Ref: amsmath.dtx: #7\\if0#2\\else\\mkern#2mu\\fi\n\n    var upperShift = -options.fontMetrics().axisHeight - 0.5 * arrowBody.height - 0.111; // 0.111 em = 2 mu\n\n    if (upperGroup.depth > 0.25 || group.label === \"\\\\xleftequilibrium\") {\n      upperShift -= upperGroup.depth; // shift up if depth encroaches\n    } // Generate the vlist\n\n\n    var vlist;\n\n    if (lowerGroup) {\n      var lowerShift = -options.fontMetrics().axisHeight + lowerGroup.height + 0.5 * arrowBody.height + 0.111;\n      vlist = buildCommon.makeVList({\n        positionType: \"individualShift\",\n        children: [{\n          type: \"elem\",\n          elem: upperGroup,\n          shift: upperShift\n        }, {\n          type: \"elem\",\n          elem: arrowBody,\n          shift: arrowShift\n        }, {\n          type: \"elem\",\n          elem: lowerGroup,\n          shift: lowerShift\n        }]\n      }, options);\n    } else {\n      vlist = buildCommon.makeVList({\n        positionType: \"individualShift\",\n        children: [{\n          type: \"elem\",\n          elem: upperGroup,\n          shift: upperShift\n        }, {\n          type: \"elem\",\n          elem: arrowBody,\n          shift: arrowShift\n        }]\n      }, options);\n    } // $FlowFixMe: Replace this with passing \"svg-align\" into makeVList.\n\n\n    vlist.children[0].children[0].children[1].classes.push(\"svg-align\");\n    return buildCommon.makeSpan([\"mrel\", \"x-arrow\"], [vlist], options);\n  },\n\n  mathmlBuilder(group, options) {\n    var arrowNode = stretchy.mathMLnode(group.label);\n    arrowNode.setAttribute(\"minsize\", group.label.charAt(0) === \"x\" ? \"1.75em\" : \"3.0em\");\n    var node;\n\n    if (group.body) {\n      var upperNode = paddedNode(buildGroup(group.body, options));\n\n      if (group.below) {\n        var lowerNode = paddedNode(buildGroup(group.below, options));\n        node = new mathMLTree.MathNode(\"munderover\", [arrowNode, lowerNode, upperNode]);\n      } else {\n        node = new mathMLTree.MathNode(\"mover\", [arrowNode, upperNode]);\n      }\n    } else if (group.below) {\n      var _lowerNode = paddedNode(buildGroup(group.below, options));\n\n      node = new mathMLTree.MathNode(\"munder\", [arrowNode, _lowerNode]);\n    } else {\n      // This should never happen.\n      // Parser.js throws an error if there is no argument.\n      node = paddedNode();\n      node = new mathMLTree.MathNode(\"mover\", [arrowNode, node]);\n    }\n\n    return node;\n  }\n\n});\n\nvar makeSpan = buildCommon.makeSpan;\n\nfunction htmlBuilder$9(group, options) {\n  var elements = buildExpression$1(group.body, options, true);\n  return makeSpan([group.mclass], elements, options);\n}\n\nfunction mathmlBuilder$8(group, options) {\n  var node;\n  var inner = buildExpression(group.body, options);\n\n  if (group.mclass === \"minner\") {\n    node = new mathMLTree.MathNode(\"mpadded\", inner);\n  } else if (group.mclass === \"mord\") {\n    if (group.isCharacterBox) {\n      node = inner[0];\n      node.type = \"mi\";\n    } else {\n      node = new mathMLTree.MathNode(\"mi\", inner);\n    }\n  } else {\n    if (group.isCharacterBox) {\n      node = inner[0];\n      node.type = \"mo\";\n    } else {\n      node = new mathMLTree.MathNode(\"mo\", inner);\n    } // Set spacing based on what is the most likely adjacent atom type.\n    // See TeXbook p170.\n\n\n    if (group.mclass === \"mbin\") {\n      node.attributes.lspace = \"0.22em\"; // medium space\n\n      node.attributes.rspace = \"0.22em\";\n    } else if (group.mclass === \"mpunct\") {\n      node.attributes.lspace = \"0em\";\n      node.attributes.rspace = \"0.17em\"; // thinspace\n    } else if (group.mclass === \"mopen\" || group.mclass === \"mclose\") {\n      node.attributes.lspace = \"0em\";\n      node.attributes.rspace = \"0em\";\n    } else if (group.mclass === \"minner\") {\n      node.attributes.lspace = \"0.0556em\"; // 1 mu is the most likely option\n\n      node.attributes.width = \"+0.1111em\";\n    } // MathML <mo> default space is 5/18 em, so <mrel> needs no action.\n    // Ref: https://developer.mozilla.org/en-US/docs/Web/MathML/Element/mo\n\n  }\n\n  return node;\n} // Math class commands except \\mathop\n\n\ndefineFunction({\n  type: \"mclass\",\n  names: [\"\\\\mathord\", \"\\\\mathbin\", \"\\\\mathrel\", \"\\\\mathopen\", \"\\\\mathclose\", \"\\\\mathpunct\", \"\\\\mathinner\"],\n  props: {\n    numArgs: 1,\n    primitive: true\n  },\n\n  handler(_ref, args) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var body = args[0];\n    return {\n      type: \"mclass\",\n      mode: parser.mode,\n      mclass: \"m\" + funcName.slice(5),\n      // TODO(kevinb): don't prefix with 'm'\n      body: ordargument(body),\n      isCharacterBox: utils.isCharacterBox(body)\n    };\n  },\n\n  htmlBuilder: htmlBuilder$9,\n  mathmlBuilder: mathmlBuilder$8\n});\nvar binrelClass = arg => {\n  // \\binrel@ spacing varies with (bin|rel|ord) of the atom in the argument.\n  // (by rendering separately and with {}s before and after, and measuring\n  // the change in spacing).  We'll do roughly the same by detecting the\n  // atom type directly.\n  var atom = arg.type === \"ordgroup\" && arg.body.length ? arg.body[0] : arg;\n\n  if (atom.type === \"atom\" && (atom.family === \"bin\" || atom.family === \"rel\")) {\n    return \"m\" + atom.family;\n  } else {\n    return \"mord\";\n  }\n}; // \\@binrel{x}{y} renders like y but as mbin/mrel/mord if x is mbin/mrel/mord.\n// This is equivalent to \\binrel@{x}\\binrel@@{y} in AMSTeX.\n\ndefineFunction({\n  type: \"mclass\",\n  names: [\"\\\\@binrel\"],\n  props: {\n    numArgs: 2\n  },\n\n  handler(_ref2, args) {\n    var {\n      parser\n    } = _ref2;\n    return {\n      type: \"mclass\",\n      mode: parser.mode,\n      mclass: binrelClass(args[0]),\n      body: ordargument(args[1]),\n      isCharacterBox: utils.isCharacterBox(args[1])\n    };\n  }\n\n}); // Build a relation or stacked op by placing one symbol on top of another\n\ndefineFunction({\n  type: \"mclass\",\n  names: [\"\\\\stackrel\", \"\\\\overset\", \"\\\\underset\"],\n  props: {\n    numArgs: 2\n  },\n\n  handler(_ref3, args) {\n    var {\n      parser,\n      funcName\n    } = _ref3;\n    var baseArg = args[1];\n    var shiftedArg = args[0];\n    var mclass;\n\n    if (funcName !== \"\\\\stackrel\") {\n      // LaTeX applies \\binrel spacing to \\overset and \\underset.\n      mclass = binrelClass(baseArg);\n    } else {\n      mclass = \"mrel\"; // for \\stackrel\n    }\n\n    var baseOp = {\n      type: \"op\",\n      mode: baseArg.mode,\n      limits: true,\n      alwaysHandleSupSub: true,\n      parentIsSupSub: false,\n      symbol: false,\n      suppressBaseShift: funcName !== \"\\\\stackrel\",\n      body: ordargument(baseArg)\n    };\n    var supsub = {\n      type: \"supsub\",\n      mode: shiftedArg.mode,\n      base: baseOp,\n      sup: funcName === \"\\\\underset\" ? null : shiftedArg,\n      sub: funcName === \"\\\\underset\" ? shiftedArg : null\n    };\n    return {\n      type: \"mclass\",\n      mode: parser.mode,\n      mclass,\n      body: [supsub],\n      isCharacterBox: utils.isCharacterBox(supsub)\n    };\n  },\n\n  htmlBuilder: htmlBuilder$9,\n  mathmlBuilder: mathmlBuilder$8\n});\n\n// \\pmb is a simulation of bold font.\n// The version of \\pmb in ambsy.sty works by typesetting three copies\n// with small offsets. We use CSS text-shadow.\n// It's a hack. Not as good as a real bold font. Better than nothing.\ndefineFunction({\n  type: \"pmb\",\n  names: [\"\\\\pmb\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true\n  },\n\n  handler(_ref, args) {\n    var {\n      parser\n    } = _ref;\n    return {\n      type: \"pmb\",\n      mode: parser.mode,\n      mclass: binrelClass(args[0]),\n      body: ordargument(args[0])\n    };\n  },\n\n  htmlBuilder(group, options) {\n    var elements = buildExpression$1(group.body, options, true);\n    var node = buildCommon.makeSpan([group.mclass], elements, options);\n    node.style.textShadow = \"0.02em 0.01em 0.04px\";\n    return node;\n  },\n\n  mathmlBuilder(group, style) {\n    var inner = buildExpression(group.body, style); // Wrap with an <mstyle> element.\n\n    var node = new mathMLTree.MathNode(\"mstyle\", inner);\n    node.setAttribute(\"style\", \"text-shadow: 0.02em 0.01em 0.04px\");\n    return node;\n  }\n\n});\n\nvar cdArrowFunctionName = {\n  \">\": \"\\\\\\\\cdrightarrow\",\n  \"<\": \"\\\\\\\\cdleftarrow\",\n  \"=\": \"\\\\\\\\cdlongequal\",\n  \"A\": \"\\\\uparrow\",\n  \"V\": \"\\\\downarrow\",\n  \"|\": \"\\\\Vert\",\n  \".\": \"no arrow\"\n};\n\nvar newCell = () => {\n  // Create an empty cell, to be filled below with parse nodes.\n  // The parseTree from this module must be constructed like the\n  // one created by parseArray(), so an empty CD cell must\n  // be a ParseNode<\"styling\">. And CD is always displaystyle.\n  // So these values are fixed and flow can do implicit typing.\n  return {\n    type: \"styling\",\n    body: [],\n    mode: \"math\",\n    style: \"display\"\n  };\n};\n\nvar isStartOfArrow = node => {\n  return node.type === \"textord\" && node.text === \"@\";\n};\n\nvar isLabelEnd = (node, endChar) => {\n  return (node.type === \"mathord\" || node.type === \"atom\") && node.text === endChar;\n};\n\nfunction cdArrow(arrowChar, labels, parser) {\n  // Return a parse tree of an arrow and its labels.\n  // This acts in a way similar to a macro expansion.\n  var funcName = cdArrowFunctionName[arrowChar];\n\n  switch (funcName) {\n    case \"\\\\\\\\cdrightarrow\":\n    case \"\\\\\\\\cdleftarrow\":\n      return parser.callFunction(funcName, [labels[0]], [labels[1]]);\n\n    case \"\\\\uparrow\":\n    case \"\\\\downarrow\":\n      {\n        var leftLabel = parser.callFunction(\"\\\\\\\\cdleft\", [labels[0]], []);\n        var bareArrow = {\n          type: \"atom\",\n          text: funcName,\n          mode: \"math\",\n          family: \"rel\"\n        };\n        var sizedArrow = parser.callFunction(\"\\\\Big\", [bareArrow], []);\n        var rightLabel = parser.callFunction(\"\\\\\\\\cdright\", [labels[1]], []);\n        var arrowGroup = {\n          type: \"ordgroup\",\n          mode: \"math\",\n          body: [leftLabel, sizedArrow, rightLabel]\n        };\n        return parser.callFunction(\"\\\\\\\\cdparent\", [arrowGroup], []);\n      }\n\n    case \"\\\\\\\\cdlongequal\":\n      return parser.callFunction(\"\\\\\\\\cdlongequal\", [], []);\n\n    case \"\\\\Vert\":\n      {\n        var arrow = {\n          type: \"textord\",\n          text: \"\\\\Vert\",\n          mode: \"math\"\n        };\n        return parser.callFunction(\"\\\\Big\", [arrow], []);\n      }\n\n    default:\n      return {\n        type: \"textord\",\n        text: \" \",\n        mode: \"math\"\n      };\n  }\n}\n\nfunction parseCD(parser) {\n  // Get the array's parse nodes with \\\\ temporarily mapped to \\cr.\n  var parsedRows = [];\n  parser.gullet.beginGroup();\n  parser.gullet.macros.set(\"\\\\cr\", \"\\\\\\\\\\\\relax\");\n  parser.gullet.beginGroup();\n\n  while (true) {\n    // eslint-disable-line no-constant-condition\n    // Get the parse nodes for the next row.\n    parsedRows.push(parser.parseExpression(false, \"\\\\\\\\\"));\n    parser.gullet.endGroup();\n    parser.gullet.beginGroup();\n    var next = parser.fetch().text;\n\n    if (next === \"&\" || next === \"\\\\\\\\\") {\n      parser.consume();\n    } else if (next === \"\\\\end\") {\n      if (parsedRows[parsedRows.length - 1].length === 0) {\n        parsedRows.pop(); // final row ended in \\\\\n      }\n\n      break;\n    } else {\n      throw new ParseError(\"Expected \\\\\\\\ or \\\\cr or \\\\end\", parser.nextToken);\n    }\n  }\n\n  var row = [];\n  var body = [row]; // Loop thru the parse nodes. Collect them into cells and arrows.\n\n  for (var i = 0; i < parsedRows.length; i++) {\n    // Start a new row.\n    var rowNodes = parsedRows[i]; // Create the first cell.\n\n    var cell = newCell();\n\n    for (var j = 0; j < rowNodes.length; j++) {\n      if (!isStartOfArrow(rowNodes[j])) {\n        // If a parseNode is not an arrow, it goes into a cell.\n        cell.body.push(rowNodes[j]);\n      } else {\n        // Parse node j is an \"@\", the start of an arrow.\n        // Before starting on the arrow, push the cell into `row`.\n        row.push(cell); // Now collect parseNodes into an arrow.\n        // The character after \"@\" defines the arrow type.\n\n        j += 1;\n        var arrowChar = assertSymbolNodeType(rowNodes[j]).text; // Create two empty label nodes. We may or may not use them.\n\n        var labels = new Array(2);\n        labels[0] = {\n          type: \"ordgroup\",\n          mode: \"math\",\n          body: []\n        };\n        labels[1] = {\n          type: \"ordgroup\",\n          mode: \"math\",\n          body: []\n        }; // Process the arrow.\n\n        if (\"=|.\".indexOf(arrowChar) > -1) ; else if (\"<>AV\".indexOf(arrowChar) > -1) {\n          // Four arrows, `@>>>`, `@<<<`, `@AAA`, and `@VVV`, each take\n          // two optional labels. E.g. the right-point arrow syntax is\n          // really:  @>{optional label}>{optional label}>\n          // Collect parseNodes into labels.\n          for (var labelNum = 0; labelNum < 2; labelNum++) {\n            var inLabel = true;\n\n            for (var k = j + 1; k < rowNodes.length; k++) {\n              if (isLabelEnd(rowNodes[k], arrowChar)) {\n                inLabel = false;\n                j = k;\n                break;\n              }\n\n              if (isStartOfArrow(rowNodes[k])) {\n                throw new ParseError(\"Missing a \" + arrowChar + \" character to complete a CD arrow.\", rowNodes[k]);\n              }\n\n              labels[labelNum].body.push(rowNodes[k]);\n            }\n\n            if (inLabel) {\n              // isLabelEnd never returned a true.\n              throw new ParseError(\"Missing a \" + arrowChar + \" character to complete a CD arrow.\", rowNodes[j]);\n            }\n          }\n        } else {\n          throw new ParseError(\"Expected one of \\\"<>AV=|.\\\" after @\", rowNodes[j]);\n        } // Now join the arrow to its labels.\n\n\n        var arrow = cdArrow(arrowChar, labels, parser); // Wrap the arrow in  ParseNode<\"styling\">.\n        // This is done to match parseArray() behavior.\n\n        var wrappedArrow = {\n          type: \"styling\",\n          body: [arrow],\n          mode: \"math\",\n          style: \"display\" // CD is always displaystyle.\n\n        };\n        row.push(wrappedArrow); // In CD's syntax, cells are implicit. That is, everything that\n        // is not an arrow gets collected into a cell. So create an empty\n        // cell now. It will collect upcoming parseNodes.\n\n        cell = newCell();\n      }\n    }\n\n    if (i % 2 === 0) {\n      // Even-numbered rows consist of: cell, arrow, cell, arrow, ... cell\n      // The last cell is not yet pushed into `row`, so:\n      row.push(cell);\n    } else {\n      // Odd-numbered rows consist of: vert arrow, empty cell, ... vert arrow\n      // Remove the empty cell that was placed at the beginning of `row`.\n      row.shift();\n    }\n\n    row = [];\n    body.push(row);\n  } // End row group\n\n\n  parser.gullet.endGroup(); // End array group defining \\\\\n\n  parser.gullet.endGroup(); // define column separation.\n\n  var cols = new Array(body[0].length).fill({\n    type: \"align\",\n    align: \"c\",\n    pregap: 0.25,\n    // CD package sets \\enskip between columns.\n    postgap: 0.25 // So pre and post each get half an \\enskip, i.e. 0.25em.\n\n  });\n  return {\n    type: \"array\",\n    mode: \"math\",\n    body,\n    arraystretch: 1,\n    addJot: true,\n    rowGaps: [null],\n    cols,\n    colSeparationType: \"CD\",\n    hLinesBeforeRow: new Array(body.length + 1).fill([])\n  };\n} // The functions below are not available for general use.\n// They are here only for internal use by the {CD} environment in placing labels\n// next to vertical arrows.\n// We don't need any such functions for horizontal arrows because we can reuse\n// the functionality that already exists for extensible arrows.\n\ndefineFunction({\n  type: \"cdlabel\",\n  names: [\"\\\\\\\\cdleft\", \"\\\\\\\\cdright\"],\n  props: {\n    numArgs: 1\n  },\n\n  handler(_ref, args) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    return {\n      type: \"cdlabel\",\n      mode: parser.mode,\n      side: funcName.slice(4),\n      label: args[0]\n    };\n  },\n\n  htmlBuilder(group, options) {\n    var newOptions = options.havingStyle(options.style.sup());\n    var label = buildCommon.wrapFragment(buildGroup$1(group.label, newOptions, options), options);\n    label.classes.push(\"cd-label-\" + group.side);\n    label.style.bottom = makeEm(0.8 - label.depth); // Zero out label height & depth, so vertical align of arrow is set\n    // by the arrow height, not by the label.\n\n    label.height = 0;\n    label.depth = 0;\n    return label;\n  },\n\n  mathmlBuilder(group, options) {\n    var label = new mathMLTree.MathNode(\"mrow\", [buildGroup(group.label, options)]);\n    label = new mathMLTree.MathNode(\"mpadded\", [label]);\n    label.setAttribute(\"width\", \"0\");\n\n    if (group.side === \"left\") {\n      label.setAttribute(\"lspace\", \"-1width\");\n    } // We have to guess at vertical alignment. We know the arrow is 1.8em tall,\n    // But we don't know the height or depth of the label.\n\n\n    label.setAttribute(\"voffset\", \"0.7em\");\n    label = new mathMLTree.MathNode(\"mstyle\", [label]);\n    label.setAttribute(\"displaystyle\", \"false\");\n    label.setAttribute(\"scriptlevel\", \"1\");\n    return label;\n  }\n\n});\ndefineFunction({\n  type: \"cdlabelparent\",\n  names: [\"\\\\\\\\cdparent\"],\n  props: {\n    numArgs: 1\n  },\n\n  handler(_ref2, args) {\n    var {\n      parser\n    } = _ref2;\n    return {\n      type: \"cdlabelparent\",\n      mode: parser.mode,\n      fragment: args[0]\n    };\n  },\n\n  htmlBuilder(group, options) {\n    // Wrap the vertical arrow and its labels.\n    // The parent gets position: relative. The child gets position: absolute.\n    // So CSS can locate the label correctly.\n    var parent = buildCommon.wrapFragment(buildGroup$1(group.fragment, options), options);\n    parent.classes.push(\"cd-vert-arrow\");\n    return parent;\n  },\n\n  mathmlBuilder(group, options) {\n    return new mathMLTree.MathNode(\"mrow\", [buildGroup(group.fragment, options)]);\n  }\n\n});\n\n// {123} and converts into symbol with code 123.  It is used by the *macro*\n// \\char defined in macros.js.\n\ndefineFunction({\n  type: \"textord\",\n  names: [\"\\\\@char\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true\n  },\n\n  handler(_ref, args) {\n    var {\n      parser\n    } = _ref;\n    var arg = assertNodeType(args[0], \"ordgroup\");\n    var group = arg.body;\n    var number = \"\";\n\n    for (var i = 0; i < group.length; i++) {\n      var node = assertNodeType(group[i], \"textord\");\n      number += node.text;\n    }\n\n    var code = parseInt(number);\n    var text;\n\n    if (isNaN(code)) {\n      throw new ParseError(\"\\\\@char has non-numeric argument \" + number); // If we drop IE support, the following code could be replaced with\n      // text = String.fromCodePoint(code)\n    } else if (code < 0 || code >= 0x10ffff) {\n      throw new ParseError(\"\\\\@char with invalid code point \" + number);\n    } else if (code <= 0xffff) {\n      text = String.fromCharCode(code);\n    } else {\n      // Astral code point; split into surrogate halves\n      code -= 0x10000;\n      text = String.fromCharCode((code >> 10) + 0xd800, (code & 0x3ff) + 0xdc00);\n    }\n\n    return {\n      type: \"textord\",\n      mode: parser.mode,\n      text: text\n    };\n  }\n\n});\n\nvar htmlBuilder$8 = (group, options) => {\n  var elements = buildExpression$1(group.body, options.withColor(group.color), false); // \\color isn't supposed to affect the type of the elements it contains.\n  // To accomplish this, we wrap the results in a fragment, so the inner\n  // elements will be able to directly interact with their neighbors. For\n  // example, `\\color{red}{2 +} 3` has the same spacing as `2 + 3`\n\n  return buildCommon.makeFragment(elements);\n};\n\nvar mathmlBuilder$7 = (group, options) => {\n  var inner = buildExpression(group.body, options.withColor(group.color));\n  var node = new mathMLTree.MathNode(\"mstyle\", inner);\n  node.setAttribute(\"mathcolor\", group.color);\n  return node;\n};\n\ndefineFunction({\n  type: \"color\",\n  names: [\"\\\\textcolor\"],\n  props: {\n    numArgs: 2,\n    allowedInText: true,\n    argTypes: [\"color\", \"original\"]\n  },\n\n  handler(_ref, args) {\n    var {\n      parser\n    } = _ref;\n    var color = assertNodeType(args[0], \"color-token\").color;\n    var body = args[1];\n    return {\n      type: \"color\",\n      mode: parser.mode,\n      color,\n      body: ordargument(body)\n    };\n  },\n\n  htmlBuilder: htmlBuilder$8,\n  mathmlBuilder: mathmlBuilder$7\n});\ndefineFunction({\n  type: \"color\",\n  names: [\"\\\\color\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true,\n    argTypes: [\"color\"]\n  },\n\n  handler(_ref2, args) {\n    var {\n      parser,\n      breakOnTokenText\n    } = _ref2;\n    var color = assertNodeType(args[0], \"color-token\").color; // Set macro \\current@color in current namespace to store the current\n    // color, mimicking the behavior of color.sty.\n    // This is currently used just to correctly color a \\right\n    // that follows a \\color command.\n\n    parser.gullet.macros.set(\"\\\\current@color\", color); // Parse out the implicit body that should be colored.\n\n    var body = parser.parseExpression(true, breakOnTokenText);\n    return {\n      type: \"color\",\n      mode: parser.mode,\n      color,\n      body\n    };\n  },\n\n  htmlBuilder: htmlBuilder$8,\n  mathmlBuilder: mathmlBuilder$7\n});\n\n// Row breaks within tabular environments, and line breaks at top level\n\ndefineFunction({\n  type: \"cr\",\n  names: [\"\\\\\\\\\"],\n  props: {\n    numArgs: 0,\n    numOptionalArgs: 0,\n    allowedInText: true\n  },\n\n  handler(_ref, args, optArgs) {\n    var {\n      parser\n    } = _ref;\n    var size = parser.gullet.future().text === \"[\" ? parser.parseSizeGroup(true) : null;\n    var newLine = !parser.settings.displayMode || !parser.settings.useStrictBehavior(\"newLineInDisplayMode\", \"In LaTeX, \\\\\\\\ or \\\\newline \" + \"does nothing in display mode\");\n    return {\n      type: \"cr\",\n      mode: parser.mode,\n      newLine,\n      size: size && assertNodeType(size, \"size\").value\n    };\n  },\n\n  // The following builders are called only at the top level,\n  // not within tabular/array environments.\n  htmlBuilder(group, options) {\n    var span = buildCommon.makeSpan([\"mspace\"], [], options);\n\n    if (group.newLine) {\n      span.classes.push(\"newline\");\n\n      if (group.size) {\n        span.style.marginTop = makeEm(calculateSize(group.size, options));\n      }\n    }\n\n    return span;\n  },\n\n  mathmlBuilder(group, options) {\n    var node = new mathMLTree.MathNode(\"mspace\");\n\n    if (group.newLine) {\n      node.setAttribute(\"linebreak\", \"newline\");\n\n      if (group.size) {\n        node.setAttribute(\"height\", makeEm(calculateSize(group.size, options)));\n      }\n    }\n\n    return node;\n  }\n\n});\n\nvar globalMap = {\n  \"\\\\global\": \"\\\\global\",\n  \"\\\\long\": \"\\\\\\\\globallong\",\n  \"\\\\\\\\globallong\": \"\\\\\\\\globallong\",\n  \"\\\\def\": \"\\\\gdef\",\n  \"\\\\gdef\": \"\\\\gdef\",\n  \"\\\\edef\": \"\\\\xdef\",\n  \"\\\\xdef\": \"\\\\xdef\",\n  \"\\\\let\": \"\\\\\\\\globallet\",\n  \"\\\\futurelet\": \"\\\\\\\\globalfuture\"\n};\n\nvar checkControlSequence = tok => {\n  var name = tok.text;\n\n  if (/^(?:[\\\\{}$&#^_]|EOF)$/.test(name)) {\n    throw new ParseError(\"Expected a control sequence\", tok);\n  }\n\n  return name;\n};\n\nvar getRHS = parser => {\n  var tok = parser.gullet.popToken();\n\n  if (tok.text === \"=\") {\n    // consume optional equals\n    tok = parser.gullet.popToken();\n\n    if (tok.text === \" \") {\n      // consume one optional space\n      tok = parser.gullet.popToken();\n    }\n  }\n\n  return tok;\n};\n\nvar letCommand = (parser, name, tok, global) => {\n  var macro = parser.gullet.macros.get(tok.text);\n\n  if (macro == null) {\n    // don't expand it later even if a macro with the same name is defined\n    // e.g., \\let\\foo=\\frac \\def\\frac{\\relax} \\frac12\n    tok.noexpand = true;\n    macro = {\n      tokens: [tok],\n      numArgs: 0,\n      // reproduce the same behavior in expansion\n      unexpandable: !parser.gullet.isExpandable(tok.text)\n    };\n  }\n\n  parser.gullet.macros.set(name, macro, global);\n}; // <assignment> -> <non-macro assignment>|<macro assignment>\n// <non-macro assignment> -> <simple assignment>|\\global<non-macro assignment>\n// <macro assignment> -> <definition>|<prefix><macro assignment>\n// <prefix> -> \\global|\\long|\\outer\n\n\ndefineFunction({\n  type: \"internal\",\n  names: [\"\\\\global\", \"\\\\long\", \"\\\\\\\\globallong\" // can’t be entered directly\n  ],\n  props: {\n    numArgs: 0,\n    allowedInText: true\n  },\n\n  handler(_ref) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    parser.consumeSpaces();\n    var token = parser.fetch();\n\n    if (globalMap[token.text]) {\n      // KaTeX doesn't have \\par, so ignore \\long\n      if (funcName === \"\\\\global\" || funcName === \"\\\\\\\\globallong\") {\n        token.text = globalMap[token.text];\n      }\n\n      return assertNodeType(parser.parseFunction(), \"internal\");\n    }\n\n    throw new ParseError(\"Invalid token after macro prefix\", token);\n  }\n\n}); // Basic support for macro definitions: \\def, \\gdef, \\edef, \\xdef\n// <definition> -> <def><control sequence><definition text>\n// <def> -> \\def|\\gdef|\\edef|\\xdef\n// <definition text> -> <parameter text><left brace><balanced text><right brace>\n\ndefineFunction({\n  type: \"internal\",\n  names: [\"\\\\def\", \"\\\\gdef\", \"\\\\edef\", \"\\\\xdef\"],\n  props: {\n    numArgs: 0,\n    allowedInText: true,\n    primitive: true\n  },\n\n  handler(_ref2) {\n    var {\n      parser,\n      funcName\n    } = _ref2;\n    var tok = parser.gullet.popToken();\n    var name = tok.text;\n\n    if (/^(?:[\\\\{}$&#^_]|EOF)$/.test(name)) {\n      throw new ParseError(\"Expected a control sequence\", tok);\n    }\n\n    var numArgs = 0;\n    var insert;\n    var delimiters = [[]]; // <parameter text> contains no braces\n\n    while (parser.gullet.future().text !== \"{\") {\n      tok = parser.gullet.popToken();\n\n      if (tok.text === \"#\") {\n        // If the very last character of the <parameter text> is #, so that\n        // this # is immediately followed by {, TeX will behave as if the {\n        // had been inserted at the right end of both the parameter text\n        // and the replacement text.\n        if (parser.gullet.future().text === \"{\") {\n          insert = parser.gullet.future();\n          delimiters[numArgs].push(\"{\");\n          break;\n        } // A parameter, the first appearance of # must be followed by 1,\n        // the next by 2, and so on; up to nine #’s are allowed\n\n\n        tok = parser.gullet.popToken();\n\n        if (!/^[1-9]$/.test(tok.text)) {\n          throw new ParseError(\"Invalid argument number \\\"\" + tok.text + \"\\\"\");\n        }\n\n        if (parseInt(tok.text) !== numArgs + 1) {\n          throw new ParseError(\"Argument number \\\"\" + tok.text + \"\\\" out of order\");\n        }\n\n        numArgs++;\n        delimiters.push([]);\n      } else if (tok.text === \"EOF\") {\n        throw new ParseError(\"Expected a macro definition\");\n      } else {\n        delimiters[numArgs].push(tok.text);\n      }\n    } // replacement text, enclosed in '{' and '}' and properly nested\n\n\n    var {\n      tokens\n    } = parser.gullet.consumeArg();\n\n    if (insert) {\n      tokens.unshift(insert);\n    }\n\n    if (funcName === \"\\\\edef\" || funcName === \"\\\\xdef\") {\n      tokens = parser.gullet.expandTokens(tokens);\n      tokens.reverse(); // to fit in with stack order\n    } // Final arg is the expansion of the macro\n\n\n    parser.gullet.macros.set(name, {\n      tokens,\n      numArgs,\n      delimiters\n    }, funcName === globalMap[funcName]);\n    return {\n      type: \"internal\",\n      mode: parser.mode\n    };\n  }\n\n}); // <simple assignment> -> <let assignment>\n// <let assignment> -> \\futurelet<control sequence><token><token>\n//     | \\let<control sequence><equals><one optional space><token>\n// <equals> -> <optional spaces>|<optional spaces>=\n\ndefineFunction({\n  type: \"internal\",\n  names: [\"\\\\let\", \"\\\\\\\\globallet\" // can’t be entered directly\n  ],\n  props: {\n    numArgs: 0,\n    allowedInText: true,\n    primitive: true\n  },\n\n  handler(_ref3) {\n    var {\n      parser,\n      funcName\n    } = _ref3;\n    var name = checkControlSequence(parser.gullet.popToken());\n    parser.gullet.consumeSpaces();\n    var tok = getRHS(parser);\n    letCommand(parser, name, tok, funcName === \"\\\\\\\\globallet\");\n    return {\n      type: \"internal\",\n      mode: parser.mode\n    };\n  }\n\n}); // ref: https://www.tug.org/TUGboat/tb09-3/tb22bechtolsheim.pdf\n\ndefineFunction({\n  type: \"internal\",\n  names: [\"\\\\futurelet\", \"\\\\\\\\globalfuture\" // can’t be entered directly\n  ],\n  props: {\n    numArgs: 0,\n    allowedInText: true,\n    primitive: true\n  },\n\n  handler(_ref4) {\n    var {\n      parser,\n      funcName\n    } = _ref4;\n    var name = checkControlSequence(parser.gullet.popToken());\n    var middle = parser.gullet.popToken();\n    var tok = parser.gullet.popToken();\n    letCommand(parser, name, tok, funcName === \"\\\\\\\\globalfuture\");\n    parser.gullet.pushToken(tok);\n    parser.gullet.pushToken(middle);\n    return {\n      type: \"internal\",\n      mode: parser.mode\n    };\n  }\n\n});\n\n/**\n * This file deals with creating delimiters of various sizes. The TeXbook\n * discusses these routines on page 441-442, in the \"Another subroutine sets box\n * x to a specified variable delimiter\" paragraph.\n *\n * There are three main routines here. `makeSmallDelim` makes a delimiter in the\n * normal font, but in either text, script, or scriptscript style.\n * `makeLargeDelim` makes a delimiter in textstyle, but in one of the Size1,\n * Size2, Size3, or Size4 fonts. `makeStackedDelim` makes a delimiter out of\n * smaller pieces that are stacked on top of one another.\n *\n * The functions take a parameter `center`, which determines if the delimiter\n * should be centered around the axis.\n *\n * Then, there are three exposed functions. `sizedDelim` makes a delimiter in\n * one of the given sizes. This is used for things like `\\bigl`.\n * `customSizedDelim` makes a delimiter with a given total height+depth. It is\n * called in places like `\\sqrt`. `leftRightDelim` makes an appropriate\n * delimiter which surrounds an expression of a given height an depth. It is\n * used in `\\left` and `\\right`.\n */\n\n/**\n * Get the metrics for a given symbol and font, after transformation (i.e.\n * after following replacement from symbols.js)\n */\nvar getMetrics = function getMetrics(symbol, font, mode) {\n  var replace = symbols.math[symbol] && symbols.math[symbol].replace;\n  var metrics = getCharacterMetrics(replace || symbol, font, mode);\n\n  if (!metrics) {\n    throw new Error(\"Unsupported symbol \" + symbol + \" and font size \" + font + \".\");\n  }\n\n  return metrics;\n};\n/**\n * Puts a delimiter span in a given style, and adds appropriate height, depth,\n * and maxFontSizes.\n */\n\n\nvar styleWrap = function styleWrap(delim, toStyle, options, classes) {\n  var newOptions = options.havingBaseStyle(toStyle);\n  var span = buildCommon.makeSpan(classes.concat(newOptions.sizingClasses(options)), [delim], options);\n  var delimSizeMultiplier = newOptions.sizeMultiplier / options.sizeMultiplier;\n  span.height *= delimSizeMultiplier;\n  span.depth *= delimSizeMultiplier;\n  span.maxFontSize = newOptions.sizeMultiplier;\n  return span;\n};\n\nvar centerSpan = function centerSpan(span, options, style) {\n  var newOptions = options.havingBaseStyle(style);\n  var shift = (1 - options.sizeMultiplier / newOptions.sizeMultiplier) * options.fontMetrics().axisHeight;\n  span.classes.push(\"delimcenter\");\n  span.style.top = makeEm(shift);\n  span.height -= shift;\n  span.depth += shift;\n};\n/**\n * Makes a small delimiter. This is a delimiter that comes in the Main-Regular\n * font, but is restyled to either be in textstyle, scriptstyle, or\n * scriptscriptstyle.\n */\n\n\nvar makeSmallDelim = function makeSmallDelim(delim, style, center, options, mode, classes) {\n  var text = buildCommon.makeSymbol(delim, \"Main-Regular\", mode, options);\n  var span = styleWrap(text, style, options, classes);\n\n  if (center) {\n    centerSpan(span, options, style);\n  }\n\n  return span;\n};\n/**\n * Builds a symbol in the given font size (note size is an integer)\n */\n\n\nvar mathrmSize = function mathrmSize(value, size, mode, options) {\n  return buildCommon.makeSymbol(value, \"Size\" + size + \"-Regular\", mode, options);\n};\n/**\n * Makes a large delimiter. This is a delimiter that comes in the Size1, Size2,\n * Size3, or Size4 fonts. It is always rendered in textstyle.\n */\n\n\nvar makeLargeDelim = function makeLargeDelim(delim, size, center, options, mode, classes) {\n  var inner = mathrmSize(delim, size, mode, options);\n  var span = styleWrap(buildCommon.makeSpan([\"delimsizing\", \"size\" + size], [inner], options), Style$1.TEXT, options, classes);\n\n  if (center) {\n    centerSpan(span, options, Style$1.TEXT);\n  }\n\n  return span;\n};\n/**\n * Make a span from a font glyph with the given offset and in the given font.\n * This is used in makeStackedDelim to make the stacking pieces for the delimiter.\n */\n\n\nvar makeGlyphSpan = function makeGlyphSpan(symbol, font, mode) {\n  var sizeClass; // Apply the correct CSS class to choose the right font.\n\n  if (font === \"Size1-Regular\") {\n    sizeClass = \"delim-size1\";\n  } else\n    /* if (font === \"Size4-Regular\") */\n    {\n      sizeClass = \"delim-size4\";\n    }\n\n  var corner = buildCommon.makeSpan([\"delimsizinginner\", sizeClass], [buildCommon.makeSpan([], [buildCommon.makeSymbol(symbol, font, mode)])]); // Since this will be passed into `makeVList` in the end, wrap the element\n  // in the appropriate tag that VList uses.\n\n  return {\n    type: \"elem\",\n    elem: corner\n  };\n};\n\nvar makeInner = function makeInner(ch, height, options) {\n  // Create a span with inline SVG for the inner part of a tall stacked delimiter.\n  var width = fontMetricsData['Size4-Regular'][ch.charCodeAt(0)] ? fontMetricsData['Size4-Regular'][ch.charCodeAt(0)][4] : fontMetricsData['Size1-Regular'][ch.charCodeAt(0)][4];\n  var path = new PathNode(\"inner\", innerPath(ch, Math.round(1000 * height)));\n  var svgNode = new SvgNode([path], {\n    \"width\": makeEm(width),\n    \"height\": makeEm(height),\n    // Override CSS rule `.katex svg { width: 100% }`\n    \"style\": \"width:\" + makeEm(width),\n    \"viewBox\": \"0 0 \" + 1000 * width + \" \" + Math.round(1000 * height),\n    \"preserveAspectRatio\": \"xMinYMin\"\n  });\n  var span = buildCommon.makeSvgSpan([], [svgNode], options);\n  span.height = height;\n  span.style.height = makeEm(height);\n  span.style.width = makeEm(width);\n  return {\n    type: \"elem\",\n    elem: span\n  };\n}; // Helpers for makeStackedDelim\n\n\nvar lapInEms = 0.008;\nvar lap = {\n  type: \"kern\",\n  size: -1 * lapInEms\n};\nvar verts = [\"|\", \"\\\\lvert\", \"\\\\rvert\", \"\\\\vert\"];\nvar doubleVerts = [\"\\\\|\", \"\\\\lVert\", \"\\\\rVert\", \"\\\\Vert\"];\n/**\n * Make a stacked delimiter out of a given delimiter, with the total height at\n * least `heightTotal`. This routine is mentioned on page 442 of the TeXbook.\n */\n\nvar makeStackedDelim = function makeStackedDelim(delim, heightTotal, center, options, mode, classes) {\n  // There are four parts, the top, an optional middle, a repeated part, and a\n  // bottom.\n  var top;\n  var middle;\n  var repeat;\n  var bottom;\n  var svgLabel = \"\";\n  var viewBoxWidth = 0;\n  top = repeat = bottom = delim;\n  middle = null; // Also keep track of what font the delimiters are in\n\n  var font = \"Size1-Regular\"; // We set the parts and font based on the symbol. Note that we use\n  // '\\u23d0' instead of '|' and '\\u2016' instead of '\\\\|' for the\n  // repeats of the arrows\n\n  if (delim === \"\\\\uparrow\") {\n    repeat = bottom = \"\\u23d0\";\n  } else if (delim === \"\\\\Uparrow\") {\n    repeat = bottom = \"\\u2016\";\n  } else if (delim === \"\\\\downarrow\") {\n    top = repeat = \"\\u23d0\";\n  } else if (delim === \"\\\\Downarrow\") {\n    top = repeat = \"\\u2016\";\n  } else if (delim === \"\\\\updownarrow\") {\n    top = \"\\\\uparrow\";\n    repeat = \"\\u23d0\";\n    bottom = \"\\\\downarrow\";\n  } else if (delim === \"\\\\Updownarrow\") {\n    top = \"\\\\Uparrow\";\n    repeat = \"\\u2016\";\n    bottom = \"\\\\Downarrow\";\n  } else if (utils.contains(verts, delim)) {\n    repeat = \"\\u2223\";\n    svgLabel = \"vert\";\n    viewBoxWidth = 333;\n  } else if (utils.contains(doubleVerts, delim)) {\n    repeat = \"\\u2225\";\n    svgLabel = \"doublevert\";\n    viewBoxWidth = 556;\n  } else if (delim === \"[\" || delim === \"\\\\lbrack\") {\n    top = \"\\u23a1\";\n    repeat = \"\\u23a2\";\n    bottom = \"\\u23a3\";\n    font = \"Size4-Regular\";\n    svgLabel = \"lbrack\";\n    viewBoxWidth = 667;\n  } else if (delim === \"]\" || delim === \"\\\\rbrack\") {\n    top = \"\\u23a4\";\n    repeat = \"\\u23a5\";\n    bottom = \"\\u23a6\";\n    font = \"Size4-Regular\";\n    svgLabel = \"rbrack\";\n    viewBoxWidth = 667;\n  } else if (delim === \"\\\\lfloor\" || delim === \"\\u230a\") {\n    repeat = top = \"\\u23a2\";\n    bottom = \"\\u23a3\";\n    font = \"Size4-Regular\";\n    svgLabel = \"lfloor\";\n    viewBoxWidth = 667;\n  } else if (delim === \"\\\\lceil\" || delim === \"\\u2308\") {\n    top = \"\\u23a1\";\n    repeat = bottom = \"\\u23a2\";\n    font = \"Size4-Regular\";\n    svgLabel = \"lceil\";\n    viewBoxWidth = 667;\n  } else if (delim === \"\\\\rfloor\" || delim === \"\\u230b\") {\n    repeat = top = \"\\u23a5\";\n    bottom = \"\\u23a6\";\n    font = \"Size4-Regular\";\n    svgLabel = \"rfloor\";\n    viewBoxWidth = 667;\n  } else if (delim === \"\\\\rceil\" || delim === \"\\u2309\") {\n    top = \"\\u23a4\";\n    repeat = bottom = \"\\u23a5\";\n    font = \"Size4-Regular\";\n    svgLabel = \"rceil\";\n    viewBoxWidth = 667;\n  } else if (delim === \"(\" || delim === \"\\\\lparen\") {\n    top = \"\\u239b\";\n    repeat = \"\\u239c\";\n    bottom = \"\\u239d\";\n    font = \"Size4-Regular\";\n    svgLabel = \"lparen\";\n    viewBoxWidth = 875;\n  } else if (delim === \")\" || delim === \"\\\\rparen\") {\n    top = \"\\u239e\";\n    repeat = \"\\u239f\";\n    bottom = \"\\u23a0\";\n    font = \"Size4-Regular\";\n    svgLabel = \"rparen\";\n    viewBoxWidth = 875;\n  } else if (delim === \"\\\\{\" || delim === \"\\\\lbrace\") {\n    top = \"\\u23a7\";\n    middle = \"\\u23a8\";\n    bottom = \"\\u23a9\";\n    repeat = \"\\u23aa\";\n    font = \"Size4-Regular\";\n  } else if (delim === \"\\\\}\" || delim === \"\\\\rbrace\") {\n    top = \"\\u23ab\";\n    middle = \"\\u23ac\";\n    bottom = \"\\u23ad\";\n    repeat = \"\\u23aa\";\n    font = \"Size4-Regular\";\n  } else if (delim === \"\\\\lgroup\" || delim === \"\\u27ee\") {\n    top = \"\\u23a7\";\n    bottom = \"\\u23a9\";\n    repeat = \"\\u23aa\";\n    font = \"Size4-Regular\";\n  } else if (delim === \"\\\\rgroup\" || delim === \"\\u27ef\") {\n    top = \"\\u23ab\";\n    bottom = \"\\u23ad\";\n    repeat = \"\\u23aa\";\n    font = \"Size4-Regular\";\n  } else if (delim === \"\\\\lmoustache\" || delim === \"\\u23b0\") {\n    top = \"\\u23a7\";\n    bottom = \"\\u23ad\";\n    repeat = \"\\u23aa\";\n    font = \"Size4-Regular\";\n  } else if (delim === \"\\\\rmoustache\" || delim === \"\\u23b1\") {\n    top = \"\\u23ab\";\n    bottom = \"\\u23a9\";\n    repeat = \"\\u23aa\";\n    font = \"Size4-Regular\";\n  } // Get the metrics of the four sections\n\n\n  var topMetrics = getMetrics(top, font, mode);\n  var topHeightTotal = topMetrics.height + topMetrics.depth;\n  var repeatMetrics = getMetrics(repeat, font, mode);\n  var repeatHeightTotal = repeatMetrics.height + repeatMetrics.depth;\n  var bottomMetrics = getMetrics(bottom, font, mode);\n  var bottomHeightTotal = bottomMetrics.height + bottomMetrics.depth;\n  var middleHeightTotal = 0;\n  var middleFactor = 1;\n\n  if (middle !== null) {\n    var middleMetrics = getMetrics(middle, font, mode);\n    middleHeightTotal = middleMetrics.height + middleMetrics.depth;\n    middleFactor = 2; // repeat symmetrically above and below middle\n  } // Calculate the minimal height that the delimiter can have.\n  // It is at least the size of the top, bottom, and optional middle combined.\n\n\n  var minHeight = topHeightTotal + bottomHeightTotal + middleHeightTotal; // Compute the number of copies of the repeat symbol we will need\n\n  var repeatCount = Math.max(0, Math.ceil((heightTotal - minHeight) / (middleFactor * repeatHeightTotal))); // Compute the total height of the delimiter including all the symbols\n\n  var realHeightTotal = minHeight + repeatCount * middleFactor * repeatHeightTotal; // The center of the delimiter is placed at the center of the axis. Note\n  // that in this context, \"center\" means that the delimiter should be\n  // centered around the axis in the current style, while normally it is\n  // centered around the axis in textstyle.\n\n  var axisHeight = options.fontMetrics().axisHeight;\n\n  if (center) {\n    axisHeight *= options.sizeMultiplier;\n  } // Calculate the depth\n\n\n  var depth = realHeightTotal / 2 - axisHeight; // Now, we start building the pieces that will go into the vlist\n  // Keep a list of the pieces of the stacked delimiter\n\n  var stack = [];\n\n  if (svgLabel.length > 0) {\n    // Instead of stacking glyphs, create a single SVG.\n    // This evades browser problems with imprecise positioning of spans.\n    var midHeight = realHeightTotal - topHeightTotal - bottomHeightTotal;\n    var viewBoxHeight = Math.round(realHeightTotal * 1000);\n    var pathStr = tallDelim(svgLabel, Math.round(midHeight * 1000));\n    var path = new PathNode(svgLabel, pathStr);\n    var width = (viewBoxWidth / 1000).toFixed(3) + \"em\";\n    var height = (viewBoxHeight / 1000).toFixed(3) + \"em\";\n    var svg = new SvgNode([path], {\n      \"width\": width,\n      \"height\": height,\n      \"viewBox\": \"0 0 \" + viewBoxWidth + \" \" + viewBoxHeight\n    });\n    var wrapper = buildCommon.makeSvgSpan([], [svg], options);\n    wrapper.height = viewBoxHeight / 1000;\n    wrapper.style.width = width;\n    wrapper.style.height = height;\n    stack.push({\n      type: \"elem\",\n      elem: wrapper\n    });\n  } else {\n    // Stack glyphs\n    // Start by adding the bottom symbol\n    stack.push(makeGlyphSpan(bottom, font, mode));\n    stack.push(lap); // overlap\n\n    if (middle === null) {\n      // The middle section will be an SVG. Make it an extra 0.016em tall.\n      // We'll overlap by 0.008em at top and bottom.\n      var innerHeight = realHeightTotal - topHeightTotal - bottomHeightTotal + 2 * lapInEms;\n      stack.push(makeInner(repeat, innerHeight, options));\n    } else {\n      // When there is a middle bit, we need the middle part and two repeated\n      // sections\n      var _innerHeight = (realHeightTotal - topHeightTotal - bottomHeightTotal - middleHeightTotal) / 2 + 2 * lapInEms;\n\n      stack.push(makeInner(repeat, _innerHeight, options)); // Now insert the middle of the brace.\n\n      stack.push(lap);\n      stack.push(makeGlyphSpan(middle, font, mode));\n      stack.push(lap);\n      stack.push(makeInner(repeat, _innerHeight, options));\n    } // Add the top symbol\n\n\n    stack.push(lap);\n    stack.push(makeGlyphSpan(top, font, mode));\n  } // Finally, build the vlist\n\n\n  var newOptions = options.havingBaseStyle(Style$1.TEXT);\n  var inner = buildCommon.makeVList({\n    positionType: \"bottom\",\n    positionData: depth,\n    children: stack\n  }, newOptions);\n  return styleWrap(buildCommon.makeSpan([\"delimsizing\", \"mult\"], [inner], newOptions), Style$1.TEXT, options, classes);\n}; // All surds have 0.08em padding above the vinculum inside the SVG.\n// That keeps browser span height rounding error from pinching the line.\n\n\nvar vbPad = 80; // padding above the surd, measured inside the viewBox.\n\nvar emPad = 0.08; // padding, in ems, measured in the document.\n\nvar sqrtSvg = function sqrtSvg(sqrtName, height, viewBoxHeight, extraVinculum, options) {\n  var path = sqrtPath(sqrtName, extraVinculum, viewBoxHeight);\n  var pathNode = new PathNode(sqrtName, path);\n  var svg = new SvgNode([pathNode], {\n    // Note: 1000:1 ratio of viewBox to document em width.\n    \"width\": \"400em\",\n    \"height\": makeEm(height),\n    \"viewBox\": \"0 0 400000 \" + viewBoxHeight,\n    \"preserveAspectRatio\": \"xMinYMin slice\"\n  });\n  return buildCommon.makeSvgSpan([\"hide-tail\"], [svg], options);\n};\n/**\n * Make a sqrt image of the given height,\n */\n\n\nvar makeSqrtImage = function makeSqrtImage(height, options) {\n  // Define a newOptions that removes the effect of size changes such as \\Huge.\n  // We don't pick different a height surd for \\Huge. For it, we scale up.\n  var newOptions = options.havingBaseSizing(); // Pick the desired surd glyph from a sequence of surds.\n\n  var delim = traverseSequence(\"\\\\surd\", height * newOptions.sizeMultiplier, stackLargeDelimiterSequence, newOptions);\n  var sizeMultiplier = newOptions.sizeMultiplier; // default\n  // The standard sqrt SVGs each have a 0.04em thick vinculum.\n  // If Settings.minRuleThickness is larger than that, we add extraVinculum.\n\n  var extraVinculum = Math.max(0, options.minRuleThickness - options.fontMetrics().sqrtRuleThickness); // Create a span containing an SVG image of a sqrt symbol.\n\n  var span;\n  var spanHeight = 0;\n  var texHeight = 0;\n  var viewBoxHeight = 0;\n  var advanceWidth; // We create viewBoxes with 80 units of \"padding\" above each surd.\n  // Then browser rounding error on the parent span height will not\n  // encroach on the ink of the vinculum. But that padding is not\n  // included in the TeX-like `height` used for calculation of\n  // vertical alignment. So texHeight = span.height < span.style.height.\n\n  if (delim.type === \"small\") {\n    // Get an SVG that is derived from glyph U+221A in font KaTeX-Main.\n    // 1000 unit normal glyph height.\n    viewBoxHeight = 1000 + 1000 * extraVinculum + vbPad;\n\n    if (height < 1.0) {\n      sizeMultiplier = 1.0; // mimic a \\textfont radical\n    } else if (height < 1.4) {\n      sizeMultiplier = 0.7; // mimic a \\scriptfont radical\n    }\n\n    spanHeight = (1.0 + extraVinculum + emPad) / sizeMultiplier;\n    texHeight = (1.00 + extraVinculum) / sizeMultiplier;\n    span = sqrtSvg(\"sqrtMain\", spanHeight, viewBoxHeight, extraVinculum, options);\n    span.style.minWidth = \"0.853em\";\n    advanceWidth = 0.833 / sizeMultiplier; // from the font.\n  } else if (delim.type === \"large\") {\n    // These SVGs come from fonts: KaTeX_Size1, _Size2, etc.\n    viewBoxHeight = (1000 + vbPad) * sizeToMaxHeight[delim.size];\n    texHeight = (sizeToMaxHeight[delim.size] + extraVinculum) / sizeMultiplier;\n    spanHeight = (sizeToMaxHeight[delim.size] + extraVinculum + emPad) / sizeMultiplier;\n    span = sqrtSvg(\"sqrtSize\" + delim.size, spanHeight, viewBoxHeight, extraVinculum, options);\n    span.style.minWidth = \"1.02em\";\n    advanceWidth = 1.0 / sizeMultiplier; // 1.0 from the font.\n  } else {\n    // Tall sqrt. In TeX, this would be stacked using multiple glyphs.\n    // We'll use a single SVG to accomplish the same thing.\n    spanHeight = height + extraVinculum + emPad;\n    texHeight = height + extraVinculum;\n    viewBoxHeight = Math.floor(1000 * height + extraVinculum) + vbPad;\n    span = sqrtSvg(\"sqrtTall\", spanHeight, viewBoxHeight, extraVinculum, options);\n    span.style.minWidth = \"0.742em\";\n    advanceWidth = 1.056;\n  }\n\n  span.height = texHeight;\n  span.style.height = makeEm(spanHeight);\n  return {\n    span,\n    advanceWidth,\n    // Calculate the actual line width.\n    // This actually should depend on the chosen font -- e.g. \\boldmath\n    // should use the thicker surd symbols from e.g. KaTeX_Main-Bold, and\n    // have thicker rules.\n    ruleWidth: (options.fontMetrics().sqrtRuleThickness + extraVinculum) * sizeMultiplier\n  };\n}; // There are three kinds of delimiters, delimiters that stack when they become\n// too large\n\n\nvar stackLargeDelimiters = [\"(\", \"\\\\lparen\", \")\", \"\\\\rparen\", \"[\", \"\\\\lbrack\", \"]\", \"\\\\rbrack\", \"\\\\{\", \"\\\\lbrace\", \"\\\\}\", \"\\\\rbrace\", \"\\\\lfloor\", \"\\\\rfloor\", \"\\u230a\", \"\\u230b\", \"\\\\lceil\", \"\\\\rceil\", \"\\u2308\", \"\\u2309\", \"\\\\surd\"]; // delimiters that always stack\n\nvar stackAlwaysDelimiters = [\"\\\\uparrow\", \"\\\\downarrow\", \"\\\\updownarrow\", \"\\\\Uparrow\", \"\\\\Downarrow\", \"\\\\Updownarrow\", \"|\", \"\\\\|\", \"\\\\vert\", \"\\\\Vert\", \"\\\\lvert\", \"\\\\rvert\", \"\\\\lVert\", \"\\\\rVert\", \"\\\\lgroup\", \"\\\\rgroup\", \"\\u27ee\", \"\\u27ef\", \"\\\\lmoustache\", \"\\\\rmoustache\", \"\\u23b0\", \"\\u23b1\"]; // and delimiters that never stack\n\nvar stackNeverDelimiters = [\"<\", \">\", \"\\\\langle\", \"\\\\rangle\", \"/\", \"\\\\backslash\", \"\\\\lt\", \"\\\\gt\"]; // Metrics of the different sizes. Found by looking at TeX's output of\n// $\\bigl| // \\Bigl| \\biggl| \\Biggl| \\showlists$\n// Used to create stacked delimiters of appropriate sizes in makeSizedDelim.\n\nvar sizeToMaxHeight = [0, 1.2, 1.8, 2.4, 3.0];\n/**\n * Used to create a delimiter of a specific size, where `size` is 1, 2, 3, or 4.\n */\n\nvar makeSizedDelim = function makeSizedDelim(delim, size, options, mode, classes) {\n  // < and > turn into \\langle and \\rangle in delimiters\n  if (delim === \"<\" || delim === \"\\\\lt\" || delim === \"\\u27e8\") {\n    delim = \"\\\\langle\";\n  } else if (delim === \">\" || delim === \"\\\\gt\" || delim === \"\\u27e9\") {\n    delim = \"\\\\rangle\";\n  } // Sized delimiters are never centered.\n\n\n  if (utils.contains(stackLargeDelimiters, delim) || utils.contains(stackNeverDelimiters, delim)) {\n    return makeLargeDelim(delim, size, false, options, mode, classes);\n  } else if (utils.contains(stackAlwaysDelimiters, delim)) {\n    return makeStackedDelim(delim, sizeToMaxHeight[size], false, options, mode, classes);\n  } else {\n    throw new ParseError(\"Illegal delimiter: '\" + delim + \"'\");\n  }\n};\n/**\n * There are three different sequences of delimiter sizes that the delimiters\n * follow depending on the kind of delimiter. This is used when creating custom\n * sized delimiters to decide whether to create a small, large, or stacked\n * delimiter.\n *\n * In real TeX, these sequences aren't explicitly defined, but are instead\n * defined inside the font metrics. Since there are only three sequences that\n * are possible for the delimiters that TeX defines, it is easier to just encode\n * them explicitly here.\n */\n\n\n// Delimiters that never stack try small delimiters and large delimiters only\nvar stackNeverDelimiterSequence = [{\n  type: \"small\",\n  style: Style$1.SCRIPTSCRIPT\n}, {\n  type: \"small\",\n  style: Style$1.SCRIPT\n}, {\n  type: \"small\",\n  style: Style$1.TEXT\n}, {\n  type: \"large\",\n  size: 1\n}, {\n  type: \"large\",\n  size: 2\n}, {\n  type: \"large\",\n  size: 3\n}, {\n  type: \"large\",\n  size: 4\n}]; // Delimiters that always stack try the small delimiters first, then stack\n\nvar stackAlwaysDelimiterSequence = [{\n  type: \"small\",\n  style: Style$1.SCRIPTSCRIPT\n}, {\n  type: \"small\",\n  style: Style$1.SCRIPT\n}, {\n  type: \"small\",\n  style: Style$1.TEXT\n}, {\n  type: \"stack\"\n}]; // Delimiters that stack when large try the small and then large delimiters, and\n// stack afterwards\n\nvar stackLargeDelimiterSequence = [{\n  type: \"small\",\n  style: Style$1.SCRIPTSCRIPT\n}, {\n  type: \"small\",\n  style: Style$1.SCRIPT\n}, {\n  type: \"small\",\n  style: Style$1.TEXT\n}, {\n  type: \"large\",\n  size: 1\n}, {\n  type: \"large\",\n  size: 2\n}, {\n  type: \"large\",\n  size: 3\n}, {\n  type: \"large\",\n  size: 4\n}, {\n  type: \"stack\"\n}];\n/**\n * Get the font used in a delimiter based on what kind of delimiter it is.\n * TODO(#963) Use more specific font family return type once that is introduced.\n */\n\nvar delimTypeToFont = function delimTypeToFont(type) {\n  if (type.type === \"small\") {\n    return \"Main-Regular\";\n  } else if (type.type === \"large\") {\n    return \"Size\" + type.size + \"-Regular\";\n  } else if (type.type === \"stack\") {\n    return \"Size4-Regular\";\n  } else {\n    throw new Error(\"Add support for delim type '\" + type.type + \"' here.\");\n  }\n};\n/**\n * Traverse a sequence of types of delimiters to decide what kind of delimiter\n * should be used to create a delimiter of the given height+depth.\n */\n\n\nvar traverseSequence = function traverseSequence(delim, height, sequence, options) {\n  // Here, we choose the index we should start at in the sequences. In smaller\n  // sizes (which correspond to larger numbers in style.size) we start earlier\n  // in the sequence. Thus, scriptscript starts at index 3-3=0, script starts\n  // at index 3-2=1, text starts at 3-1=2, and display starts at min(2,3-0)=2\n  var start = Math.min(2, 3 - options.style.size);\n\n  for (var i = start; i < sequence.length; i++) {\n    if (sequence[i].type === \"stack\") {\n      // This is always the last delimiter, so we just break the loop now.\n      break;\n    }\n\n    var metrics = getMetrics(delim, delimTypeToFont(sequence[i]), \"math\");\n    var heightDepth = metrics.height + metrics.depth; // Small delimiters are scaled down versions of the same font, so we\n    // account for the style change size.\n\n    if (sequence[i].type === \"small\") {\n      var newOptions = options.havingBaseStyle(sequence[i].style);\n      heightDepth *= newOptions.sizeMultiplier;\n    } // Check if the delimiter at this size works for the given height.\n\n\n    if (heightDepth > height) {\n      return sequence[i];\n    }\n  } // If we reached the end of the sequence, return the last sequence element.\n\n\n  return sequence[sequence.length - 1];\n};\n/**\n * Make a delimiter of a given height+depth, with optional centering. Here, we\n * traverse the sequences, and create a delimiter that the sequence tells us to.\n */\n\n\nvar makeCustomSizedDelim = function makeCustomSizedDelim(delim, height, center, options, mode, classes) {\n  if (delim === \"<\" || delim === \"\\\\lt\" || delim === \"\\u27e8\") {\n    delim = \"\\\\langle\";\n  } else if (delim === \">\" || delim === \"\\\\gt\" || delim === \"\\u27e9\") {\n    delim = \"\\\\rangle\";\n  } // Decide what sequence to use\n\n\n  var sequence;\n\n  if (utils.contains(stackNeverDelimiters, delim)) {\n    sequence = stackNeverDelimiterSequence;\n  } else if (utils.contains(stackLargeDelimiters, delim)) {\n    sequence = stackLargeDelimiterSequence;\n  } else {\n    sequence = stackAlwaysDelimiterSequence;\n  } // Look through the sequence\n\n\n  var delimType = traverseSequence(delim, height, sequence, options); // Get the delimiter from font glyphs.\n  // Depending on the sequence element we decided on, call the\n  // appropriate function.\n\n  if (delimType.type === \"small\") {\n    return makeSmallDelim(delim, delimType.style, center, options, mode, classes);\n  } else if (delimType.type === \"large\") {\n    return makeLargeDelim(delim, delimType.size, center, options, mode, classes);\n  } else\n    /* if (delimType.type === \"stack\") */\n    {\n      return makeStackedDelim(delim, height, center, options, mode, classes);\n    }\n};\n/**\n * Make a delimiter for use with `\\left` and `\\right`, given a height and depth\n * of an expression that the delimiters surround.\n */\n\n\nvar makeLeftRightDelim = function makeLeftRightDelim(delim, height, depth, options, mode, classes) {\n  // We always center \\left/\\right delimiters, so the axis is always shifted\n  var axisHeight = options.fontMetrics().axisHeight * options.sizeMultiplier; // Taken from TeX source, tex.web, function make_left_right\n\n  var delimiterFactor = 901;\n  var delimiterExtend = 5.0 / options.fontMetrics().ptPerEm;\n  var maxDistFromAxis = Math.max(height - axisHeight, depth + axisHeight);\n  var totalHeight = Math.max( // In real TeX, calculations are done using integral values which are\n  // 65536 per pt, or 655360 per em. So, the division here truncates in\n  // TeX but doesn't here, producing different results. If we wanted to\n  // exactly match TeX's calculation, we could do\n  //   Math.floor(655360 * maxDistFromAxis / 500) *\n  //    delimiterFactor / 655360\n  // (To see the difference, compare\n  //    x^{x^{\\left(\\rule{0.1em}{0.68em}\\right)}}\n  // in TeX and KaTeX)\n  maxDistFromAxis / 500 * delimiterFactor, 2 * maxDistFromAxis - delimiterExtend); // Finally, we defer to `makeCustomSizedDelim` with our calculated total\n  // height\n\n  return makeCustomSizedDelim(delim, totalHeight, true, options, mode, classes);\n};\n\nvar delimiter = {\n  sqrtImage: makeSqrtImage,\n  sizedDelim: makeSizedDelim,\n  sizeToMaxHeight: sizeToMaxHeight,\n  customSizedDelim: makeCustomSizedDelim,\n  leftRightDelim: makeLeftRightDelim\n};\n\n// Extra data needed for the delimiter handler down below\nvar delimiterSizes = {\n  \"\\\\bigl\": {\n    mclass: \"mopen\",\n    size: 1\n  },\n  \"\\\\Bigl\": {\n    mclass: \"mopen\",\n    size: 2\n  },\n  \"\\\\biggl\": {\n    mclass: \"mopen\",\n    size: 3\n  },\n  \"\\\\Biggl\": {\n    mclass: \"mopen\",\n    size: 4\n  },\n  \"\\\\bigr\": {\n    mclass: \"mclose\",\n    size: 1\n  },\n  \"\\\\Bigr\": {\n    mclass: \"mclose\",\n    size: 2\n  },\n  \"\\\\biggr\": {\n    mclass: \"mclose\",\n    size: 3\n  },\n  \"\\\\Biggr\": {\n    mclass: \"mclose\",\n    size: 4\n  },\n  \"\\\\bigm\": {\n    mclass: \"mrel\",\n    size: 1\n  },\n  \"\\\\Bigm\": {\n    mclass: \"mrel\",\n    size: 2\n  },\n  \"\\\\biggm\": {\n    mclass: \"mrel\",\n    size: 3\n  },\n  \"\\\\Biggm\": {\n    mclass: \"mrel\",\n    size: 4\n  },\n  \"\\\\big\": {\n    mclass: \"mord\",\n    size: 1\n  },\n  \"\\\\Big\": {\n    mclass: \"mord\",\n    size: 2\n  },\n  \"\\\\bigg\": {\n    mclass: \"mord\",\n    size: 3\n  },\n  \"\\\\Bigg\": {\n    mclass: \"mord\",\n    size: 4\n  }\n};\nvar delimiters = [\"(\", \"\\\\lparen\", \")\", \"\\\\rparen\", \"[\", \"\\\\lbrack\", \"]\", \"\\\\rbrack\", \"\\\\{\", \"\\\\lbrace\", \"\\\\}\", \"\\\\rbrace\", \"\\\\lfloor\", \"\\\\rfloor\", \"\\u230a\", \"\\u230b\", \"\\\\lceil\", \"\\\\rceil\", \"\\u2308\", \"\\u2309\", \"<\", \">\", \"\\\\langle\", \"\\u27e8\", \"\\\\rangle\", \"\\u27e9\", \"\\\\lt\", \"\\\\gt\", \"\\\\lvert\", \"\\\\rvert\", \"\\\\lVert\", \"\\\\rVert\", \"\\\\lgroup\", \"\\\\rgroup\", \"\\u27ee\", \"\\u27ef\", \"\\\\lmoustache\", \"\\\\rmoustache\", \"\\u23b0\", \"\\u23b1\", \"/\", \"\\\\backslash\", \"|\", \"\\\\vert\", \"\\\\|\", \"\\\\Vert\", \"\\\\uparrow\", \"\\\\Uparrow\", \"\\\\downarrow\", \"\\\\Downarrow\", \"\\\\updownarrow\", \"\\\\Updownarrow\", \".\"];\n\n// Delimiter functions\nfunction checkDelimiter(delim, context) {\n  var symDelim = checkSymbolNodeType(delim);\n\n  if (symDelim && utils.contains(delimiters, symDelim.text)) {\n    return symDelim;\n  } else if (symDelim) {\n    throw new ParseError(\"Invalid delimiter '\" + symDelim.text + \"' after '\" + context.funcName + \"'\", delim);\n  } else {\n    throw new ParseError(\"Invalid delimiter type '\" + delim.type + \"'\", delim);\n  }\n}\n\ndefineFunction({\n  type: \"delimsizing\",\n  names: [\"\\\\bigl\", \"\\\\Bigl\", \"\\\\biggl\", \"\\\\Biggl\", \"\\\\bigr\", \"\\\\Bigr\", \"\\\\biggr\", \"\\\\Biggr\", \"\\\\bigm\", \"\\\\Bigm\", \"\\\\biggm\", \"\\\\Biggm\", \"\\\\big\", \"\\\\Big\", \"\\\\bigg\", \"\\\\Bigg\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"primitive\"]\n  },\n  handler: (context, args) => {\n    var delim = checkDelimiter(args[0], context);\n    return {\n      type: \"delimsizing\",\n      mode: context.parser.mode,\n      size: delimiterSizes[context.funcName].size,\n      mclass: delimiterSizes[context.funcName].mclass,\n      delim: delim.text\n    };\n  },\n  htmlBuilder: (group, options) => {\n    if (group.delim === \".\") {\n      // Empty delimiters still count as elements, even though they don't\n      // show anything.\n      return buildCommon.makeSpan([group.mclass]);\n    } // Use delimiter.sizedDelim to generate the delimiter.\n\n\n    return delimiter.sizedDelim(group.delim, group.size, options, group.mode, [group.mclass]);\n  },\n  mathmlBuilder: group => {\n    var children = [];\n\n    if (group.delim !== \".\") {\n      children.push(makeText(group.delim, group.mode));\n    }\n\n    var node = new mathMLTree.MathNode(\"mo\", children);\n\n    if (group.mclass === \"mopen\" || group.mclass === \"mclose\") {\n      // Only some of the delimsizing functions act as fences, and they\n      // return \"mopen\" or \"mclose\" mclass.\n      node.setAttribute(\"fence\", \"true\");\n    } else {\n      // Explicitly disable fencing if it's not a fence, to override the\n      // defaults.\n      node.setAttribute(\"fence\", \"false\");\n    }\n\n    node.setAttribute(\"stretchy\", \"true\");\n    var size = makeEm(delimiter.sizeToMaxHeight[group.size]);\n    node.setAttribute(\"minsize\", size);\n    node.setAttribute(\"maxsize\", size);\n    return node;\n  }\n});\n\nfunction assertParsed(group) {\n  if (!group.body) {\n    throw new Error(\"Bug: The leftright ParseNode wasn't fully parsed.\");\n  }\n}\n\ndefineFunction({\n  type: \"leftright-right\",\n  names: [\"\\\\right\"],\n  props: {\n    numArgs: 1,\n    primitive: true\n  },\n  handler: (context, args) => {\n    // \\left case below triggers parsing of \\right in\n    //   `const right = parser.parseFunction();`\n    // uses this return value.\n    var color = context.parser.gullet.macros.get(\"\\\\current@color\");\n\n    if (color && typeof color !== \"string\") {\n      throw new ParseError(\"\\\\current@color set to non-string in \\\\right\");\n    }\n\n    return {\n      type: \"leftright-right\",\n      mode: context.parser.mode,\n      delim: checkDelimiter(args[0], context).text,\n      color // undefined if not set via \\color\n\n    };\n  }\n});\ndefineFunction({\n  type: \"leftright\",\n  names: [\"\\\\left\"],\n  props: {\n    numArgs: 1,\n    primitive: true\n  },\n  handler: (context, args) => {\n    var delim = checkDelimiter(args[0], context);\n    var parser = context.parser; // Parse out the implicit body\n\n    ++parser.leftrightDepth; // parseExpression stops before '\\\\right'\n\n    var body = parser.parseExpression(false);\n    --parser.leftrightDepth; // Check the next token\n\n    parser.expect(\"\\\\right\", false);\n    var right = assertNodeType(parser.parseFunction(), \"leftright-right\");\n    return {\n      type: \"leftright\",\n      mode: parser.mode,\n      body,\n      left: delim.text,\n      right: right.delim,\n      rightColor: right.color\n    };\n  },\n  htmlBuilder: (group, options) => {\n    assertParsed(group); // Build the inner expression\n\n    var inner = buildExpression$1(group.body, options, true, [\"mopen\", \"mclose\"]);\n    var innerHeight = 0;\n    var innerDepth = 0;\n    var hadMiddle = false; // Calculate its height and depth\n\n    for (var i = 0; i < inner.length; i++) {\n      // Property `isMiddle` not defined on `span`. See comment in\n      // \"middle\"'s htmlBuilder.\n      // $FlowFixMe\n      if (inner[i].isMiddle) {\n        hadMiddle = true;\n      } else {\n        innerHeight = Math.max(inner[i].height, innerHeight);\n        innerDepth = Math.max(inner[i].depth, innerDepth);\n      }\n    } // The size of delimiters is the same, regardless of what style we are\n    // in. Thus, to correctly calculate the size of delimiter we need around\n    // a group, we scale down the inner size based on the size.\n\n\n    innerHeight *= options.sizeMultiplier;\n    innerDepth *= options.sizeMultiplier;\n    var leftDelim;\n\n    if (group.left === \".\") {\n      // Empty delimiters in \\left and \\right make null delimiter spaces.\n      leftDelim = makeNullDelimiter(options, [\"mopen\"]);\n    } else {\n      // Otherwise, use leftRightDelim to generate the correct sized\n      // delimiter.\n      leftDelim = delimiter.leftRightDelim(group.left, innerHeight, innerDepth, options, group.mode, [\"mopen\"]);\n    } // Add it to the beginning of the expression\n\n\n    inner.unshift(leftDelim); // Handle middle delimiters\n\n    if (hadMiddle) {\n      for (var _i = 1; _i < inner.length; _i++) {\n        var middleDelim = inner[_i]; // Property `isMiddle` not defined on `span`. See comment in\n        // \"middle\"'s htmlBuilder.\n        // $FlowFixMe\n\n        var isMiddle = middleDelim.isMiddle;\n\n        if (isMiddle) {\n          // Apply the options that were active when \\middle was called\n          inner[_i] = delimiter.leftRightDelim(isMiddle.delim, innerHeight, innerDepth, isMiddle.options, group.mode, []);\n        }\n      }\n    }\n\n    var rightDelim; // Same for the right delimiter, but using color specified by \\color\n\n    if (group.right === \".\") {\n      rightDelim = makeNullDelimiter(options, [\"mclose\"]);\n    } else {\n      var colorOptions = group.rightColor ? options.withColor(group.rightColor) : options;\n      rightDelim = delimiter.leftRightDelim(group.right, innerHeight, innerDepth, colorOptions, group.mode, [\"mclose\"]);\n    } // Add it to the end of the expression.\n\n\n    inner.push(rightDelim);\n    return buildCommon.makeSpan([\"minner\"], inner, options);\n  },\n  mathmlBuilder: (group, options) => {\n    assertParsed(group);\n    var inner = buildExpression(group.body, options);\n\n    if (group.left !== \".\") {\n      var leftNode = new mathMLTree.MathNode(\"mo\", [makeText(group.left, group.mode)]);\n      leftNode.setAttribute(\"fence\", \"true\");\n      inner.unshift(leftNode);\n    }\n\n    if (group.right !== \".\") {\n      var rightNode = new mathMLTree.MathNode(\"mo\", [makeText(group.right, group.mode)]);\n      rightNode.setAttribute(\"fence\", \"true\");\n\n      if (group.rightColor) {\n        rightNode.setAttribute(\"mathcolor\", group.rightColor);\n      }\n\n      inner.push(rightNode);\n    }\n\n    return makeRow(inner);\n  }\n});\ndefineFunction({\n  type: \"middle\",\n  names: [\"\\\\middle\"],\n  props: {\n    numArgs: 1,\n    primitive: true\n  },\n  handler: (context, args) => {\n    var delim = checkDelimiter(args[0], context);\n\n    if (!context.parser.leftrightDepth) {\n      throw new ParseError(\"\\\\middle without preceding \\\\left\", delim);\n    }\n\n    return {\n      type: \"middle\",\n      mode: context.parser.mode,\n      delim: delim.text\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var middleDelim;\n\n    if (group.delim === \".\") {\n      middleDelim = makeNullDelimiter(options, []);\n    } else {\n      middleDelim = delimiter.sizedDelim(group.delim, 1, options, group.mode, []);\n      var isMiddle = {\n        delim: group.delim,\n        options\n      }; // Property `isMiddle` not defined on `span`. It is only used in\n      // this file above.\n      // TODO: Fix this violation of the `span` type and possibly rename\n      // things since `isMiddle` sounds like a boolean, but is a struct.\n      // $FlowFixMe\n\n      middleDelim.isMiddle = isMiddle;\n    }\n\n    return middleDelim;\n  },\n  mathmlBuilder: (group, options) => {\n    // A Firefox \\middle will stretch a character vertically only if it\n    // is in the fence part of the operator dictionary at:\n    // https://www.w3.org/TR/MathML3/appendixc.html.\n    // So we need to avoid U+2223 and use plain \"|\" instead.\n    var textNode = group.delim === \"\\\\vert\" || group.delim === \"|\" ? makeText(\"|\", \"text\") : makeText(group.delim, group.mode);\n    var middleNode = new mathMLTree.MathNode(\"mo\", [textNode]);\n    middleNode.setAttribute(\"fence\", \"true\"); // MathML gives 5/18em spacing to each <mo> element.\n    // \\middle should get delimiter spacing instead.\n\n    middleNode.setAttribute(\"lspace\", \"0.05em\");\n    middleNode.setAttribute(\"rspace\", \"0.05em\");\n    return middleNode;\n  }\n});\n\nvar htmlBuilder$7 = (group, options) => {\n  // \\cancel, \\bcancel, \\xcancel, \\sout, \\fbox, \\colorbox, \\fcolorbox, \\phase\n  // Some groups can return document fragments.  Handle those by wrapping\n  // them in a span.\n  var inner = buildCommon.wrapFragment(buildGroup$1(group.body, options), options);\n  var label = group.label.slice(1);\n  var scale = options.sizeMultiplier;\n  var img;\n  var imgShift = 0; // In the LaTeX cancel package, line geometry is slightly different\n  // depending on whether the subject is wider than it is tall, or vice versa.\n  // We don't know the width of a group, so as a proxy, we test if\n  // the subject is a single character. This captures most of the\n  // subjects that should get the \"tall\" treatment.\n\n  var isSingleChar = utils.isCharacterBox(group.body);\n\n  if (label === \"sout\") {\n    img = buildCommon.makeSpan([\"stretchy\", \"sout\"]);\n    img.height = options.fontMetrics().defaultRuleThickness / scale;\n    imgShift = -0.5 * options.fontMetrics().xHeight;\n  } else if (label === \"phase\") {\n    // Set a couple of dimensions from the steinmetz package.\n    var lineWeight = calculateSize({\n      number: 0.6,\n      unit: \"pt\"\n    }, options);\n    var clearance = calculateSize({\n      number: 0.35,\n      unit: \"ex\"\n    }, options); // Prevent size changes like \\Huge from affecting line thickness\n\n    var newOptions = options.havingBaseSizing();\n    scale = scale / newOptions.sizeMultiplier;\n    var angleHeight = inner.height + inner.depth + lineWeight + clearance; // Reserve a left pad for the angle.\n\n    inner.style.paddingLeft = makeEm(angleHeight / 2 + lineWeight); // Create an SVG\n\n    var viewBoxHeight = Math.floor(1000 * angleHeight * scale);\n    var path = phasePath(viewBoxHeight);\n    var svgNode = new SvgNode([new PathNode(\"phase\", path)], {\n      \"width\": \"400em\",\n      \"height\": makeEm(viewBoxHeight / 1000),\n      \"viewBox\": \"0 0 400000 \" + viewBoxHeight,\n      \"preserveAspectRatio\": \"xMinYMin slice\"\n    }); // Wrap it in a span with overflow: hidden.\n\n    img = buildCommon.makeSvgSpan([\"hide-tail\"], [svgNode], options);\n    img.style.height = makeEm(angleHeight);\n    imgShift = inner.depth + lineWeight + clearance;\n  } else {\n    // Add horizontal padding\n    if (/cancel/.test(label)) {\n      if (!isSingleChar) {\n        inner.classes.push(\"cancel-pad\");\n      }\n    } else if (label === \"angl\") {\n      inner.classes.push(\"anglpad\");\n    } else {\n      inner.classes.push(\"boxpad\");\n    } // Add vertical padding\n\n\n    var topPad = 0;\n    var bottomPad = 0;\n    var ruleThickness = 0; // ref: cancel package: \\advance\\totalheight2\\p@ % \"+2\"\n\n    if (/box/.test(label)) {\n      ruleThickness = Math.max(options.fontMetrics().fboxrule, // default\n      options.minRuleThickness // User override.\n      );\n      topPad = options.fontMetrics().fboxsep + (label === \"colorbox\" ? 0 : ruleThickness);\n      bottomPad = topPad;\n    } else if (label === \"angl\") {\n      ruleThickness = Math.max(options.fontMetrics().defaultRuleThickness, options.minRuleThickness);\n      topPad = 4 * ruleThickness; // gap = 3 × line, plus the line itself.\n\n      bottomPad = Math.max(0, 0.25 - inner.depth);\n    } else {\n      topPad = isSingleChar ? 0.2 : 0;\n      bottomPad = topPad;\n    }\n\n    img = stretchy.encloseSpan(inner, label, topPad, bottomPad, options);\n\n    if (/fbox|boxed|fcolorbox/.test(label)) {\n      img.style.borderStyle = \"solid\";\n      img.style.borderWidth = makeEm(ruleThickness);\n    } else if (label === \"angl\" && ruleThickness !== 0.049) {\n      img.style.borderTopWidth = makeEm(ruleThickness);\n      img.style.borderRightWidth = makeEm(ruleThickness);\n    }\n\n    imgShift = inner.depth + bottomPad;\n\n    if (group.backgroundColor) {\n      img.style.backgroundColor = group.backgroundColor;\n\n      if (group.borderColor) {\n        img.style.borderColor = group.borderColor;\n      }\n    }\n  }\n\n  var vlist;\n\n  if (group.backgroundColor) {\n    vlist = buildCommon.makeVList({\n      positionType: \"individualShift\",\n      children: [// Put the color background behind inner;\n      {\n        type: \"elem\",\n        elem: img,\n        shift: imgShift\n      }, {\n        type: \"elem\",\n        elem: inner,\n        shift: 0\n      }]\n    }, options);\n  } else {\n    var classes = /cancel|phase/.test(label) ? [\"svg-align\"] : [];\n    vlist = buildCommon.makeVList({\n      positionType: \"individualShift\",\n      children: [// Write the \\cancel stroke on top of inner.\n      {\n        type: \"elem\",\n        elem: inner,\n        shift: 0\n      }, {\n        type: \"elem\",\n        elem: img,\n        shift: imgShift,\n        wrapperClasses: classes\n      }]\n    }, options);\n  }\n\n  if (/cancel/.test(label)) {\n    // The cancel package documentation says that cancel lines add their height\n    // to the expression, but tests show that isn't how it actually works.\n    vlist.height = inner.height;\n    vlist.depth = inner.depth;\n  }\n\n  if (/cancel/.test(label) && !isSingleChar) {\n    // cancel does not create horiz space for its line extension.\n    return buildCommon.makeSpan([\"mord\", \"cancel-lap\"], [vlist], options);\n  } else {\n    return buildCommon.makeSpan([\"mord\"], [vlist], options);\n  }\n};\n\nvar mathmlBuilder$6 = (group, options) => {\n  var fboxsep = 0;\n  var node = new mathMLTree.MathNode(group.label.indexOf(\"colorbox\") > -1 ? \"mpadded\" : \"menclose\", [buildGroup(group.body, options)]);\n\n  switch (group.label) {\n    case \"\\\\cancel\":\n      node.setAttribute(\"notation\", \"updiagonalstrike\");\n      break;\n\n    case \"\\\\bcancel\":\n      node.setAttribute(\"notation\", \"downdiagonalstrike\");\n      break;\n\n    case \"\\\\phase\":\n      node.setAttribute(\"notation\", \"phasorangle\");\n      break;\n\n    case \"\\\\sout\":\n      node.setAttribute(\"notation\", \"horizontalstrike\");\n      break;\n\n    case \"\\\\fbox\":\n      node.setAttribute(\"notation\", \"box\");\n      break;\n\n    case \"\\\\angl\":\n      node.setAttribute(\"notation\", \"actuarial\");\n      break;\n\n    case \"\\\\fcolorbox\":\n    case \"\\\\colorbox\":\n      // <menclose> doesn't have a good notation option. So use <mpadded>\n      // instead. Set some attributes that come included with <menclose>.\n      fboxsep = options.fontMetrics().fboxsep * options.fontMetrics().ptPerEm;\n      node.setAttribute(\"width\", \"+\" + 2 * fboxsep + \"pt\");\n      node.setAttribute(\"height\", \"+\" + 2 * fboxsep + \"pt\");\n      node.setAttribute(\"lspace\", fboxsep + \"pt\"); //\n\n      node.setAttribute(\"voffset\", fboxsep + \"pt\");\n\n      if (group.label === \"\\\\fcolorbox\") {\n        var thk = Math.max(options.fontMetrics().fboxrule, // default\n        options.minRuleThickness // user override\n        );\n        node.setAttribute(\"style\", \"border: \" + thk + \"em solid \" + String(group.borderColor));\n      }\n\n      break;\n\n    case \"\\\\xcancel\":\n      node.setAttribute(\"notation\", \"updiagonalstrike downdiagonalstrike\");\n      break;\n  }\n\n  if (group.backgroundColor) {\n    node.setAttribute(\"mathbackground\", group.backgroundColor);\n  }\n\n  return node;\n};\n\ndefineFunction({\n  type: \"enclose\",\n  names: [\"\\\\colorbox\"],\n  props: {\n    numArgs: 2,\n    allowedInText: true,\n    argTypes: [\"color\", \"text\"]\n  },\n\n  handler(_ref, args, optArgs) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var color = assertNodeType(args[0], \"color-token\").color;\n    var body = args[1];\n    return {\n      type: \"enclose\",\n      mode: parser.mode,\n      label: funcName,\n      backgroundColor: color,\n      body\n    };\n  },\n\n  htmlBuilder: htmlBuilder$7,\n  mathmlBuilder: mathmlBuilder$6\n});\ndefineFunction({\n  type: \"enclose\",\n  names: [\"\\\\fcolorbox\"],\n  props: {\n    numArgs: 3,\n    allowedInText: true,\n    argTypes: [\"color\", \"color\", \"text\"]\n  },\n\n  handler(_ref2, args, optArgs) {\n    var {\n      parser,\n      funcName\n    } = _ref2;\n    var borderColor = assertNodeType(args[0], \"color-token\").color;\n    var backgroundColor = assertNodeType(args[1], \"color-token\").color;\n    var body = args[2];\n    return {\n      type: \"enclose\",\n      mode: parser.mode,\n      label: funcName,\n      backgroundColor,\n      borderColor,\n      body\n    };\n  },\n\n  htmlBuilder: htmlBuilder$7,\n  mathmlBuilder: mathmlBuilder$6\n});\ndefineFunction({\n  type: \"enclose\",\n  names: [\"\\\\fbox\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"hbox\"],\n    allowedInText: true\n  },\n\n  handler(_ref3, args) {\n    var {\n      parser\n    } = _ref3;\n    return {\n      type: \"enclose\",\n      mode: parser.mode,\n      label: \"\\\\fbox\",\n      body: args[0]\n    };\n  }\n\n});\ndefineFunction({\n  type: \"enclose\",\n  names: [\"\\\\cancel\", \"\\\\bcancel\", \"\\\\xcancel\", \"\\\\sout\", \"\\\\phase\"],\n  props: {\n    numArgs: 1\n  },\n\n  handler(_ref4, args) {\n    var {\n      parser,\n      funcName\n    } = _ref4;\n    var body = args[0];\n    return {\n      type: \"enclose\",\n      mode: parser.mode,\n      label: funcName,\n      body\n    };\n  },\n\n  htmlBuilder: htmlBuilder$7,\n  mathmlBuilder: mathmlBuilder$6\n});\ndefineFunction({\n  type: \"enclose\",\n  names: [\"\\\\angl\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"hbox\"],\n    allowedInText: false\n  },\n\n  handler(_ref5, args) {\n    var {\n      parser\n    } = _ref5;\n    return {\n      type: \"enclose\",\n      mode: parser.mode,\n      label: \"\\\\angl\",\n      body: args[0]\n    };\n  }\n\n});\n\n/**\n * All registered environments.\n * `environments.js` exports this same dictionary again and makes it public.\n * `Parser.js` requires this dictionary via `environments.js`.\n */\nvar _environments = {};\nfunction defineEnvironment(_ref) {\n  var {\n    type,\n    names,\n    props,\n    handler,\n    htmlBuilder,\n    mathmlBuilder\n  } = _ref;\n  // Set default values of environments.\n  var data = {\n    type,\n    numArgs: props.numArgs || 0,\n    allowedInText: false,\n    numOptionalArgs: 0,\n    handler\n  };\n\n  for (var i = 0; i < names.length; ++i) {\n    // TODO: The value type of _environments should be a type union of all\n    // possible `EnvSpec<>` possibilities instead of `EnvSpec<*>`, which is\n    // an existential type.\n    _environments[names[i]] = data;\n  }\n\n  if (htmlBuilder) {\n    _htmlGroupBuilders[type] = htmlBuilder;\n  }\n\n  if (mathmlBuilder) {\n    _mathmlGroupBuilders[type] = mathmlBuilder;\n  }\n}\n\n/**\n * All registered global/built-in macros.\n * `macros.js` exports this same dictionary again and makes it public.\n * `Parser.js` requires this dictionary via `macros.js`.\n */\nvar _macros = {}; // This function might one day accept an additional argument and do more things.\n\nfunction defineMacro(name, body) {\n  _macros[name] = body;\n}\n\n// Helper functions\nfunction getHLines(parser) {\n  // Return an array. The array length = number of hlines.\n  // Each element in the array tells if the line is dashed.\n  var hlineInfo = [];\n  parser.consumeSpaces();\n  var nxt = parser.fetch().text;\n\n  if (nxt === \"\\\\relax\") {\n    // \\relax is an artifact of the \\cr macro below\n    parser.consume();\n    parser.consumeSpaces();\n    nxt = parser.fetch().text;\n  }\n\n  while (nxt === \"\\\\hline\" || nxt === \"\\\\hdashline\") {\n    parser.consume();\n    hlineInfo.push(nxt === \"\\\\hdashline\");\n    parser.consumeSpaces();\n    nxt = parser.fetch().text;\n  }\n\n  return hlineInfo;\n}\n\nvar validateAmsEnvironmentContext = context => {\n  var settings = context.parser.settings;\n\n  if (!settings.displayMode) {\n    throw new ParseError(\"{\" + context.envName + \"} can be used only in\" + \" display mode.\");\n  }\n}; // autoTag (an argument to parseArray) can be one of three values:\n// * undefined: Regular (not-top-level) array; no tags on each row\n// * true: Automatic equation numbering, overridable by \\tag\n// * false: Tags allowed on each row, but no automatic numbering\n// This function *doesn't* work with the \"split\" environment name.\n\n\nfunction getAutoTag(name) {\n  if (name.indexOf(\"ed\") === -1) {\n    return name.indexOf(\"*\") === -1;\n  } // return undefined;\n\n}\n/**\n * Parse the body of the environment, with rows delimited by \\\\ and\n * columns delimited by &, and create a nested list in row-major order\n * with one group per cell.  If given an optional argument style\n * (\"text\", \"display\", etc.), then each cell is cast into that style.\n */\n\n\nfunction parseArray(parser, _ref, style) {\n  var {\n    hskipBeforeAndAfter,\n    addJot,\n    cols,\n    arraystretch,\n    colSeparationType,\n    autoTag,\n    singleRow,\n    emptySingleRow,\n    maxNumCols,\n    leqno\n  } = _ref;\n  parser.gullet.beginGroup();\n\n  if (!singleRow) {\n    // \\cr is equivalent to \\\\ without the optional size argument (see below)\n    // TODO: provide helpful error when \\cr is used outside array environment\n    parser.gullet.macros.set(\"\\\\cr\", \"\\\\\\\\\\\\relax\");\n  } // Get current arraystretch if it's not set by the environment\n\n\n  if (!arraystretch) {\n    var stretch = parser.gullet.expandMacroAsText(\"\\\\arraystretch\");\n\n    if (stretch == null) {\n      // Default \\arraystretch from lttab.dtx\n      arraystretch = 1;\n    } else {\n      arraystretch = parseFloat(stretch);\n\n      if (!arraystretch || arraystretch < 0) {\n        throw new ParseError(\"Invalid \\\\arraystretch: \" + stretch);\n      }\n    }\n  } // Start group for first cell\n\n\n  parser.gullet.beginGroup();\n  var row = [];\n  var body = [row];\n  var rowGaps = [];\n  var hLinesBeforeRow = [];\n  var tags = autoTag != null ? [] : undefined; // amsmath uses \\global\\@eqnswtrue and \\global\\@eqnswfalse to represent\n  // whether this row should have an equation number.  Simulate this with\n  // a \\@eqnsw macro set to 1 or 0.\n\n  function beginRow() {\n    if (autoTag) {\n      parser.gullet.macros.set(\"\\\\@eqnsw\", \"1\", true);\n    }\n  }\n\n  function endRow() {\n    if (tags) {\n      if (parser.gullet.macros.get(\"\\\\df@tag\")) {\n        tags.push(parser.subparse([new Token(\"\\\\df@tag\")]));\n        parser.gullet.macros.set(\"\\\\df@tag\", undefined, true);\n      } else {\n        tags.push(Boolean(autoTag) && parser.gullet.macros.get(\"\\\\@eqnsw\") === \"1\");\n      }\n    }\n  }\n\n  beginRow(); // Test for \\hline at the top of the array.\n\n  hLinesBeforeRow.push(getHLines(parser));\n\n  while (true) {\n    // eslint-disable-line no-constant-condition\n    // Parse each cell in its own group (namespace)\n    var cell = parser.parseExpression(false, singleRow ? \"\\\\end\" : \"\\\\\\\\\");\n    parser.gullet.endGroup();\n    parser.gullet.beginGroup();\n    cell = {\n      type: \"ordgroup\",\n      mode: parser.mode,\n      body: cell\n    };\n\n    if (style) {\n      cell = {\n        type: \"styling\",\n        mode: parser.mode,\n        style,\n        body: [cell]\n      };\n    }\n\n    row.push(cell);\n    var next = parser.fetch().text;\n\n    if (next === \"&\") {\n      if (maxNumCols && row.length === maxNumCols) {\n        if (singleRow || colSeparationType) {\n          // {equation} or {split}\n          throw new ParseError(\"Too many tab characters: &\", parser.nextToken);\n        } else {\n          // {array} environment\n          parser.settings.reportNonstrict(\"textEnv\", \"Too few columns \" + \"specified in the {array} column argument.\");\n        }\n      }\n\n      parser.consume();\n    } else if (next === \"\\\\end\") {\n      endRow(); // Arrays terminate newlines with `\\crcr` which consumes a `\\cr` if\n      // the last line is empty.  However, AMS environments keep the\n      // empty row if it's the only one.\n      // NOTE: Currently, `cell` is the last item added into `row`.\n\n      if (row.length === 1 && cell.type === \"styling\" && cell.body[0].body.length === 0 && (body.length > 1 || !emptySingleRow)) {\n        body.pop();\n      }\n\n      if (hLinesBeforeRow.length < body.length + 1) {\n        hLinesBeforeRow.push([]);\n      }\n\n      break;\n    } else if (next === \"\\\\\\\\\") {\n      parser.consume();\n      var size = void 0; // \\def\\Let@{\\let\\\\\\math@cr}\n      // \\def\\math@cr{...\\math@cr@}\n      // \\def\\math@cr@{\\new@ifnextchar[\\math@cr@@{\\math@cr@@[\\z@]}}\n      // \\def\\math@cr@@[#1]{...\\math@cr@@@...}\n      // \\def\\math@cr@@@{\\cr}\n\n      if (parser.gullet.future().text !== \" \") {\n        size = parser.parseSizeGroup(true);\n      }\n\n      rowGaps.push(size ? size.value : null);\n      endRow(); // check for \\hline(s) following the row separator\n\n      hLinesBeforeRow.push(getHLines(parser));\n      row = [];\n      body.push(row);\n      beginRow();\n    } else {\n      throw new ParseError(\"Expected & or \\\\\\\\ or \\\\cr or \\\\end\", parser.nextToken);\n    }\n  } // End cell group\n\n\n  parser.gullet.endGroup(); // End array group defining \\cr\n\n  parser.gullet.endGroup();\n  return {\n    type: \"array\",\n    mode: parser.mode,\n    addJot,\n    arraystretch,\n    body,\n    cols,\n    rowGaps,\n    hskipBeforeAndAfter,\n    hLinesBeforeRow,\n    colSeparationType,\n    tags,\n    leqno\n  };\n} // Decides on a style for cells in an array according to whether the given\n// environment name starts with the letter 'd'.\n\n\nfunction dCellStyle(envName) {\n  if (envName.slice(0, 1) === \"d\") {\n    return \"display\";\n  } else {\n    return \"text\";\n  }\n}\n\nvar htmlBuilder$6 = function htmlBuilder(group, options) {\n  var r;\n  var c;\n  var nr = group.body.length;\n  var hLinesBeforeRow = group.hLinesBeforeRow;\n  var nc = 0;\n  var body = new Array(nr);\n  var hlines = [];\n  var ruleThickness = Math.max( // From LaTeX \\showthe\\arrayrulewidth. Equals 0.04 em.\n  options.fontMetrics().arrayRuleWidth, options.minRuleThickness // User override.\n  ); // Horizontal spacing\n\n  var pt = 1 / options.fontMetrics().ptPerEm;\n  var arraycolsep = 5 * pt; // default value, i.e. \\arraycolsep in article.cls\n\n  if (group.colSeparationType && group.colSeparationType === \"small\") {\n    // We're in a {smallmatrix}. Default column space is \\thickspace,\n    // i.e. 5/18em = 0.2778em, per amsmath.dtx for {smallmatrix}.\n    // But that needs adjustment because LaTeX applies \\scriptstyle to the\n    // entire array, including the colspace, but this function applies\n    // \\scriptstyle only inside each element.\n    var localMultiplier = options.havingStyle(Style$1.SCRIPT).sizeMultiplier;\n    arraycolsep = 0.2778 * (localMultiplier / options.sizeMultiplier);\n  } // Vertical spacing\n\n\n  var baselineskip = group.colSeparationType === \"CD\" ? calculateSize({\n    number: 3,\n    unit: \"ex\"\n  }, options) : 12 * pt; // see size10.clo\n  // Default \\jot from ltmath.dtx\n  // TODO(edemaine): allow overriding \\jot via \\setlength (#687)\n\n  var jot = 3 * pt;\n  var arrayskip = group.arraystretch * baselineskip;\n  var arstrutHeight = 0.7 * arrayskip; // \\strutbox in ltfsstrc.dtx and\n\n  var arstrutDepth = 0.3 * arrayskip; // \\@arstrutbox in lttab.dtx\n\n  var totalHeight = 0; // Set a position for \\hline(s) at the top of the array, if any.\n\n  function setHLinePos(hlinesInGap) {\n    for (var i = 0; i < hlinesInGap.length; ++i) {\n      if (i > 0) {\n        totalHeight += 0.25;\n      }\n\n      hlines.push({\n        pos: totalHeight,\n        isDashed: hlinesInGap[i]\n      });\n    }\n  }\n\n  setHLinePos(hLinesBeforeRow[0]);\n\n  for (r = 0; r < group.body.length; ++r) {\n    var inrow = group.body[r];\n    var height = arstrutHeight; // \\@array adds an \\@arstrut\n\n    var depth = arstrutDepth; // to each tow (via the template)\n\n    if (nc < inrow.length) {\n      nc = inrow.length;\n    }\n\n    var outrow = new Array(inrow.length);\n\n    for (c = 0; c < inrow.length; ++c) {\n      var elt = buildGroup$1(inrow[c], options);\n\n      if (depth < elt.depth) {\n        depth = elt.depth;\n      }\n\n      if (height < elt.height) {\n        height = elt.height;\n      }\n\n      outrow[c] = elt;\n    }\n\n    var rowGap = group.rowGaps[r];\n    var gap = 0;\n\n    if (rowGap) {\n      gap = calculateSize(rowGap, options);\n\n      if (gap > 0) {\n        // \\@argarraycr\n        gap += arstrutDepth;\n\n        if (depth < gap) {\n          depth = gap; // \\@xargarraycr\n        }\n\n        gap = 0;\n      }\n    } // In AMS multiline environments such as aligned and gathered, rows\n    // correspond to lines that have additional \\jot added to the\n    // \\baselineskip via \\openup.\n\n\n    if (group.addJot) {\n      depth += jot;\n    }\n\n    outrow.height = height;\n    outrow.depth = depth;\n    totalHeight += height;\n    outrow.pos = totalHeight;\n    totalHeight += depth + gap; // \\@yargarraycr\n\n    body[r] = outrow; // Set a position for \\hline(s), if any.\n\n    setHLinePos(hLinesBeforeRow[r + 1]);\n  }\n\n  var offset = totalHeight / 2 + options.fontMetrics().axisHeight;\n  var colDescriptions = group.cols || [];\n  var cols = [];\n  var colSep;\n  var colDescrNum;\n  var tagSpans = [];\n\n  if (group.tags && group.tags.some(tag => tag)) {\n    // An environment with manual tags and/or automatic equation numbers.\n    // Create node(s), the latter of which trigger CSS counter increment.\n    for (r = 0; r < nr; ++r) {\n      var rw = body[r];\n      var shift = rw.pos - offset;\n      var tag = group.tags[r];\n      var tagSpan = void 0;\n\n      if (tag === true) {\n        // automatic numbering\n        tagSpan = buildCommon.makeSpan([\"eqn-num\"], [], options);\n      } else if (tag === false) {\n        // \\nonumber/\\notag or starred environment\n        tagSpan = buildCommon.makeSpan([], [], options);\n      } else {\n        // manual \\tag\n        tagSpan = buildCommon.makeSpan([], buildExpression$1(tag, options, true), options);\n      }\n\n      tagSpan.depth = rw.depth;\n      tagSpan.height = rw.height;\n      tagSpans.push({\n        type: \"elem\",\n        elem: tagSpan,\n        shift\n      });\n    }\n  }\n\n  for (c = 0, colDescrNum = 0; // Continue while either there are more columns or more column\n  // descriptions, so trailing separators don't get lost.\n  c < nc || colDescrNum < colDescriptions.length; ++c, ++colDescrNum) {\n    var colDescr = colDescriptions[colDescrNum] || {};\n    var firstSeparator = true;\n\n    while (colDescr.type === \"separator\") {\n      // If there is more than one separator in a row, add a space\n      // between them.\n      if (!firstSeparator) {\n        colSep = buildCommon.makeSpan([\"arraycolsep\"], []);\n        colSep.style.width = makeEm(options.fontMetrics().doubleRuleSep);\n        cols.push(colSep);\n      }\n\n      if (colDescr.separator === \"|\" || colDescr.separator === \":\") {\n        var lineType = colDescr.separator === \"|\" ? \"solid\" : \"dashed\";\n        var separator = buildCommon.makeSpan([\"vertical-separator\"], [], options);\n        separator.style.height = makeEm(totalHeight);\n        separator.style.borderRightWidth = makeEm(ruleThickness);\n        separator.style.borderRightStyle = lineType;\n        separator.style.margin = \"0 \" + makeEm(-ruleThickness / 2);\n\n        var _shift = totalHeight - offset;\n\n        if (_shift) {\n          separator.style.verticalAlign = makeEm(-_shift);\n        }\n\n        cols.push(separator);\n      } else {\n        throw new ParseError(\"Invalid separator type: \" + colDescr.separator);\n      }\n\n      colDescrNum++;\n      colDescr = colDescriptions[colDescrNum] || {};\n      firstSeparator = false;\n    }\n\n    if (c >= nc) {\n      continue;\n    }\n\n    var sepwidth = void 0;\n\n    if (c > 0 || group.hskipBeforeAndAfter) {\n      sepwidth = utils.deflt(colDescr.pregap, arraycolsep);\n\n      if (sepwidth !== 0) {\n        colSep = buildCommon.makeSpan([\"arraycolsep\"], []);\n        colSep.style.width = makeEm(sepwidth);\n        cols.push(colSep);\n      }\n    }\n\n    var col = [];\n\n    for (r = 0; r < nr; ++r) {\n      var row = body[r];\n      var elem = row[c];\n\n      if (!elem) {\n        continue;\n      }\n\n      var _shift2 = row.pos - offset;\n\n      elem.depth = row.depth;\n      elem.height = row.height;\n      col.push({\n        type: \"elem\",\n        elem: elem,\n        shift: _shift2\n      });\n    }\n\n    col = buildCommon.makeVList({\n      positionType: \"individualShift\",\n      children: col\n    }, options);\n    col = buildCommon.makeSpan([\"col-align-\" + (colDescr.align || \"c\")], [col]);\n    cols.push(col);\n\n    if (c < nc - 1 || group.hskipBeforeAndAfter) {\n      sepwidth = utils.deflt(colDescr.postgap, arraycolsep);\n\n      if (sepwidth !== 0) {\n        colSep = buildCommon.makeSpan([\"arraycolsep\"], []);\n        colSep.style.width = makeEm(sepwidth);\n        cols.push(colSep);\n      }\n    }\n  }\n\n  body = buildCommon.makeSpan([\"mtable\"], cols); // Add \\hline(s), if any.\n\n  if (hlines.length > 0) {\n    var line = buildCommon.makeLineSpan(\"hline\", options, ruleThickness);\n    var dashes = buildCommon.makeLineSpan(\"hdashline\", options, ruleThickness);\n    var vListElems = [{\n      type: \"elem\",\n      elem: body,\n      shift: 0\n    }];\n\n    while (hlines.length > 0) {\n      var hline = hlines.pop();\n      var lineShift = hline.pos - offset;\n\n      if (hline.isDashed) {\n        vListElems.push({\n          type: \"elem\",\n          elem: dashes,\n          shift: lineShift\n        });\n      } else {\n        vListElems.push({\n          type: \"elem\",\n          elem: line,\n          shift: lineShift\n        });\n      }\n    }\n\n    body = buildCommon.makeVList({\n      positionType: \"individualShift\",\n      children: vListElems\n    }, options);\n  }\n\n  if (tagSpans.length === 0) {\n    return buildCommon.makeSpan([\"mord\"], [body], options);\n  } else {\n    var eqnNumCol = buildCommon.makeVList({\n      positionType: \"individualShift\",\n      children: tagSpans\n    }, options);\n    eqnNumCol = buildCommon.makeSpan([\"tag\"], [eqnNumCol], options);\n    return buildCommon.makeFragment([body, eqnNumCol]);\n  }\n};\n\nvar alignMap = {\n  c: \"center \",\n  l: \"left \",\n  r: \"right \"\n};\n\nvar mathmlBuilder$5 = function mathmlBuilder(group, options) {\n  var tbl = [];\n  var glue = new mathMLTree.MathNode(\"mtd\", [], [\"mtr-glue\"]);\n  var tag = new mathMLTree.MathNode(\"mtd\", [], [\"mml-eqn-num\"]);\n\n  for (var i = 0; i < group.body.length; i++) {\n    var rw = group.body[i];\n    var row = [];\n\n    for (var j = 0; j < rw.length; j++) {\n      row.push(new mathMLTree.MathNode(\"mtd\", [buildGroup(rw[j], options)]));\n    }\n\n    if (group.tags && group.tags[i]) {\n      row.unshift(glue);\n      row.push(glue);\n\n      if (group.leqno) {\n        row.unshift(tag);\n      } else {\n        row.push(tag);\n      }\n    }\n\n    tbl.push(new mathMLTree.MathNode(\"mtr\", row));\n  }\n\n  var table = new mathMLTree.MathNode(\"mtable\", tbl); // Set column alignment, row spacing, column spacing, and\n  // array lines by setting attributes on the table element.\n  // Set the row spacing. In MathML, we specify a gap distance.\n  // We do not use rowGap[] because MathML automatically increases\n  // cell height with the height/depth of the element content.\n  // LaTeX \\arraystretch multiplies the row baseline-to-baseline distance.\n  // We simulate this by adding (arraystretch - 1)em to the gap. This\n  // does a reasonable job of adjusting arrays containing 1 em tall content.\n  // The 0.16 and 0.09 values are found empirically. They produce an array\n  // similar to LaTeX and in which content does not interfere with \\hlines.\n\n  var gap = group.arraystretch === 0.5 ? 0.1 // {smallmatrix}, {subarray}\n  : 0.16 + group.arraystretch - 1 + (group.addJot ? 0.09 : 0);\n  table.setAttribute(\"rowspacing\", makeEm(gap)); // MathML table lines go only between cells.\n  // To place a line on an edge we'll use <menclose>, if necessary.\n\n  var menclose = \"\";\n  var align = \"\";\n\n  if (group.cols && group.cols.length > 0) {\n    // Find column alignment, column spacing, and  vertical lines.\n    var cols = group.cols;\n    var columnLines = \"\";\n    var prevTypeWasAlign = false;\n    var iStart = 0;\n    var iEnd = cols.length;\n\n    if (cols[0].type === \"separator\") {\n      menclose += \"top \";\n      iStart = 1;\n    }\n\n    if (cols[cols.length - 1].type === \"separator\") {\n      menclose += \"bottom \";\n      iEnd -= 1;\n    }\n\n    for (var _i = iStart; _i < iEnd; _i++) {\n      if (cols[_i].type === \"align\") {\n        align += alignMap[cols[_i].align];\n\n        if (prevTypeWasAlign) {\n          columnLines += \"none \";\n        }\n\n        prevTypeWasAlign = true;\n      } else if (cols[_i].type === \"separator\") {\n        // MathML accepts only single lines between cells.\n        // So we read only the first of consecutive separators.\n        if (prevTypeWasAlign) {\n          columnLines += cols[_i].separator === \"|\" ? \"solid \" : \"dashed \";\n          prevTypeWasAlign = false;\n        }\n      }\n    }\n\n    table.setAttribute(\"columnalign\", align.trim());\n\n    if (/[sd]/.test(columnLines)) {\n      table.setAttribute(\"columnlines\", columnLines.trim());\n    }\n  } // Set column spacing.\n\n\n  if (group.colSeparationType === \"align\") {\n    var _cols = group.cols || [];\n\n    var spacing = \"\";\n\n    for (var _i2 = 1; _i2 < _cols.length; _i2++) {\n      spacing += _i2 % 2 ? \"0em \" : \"1em \";\n    }\n\n    table.setAttribute(\"columnspacing\", spacing.trim());\n  } else if (group.colSeparationType === \"alignat\" || group.colSeparationType === \"gather\") {\n    table.setAttribute(\"columnspacing\", \"0em\");\n  } else if (group.colSeparationType === \"small\") {\n    table.setAttribute(\"columnspacing\", \"0.2778em\");\n  } else if (group.colSeparationType === \"CD\") {\n    table.setAttribute(\"columnspacing\", \"0.5em\");\n  } else {\n    table.setAttribute(\"columnspacing\", \"1em\");\n  } // Address \\hline and \\hdashline\n\n\n  var rowLines = \"\";\n  var hlines = group.hLinesBeforeRow;\n  menclose += hlines[0].length > 0 ? \"left \" : \"\";\n  menclose += hlines[hlines.length - 1].length > 0 ? \"right \" : \"\";\n\n  for (var _i3 = 1; _i3 < hlines.length - 1; _i3++) {\n    rowLines += hlines[_i3].length === 0 ? \"none \" // MathML accepts only a single line between rows. Read one element.\n    : hlines[_i3][0] ? \"dashed \" : \"solid \";\n  }\n\n  if (/[sd]/.test(rowLines)) {\n    table.setAttribute(\"rowlines\", rowLines.trim());\n  }\n\n  if (menclose !== \"\") {\n    table = new mathMLTree.MathNode(\"menclose\", [table]);\n    table.setAttribute(\"notation\", menclose.trim());\n  }\n\n  if (group.arraystretch && group.arraystretch < 1) {\n    // A small array. Wrap in scriptstyle so row gap is not too large.\n    table = new mathMLTree.MathNode(\"mstyle\", [table]);\n    table.setAttribute(\"scriptlevel\", \"1\");\n  }\n\n  return table;\n}; // Convenience function for align, align*, aligned, alignat, alignat*, alignedat.\n\n\nvar alignedHandler = function alignedHandler(context, args) {\n  if (context.envName.indexOf(\"ed\") === -1) {\n    validateAmsEnvironmentContext(context);\n  }\n\n  var cols = [];\n  var separationType = context.envName.indexOf(\"at\") > -1 ? \"alignat\" : \"align\";\n  var isSplit = context.envName === \"split\";\n  var res = parseArray(context.parser, {\n    cols,\n    addJot: true,\n    autoTag: isSplit ? undefined : getAutoTag(context.envName),\n    emptySingleRow: true,\n    colSeparationType: separationType,\n    maxNumCols: isSplit ? 2 : undefined,\n    leqno: context.parser.settings.leqno\n  }, \"display\"); // Determining number of columns.\n  // 1. If the first argument is given, we use it as a number of columns,\n  //    and makes sure that each row doesn't exceed that number.\n  // 2. Otherwise, just count number of columns = maximum number\n  //    of cells in each row (\"aligned\" mode -- isAligned will be true).\n  //\n  // At the same time, prepend empty group {} at beginning of every second\n  // cell in each row (starting with second cell) so that operators become\n  // binary.  This behavior is implemented in amsmath's \\start@aligned.\n\n  var numMaths;\n  var numCols = 0;\n  var emptyGroup = {\n    type: \"ordgroup\",\n    mode: context.mode,\n    body: []\n  };\n\n  if (args[0] && args[0].type === \"ordgroup\") {\n    var arg0 = \"\";\n\n    for (var i = 0; i < args[0].body.length; i++) {\n      var textord = assertNodeType(args[0].body[i], \"textord\");\n      arg0 += textord.text;\n    }\n\n    numMaths = Number(arg0);\n    numCols = numMaths * 2;\n  }\n\n  var isAligned = !numCols;\n  res.body.forEach(function (row) {\n    for (var _i4 = 1; _i4 < row.length; _i4 += 2) {\n      // Modify ordgroup node within styling node\n      var styling = assertNodeType(row[_i4], \"styling\");\n      var ordgroup = assertNodeType(styling.body[0], \"ordgroup\");\n      ordgroup.body.unshift(emptyGroup);\n    }\n\n    if (!isAligned) {\n      // Case 1\n      var curMaths = row.length / 2;\n\n      if (numMaths < curMaths) {\n        throw new ParseError(\"Too many math in a row: \" + (\"expected \" + numMaths + \", but got \" + curMaths), row[0]);\n      }\n    } else if (numCols < row.length) {\n      // Case 2\n      numCols = row.length;\n    }\n  }); // Adjusting alignment.\n  // In aligned mode, we add one \\qquad between columns;\n  // otherwise we add nothing.\n\n  for (var _i5 = 0; _i5 < numCols; ++_i5) {\n    var align = \"r\";\n    var pregap = 0;\n\n    if (_i5 % 2 === 1) {\n      align = \"l\";\n    } else if (_i5 > 0 && isAligned) {\n      // \"aligned\" mode.\n      pregap = 1; // add one \\quad\n    }\n\n    cols[_i5] = {\n      type: \"align\",\n      align: align,\n      pregap: pregap,\n      postgap: 0\n    };\n  }\n\n  res.colSeparationType = isAligned ? \"align\" : \"alignat\";\n  return res;\n}; // Arrays are part of LaTeX, defined in lttab.dtx so its documentation\n// is part of the source2e.pdf file of LaTeX2e source documentation.\n// {darray} is an {array} environment where cells are set in \\displaystyle,\n// as defined in nccmath.sty.\n\n\ndefineEnvironment({\n  type: \"array\",\n  names: [\"array\", \"darray\"],\n  props: {\n    numArgs: 1\n  },\n\n  handler(context, args) {\n    // Since no types are specified above, the two possibilities are\n    // - The argument is wrapped in {} or [], in which case Parser's\n    //   parseGroup() returns an \"ordgroup\" wrapping some symbol node.\n    // - The argument is a bare symbol node.\n    var symNode = checkSymbolNodeType(args[0]);\n    var colalign = symNode ? [args[0]] : assertNodeType(args[0], \"ordgroup\").body;\n    var cols = colalign.map(function (nde) {\n      var node = assertSymbolNodeType(nde);\n      var ca = node.text;\n\n      if (\"lcr\".indexOf(ca) !== -1) {\n        return {\n          type: \"align\",\n          align: ca\n        };\n      } else if (ca === \"|\") {\n        return {\n          type: \"separator\",\n          separator: \"|\"\n        };\n      } else if (ca === \":\") {\n        return {\n          type: \"separator\",\n          separator: \":\"\n        };\n      }\n\n      throw new ParseError(\"Unknown column alignment: \" + ca, nde);\n    });\n    var res = {\n      cols,\n      hskipBeforeAndAfter: true,\n      // \\@preamble in lttab.dtx\n      maxNumCols: cols.length\n    };\n    return parseArray(context.parser, res, dCellStyle(context.envName));\n  },\n\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n}); // The matrix environments of amsmath builds on the array environment\n// of LaTeX, which is discussed above.\n// The mathtools package adds starred versions of the same environments.\n// These have an optional argument to choose left|center|right justification.\n\ndefineEnvironment({\n  type: \"array\",\n  names: [\"matrix\", \"pmatrix\", \"bmatrix\", \"Bmatrix\", \"vmatrix\", \"Vmatrix\", \"matrix*\", \"pmatrix*\", \"bmatrix*\", \"Bmatrix*\", \"vmatrix*\", \"Vmatrix*\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(context) {\n    var delimiters = {\n      \"matrix\": null,\n      \"pmatrix\": [\"(\", \")\"],\n      \"bmatrix\": [\"[\", \"]\"],\n      \"Bmatrix\": [\"\\\\{\", \"\\\\}\"],\n      \"vmatrix\": [\"|\", \"|\"],\n      \"Vmatrix\": [\"\\\\Vert\", \"\\\\Vert\"]\n    }[context.envName.replace(\"*\", \"\")]; // \\hskip -\\arraycolsep in amsmath\n\n    var colAlign = \"c\";\n    var payload = {\n      hskipBeforeAndAfter: false,\n      cols: [{\n        type: \"align\",\n        align: colAlign\n      }]\n    };\n\n    if (context.envName.charAt(context.envName.length - 1) === \"*\") {\n      // It's one of the mathtools starred functions.\n      // Parse the optional alignment argument.\n      var parser = context.parser;\n      parser.consumeSpaces();\n\n      if (parser.fetch().text === \"[\") {\n        parser.consume();\n        parser.consumeSpaces();\n        colAlign = parser.fetch().text;\n\n        if (\"lcr\".indexOf(colAlign) === -1) {\n          throw new ParseError(\"Expected l or c or r\", parser.nextToken);\n        }\n\n        parser.consume();\n        parser.consumeSpaces();\n        parser.expect(\"]\");\n        parser.consume();\n        payload.cols = [{\n          type: \"align\",\n          align: colAlign\n        }];\n      }\n    }\n\n    var res = parseArray(context.parser, payload, dCellStyle(context.envName)); // Populate cols with the correct number of column alignment specs.\n\n    var numCols = Math.max(0, ...res.body.map(row => row.length));\n    res.cols = new Array(numCols).fill({\n      type: \"align\",\n      align: colAlign\n    });\n    return delimiters ? {\n      type: \"leftright\",\n      mode: context.mode,\n      body: [res],\n      left: delimiters[0],\n      right: delimiters[1],\n      rightColor: undefined // \\right uninfluenced by \\color in array\n\n    } : res;\n  },\n\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n});\ndefineEnvironment({\n  type: \"array\",\n  names: [\"smallmatrix\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(context) {\n    var payload = {\n      arraystretch: 0.5\n    };\n    var res = parseArray(context.parser, payload, \"script\");\n    res.colSeparationType = \"small\";\n    return res;\n  },\n\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n});\ndefineEnvironment({\n  type: \"array\",\n  names: [\"subarray\"],\n  props: {\n    numArgs: 1\n  },\n\n  handler(context, args) {\n    // Parsing of {subarray} is similar to {array}\n    var symNode = checkSymbolNodeType(args[0]);\n    var colalign = symNode ? [args[0]] : assertNodeType(args[0], \"ordgroup\").body;\n    var cols = colalign.map(function (nde) {\n      var node = assertSymbolNodeType(nde);\n      var ca = node.text; // {subarray} only recognizes \"l\" & \"c\"\n\n      if (\"lc\".indexOf(ca) !== -1) {\n        return {\n          type: \"align\",\n          align: ca\n        };\n      }\n\n      throw new ParseError(\"Unknown column alignment: \" + ca, nde);\n    });\n\n    if (cols.length > 1) {\n      throw new ParseError(\"{subarray} can contain only one column\");\n    }\n\n    var res = {\n      cols,\n      hskipBeforeAndAfter: false,\n      arraystretch: 0.5\n    };\n    res = parseArray(context.parser, res, \"script\");\n\n    if (res.body.length > 0 && res.body[0].length > 1) {\n      throw new ParseError(\"{subarray} can contain only one column\");\n    }\n\n    return res;\n  },\n\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n}); // A cases environment (in amsmath.sty) is almost equivalent to\n// \\def\\arraystretch{1.2}%\n// \\left\\{\\begin{array}{@{}l@{\\quad}l@{}} … \\end{array}\\right.\n// {dcases} is a {cases} environment where cells are set in \\displaystyle,\n// as defined in mathtools.sty.\n// {rcases} is another mathtools environment. It's brace is on the right side.\n\ndefineEnvironment({\n  type: \"array\",\n  names: [\"cases\", \"dcases\", \"rcases\", \"drcases\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(context) {\n    var payload = {\n      arraystretch: 1.2,\n      cols: [{\n        type: \"align\",\n        align: \"l\",\n        pregap: 0,\n        // TODO(kevinb) get the current style.\n        // For now we use the metrics for TEXT style which is what we were\n        // doing before.  Before attempting to get the current style we\n        // should look at TeX's behavior especially for \\over and matrices.\n        postgap: 1.0\n        /* 1em quad */\n\n      }, {\n        type: \"align\",\n        align: \"l\",\n        pregap: 0,\n        postgap: 0\n      }]\n    };\n    var res = parseArray(context.parser, payload, dCellStyle(context.envName));\n    return {\n      type: \"leftright\",\n      mode: context.mode,\n      body: [res],\n      left: context.envName.indexOf(\"r\") > -1 ? \".\" : \"\\\\{\",\n      right: context.envName.indexOf(\"r\") > -1 ? \"\\\\}\" : \".\",\n      rightColor: undefined\n    };\n  },\n\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n}); // In the align environment, one uses ampersands, &, to specify number of\n// columns in each row, and to locate spacing between each column.\n// align gets automatic numbering. align* and aligned do not.\n// The alignedat environment can be used in math mode.\n// Note that we assume \\nomallineskiplimit to be zero,\n// so that \\strut@ is the same as \\strut.\n\ndefineEnvironment({\n  type: \"array\",\n  names: [\"align\", \"align*\", \"aligned\", \"split\"],\n  props: {\n    numArgs: 0\n  },\n  handler: alignedHandler,\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n}); // A gathered environment is like an array environment with one centered\n// column, but where rows are considered lines so get \\jot line spacing\n// and contents are set in \\displaystyle.\n\ndefineEnvironment({\n  type: \"array\",\n  names: [\"gathered\", \"gather\", \"gather*\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(context) {\n    if (utils.contains([\"gather\", \"gather*\"], context.envName)) {\n      validateAmsEnvironmentContext(context);\n    }\n\n    var res = {\n      cols: [{\n        type: \"align\",\n        align: \"c\"\n      }],\n      addJot: true,\n      colSeparationType: \"gather\",\n      autoTag: getAutoTag(context.envName),\n      emptySingleRow: true,\n      leqno: context.parser.settings.leqno\n    };\n    return parseArray(context.parser, res, \"display\");\n  },\n\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n}); // alignat environment is like an align environment, but one must explicitly\n// specify maximum number of columns in each row, and can adjust spacing between\n// each columns.\n\ndefineEnvironment({\n  type: \"array\",\n  names: [\"alignat\", \"alignat*\", \"alignedat\"],\n  props: {\n    numArgs: 1\n  },\n  handler: alignedHandler,\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n});\ndefineEnvironment({\n  type: \"array\",\n  names: [\"equation\", \"equation*\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(context) {\n    validateAmsEnvironmentContext(context);\n    var res = {\n      autoTag: getAutoTag(context.envName),\n      emptySingleRow: true,\n      singleRow: true,\n      maxNumCols: 1,\n      leqno: context.parser.settings.leqno\n    };\n    return parseArray(context.parser, res, \"display\");\n  },\n\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n});\ndefineEnvironment({\n  type: \"array\",\n  names: [\"CD\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(context) {\n    validateAmsEnvironmentContext(context);\n    return parseCD(context.parser);\n  },\n\n  htmlBuilder: htmlBuilder$6,\n  mathmlBuilder: mathmlBuilder$5\n});\ndefineMacro(\"\\\\nonumber\", \"\\\\gdef\\\\@eqnsw{0}\");\ndefineMacro(\"\\\\notag\", \"\\\\nonumber\"); // Catch \\hline outside array environment\n\ndefineFunction({\n  type: \"text\",\n  // Doesn't matter what this is.\n  names: [\"\\\\hline\", \"\\\\hdashline\"],\n  props: {\n    numArgs: 0,\n    allowedInText: true,\n    allowedInMath: true\n  },\n\n  handler(context, args) {\n    throw new ParseError(context.funcName + \" valid only within array environment\");\n  }\n\n});\n\nvar environments = _environments;\n\n// defineEnvironment definitions.\n\ndefineFunction({\n  type: \"environment\",\n  names: [\"\\\\begin\", \"\\\\end\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"text\"]\n  },\n\n  handler(_ref, args) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var nameGroup = args[0];\n\n    if (nameGroup.type !== \"ordgroup\") {\n      throw new ParseError(\"Invalid environment name\", nameGroup);\n    }\n\n    var envName = \"\";\n\n    for (var i = 0; i < nameGroup.body.length; ++i) {\n      envName += assertNodeType(nameGroup.body[i], \"textord\").text;\n    }\n\n    if (funcName === \"\\\\begin\") {\n      // begin...end is similar to left...right\n      if (!environments.hasOwnProperty(envName)) {\n        throw new ParseError(\"No such environment: \" + envName, nameGroup);\n      } // Build the environment object. Arguments and other information will\n      // be made available to the begin and end methods using properties.\n\n\n      var env = environments[envName];\n      var {\n        args: _args,\n        optArgs\n      } = parser.parseArguments(\"\\\\begin{\" + envName + \"}\", env);\n      var context = {\n        mode: parser.mode,\n        envName,\n        parser\n      };\n      var result = env.handler(context, _args, optArgs);\n      parser.expect(\"\\\\end\", false);\n      var endNameToken = parser.nextToken;\n      var end = assertNodeType(parser.parseFunction(), \"environment\");\n\n      if (end.name !== envName) {\n        throw new ParseError(\"Mismatch: \\\\begin{\" + envName + \"} matched by \\\\end{\" + end.name + \"}\", endNameToken);\n      } // $FlowFixMe, \"environment\" handler returns an environment ParseNode\n\n\n      return result;\n    }\n\n    return {\n      type: \"environment\",\n      mode: parser.mode,\n      name: envName,\n      nameGroup\n    };\n  }\n\n});\n\n// TODO(kevinb): implement \\\\sl and \\\\sc\n\nvar htmlBuilder$5 = (group, options) => {\n  var font = group.font;\n  var newOptions = options.withFont(font);\n  return buildGroup$1(group.body, newOptions);\n};\n\nvar mathmlBuilder$4 = (group, options) => {\n  var font = group.font;\n  var newOptions = options.withFont(font);\n  return buildGroup(group.body, newOptions);\n};\n\nvar fontAliases = {\n  \"\\\\Bbb\": \"\\\\mathbb\",\n  \"\\\\bold\": \"\\\\mathbf\",\n  \"\\\\frak\": \"\\\\mathfrak\",\n  \"\\\\bm\": \"\\\\boldsymbol\"\n};\ndefineFunction({\n  type: \"font\",\n  names: [// styles, except \\boldsymbol defined below\n  \"\\\\mathrm\", \"\\\\mathit\", \"\\\\mathbf\", \"\\\\mathnormal\", \"\\\\mathsfit\", // families\n  \"\\\\mathbb\", \"\\\\mathcal\", \"\\\\mathfrak\", \"\\\\mathscr\", \"\\\\mathsf\", \"\\\\mathtt\", // aliases, except \\bm defined below\n  \"\\\\Bbb\", \"\\\\bold\", \"\\\\frak\"],\n  props: {\n    numArgs: 1,\n    allowedInArgument: true\n  },\n  handler: (_ref, args) => {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var body = normalizeArgument(args[0]);\n    var func = funcName;\n\n    if (func in fontAliases) {\n      func = fontAliases[func];\n    }\n\n    return {\n      type: \"font\",\n      mode: parser.mode,\n      font: func.slice(1),\n      body\n    };\n  },\n  htmlBuilder: htmlBuilder$5,\n  mathmlBuilder: mathmlBuilder$4\n});\ndefineFunction({\n  type: \"mclass\",\n  names: [\"\\\\boldsymbol\", \"\\\\bm\"],\n  props: {\n    numArgs: 1\n  },\n  handler: (_ref2, args) => {\n    var {\n      parser\n    } = _ref2;\n    var body = args[0];\n    var isCharacterBox = utils.isCharacterBox(body); // amsbsy.sty's \\boldsymbol uses \\binrel spacing to inherit the\n    // argument's bin|rel|ord status\n\n    return {\n      type: \"mclass\",\n      mode: parser.mode,\n      mclass: binrelClass(body),\n      body: [{\n        type: \"font\",\n        mode: parser.mode,\n        font: \"boldsymbol\",\n        body\n      }],\n      isCharacterBox: isCharacterBox\n    };\n  }\n}); // Old font changing functions\n\ndefineFunction({\n  type: \"font\",\n  names: [\"\\\\rm\", \"\\\\sf\", \"\\\\tt\", \"\\\\bf\", \"\\\\it\", \"\\\\cal\"],\n  props: {\n    numArgs: 0,\n    allowedInText: true\n  },\n  handler: (_ref3, args) => {\n    var {\n      parser,\n      funcName,\n      breakOnTokenText\n    } = _ref3;\n    var {\n      mode\n    } = parser;\n    var body = parser.parseExpression(true, breakOnTokenText);\n    var style = \"math\" + funcName.slice(1);\n    return {\n      type: \"font\",\n      mode: mode,\n      font: style,\n      body: {\n        type: \"ordgroup\",\n        mode: parser.mode,\n        body\n      }\n    };\n  },\n  htmlBuilder: htmlBuilder$5,\n  mathmlBuilder: mathmlBuilder$4\n});\n\nvar adjustStyle = (size, originalStyle) => {\n  // Figure out what style this fraction should be in based on the\n  // function used\n  var style = originalStyle;\n\n  if (size === \"display\") {\n    // Get display style as a default.\n    // If incoming style is sub/sup, use style.text() to get correct size.\n    style = style.id >= Style$1.SCRIPT.id ? style.text() : Style$1.DISPLAY;\n  } else if (size === \"text\" && style.size === Style$1.DISPLAY.size) {\n    // We're in a \\tfrac but incoming style is displaystyle, so:\n    style = Style$1.TEXT;\n  } else if (size === \"script\") {\n    style = Style$1.SCRIPT;\n  } else if (size === \"scriptscript\") {\n    style = Style$1.SCRIPTSCRIPT;\n  }\n\n  return style;\n};\n\nvar htmlBuilder$4 = (group, options) => {\n  // Fractions are handled in the TeXbook on pages 444-445, rules 15(a-e).\n  var style = adjustStyle(group.size, options.style);\n  var nstyle = style.fracNum();\n  var dstyle = style.fracDen();\n  var newOptions;\n  newOptions = options.havingStyle(nstyle);\n  var numerm = buildGroup$1(group.numer, newOptions, options);\n\n  if (group.continued) {\n    // \\cfrac inserts a \\strut into the numerator.\n    // Get \\strut dimensions from TeXbook page 353.\n    var hStrut = 8.5 / options.fontMetrics().ptPerEm;\n    var dStrut = 3.5 / options.fontMetrics().ptPerEm;\n    numerm.height = numerm.height < hStrut ? hStrut : numerm.height;\n    numerm.depth = numerm.depth < dStrut ? dStrut : numerm.depth;\n  }\n\n  newOptions = options.havingStyle(dstyle);\n  var denomm = buildGroup$1(group.denom, newOptions, options);\n  var rule;\n  var ruleWidth;\n  var ruleSpacing;\n\n  if (group.hasBarLine) {\n    if (group.barSize) {\n      ruleWidth = calculateSize(group.barSize, options);\n      rule = buildCommon.makeLineSpan(\"frac-line\", options, ruleWidth);\n    } else {\n      rule = buildCommon.makeLineSpan(\"frac-line\", options);\n    }\n\n    ruleWidth = rule.height;\n    ruleSpacing = rule.height;\n  } else {\n    rule = null;\n    ruleWidth = 0;\n    ruleSpacing = options.fontMetrics().defaultRuleThickness;\n  } // Rule 15b\n\n\n  var numShift;\n  var clearance;\n  var denomShift;\n\n  if (style.size === Style$1.DISPLAY.size || group.size === \"display\") {\n    numShift = options.fontMetrics().num1;\n\n    if (ruleWidth > 0) {\n      clearance = 3 * ruleSpacing;\n    } else {\n      clearance = 7 * ruleSpacing;\n    }\n\n    denomShift = options.fontMetrics().denom1;\n  } else {\n    if (ruleWidth > 0) {\n      numShift = options.fontMetrics().num2;\n      clearance = ruleSpacing;\n    } else {\n      numShift = options.fontMetrics().num3;\n      clearance = 3 * ruleSpacing;\n    }\n\n    denomShift = options.fontMetrics().denom2;\n  }\n\n  var frac;\n\n  if (!rule) {\n    // Rule 15c\n    var candidateClearance = numShift - numerm.depth - (denomm.height - denomShift);\n\n    if (candidateClearance < clearance) {\n      numShift += 0.5 * (clearance - candidateClearance);\n      denomShift += 0.5 * (clearance - candidateClearance);\n    }\n\n    frac = buildCommon.makeVList({\n      positionType: \"individualShift\",\n      children: [{\n        type: \"elem\",\n        elem: denomm,\n        shift: denomShift\n      }, {\n        type: \"elem\",\n        elem: numerm,\n        shift: -numShift\n      }]\n    }, options);\n  } else {\n    // Rule 15d\n    var axisHeight = options.fontMetrics().axisHeight;\n\n    if (numShift - numerm.depth - (axisHeight + 0.5 * ruleWidth) < clearance) {\n      numShift += clearance - (numShift - numerm.depth - (axisHeight + 0.5 * ruleWidth));\n    }\n\n    if (axisHeight - 0.5 * ruleWidth - (denomm.height - denomShift) < clearance) {\n      denomShift += clearance - (axisHeight - 0.5 * ruleWidth - (denomm.height - denomShift));\n    }\n\n    var midShift = -(axisHeight - 0.5 * ruleWidth);\n    frac = buildCommon.makeVList({\n      positionType: \"individualShift\",\n      children: [{\n        type: \"elem\",\n        elem: denomm,\n        shift: denomShift\n      }, {\n        type: \"elem\",\n        elem: rule,\n        shift: midShift\n      }, {\n        type: \"elem\",\n        elem: numerm,\n        shift: -numShift\n      }]\n    }, options);\n  } // Since we manually change the style sometimes (with \\dfrac or \\tfrac),\n  // account for the possible size change here.\n\n\n  newOptions = options.havingStyle(style);\n  frac.height *= newOptions.sizeMultiplier / options.sizeMultiplier;\n  frac.depth *= newOptions.sizeMultiplier / options.sizeMultiplier; // Rule 15e\n\n  var delimSize;\n\n  if (style.size === Style$1.DISPLAY.size) {\n    delimSize = options.fontMetrics().delim1;\n  } else if (style.size === Style$1.SCRIPTSCRIPT.size) {\n    delimSize = options.havingStyle(Style$1.SCRIPT).fontMetrics().delim2;\n  } else {\n    delimSize = options.fontMetrics().delim2;\n  }\n\n  var leftDelim;\n  var rightDelim;\n\n  if (group.leftDelim == null) {\n    leftDelim = makeNullDelimiter(options, [\"mopen\"]);\n  } else {\n    leftDelim = delimiter.customSizedDelim(group.leftDelim, delimSize, true, options.havingStyle(style), group.mode, [\"mopen\"]);\n  }\n\n  if (group.continued) {\n    rightDelim = buildCommon.makeSpan([]); // zero width for \\cfrac\n  } else if (group.rightDelim == null) {\n    rightDelim = makeNullDelimiter(options, [\"mclose\"]);\n  } else {\n    rightDelim = delimiter.customSizedDelim(group.rightDelim, delimSize, true, options.havingStyle(style), group.mode, [\"mclose\"]);\n  }\n\n  return buildCommon.makeSpan([\"mord\"].concat(newOptions.sizingClasses(options)), [leftDelim, buildCommon.makeSpan([\"mfrac\"], [frac]), rightDelim], options);\n};\n\nvar mathmlBuilder$3 = (group, options) => {\n  var node = new mathMLTree.MathNode(\"mfrac\", [buildGroup(group.numer, options), buildGroup(group.denom, options)]);\n\n  if (!group.hasBarLine) {\n    node.setAttribute(\"linethickness\", \"0px\");\n  } else if (group.barSize) {\n    var ruleWidth = calculateSize(group.barSize, options);\n    node.setAttribute(\"linethickness\", makeEm(ruleWidth));\n  }\n\n  var style = adjustStyle(group.size, options.style);\n\n  if (style.size !== options.style.size) {\n    node = new mathMLTree.MathNode(\"mstyle\", [node]);\n    var isDisplay = style.size === Style$1.DISPLAY.size ? \"true\" : \"false\";\n    node.setAttribute(\"displaystyle\", isDisplay);\n    node.setAttribute(\"scriptlevel\", \"0\");\n  }\n\n  if (group.leftDelim != null || group.rightDelim != null) {\n    var withDelims = [];\n\n    if (group.leftDelim != null) {\n      var leftOp = new mathMLTree.MathNode(\"mo\", [new mathMLTree.TextNode(group.leftDelim.replace(\"\\\\\", \"\"))]);\n      leftOp.setAttribute(\"fence\", \"true\");\n      withDelims.push(leftOp);\n    }\n\n    withDelims.push(node);\n\n    if (group.rightDelim != null) {\n      var rightOp = new mathMLTree.MathNode(\"mo\", [new mathMLTree.TextNode(group.rightDelim.replace(\"\\\\\", \"\"))]);\n      rightOp.setAttribute(\"fence\", \"true\");\n      withDelims.push(rightOp);\n    }\n\n    return makeRow(withDelims);\n  }\n\n  return node;\n};\n\ndefineFunction({\n  type: \"genfrac\",\n  names: [\"\\\\dfrac\", \"\\\\frac\", \"\\\\tfrac\", \"\\\\dbinom\", \"\\\\binom\", \"\\\\tbinom\", \"\\\\\\\\atopfrac\", // can’t be entered directly\n  \"\\\\\\\\bracefrac\", \"\\\\\\\\brackfrac\" // ditto\n  ],\n  props: {\n    numArgs: 2,\n    allowedInArgument: true\n  },\n  handler: (_ref, args) => {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var numer = args[0];\n    var denom = args[1];\n    var hasBarLine;\n    var leftDelim = null;\n    var rightDelim = null;\n    var size = \"auto\";\n\n    switch (funcName) {\n      case \"\\\\dfrac\":\n      case \"\\\\frac\":\n      case \"\\\\tfrac\":\n        hasBarLine = true;\n        break;\n\n      case \"\\\\\\\\atopfrac\":\n        hasBarLine = false;\n        break;\n\n      case \"\\\\dbinom\":\n      case \"\\\\binom\":\n      case \"\\\\tbinom\":\n        hasBarLine = false;\n        leftDelim = \"(\";\n        rightDelim = \")\";\n        break;\n\n      case \"\\\\\\\\bracefrac\":\n        hasBarLine = false;\n        leftDelim = \"\\\\{\";\n        rightDelim = \"\\\\}\";\n        break;\n\n      case \"\\\\\\\\brackfrac\":\n        hasBarLine = false;\n        leftDelim = \"[\";\n        rightDelim = \"]\";\n        break;\n\n      default:\n        throw new Error(\"Unrecognized genfrac command\");\n    }\n\n    switch (funcName) {\n      case \"\\\\dfrac\":\n      case \"\\\\dbinom\":\n        size = \"display\";\n        break;\n\n      case \"\\\\tfrac\":\n      case \"\\\\tbinom\":\n        size = \"text\";\n        break;\n    }\n\n    return {\n      type: \"genfrac\",\n      mode: parser.mode,\n      continued: false,\n      numer,\n      denom,\n      hasBarLine,\n      leftDelim,\n      rightDelim,\n      size,\n      barSize: null\n    };\n  },\n  htmlBuilder: htmlBuilder$4,\n  mathmlBuilder: mathmlBuilder$3\n});\ndefineFunction({\n  type: \"genfrac\",\n  names: [\"\\\\cfrac\"],\n  props: {\n    numArgs: 2\n  },\n  handler: (_ref2, args) => {\n    var {\n      parser,\n      funcName\n    } = _ref2;\n    var numer = args[0];\n    var denom = args[1];\n    return {\n      type: \"genfrac\",\n      mode: parser.mode,\n      continued: true,\n      numer,\n      denom,\n      hasBarLine: true,\n      leftDelim: null,\n      rightDelim: null,\n      size: \"display\",\n      barSize: null\n    };\n  }\n}); // Infix generalized fractions -- these are not rendered directly, but replaced\n// immediately by one of the variants above.\n\ndefineFunction({\n  type: \"infix\",\n  names: [\"\\\\over\", \"\\\\choose\", \"\\\\atop\", \"\\\\brace\", \"\\\\brack\"],\n  props: {\n    numArgs: 0,\n    infix: true\n  },\n\n  handler(_ref3) {\n    var {\n      parser,\n      funcName,\n      token\n    } = _ref3;\n    var replaceWith;\n\n    switch (funcName) {\n      case \"\\\\over\":\n        replaceWith = \"\\\\frac\";\n        break;\n\n      case \"\\\\choose\":\n        replaceWith = \"\\\\binom\";\n        break;\n\n      case \"\\\\atop\":\n        replaceWith = \"\\\\\\\\atopfrac\";\n        break;\n\n      case \"\\\\brace\":\n        replaceWith = \"\\\\\\\\bracefrac\";\n        break;\n\n      case \"\\\\brack\":\n        replaceWith = \"\\\\\\\\brackfrac\";\n        break;\n\n      default:\n        throw new Error(\"Unrecognized infix genfrac command\");\n    }\n\n    return {\n      type: \"infix\",\n      mode: parser.mode,\n      replaceWith,\n      token\n    };\n  }\n\n});\nvar stylArray = [\"display\", \"text\", \"script\", \"scriptscript\"];\n\nvar delimFromValue = function delimFromValue(delimString) {\n  var delim = null;\n\n  if (delimString.length > 0) {\n    delim = delimString;\n    delim = delim === \".\" ? null : delim;\n  }\n\n  return delim;\n};\n\ndefineFunction({\n  type: \"genfrac\",\n  names: [\"\\\\genfrac\"],\n  props: {\n    numArgs: 6,\n    allowedInArgument: true,\n    argTypes: [\"math\", \"math\", \"size\", \"text\", \"math\", \"math\"]\n  },\n\n  handler(_ref4, args) {\n    var {\n      parser\n    } = _ref4;\n    var numer = args[4];\n    var denom = args[5]; // Look into the parse nodes to get the desired delimiters.\n\n    var leftNode = normalizeArgument(args[0]);\n    var leftDelim = leftNode.type === \"atom\" && leftNode.family === \"open\" ? delimFromValue(leftNode.text) : null;\n    var rightNode = normalizeArgument(args[1]);\n    var rightDelim = rightNode.type === \"atom\" && rightNode.family === \"close\" ? delimFromValue(rightNode.text) : null;\n    var barNode = assertNodeType(args[2], \"size\");\n    var hasBarLine;\n    var barSize = null;\n\n    if (barNode.isBlank) {\n      // \\genfrac acts differently than \\above.\n      // \\genfrac treats an empty size group as a signal to use a\n      // standard bar size. \\above would see size = 0 and omit the bar.\n      hasBarLine = true;\n    } else {\n      barSize = barNode.value;\n      hasBarLine = barSize.number > 0;\n    } // Find out if we want displaystyle, textstyle, etc.\n\n\n    var size = \"auto\";\n    var styl = args[3];\n\n    if (styl.type === \"ordgroup\") {\n      if (styl.body.length > 0) {\n        var textOrd = assertNodeType(styl.body[0], \"textord\");\n        size = stylArray[Number(textOrd.text)];\n      }\n    } else {\n      styl = assertNodeType(styl, \"textord\");\n      size = stylArray[Number(styl.text)];\n    }\n\n    return {\n      type: \"genfrac\",\n      mode: parser.mode,\n      numer,\n      denom,\n      continued: false,\n      hasBarLine,\n      barSize,\n      leftDelim,\n      rightDelim,\n      size\n    };\n  },\n\n  htmlBuilder: htmlBuilder$4,\n  mathmlBuilder: mathmlBuilder$3\n}); // \\above is an infix fraction that also defines a fraction bar size.\n\ndefineFunction({\n  type: \"infix\",\n  names: [\"\\\\above\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"size\"],\n    infix: true\n  },\n\n  handler(_ref5, args) {\n    var {\n      parser,\n      funcName,\n      token\n    } = _ref5;\n    return {\n      type: \"infix\",\n      mode: parser.mode,\n      replaceWith: \"\\\\\\\\abovefrac\",\n      size: assertNodeType(args[0], \"size\").value,\n      token\n    };\n  }\n\n});\ndefineFunction({\n  type: \"genfrac\",\n  names: [\"\\\\\\\\abovefrac\"],\n  props: {\n    numArgs: 3,\n    argTypes: [\"math\", \"size\", \"math\"]\n  },\n  handler: (_ref6, args) => {\n    var {\n      parser,\n      funcName\n    } = _ref6;\n    var numer = args[0];\n    var barSize = assert(assertNodeType(args[1], \"infix\").size);\n    var denom = args[2];\n    var hasBarLine = barSize.number > 0;\n    return {\n      type: \"genfrac\",\n      mode: parser.mode,\n      numer,\n      denom,\n      continued: false,\n      hasBarLine,\n      barSize,\n      leftDelim: null,\n      rightDelim: null,\n      size: \"auto\"\n    };\n  },\n  htmlBuilder: htmlBuilder$4,\n  mathmlBuilder: mathmlBuilder$3\n});\n\n// NOTE: Unlike most `htmlBuilder`s, this one handles not only \"horizBrace\", but\n// also \"supsub\" since an over/underbrace can affect super/subscripting.\nvar htmlBuilder$3 = (grp, options) => {\n  var style = options.style; // Pull out the `ParseNode<\"horizBrace\">` if `grp` is a \"supsub\" node.\n\n  var supSubGroup;\n  var group;\n\n  if (grp.type === \"supsub\") {\n    // Ref: LaTeX source2e: }}}}\\limits}\n    // i.e. LaTeX treats the brace similar to an op and passes it\n    // with \\limits, so we need to assign supsub style.\n    supSubGroup = grp.sup ? buildGroup$1(grp.sup, options.havingStyle(style.sup()), options) : buildGroup$1(grp.sub, options.havingStyle(style.sub()), options);\n    group = assertNodeType(grp.base, \"horizBrace\");\n  } else {\n    group = assertNodeType(grp, \"horizBrace\");\n  } // Build the base group\n\n\n  var body = buildGroup$1(group.base, options.havingBaseStyle(Style$1.DISPLAY)); // Create the stretchy element\n\n  var braceBody = stretchy.svgSpan(group, options); // Generate the vlist, with the appropriate kerns        ┏━━━━━━━━┓\n  // This first vlist contains the content and the brace:   equation\n\n  var vlist;\n\n  if (group.isOver) {\n    vlist = buildCommon.makeVList({\n      positionType: \"firstBaseline\",\n      children: [{\n        type: \"elem\",\n        elem: body\n      }, {\n        type: \"kern\",\n        size: 0.1\n      }, {\n        type: \"elem\",\n        elem: braceBody\n      }]\n    }, options); // $FlowFixMe: Replace this with passing \"svg-align\" into makeVList.\n\n    vlist.children[0].children[0].children[1].classes.push(\"svg-align\");\n  } else {\n    vlist = buildCommon.makeVList({\n      positionType: \"bottom\",\n      positionData: body.depth + 0.1 + braceBody.height,\n      children: [{\n        type: \"elem\",\n        elem: braceBody\n      }, {\n        type: \"kern\",\n        size: 0.1\n      }, {\n        type: \"elem\",\n        elem: body\n      }]\n    }, options); // $FlowFixMe: Replace this with passing \"svg-align\" into makeVList.\n\n    vlist.children[0].children[0].children[0].classes.push(\"svg-align\");\n  }\n\n  if (supSubGroup) {\n    // To write the supsub, wrap the first vlist in another vlist:\n    // They can't all go in the same vlist, because the note might be\n    // wider than the equation. We want the equation to control the\n    // brace width.\n    //      note          long note           long note\n    //   ┏━━━━━━━━┓   or    ┏━━━┓     not    ┏━━━━━━━━━┓\n    //    equation           eqn                 eqn\n    var vSpan = buildCommon.makeSpan([\"mord\", group.isOver ? \"mover\" : \"munder\"], [vlist], options);\n\n    if (group.isOver) {\n      vlist = buildCommon.makeVList({\n        positionType: \"firstBaseline\",\n        children: [{\n          type: \"elem\",\n          elem: vSpan\n        }, {\n          type: \"kern\",\n          size: 0.2\n        }, {\n          type: \"elem\",\n          elem: supSubGroup\n        }]\n      }, options);\n    } else {\n      vlist = buildCommon.makeVList({\n        positionType: \"bottom\",\n        positionData: vSpan.depth + 0.2 + supSubGroup.height + supSubGroup.depth,\n        children: [{\n          type: \"elem\",\n          elem: supSubGroup\n        }, {\n          type: \"kern\",\n          size: 0.2\n        }, {\n          type: \"elem\",\n          elem: vSpan\n        }]\n      }, options);\n    }\n  }\n\n  return buildCommon.makeSpan([\"mord\", group.isOver ? \"mover\" : \"munder\"], [vlist], options);\n};\n\nvar mathmlBuilder$2 = (group, options) => {\n  var accentNode = stretchy.mathMLnode(group.label);\n  return new mathMLTree.MathNode(group.isOver ? \"mover\" : \"munder\", [buildGroup(group.base, options), accentNode]);\n}; // Horizontal stretchy braces\n\n\ndefineFunction({\n  type: \"horizBrace\",\n  names: [\"\\\\overbrace\", \"\\\\underbrace\"],\n  props: {\n    numArgs: 1\n  },\n\n  handler(_ref, args) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    return {\n      type: \"horizBrace\",\n      mode: parser.mode,\n      label: funcName,\n      isOver: /^\\\\over/.test(funcName),\n      base: args[0]\n    };\n  },\n\n  htmlBuilder: htmlBuilder$3,\n  mathmlBuilder: mathmlBuilder$2\n});\n\ndefineFunction({\n  type: \"href\",\n  names: [\"\\\\href\"],\n  props: {\n    numArgs: 2,\n    argTypes: [\"url\", \"original\"],\n    allowedInText: true\n  },\n  handler: (_ref, args) => {\n    var {\n      parser\n    } = _ref;\n    var body = args[1];\n    var href = assertNodeType(args[0], \"url\").url;\n\n    if (!parser.settings.isTrusted({\n      command: \"\\\\href\",\n      url: href\n    })) {\n      return parser.formatUnsupportedCmd(\"\\\\href\");\n    }\n\n    return {\n      type: \"href\",\n      mode: parser.mode,\n      href,\n      body: ordargument(body)\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var elements = buildExpression$1(group.body, options, false);\n    return buildCommon.makeAnchor(group.href, [], elements, options);\n  },\n  mathmlBuilder: (group, options) => {\n    var math = buildExpressionRow(group.body, options);\n\n    if (!(math instanceof MathNode)) {\n      math = new MathNode(\"mrow\", [math]);\n    }\n\n    math.setAttribute(\"href\", group.href);\n    return math;\n  }\n});\ndefineFunction({\n  type: \"href\",\n  names: [\"\\\\url\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"url\"],\n    allowedInText: true\n  },\n  handler: (_ref2, args) => {\n    var {\n      parser\n    } = _ref2;\n    var href = assertNodeType(args[0], \"url\").url;\n\n    if (!parser.settings.isTrusted({\n      command: \"\\\\url\",\n      url: href\n    })) {\n      return parser.formatUnsupportedCmd(\"\\\\url\");\n    }\n\n    var chars = [];\n\n    for (var i = 0; i < href.length; i++) {\n      var c = href[i];\n\n      if (c === \"~\") {\n        c = \"\\\\textasciitilde\";\n      }\n\n      chars.push({\n        type: \"textord\",\n        mode: \"text\",\n        text: c\n      });\n    }\n\n    var body = {\n      type: \"text\",\n      mode: parser.mode,\n      font: \"\\\\texttt\",\n      body: chars\n    };\n    return {\n      type: \"href\",\n      mode: parser.mode,\n      href,\n      body: ordargument(body)\n    };\n  }\n});\n\n// In LaTeX, \\vcenter can act only on a box, as in\n// \\vcenter{\\hbox{$\\frac{a+b}{\\dfrac{c}{d}}$}}\n// This function by itself doesn't do anything but prevent a soft line break.\n\ndefineFunction({\n  type: \"hbox\",\n  names: [\"\\\\hbox\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"text\"],\n    allowedInText: true,\n    primitive: true\n  },\n\n  handler(_ref, args) {\n    var {\n      parser\n    } = _ref;\n    return {\n      type: \"hbox\",\n      mode: parser.mode,\n      body: ordargument(args[0])\n    };\n  },\n\n  htmlBuilder(group, options) {\n    var elements = buildExpression$1(group.body, options, false);\n    return buildCommon.makeFragment(elements);\n  },\n\n  mathmlBuilder(group, options) {\n    return new mathMLTree.MathNode(\"mrow\", buildExpression(group.body, options));\n  }\n\n});\n\ndefineFunction({\n  type: \"html\",\n  names: [\"\\\\htmlClass\", \"\\\\htmlId\", \"\\\\htmlStyle\", \"\\\\htmlData\"],\n  props: {\n    numArgs: 2,\n    argTypes: [\"raw\", \"original\"],\n    allowedInText: true\n  },\n  handler: (_ref, args) => {\n    var {\n      parser,\n      funcName,\n      token\n    } = _ref;\n    var value = assertNodeType(args[0], \"raw\").string;\n    var body = args[1];\n\n    if (parser.settings.strict) {\n      parser.settings.reportNonstrict(\"htmlExtension\", \"HTML extension is disabled on strict mode\");\n    }\n\n    var trustContext;\n    var attributes = {};\n\n    switch (funcName) {\n      case \"\\\\htmlClass\":\n        attributes.class = value;\n        trustContext = {\n          command: \"\\\\htmlClass\",\n          class: value\n        };\n        break;\n\n      case \"\\\\htmlId\":\n        attributes.id = value;\n        trustContext = {\n          command: \"\\\\htmlId\",\n          id: value\n        };\n        break;\n\n      case \"\\\\htmlStyle\":\n        attributes.style = value;\n        trustContext = {\n          command: \"\\\\htmlStyle\",\n          style: value\n        };\n        break;\n\n      case \"\\\\htmlData\":\n        {\n          var data = value.split(\",\");\n\n          for (var i = 0; i < data.length; i++) {\n            var keyVal = data[i].split(\"=\");\n\n            if (keyVal.length !== 2) {\n              throw new ParseError(\"Error parsing key-value for \\\\htmlData\");\n            }\n\n            attributes[\"data-\" + keyVal[0].trim()] = keyVal[1].trim();\n          }\n\n          trustContext = {\n            command: \"\\\\htmlData\",\n            attributes\n          };\n          break;\n        }\n\n      default:\n        throw new Error(\"Unrecognized html command\");\n    }\n\n    if (!parser.settings.isTrusted(trustContext)) {\n      return parser.formatUnsupportedCmd(funcName);\n    }\n\n    return {\n      type: \"html\",\n      mode: parser.mode,\n      attributes,\n      body: ordargument(body)\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var elements = buildExpression$1(group.body, options, false);\n    var classes = [\"enclosing\"];\n\n    if (group.attributes.class) {\n      classes.push(...group.attributes.class.trim().split(/\\s+/));\n    }\n\n    var span = buildCommon.makeSpan(classes, elements, options);\n\n    for (var attr in group.attributes) {\n      if (attr !== \"class\" && group.attributes.hasOwnProperty(attr)) {\n        span.setAttribute(attr, group.attributes[attr]);\n      }\n    }\n\n    return span;\n  },\n  mathmlBuilder: (group, options) => {\n    return buildExpressionRow(group.body, options);\n  }\n});\n\ndefineFunction({\n  type: \"htmlmathml\",\n  names: [\"\\\\html@mathml\"],\n  props: {\n    numArgs: 2,\n    allowedInText: true\n  },\n  handler: (_ref, args) => {\n    var {\n      parser\n    } = _ref;\n    return {\n      type: \"htmlmathml\",\n      mode: parser.mode,\n      html: ordargument(args[0]),\n      mathml: ordargument(args[1])\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var elements = buildExpression$1(group.html, options, false);\n    return buildCommon.makeFragment(elements);\n  },\n  mathmlBuilder: (group, options) => {\n    return buildExpressionRow(group.mathml, options);\n  }\n});\n\nvar sizeData = function sizeData(str) {\n  if (/^[-+]? *(\\d+(\\.\\d*)?|\\.\\d+)$/.test(str)) {\n    // str is a number with no unit specified.\n    // default unit is bp, per graphix package.\n    return {\n      number: +str,\n      unit: \"bp\"\n    };\n  } else {\n    var match = /([-+]?) *(\\d+(?:\\.\\d*)?|\\.\\d+) *([a-z]{2})/.exec(str);\n\n    if (!match) {\n      throw new ParseError(\"Invalid size: '\" + str + \"' in \\\\includegraphics\");\n    }\n\n    var data = {\n      number: +(match[1] + match[2]),\n      // sign + magnitude, cast to number\n      unit: match[3]\n    };\n\n    if (!validUnit(data)) {\n      throw new ParseError(\"Invalid unit: '\" + data.unit + \"' in \\\\includegraphics.\");\n    }\n\n    return data;\n  }\n};\n\ndefineFunction({\n  type: \"includegraphics\",\n  names: [\"\\\\includegraphics\"],\n  props: {\n    numArgs: 1,\n    numOptionalArgs: 1,\n    argTypes: [\"raw\", \"url\"],\n    allowedInText: false\n  },\n  handler: (_ref, args, optArgs) => {\n    var {\n      parser\n    } = _ref;\n    var width = {\n      number: 0,\n      unit: \"em\"\n    };\n    var height = {\n      number: 0.9,\n      unit: \"em\"\n    }; // sorta character sized.\n\n    var totalheight = {\n      number: 0,\n      unit: \"em\"\n    };\n    var alt = \"\";\n\n    if (optArgs[0]) {\n      var attributeStr = assertNodeType(optArgs[0], \"raw\").string; // Parser.js does not parse key/value pairs. We get a string.\n\n      var attributes = attributeStr.split(\",\");\n\n      for (var i = 0; i < attributes.length; i++) {\n        var keyVal = attributes[i].split(\"=\");\n\n        if (keyVal.length === 2) {\n          var str = keyVal[1].trim();\n\n          switch (keyVal[0].trim()) {\n            case \"alt\":\n              alt = str;\n              break;\n\n            case \"width\":\n              width = sizeData(str);\n              break;\n\n            case \"height\":\n              height = sizeData(str);\n              break;\n\n            case \"totalheight\":\n              totalheight = sizeData(str);\n              break;\n\n            default:\n              throw new ParseError(\"Invalid key: '\" + keyVal[0] + \"' in \\\\includegraphics.\");\n          }\n        }\n      }\n    }\n\n    var src = assertNodeType(args[0], \"url\").url;\n\n    if (alt === \"\") {\n      // No alt given. Use the file name. Strip away the path.\n      alt = src;\n      alt = alt.replace(/^.*[\\\\/]/, '');\n      alt = alt.substring(0, alt.lastIndexOf('.'));\n    }\n\n    if (!parser.settings.isTrusted({\n      command: \"\\\\includegraphics\",\n      url: src\n    })) {\n      return parser.formatUnsupportedCmd(\"\\\\includegraphics\");\n    }\n\n    return {\n      type: \"includegraphics\",\n      mode: parser.mode,\n      alt: alt,\n      width: width,\n      height: height,\n      totalheight: totalheight,\n      src: src\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var height = calculateSize(group.height, options);\n    var depth = 0;\n\n    if (group.totalheight.number > 0) {\n      depth = calculateSize(group.totalheight, options) - height;\n    }\n\n    var width = 0;\n\n    if (group.width.number > 0) {\n      width = calculateSize(group.width, options);\n    }\n\n    var style = {\n      height: makeEm(height + depth)\n    };\n\n    if (width > 0) {\n      style.width = makeEm(width);\n    }\n\n    if (depth > 0) {\n      style.verticalAlign = makeEm(-depth);\n    }\n\n    var node = new Img(group.src, group.alt, style);\n    node.height = height;\n    node.depth = depth;\n    return node;\n  },\n  mathmlBuilder: (group, options) => {\n    var node = new mathMLTree.MathNode(\"mglyph\", []);\n    node.setAttribute(\"alt\", group.alt);\n    var height = calculateSize(group.height, options);\n    var depth = 0;\n\n    if (group.totalheight.number > 0) {\n      depth = calculateSize(group.totalheight, options) - height;\n      node.setAttribute(\"valign\", makeEm(-depth));\n    }\n\n    node.setAttribute(\"height\", makeEm(height + depth));\n\n    if (group.width.number > 0) {\n      var width = calculateSize(group.width, options);\n      node.setAttribute(\"width\", makeEm(width));\n    }\n\n    node.setAttribute(\"src\", group.src);\n    return node;\n  }\n});\n\n// Horizontal spacing commands\n\ndefineFunction({\n  type: \"kern\",\n  names: [\"\\\\kern\", \"\\\\mkern\", \"\\\\hskip\", \"\\\\mskip\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"size\"],\n    primitive: true,\n    allowedInText: true\n  },\n\n  handler(_ref, args) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var size = assertNodeType(args[0], \"size\");\n\n    if (parser.settings.strict) {\n      var mathFunction = funcName[1] === 'm'; // \\mkern, \\mskip\n\n      var muUnit = size.value.unit === 'mu';\n\n      if (mathFunction) {\n        if (!muUnit) {\n          parser.settings.reportNonstrict(\"mathVsTextUnits\", \"LaTeX's \" + funcName + \" supports only mu units, \" + (\"not \" + size.value.unit + \" units\"));\n        }\n\n        if (parser.mode !== \"math\") {\n          parser.settings.reportNonstrict(\"mathVsTextUnits\", \"LaTeX's \" + funcName + \" works only in math mode\");\n        }\n      } else {\n        // !mathFunction\n        if (muUnit) {\n          parser.settings.reportNonstrict(\"mathVsTextUnits\", \"LaTeX's \" + funcName + \" doesn't support mu units\");\n        }\n      }\n    }\n\n    return {\n      type: \"kern\",\n      mode: parser.mode,\n      dimension: size.value\n    };\n  },\n\n  htmlBuilder(group, options) {\n    return buildCommon.makeGlue(group.dimension, options);\n  },\n\n  mathmlBuilder(group, options) {\n    var dimension = calculateSize(group.dimension, options);\n    return new mathMLTree.SpaceNode(dimension);\n  }\n\n});\n\n// Horizontal overlap functions\ndefineFunction({\n  type: \"lap\",\n  names: [\"\\\\mathllap\", \"\\\\mathrlap\", \"\\\\mathclap\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true\n  },\n  handler: (_ref, args) => {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var body = args[0];\n    return {\n      type: \"lap\",\n      mode: parser.mode,\n      alignment: funcName.slice(5),\n      body\n    };\n  },\n  htmlBuilder: (group, options) => {\n    // mathllap, mathrlap, mathclap\n    var inner;\n\n    if (group.alignment === \"clap\") {\n      // ref: https://www.math.lsu.edu/~aperlis/publications/mathclap/\n      inner = buildCommon.makeSpan([], [buildGroup$1(group.body, options)]); // wrap, since CSS will center a .clap > .inner > span\n\n      inner = buildCommon.makeSpan([\"inner\"], [inner], options);\n    } else {\n      inner = buildCommon.makeSpan([\"inner\"], [buildGroup$1(group.body, options)]);\n    }\n\n    var fix = buildCommon.makeSpan([\"fix\"], []);\n    var node = buildCommon.makeSpan([group.alignment], [inner, fix], options); // At this point, we have correctly set horizontal alignment of the\n    // two items involved in the lap.\n    // Next, use a strut to set the height of the HTML bounding box.\n    // Otherwise, a tall argument may be misplaced.\n    // This code resolved issue #1153\n\n    var strut = buildCommon.makeSpan([\"strut\"]);\n    strut.style.height = makeEm(node.height + node.depth);\n\n    if (node.depth) {\n      strut.style.verticalAlign = makeEm(-node.depth);\n    }\n\n    node.children.unshift(strut); // Next, prevent vertical misplacement when next to something tall.\n    // This code resolves issue #1234\n\n    node = buildCommon.makeSpan([\"thinbox\"], [node], options);\n    return buildCommon.makeSpan([\"mord\", \"vbox\"], [node], options);\n  },\n  mathmlBuilder: (group, options) => {\n    // mathllap, mathrlap, mathclap\n    var node = new mathMLTree.MathNode(\"mpadded\", [buildGroup(group.body, options)]);\n\n    if (group.alignment !== \"rlap\") {\n      var offset = group.alignment === \"llap\" ? \"-1\" : \"-0.5\";\n      node.setAttribute(\"lspace\", offset + \"width\");\n    }\n\n    node.setAttribute(\"width\", \"0px\");\n    return node;\n  }\n});\n\ndefineFunction({\n  type: \"styling\",\n  names: [\"\\\\(\", \"$\"],\n  props: {\n    numArgs: 0,\n    allowedInText: true,\n    allowedInMath: false\n  },\n\n  handler(_ref, args) {\n    var {\n      funcName,\n      parser\n    } = _ref;\n    var outerMode = parser.mode;\n    parser.switchMode(\"math\");\n    var close = funcName === \"\\\\(\" ? \"\\\\)\" : \"$\";\n    var body = parser.parseExpression(false, close);\n    parser.expect(close);\n    parser.switchMode(outerMode);\n    return {\n      type: \"styling\",\n      mode: parser.mode,\n      style: \"text\",\n      body\n    };\n  }\n\n}); // Check for extra closing math delimiters\n\ndefineFunction({\n  type: \"text\",\n  // Doesn't matter what this is.\n  names: [\"\\\\)\", \"\\\\]\"],\n  props: {\n    numArgs: 0,\n    allowedInText: true,\n    allowedInMath: false\n  },\n\n  handler(context, args) {\n    throw new ParseError(\"Mismatched \" + context.funcName);\n  }\n\n});\n\nvar chooseMathStyle = (group, options) => {\n  switch (options.style.size) {\n    case Style$1.DISPLAY.size:\n      return group.display;\n\n    case Style$1.TEXT.size:\n      return group.text;\n\n    case Style$1.SCRIPT.size:\n      return group.script;\n\n    case Style$1.SCRIPTSCRIPT.size:\n      return group.scriptscript;\n\n    default:\n      return group.text;\n  }\n};\n\ndefineFunction({\n  type: \"mathchoice\",\n  names: [\"\\\\mathchoice\"],\n  props: {\n    numArgs: 4,\n    primitive: true\n  },\n  handler: (_ref, args) => {\n    var {\n      parser\n    } = _ref;\n    return {\n      type: \"mathchoice\",\n      mode: parser.mode,\n      display: ordargument(args[0]),\n      text: ordargument(args[1]),\n      script: ordargument(args[2]),\n      scriptscript: ordargument(args[3])\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var body = chooseMathStyle(group, options);\n    var elements = buildExpression$1(body, options, false);\n    return buildCommon.makeFragment(elements);\n  },\n  mathmlBuilder: (group, options) => {\n    var body = chooseMathStyle(group, options);\n    return buildExpressionRow(body, options);\n  }\n});\n\nvar assembleSupSub = (base, supGroup, subGroup, options, style, slant, baseShift) => {\n  base = buildCommon.makeSpan([], [base]);\n  var subIsSingleCharacter = subGroup && utils.isCharacterBox(subGroup);\n  var sub;\n  var sup; // We manually have to handle the superscripts and subscripts. This,\n  // aside from the kern calculations, is copied from supsub.\n\n  if (supGroup) {\n    var elem = buildGroup$1(supGroup, options.havingStyle(style.sup()), options);\n    sup = {\n      elem,\n      kern: Math.max(options.fontMetrics().bigOpSpacing1, options.fontMetrics().bigOpSpacing3 - elem.depth)\n    };\n  }\n\n  if (subGroup) {\n    var _elem = buildGroup$1(subGroup, options.havingStyle(style.sub()), options);\n\n    sub = {\n      elem: _elem,\n      kern: Math.max(options.fontMetrics().bigOpSpacing2, options.fontMetrics().bigOpSpacing4 - _elem.height)\n    };\n  } // Build the final group as a vlist of the possible subscript, base,\n  // and possible superscript.\n\n\n  var finalGroup;\n\n  if (sup && sub) {\n    var bottom = options.fontMetrics().bigOpSpacing5 + sub.elem.height + sub.elem.depth + sub.kern + base.depth + baseShift;\n    finalGroup = buildCommon.makeVList({\n      positionType: \"bottom\",\n      positionData: bottom,\n      children: [{\n        type: \"kern\",\n        size: options.fontMetrics().bigOpSpacing5\n      }, {\n        type: \"elem\",\n        elem: sub.elem,\n        marginLeft: makeEm(-slant)\n      }, {\n        type: \"kern\",\n        size: sub.kern\n      }, {\n        type: \"elem\",\n        elem: base\n      }, {\n        type: \"kern\",\n        size: sup.kern\n      }, {\n        type: \"elem\",\n        elem: sup.elem,\n        marginLeft: makeEm(slant)\n      }, {\n        type: \"kern\",\n        size: options.fontMetrics().bigOpSpacing5\n      }]\n    }, options);\n  } else if (sub) {\n    var top = base.height - baseShift; // Shift the limits by the slant of the symbol. Note\n    // that we are supposed to shift the limits by 1/2 of the slant,\n    // but since we are centering the limits adding a full slant of\n    // margin will shift by 1/2 that.\n\n    finalGroup = buildCommon.makeVList({\n      positionType: \"top\",\n      positionData: top,\n      children: [{\n        type: \"kern\",\n        size: options.fontMetrics().bigOpSpacing5\n      }, {\n        type: \"elem\",\n        elem: sub.elem,\n        marginLeft: makeEm(-slant)\n      }, {\n        type: \"kern\",\n        size: sub.kern\n      }, {\n        type: \"elem\",\n        elem: base\n      }]\n    }, options);\n  } else if (sup) {\n    var _bottom = base.depth + baseShift;\n\n    finalGroup = buildCommon.makeVList({\n      positionType: \"bottom\",\n      positionData: _bottom,\n      children: [{\n        type: \"elem\",\n        elem: base\n      }, {\n        type: \"kern\",\n        size: sup.kern\n      }, {\n        type: \"elem\",\n        elem: sup.elem,\n        marginLeft: makeEm(slant)\n      }, {\n        type: \"kern\",\n        size: options.fontMetrics().bigOpSpacing5\n      }]\n    }, options);\n  } else {\n    // This case probably shouldn't occur (this would mean the\n    // supsub was sending us a group with no superscript or\n    // subscript) but be safe.\n    return base;\n  }\n\n  var parts = [finalGroup];\n\n  if (sub && slant !== 0 && !subIsSingleCharacter) {\n    // A negative margin-left was applied to the lower limit.\n    // Avoid an overlap by placing a spacer on the left on the group.\n    var spacer = buildCommon.makeSpan([\"mspace\"], [], options);\n    spacer.style.marginRight = makeEm(slant);\n    parts.unshift(spacer);\n  }\n\n  return buildCommon.makeSpan([\"mop\", \"op-limits\"], parts, options);\n};\n\n// Limits, symbols\n// Most operators have a large successor symbol, but these don't.\nvar noSuccessor = [\"\\\\smallint\"]; // NOTE: Unlike most `htmlBuilder`s, this one handles not only \"op\", but also\n// \"supsub\" since some of them (like \\int) can affect super/subscripting.\n\nvar htmlBuilder$2 = (grp, options) => {\n  // Operators are handled in the TeXbook pg. 443-444, rule 13(a).\n  var supGroup;\n  var subGroup;\n  var hasLimits = false;\n  var group;\n\n  if (grp.type === \"supsub\") {\n    // If we have limits, supsub will pass us its group to handle. Pull\n    // out the superscript and subscript and set the group to the op in\n    // its base.\n    supGroup = grp.sup;\n    subGroup = grp.sub;\n    group = assertNodeType(grp.base, \"op\");\n    hasLimits = true;\n  } else {\n    group = assertNodeType(grp, \"op\");\n  }\n\n  var style = options.style;\n  var large = false;\n\n  if (style.size === Style$1.DISPLAY.size && group.symbol && !utils.contains(noSuccessor, group.name)) {\n    // Most symbol operators get larger in displaystyle (rule 13)\n    large = true;\n  }\n\n  var base;\n\n  if (group.symbol) {\n    // If this is a symbol, create the symbol.\n    var fontName = large ? \"Size2-Regular\" : \"Size1-Regular\";\n    var stash = \"\";\n\n    if (group.name === \"\\\\oiint\" || group.name === \"\\\\oiiint\") {\n      // No font glyphs yet, so use a glyph w/o the oval.\n      // TODO: When font glyphs are available, delete this code.\n      stash = group.name.slice(1);\n      group.name = stash === \"oiint\" ? \"\\\\iint\" : \"\\\\iiint\";\n    }\n\n    base = buildCommon.makeSymbol(group.name, fontName, \"math\", options, [\"mop\", \"op-symbol\", large ? \"large-op\" : \"small-op\"]);\n\n    if (stash.length > 0) {\n      // We're in \\oiint or \\oiiint. Overlay the oval.\n      // TODO: When font glyphs are available, delete this code.\n      var italic = base.italic;\n      var oval = buildCommon.staticSvg(stash + \"Size\" + (large ? \"2\" : \"1\"), options);\n      base = buildCommon.makeVList({\n        positionType: \"individualShift\",\n        children: [{\n          type: \"elem\",\n          elem: base,\n          shift: 0\n        }, {\n          type: \"elem\",\n          elem: oval,\n          shift: large ? 0.08 : 0\n        }]\n      }, options);\n      group.name = \"\\\\\" + stash;\n      base.classes.unshift(\"mop\"); // $FlowFixMe\n\n      base.italic = italic;\n    }\n  } else if (group.body) {\n    // If this is a list, compose that list.\n    var inner = buildExpression$1(group.body, options, true);\n\n    if (inner.length === 1 && inner[0] instanceof SymbolNode) {\n      base = inner[0];\n      base.classes[0] = \"mop\"; // replace old mclass\n    } else {\n      base = buildCommon.makeSpan([\"mop\"], inner, options);\n    }\n  } else {\n    // Otherwise, this is a text operator. Build the text from the\n    // operator's name.\n    var output = [];\n\n    for (var i = 1; i < group.name.length; i++) {\n      output.push(buildCommon.mathsym(group.name[i], group.mode, options));\n    }\n\n    base = buildCommon.makeSpan([\"mop\"], output, options);\n  } // If content of op is a single symbol, shift it vertically.\n\n\n  var baseShift = 0;\n  var slant = 0;\n\n  if ((base instanceof SymbolNode || group.name === \"\\\\oiint\" || group.name === \"\\\\oiiint\") && !group.suppressBaseShift) {\n    // We suppress the shift of the base of \\overset and \\underset. Otherwise,\n    // shift the symbol so its center lies on the axis (rule 13). It\n    // appears that our fonts have the centers of the symbols already\n    // almost on the axis, so these numbers are very small. Note we\n    // don't actually apply this here, but instead it is used either in\n    // the vlist creation or separately when there are no limits.\n    baseShift = (base.height - base.depth) / 2 - options.fontMetrics().axisHeight; // The slant of the symbol is just its italic correction.\n    // $FlowFixMe\n\n    slant = base.italic;\n  }\n\n  if (hasLimits) {\n    return assembleSupSub(base, supGroup, subGroup, options, style, slant, baseShift);\n  } else {\n    if (baseShift) {\n      base.style.position = \"relative\";\n      base.style.top = makeEm(baseShift);\n    }\n\n    return base;\n  }\n};\n\nvar mathmlBuilder$1 = (group, options) => {\n  var node;\n\n  if (group.symbol) {\n    // This is a symbol. Just add the symbol.\n    node = new MathNode(\"mo\", [makeText(group.name, group.mode)]);\n\n    if (utils.contains(noSuccessor, group.name)) {\n      node.setAttribute(\"largeop\", \"false\");\n    }\n  } else if (group.body) {\n    // This is an operator with children. Add them.\n    node = new MathNode(\"mo\", buildExpression(group.body, options));\n  } else {\n    // This is a text operator. Add all of the characters from the\n    // operator's name.\n    node = new MathNode(\"mi\", [new TextNode(group.name.slice(1))]); // Append an <mo>&ApplyFunction;</mo>.\n    // ref: https://www.w3.org/TR/REC-MathML/chap3_2.html#sec3.2.4\n\n    var operator = new MathNode(\"mo\", [makeText(\"\\u2061\", \"text\")]);\n\n    if (group.parentIsSupSub) {\n      node = new MathNode(\"mrow\", [node, operator]);\n    } else {\n      node = newDocumentFragment([node, operator]);\n    }\n  }\n\n  return node;\n};\n\nvar singleCharBigOps = {\n  \"\\u220F\": \"\\\\prod\",\n  \"\\u2210\": \"\\\\coprod\",\n  \"\\u2211\": \"\\\\sum\",\n  \"\\u22c0\": \"\\\\bigwedge\",\n  \"\\u22c1\": \"\\\\bigvee\",\n  \"\\u22c2\": \"\\\\bigcap\",\n  \"\\u22c3\": \"\\\\bigcup\",\n  \"\\u2a00\": \"\\\\bigodot\",\n  \"\\u2a01\": \"\\\\bigoplus\",\n  \"\\u2a02\": \"\\\\bigotimes\",\n  \"\\u2a04\": \"\\\\biguplus\",\n  \"\\u2a06\": \"\\\\bigsqcup\"\n};\ndefineFunction({\n  type: \"op\",\n  names: [\"\\\\coprod\", \"\\\\bigvee\", \"\\\\bigwedge\", \"\\\\biguplus\", \"\\\\bigcap\", \"\\\\bigcup\", \"\\\\intop\", \"\\\\prod\", \"\\\\sum\", \"\\\\bigotimes\", \"\\\\bigoplus\", \"\\\\bigodot\", \"\\\\bigsqcup\", \"\\\\smallint\", \"\\u220F\", \"\\u2210\", \"\\u2211\", \"\\u22c0\", \"\\u22c1\", \"\\u22c2\", \"\\u22c3\", \"\\u2a00\", \"\\u2a01\", \"\\u2a02\", \"\\u2a04\", \"\\u2a06\"],\n  props: {\n    numArgs: 0\n  },\n  handler: (_ref, args) => {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var fName = funcName;\n\n    if (fName.length === 1) {\n      fName = singleCharBigOps[fName];\n    }\n\n    return {\n      type: \"op\",\n      mode: parser.mode,\n      limits: true,\n      parentIsSupSub: false,\n      symbol: true,\n      name: fName\n    };\n  },\n  htmlBuilder: htmlBuilder$2,\n  mathmlBuilder: mathmlBuilder$1\n}); // Note: calling defineFunction with a type that's already been defined only\n// works because the same htmlBuilder and mathmlBuilder are being used.\n\ndefineFunction({\n  type: \"op\",\n  names: [\"\\\\mathop\"],\n  props: {\n    numArgs: 1,\n    primitive: true\n  },\n  handler: (_ref2, args) => {\n    var {\n      parser\n    } = _ref2;\n    var body = args[0];\n    return {\n      type: \"op\",\n      mode: parser.mode,\n      limits: false,\n      parentIsSupSub: false,\n      symbol: false,\n      body: ordargument(body)\n    };\n  },\n  htmlBuilder: htmlBuilder$2,\n  mathmlBuilder: mathmlBuilder$1\n}); // There are 2 flags for operators; whether they produce limits in\n// displaystyle, and whether they are symbols and should grow in\n// displaystyle. These four groups cover the four possible choices.\n\nvar singleCharIntegrals = {\n  \"\\u222b\": \"\\\\int\",\n  \"\\u222c\": \"\\\\iint\",\n  \"\\u222d\": \"\\\\iiint\",\n  \"\\u222e\": \"\\\\oint\",\n  \"\\u222f\": \"\\\\oiint\",\n  \"\\u2230\": \"\\\\oiiint\"\n}; // No limits, not symbols\n\ndefineFunction({\n  type: \"op\",\n  names: [\"\\\\arcsin\", \"\\\\arccos\", \"\\\\arctan\", \"\\\\arctg\", \"\\\\arcctg\", \"\\\\arg\", \"\\\\ch\", \"\\\\cos\", \"\\\\cosec\", \"\\\\cosh\", \"\\\\cot\", \"\\\\cotg\", \"\\\\coth\", \"\\\\csc\", \"\\\\ctg\", \"\\\\cth\", \"\\\\deg\", \"\\\\dim\", \"\\\\exp\", \"\\\\hom\", \"\\\\ker\", \"\\\\lg\", \"\\\\ln\", \"\\\\log\", \"\\\\sec\", \"\\\\sin\", \"\\\\sinh\", \"\\\\sh\", \"\\\\tan\", \"\\\\tanh\", \"\\\\tg\", \"\\\\th\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(_ref3) {\n    var {\n      parser,\n      funcName\n    } = _ref3;\n    return {\n      type: \"op\",\n      mode: parser.mode,\n      limits: false,\n      parentIsSupSub: false,\n      symbol: false,\n      name: funcName\n    };\n  },\n\n  htmlBuilder: htmlBuilder$2,\n  mathmlBuilder: mathmlBuilder$1\n}); // Limits, not symbols\n\ndefineFunction({\n  type: \"op\",\n  names: [\"\\\\det\", \"\\\\gcd\", \"\\\\inf\", \"\\\\lim\", \"\\\\max\", \"\\\\min\", \"\\\\Pr\", \"\\\\sup\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(_ref4) {\n    var {\n      parser,\n      funcName\n    } = _ref4;\n    return {\n      type: \"op\",\n      mode: parser.mode,\n      limits: true,\n      parentIsSupSub: false,\n      symbol: false,\n      name: funcName\n    };\n  },\n\n  htmlBuilder: htmlBuilder$2,\n  mathmlBuilder: mathmlBuilder$1\n}); // No limits, symbols\n\ndefineFunction({\n  type: \"op\",\n  names: [\"\\\\int\", \"\\\\iint\", \"\\\\iiint\", \"\\\\oint\", \"\\\\oiint\", \"\\\\oiiint\", \"\\u222b\", \"\\u222c\", \"\\u222d\", \"\\u222e\", \"\\u222f\", \"\\u2230\"],\n  props: {\n    numArgs: 0\n  },\n\n  handler(_ref5) {\n    var {\n      parser,\n      funcName\n    } = _ref5;\n    var fName = funcName;\n\n    if (fName.length === 1) {\n      fName = singleCharIntegrals[fName];\n    }\n\n    return {\n      type: \"op\",\n      mode: parser.mode,\n      limits: false,\n      parentIsSupSub: false,\n      symbol: true,\n      name: fName\n    };\n  },\n\n  htmlBuilder: htmlBuilder$2,\n  mathmlBuilder: mathmlBuilder$1\n});\n\n// NOTE: Unlike most `htmlBuilder`s, this one handles not only\n// \"operatorname\", but also  \"supsub\" since \\operatorname* can\n// affect super/subscripting.\nvar htmlBuilder$1 = (grp, options) => {\n  // Operators are handled in the TeXbook pg. 443-444, rule 13(a).\n  var supGroup;\n  var subGroup;\n  var hasLimits = false;\n  var group;\n\n  if (grp.type === \"supsub\") {\n    // If we have limits, supsub will pass us its group to handle. Pull\n    // out the superscript and subscript and set the group to the op in\n    // its base.\n    supGroup = grp.sup;\n    subGroup = grp.sub;\n    group = assertNodeType(grp.base, \"operatorname\");\n    hasLimits = true;\n  } else {\n    group = assertNodeType(grp, \"operatorname\");\n  }\n\n  var base;\n\n  if (group.body.length > 0) {\n    var body = group.body.map(child => {\n      // $FlowFixMe: Check if the node has a string `text` property.\n      var childText = child.text;\n\n      if (typeof childText === \"string\") {\n        return {\n          type: \"textord\",\n          mode: child.mode,\n          text: childText\n        };\n      } else {\n        return child;\n      }\n    }); // Consolidate function names into symbol characters.\n\n    var expression = buildExpression$1(body, options.withFont(\"mathrm\"), true);\n\n    for (var i = 0; i < expression.length; i++) {\n      var child = expression[i];\n\n      if (child instanceof SymbolNode) {\n        // Per amsopn package,\n        // change minus to hyphen and \\ast to asterisk\n        child.text = child.text.replace(/\\u2212/, \"-\").replace(/\\u2217/, \"*\");\n      }\n    }\n\n    base = buildCommon.makeSpan([\"mop\"], expression, options);\n  } else {\n    base = buildCommon.makeSpan([\"mop\"], [], options);\n  }\n\n  if (hasLimits) {\n    return assembleSupSub(base, supGroup, subGroup, options, options.style, 0, 0);\n  } else {\n    return base;\n  }\n};\n\nvar mathmlBuilder = (group, options) => {\n  // The steps taken here are similar to the html version.\n  var expression = buildExpression(group.body, options.withFont(\"mathrm\")); // Is expression a string or has it something like a fraction?\n\n  var isAllString = true; // default\n\n  for (var i = 0; i < expression.length; i++) {\n    var node = expression[i];\n\n    if (node instanceof mathMLTree.SpaceNode) ; else if (node instanceof mathMLTree.MathNode) {\n      switch (node.type) {\n        case \"mi\":\n        case \"mn\":\n        case \"ms\":\n        case \"mspace\":\n        case \"mtext\":\n          break;\n        // Do nothing yet.\n\n        case \"mo\":\n          {\n            var child = node.children[0];\n\n            if (node.children.length === 1 && child instanceof mathMLTree.TextNode) {\n              child.text = child.text.replace(/\\u2212/, \"-\").replace(/\\u2217/, \"*\");\n            } else {\n              isAllString = false;\n            }\n\n            break;\n          }\n\n        default:\n          isAllString = false;\n      }\n    } else {\n      isAllString = false;\n    }\n  }\n\n  if (isAllString) {\n    // Write a single TextNode instead of multiple nested tags.\n    var word = expression.map(node => node.toText()).join(\"\");\n    expression = [new mathMLTree.TextNode(word)];\n  }\n\n  var identifier = new mathMLTree.MathNode(\"mi\", expression);\n  identifier.setAttribute(\"mathvariant\", \"normal\"); // \\u2061 is the same as &ApplyFunction;\n  // ref: https://www.w3schools.com/charsets/ref_html_entities_a.asp\n\n  var operator = new mathMLTree.MathNode(\"mo\", [makeText(\"\\u2061\", \"text\")]);\n\n  if (group.parentIsSupSub) {\n    return new mathMLTree.MathNode(\"mrow\", [identifier, operator]);\n  } else {\n    return mathMLTree.newDocumentFragment([identifier, operator]);\n  }\n}; // \\operatorname\n// amsopn.dtx: \\mathop{#1\\kern\\z@\\operator@font#3}\\newmcodes@\n\n\ndefineFunction({\n  type: \"operatorname\",\n  names: [\"\\\\operatorname@\", \"\\\\operatornamewithlimits\"],\n  props: {\n    numArgs: 1\n  },\n  handler: (_ref, args) => {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var body = args[0];\n    return {\n      type: \"operatorname\",\n      mode: parser.mode,\n      body: ordargument(body),\n      alwaysHandleSupSub: funcName === \"\\\\operatornamewithlimits\",\n      limits: false,\n      parentIsSupSub: false\n    };\n  },\n  htmlBuilder: htmlBuilder$1,\n  mathmlBuilder\n});\ndefineMacro(\"\\\\operatorname\", \"\\\\@ifstar\\\\operatornamewithlimits\\\\operatorname@\");\n\ndefineFunctionBuilders({\n  type: \"ordgroup\",\n\n  htmlBuilder(group, options) {\n    if (group.semisimple) {\n      return buildCommon.makeFragment(buildExpression$1(group.body, options, false));\n    }\n\n    return buildCommon.makeSpan([\"mord\"], buildExpression$1(group.body, options, true), options);\n  },\n\n  mathmlBuilder(group, options) {\n    return buildExpressionRow(group.body, options, true);\n  }\n\n});\n\ndefineFunction({\n  type: \"overline\",\n  names: [\"\\\\overline\"],\n  props: {\n    numArgs: 1\n  },\n\n  handler(_ref, args) {\n    var {\n      parser\n    } = _ref;\n    var body = args[0];\n    return {\n      type: \"overline\",\n      mode: parser.mode,\n      body\n    };\n  },\n\n  htmlBuilder(group, options) {\n    // Overlines are handled in the TeXbook pg 443, Rule 9.\n    // Build the inner group in the cramped style.\n    var innerGroup = buildGroup$1(group.body, options.havingCrampedStyle()); // Create the line above the body\n\n    var line = buildCommon.makeLineSpan(\"overline-line\", options); // Generate the vlist, with the appropriate kerns\n\n    var defaultRuleThickness = options.fontMetrics().defaultRuleThickness;\n    var vlist = buildCommon.makeVList({\n      positionType: \"firstBaseline\",\n      children: [{\n        type: \"elem\",\n        elem: innerGroup\n      }, {\n        type: \"kern\",\n        size: 3 * defaultRuleThickness\n      }, {\n        type: \"elem\",\n        elem: line\n      }, {\n        type: \"kern\",\n        size: defaultRuleThickness\n      }]\n    }, options);\n    return buildCommon.makeSpan([\"mord\", \"overline\"], [vlist], options);\n  },\n\n  mathmlBuilder(group, options) {\n    var operator = new mathMLTree.MathNode(\"mo\", [new mathMLTree.TextNode(\"\\u203e\")]);\n    operator.setAttribute(\"stretchy\", \"true\");\n    var node = new mathMLTree.MathNode(\"mover\", [buildGroup(group.body, options), operator]);\n    node.setAttribute(\"accent\", \"true\");\n    return node;\n  }\n\n});\n\ndefineFunction({\n  type: \"phantom\",\n  names: [\"\\\\phantom\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true\n  },\n  handler: (_ref, args) => {\n    var {\n      parser\n    } = _ref;\n    var body = args[0];\n    return {\n      type: \"phantom\",\n      mode: parser.mode,\n      body: ordargument(body)\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var elements = buildExpression$1(group.body, options.withPhantom(), false); // \\phantom isn't supposed to affect the elements it contains.\n    // See \"color\" for more details.\n\n    return buildCommon.makeFragment(elements);\n  },\n  mathmlBuilder: (group, options) => {\n    var inner = buildExpression(group.body, options);\n    return new mathMLTree.MathNode(\"mphantom\", inner);\n  }\n});\ndefineFunction({\n  type: \"hphantom\",\n  names: [\"\\\\hphantom\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true\n  },\n  handler: (_ref2, args) => {\n    var {\n      parser\n    } = _ref2;\n    var body = args[0];\n    return {\n      type: \"hphantom\",\n      mode: parser.mode,\n      body\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var node = buildCommon.makeSpan([], [buildGroup$1(group.body, options.withPhantom())]);\n    node.height = 0;\n    node.depth = 0;\n\n    if (node.children) {\n      for (var i = 0; i < node.children.length; i++) {\n        node.children[i].height = 0;\n        node.children[i].depth = 0;\n      }\n    } // See smash for comment re: use of makeVList\n\n\n    node = buildCommon.makeVList({\n      positionType: \"firstBaseline\",\n      children: [{\n        type: \"elem\",\n        elem: node\n      }]\n    }, options); // For spacing, TeX treats \\smash as a math group (same spacing as ord).\n\n    return buildCommon.makeSpan([\"mord\"], [node], options);\n  },\n  mathmlBuilder: (group, options) => {\n    var inner = buildExpression(ordargument(group.body), options);\n    var phantom = new mathMLTree.MathNode(\"mphantom\", inner);\n    var node = new mathMLTree.MathNode(\"mpadded\", [phantom]);\n    node.setAttribute(\"height\", \"0px\");\n    node.setAttribute(\"depth\", \"0px\");\n    return node;\n  }\n});\ndefineFunction({\n  type: \"vphantom\",\n  names: [\"\\\\vphantom\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true\n  },\n  handler: (_ref3, args) => {\n    var {\n      parser\n    } = _ref3;\n    var body = args[0];\n    return {\n      type: \"vphantom\",\n      mode: parser.mode,\n      body\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var inner = buildCommon.makeSpan([\"inner\"], [buildGroup$1(group.body, options.withPhantom())]);\n    var fix = buildCommon.makeSpan([\"fix\"], []);\n    return buildCommon.makeSpan([\"mord\", \"rlap\"], [inner, fix], options);\n  },\n  mathmlBuilder: (group, options) => {\n    var inner = buildExpression(ordargument(group.body), options);\n    var phantom = new mathMLTree.MathNode(\"mphantom\", inner);\n    var node = new mathMLTree.MathNode(\"mpadded\", [phantom]);\n    node.setAttribute(\"width\", \"0px\");\n    return node;\n  }\n});\n\ndefineFunction({\n  type: \"raisebox\",\n  names: [\"\\\\raisebox\"],\n  props: {\n    numArgs: 2,\n    argTypes: [\"size\", \"hbox\"],\n    allowedInText: true\n  },\n\n  handler(_ref, args) {\n    var {\n      parser\n    } = _ref;\n    var amount = assertNodeType(args[0], \"size\").value;\n    var body = args[1];\n    return {\n      type: \"raisebox\",\n      mode: parser.mode,\n      dy: amount,\n      body\n    };\n  },\n\n  htmlBuilder(group, options) {\n    var body = buildGroup$1(group.body, options);\n    var dy = calculateSize(group.dy, options);\n    return buildCommon.makeVList({\n      positionType: \"shift\",\n      positionData: -dy,\n      children: [{\n        type: \"elem\",\n        elem: body\n      }]\n    }, options);\n  },\n\n  mathmlBuilder(group, options) {\n    var node = new mathMLTree.MathNode(\"mpadded\", [buildGroup(group.body, options)]);\n    var dy = group.dy.number + group.dy.unit;\n    node.setAttribute(\"voffset\", dy);\n    return node;\n  }\n\n});\n\ndefineFunction({\n  type: \"internal\",\n  names: [\"\\\\relax\"],\n  props: {\n    numArgs: 0,\n    allowedInText: true,\n    allowedInArgument: true\n  },\n\n  handler(_ref) {\n    var {\n      parser\n    } = _ref;\n    return {\n      type: \"internal\",\n      mode: parser.mode\n    };\n  }\n\n});\n\ndefineFunction({\n  type: \"rule\",\n  names: [\"\\\\rule\"],\n  props: {\n    numArgs: 2,\n    numOptionalArgs: 1,\n    allowedInText: true,\n    allowedInMath: true,\n    argTypes: [\"size\", \"size\", \"size\"]\n  },\n\n  handler(_ref, args, optArgs) {\n    var {\n      parser\n    } = _ref;\n    var shift = optArgs[0];\n    var width = assertNodeType(args[0], \"size\");\n    var height = assertNodeType(args[1], \"size\");\n    return {\n      type: \"rule\",\n      mode: parser.mode,\n      shift: shift && assertNodeType(shift, \"size\").value,\n      width: width.value,\n      height: height.value\n    };\n  },\n\n  htmlBuilder(group, options) {\n    // Make an empty span for the rule\n    var rule = buildCommon.makeSpan([\"mord\", \"rule\"], [], options); // Calculate the shift, width, and height of the rule, and account for units\n\n    var width = calculateSize(group.width, options);\n    var height = calculateSize(group.height, options);\n    var shift = group.shift ? calculateSize(group.shift, options) : 0; // Style the rule to the right size\n\n    rule.style.borderRightWidth = makeEm(width);\n    rule.style.borderTopWidth = makeEm(height);\n    rule.style.bottom = makeEm(shift); // Record the height and width\n\n    rule.width = width;\n    rule.height = height + shift;\n    rule.depth = -shift; // Font size is the number large enough that the browser will\n    // reserve at least `absHeight` space above the baseline.\n    // The 1.125 factor was empirically determined\n\n    rule.maxFontSize = height * 1.125 * options.sizeMultiplier;\n    return rule;\n  },\n\n  mathmlBuilder(group, options) {\n    var width = calculateSize(group.width, options);\n    var height = calculateSize(group.height, options);\n    var shift = group.shift ? calculateSize(group.shift, options) : 0;\n    var color = options.color && options.getColor() || \"black\";\n    var rule = new mathMLTree.MathNode(\"mspace\");\n    rule.setAttribute(\"mathbackground\", color);\n    rule.setAttribute(\"width\", makeEm(width));\n    rule.setAttribute(\"height\", makeEm(height));\n    var wrapper = new mathMLTree.MathNode(\"mpadded\", [rule]);\n\n    if (shift >= 0) {\n      wrapper.setAttribute(\"height\", makeEm(shift));\n    } else {\n      wrapper.setAttribute(\"height\", makeEm(shift));\n      wrapper.setAttribute(\"depth\", makeEm(-shift));\n    }\n\n    wrapper.setAttribute(\"voffset\", makeEm(shift));\n    return wrapper;\n  }\n\n});\n\nfunction sizingGroup(value, options, baseOptions) {\n  var inner = buildExpression$1(value, options, false);\n  var multiplier = options.sizeMultiplier / baseOptions.sizeMultiplier; // Add size-resetting classes to the inner list and set maxFontSize\n  // manually. Handle nested size changes.\n\n  for (var i = 0; i < inner.length; i++) {\n    var pos = inner[i].classes.indexOf(\"sizing\");\n\n    if (pos < 0) {\n      Array.prototype.push.apply(inner[i].classes, options.sizingClasses(baseOptions));\n    } else if (inner[i].classes[pos + 1] === \"reset-size\" + options.size) {\n      // This is a nested size change: e.g., inner[i] is the \"b\" in\n      // `\\Huge a \\small b`. Override the old size (the `reset-` class)\n      // but not the new size.\n      inner[i].classes[pos + 1] = \"reset-size\" + baseOptions.size;\n    }\n\n    inner[i].height *= multiplier;\n    inner[i].depth *= multiplier;\n  }\n\n  return buildCommon.makeFragment(inner);\n}\nvar sizeFuncs = [\"\\\\tiny\", \"\\\\sixptsize\", \"\\\\scriptsize\", \"\\\\footnotesize\", \"\\\\small\", \"\\\\normalsize\", \"\\\\large\", \"\\\\Large\", \"\\\\LARGE\", \"\\\\huge\", \"\\\\Huge\"];\nvar htmlBuilder = (group, options) => {\n  // Handle sizing operators like \\Huge. Real TeX doesn't actually allow\n  // these functions inside of math expressions, so we do some special\n  // handling.\n  var newOptions = options.havingSize(group.size);\n  return sizingGroup(group.body, newOptions, options);\n};\ndefineFunction({\n  type: \"sizing\",\n  names: sizeFuncs,\n  props: {\n    numArgs: 0,\n    allowedInText: true\n  },\n  handler: (_ref, args) => {\n    var {\n      breakOnTokenText,\n      funcName,\n      parser\n    } = _ref;\n    var body = parser.parseExpression(false, breakOnTokenText);\n    return {\n      type: \"sizing\",\n      mode: parser.mode,\n      // Figure out what size to use based on the list of functions above\n      size: sizeFuncs.indexOf(funcName) + 1,\n      body\n    };\n  },\n  htmlBuilder,\n  mathmlBuilder: (group, options) => {\n    var newOptions = options.havingSize(group.size);\n    var inner = buildExpression(group.body, newOptions);\n    var node = new mathMLTree.MathNode(\"mstyle\", inner); // TODO(emily): This doesn't produce the correct size for nested size\n    // changes, because we don't keep state of what style we're currently\n    // in, so we can't reset the size to normal before changing it.  Now\n    // that we're passing an options parameter we should be able to fix\n    // this.\n\n    node.setAttribute(\"mathsize\", makeEm(newOptions.sizeMultiplier));\n    return node;\n  }\n});\n\n// smash, with optional [tb], as in AMS\ndefineFunction({\n  type: \"smash\",\n  names: [\"\\\\smash\"],\n  props: {\n    numArgs: 1,\n    numOptionalArgs: 1,\n    allowedInText: true\n  },\n  handler: (_ref, args, optArgs) => {\n    var {\n      parser\n    } = _ref;\n    var smashHeight = false;\n    var smashDepth = false;\n    var tbArg = optArgs[0] && assertNodeType(optArgs[0], \"ordgroup\");\n\n    if (tbArg) {\n      // Optional [tb] argument is engaged.\n      // ref: amsmath: \\renewcommand{\\smash}[1][tb]{%\n      //               def\\mb@t{\\ht}\\def\\mb@b{\\dp}\\def\\mb@tb{\\ht\\z@\\z@\\dp}%\n      var letter = \"\";\n\n      for (var i = 0; i < tbArg.body.length; ++i) {\n        var node = tbArg.body[i]; // $FlowFixMe: Not every node type has a `text` property.\n\n        letter = node.text;\n\n        if (letter === \"t\") {\n          smashHeight = true;\n        } else if (letter === \"b\") {\n          smashDepth = true;\n        } else {\n          smashHeight = false;\n          smashDepth = false;\n          break;\n        }\n      }\n    } else {\n      smashHeight = true;\n      smashDepth = true;\n    }\n\n    var body = args[0];\n    return {\n      type: \"smash\",\n      mode: parser.mode,\n      body,\n      smashHeight,\n      smashDepth\n    };\n  },\n  htmlBuilder: (group, options) => {\n    var node = buildCommon.makeSpan([], [buildGroup$1(group.body, options)]);\n\n    if (!group.smashHeight && !group.smashDepth) {\n      return node;\n    }\n\n    if (group.smashHeight) {\n      node.height = 0; // In order to influence makeVList, we have to reset the children.\n\n      if (node.children) {\n        for (var i = 0; i < node.children.length; i++) {\n          node.children[i].height = 0;\n        }\n      }\n    }\n\n    if (group.smashDepth) {\n      node.depth = 0;\n\n      if (node.children) {\n        for (var _i = 0; _i < node.children.length; _i++) {\n          node.children[_i].depth = 0;\n        }\n      }\n    } // At this point, we've reset the TeX-like height and depth values.\n    // But the span still has an HTML line height.\n    // makeVList applies \"display: table-cell\", which prevents the browser\n    // from acting on that line height. So we'll call makeVList now.\n\n\n    var smashedNode = buildCommon.makeVList({\n      positionType: \"firstBaseline\",\n      children: [{\n        type: \"elem\",\n        elem: node\n      }]\n    }, options); // For spacing, TeX treats \\hphantom as a math group (same spacing as ord).\n\n    return buildCommon.makeSpan([\"mord\"], [smashedNode], options);\n  },\n  mathmlBuilder: (group, options) => {\n    var node = new mathMLTree.MathNode(\"mpadded\", [buildGroup(group.body, options)]);\n\n    if (group.smashHeight) {\n      node.setAttribute(\"height\", \"0px\");\n    }\n\n    if (group.smashDepth) {\n      node.setAttribute(\"depth\", \"0px\");\n    }\n\n    return node;\n  }\n});\n\ndefineFunction({\n  type: \"sqrt\",\n  names: [\"\\\\sqrt\"],\n  props: {\n    numArgs: 1,\n    numOptionalArgs: 1\n  },\n\n  handler(_ref, args, optArgs) {\n    var {\n      parser\n    } = _ref;\n    var index = optArgs[0];\n    var body = args[0];\n    return {\n      type: \"sqrt\",\n      mode: parser.mode,\n      body,\n      index\n    };\n  },\n\n  htmlBuilder(group, options) {\n    // Square roots are handled in the TeXbook pg. 443, Rule 11.\n    // First, we do the same steps as in overline to build the inner group\n    // and line\n    var inner = buildGroup$1(group.body, options.havingCrampedStyle());\n\n    if (inner.height === 0) {\n      // Render a small surd.\n      inner.height = options.fontMetrics().xHeight;\n    } // Some groups can return document fragments.  Handle those by wrapping\n    // them in a span.\n\n\n    inner = buildCommon.wrapFragment(inner, options); // Calculate the minimum size for the \\surd delimiter\n\n    var metrics = options.fontMetrics();\n    var theta = metrics.defaultRuleThickness;\n    var phi = theta;\n\n    if (options.style.id < Style$1.TEXT.id) {\n      phi = options.fontMetrics().xHeight;\n    } // Calculate the clearance between the body and line\n\n\n    var lineClearance = theta + phi / 4;\n    var minDelimiterHeight = inner.height + inner.depth + lineClearance + theta; // Create a sqrt SVG of the required minimum size\n\n    var {\n      span: img,\n      ruleWidth,\n      advanceWidth\n    } = delimiter.sqrtImage(minDelimiterHeight, options);\n    var delimDepth = img.height - ruleWidth; // Adjust the clearance based on the delimiter size\n\n    if (delimDepth > inner.height + inner.depth + lineClearance) {\n      lineClearance = (lineClearance + delimDepth - inner.height - inner.depth) / 2;\n    } // Shift the sqrt image\n\n\n    var imgShift = img.height - inner.height - lineClearance - ruleWidth;\n    inner.style.paddingLeft = makeEm(advanceWidth); // Overlay the image and the argument.\n\n    var body = buildCommon.makeVList({\n      positionType: \"firstBaseline\",\n      children: [{\n        type: \"elem\",\n        elem: inner,\n        wrapperClasses: [\"svg-align\"]\n      }, {\n        type: \"kern\",\n        size: -(inner.height + imgShift)\n      }, {\n        type: \"elem\",\n        elem: img\n      }, {\n        type: \"kern\",\n        size: ruleWidth\n      }]\n    }, options);\n\n    if (!group.index) {\n      return buildCommon.makeSpan([\"mord\", \"sqrt\"], [body], options);\n    } else {\n      // Handle the optional root index\n      // The index is always in scriptscript style\n      var newOptions = options.havingStyle(Style$1.SCRIPTSCRIPT);\n      var rootm = buildGroup$1(group.index, newOptions, options); // The amount the index is shifted by. This is taken from the TeX\n      // source, in the definition of `\\r@@t`.\n\n      var toShift = 0.6 * (body.height - body.depth); // Build a VList with the superscript shifted up correctly\n\n      var rootVList = buildCommon.makeVList({\n        positionType: \"shift\",\n        positionData: -toShift,\n        children: [{\n          type: \"elem\",\n          elem: rootm\n        }]\n      }, options); // Add a class surrounding it so we can add on the appropriate\n      // kerning\n\n      var rootVListWrap = buildCommon.makeSpan([\"root\"], [rootVList]);\n      return buildCommon.makeSpan([\"mord\", \"sqrt\"], [rootVListWrap, body], options);\n    }\n  },\n\n  mathmlBuilder(group, options) {\n    var {\n      body,\n      index\n    } = group;\n    return index ? new mathMLTree.MathNode(\"mroot\", [buildGroup(body, options), buildGroup(index, options)]) : new mathMLTree.MathNode(\"msqrt\", [buildGroup(body, options)]);\n  }\n\n});\n\nvar styleMap = {\n  \"display\": Style$1.DISPLAY,\n  \"text\": Style$1.TEXT,\n  \"script\": Style$1.SCRIPT,\n  \"scriptscript\": Style$1.SCRIPTSCRIPT\n};\ndefineFunction({\n  type: \"styling\",\n  names: [\"\\\\displaystyle\", \"\\\\textstyle\", \"\\\\scriptstyle\", \"\\\\scriptscriptstyle\"],\n  props: {\n    numArgs: 0,\n    allowedInText: true,\n    primitive: true\n  },\n\n  handler(_ref, args) {\n    var {\n      breakOnTokenText,\n      funcName,\n      parser\n    } = _ref;\n    // parse out the implicit body\n    var body = parser.parseExpression(true, breakOnTokenText); // TODO: Refactor to avoid duplicating styleMap in multiple places (e.g.\n    // here and in buildHTML and de-dupe the enumeration of all the styles).\n    // $FlowFixMe: The names above exactly match the styles.\n\n    var style = funcName.slice(1, funcName.length - 5);\n    return {\n      type: \"styling\",\n      mode: parser.mode,\n      // Figure out what style to use by pulling out the style from\n      // the function name\n      style,\n      body\n    };\n  },\n\n  htmlBuilder(group, options) {\n    // Style changes are handled in the TeXbook on pg. 442, Rule 3.\n    var newStyle = styleMap[group.style];\n    var newOptions = options.havingStyle(newStyle).withFont('');\n    return sizingGroup(group.body, newOptions, options);\n  },\n\n  mathmlBuilder(group, options) {\n    // Figure out what style we're changing to.\n    var newStyle = styleMap[group.style];\n    var newOptions = options.havingStyle(newStyle);\n    var inner = buildExpression(group.body, newOptions);\n    var node = new mathMLTree.MathNode(\"mstyle\", inner);\n    var styleAttributes = {\n      \"display\": [\"0\", \"true\"],\n      \"text\": [\"0\", \"false\"],\n      \"script\": [\"1\", \"false\"],\n      \"scriptscript\": [\"2\", \"false\"]\n    };\n    var attr = styleAttributes[group.style];\n    node.setAttribute(\"scriptlevel\", attr[0]);\n    node.setAttribute(\"displaystyle\", attr[1]);\n    return node;\n  }\n\n});\n\n/**\n * Sometimes, groups perform special rules when they have superscripts or\n * subscripts attached to them. This function lets the `supsub` group know that\n * Sometimes, groups perform special rules when they have superscripts or\n * its inner element should handle the superscripts and subscripts instead of\n * handling them itself.\n */\nvar htmlBuilderDelegate = function htmlBuilderDelegate(group, options) {\n  var base = group.base;\n\n  if (!base) {\n    return null;\n  } else if (base.type === \"op\") {\n    // Operators handle supsubs differently when they have limits\n    // (e.g. `\\displaystyle\\sum_2^3`)\n    var delegate = base.limits && (options.style.size === Style$1.DISPLAY.size || base.alwaysHandleSupSub);\n    return delegate ? htmlBuilder$2 : null;\n  } else if (base.type === \"operatorname\") {\n    var _delegate = base.alwaysHandleSupSub && (options.style.size === Style$1.DISPLAY.size || base.limits);\n\n    return _delegate ? htmlBuilder$1 : null;\n  } else if (base.type === \"accent\") {\n    return utils.isCharacterBox(base.base) ? htmlBuilder$a : null;\n  } else if (base.type === \"horizBrace\") {\n    var isSup = !group.sub;\n    return isSup === base.isOver ? htmlBuilder$3 : null;\n  } else {\n    return null;\n  }\n}; // Super scripts and subscripts, whose precise placement can depend on other\n// functions that precede them.\n\n\ndefineFunctionBuilders({\n  type: \"supsub\",\n\n  htmlBuilder(group, options) {\n    // Superscript and subscripts are handled in the TeXbook on page\n    // 445-446, rules 18(a-f).\n    // Here is where we defer to the inner group if it should handle\n    // superscripts and subscripts itself.\n    var builderDelegate = htmlBuilderDelegate(group, options);\n\n    if (builderDelegate) {\n      return builderDelegate(group, options);\n    }\n\n    var {\n      base: valueBase,\n      sup: valueSup,\n      sub: valueSub\n    } = group;\n    var base = buildGroup$1(valueBase, options);\n    var supm;\n    var subm;\n    var metrics = options.fontMetrics(); // Rule 18a\n\n    var supShift = 0;\n    var subShift = 0;\n    var isCharacterBox = valueBase && utils.isCharacterBox(valueBase);\n\n    if (valueSup) {\n      var newOptions = options.havingStyle(options.style.sup());\n      supm = buildGroup$1(valueSup, newOptions, options);\n\n      if (!isCharacterBox) {\n        supShift = base.height - newOptions.fontMetrics().supDrop * newOptions.sizeMultiplier / options.sizeMultiplier;\n      }\n    }\n\n    if (valueSub) {\n      var _newOptions = options.havingStyle(options.style.sub());\n\n      subm = buildGroup$1(valueSub, _newOptions, options);\n\n      if (!isCharacterBox) {\n        subShift = base.depth + _newOptions.fontMetrics().subDrop * _newOptions.sizeMultiplier / options.sizeMultiplier;\n      }\n    } // Rule 18c\n\n\n    var minSupShift;\n\n    if (options.style === Style$1.DISPLAY) {\n      minSupShift = metrics.sup1;\n    } else if (options.style.cramped) {\n      minSupShift = metrics.sup3;\n    } else {\n      minSupShift = metrics.sup2;\n    } // scriptspace is a font-size-independent size, so scale it\n    // appropriately for use as the marginRight.\n\n\n    var multiplier = options.sizeMultiplier;\n    var marginRight = makeEm(0.5 / metrics.ptPerEm / multiplier);\n    var marginLeft = null;\n\n    if (subm) {\n      // Subscripts shouldn't be shifted by the base's italic correction.\n      // Account for that by shifting the subscript back the appropriate\n      // amount. Note we only do this when the base is a single symbol.\n      var isOiint = group.base && group.base.type === \"op\" && group.base.name && (group.base.name === \"\\\\oiint\" || group.base.name === \"\\\\oiiint\");\n\n      if (base instanceof SymbolNode || isOiint) {\n        // $FlowFixMe\n        marginLeft = makeEm(-base.italic);\n      }\n    }\n\n    var supsub;\n\n    if (supm && subm) {\n      supShift = Math.max(supShift, minSupShift, supm.depth + 0.25 * metrics.xHeight);\n      subShift = Math.max(subShift, metrics.sub2);\n      var ruleWidth = metrics.defaultRuleThickness; // Rule 18e\n\n      var maxWidth = 4 * ruleWidth;\n\n      if (supShift - supm.depth - (subm.height - subShift) < maxWidth) {\n        subShift = maxWidth - (supShift - supm.depth) + subm.height;\n        var psi = 0.8 * metrics.xHeight - (supShift - supm.depth);\n\n        if (psi > 0) {\n          supShift += psi;\n          subShift -= psi;\n        }\n      }\n\n      var vlistElem = [{\n        type: \"elem\",\n        elem: subm,\n        shift: subShift,\n        marginRight,\n        marginLeft\n      }, {\n        type: \"elem\",\n        elem: supm,\n        shift: -supShift,\n        marginRight\n      }];\n      supsub = buildCommon.makeVList({\n        positionType: \"individualShift\",\n        children: vlistElem\n      }, options);\n    } else if (subm) {\n      // Rule 18b\n      subShift = Math.max(subShift, metrics.sub1, subm.height - 0.8 * metrics.xHeight);\n      var _vlistElem = [{\n        type: \"elem\",\n        elem: subm,\n        marginLeft,\n        marginRight\n      }];\n      supsub = buildCommon.makeVList({\n        positionType: \"shift\",\n        positionData: subShift,\n        children: _vlistElem\n      }, options);\n    } else if (supm) {\n      // Rule 18c, d\n      supShift = Math.max(supShift, minSupShift, supm.depth + 0.25 * metrics.xHeight);\n      supsub = buildCommon.makeVList({\n        positionType: \"shift\",\n        positionData: -supShift,\n        children: [{\n          type: \"elem\",\n          elem: supm,\n          marginRight\n        }]\n      }, options);\n    } else {\n      throw new Error(\"supsub must have either sup or sub.\");\n    } // Wrap the supsub vlist in a span.msupsub to reset text-align.\n\n\n    var mclass = getTypeOfDomTree(base, \"right\") || \"mord\";\n    return buildCommon.makeSpan([mclass], [base, buildCommon.makeSpan([\"msupsub\"], [supsub])], options);\n  },\n\n  mathmlBuilder(group, options) {\n    // Is the inner group a relevant horizontal brace?\n    var isBrace = false;\n    var isOver;\n    var isSup;\n\n    if (group.base && group.base.type === \"horizBrace\") {\n      isSup = !!group.sup;\n\n      if (isSup === group.base.isOver) {\n        isBrace = true;\n        isOver = group.base.isOver;\n      }\n    }\n\n    if (group.base && (group.base.type === \"op\" || group.base.type === \"operatorname\")) {\n      group.base.parentIsSupSub = true;\n    }\n\n    var children = [buildGroup(group.base, options)];\n\n    if (group.sub) {\n      children.push(buildGroup(group.sub, options));\n    }\n\n    if (group.sup) {\n      children.push(buildGroup(group.sup, options));\n    }\n\n    var nodeType;\n\n    if (isBrace) {\n      nodeType = isOver ? \"mover\" : \"munder\";\n    } else if (!group.sub) {\n      var base = group.base;\n\n      if (base && base.type === \"op\" && base.limits && (options.style === Style$1.DISPLAY || base.alwaysHandleSupSub)) {\n        nodeType = \"mover\";\n      } else if (base && base.type === \"operatorname\" && base.alwaysHandleSupSub && (base.limits || options.style === Style$1.DISPLAY)) {\n        nodeType = \"mover\";\n      } else {\n        nodeType = \"msup\";\n      }\n    } else if (!group.sup) {\n      var _base = group.base;\n\n      if (_base && _base.type === \"op\" && _base.limits && (options.style === Style$1.DISPLAY || _base.alwaysHandleSupSub)) {\n        nodeType = \"munder\";\n      } else if (_base && _base.type === \"operatorname\" && _base.alwaysHandleSupSub && (_base.limits || options.style === Style$1.DISPLAY)) {\n        nodeType = \"munder\";\n      } else {\n        nodeType = \"msub\";\n      }\n    } else {\n      var _base2 = group.base;\n\n      if (_base2 && _base2.type === \"op\" && _base2.limits && options.style === Style$1.DISPLAY) {\n        nodeType = \"munderover\";\n      } else if (_base2 && _base2.type === \"operatorname\" && _base2.alwaysHandleSupSub && (options.style === Style$1.DISPLAY || _base2.limits)) {\n        nodeType = \"munderover\";\n      } else {\n        nodeType = \"msubsup\";\n      }\n    }\n\n    return new mathMLTree.MathNode(nodeType, children);\n  }\n\n});\n\ndefineFunctionBuilders({\n  type: \"atom\",\n\n  htmlBuilder(group, options) {\n    return buildCommon.mathsym(group.text, group.mode, options, [\"m\" + group.family]);\n  },\n\n  mathmlBuilder(group, options) {\n    var node = new mathMLTree.MathNode(\"mo\", [makeText(group.text, group.mode)]);\n\n    if (group.family === \"bin\") {\n      var variant = getVariant(group, options);\n\n      if (variant === \"bold-italic\") {\n        node.setAttribute(\"mathvariant\", variant);\n      }\n    } else if (group.family === \"punct\") {\n      node.setAttribute(\"separator\", \"true\");\n    } else if (group.family === \"open\" || group.family === \"close\") {\n      // Delims built here should not stretch vertically.\n      // See delimsizing.js for stretchy delims.\n      node.setAttribute(\"stretchy\", \"false\");\n    }\n\n    return node;\n  }\n\n});\n\n// \"mathord\" and \"textord\" ParseNodes created in Parser.js from symbol Groups in\n// src/symbols.js.\nvar defaultVariant = {\n  \"mi\": \"italic\",\n  \"mn\": \"normal\",\n  \"mtext\": \"normal\"\n};\ndefineFunctionBuilders({\n  type: \"mathord\",\n\n  htmlBuilder(group, options) {\n    return buildCommon.makeOrd(group, options, \"mathord\");\n  },\n\n  mathmlBuilder(group, options) {\n    var node = new mathMLTree.MathNode(\"mi\", [makeText(group.text, group.mode, options)]);\n    var variant = getVariant(group, options) || \"italic\";\n\n    if (variant !== defaultVariant[node.type]) {\n      node.setAttribute(\"mathvariant\", variant);\n    }\n\n    return node;\n  }\n\n});\ndefineFunctionBuilders({\n  type: \"textord\",\n\n  htmlBuilder(group, options) {\n    return buildCommon.makeOrd(group, options, \"textord\");\n  },\n\n  mathmlBuilder(group, options) {\n    var text = makeText(group.text, group.mode, options);\n    var variant = getVariant(group, options) || \"normal\";\n    var node;\n\n    if (group.mode === 'text') {\n      node = new mathMLTree.MathNode(\"mtext\", [text]);\n    } else if (/[0-9]/.test(group.text)) {\n      node = new mathMLTree.MathNode(\"mn\", [text]);\n    } else if (group.text === \"\\\\prime\") {\n      node = new mathMLTree.MathNode(\"mo\", [text]);\n    } else {\n      node = new mathMLTree.MathNode(\"mi\", [text]);\n    }\n\n    if (variant !== defaultVariant[node.type]) {\n      node.setAttribute(\"mathvariant\", variant);\n    }\n\n    return node;\n  }\n\n});\n\nvar cssSpace = {\n  \"\\\\nobreak\": \"nobreak\",\n  \"\\\\allowbreak\": \"allowbreak\"\n}; // A lookup table to determine whether a spacing function/symbol should be\n// treated like a regular space character.  If a symbol or command is a key\n// in this table, then it should be a regular space character.  Furthermore,\n// the associated value may have a `className` specifying an extra CSS class\n// to add to the created `span`.\n\nvar regularSpace = {\n  \" \": {},\n  \"\\\\ \": {},\n  \"~\": {\n    className: \"nobreak\"\n  },\n  \"\\\\space\": {},\n  \"\\\\nobreakspace\": {\n    className: \"nobreak\"\n  }\n}; // ParseNode<\"spacing\"> created in Parser.js from the \"spacing\" symbol Groups in\n// src/symbols.js.\n\ndefineFunctionBuilders({\n  type: \"spacing\",\n\n  htmlBuilder(group, options) {\n    if (regularSpace.hasOwnProperty(group.text)) {\n      var className = regularSpace[group.text].className || \"\"; // Spaces are generated by adding an actual space. Each of these\n      // things has an entry in the symbols table, so these will be turned\n      // into appropriate outputs.\n\n      if (group.mode === \"text\") {\n        var ord = buildCommon.makeOrd(group, options, \"textord\");\n        ord.classes.push(className);\n        return ord;\n      } else {\n        return buildCommon.makeSpan([\"mspace\", className], [buildCommon.mathsym(group.text, group.mode, options)], options);\n      }\n    } else if (cssSpace.hasOwnProperty(group.text)) {\n      // Spaces based on just a CSS class.\n      return buildCommon.makeSpan([\"mspace\", cssSpace[group.text]], [], options);\n    } else {\n      throw new ParseError(\"Unknown type of space \\\"\" + group.text + \"\\\"\");\n    }\n  },\n\n  mathmlBuilder(group, options) {\n    var node;\n\n    if (regularSpace.hasOwnProperty(group.text)) {\n      node = new mathMLTree.MathNode(\"mtext\", [new mathMLTree.TextNode(\"\\u00a0\")]);\n    } else if (cssSpace.hasOwnProperty(group.text)) {\n      // CSS-based MathML spaces (\\nobreak, \\allowbreak) are ignored\n      return new mathMLTree.MathNode(\"mspace\");\n    } else {\n      throw new ParseError(\"Unknown type of space \\\"\" + group.text + \"\\\"\");\n    }\n\n    return node;\n  }\n\n});\n\nvar pad = () => {\n  var padNode = new mathMLTree.MathNode(\"mtd\", []);\n  padNode.setAttribute(\"width\", \"50%\");\n  return padNode;\n};\n\ndefineFunctionBuilders({\n  type: \"tag\",\n\n  mathmlBuilder(group, options) {\n    var table = new mathMLTree.MathNode(\"mtable\", [new mathMLTree.MathNode(\"mtr\", [pad(), new mathMLTree.MathNode(\"mtd\", [buildExpressionRow(group.body, options)]), pad(), new mathMLTree.MathNode(\"mtd\", [buildExpressionRow(group.tag, options)])])]);\n    table.setAttribute(\"width\", \"100%\");\n    return table; // TODO: Left-aligned tags.\n    // Currently, the group and options passed here do not contain\n    // enough info to set tag alignment. `leqno` is in Settings but it is\n    // not passed to Options. On the HTML side, leqno is\n    // set by a CSS class applied in buildTree.js. That would have worked\n    // in MathML if browsers supported <mlabeledtr>. Since they don't, we\n    // need to rewrite the way this function is called.\n  }\n\n});\n\nvar textFontFamilies = {\n  \"\\\\text\": undefined,\n  \"\\\\textrm\": \"textrm\",\n  \"\\\\textsf\": \"textsf\",\n  \"\\\\texttt\": \"texttt\",\n  \"\\\\textnormal\": \"textrm\"\n};\nvar textFontWeights = {\n  \"\\\\textbf\": \"textbf\",\n  \"\\\\textmd\": \"textmd\"\n};\nvar textFontShapes = {\n  \"\\\\textit\": \"textit\",\n  \"\\\\textup\": \"textup\"\n};\n\nvar optionsWithFont = (group, options) => {\n  var font = group.font; // Checks if the argument is a font family or a font style.\n\n  if (!font) {\n    return options;\n  } else if (textFontFamilies[font]) {\n    return options.withTextFontFamily(textFontFamilies[font]);\n  } else if (textFontWeights[font]) {\n    return options.withTextFontWeight(textFontWeights[font]);\n  } else if (font === \"\\\\emph\") {\n    return options.fontShape === \"textit\" ? options.withTextFontShape(\"textup\") : options.withTextFontShape(\"textit\");\n  }\n\n  return options.withTextFontShape(textFontShapes[font]);\n};\n\ndefineFunction({\n  type: \"text\",\n  names: [// Font families\n  \"\\\\text\", \"\\\\textrm\", \"\\\\textsf\", \"\\\\texttt\", \"\\\\textnormal\", // Font weights\n  \"\\\\textbf\", \"\\\\textmd\", // Font Shapes\n  \"\\\\textit\", \"\\\\textup\", \"\\\\emph\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"text\"],\n    allowedInArgument: true,\n    allowedInText: true\n  },\n\n  handler(_ref, args) {\n    var {\n      parser,\n      funcName\n    } = _ref;\n    var body = args[0];\n    return {\n      type: \"text\",\n      mode: parser.mode,\n      body: ordargument(body),\n      font: funcName\n    };\n  },\n\n  htmlBuilder(group, options) {\n    var newOptions = optionsWithFont(group, options);\n    var inner = buildExpression$1(group.body, newOptions, true);\n    return buildCommon.makeSpan([\"mord\", \"text\"], inner, newOptions);\n  },\n\n  mathmlBuilder(group, options) {\n    var newOptions = optionsWithFont(group, options);\n    return buildExpressionRow(group.body, newOptions);\n  }\n\n});\n\ndefineFunction({\n  type: \"underline\",\n  names: [\"\\\\underline\"],\n  props: {\n    numArgs: 1,\n    allowedInText: true\n  },\n\n  handler(_ref, args) {\n    var {\n      parser\n    } = _ref;\n    return {\n      type: \"underline\",\n      mode: parser.mode,\n      body: args[0]\n    };\n  },\n\n  htmlBuilder(group, options) {\n    // Underlines are handled in the TeXbook pg 443, Rule 10.\n    // Build the inner group.\n    var innerGroup = buildGroup$1(group.body, options); // Create the line to go below the body\n\n    var line = buildCommon.makeLineSpan(\"underline-line\", options); // Generate the vlist, with the appropriate kerns\n\n    var defaultRuleThickness = options.fontMetrics().defaultRuleThickness;\n    var vlist = buildCommon.makeVList({\n      positionType: \"top\",\n      positionData: innerGroup.height,\n      children: [{\n        type: \"kern\",\n        size: defaultRuleThickness\n      }, {\n        type: \"elem\",\n        elem: line\n      }, {\n        type: \"kern\",\n        size: 3 * defaultRuleThickness\n      }, {\n        type: \"elem\",\n        elem: innerGroup\n      }]\n    }, options);\n    return buildCommon.makeSpan([\"mord\", \"underline\"], [vlist], options);\n  },\n\n  mathmlBuilder(group, options) {\n    var operator = new mathMLTree.MathNode(\"mo\", [new mathMLTree.TextNode(\"\\u203e\")]);\n    operator.setAttribute(\"stretchy\", \"true\");\n    var node = new mathMLTree.MathNode(\"munder\", [buildGroup(group.body, options), operator]);\n    node.setAttribute(\"accentunder\", \"true\");\n    return node;\n  }\n\n});\n\ndefineFunction({\n  type: \"vcenter\",\n  names: [\"\\\\vcenter\"],\n  props: {\n    numArgs: 1,\n    argTypes: [\"original\"],\n    // In LaTeX, \\vcenter can act only on a box.\n    allowedInText: false\n  },\n\n  handler(_ref, args) {\n    var {\n      parser\n    } = _ref;\n    return {\n      type: \"vcenter\",\n      mode: parser.mode,\n      body: args[0]\n    };\n  },\n\n  htmlBuilder(group, options) {\n    var body = buildGroup$1(group.body, options);\n    var axisHeight = options.fontMetrics().axisHeight;\n    var dy = 0.5 * (body.height - axisHeight - (body.depth + axisHeight));\n    return buildCommon.makeVList({\n      positionType: \"shift\",\n      positionData: dy,\n      children: [{\n        type: \"elem\",\n        elem: body\n      }]\n    }, options);\n  },\n\n  mathmlBuilder(group, options) {\n    // There is no way to do this in MathML.\n    // Write a class as a breadcrumb in case some post-processor wants\n    // to perform a vcenter adjustment.\n    return new mathMLTree.MathNode(\"mpadded\", [buildGroup(group.body, options)], [\"vcenter\"]);\n  }\n\n});\n\ndefineFunction({\n  type: \"verb\",\n  names: [\"\\\\verb\"],\n  props: {\n    numArgs: 0,\n    allowedInText: true\n  },\n\n  handler(context, args, optArgs) {\n    // \\verb and \\verb* are dealt with directly in Parser.js.\n    // If we end up here, it's because of a failure to match the two delimiters\n    // in the regex in Lexer.js.  LaTeX raises the following error when \\verb is\n    // terminated by end of line (or file).\n    throw new ParseError(\"\\\\verb ended by end of line instead of matching delimiter\");\n  },\n\n  htmlBuilder(group, options) {\n    var text = makeVerb(group);\n    var body = []; // \\verb enters text mode and therefore is sized like \\textstyle\n\n    var newOptions = options.havingStyle(options.style.text());\n\n    for (var i = 0; i < text.length; i++) {\n      var c = text[i];\n\n      if (c === '~') {\n        c = '\\\\textasciitilde';\n      }\n\n      body.push(buildCommon.makeSymbol(c, \"Typewriter-Regular\", group.mode, newOptions, [\"mord\", \"texttt\"]));\n    }\n\n    return buildCommon.makeSpan([\"mord\", \"text\"].concat(newOptions.sizingClasses(options)), buildCommon.tryCombineChars(body), newOptions);\n  },\n\n  mathmlBuilder(group, options) {\n    var text = new mathMLTree.TextNode(makeVerb(group));\n    var node = new mathMLTree.MathNode(\"mtext\", [text]);\n    node.setAttribute(\"mathvariant\", \"monospace\");\n    return node;\n  }\n\n});\n/**\n * Converts verb group into body string.\n *\n * \\verb* replaces each space with an open box \\u2423\n * \\verb replaces each space with a no-break space \\xA0\n */\n\nvar makeVerb = group => group.body.replace(/ /g, group.star ? '\\u2423' : '\\xA0');\n\n/** Include this to ensure that all functions are defined. */\nvar functions = _functions;\n\n/**\n * The Lexer class handles tokenizing the input in various ways. Since our\n * parser expects us to be able to backtrack, the lexer allows lexing from any\n * given starting point.\n *\n * Its main exposed function is the `lex` function, which takes a position to\n * lex from and a type of token to lex. It defers to the appropriate `_innerLex`\n * function.\n *\n * The various `_innerLex` functions perform the actual lexing of different\n * kinds.\n */\n\n/* The following tokenRegex\n * - matches typical whitespace (but not NBSP etc.) using its first group\n * - does not match any control character \\x00-\\x1f except whitespace\n * - does not match a bare backslash\n * - matches any ASCII character except those just mentioned\n * - does not match the BMP private use area \\uE000-\\uF8FF\n * - does not match bare surrogate code units\n * - matches any BMP character except for those just described\n * - matches any valid Unicode surrogate pair\n * - matches a backslash followed by one or more whitespace characters\n * - matches a backslash followed by one or more letters then whitespace\n * - matches a backslash followed by any BMP character\n * Capturing groups:\n *   [1] regular whitespace\n *   [2] backslash followed by whitespace\n *   [3] anything else, which may include:\n *     [4] left character of \\verb*\n *     [5] left character of \\verb\n *     [6] backslash followed by word, excluding any trailing whitespace\n * Just because the Lexer matches something doesn't mean it's valid input:\n * If there is no matching function or symbol definition, the Parser will\n * still reject the input.\n */\nvar spaceRegexString = \"[ \\r\\n\\t]\";\nvar controlWordRegexString = \"\\\\\\\\[a-zA-Z@]+\";\nvar controlSymbolRegexString = \"\\\\\\\\[^\\uD800-\\uDFFF]\";\nvar controlWordWhitespaceRegexString = \"(\" + controlWordRegexString + \")\" + spaceRegexString + \"*\";\nvar controlSpaceRegexString = \"\\\\\\\\(\\n|[ \\r\\t]+\\n?)[ \\r\\t]*\";\nvar combiningDiacriticalMarkString = \"[\\u0300-\\u036f]\";\nvar combiningDiacriticalMarksEndRegex = new RegExp(combiningDiacriticalMarkString + \"+$\");\nvar tokenRegexString = \"(\" + spaceRegexString + \"+)|\" + ( // whitespace\ncontrolSpaceRegexString + \"|\") + // \\whitespace\n\"([!-\\\\[\\\\]-\\u2027\\u202A-\\uD7FF\\uF900-\\uFFFF]\" + ( // single codepoint\ncombiningDiacriticalMarkString + \"*\") + // ...plus accents\n\"|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]\" + ( // surrogate pair\ncombiningDiacriticalMarkString + \"*\") + // ...plus accents\n\"|\\\\\\\\verb\\\\*([^]).*?\\\\4\" + // \\verb*\n\"|\\\\\\\\verb([^*a-zA-Z]).*?\\\\5\" + ( // \\verb unstarred\n\"|\" + controlWordWhitespaceRegexString) + ( // \\macroName + spaces\n\"|\" + controlSymbolRegexString + \")\"); // \\\\, \\', etc.\n\n/** Main Lexer class */\n\nclass Lexer {\n  // Category codes. The lexer only supports comment characters (14) for now.\n  // MacroExpander additionally distinguishes active (13).\n  constructor(input, settings) {\n    this.input = void 0;\n    this.settings = void 0;\n    this.tokenRegex = void 0;\n    this.catcodes = void 0;\n    // Separate accents from characters\n    this.input = input;\n    this.settings = settings;\n    this.tokenRegex = new RegExp(tokenRegexString, 'g');\n    this.catcodes = {\n      \"%\": 14,\n      // comment character\n      \"~\": 13 // active character\n\n    };\n  }\n\n  setCatcode(char, code) {\n    this.catcodes[char] = code;\n  }\n  /**\n   * This function lexes a single token.\n   */\n\n\n  lex() {\n    var input = this.input;\n    var pos = this.tokenRegex.lastIndex;\n\n    if (pos === input.length) {\n      return new Token(\"EOF\", new SourceLocation(this, pos, pos));\n    }\n\n    var match = this.tokenRegex.exec(input);\n\n    if (match === null || match.index !== pos) {\n      throw new ParseError(\"Unexpected character: '\" + input[pos] + \"'\", new Token(input[pos], new SourceLocation(this, pos, pos + 1)));\n    }\n\n    var text = match[6] || match[3] || (match[2] ? \"\\\\ \" : \" \");\n\n    if (this.catcodes[text] === 14) {\n      // comment character\n      var nlIndex = input.indexOf('\\n', this.tokenRegex.lastIndex);\n\n      if (nlIndex === -1) {\n        this.tokenRegex.lastIndex = input.length; // EOF\n\n        this.settings.reportNonstrict(\"commentAtEnd\", \"% comment has no terminating newline; LaTeX would \" + \"fail because of commenting the end of math mode (e.g. $)\");\n      } else {\n        this.tokenRegex.lastIndex = nlIndex + 1;\n      }\n\n      return this.lex();\n    }\n\n    return new Token(text, new SourceLocation(this, pos, this.tokenRegex.lastIndex));\n  }\n\n}\n\n/**\n * A `Namespace` refers to a space of nameable things like macros or lengths,\n * which can be `set` either globally or local to a nested group, using an\n * undo stack similar to how TeX implements this functionality.\n * Performance-wise, `get` and local `set` take constant time, while global\n * `set` takes time proportional to the depth of group nesting.\n */\nclass Namespace {\n  /**\n   * Both arguments are optional.  The first argument is an object of\n   * built-in mappings which never change.  The second argument is an object\n   * of initial (global-level) mappings, which will constantly change\n   * according to any global/top-level `set`s done.\n   */\n  constructor(builtins, globalMacros) {\n    if (builtins === void 0) {\n      builtins = {};\n    }\n\n    if (globalMacros === void 0) {\n      globalMacros = {};\n    }\n\n    this.current = void 0;\n    this.builtins = void 0;\n    this.undefStack = void 0;\n    this.current = globalMacros;\n    this.builtins = builtins;\n    this.undefStack = [];\n  }\n  /**\n   * Start a new nested group, affecting future local `set`s.\n   */\n\n\n  beginGroup() {\n    this.undefStack.push({});\n  }\n  /**\n   * End current nested group, restoring values before the group began.\n   */\n\n\n  endGroup() {\n    if (this.undefStack.length === 0) {\n      throw new ParseError(\"Unbalanced namespace destruction: attempt \" + \"to pop global namespace; please report this as a bug\");\n    }\n\n    var undefs = this.undefStack.pop();\n\n    for (var undef in undefs) {\n      if (undefs.hasOwnProperty(undef)) {\n        if (undefs[undef] == null) {\n          delete this.current[undef];\n        } else {\n          this.current[undef] = undefs[undef];\n        }\n      }\n    }\n  }\n  /**\n   * Ends all currently nested groups (if any), restoring values before the\n   * groups began.  Useful in case of an error in the middle of parsing.\n   */\n\n\n  endGroups() {\n    while (this.undefStack.length > 0) {\n      this.endGroup();\n    }\n  }\n  /**\n   * Detect whether `name` has a definition.  Equivalent to\n   * `get(name) != null`.\n   */\n\n\n  has(name) {\n    return this.current.hasOwnProperty(name) || this.builtins.hasOwnProperty(name);\n  }\n  /**\n   * Get the current value of a name, or `undefined` if there is no value.\n   *\n   * Note: Do not use `if (namespace.get(...))` to detect whether a macro\n   * is defined, as the definition may be the empty string which evaluates\n   * to `false` in JavaScript.  Use `if (namespace.get(...) != null)` or\n   * `if (namespace.has(...))`.\n   */\n\n\n  get(name) {\n    if (this.current.hasOwnProperty(name)) {\n      return this.current[name];\n    } else {\n      return this.builtins[name];\n    }\n  }\n  /**\n   * Set the current value of a name, and optionally set it globally too.\n   * Local set() sets the current value and (when appropriate) adds an undo\n   * operation to the undo stack.  Global set() may change the undo\n   * operation at every level, so takes time linear in their number.\n   * A value of undefined means to delete existing definitions.\n   */\n\n\n  set(name, value, global) {\n    if (global === void 0) {\n      global = false;\n    }\n\n    if (global) {\n      // Global set is equivalent to setting in all groups.  Simulate this\n      // by destroying any undos currently scheduled for this name,\n      // and adding an undo with the *new* value (in case it later gets\n      // locally reset within this environment).\n      for (var i = 0; i < this.undefStack.length; i++) {\n        delete this.undefStack[i][name];\n      }\n\n      if (this.undefStack.length > 0) {\n        this.undefStack[this.undefStack.length - 1][name] = value;\n      }\n    } else {\n      // Undo this set at end of this group (possibly to `undefined`),\n      // unless an undo is already in place, in which case that older\n      // value is the correct one.\n      var top = this.undefStack[this.undefStack.length - 1];\n\n      if (top && !top.hasOwnProperty(name)) {\n        top[name] = this.current[name];\n      }\n    }\n\n    if (value == null) {\n      delete this.current[name];\n    } else {\n      this.current[name] = value;\n    }\n  }\n\n}\n\n/**\n * Predefined macros for KaTeX.\n * This can be used to define some commands in terms of others.\n */\nvar macros = _macros;\n// macro tools\n\ndefineMacro(\"\\\\noexpand\", function (context) {\n  // The expansion is the token itself; but that token is interpreted\n  // as if its meaning were ‘\\relax’ if it is a control sequence that\n  // would ordinarily be expanded by TeX’s expansion rules.\n  var t = context.popToken();\n\n  if (context.isExpandable(t.text)) {\n    t.noexpand = true;\n    t.treatAsRelax = true;\n  }\n\n  return {\n    tokens: [t],\n    numArgs: 0\n  };\n});\ndefineMacro(\"\\\\expandafter\", function (context) {\n  // TeX first reads the token that comes immediately after \\expandafter,\n  // without expanding it; let’s call this token t. Then TeX reads the\n  // token that comes after t (and possibly more tokens, if that token\n  // has an argument), replacing it by its expansion. Finally TeX puts\n  // t back in front of that expansion.\n  var t = context.popToken();\n  context.expandOnce(true); // expand only an expandable token\n\n  return {\n    tokens: [t],\n    numArgs: 0\n  };\n}); // LaTeX's \\@firstoftwo{#1}{#2} expands to #1, skipping #2\n// TeX source: \\long\\def\\@firstoftwo#1#2{#1}\n\ndefineMacro(\"\\\\@firstoftwo\", function (context) {\n  var args = context.consumeArgs(2);\n  return {\n    tokens: args[0],\n    numArgs: 0\n  };\n}); // LaTeX's \\@secondoftwo{#1}{#2} expands to #2, skipping #1\n// TeX source: \\long\\def\\@secondoftwo#1#2{#2}\n\ndefineMacro(\"\\\\@secondoftwo\", function (context) {\n  var args = context.consumeArgs(2);\n  return {\n    tokens: args[1],\n    numArgs: 0\n  };\n}); // LaTeX's \\@ifnextchar{#1}{#2}{#3} looks ahead to the next (unexpanded)\n// symbol that isn't a space, consuming any spaces but not consuming the\n// first nonspace character.  If that nonspace character matches #1, then\n// the macro expands to #2; otherwise, it expands to #3.\n\ndefineMacro(\"\\\\@ifnextchar\", function (context) {\n  var args = context.consumeArgs(3); // symbol, if, else\n\n  context.consumeSpaces();\n  var nextToken = context.future();\n\n  if (args[0].length === 1 && args[0][0].text === nextToken.text) {\n    return {\n      tokens: args[1],\n      numArgs: 0\n    };\n  } else {\n    return {\n      tokens: args[2],\n      numArgs: 0\n    };\n  }\n}); // LaTeX's \\@ifstar{#1}{#2} looks ahead to the next (unexpanded) symbol.\n// If it is `*`, then it consumes the symbol, and the macro expands to #1;\n// otherwise, the macro expands to #2 (without consuming the symbol).\n// TeX source: \\def\\@ifstar#1{\\@ifnextchar *{\\@firstoftwo{#1}}}\n\ndefineMacro(\"\\\\@ifstar\", \"\\\\@ifnextchar *{\\\\@firstoftwo{#1}}\"); // LaTeX's \\TextOrMath{#1}{#2} expands to #1 in text mode, #2 in math mode\n\ndefineMacro(\"\\\\TextOrMath\", function (context) {\n  var args = context.consumeArgs(2);\n\n  if (context.mode === 'text') {\n    return {\n      tokens: args[0],\n      numArgs: 0\n    };\n  } else {\n    return {\n      tokens: args[1],\n      numArgs: 0\n    };\n  }\n}); // Lookup table for parsing numbers in base 8 through 16\n\nvar digitToNumber = {\n  \"0\": 0,\n  \"1\": 1,\n  \"2\": 2,\n  \"3\": 3,\n  \"4\": 4,\n  \"5\": 5,\n  \"6\": 6,\n  \"7\": 7,\n  \"8\": 8,\n  \"9\": 9,\n  \"a\": 10,\n  \"A\": 10,\n  \"b\": 11,\n  \"B\": 11,\n  \"c\": 12,\n  \"C\": 12,\n  \"d\": 13,\n  \"D\": 13,\n  \"e\": 14,\n  \"E\": 14,\n  \"f\": 15,\n  \"F\": 15\n}; // TeX \\char makes a literal character (catcode 12) using the following forms:\n// (see The TeXBook, p. 43)\n//   \\char123  -- decimal\n//   \\char'123 -- octal\n//   \\char\"123 -- hex\n//   \\char`x   -- character that can be written (i.e. isn't active)\n//   \\char`\\x  -- character that cannot be written (e.g. %)\n// These all refer to characters from the font, so we turn them into special\n// calls to a function \\@char dealt with in the Parser.\n\ndefineMacro(\"\\\\char\", function (context) {\n  var token = context.popToken();\n  var base;\n  var number = '';\n\n  if (token.text === \"'\") {\n    base = 8;\n    token = context.popToken();\n  } else if (token.text === '\"') {\n    base = 16;\n    token = context.popToken();\n  } else if (token.text === \"`\") {\n    token = context.popToken();\n\n    if (token.text[0] === \"\\\\\") {\n      number = token.text.charCodeAt(1);\n    } else if (token.text === \"EOF\") {\n      throw new ParseError(\"\\\\char` missing argument\");\n    } else {\n      number = token.text.charCodeAt(0);\n    }\n  } else {\n    base = 10;\n  }\n\n  if (base) {\n    // Parse a number in the given base, starting with first `token`.\n    number = digitToNumber[token.text];\n\n    if (number == null || number >= base) {\n      throw new ParseError(\"Invalid base-\" + base + \" digit \" + token.text);\n    }\n\n    var digit;\n\n    while ((digit = digitToNumber[context.future().text]) != null && digit < base) {\n      number *= base;\n      number += digit;\n      context.popToken();\n    }\n  }\n\n  return \"\\\\@char{\" + number + \"}\";\n}); // \\newcommand{\\macro}[args]{definition}\n// \\renewcommand{\\macro}[args]{definition}\n// TODO: Optional arguments: \\newcommand{\\macro}[args][default]{definition}\n\nvar newcommand = (context, existsOK, nonexistsOK, skipIfExists) => {\n  var arg = context.consumeArg().tokens;\n\n  if (arg.length !== 1) {\n    throw new ParseError(\"\\\\newcommand's first argument must be a macro name\");\n  }\n\n  var name = arg[0].text;\n  var exists = context.isDefined(name);\n\n  if (exists && !existsOK) {\n    throw new ParseError(\"\\\\newcommand{\" + name + \"} attempting to redefine \" + (name + \"; use \\\\renewcommand\"));\n  }\n\n  if (!exists && !nonexistsOK) {\n    throw new ParseError(\"\\\\renewcommand{\" + name + \"} when command \" + name + \" \" + \"does not yet exist; use \\\\newcommand\");\n  }\n\n  var numArgs = 0;\n  arg = context.consumeArg().tokens;\n\n  if (arg.length === 1 && arg[0].text === \"[\") {\n    var argText = '';\n    var token = context.expandNextToken();\n\n    while (token.text !== \"]\" && token.text !== \"EOF\") {\n      // TODO: Should properly expand arg, e.g., ignore {}s\n      argText += token.text;\n      token = context.expandNextToken();\n    }\n\n    if (!argText.match(/^\\s*[0-9]+\\s*$/)) {\n      throw new ParseError(\"Invalid number of arguments: \" + argText);\n    }\n\n    numArgs = parseInt(argText);\n    arg = context.consumeArg().tokens;\n  }\n\n  if (!(exists && skipIfExists)) {\n    // Final arg is the expansion of the macro\n    context.macros.set(name, {\n      tokens: arg,\n      numArgs\n    });\n  }\n\n  return '';\n};\n\ndefineMacro(\"\\\\newcommand\", context => newcommand(context, false, true, false));\ndefineMacro(\"\\\\renewcommand\", context => newcommand(context, true, false, false));\ndefineMacro(\"\\\\providecommand\", context => newcommand(context, true, true, true)); // terminal (console) tools\n\ndefineMacro(\"\\\\message\", context => {\n  var arg = context.consumeArgs(1)[0]; // eslint-disable-next-line no-console\n\n  console.log(arg.reverse().map(token => token.text).join(\"\"));\n  return '';\n});\ndefineMacro(\"\\\\errmessage\", context => {\n  var arg = context.consumeArgs(1)[0]; // eslint-disable-next-line no-console\n\n  console.error(arg.reverse().map(token => token.text).join(\"\"));\n  return '';\n});\ndefineMacro(\"\\\\show\", context => {\n  var tok = context.popToken();\n  var name = tok.text; // eslint-disable-next-line no-console\n\n  console.log(tok, context.macros.get(name), functions[name], symbols.math[name], symbols.text[name]);\n  return '';\n}); //////////////////////////////////////////////////////////////////////\n// Grouping\n// \\let\\bgroup={ \\let\\egroup=}\n\ndefineMacro(\"\\\\bgroup\", \"{\");\ndefineMacro(\"\\\\egroup\", \"}\"); // Symbols from latex.ltx:\n// \\def~{\\nobreakspace{}}\n// \\def\\lq{`}\n// \\def\\rq{'}\n// \\def \\aa {\\r a}\n// \\def \\AA {\\r A}\n\ndefineMacro(\"~\", \"\\\\nobreakspace\");\ndefineMacro(\"\\\\lq\", \"`\");\ndefineMacro(\"\\\\rq\", \"'\");\ndefineMacro(\"\\\\aa\", \"\\\\r a\");\ndefineMacro(\"\\\\AA\", \"\\\\r A\"); // Copyright (C) and registered (R) symbols. Use raw symbol in MathML.\n// \\DeclareTextCommandDefault{\\textcopyright}{\\textcircled{c}}\n// \\DeclareTextCommandDefault{\\textregistered}{\\textcircled{%\n//      \\check@mathfonts\\fontsize\\sf@size\\z@\\math@fontsfalse\\selectfont R}}\n// \\DeclareRobustCommand{\\copyright}{%\n//    \\ifmmode{\\nfss@text{\\textcopyright}}\\else\\textcopyright\\fi}\n\ndefineMacro(\"\\\\textcopyright\", \"\\\\html@mathml{\\\\textcircled{c}}{\\\\char`©}\");\ndefineMacro(\"\\\\copyright\", \"\\\\TextOrMath{\\\\textcopyright}{\\\\text{\\\\textcopyright}}\");\ndefineMacro(\"\\\\textregistered\", \"\\\\html@mathml{\\\\textcircled{\\\\scriptsize R}}{\\\\char`®}\"); // Characters omitted from Unicode range 1D400–1D7FF\n\ndefineMacro(\"\\u212C\", \"\\\\mathscr{B}\"); // script\n\ndefineMacro(\"\\u2130\", \"\\\\mathscr{E}\");\ndefineMacro(\"\\u2131\", \"\\\\mathscr{F}\");\ndefineMacro(\"\\u210B\", \"\\\\mathscr{H}\");\ndefineMacro(\"\\u2110\", \"\\\\mathscr{I}\");\ndefineMacro(\"\\u2112\", \"\\\\mathscr{L}\");\ndefineMacro(\"\\u2133\", \"\\\\mathscr{M}\");\ndefineMacro(\"\\u211B\", \"\\\\mathscr{R}\");\ndefineMacro(\"\\u212D\", \"\\\\mathfrak{C}\"); // Fraktur\n\ndefineMacro(\"\\u210C\", \"\\\\mathfrak{H}\");\ndefineMacro(\"\\u2128\", \"\\\\mathfrak{Z}\"); // Define \\Bbbk with a macro that works in both HTML and MathML.\n\ndefineMacro(\"\\\\Bbbk\", \"\\\\Bbb{k}\"); // Unicode middle dot\n// The KaTeX fonts do not contain U+00B7. Instead, \\cdotp displays\n// the dot at U+22C5 and gives it punct spacing.\n\ndefineMacro(\"\\u00b7\", \"\\\\cdotp\"); // \\llap and \\rlap render their contents in text mode\n\ndefineMacro(\"\\\\llap\", \"\\\\mathllap{\\\\textrm{#1}}\");\ndefineMacro(\"\\\\rlap\", \"\\\\mathrlap{\\\\textrm{#1}}\");\ndefineMacro(\"\\\\clap\", \"\\\\mathclap{\\\\textrm{#1}}\"); // \\mathstrut from the TeXbook, p 360\n\ndefineMacro(\"\\\\mathstrut\", \"\\\\vphantom{(}\"); // \\underbar from TeXbook p 353\n\ndefineMacro(\"\\\\underbar\", \"\\\\underline{\\\\text{#1}}\"); // \\not is defined by base/fontmath.ltx via\n// \\DeclareMathSymbol{\\not}{\\mathrel}{symbols}{\"36}\n// It's thus treated like a \\mathrel, but defined by a symbol that has zero\n// width but extends to the right.  We use \\rlap to get that spacing.\n// For MathML we write U+0338 here. buildMathML.js will then do the overlay.\n\ndefineMacro(\"\\\\not\", '\\\\html@mathml{\\\\mathrel{\\\\mathrlap\\\\@not}}{\\\\char\"338}'); // Negated symbols from base/fontmath.ltx:\n// \\def\\neq{\\not=} \\let\\ne=\\neq\n// \\DeclareRobustCommand\n//   \\notin{\\mathrel{\\m@th\\mathpalette\\c@ncel\\in}}\n// \\def\\c@ncel#1#2{\\m@th\\ooalign{$\\hfil#1\\mkern1mu/\\hfil$\\crcr$#1#2$}}\n\ndefineMacro(\"\\\\neq\", \"\\\\html@mathml{\\\\mathrel{\\\\not=}}{\\\\mathrel{\\\\char`≠}}\");\ndefineMacro(\"\\\\ne\", \"\\\\neq\");\ndefineMacro(\"\\u2260\", \"\\\\neq\");\ndefineMacro(\"\\\\notin\", \"\\\\html@mathml{\\\\mathrel{{\\\\in}\\\\mathllap{/\\\\mskip1mu}}}\" + \"{\\\\mathrel{\\\\char`∉}}\");\ndefineMacro(\"\\u2209\", \"\\\\notin\"); // Unicode stacked relations\n\ndefineMacro(\"\\u2258\", \"\\\\html@mathml{\" + \"\\\\mathrel{=\\\\kern{-1em}\\\\raisebox{0.4em}{$\\\\scriptsize\\\\frown$}}\" + \"}{\\\\mathrel{\\\\char`\\u2258}}\");\ndefineMacro(\"\\u2259\", \"\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\wedge}{=}}{\\\\mathrel{\\\\char`\\u2258}}\");\ndefineMacro(\"\\u225A\", \"\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\vee}{=}}{\\\\mathrel{\\\\char`\\u225A}}\");\ndefineMacro(\"\\u225B\", \"\\\\html@mathml{\\\\stackrel{\\\\scriptsize\\\\star}{=}}\" + \"{\\\\mathrel{\\\\char`\\u225B}}\");\ndefineMacro(\"\\u225D\", \"\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\mathrm{def}}{=}}\" + \"{\\\\mathrel{\\\\char`\\u225D}}\");\ndefineMacro(\"\\u225E\", \"\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\mathrm{m}}{=}}\" + \"{\\\\mathrel{\\\\char`\\u225E}}\");\ndefineMacro(\"\\u225F\", \"\\\\html@mathml{\\\\stackrel{\\\\tiny?}{=}}{\\\\mathrel{\\\\char`\\u225F}}\"); // Misc Unicode\n\ndefineMacro(\"\\u27C2\", \"\\\\perp\");\ndefineMacro(\"\\u203C\", \"\\\\mathclose{!\\\\mkern-0.8mu!}\");\ndefineMacro(\"\\u220C\", \"\\\\notni\");\ndefineMacro(\"\\u231C\", \"\\\\ulcorner\");\ndefineMacro(\"\\u231D\", \"\\\\urcorner\");\ndefineMacro(\"\\u231E\", \"\\\\llcorner\");\ndefineMacro(\"\\u231F\", \"\\\\lrcorner\");\ndefineMacro(\"\\u00A9\", \"\\\\copyright\");\ndefineMacro(\"\\u00AE\", \"\\\\textregistered\");\ndefineMacro(\"\\uFE0F\", \"\\\\textregistered\"); // The KaTeX fonts have corners at codepoints that don't match Unicode.\n// For MathML purposes, use the Unicode code point.\n\ndefineMacro(\"\\\\ulcorner\", \"\\\\html@mathml{\\\\@ulcorner}{\\\\mathop{\\\\char\\\"231c}}\");\ndefineMacro(\"\\\\urcorner\", \"\\\\html@mathml{\\\\@urcorner}{\\\\mathop{\\\\char\\\"231d}}\");\ndefineMacro(\"\\\\llcorner\", \"\\\\html@mathml{\\\\@llcorner}{\\\\mathop{\\\\char\\\"231e}}\");\ndefineMacro(\"\\\\lrcorner\", \"\\\\html@mathml{\\\\@lrcorner}{\\\\mathop{\\\\char\\\"231f}}\"); //////////////////////////////////////////////////////////////////////\n// LaTeX_2ε\n// \\vdots{\\vbox{\\baselineskip4\\p@  \\lineskiplimit\\z@\n// \\kern6\\p@\\hbox{.}\\hbox{.}\\hbox{.}}}\n// We'll call \\varvdots, which gets a glyph from symbols.js.\n// The zero-width rule gets us an equivalent to the vertical 6pt kern.\n\ndefineMacro(\"\\\\vdots\", \"{\\\\varvdots\\\\rule{0pt}{15pt}}\");\ndefineMacro(\"\\u22ee\", \"\\\\vdots\"); //////////////////////////////////////////////////////////////////////\n// amsmath.sty\n// http://mirrors.concertpass.com/tex-archive/macros/latex/required/amsmath/amsmath.pdf\n// Italic Greek capital letters.  AMS defines these with \\DeclareMathSymbol,\n// but they are equivalent to \\mathit{\\Letter}.\n\ndefineMacro(\"\\\\varGamma\", \"\\\\mathit{\\\\Gamma}\");\ndefineMacro(\"\\\\varDelta\", \"\\\\mathit{\\\\Delta}\");\ndefineMacro(\"\\\\varTheta\", \"\\\\mathit{\\\\Theta}\");\ndefineMacro(\"\\\\varLambda\", \"\\\\mathit{\\\\Lambda}\");\ndefineMacro(\"\\\\varXi\", \"\\\\mathit{\\\\Xi}\");\ndefineMacro(\"\\\\varPi\", \"\\\\mathit{\\\\Pi}\");\ndefineMacro(\"\\\\varSigma\", \"\\\\mathit{\\\\Sigma}\");\ndefineMacro(\"\\\\varUpsilon\", \"\\\\mathit{\\\\Upsilon}\");\ndefineMacro(\"\\\\varPhi\", \"\\\\mathit{\\\\Phi}\");\ndefineMacro(\"\\\\varPsi\", \"\\\\mathit{\\\\Psi}\");\ndefineMacro(\"\\\\varOmega\", \"\\\\mathit{\\\\Omega}\"); //\\newcommand{\\substack}[1]{\\subarray{c}#1\\endsubarray}\n\ndefineMacro(\"\\\\substack\", \"\\\\begin{subarray}{c}#1\\\\end{subarray}\"); // \\renewcommand{\\colon}{\\nobreak\\mskip2mu\\mathpunct{}\\nonscript\n// \\mkern-\\thinmuskip{:}\\mskip6muplus1mu\\relax}\n\ndefineMacro(\"\\\\colon\", \"\\\\nobreak\\\\mskip2mu\\\\mathpunct{}\" + \"\\\\mathchoice{\\\\mkern-3mu}{\\\\mkern-3mu}{}{}{:}\\\\mskip6mu\\\\relax\"); // \\newcommand{\\boxed}[1]{\\fbox{\\m@th$\\displaystyle#1$}}\n\ndefineMacro(\"\\\\boxed\", \"\\\\fbox{$\\\\displaystyle{#1}$}\"); // \\def\\iff{\\DOTSB\\;\\Longleftrightarrow\\;}\n// \\def\\implies{\\DOTSB\\;\\Longrightarrow\\;}\n// \\def\\impliedby{\\DOTSB\\;\\Longleftarrow\\;}\n\ndefineMacro(\"\\\\iff\", \"\\\\DOTSB\\\\;\\\\Longleftrightarrow\\\\;\");\ndefineMacro(\"\\\\implies\", \"\\\\DOTSB\\\\;\\\\Longrightarrow\\\\;\");\ndefineMacro(\"\\\\impliedby\", \"\\\\DOTSB\\\\;\\\\Longleftarrow\\\\;\"); // \\def\\dddot#1{{\\mathop{#1}\\limits^{\\vbox to-1.4\\ex@{\\kern-\\tw@\\ex@\n//  \\hbox{\\normalfont ...}\\vss}}}}\n// We use \\overset which avoids the vertical shift of \\mathop.\n\ndefineMacro(\"\\\\dddot\", \"{\\\\overset{\\\\raisebox{-0.1ex}{\\\\normalsize ...}}{#1}}\");\ndefineMacro(\"\\\\ddddot\", \"{\\\\overset{\\\\raisebox{-0.1ex}{\\\\normalsize ....}}{#1}}\"); // AMSMath's automatic \\dots, based on \\mdots@@ macro.\n\nvar dotsByToken = {\n  ',': '\\\\dotsc',\n  '\\\\not': '\\\\dotsb',\n  // \\keybin@ checks for the following:\n  '+': '\\\\dotsb',\n  '=': '\\\\dotsb',\n  '<': '\\\\dotsb',\n  '>': '\\\\dotsb',\n  '-': '\\\\dotsb',\n  '*': '\\\\dotsb',\n  ':': '\\\\dotsb',\n  // Symbols whose definition starts with \\DOTSB:\n  '\\\\DOTSB': '\\\\dotsb',\n  '\\\\coprod': '\\\\dotsb',\n  '\\\\bigvee': '\\\\dotsb',\n  '\\\\bigwedge': '\\\\dotsb',\n  '\\\\biguplus': '\\\\dotsb',\n  '\\\\bigcap': '\\\\dotsb',\n  '\\\\bigcup': '\\\\dotsb',\n  '\\\\prod': '\\\\dotsb',\n  '\\\\sum': '\\\\dotsb',\n  '\\\\bigotimes': '\\\\dotsb',\n  '\\\\bigoplus': '\\\\dotsb',\n  '\\\\bigodot': '\\\\dotsb',\n  '\\\\bigsqcup': '\\\\dotsb',\n  '\\\\And': '\\\\dotsb',\n  '\\\\longrightarrow': '\\\\dotsb',\n  '\\\\Longrightarrow': '\\\\dotsb',\n  '\\\\longleftarrow': '\\\\dotsb',\n  '\\\\Longleftarrow': '\\\\dotsb',\n  '\\\\longleftrightarrow': '\\\\dotsb',\n  '\\\\Longleftrightarrow': '\\\\dotsb',\n  '\\\\mapsto': '\\\\dotsb',\n  '\\\\longmapsto': '\\\\dotsb',\n  '\\\\hookrightarrow': '\\\\dotsb',\n  '\\\\doteq': '\\\\dotsb',\n  // Symbols whose definition starts with \\mathbin:\n  '\\\\mathbin': '\\\\dotsb',\n  // Symbols whose definition starts with \\mathrel:\n  '\\\\mathrel': '\\\\dotsb',\n  '\\\\relbar': '\\\\dotsb',\n  '\\\\Relbar': '\\\\dotsb',\n  '\\\\xrightarrow': '\\\\dotsb',\n  '\\\\xleftarrow': '\\\\dotsb',\n  // Symbols whose definition starts with \\DOTSI:\n  '\\\\DOTSI': '\\\\dotsi',\n  '\\\\int': '\\\\dotsi',\n  '\\\\oint': '\\\\dotsi',\n  '\\\\iint': '\\\\dotsi',\n  '\\\\iiint': '\\\\dotsi',\n  '\\\\iiiint': '\\\\dotsi',\n  '\\\\idotsint': '\\\\dotsi',\n  // Symbols whose definition starts with \\DOTSX:\n  '\\\\DOTSX': '\\\\dotsx'\n};\ndefineMacro(\"\\\\dots\", function (context) {\n  // TODO: If used in text mode, should expand to \\textellipsis.\n  // However, in KaTeX, \\textellipsis and \\ldots behave the same\n  // (in text mode), and it's unlikely we'd see any of the math commands\n  // that affect the behavior of \\dots when in text mode.  So fine for now\n  // (until we support \\ifmmode ... \\else ... \\fi).\n  var thedots = '\\\\dotso';\n  var next = context.expandAfterFuture().text;\n\n  if (next in dotsByToken) {\n    thedots = dotsByToken[next];\n  } else if (next.slice(0, 4) === '\\\\not') {\n    thedots = '\\\\dotsb';\n  } else if (next in symbols.math) {\n    if (utils.contains(['bin', 'rel'], symbols.math[next].group)) {\n      thedots = '\\\\dotsb';\n    }\n  }\n\n  return thedots;\n});\nvar spaceAfterDots = {\n  // \\rightdelim@ checks for the following:\n  ')': true,\n  ']': true,\n  '\\\\rbrack': true,\n  '\\\\}': true,\n  '\\\\rbrace': true,\n  '\\\\rangle': true,\n  '\\\\rceil': true,\n  '\\\\rfloor': true,\n  '\\\\rgroup': true,\n  '\\\\rmoustache': true,\n  '\\\\right': true,\n  '\\\\bigr': true,\n  '\\\\biggr': true,\n  '\\\\Bigr': true,\n  '\\\\Biggr': true,\n  // \\extra@ also tests for the following:\n  '$': true,\n  // \\extrap@ checks for the following:\n  ';': true,\n  '.': true,\n  ',': true\n};\ndefineMacro(\"\\\\dotso\", function (context) {\n  var next = context.future().text;\n\n  if (next in spaceAfterDots) {\n    return \"\\\\ldots\\\\,\";\n  } else {\n    return \"\\\\ldots\";\n  }\n});\ndefineMacro(\"\\\\dotsc\", function (context) {\n  var next = context.future().text; // \\dotsc uses \\extra@ but not \\extrap@, instead specially checking for\n  // ';' and '.', but doesn't check for ','.\n\n  if (next in spaceAfterDots && next !== ',') {\n    return \"\\\\ldots\\\\,\";\n  } else {\n    return \"\\\\ldots\";\n  }\n});\ndefineMacro(\"\\\\cdots\", function (context) {\n  var next = context.future().text;\n\n  if (next in spaceAfterDots) {\n    return \"\\\\@cdots\\\\,\";\n  } else {\n    return \"\\\\@cdots\";\n  }\n});\ndefineMacro(\"\\\\dotsb\", \"\\\\cdots\");\ndefineMacro(\"\\\\dotsm\", \"\\\\cdots\");\ndefineMacro(\"\\\\dotsi\", \"\\\\!\\\\cdots\"); // amsmath doesn't actually define \\dotsx, but \\dots followed by a macro\n// starting with \\DOTSX implies \\dotso, and then \\extra@ detects this case\n// and forces the added `\\,`.\n\ndefineMacro(\"\\\\dotsx\", \"\\\\ldots\\\\,\"); // \\let\\DOTSI\\relax\n// \\let\\DOTSB\\relax\n// \\let\\DOTSX\\relax\n\ndefineMacro(\"\\\\DOTSI\", \"\\\\relax\");\ndefineMacro(\"\\\\DOTSB\", \"\\\\relax\");\ndefineMacro(\"\\\\DOTSX\", \"\\\\relax\"); // Spacing, based on amsmath.sty's override of LaTeX defaults\n// \\DeclareRobustCommand{\\tmspace}[3]{%\n//   \\ifmmode\\mskip#1#2\\else\\kern#1#3\\fi\\relax}\n\ndefineMacro(\"\\\\tmspace\", \"\\\\TextOrMath{\\\\kern#1#3}{\\\\mskip#1#2}\\\\relax\"); // \\renewcommand{\\,}{\\tmspace+\\thinmuskip{.1667em}}\n// TODO: math mode should use \\thinmuskip\n\ndefineMacro(\"\\\\,\", \"\\\\tmspace+{3mu}{.1667em}\"); // \\let\\thinspace\\,\n\ndefineMacro(\"\\\\thinspace\", \"\\\\,\"); // \\def\\>{\\mskip\\medmuskip}\n// \\renewcommand{\\:}{\\tmspace+\\medmuskip{.2222em}}\n// TODO: \\> and math mode of \\: should use \\medmuskip = 4mu plus 2mu minus 4mu\n\ndefineMacro(\"\\\\>\", \"\\\\mskip{4mu}\");\ndefineMacro(\"\\\\:\", \"\\\\tmspace+{4mu}{.2222em}\"); // \\let\\medspace\\:\n\ndefineMacro(\"\\\\medspace\", \"\\\\:\"); // \\renewcommand{\\;}{\\tmspace+\\thickmuskip{.2777em}}\n// TODO: math mode should use \\thickmuskip = 5mu plus 5mu\n\ndefineMacro(\"\\\\;\", \"\\\\tmspace+{5mu}{.2777em}\"); // \\let\\thickspace\\;\n\ndefineMacro(\"\\\\thickspace\", \"\\\\;\"); // \\renewcommand{\\!}{\\tmspace-\\thinmuskip{.1667em}}\n// TODO: math mode should use \\thinmuskip\n\ndefineMacro(\"\\\\!\", \"\\\\tmspace-{3mu}{.1667em}\"); // \\let\\negthinspace\\!\n\ndefineMacro(\"\\\\negthinspace\", \"\\\\!\"); // \\newcommand{\\negmedspace}{\\tmspace-\\medmuskip{.2222em}}\n// TODO: math mode should use \\medmuskip\n\ndefineMacro(\"\\\\negmedspace\", \"\\\\tmspace-{4mu}{.2222em}\"); // \\newcommand{\\negthickspace}{\\tmspace-\\thickmuskip{.2777em}}\n// TODO: math mode should use \\thickmuskip\n\ndefineMacro(\"\\\\negthickspace\", \"\\\\tmspace-{5mu}{.277em}\"); // \\def\\enspace{\\kern.5em }\n\ndefineMacro(\"\\\\enspace\", \"\\\\kern.5em \"); // \\def\\enskip{\\hskip.5em\\relax}\n\ndefineMacro(\"\\\\enskip\", \"\\\\hskip.5em\\\\relax\"); // \\def\\quad{\\hskip1em\\relax}\n\ndefineMacro(\"\\\\quad\", \"\\\\hskip1em\\\\relax\"); // \\def\\qquad{\\hskip2em\\relax}\n\ndefineMacro(\"\\\\qquad\", \"\\\\hskip2em\\\\relax\"); // \\tag@in@display form of \\tag\n\ndefineMacro(\"\\\\tag\", \"\\\\@ifstar\\\\tag@literal\\\\tag@paren\");\ndefineMacro(\"\\\\tag@paren\", \"\\\\tag@literal{({#1})}\");\ndefineMacro(\"\\\\tag@literal\", context => {\n  if (context.macros.get(\"\\\\df@tag\")) {\n    throw new ParseError(\"Multiple \\\\tag\");\n  }\n\n  return \"\\\\gdef\\\\df@tag{\\\\text{#1}}\";\n}); // \\renewcommand{\\bmod}{\\nonscript\\mskip-\\medmuskip\\mkern5mu\\mathbin\n//   {\\operator@font mod}\\penalty900\n//   \\mkern5mu\\nonscript\\mskip-\\medmuskip}\n// \\newcommand{\\pod}[1]{\\allowbreak\n//   \\if@display\\mkern18mu\\else\\mkern8mu\\fi(#1)}\n// \\renewcommand{\\pmod}[1]{\\pod{{\\operator@font mod}\\mkern6mu#1}}\n// \\newcommand{\\mod}[1]{\\allowbreak\\if@display\\mkern18mu\n//   \\else\\mkern12mu\\fi{\\operator@font mod}\\,\\,#1}\n// TODO: math mode should use \\medmuskip = 4mu plus 2mu minus 4mu\n\ndefineMacro(\"\\\\bmod\", \"\\\\mathchoice{\\\\mskip1mu}{\\\\mskip1mu}{\\\\mskip5mu}{\\\\mskip5mu}\" + \"\\\\mathbin{\\\\rm mod}\" + \"\\\\mathchoice{\\\\mskip1mu}{\\\\mskip1mu}{\\\\mskip5mu}{\\\\mskip5mu}\");\ndefineMacro(\"\\\\pod\", \"\\\\allowbreak\" + \"\\\\mathchoice{\\\\mkern18mu}{\\\\mkern8mu}{\\\\mkern8mu}{\\\\mkern8mu}(#1)\");\ndefineMacro(\"\\\\pmod\", \"\\\\pod{{\\\\rm mod}\\\\mkern6mu#1}\");\ndefineMacro(\"\\\\mod\", \"\\\\allowbreak\" + \"\\\\mathchoice{\\\\mkern18mu}{\\\\mkern12mu}{\\\\mkern12mu}{\\\\mkern12mu}\" + \"{\\\\rm mod}\\\\,\\\\,#1\"); //////////////////////////////////////////////////////////////////////\n// LaTeX source2e\n// \\expandafter\\let\\expandafter\\@normalcr\n//     \\csname\\expandafter\\@gobble\\string\\\\ \\endcsname\n// \\DeclareRobustCommand\\newline{\\@normalcr\\relax}\n\ndefineMacro(\"\\\\newline\", \"\\\\\\\\\\\\relax\"); // \\def\\TeX{T\\kern-.1667em\\lower.5ex\\hbox{E}\\kern-.125emX\\@}\n// TODO: Doesn't normally work in math mode because \\@ fails.  KaTeX doesn't\n// support \\@ yet, so that's omitted, and we add \\text so that the result\n// doesn't look funny in math mode.\n\ndefineMacro(\"\\\\TeX\", \"\\\\textrm{\\\\html@mathml{\" + \"T\\\\kern-.1667em\\\\raisebox{-.5ex}{E}\\\\kern-.125emX\" + \"}{TeX}}\"); // \\DeclareRobustCommand{\\LaTeX}{L\\kern-.36em%\n//         {\\sbox\\z@ T%\n//          \\vbox to\\ht\\z@{\\hbox{\\check@mathfonts\n//                               \\fontsize\\sf@size\\z@\n//                               \\math@fontsfalse\\selectfont\n//                               A}%\n//                         \\vss}%\n//         }%\n//         \\kern-.15em%\n//         \\TeX}\n// This code aligns the top of the A with the T (from the perspective of TeX's\n// boxes, though visually the A appears to extend above slightly).\n// We compute the corresponding \\raisebox when A is rendered in \\normalsize\n// \\scriptstyle, which has a scale factor of 0.7 (see Options.js).\n\nvar latexRaiseA = makeEm(fontMetricsData['Main-Regular'][\"T\".charCodeAt(0)][1] - 0.7 * fontMetricsData['Main-Regular'][\"A\".charCodeAt(0)][1]);\ndefineMacro(\"\\\\LaTeX\", \"\\\\textrm{\\\\html@mathml{\" + (\"L\\\\kern-.36em\\\\raisebox{\" + latexRaiseA + \"}{\\\\scriptstyle A}\") + \"\\\\kern-.15em\\\\TeX}{LaTeX}}\"); // New KaTeX logo based on tweaking LaTeX logo\n\ndefineMacro(\"\\\\KaTeX\", \"\\\\textrm{\\\\html@mathml{\" + (\"K\\\\kern-.17em\\\\raisebox{\" + latexRaiseA + \"}{\\\\scriptstyle A}\") + \"\\\\kern-.15em\\\\TeX}{KaTeX}}\"); // \\DeclareRobustCommand\\hspace{\\@ifstar\\@hspacer\\@hspace}\n// \\def\\@hspace#1{\\hskip  #1\\relax}\n// \\def\\@hspacer#1{\\vrule \\@width\\z@\\nobreak\n//                 \\hskip #1\\hskip \\z@skip}\n\ndefineMacro(\"\\\\hspace\", \"\\\\@ifstar\\\\@hspacer\\\\@hspace\");\ndefineMacro(\"\\\\@hspace\", \"\\\\hskip #1\\\\relax\");\ndefineMacro(\"\\\\@hspacer\", \"\\\\rule{0pt}{0pt}\\\\hskip #1\\\\relax\"); //////////////////////////////////////////////////////////////////////\n// mathtools.sty\n//\\providecommand\\ordinarycolon{:}\n\ndefineMacro(\"\\\\ordinarycolon\", \":\"); //\\def\\vcentcolon{\\mathrel{\\mathop\\ordinarycolon}}\n//TODO(edemaine): Not yet centered. Fix via \\raisebox or #726\n\ndefineMacro(\"\\\\vcentcolon\", \"\\\\mathrel{\\\\mathop\\\\ordinarycolon}\"); // \\providecommand*\\dblcolon{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}\n\ndefineMacro(\"\\\\dblcolon\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-.9mu}\\\\vcentcolon}}\" + \"{\\\\mathop{\\\\char\\\"2237}}\"); // \\providecommand*\\coloneqq{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}\n\ndefineMacro(\"\\\\coloneqq\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}=}}\" + \"{\\\\mathop{\\\\char\\\"2254}}\"); // ≔\n// \\providecommand*\\Coloneqq{\\dblcolon\\mathrel{\\mkern-1.2mu}=}\n\ndefineMacro(\"\\\\Coloneqq\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}=}}\" + \"{\\\\mathop{\\\\char\\\"2237\\\\char\\\"3d}}\"); // \\providecommand*\\coloneq{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}\n\ndefineMacro(\"\\\\coloneq\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\mathrel{-}}}\" + \"{\\\\mathop{\\\\char\\\"3a\\\\char\\\"2212}}\"); // \\providecommand*\\Coloneq{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}\n\ndefineMacro(\"\\\\Coloneq\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\mathrel{-}}}\" + \"{\\\\mathop{\\\\char\\\"2237\\\\char\\\"2212}}\"); // \\providecommand*\\eqqcolon{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}\n\ndefineMacro(\"\\\\eqqcolon\", \"\\\\html@mathml{\" + \"\\\\mathrel{=\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}}\" + \"{\\\\mathop{\\\\char\\\"2255}}\"); // ≕\n// \\providecommand*\\Eqqcolon{=\\mathrel{\\mkern-1.2mu}\\dblcolon}\n\ndefineMacro(\"\\\\Eqqcolon\", \"\\\\html@mathml{\" + \"\\\\mathrel{=\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}}\" + \"{\\\\mathop{\\\\char\\\"3d\\\\char\\\"2237}}\"); // \\providecommand*\\eqcolon{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}\n\ndefineMacro(\"\\\\eqcolon\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\mathrel{-}\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}}\" + \"{\\\\mathop{\\\\char\\\"2239}}\"); // \\providecommand*\\Eqcolon{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}\n\ndefineMacro(\"\\\\Eqcolon\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\mathrel{-}\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}}\" + \"{\\\\mathop{\\\\char\\\"2212\\\\char\\\"2237}}\"); // \\providecommand*\\colonapprox{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}\n\ndefineMacro(\"\\\\colonapprox\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\approx}}\" + \"{\\\\mathop{\\\\char\\\"3a\\\\char\\\"2248}}\"); // \\providecommand*\\Colonapprox{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}\n\ndefineMacro(\"\\\\Colonapprox\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\approx}}\" + \"{\\\\mathop{\\\\char\\\"2237\\\\char\\\"2248}}\"); // \\providecommand*\\colonsim{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}\n\ndefineMacro(\"\\\\colonsim\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\sim}}\" + \"{\\\\mathop{\\\\char\\\"3a\\\\char\\\"223c}}\"); // \\providecommand*\\Colonsim{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}\n\ndefineMacro(\"\\\\Colonsim\", \"\\\\html@mathml{\" + \"\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\sim}}\" + \"{\\\\mathop{\\\\char\\\"2237\\\\char\\\"223c}}\"); // Some Unicode characters are implemented with macros to mathtools functions.\n\ndefineMacro(\"\\u2237\", \"\\\\dblcolon\"); // ::\n\ndefineMacro(\"\\u2239\", \"\\\\eqcolon\"); // -:\n\ndefineMacro(\"\\u2254\", \"\\\\coloneqq\"); // :=\n\ndefineMacro(\"\\u2255\", \"\\\\eqqcolon\"); // =:\n\ndefineMacro(\"\\u2A74\", \"\\\\Coloneqq\"); // ::=\n//////////////////////////////////////////////////////////////////////\n// colonequals.sty\n// Alternate names for mathtools's macros:\n\ndefineMacro(\"\\\\ratio\", \"\\\\vcentcolon\");\ndefineMacro(\"\\\\coloncolon\", \"\\\\dblcolon\");\ndefineMacro(\"\\\\colonequals\", \"\\\\coloneqq\");\ndefineMacro(\"\\\\coloncolonequals\", \"\\\\Coloneqq\");\ndefineMacro(\"\\\\equalscolon\", \"\\\\eqqcolon\");\ndefineMacro(\"\\\\equalscoloncolon\", \"\\\\Eqqcolon\");\ndefineMacro(\"\\\\colonminus\", \"\\\\coloneq\");\ndefineMacro(\"\\\\coloncolonminus\", \"\\\\Coloneq\");\ndefineMacro(\"\\\\minuscolon\", \"\\\\eqcolon\");\ndefineMacro(\"\\\\minuscoloncolon\", \"\\\\Eqcolon\"); // \\colonapprox name is same in mathtools and colonequals.\n\ndefineMacro(\"\\\\coloncolonapprox\", \"\\\\Colonapprox\"); // \\colonsim name is same in mathtools and colonequals.\n\ndefineMacro(\"\\\\coloncolonsim\", \"\\\\Colonsim\"); // Additional macros, implemented by analogy with mathtools definitions:\n\ndefineMacro(\"\\\\simcolon\", \"\\\\mathrel{\\\\sim\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}\");\ndefineMacro(\"\\\\simcoloncolon\", \"\\\\mathrel{\\\\sim\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}\");\ndefineMacro(\"\\\\approxcolon\", \"\\\\mathrel{\\\\approx\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}\");\ndefineMacro(\"\\\\approxcoloncolon\", \"\\\\mathrel{\\\\approx\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}\"); // Present in newtxmath, pxfonts and txfonts\n\ndefineMacro(\"\\\\notni\", \"\\\\html@mathml{\\\\not\\\\ni}{\\\\mathrel{\\\\char`\\u220C}}\");\ndefineMacro(\"\\\\limsup\", \"\\\\DOTSB\\\\operatorname*{lim\\\\,sup}\");\ndefineMacro(\"\\\\liminf\", \"\\\\DOTSB\\\\operatorname*{lim\\\\,inf}\"); //////////////////////////////////////////////////////////////////////\n// From amsopn.sty\n\ndefineMacro(\"\\\\injlim\", \"\\\\DOTSB\\\\operatorname*{inj\\\\,lim}\");\ndefineMacro(\"\\\\projlim\", \"\\\\DOTSB\\\\operatorname*{proj\\\\,lim}\");\ndefineMacro(\"\\\\varlimsup\", \"\\\\DOTSB\\\\operatorname*{\\\\overline{lim}}\");\ndefineMacro(\"\\\\varliminf\", \"\\\\DOTSB\\\\operatorname*{\\\\underline{lim}}\");\ndefineMacro(\"\\\\varinjlim\", \"\\\\DOTSB\\\\operatorname*{\\\\underrightarrow{lim}}\");\ndefineMacro(\"\\\\varprojlim\", \"\\\\DOTSB\\\\operatorname*{\\\\underleftarrow{lim}}\"); //////////////////////////////////////////////////////////////////////\n// MathML alternates for KaTeX glyphs in the Unicode private area\n\ndefineMacro(\"\\\\gvertneqq\", \"\\\\html@mathml{\\\\@gvertneqq}{\\u2269}\");\ndefineMacro(\"\\\\lvertneqq\", \"\\\\html@mathml{\\\\@lvertneqq}{\\u2268}\");\ndefineMacro(\"\\\\ngeqq\", \"\\\\html@mathml{\\\\@ngeqq}{\\u2271}\");\ndefineMacro(\"\\\\ngeqslant\", \"\\\\html@mathml{\\\\@ngeqslant}{\\u2271}\");\ndefineMacro(\"\\\\nleqq\", \"\\\\html@mathml{\\\\@nleqq}{\\u2270}\");\ndefineMacro(\"\\\\nleqslant\", \"\\\\html@mathml{\\\\@nleqslant}{\\u2270}\");\ndefineMacro(\"\\\\nshortmid\", \"\\\\html@mathml{\\\\@nshortmid}{∤}\");\ndefineMacro(\"\\\\nshortparallel\", \"\\\\html@mathml{\\\\@nshortparallel}{∦}\");\ndefineMacro(\"\\\\nsubseteqq\", \"\\\\html@mathml{\\\\@nsubseteqq}{\\u2288}\");\ndefineMacro(\"\\\\nsupseteqq\", \"\\\\html@mathml{\\\\@nsupseteqq}{\\u2289}\");\ndefineMacro(\"\\\\varsubsetneq\", \"\\\\html@mathml{\\\\@varsubsetneq}{⊊}\");\ndefineMacro(\"\\\\varsubsetneqq\", \"\\\\html@mathml{\\\\@varsubsetneqq}{⫋}\");\ndefineMacro(\"\\\\varsupsetneq\", \"\\\\html@mathml{\\\\@varsupsetneq}{⊋}\");\ndefineMacro(\"\\\\varsupsetneqq\", \"\\\\html@mathml{\\\\@varsupsetneqq}{⫌}\");\ndefineMacro(\"\\\\imath\", \"\\\\html@mathml{\\\\@imath}{\\u0131}\");\ndefineMacro(\"\\\\jmath\", \"\\\\html@mathml{\\\\@jmath}{\\u0237}\"); //////////////////////////////////////////////////////////////////////\n// stmaryrd and semantic\n// The stmaryrd and semantic packages render the next four items by calling a\n// glyph. Those glyphs do not exist in the KaTeX fonts. Hence the macros.\n\ndefineMacro(\"\\\\llbracket\", \"\\\\html@mathml{\" + \"\\\\mathopen{[\\\\mkern-3.2mu[}}\" + \"{\\\\mathopen{\\\\char`\\u27e6}}\");\ndefineMacro(\"\\\\rrbracket\", \"\\\\html@mathml{\" + \"\\\\mathclose{]\\\\mkern-3.2mu]}}\" + \"{\\\\mathclose{\\\\char`\\u27e7}}\");\ndefineMacro(\"\\u27e6\", \"\\\\llbracket\"); // blackboard bold [\n\ndefineMacro(\"\\u27e7\", \"\\\\rrbracket\"); // blackboard bold ]\n\ndefineMacro(\"\\\\lBrace\", \"\\\\html@mathml{\" + \"\\\\mathopen{\\\\{\\\\mkern-3.2mu[}}\" + \"{\\\\mathopen{\\\\char`\\u2983}}\");\ndefineMacro(\"\\\\rBrace\", \"\\\\html@mathml{\" + \"\\\\mathclose{]\\\\mkern-3.2mu\\\\}}}\" + \"{\\\\mathclose{\\\\char`\\u2984}}\");\ndefineMacro(\"\\u2983\", \"\\\\lBrace\"); // blackboard bold {\n\ndefineMacro(\"\\u2984\", \"\\\\rBrace\"); // blackboard bold }\n// TODO: Create variable sized versions of the last two items. I believe that\n// will require new font glyphs.\n// The stmaryrd function `\\minuso` provides a \"Plimsoll\" symbol that\n// superimposes the characters \\circ and \\mathminus. Used in chemistry.\n\ndefineMacro(\"\\\\minuso\", \"\\\\mathbin{\\\\html@mathml{\" + \"{\\\\mathrlap{\\\\mathchoice{\\\\kern{0.145em}}{\\\\kern{0.145em}}\" + \"{\\\\kern{0.1015em}}{\\\\kern{0.0725em}}\\\\circ}{-}}}\" + \"{\\\\char`⦵}}\");\ndefineMacro(\"⦵\", \"\\\\minuso\"); //////////////////////////////////////////////////////////////////////\n// texvc.sty\n// The texvc package contains macros available in mediawiki pages.\n// We omit the functions deprecated at\n// https://en.wikipedia.org/wiki/Help:Displaying_a_formula#Deprecated_syntax\n// We also omit texvc's \\O, which conflicts with \\text{\\O}\n\ndefineMacro(\"\\\\darr\", \"\\\\downarrow\");\ndefineMacro(\"\\\\dArr\", \"\\\\Downarrow\");\ndefineMacro(\"\\\\Darr\", \"\\\\Downarrow\");\ndefineMacro(\"\\\\lang\", \"\\\\langle\");\ndefineMacro(\"\\\\rang\", \"\\\\rangle\");\ndefineMacro(\"\\\\uarr\", \"\\\\uparrow\");\ndefineMacro(\"\\\\uArr\", \"\\\\Uparrow\");\ndefineMacro(\"\\\\Uarr\", \"\\\\Uparrow\");\ndefineMacro(\"\\\\N\", \"\\\\mathbb{N}\");\ndefineMacro(\"\\\\R\", \"\\\\mathbb{R}\");\ndefineMacro(\"\\\\Z\", \"\\\\mathbb{Z}\");\ndefineMacro(\"\\\\alef\", \"\\\\aleph\");\ndefineMacro(\"\\\\alefsym\", \"\\\\aleph\");\ndefineMacro(\"\\\\Alpha\", \"\\\\mathrm{A}\");\ndefineMacro(\"\\\\Beta\", \"\\\\mathrm{B}\");\ndefineMacro(\"\\\\bull\", \"\\\\bullet\");\ndefineMacro(\"\\\\Chi\", \"\\\\mathrm{X}\");\ndefineMacro(\"\\\\clubs\", \"\\\\clubsuit\");\ndefineMacro(\"\\\\cnums\", \"\\\\mathbb{C}\");\ndefineMacro(\"\\\\Complex\", \"\\\\mathbb{C}\");\ndefineMacro(\"\\\\Dagger\", \"\\\\ddagger\");\ndefineMacro(\"\\\\diamonds\", \"\\\\diamondsuit\");\ndefineMacro(\"\\\\empty\", \"\\\\emptyset\");\ndefineMacro(\"\\\\Epsilon\", \"\\\\mathrm{E}\");\ndefineMacro(\"\\\\Eta\", \"\\\\mathrm{H}\");\ndefineMacro(\"\\\\exist\", \"\\\\exists\");\ndefineMacro(\"\\\\harr\", \"\\\\leftrightarrow\");\ndefineMacro(\"\\\\hArr\", \"\\\\Leftrightarrow\");\ndefineMacro(\"\\\\Harr\", \"\\\\Leftrightarrow\");\ndefineMacro(\"\\\\hearts\", \"\\\\heartsuit\");\ndefineMacro(\"\\\\image\", \"\\\\Im\");\ndefineMacro(\"\\\\infin\", \"\\\\infty\");\ndefineMacro(\"\\\\Iota\", \"\\\\mathrm{I}\");\ndefineMacro(\"\\\\isin\", \"\\\\in\");\ndefineMacro(\"\\\\Kappa\", \"\\\\mathrm{K}\");\ndefineMacro(\"\\\\larr\", \"\\\\leftarrow\");\ndefineMacro(\"\\\\lArr\", \"\\\\Leftarrow\");\ndefineMacro(\"\\\\Larr\", \"\\\\Leftarrow\");\ndefineMacro(\"\\\\lrarr\", \"\\\\leftrightarrow\");\ndefineMacro(\"\\\\lrArr\", \"\\\\Leftrightarrow\");\ndefineMacro(\"\\\\Lrarr\", \"\\\\Leftrightarrow\");\ndefineMacro(\"\\\\Mu\", \"\\\\mathrm{M}\");\ndefineMacro(\"\\\\natnums\", \"\\\\mathbb{N}\");\ndefineMacro(\"\\\\Nu\", \"\\\\mathrm{N}\");\ndefineMacro(\"\\\\Omicron\", \"\\\\mathrm{O}\");\ndefineMacro(\"\\\\plusmn\", \"\\\\pm\");\ndefineMacro(\"\\\\rarr\", \"\\\\rightarrow\");\ndefineMacro(\"\\\\rArr\", \"\\\\Rightarrow\");\ndefineMacro(\"\\\\Rarr\", \"\\\\Rightarrow\");\ndefineMacro(\"\\\\real\", \"\\\\Re\");\ndefineMacro(\"\\\\reals\", \"\\\\mathbb{R}\");\ndefineMacro(\"\\\\Reals\", \"\\\\mathbb{R}\");\ndefineMacro(\"\\\\Rho\", \"\\\\mathrm{P}\");\ndefineMacro(\"\\\\sdot\", \"\\\\cdot\");\ndefineMacro(\"\\\\sect\", \"\\\\S\");\ndefineMacro(\"\\\\spades\", \"\\\\spadesuit\");\ndefineMacro(\"\\\\sub\", \"\\\\subset\");\ndefineMacro(\"\\\\sube\", \"\\\\subseteq\");\ndefineMacro(\"\\\\supe\", \"\\\\supseteq\");\ndefineMacro(\"\\\\Tau\", \"\\\\mathrm{T}\");\ndefineMacro(\"\\\\thetasym\", \"\\\\vartheta\"); // TODO: defineMacro(\"\\\\varcoppa\", \"\\\\\\mbox{\\\\coppa}\");\n\ndefineMacro(\"\\\\weierp\", \"\\\\wp\");\ndefineMacro(\"\\\\Zeta\", \"\\\\mathrm{Z}\"); //////////////////////////////////////////////////////////////////////\n// statmath.sty\n// https://ctan.math.illinois.edu/macros/latex/contrib/statmath/statmath.pdf\n\ndefineMacro(\"\\\\argmin\", \"\\\\DOTSB\\\\operatorname*{arg\\\\,min}\");\ndefineMacro(\"\\\\argmax\", \"\\\\DOTSB\\\\operatorname*{arg\\\\,max}\");\ndefineMacro(\"\\\\plim\", \"\\\\DOTSB\\\\mathop{\\\\operatorname{plim}}\\\\limits\"); //////////////////////////////////////////////////////////////////////\n// braket.sty\n// http://ctan.math.washington.edu/tex-archive/macros/latex/contrib/braket/braket.pdf\n\ndefineMacro(\"\\\\bra\", \"\\\\mathinner{\\\\langle{#1}|}\");\ndefineMacro(\"\\\\ket\", \"\\\\mathinner{|{#1}\\\\rangle}\");\ndefineMacro(\"\\\\braket\", \"\\\\mathinner{\\\\langle{#1}\\\\rangle}\");\ndefineMacro(\"\\\\Bra\", \"\\\\left\\\\langle#1\\\\right|\");\ndefineMacro(\"\\\\Ket\", \"\\\\left|#1\\\\right\\\\rangle\");\n\nvar braketHelper = one => context => {\n  var left = context.consumeArg().tokens;\n  var middle = context.consumeArg().tokens;\n  var middleDouble = context.consumeArg().tokens;\n  var right = context.consumeArg().tokens;\n  var oldMiddle = context.macros.get(\"|\");\n  var oldMiddleDouble = context.macros.get(\"\\\\|\");\n  context.macros.beginGroup();\n\n  var midMacro = double => context => {\n    if (one) {\n      // Only modify the first instance of | or \\|\n      context.macros.set(\"|\", oldMiddle);\n\n      if (middleDouble.length) {\n        context.macros.set(\"\\\\|\", oldMiddleDouble);\n      }\n    }\n\n    var doubled = double;\n\n    if (!double && middleDouble.length) {\n      // Mimic \\@ifnextchar\n      var nextToken = context.future();\n\n      if (nextToken.text === \"|\") {\n        context.popToken();\n        doubled = true;\n      }\n    }\n\n    return {\n      tokens: doubled ? middleDouble : middle,\n      numArgs: 0\n    };\n  };\n\n  context.macros.set(\"|\", midMacro(false));\n\n  if (middleDouble.length) {\n    context.macros.set(\"\\\\|\", midMacro(true));\n  }\n\n  var arg = context.consumeArg().tokens;\n  var expanded = context.expandTokens([...right, ...arg, ...left // reversed\n  ]);\n  context.macros.endGroup();\n  return {\n    tokens: expanded.reverse(),\n    numArgs: 0\n  };\n};\n\ndefineMacro(\"\\\\bra@ket\", braketHelper(false));\ndefineMacro(\"\\\\bra@set\", braketHelper(true));\ndefineMacro(\"\\\\Braket\", \"\\\\bra@ket{\\\\left\\\\langle}\" + \"{\\\\,\\\\middle\\\\vert\\\\,}{\\\\,\\\\middle\\\\vert\\\\,}{\\\\right\\\\rangle}\");\ndefineMacro(\"\\\\Set\", \"\\\\bra@set{\\\\left\\\\{\\\\:}\" + \"{\\\\;\\\\middle\\\\vert\\\\;}{\\\\;\\\\middle\\\\Vert\\\\;}{\\\\:\\\\right\\\\}}\");\ndefineMacro(\"\\\\set\", \"\\\\bra@set{\\\\{\\\\,}{\\\\mid}{}{\\\\,\\\\}}\"); // has no support for special || or \\|\n//////////////////////////////////////////////////////////////////////\n// actuarialangle.dtx\n\ndefineMacro(\"\\\\angln\", \"{\\\\angl n}\"); // Custom Khan Academy colors, should be moved to an optional package\n\ndefineMacro(\"\\\\blue\", \"\\\\textcolor{##6495ed}{#1}\");\ndefineMacro(\"\\\\orange\", \"\\\\textcolor{##ffa500}{#1}\");\ndefineMacro(\"\\\\pink\", \"\\\\textcolor{##ff00af}{#1}\");\ndefineMacro(\"\\\\red\", \"\\\\textcolor{##df0030}{#1}\");\ndefineMacro(\"\\\\green\", \"\\\\textcolor{##28ae7b}{#1}\");\ndefineMacro(\"\\\\gray\", \"\\\\textcolor{gray}{#1}\");\ndefineMacro(\"\\\\purple\", \"\\\\textcolor{##9d38bd}{#1}\");\ndefineMacro(\"\\\\blueA\", \"\\\\textcolor{##ccfaff}{#1}\");\ndefineMacro(\"\\\\blueB\", \"\\\\textcolor{##80f6ff}{#1}\");\ndefineMacro(\"\\\\blueC\", \"\\\\textcolor{##63d9ea}{#1}\");\ndefineMacro(\"\\\\blueD\", \"\\\\textcolor{##11accd}{#1}\");\ndefineMacro(\"\\\\blueE\", \"\\\\textcolor{##0c7f99}{#1}\");\ndefineMacro(\"\\\\tealA\", \"\\\\textcolor{##94fff5}{#1}\");\ndefineMacro(\"\\\\tealB\", \"\\\\textcolor{##26edd5}{#1}\");\ndefineMacro(\"\\\\tealC\", \"\\\\textcolor{##01d1c1}{#1}\");\ndefineMacro(\"\\\\tealD\", \"\\\\textcolor{##01a995}{#1}\");\ndefineMacro(\"\\\\tealE\", \"\\\\textcolor{##208170}{#1}\");\ndefineMacro(\"\\\\greenA\", \"\\\\textcolor{##b6ffb0}{#1}\");\ndefineMacro(\"\\\\greenB\", \"\\\\textcolor{##8af281}{#1}\");\ndefineMacro(\"\\\\greenC\", \"\\\\textcolor{##74cf70}{#1}\");\ndefineMacro(\"\\\\greenD\", \"\\\\textcolor{##1fab54}{#1}\");\ndefineMacro(\"\\\\greenE\", \"\\\\textcolor{##0d923f}{#1}\");\ndefineMacro(\"\\\\goldA\", \"\\\\textcolor{##ffd0a9}{#1}\");\ndefineMacro(\"\\\\goldB\", \"\\\\textcolor{##ffbb71}{#1}\");\ndefineMacro(\"\\\\goldC\", \"\\\\textcolor{##ff9c39}{#1}\");\ndefineMacro(\"\\\\goldD\", \"\\\\textcolor{##e07d10}{#1}\");\ndefineMacro(\"\\\\goldE\", \"\\\\textcolor{##a75a05}{#1}\");\ndefineMacro(\"\\\\redA\", \"\\\\textcolor{##fca9a9}{#1}\");\ndefineMacro(\"\\\\redB\", \"\\\\textcolor{##ff8482}{#1}\");\ndefineMacro(\"\\\\redC\", \"\\\\textcolor{##f9685d}{#1}\");\ndefineMacro(\"\\\\redD\", \"\\\\textcolor{##e84d39}{#1}\");\ndefineMacro(\"\\\\redE\", \"\\\\textcolor{##bc2612}{#1}\");\ndefineMacro(\"\\\\maroonA\", \"\\\\textcolor{##ffbde0}{#1}\");\ndefineMacro(\"\\\\maroonB\", \"\\\\textcolor{##ff92c6}{#1}\");\ndefineMacro(\"\\\\maroonC\", \"\\\\textcolor{##ed5fa6}{#1}\");\ndefineMacro(\"\\\\maroonD\", \"\\\\textcolor{##ca337c}{#1}\");\ndefineMacro(\"\\\\maroonE\", \"\\\\textcolor{##9e034e}{#1}\");\ndefineMacro(\"\\\\purpleA\", \"\\\\textcolor{##ddd7ff}{#1}\");\ndefineMacro(\"\\\\purpleB\", \"\\\\textcolor{##c6b9fc}{#1}\");\ndefineMacro(\"\\\\purpleC\", \"\\\\textcolor{##aa87ff}{#1}\");\ndefineMacro(\"\\\\purpleD\", \"\\\\textcolor{##7854ab}{#1}\");\ndefineMacro(\"\\\\purpleE\", \"\\\\textcolor{##543b78}{#1}\");\ndefineMacro(\"\\\\mintA\", \"\\\\textcolor{##f5f9e8}{#1}\");\ndefineMacro(\"\\\\mintB\", \"\\\\textcolor{##edf2df}{#1}\");\ndefineMacro(\"\\\\mintC\", \"\\\\textcolor{##e0e5cc}{#1}\");\ndefineMacro(\"\\\\grayA\", \"\\\\textcolor{##f6f7f7}{#1}\");\ndefineMacro(\"\\\\grayB\", \"\\\\textcolor{##f0f1f2}{#1}\");\ndefineMacro(\"\\\\grayC\", \"\\\\textcolor{##e3e5e6}{#1}\");\ndefineMacro(\"\\\\grayD\", \"\\\\textcolor{##d6d8da}{#1}\");\ndefineMacro(\"\\\\grayE\", \"\\\\textcolor{##babec2}{#1}\");\ndefineMacro(\"\\\\grayF\", \"\\\\textcolor{##888d93}{#1}\");\ndefineMacro(\"\\\\grayG\", \"\\\\textcolor{##626569}{#1}\");\ndefineMacro(\"\\\\grayH\", \"\\\\textcolor{##3b3e40}{#1}\");\ndefineMacro(\"\\\\grayI\", \"\\\\textcolor{##21242c}{#1}\");\ndefineMacro(\"\\\\kaBlue\", \"\\\\textcolor{##314453}{#1}\");\ndefineMacro(\"\\\\kaGreen\", \"\\\\textcolor{##71B307}{#1}\");\n\n/**\n * This file contains the “gullet” where macros are expanded\n * until only non-macro tokens remain.\n */\n// List of commands that act like macros but aren't defined as a macro,\n// function, or symbol.  Used in `isDefined`.\nvar implicitCommands = {\n  \"^\": true,\n  // Parser.js\n  \"_\": true,\n  // Parser.js\n  \"\\\\limits\": true,\n  // Parser.js\n  \"\\\\nolimits\": true // Parser.js\n\n};\nclass MacroExpander {\n  constructor(input, settings, mode) {\n    this.settings = void 0;\n    this.expansionCount = void 0;\n    this.lexer = void 0;\n    this.macros = void 0;\n    this.stack = void 0;\n    this.mode = void 0;\n    this.settings = settings;\n    this.expansionCount = 0;\n    this.feed(input); // Make new global namespace\n\n    this.macros = new Namespace(macros, settings.macros);\n    this.mode = mode;\n    this.stack = []; // contains tokens in REVERSE order\n  }\n  /**\n   * Feed a new input string to the same MacroExpander\n   * (with existing macros etc.).\n   */\n\n\n  feed(input) {\n    this.lexer = new Lexer(input, this.settings);\n  }\n  /**\n   * Switches between \"text\" and \"math\" modes.\n   */\n\n\n  switchMode(newMode) {\n    this.mode = newMode;\n  }\n  /**\n   * Start a new group nesting within all namespaces.\n   */\n\n\n  beginGroup() {\n    this.macros.beginGroup();\n  }\n  /**\n   * End current group nesting within all namespaces.\n   */\n\n\n  endGroup() {\n    this.macros.endGroup();\n  }\n  /**\n   * Ends all currently nested groups (if any), restoring values before the\n   * groups began.  Useful in case of an error in the middle of parsing.\n   */\n\n\n  endGroups() {\n    this.macros.endGroups();\n  }\n  /**\n   * Returns the topmost token on the stack, without expanding it.\n   * Similar in behavior to TeX's `\\futurelet`.\n   */\n\n\n  future() {\n    if (this.stack.length === 0) {\n      this.pushToken(this.lexer.lex());\n    }\n\n    return this.stack[this.stack.length - 1];\n  }\n  /**\n   * Remove and return the next unexpanded token.\n   */\n\n\n  popToken() {\n    this.future(); // ensure non-empty stack\n\n    return this.stack.pop();\n  }\n  /**\n   * Add a given token to the token stack.  In particular, this get be used\n   * to put back a token returned from one of the other methods.\n   */\n\n\n  pushToken(token) {\n    this.stack.push(token);\n  }\n  /**\n   * Append an array of tokens to the token stack.\n   */\n\n\n  pushTokens(tokens) {\n    this.stack.push(...tokens);\n  }\n  /**\n   * Find an macro argument without expanding tokens and append the array of\n   * tokens to the token stack. Uses Token as a container for the result.\n   */\n\n\n  scanArgument(isOptional) {\n    var start;\n    var end;\n    var tokens;\n\n    if (isOptional) {\n      this.consumeSpaces(); // \\@ifnextchar gobbles any space following it\n\n      if (this.future().text !== \"[\") {\n        return null;\n      }\n\n      start = this.popToken(); // don't include [ in tokens\n\n      ({\n        tokens,\n        end\n      } = this.consumeArg([\"]\"]));\n    } else {\n      ({\n        tokens,\n        start,\n        end\n      } = this.consumeArg());\n    } // indicate the end of an argument\n\n\n    this.pushToken(new Token(\"EOF\", end.loc));\n    this.pushTokens(tokens);\n    return start.range(end, \"\");\n  }\n  /**\n   * Consume all following space tokens, without expansion.\n   */\n\n\n  consumeSpaces() {\n    for (;;) {\n      var token = this.future();\n\n      if (token.text === \" \") {\n        this.stack.pop();\n      } else {\n        break;\n      }\n    }\n  }\n  /**\n   * Consume an argument from the token stream, and return the resulting array\n   * of tokens and start/end token.\n   */\n\n\n  consumeArg(delims) {\n    // The argument for a delimited parameter is the shortest (possibly\n    // empty) sequence of tokens with properly nested {...} groups that is\n    // followed ... by this particular list of non-parameter tokens.\n    // The argument for an undelimited parameter is the next nonblank\n    // token, unless that token is ‘{’, when the argument will be the\n    // entire {...} group that follows.\n    var tokens = [];\n    var isDelimited = delims && delims.length > 0;\n\n    if (!isDelimited) {\n      // Ignore spaces between arguments.  As the TeXbook says:\n      // \"After you have said ‘\\def\\row#1#2{...}’, you are allowed to\n      //  put spaces between the arguments (e.g., ‘\\row x n’), because\n      //  TeX doesn’t use single spaces as undelimited arguments.\"\n      this.consumeSpaces();\n    }\n\n    var start = this.future();\n    var tok;\n    var depth = 0;\n    var match = 0;\n\n    do {\n      tok = this.popToken();\n      tokens.push(tok);\n\n      if (tok.text === \"{\") {\n        ++depth;\n      } else if (tok.text === \"}\") {\n        --depth;\n\n        if (depth === -1) {\n          throw new ParseError(\"Extra }\", tok);\n        }\n      } else if (tok.text === \"EOF\") {\n        throw new ParseError(\"Unexpected end of input in a macro argument\" + \", expected '\" + (delims && isDelimited ? delims[match] : \"}\") + \"'\", tok);\n      }\n\n      if (delims && isDelimited) {\n        if ((depth === 0 || depth === 1 && delims[match] === \"{\") && tok.text === delims[match]) {\n          ++match;\n\n          if (match === delims.length) {\n            // don't include delims in tokens\n            tokens.splice(-match, match);\n            break;\n          }\n        } else {\n          match = 0;\n        }\n      }\n    } while (depth !== 0 || isDelimited); // If the argument found ... has the form ‘{<nested tokens>}’,\n    // ... the outermost braces enclosing the argument are removed\n\n\n    if (start.text === \"{\" && tokens[tokens.length - 1].text === \"}\") {\n      tokens.pop();\n      tokens.shift();\n    }\n\n    tokens.reverse(); // to fit in with stack order\n\n    return {\n      tokens,\n      start,\n      end: tok\n    };\n  }\n  /**\n   * Consume the specified number of (delimited) arguments from the token\n   * stream and return the resulting array of arguments.\n   */\n\n\n  consumeArgs(numArgs, delimiters) {\n    if (delimiters) {\n      if (delimiters.length !== numArgs + 1) {\n        throw new ParseError(\"The length of delimiters doesn't match the number of args!\");\n      }\n\n      var delims = delimiters[0];\n\n      for (var i = 0; i < delims.length; i++) {\n        var tok = this.popToken();\n\n        if (delims[i] !== tok.text) {\n          throw new ParseError(\"Use of the macro doesn't match its definition\", tok);\n        }\n      }\n    }\n\n    var args = [];\n\n    for (var _i = 0; _i < numArgs; _i++) {\n      args.push(this.consumeArg(delimiters && delimiters[_i + 1]).tokens);\n    }\n\n    return args;\n  }\n  /**\n   * Increment `expansionCount` by the specified amount.\n   * Throw an error if it exceeds `maxExpand`.\n   */\n\n\n  countExpansion(amount) {\n    this.expansionCount += amount;\n\n    if (this.expansionCount > this.settings.maxExpand) {\n      throw new ParseError(\"Too many expansions: infinite loop or \" + \"need to increase maxExpand setting\");\n    }\n  }\n  /**\n   * Expand the next token only once if possible.\n   *\n   * If the token is expanded, the resulting tokens will be pushed onto\n   * the stack in reverse order, and the number of such tokens will be\n   * returned.  This number might be zero or positive.\n   *\n   * If not, the return value is `false`, and the next token remains at the\n   * top of the stack.\n   *\n   * In either case, the next token will be on the top of the stack,\n   * or the stack will be empty (in case of empty expansion\n   * and no other tokens).\n   *\n   * Used to implement `expandAfterFuture` and `expandNextToken`.\n   *\n   * If expandableOnly, only expandable tokens are expanded and\n   * an undefined control sequence results in an error.\n   */\n\n\n  expandOnce(expandableOnly) {\n    var topToken = this.popToken();\n    var name = topToken.text;\n    var expansion = !topToken.noexpand ? this._getExpansion(name) : null;\n\n    if (expansion == null || expandableOnly && expansion.unexpandable) {\n      if (expandableOnly && expansion == null && name[0] === \"\\\\\" && !this.isDefined(name)) {\n        throw new ParseError(\"Undefined control sequence: \" + name);\n      }\n\n      this.pushToken(topToken);\n      return false;\n    }\n\n    this.countExpansion(1);\n    var tokens = expansion.tokens;\n    var args = this.consumeArgs(expansion.numArgs, expansion.delimiters);\n\n    if (expansion.numArgs) {\n      // paste arguments in place of the placeholders\n      tokens = tokens.slice(); // make a shallow copy\n\n      for (var i = tokens.length - 1; i >= 0; --i) {\n        var tok = tokens[i];\n\n        if (tok.text === \"#\") {\n          if (i === 0) {\n            throw new ParseError(\"Incomplete placeholder at end of macro body\", tok);\n          }\n\n          tok = tokens[--i]; // next token on stack\n\n          if (tok.text === \"#\") {\n            // ## → #\n            tokens.splice(i + 1, 1); // drop first #\n          } else if (/^[1-9]$/.test(tok.text)) {\n            // replace the placeholder with the indicated argument\n            tokens.splice(i, 2, ...args[+tok.text - 1]);\n          } else {\n            throw new ParseError(\"Not a valid argument number\", tok);\n          }\n        }\n      }\n    } // Concatenate expansion onto top of stack.\n\n\n    this.pushTokens(tokens);\n    return tokens.length;\n  }\n  /**\n   * Expand the next token only once (if possible), and return the resulting\n   * top token on the stack (without removing anything from the stack).\n   * Similar in behavior to TeX's `\\expandafter\\futurelet`.\n   * Equivalent to expandOnce() followed by future().\n   */\n\n\n  expandAfterFuture() {\n    this.expandOnce();\n    return this.future();\n  }\n  /**\n   * Recursively expand first token, then return first non-expandable token.\n   */\n\n\n  expandNextToken() {\n    for (;;) {\n      if (this.expandOnce() === false) {\n        // fully expanded\n        var token = this.stack.pop(); // the token after \\noexpand is interpreted as if its meaning\n        // were ‘\\relax’\n\n        if (token.treatAsRelax) {\n          token.text = \"\\\\relax\";\n        }\n\n        return token;\n      }\n    } // Flow unable to figure out that this pathway is impossible.\n    // https://github.com/facebook/flow/issues/4808\n\n\n    throw new Error(); // eslint-disable-line no-unreachable\n  }\n  /**\n   * Fully expand the given macro name and return the resulting list of\n   * tokens, or return `undefined` if no such macro is defined.\n   */\n\n\n  expandMacro(name) {\n    return this.macros.has(name) ? this.expandTokens([new Token(name)]) : undefined;\n  }\n  /**\n   * Fully expand the given token stream and return the resulting list of\n   * tokens.  Note that the input tokens are in reverse order, but the\n   * output tokens are in forward order.\n   */\n\n\n  expandTokens(tokens) {\n    var output = [];\n    var oldStackLength = this.stack.length;\n    this.pushTokens(tokens);\n\n    while (this.stack.length > oldStackLength) {\n      // Expand only expandable tokens\n      if (this.expandOnce(true) === false) {\n        // fully expanded\n        var token = this.stack.pop();\n\n        if (token.treatAsRelax) {\n          // the expansion of \\noexpand is the token itself\n          token.noexpand = false;\n          token.treatAsRelax = false;\n        }\n\n        output.push(token);\n      }\n    } // Count all of these tokens as additional expansions, to prevent\n    // exponential blowup from linearly many \\edef's.\n\n\n    this.countExpansion(output.length);\n    return output;\n  }\n  /**\n   * Fully expand the given macro name and return the result as a string,\n   * or return `undefined` if no such macro is defined.\n   */\n\n\n  expandMacroAsText(name) {\n    var tokens = this.expandMacro(name);\n\n    if (tokens) {\n      return tokens.map(token => token.text).join(\"\");\n    } else {\n      return tokens;\n    }\n  }\n  /**\n   * Returns the expanded macro as a reversed array of tokens and a macro\n   * argument count.  Or returns `null` if no such macro.\n   */\n\n\n  _getExpansion(name) {\n    var definition = this.macros.get(name);\n\n    if (definition == null) {\n      // mainly checking for undefined here\n      return definition;\n    } // If a single character has an associated catcode other than 13\n    // (active character), then don't expand it.\n\n\n    if (name.length === 1) {\n      var catcode = this.lexer.catcodes[name];\n\n      if (catcode != null && catcode !== 13) {\n        return;\n      }\n    }\n\n    var expansion = typeof definition === \"function\" ? definition(this) : definition;\n\n    if (typeof expansion === \"string\") {\n      var numArgs = 0;\n\n      if (expansion.indexOf(\"#\") !== -1) {\n        var stripped = expansion.replace(/##/g, \"\");\n\n        while (stripped.indexOf(\"#\" + (numArgs + 1)) !== -1) {\n          ++numArgs;\n        }\n      }\n\n      var bodyLexer = new Lexer(expansion, this.settings);\n      var tokens = [];\n      var tok = bodyLexer.lex();\n\n      while (tok.text !== \"EOF\") {\n        tokens.push(tok);\n        tok = bodyLexer.lex();\n      }\n\n      tokens.reverse(); // to fit in with stack using push and pop\n\n      var expanded = {\n        tokens,\n        numArgs\n      };\n      return expanded;\n    }\n\n    return expansion;\n  }\n  /**\n   * Determine whether a command is currently \"defined\" (has some\n   * functionality), meaning that it's a macro (in the current group),\n   * a function, a symbol, or one of the special commands listed in\n   * `implicitCommands`.\n   */\n\n\n  isDefined(name) {\n    return this.macros.has(name) || functions.hasOwnProperty(name) || symbols.math.hasOwnProperty(name) || symbols.text.hasOwnProperty(name) || implicitCommands.hasOwnProperty(name);\n  }\n  /**\n   * Determine whether a command is expandable.\n   */\n\n\n  isExpandable(name) {\n    var macro = this.macros.get(name);\n    return macro != null ? typeof macro === \"string\" || typeof macro === \"function\" || !macro.unexpandable : functions.hasOwnProperty(name) && !functions[name].primitive;\n  }\n\n}\n\n// Helpers for Parser.js handling of Unicode (sub|super)script characters.\nvar unicodeSubRegEx = /^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/;\nvar uSubsAndSups = Object.freeze({\n  '₊': '+',\n  '₋': '-',\n  '₌': '=',\n  '₍': '(',\n  '₎': ')',\n  '₀': '0',\n  '₁': '1',\n  '₂': '2',\n  '₃': '3',\n  '₄': '4',\n  '₅': '5',\n  '₆': '6',\n  '₇': '7',\n  '₈': '8',\n  '₉': '9',\n  '\\u2090': 'a',\n  '\\u2091': 'e',\n  '\\u2095': 'h',\n  '\\u1D62': 'i',\n  '\\u2C7C': 'j',\n  '\\u2096': 'k',\n  '\\u2097': 'l',\n  '\\u2098': 'm',\n  '\\u2099': 'n',\n  '\\u2092': 'o',\n  '\\u209A': 'p',\n  '\\u1D63': 'r',\n  '\\u209B': 's',\n  '\\u209C': 't',\n  '\\u1D64': 'u',\n  '\\u1D65': 'v',\n  '\\u2093': 'x',\n  '\\u1D66': 'β',\n  '\\u1D67': 'γ',\n  '\\u1D68': 'ρ',\n  '\\u1D69': '\\u03d5',\n  '\\u1D6A': 'χ',\n  '⁺': '+',\n  '⁻': '-',\n  '⁼': '=',\n  '⁽': '(',\n  '⁾': ')',\n  '⁰': '0',\n  '¹': '1',\n  '²': '2',\n  '³': '3',\n  '⁴': '4',\n  '⁵': '5',\n  '⁶': '6',\n  '⁷': '7',\n  '⁸': '8',\n  '⁹': '9',\n  '\\u1D2C': 'A',\n  '\\u1D2E': 'B',\n  '\\u1D30': 'D',\n  '\\u1D31': 'E',\n  '\\u1D33': 'G',\n  '\\u1D34': 'H',\n  '\\u1D35': 'I',\n  '\\u1D36': 'J',\n  '\\u1D37': 'K',\n  '\\u1D38': 'L',\n  '\\u1D39': 'M',\n  '\\u1D3A': 'N',\n  '\\u1D3C': 'O',\n  '\\u1D3E': 'P',\n  '\\u1D3F': 'R',\n  '\\u1D40': 'T',\n  '\\u1D41': 'U',\n  '\\u2C7D': 'V',\n  '\\u1D42': 'W',\n  '\\u1D43': 'a',\n  '\\u1D47': 'b',\n  '\\u1D9C': 'c',\n  '\\u1D48': 'd',\n  '\\u1D49': 'e',\n  '\\u1DA0': 'f',\n  '\\u1D4D': 'g',\n  '\\u02B0': 'h',\n  '\\u2071': 'i',\n  '\\u02B2': 'j',\n  '\\u1D4F': 'k',\n  '\\u02E1': 'l',\n  '\\u1D50': 'm',\n  '\\u207F': 'n',\n  '\\u1D52': 'o',\n  '\\u1D56': 'p',\n  '\\u02B3': 'r',\n  '\\u02E2': 's',\n  '\\u1D57': 't',\n  '\\u1D58': 'u',\n  '\\u1D5B': 'v',\n  '\\u02B7': 'w',\n  '\\u02E3': 'x',\n  '\\u02B8': 'y',\n  '\\u1DBB': 'z',\n  '\\u1D5D': 'β',\n  '\\u1D5E': 'γ',\n  '\\u1D5F': 'δ',\n  '\\u1D60': '\\u03d5',\n  '\\u1D61': 'χ',\n  '\\u1DBF': 'θ'\n});\n\n/* eslint no-constant-condition:0 */\n\nvar unicodeAccents = {\n  \"́\": {\n    \"text\": \"\\\\'\",\n    \"math\": \"\\\\acute\"\n  },\n  \"̀\": {\n    \"text\": \"\\\\`\",\n    \"math\": \"\\\\grave\"\n  },\n  \"̈\": {\n    \"text\": \"\\\\\\\"\",\n    \"math\": \"\\\\ddot\"\n  },\n  \"̃\": {\n    \"text\": \"\\\\~\",\n    \"math\": \"\\\\tilde\"\n  },\n  \"̄\": {\n    \"text\": \"\\\\=\",\n    \"math\": \"\\\\bar\"\n  },\n  \"̆\": {\n    \"text\": \"\\\\u\",\n    \"math\": \"\\\\breve\"\n  },\n  \"̌\": {\n    \"text\": \"\\\\v\",\n    \"math\": \"\\\\check\"\n  },\n  \"̂\": {\n    \"text\": \"\\\\^\",\n    \"math\": \"\\\\hat\"\n  },\n  \"̇\": {\n    \"text\": \"\\\\.\",\n    \"math\": \"\\\\dot\"\n  },\n  \"̊\": {\n    \"text\": \"\\\\r\",\n    \"math\": \"\\\\mathring\"\n  },\n  \"̋\": {\n    \"text\": \"\\\\H\"\n  },\n  \"̧\": {\n    \"text\": \"\\\\c\"\n  }\n};\nvar unicodeSymbols = {\n  \"á\": \"á\",\n  \"à\": \"à\",\n  \"ä\": \"ä\",\n  \"ǟ\": \"ǟ\",\n  \"ã\": \"ã\",\n  \"ā\": \"ā\",\n  \"ă\": \"ă\",\n  \"ắ\": \"ắ\",\n  \"ằ\": \"ằ\",\n  \"ẵ\": \"ẵ\",\n  \"ǎ\": \"ǎ\",\n  \"â\": \"â\",\n  \"ấ\": \"ấ\",\n  \"ầ\": \"ầ\",\n  \"ẫ\": \"ẫ\",\n  \"ȧ\": \"ȧ\",\n  \"ǡ\": \"ǡ\",\n  \"å\": \"å\",\n  \"ǻ\": \"ǻ\",\n  \"ḃ\": \"ḃ\",\n  \"ć\": \"ć\",\n  \"ḉ\": \"ḉ\",\n  \"č\": \"č\",\n  \"ĉ\": \"ĉ\",\n  \"ċ\": \"ċ\",\n  \"ç\": \"ç\",\n  \"ď\": \"ď\",\n  \"ḋ\": \"ḋ\",\n  \"ḑ\": \"ḑ\",\n  \"é\": \"é\",\n  \"è\": \"è\",\n  \"ë\": \"ë\",\n  \"ẽ\": \"ẽ\",\n  \"ē\": \"ē\",\n  \"ḗ\": \"ḗ\",\n  \"ḕ\": \"ḕ\",\n  \"ĕ\": \"ĕ\",\n  \"ḝ\": \"ḝ\",\n  \"ě\": \"ě\",\n  \"ê\": \"ê\",\n  \"ế\": \"ế\",\n  \"ề\": \"ề\",\n  \"ễ\": \"ễ\",\n  \"ė\": \"ė\",\n  \"ȩ\": \"ȩ\",\n  \"ḟ\": \"ḟ\",\n  \"ǵ\": \"ǵ\",\n  \"ḡ\": \"ḡ\",\n  \"ğ\": \"ğ\",\n  \"ǧ\": \"ǧ\",\n  \"ĝ\": \"ĝ\",\n  \"ġ\": \"ġ\",\n  \"ģ\": \"ģ\",\n  \"ḧ\": \"ḧ\",\n  \"ȟ\": \"ȟ\",\n  \"ĥ\": \"ĥ\",\n  \"ḣ\": \"ḣ\",\n  \"ḩ\": \"ḩ\",\n  \"í\": \"í\",\n  \"ì\": \"ì\",\n  \"ï\": \"ï\",\n  \"ḯ\": \"ḯ\",\n  \"ĩ\": \"ĩ\",\n  \"ī\": \"ī\",\n  \"ĭ\": \"ĭ\",\n  \"ǐ\": \"ǐ\",\n  \"î\": \"î\",\n  \"ǰ\": \"ǰ\",\n  \"ĵ\": \"ĵ\",\n  \"ḱ\": \"ḱ\",\n  \"ǩ\": \"ǩ\",\n  \"ķ\": \"ķ\",\n  \"ĺ\": \"ĺ\",\n  \"ľ\": \"ľ\",\n  \"ļ\": \"ļ\",\n  \"ḿ\": \"ḿ\",\n  \"ṁ\": \"ṁ\",\n  \"ń\": \"ń\",\n  \"ǹ\": \"ǹ\",\n  \"ñ\": \"ñ\",\n  \"ň\": \"ň\",\n  \"ṅ\": \"ṅ\",\n  \"ņ\": \"ņ\",\n  \"ó\": \"ó\",\n  \"ò\": \"ò\",\n  \"ö\": \"ö\",\n  \"ȫ\": \"ȫ\",\n  \"õ\": \"õ\",\n  \"ṍ\": \"ṍ\",\n  \"ṏ\": \"ṏ\",\n  \"ȭ\": \"ȭ\",\n  \"ō\": \"ō\",\n  \"ṓ\": \"ṓ\",\n  \"ṑ\": \"ṑ\",\n  \"ŏ\": \"ŏ\",\n  \"ǒ\": \"ǒ\",\n  \"ô\": \"ô\",\n  \"ố\": \"ố\",\n  \"ồ\": \"ồ\",\n  \"ỗ\": \"ỗ\",\n  \"ȯ\": \"ȯ\",\n  \"ȱ\": \"ȱ\",\n  \"ő\": \"ő\",\n  \"ṕ\": \"ṕ\",\n  \"ṗ\": \"ṗ\",\n  \"ŕ\": \"ŕ\",\n  \"ř\": \"ř\",\n  \"ṙ\": \"ṙ\",\n  \"ŗ\": \"ŗ\",\n  \"ś\": \"ś\",\n  \"ṥ\": \"ṥ\",\n  \"š\": \"š\",\n  \"ṧ\": \"ṧ\",\n  \"ŝ\": \"ŝ\",\n  \"ṡ\": \"ṡ\",\n  \"ş\": \"ş\",\n  \"ẗ\": \"ẗ\",\n  \"ť\": \"ť\",\n  \"ṫ\": \"ṫ\",\n  \"ţ\": \"ţ\",\n  \"ú\": \"ú\",\n  \"ù\": \"ù\",\n  \"ü\": \"ü\",\n  \"ǘ\": \"ǘ\",\n  \"ǜ\": \"ǜ\",\n  \"ǖ\": \"ǖ\",\n  \"ǚ\": \"ǚ\",\n  \"ũ\": \"ũ\",\n  \"ṹ\": \"ṹ\",\n  \"ū\": \"ū\",\n  \"ṻ\": \"ṻ\",\n  \"ŭ\": \"ŭ\",\n  \"ǔ\": \"ǔ\",\n  \"û\": \"û\",\n  \"ů\": \"ů\",\n  \"ű\": \"ű\",\n  \"ṽ\": \"ṽ\",\n  \"ẃ\": \"ẃ\",\n  \"ẁ\": \"ẁ\",\n  \"ẅ\": \"ẅ\",\n  \"ŵ\": \"ŵ\",\n  \"ẇ\": \"ẇ\",\n  \"ẘ\": \"ẘ\",\n  \"ẍ\": \"ẍ\",\n  \"ẋ\": \"ẋ\",\n  \"ý\": \"ý\",\n  \"ỳ\": \"ỳ\",\n  \"ÿ\": \"ÿ\",\n  \"ỹ\": \"ỹ\",\n  \"ȳ\": \"ȳ\",\n  \"ŷ\": \"ŷ\",\n  \"ẏ\": \"ẏ\",\n  \"ẙ\": \"ẙ\",\n  \"ź\": \"ź\",\n  \"ž\": \"ž\",\n  \"ẑ\": \"ẑ\",\n  \"ż\": \"ż\",\n  \"Á\": \"Á\",\n  \"À\": \"À\",\n  \"Ä\": \"Ä\",\n  \"Ǟ\": \"Ǟ\",\n  \"Ã\": \"Ã\",\n  \"Ā\": \"Ā\",\n  \"Ă\": \"Ă\",\n  \"Ắ\": \"Ắ\",\n  \"Ằ\": \"Ằ\",\n  \"Ẵ\": \"Ẵ\",\n  \"Ǎ\": \"Ǎ\",\n  \"Â\": \"Â\",\n  \"Ấ\": \"Ấ\",\n  \"Ầ\": \"Ầ\",\n  \"Ẫ\": \"Ẫ\",\n  \"Ȧ\": \"Ȧ\",\n  \"Ǡ\": \"Ǡ\",\n  \"Å\": \"Å\",\n  \"Ǻ\": \"Ǻ\",\n  \"Ḃ\": \"Ḃ\",\n  \"Ć\": \"Ć\",\n  \"Ḉ\": \"Ḉ\",\n  \"Č\": \"Č\",\n  \"Ĉ\": \"Ĉ\",\n  \"Ċ\": \"Ċ\",\n  \"Ç\": \"Ç\",\n  \"Ď\": \"Ď\",\n  \"Ḋ\": \"Ḋ\",\n  \"Ḑ\": \"Ḑ\",\n  \"É\": \"É\",\n  \"È\": \"È\",\n  \"Ë\": \"Ë\",\n  \"Ẽ\": \"Ẽ\",\n  \"Ē\": \"Ē\",\n  \"Ḗ\": \"Ḗ\",\n  \"Ḕ\": \"Ḕ\",\n  \"Ĕ\": \"Ĕ\",\n  \"Ḝ\": \"Ḝ\",\n  \"Ě\": \"Ě\",\n  \"Ê\": \"Ê\",\n  \"Ế\": \"Ế\",\n  \"Ề\": \"Ề\",\n  \"Ễ\": \"Ễ\",\n  \"Ė\": \"Ė\",\n  \"Ȩ\": \"Ȩ\",\n  \"Ḟ\": \"Ḟ\",\n  \"Ǵ\": \"Ǵ\",\n  \"Ḡ\": \"Ḡ\",\n  \"Ğ\": \"Ğ\",\n  \"Ǧ\": \"Ǧ\",\n  \"Ĝ\": \"Ĝ\",\n  \"Ġ\": \"Ġ\",\n  \"Ģ\": \"Ģ\",\n  \"Ḧ\": \"Ḧ\",\n  \"Ȟ\": \"Ȟ\",\n  \"Ĥ\": \"Ĥ\",\n  \"Ḣ\": \"Ḣ\",\n  \"Ḩ\": \"Ḩ\",\n  \"Í\": \"Í\",\n  \"Ì\": \"Ì\",\n  \"Ï\": \"Ï\",\n  \"Ḯ\": \"Ḯ\",\n  \"Ĩ\": \"Ĩ\",\n  \"Ī\": \"Ī\",\n  \"Ĭ\": \"Ĭ\",\n  \"Ǐ\": \"Ǐ\",\n  \"Î\": \"Î\",\n  \"İ\": \"İ\",\n  \"Ĵ\": \"Ĵ\",\n  \"Ḱ\": \"Ḱ\",\n  \"Ǩ\": \"Ǩ\",\n  \"Ķ\": \"Ķ\",\n  \"Ĺ\": \"Ĺ\",\n  \"Ľ\": \"Ľ\",\n  \"Ļ\": \"Ļ\",\n  \"Ḿ\": \"Ḿ\",\n  \"Ṁ\": \"Ṁ\",\n  \"Ń\": \"Ń\",\n  \"Ǹ\": \"Ǹ\",\n  \"Ñ\": \"Ñ\",\n  \"Ň\": \"Ň\",\n  \"Ṅ\": \"Ṅ\",\n  \"Ņ\": \"Ņ\",\n  \"Ó\": \"Ó\",\n  \"Ò\": \"Ò\",\n  \"Ö\": \"Ö\",\n  \"Ȫ\": \"Ȫ\",\n  \"Õ\": \"Õ\",\n  \"Ṍ\": \"Ṍ\",\n  \"Ṏ\": \"Ṏ\",\n  \"Ȭ\": \"Ȭ\",\n  \"Ō\": \"Ō\",\n  \"Ṓ\": \"Ṓ\",\n  \"Ṑ\": \"Ṑ\",\n  \"Ŏ\": \"Ŏ\",\n  \"Ǒ\": \"Ǒ\",\n  \"Ô\": \"Ô\",\n  \"Ố\": \"Ố\",\n  \"Ồ\": \"Ồ\",\n  \"Ỗ\": \"Ỗ\",\n  \"Ȯ\": \"Ȯ\",\n  \"Ȱ\": \"Ȱ\",\n  \"Ő\": \"Ő\",\n  \"Ṕ\": \"Ṕ\",\n  \"Ṗ\": \"Ṗ\",\n  \"Ŕ\": \"Ŕ\",\n  \"Ř\": \"Ř\",\n  \"Ṙ\": \"Ṙ\",\n  \"Ŗ\": \"Ŗ\",\n  \"Ś\": \"Ś\",\n  \"Ṥ\": \"Ṥ\",\n  \"Š\": \"Š\",\n  \"Ṧ\": \"Ṧ\",\n  \"Ŝ\": \"Ŝ\",\n  \"Ṡ\": \"Ṡ\",\n  \"Ş\": \"Ş\",\n  \"Ť\": \"Ť\",\n  \"Ṫ\": \"Ṫ\",\n  \"Ţ\": \"Ţ\",\n  \"Ú\": \"Ú\",\n  \"Ù\": \"Ù\",\n  \"Ü\": \"Ü\",\n  \"Ǘ\": \"Ǘ\",\n  \"Ǜ\": \"Ǜ\",\n  \"Ǖ\": \"Ǖ\",\n  \"Ǚ\": \"Ǚ\",\n  \"Ũ\": \"Ũ\",\n  \"Ṹ\": \"Ṹ\",\n  \"Ū\": \"Ū\",\n  \"Ṻ\": \"Ṻ\",\n  \"Ŭ\": \"Ŭ\",\n  \"Ǔ\": \"Ǔ\",\n  \"Û\": \"Û\",\n  \"Ů\": \"Ů\",\n  \"Ű\": \"Ű\",\n  \"Ṽ\": \"Ṽ\",\n  \"Ẃ\": \"Ẃ\",\n  \"Ẁ\": \"Ẁ\",\n  \"Ẅ\": \"Ẅ\",\n  \"Ŵ\": \"Ŵ\",\n  \"Ẇ\": \"Ẇ\",\n  \"Ẍ\": \"Ẍ\",\n  \"Ẋ\": \"Ẋ\",\n  \"Ý\": \"Ý\",\n  \"Ỳ\": \"Ỳ\",\n  \"Ÿ\": \"Ÿ\",\n  \"Ỹ\": \"Ỹ\",\n  \"Ȳ\": \"Ȳ\",\n  \"Ŷ\": \"Ŷ\",\n  \"Ẏ\": \"Ẏ\",\n  \"Ź\": \"Ź\",\n  \"Ž\": \"Ž\",\n  \"Ẑ\": \"Ẑ\",\n  \"Ż\": \"Ż\",\n  \"ά\": \"ά\",\n  \"ὰ\": \"ὰ\",\n  \"ᾱ\": \"ᾱ\",\n  \"ᾰ\": \"ᾰ\",\n  \"έ\": \"έ\",\n  \"ὲ\": \"ὲ\",\n  \"ή\": \"ή\",\n  \"ὴ\": \"ὴ\",\n  \"ί\": \"ί\",\n  \"ὶ\": \"ὶ\",\n  \"ϊ\": \"ϊ\",\n  \"ΐ\": \"ΐ\",\n  \"ῒ\": \"ῒ\",\n  \"ῑ\": \"ῑ\",\n  \"ῐ\": \"ῐ\",\n  \"ό\": \"ό\",\n  \"ὸ\": \"ὸ\",\n  \"ύ\": \"ύ\",\n  \"ὺ\": \"ὺ\",\n  \"ϋ\": \"ϋ\",\n  \"ΰ\": \"ΰ\",\n  \"ῢ\": \"ῢ\",\n  \"ῡ\": \"ῡ\",\n  \"ῠ\": \"ῠ\",\n  \"ώ\": \"ώ\",\n  \"ὼ\": \"ὼ\",\n  \"Ύ\": \"Ύ\",\n  \"Ὺ\": \"Ὺ\",\n  \"Ϋ\": \"Ϋ\",\n  \"Ῡ\": \"Ῡ\",\n  \"Ῠ\": \"Ῠ\",\n  \"Ώ\": \"Ώ\",\n  \"Ὼ\": \"Ὼ\"\n};\n\n/**\n * This file contains the parser used to parse out a TeX expression from the\n * input. Since TeX isn't context-free, standard parsers don't work particularly\n * well.\n *\n * The strategy of this parser is as such:\n *\n * The main functions (the `.parse...` ones) take a position in the current\n * parse string to parse tokens from. The lexer (found in Lexer.js, stored at\n * this.gullet.lexer) also supports pulling out tokens at arbitrary places. When\n * individual tokens are needed at a position, the lexer is called to pull out a\n * token, which is then used.\n *\n * The parser has a property called \"mode\" indicating the mode that\n * the parser is currently in. Currently it has to be one of \"math\" or\n * \"text\", which denotes whether the current environment is a math-y\n * one or a text-y one (e.g. inside \\text). Currently, this serves to\n * limit the functions which can be used in text mode.\n *\n * The main functions then return an object which contains the useful data that\n * was parsed at its given point, and a new position at the end of the parsed\n * data. The main functions can call each other and continue the parsing by\n * using the returned position as a new starting point.\n *\n * There are also extra `.handle...` functions, which pull out some reused\n * functionality into self-contained functions.\n *\n * The functions return ParseNodes.\n */\nclass Parser {\n  constructor(input, settings) {\n    this.mode = void 0;\n    this.gullet = void 0;\n    this.settings = void 0;\n    this.leftrightDepth = void 0;\n    this.nextToken = void 0;\n    // Start in math mode\n    this.mode = \"math\"; // Create a new macro expander (gullet) and (indirectly via that) also a\n    // new lexer (mouth) for this parser (stomach, in the language of TeX)\n\n    this.gullet = new MacroExpander(input, settings, this.mode); // Store the settings for use in parsing\n\n    this.settings = settings; // Count leftright depth (for \\middle errors)\n\n    this.leftrightDepth = 0;\n  }\n  /**\n   * Checks a result to make sure it has the right type, and throws an\n   * appropriate error otherwise.\n   */\n\n\n  expect(text, consume) {\n    if (consume === void 0) {\n      consume = true;\n    }\n\n    if (this.fetch().text !== text) {\n      throw new ParseError(\"Expected '\" + text + \"', got '\" + this.fetch().text + \"'\", this.fetch());\n    }\n\n    if (consume) {\n      this.consume();\n    }\n  }\n  /**\n   * Discards the current lookahead token, considering it consumed.\n   */\n\n\n  consume() {\n    this.nextToken = null;\n  }\n  /**\n   * Return the current lookahead token, or if there isn't one (at the\n   * beginning, or if the previous lookahead token was consume()d),\n   * fetch the next token as the new lookahead token and return it.\n   */\n\n\n  fetch() {\n    if (this.nextToken == null) {\n      this.nextToken = this.gullet.expandNextToken();\n    }\n\n    return this.nextToken;\n  }\n  /**\n   * Switches between \"text\" and \"math\" modes.\n   */\n\n\n  switchMode(newMode) {\n    this.mode = newMode;\n    this.gullet.switchMode(newMode);\n  }\n  /**\n   * Main parsing function, which parses an entire input.\n   */\n\n\n  parse() {\n    if (!this.settings.globalGroup) {\n      // Create a group namespace for the math expression.\n      // (LaTeX creates a new group for every $...$, $$...$$, \\[...\\].)\n      this.gullet.beginGroup();\n    } // Use old \\color behavior (same as LaTeX's \\textcolor) if requested.\n    // We do this within the group for the math expression, so it doesn't\n    // pollute settings.macros.\n\n\n    if (this.settings.colorIsTextColor) {\n      this.gullet.macros.set(\"\\\\color\", \"\\\\textcolor\");\n    }\n\n    try {\n      // Try to parse the input\n      var parse = this.parseExpression(false); // If we succeeded, make sure there's an EOF at the end\n\n      this.expect(\"EOF\"); // End the group namespace for the expression\n\n      if (!this.settings.globalGroup) {\n        this.gullet.endGroup();\n      }\n\n      return parse; // Close any leftover groups in case of a parse error.\n    } finally {\n      this.gullet.endGroups();\n    }\n  }\n  /**\n   * Fully parse a separate sequence of tokens as a separate job.\n   * Tokens should be specified in reverse order, as in a MacroDefinition.\n   */\n\n\n  subparse(tokens) {\n    // Save the next token from the current job.\n    var oldToken = this.nextToken;\n    this.consume(); // Run the new job, terminating it with an excess '}'\n\n    this.gullet.pushToken(new Token(\"}\"));\n    this.gullet.pushTokens(tokens);\n    var parse = this.parseExpression(false);\n    this.expect(\"}\"); // Restore the next token from the current job.\n\n    this.nextToken = oldToken;\n    return parse;\n  }\n\n  /**\n   * Parses an \"expression\", which is a list of atoms.\n   *\n   * `breakOnInfix`: Should the parsing stop when we hit infix nodes? This\n   *                 happens when functions have higher precedence han infix\n   *                 nodes in implicit parses.\n   *\n   * `breakOnTokenText`: The text of the token that the expression should end\n   *                     with, or `null` if something else should end the\n   *                     expression.\n   */\n  parseExpression(breakOnInfix, breakOnTokenText) {\n    var body = []; // Keep adding atoms to the body until we can't parse any more atoms (either\n    // we reached the end, a }, or a \\right)\n\n    while (true) {\n      // Ignore spaces in math mode\n      if (this.mode === \"math\") {\n        this.consumeSpaces();\n      }\n\n      var lex = this.fetch();\n\n      if (Parser.endOfExpression.indexOf(lex.text) !== -1) {\n        break;\n      }\n\n      if (breakOnTokenText && lex.text === breakOnTokenText) {\n        break;\n      }\n\n      if (breakOnInfix && functions[lex.text] && functions[lex.text].infix) {\n        break;\n      }\n\n      var atom = this.parseAtom(breakOnTokenText);\n\n      if (!atom) {\n        break;\n      } else if (atom.type === \"internal\") {\n        // Internal nodes do not appear in parse tree\n        continue;\n      }\n\n      body.push(atom);\n    }\n\n    if (this.mode === \"text\") {\n      this.formLigatures(body);\n    }\n\n    return this.handleInfixNodes(body);\n  }\n  /**\n   * Rewrites infix operators such as \\over with corresponding commands such\n   * as \\frac.\n   *\n   * There can only be one infix operator per group.  If there's more than one\n   * then the expression is ambiguous.  This can be resolved by adding {}.\n   */\n\n\n  handleInfixNodes(body) {\n    var overIndex = -1;\n    var funcName;\n\n    for (var i = 0; i < body.length; i++) {\n      if (body[i].type === \"infix\") {\n        if (overIndex !== -1) {\n          throw new ParseError(\"only one infix operator per group\", body[i].token);\n        }\n\n        overIndex = i;\n        funcName = body[i].replaceWith;\n      }\n    }\n\n    if (overIndex !== -1 && funcName) {\n      var numerNode;\n      var denomNode;\n      var numerBody = body.slice(0, overIndex);\n      var denomBody = body.slice(overIndex + 1);\n\n      if (numerBody.length === 1 && numerBody[0].type === \"ordgroup\") {\n        numerNode = numerBody[0];\n      } else {\n        numerNode = {\n          type: \"ordgroup\",\n          mode: this.mode,\n          body: numerBody\n        };\n      }\n\n      if (denomBody.length === 1 && denomBody[0].type === \"ordgroup\") {\n        denomNode = denomBody[0];\n      } else {\n        denomNode = {\n          type: \"ordgroup\",\n          mode: this.mode,\n          body: denomBody\n        };\n      }\n\n      var node;\n\n      if (funcName === \"\\\\\\\\abovefrac\") {\n        node = this.callFunction(funcName, [numerNode, body[overIndex], denomNode], []);\n      } else {\n        node = this.callFunction(funcName, [numerNode, denomNode], []);\n      }\n\n      return [node];\n    } else {\n      return body;\n    }\n  }\n  /**\n   * Handle a subscript or superscript with nice errors.\n   */\n\n\n  handleSupSubscript(name // For error reporting.\n  ) {\n    var symbolToken = this.fetch();\n    var symbol = symbolToken.text;\n    this.consume();\n    this.consumeSpaces(); // ignore spaces before sup/subscript argument\n    // Skip over allowed internal nodes such as \\relax\n\n    var group;\n\n    do {\n      var _group;\n\n      group = this.parseGroup(name);\n    } while (((_group = group) == null ? void 0 : _group.type) === \"internal\");\n\n    if (!group) {\n      throw new ParseError(\"Expected group after '\" + symbol + \"'\", symbolToken);\n    }\n\n    return group;\n  }\n  /**\n   * Converts the textual input of an unsupported command into a text node\n   * contained within a color node whose color is determined by errorColor\n   */\n\n\n  formatUnsupportedCmd(text) {\n    var textordArray = [];\n\n    for (var i = 0; i < text.length; i++) {\n      textordArray.push({\n        type: \"textord\",\n        mode: \"text\",\n        text: text[i]\n      });\n    }\n\n    var textNode = {\n      type: \"text\",\n      mode: this.mode,\n      body: textordArray\n    };\n    var colorNode = {\n      type: \"color\",\n      mode: this.mode,\n      color: this.settings.errorColor,\n      body: [textNode]\n    };\n    return colorNode;\n  }\n  /**\n   * Parses a group with optional super/subscripts.\n   */\n\n\n  parseAtom(breakOnTokenText) {\n    // The body of an atom is an implicit group, so that things like\n    // \\left(x\\right)^2 work correctly.\n    var base = this.parseGroup(\"atom\", breakOnTokenText); // Internal nodes (e.g. \\relax) cannot support super/subscripts.\n    // Instead we will pick up super/subscripts with blank base next round.\n\n    if ((base == null ? void 0 : base.type) === \"internal\") {\n      return base;\n    } // In text mode, we don't have superscripts or subscripts\n\n\n    if (this.mode === \"text\") {\n      return base;\n    } // Note that base may be empty (i.e. null) at this point.\n\n\n    var superscript;\n    var subscript;\n\n    while (true) {\n      // Guaranteed in math mode, so eat any spaces first.\n      this.consumeSpaces(); // Lex the first token\n\n      var lex = this.fetch();\n\n      if (lex.text === \"\\\\limits\" || lex.text === \"\\\\nolimits\") {\n        // We got a limit control\n        if (base && base.type === \"op\") {\n          var limits = lex.text === \"\\\\limits\";\n          base.limits = limits;\n          base.alwaysHandleSupSub = true;\n        } else if (base && base.type === \"operatorname\") {\n          if (base.alwaysHandleSupSub) {\n            base.limits = lex.text === \"\\\\limits\";\n          }\n        } else {\n          throw new ParseError(\"Limit controls must follow a math operator\", lex);\n        }\n\n        this.consume();\n      } else if (lex.text === \"^\") {\n        // We got a superscript start\n        if (superscript) {\n          throw new ParseError(\"Double superscript\", lex);\n        }\n\n        superscript = this.handleSupSubscript(\"superscript\");\n      } else if (lex.text === \"_\") {\n        // We got a subscript start\n        if (subscript) {\n          throw new ParseError(\"Double subscript\", lex);\n        }\n\n        subscript = this.handleSupSubscript(\"subscript\");\n      } else if (lex.text === \"'\") {\n        // We got a prime\n        if (superscript) {\n          throw new ParseError(\"Double superscript\", lex);\n        }\n\n        var prime = {\n          type: \"textord\",\n          mode: this.mode,\n          text: \"\\\\prime\"\n        }; // Many primes can be grouped together, so we handle this here\n\n        var primes = [prime];\n        this.consume(); // Keep lexing tokens until we get something that's not a prime\n\n        while (this.fetch().text === \"'\") {\n          // For each one, add another prime to the list\n          primes.push(prime);\n          this.consume();\n        } // If there's a superscript following the primes, combine that\n        // superscript in with the primes.\n\n\n        if (this.fetch().text === \"^\") {\n          primes.push(this.handleSupSubscript(\"superscript\"));\n        } // Put everything into an ordgroup as the superscript\n\n\n        superscript = {\n          type: \"ordgroup\",\n          mode: this.mode,\n          body: primes\n        };\n      } else if (uSubsAndSups[lex.text]) {\n        // A Unicode subscript or superscript character.\n        // We treat these similarly to the unicode-math package.\n        // So we render a string of Unicode (sub|super)scripts the\n        // same as a (sub|super)script of regular characters.\n        var isSub = unicodeSubRegEx.test(lex.text);\n        var subsupTokens = [];\n        subsupTokens.push(new Token(uSubsAndSups[lex.text]));\n        this.consume(); // Continue fetching tokens to fill out the string.\n\n        while (true) {\n          var token = this.fetch().text;\n\n          if (!uSubsAndSups[token]) {\n            break;\n          }\n\n          if (unicodeSubRegEx.test(token) !== isSub) {\n            break;\n          }\n\n          subsupTokens.unshift(new Token(uSubsAndSups[token]));\n          this.consume();\n        } // Now create a (sub|super)script.\n\n\n        var body = this.subparse(subsupTokens);\n\n        if (isSub) {\n          subscript = {\n            type: \"ordgroup\",\n            mode: \"math\",\n            body\n          };\n        } else {\n          superscript = {\n            type: \"ordgroup\",\n            mode: \"math\",\n            body\n          };\n        }\n      } else {\n        // If it wasn't ^, _, or ', stop parsing super/subscripts\n        break;\n      }\n    } // Base must be set if superscript or subscript are set per logic above,\n    // but need to check here for type check to pass.\n\n\n    if (superscript || subscript) {\n      // If we got either a superscript or subscript, create a supsub\n      return {\n        type: \"supsub\",\n        mode: this.mode,\n        base: base,\n        sup: superscript,\n        sub: subscript\n      };\n    } else {\n      // Otherwise return the original body\n      return base;\n    }\n  }\n  /**\n   * Parses an entire function, including its base and all of its arguments.\n   */\n\n\n  parseFunction(breakOnTokenText, name // For determining its context\n  ) {\n    var token = this.fetch();\n    var func = token.text;\n    var funcData = functions[func];\n\n    if (!funcData) {\n      return null;\n    }\n\n    this.consume(); // consume command token\n\n    if (name && name !== \"atom\" && !funcData.allowedInArgument) {\n      throw new ParseError(\"Got function '\" + func + \"' with no arguments\" + (name ? \" as \" + name : \"\"), token);\n    } else if (this.mode === \"text\" && !funcData.allowedInText) {\n      throw new ParseError(\"Can't use function '\" + func + \"' in text mode\", token);\n    } else if (this.mode === \"math\" && funcData.allowedInMath === false) {\n      throw new ParseError(\"Can't use function '\" + func + \"' in math mode\", token);\n    }\n\n    var {\n      args,\n      optArgs\n    } = this.parseArguments(func, funcData);\n    return this.callFunction(func, args, optArgs, token, breakOnTokenText);\n  }\n  /**\n   * Call a function handler with a suitable context and arguments.\n   */\n\n\n  callFunction(name, args, optArgs, token, breakOnTokenText) {\n    var context = {\n      funcName: name,\n      parser: this,\n      token,\n      breakOnTokenText\n    };\n    var func = functions[name];\n\n    if (func && func.handler) {\n      return func.handler(context, args, optArgs);\n    } else {\n      throw new ParseError(\"No function handler for \" + name);\n    }\n  }\n  /**\n   * Parses the arguments of a function or environment\n   */\n\n\n  parseArguments(func, // Should look like \"\\name\" or \"\\begin{name}\".\n  funcData) {\n    var totalArgs = funcData.numArgs + funcData.numOptionalArgs;\n\n    if (totalArgs === 0) {\n      return {\n        args: [],\n        optArgs: []\n      };\n    }\n\n    var args = [];\n    var optArgs = [];\n\n    for (var i = 0; i < totalArgs; i++) {\n      var argType = funcData.argTypes && funcData.argTypes[i];\n      var isOptional = i < funcData.numOptionalArgs;\n\n      if (funcData.primitive && argType == null || // \\sqrt expands into primitive if optional argument doesn't exist\n      funcData.type === \"sqrt\" && i === 1 && optArgs[0] == null) {\n        argType = \"primitive\";\n      }\n\n      var arg = this.parseGroupOfType(\"argument to '\" + func + \"'\", argType, isOptional);\n\n      if (isOptional) {\n        optArgs.push(arg);\n      } else if (arg != null) {\n        args.push(arg);\n      } else {\n        // should be unreachable\n        throw new ParseError(\"Null argument, please report this as a bug\");\n      }\n    }\n\n    return {\n      args,\n      optArgs\n    };\n  }\n  /**\n   * Parses a group when the mode is changing.\n   */\n\n\n  parseGroupOfType(name, type, optional) {\n    switch (type) {\n      case \"color\":\n        return this.parseColorGroup(optional);\n\n      case \"size\":\n        return this.parseSizeGroup(optional);\n\n      case \"url\":\n        return this.parseUrlGroup(optional);\n\n      case \"math\":\n      case \"text\":\n        return this.parseArgumentGroup(optional, type);\n\n      case \"hbox\":\n        {\n          // hbox argument type wraps the argument in the equivalent of\n          // \\hbox, which is like \\text but switching to \\textstyle size.\n          var group = this.parseArgumentGroup(optional, \"text\");\n          return group != null ? {\n            type: \"styling\",\n            mode: group.mode,\n            body: [group],\n            style: \"text\" // simulate \\textstyle\n\n          } : null;\n        }\n\n      case \"raw\":\n        {\n          var token = this.parseStringGroup(\"raw\", optional);\n          return token != null ? {\n            type: \"raw\",\n            mode: \"text\",\n            string: token.text\n          } : null;\n        }\n\n      case \"primitive\":\n        {\n          if (optional) {\n            throw new ParseError(\"A primitive argument cannot be optional\");\n          }\n\n          var _group2 = this.parseGroup(name);\n\n          if (_group2 == null) {\n            throw new ParseError(\"Expected group as \" + name, this.fetch());\n          }\n\n          return _group2;\n        }\n\n      case \"original\":\n      case null:\n      case undefined:\n        return this.parseArgumentGroup(optional);\n\n      default:\n        throw new ParseError(\"Unknown group type as \" + name, this.fetch());\n    }\n  }\n  /**\n   * Discard any space tokens, fetching the next non-space token.\n   */\n\n\n  consumeSpaces() {\n    while (this.fetch().text === \" \") {\n      this.consume();\n    }\n  }\n  /**\n   * Parses a group, essentially returning the string formed by the\n   * brace-enclosed tokens plus some position information.\n   */\n\n\n  parseStringGroup(modeName, // Used to describe the mode in error messages.\n  optional) {\n    var argToken = this.gullet.scanArgument(optional);\n\n    if (argToken == null) {\n      return null;\n    }\n\n    var str = \"\";\n    var nextToken;\n\n    while ((nextToken = this.fetch()).text !== \"EOF\") {\n      str += nextToken.text;\n      this.consume();\n    }\n\n    this.consume(); // consume the end of the argument\n\n    argToken.text = str;\n    return argToken;\n  }\n  /**\n   * Parses a regex-delimited group: the largest sequence of tokens\n   * whose concatenated strings match `regex`. Returns the string\n   * formed by the tokens plus some position information.\n   */\n\n\n  parseRegexGroup(regex, modeName // Used to describe the mode in error messages.\n  ) {\n    var firstToken = this.fetch();\n    var lastToken = firstToken;\n    var str = \"\";\n    var nextToken;\n\n    while ((nextToken = this.fetch()).text !== \"EOF\" && regex.test(str + nextToken.text)) {\n      lastToken = nextToken;\n      str += lastToken.text;\n      this.consume();\n    }\n\n    if (str === \"\") {\n      throw new ParseError(\"Invalid \" + modeName + \": '\" + firstToken.text + \"'\", firstToken);\n    }\n\n    return firstToken.range(lastToken, str);\n  }\n  /**\n   * Parses a color description.\n   */\n\n\n  parseColorGroup(optional) {\n    var res = this.parseStringGroup(\"color\", optional);\n\n    if (res == null) {\n      return null;\n    }\n\n    var match = /^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(res.text);\n\n    if (!match) {\n      throw new ParseError(\"Invalid color: '\" + res.text + \"'\", res);\n    }\n\n    var color = match[0];\n\n    if (/^[0-9a-f]{6}$/i.test(color)) {\n      // We allow a 6-digit HTML color spec without a leading \"#\".\n      // This follows the xcolor package's HTML color model.\n      // Predefined color names are all missed by this RegEx pattern.\n      color = \"#\" + color;\n    }\n\n    return {\n      type: \"color-token\",\n      mode: this.mode,\n      color\n    };\n  }\n  /**\n   * Parses a size specification, consisting of magnitude and unit.\n   */\n\n\n  parseSizeGroup(optional) {\n    var res;\n    var isBlank = false; // don't expand before parseStringGroup\n\n    this.gullet.consumeSpaces();\n\n    if (!optional && this.gullet.future().text !== \"{\") {\n      res = this.parseRegexGroup(/^[-+]? *(?:$|\\d+|\\d+\\.\\d*|\\.\\d*) *[a-z]{0,2} *$/, \"size\");\n    } else {\n      res = this.parseStringGroup(\"size\", optional);\n    }\n\n    if (!res) {\n      return null;\n    }\n\n    if (!optional && res.text.length === 0) {\n      // Because we've tested for what is !optional, this block won't\n      // affect \\kern, \\hspace, etc. It will capture the mandatory arguments\n      // to \\genfrac and \\above.\n      res.text = \"0pt\"; // Enable \\above{}\n\n      isBlank = true; // This is here specifically for \\genfrac\n    }\n\n    var match = /([-+]?) *(\\d+(?:\\.\\d*)?|\\.\\d+) *([a-z]{2})/.exec(res.text);\n\n    if (!match) {\n      throw new ParseError(\"Invalid size: '\" + res.text + \"'\", res);\n    }\n\n    var data = {\n      number: +(match[1] + match[2]),\n      // sign + magnitude, cast to number\n      unit: match[3]\n    };\n\n    if (!validUnit(data)) {\n      throw new ParseError(\"Invalid unit: '\" + data.unit + \"'\", res);\n    }\n\n    return {\n      type: \"size\",\n      mode: this.mode,\n      value: data,\n      isBlank\n    };\n  }\n  /**\n   * Parses an URL, checking escaped letters and allowed protocols,\n   * and setting the catcode of % as an active character (as in \\hyperref).\n   */\n\n\n  parseUrlGroup(optional) {\n    this.gullet.lexer.setCatcode(\"%\", 13); // active character\n\n    this.gullet.lexer.setCatcode(\"~\", 12); // other character\n\n    var res = this.parseStringGroup(\"url\", optional);\n    this.gullet.lexer.setCatcode(\"%\", 14); // comment character\n\n    this.gullet.lexer.setCatcode(\"~\", 13); // active character\n\n    if (res == null) {\n      return null;\n    } // hyperref package allows backslashes alone in href, but doesn't\n    // generate valid links in such cases; we interpret this as\n    // \"undefined\" behaviour, and keep them as-is. Some browser will\n    // replace backslashes with forward slashes.\n\n\n    var url = res.text.replace(/\\\\([#$%&~_^{}])/g, '$1');\n    return {\n      type: \"url\",\n      mode: this.mode,\n      url\n    };\n  }\n  /**\n   * Parses an argument with the mode specified.\n   */\n\n\n  parseArgumentGroup(optional, mode) {\n    var argToken = this.gullet.scanArgument(optional);\n\n    if (argToken == null) {\n      return null;\n    }\n\n    var outerMode = this.mode;\n\n    if (mode) {\n      // Switch to specified mode\n      this.switchMode(mode);\n    }\n\n    this.gullet.beginGroup();\n    var expression = this.parseExpression(false, \"EOF\"); // TODO: find an alternative way to denote the end\n\n    this.expect(\"EOF\"); // expect the end of the argument\n\n    this.gullet.endGroup();\n    var result = {\n      type: \"ordgroup\",\n      mode: this.mode,\n      loc: argToken.loc,\n      body: expression\n    };\n\n    if (mode) {\n      // Switch mode back\n      this.switchMode(outerMode);\n    }\n\n    return result;\n  }\n  /**\n   * Parses an ordinary group, which is either a single nucleus (like \"x\")\n   * or an expression in braces (like \"{x+y}\") or an implicit group, a group\n   * that starts at the current position, and ends right before a higher explicit\n   * group ends, or at EOF.\n   */\n\n\n  parseGroup(name, // For error reporting.\n  breakOnTokenText) {\n    var firstToken = this.fetch();\n    var text = firstToken.text;\n    var result; // Try to parse an open brace or \\begingroup\n\n    if (text === \"{\" || text === \"\\\\begingroup\") {\n      this.consume();\n      var groupEnd = text === \"{\" ? \"}\" : \"\\\\endgroup\";\n      this.gullet.beginGroup(); // If we get a brace, parse an expression\n\n      var expression = this.parseExpression(false, groupEnd);\n      var lastToken = this.fetch();\n      this.expect(groupEnd); // Check that we got a matching closing brace\n\n      this.gullet.endGroup();\n      result = {\n        type: \"ordgroup\",\n        mode: this.mode,\n        loc: SourceLocation.range(firstToken, lastToken),\n        body: expression,\n        // A group formed by \\begingroup...\\endgroup is a semi-simple group\n        // which doesn't affect spacing in math mode, i.e., is transparent.\n        // https://tex.stackexchange.com/questions/1930/when-should-one-\n        // use-begingroup-instead-of-bgroup\n        semisimple: text === \"\\\\begingroup\" || undefined\n      };\n    } else {\n      // If there exists a function with this name, parse the function.\n      // Otherwise, just return a nucleus\n      result = this.parseFunction(breakOnTokenText, name) || this.parseSymbol();\n\n      if (result == null && text[0] === \"\\\\\" && !implicitCommands.hasOwnProperty(text)) {\n        if (this.settings.throwOnError) {\n          throw new ParseError(\"Undefined control sequence: \" + text, firstToken);\n        }\n\n        result = this.formatUnsupportedCmd(text);\n        this.consume();\n      }\n    }\n\n    return result;\n  }\n  /**\n   * Form ligature-like combinations of characters for text mode.\n   * This includes inputs like \"--\", \"---\", \"``\" and \"''\".\n   * The result will simply replace multiple textord nodes with a single\n   * character in each value by a single textord node having multiple\n   * characters in its value.  The representation is still ASCII source.\n   * The group will be modified in place.\n   */\n\n\n  formLigatures(group) {\n    var n = group.length - 1;\n\n    for (var i = 0; i < n; ++i) {\n      var a = group[i]; // $FlowFixMe: Not every node type has a `text` property.\n\n      var v = a.text;\n\n      if (v === \"-\" && group[i + 1].text === \"-\") {\n        if (i + 1 < n && group[i + 2].text === \"-\") {\n          group.splice(i, 3, {\n            type: \"textord\",\n            mode: \"text\",\n            loc: SourceLocation.range(a, group[i + 2]),\n            text: \"---\"\n          });\n          n -= 2;\n        } else {\n          group.splice(i, 2, {\n            type: \"textord\",\n            mode: \"text\",\n            loc: SourceLocation.range(a, group[i + 1]),\n            text: \"--\"\n          });\n          n -= 1;\n        }\n      }\n\n      if ((v === \"'\" || v === \"`\") && group[i + 1].text === v) {\n        group.splice(i, 2, {\n          type: \"textord\",\n          mode: \"text\",\n          loc: SourceLocation.range(a, group[i + 1]),\n          text: v + v\n        });\n        n -= 1;\n      }\n    }\n  }\n  /**\n   * Parse a single symbol out of the string. Here, we handle single character\n   * symbols and special functions like \\verb.\n   */\n\n\n  parseSymbol() {\n    var nucleus = this.fetch();\n    var text = nucleus.text;\n\n    if (/^\\\\verb[^a-zA-Z]/.test(text)) {\n      this.consume();\n      var arg = text.slice(5);\n      var star = arg.charAt(0) === \"*\";\n\n      if (star) {\n        arg = arg.slice(1);\n      } // Lexer's tokenRegex is constructed to always have matching\n      // first/last characters.\n\n\n      if (arg.length < 2 || arg.charAt(0) !== arg.slice(-1)) {\n        throw new ParseError(\"\\\\verb assertion failed --\\n                    please report what input caused this bug\");\n      }\n\n      arg = arg.slice(1, -1); // remove first and last char\n\n      return {\n        type: \"verb\",\n        mode: \"text\",\n        body: arg,\n        star\n      };\n    } // At this point, we should have a symbol, possibly with accents.\n    // First expand any accented base symbol according to unicodeSymbols.\n\n\n    if (unicodeSymbols.hasOwnProperty(text[0]) && !symbols[this.mode][text[0]]) {\n      // This behavior is not strict (XeTeX-compatible) in math mode.\n      if (this.settings.strict && this.mode === \"math\") {\n        this.settings.reportNonstrict(\"unicodeTextInMathMode\", \"Accented Unicode text character \\\"\" + text[0] + \"\\\" used in \" + \"math mode\", nucleus);\n      }\n\n      text = unicodeSymbols[text[0]] + text.slice(1);\n    } // Strip off any combining characters\n\n\n    var match = combiningDiacriticalMarksEndRegex.exec(text);\n\n    if (match) {\n      text = text.substring(0, match.index);\n\n      if (text === 'i') {\n        text = '\\u0131'; // dotless i, in math and text mode\n      } else if (text === 'j') {\n        text = '\\u0237'; // dotless j, in math and text mode\n      }\n    } // Recognize base symbol\n\n\n    var symbol;\n\n    if (symbols[this.mode][text]) {\n      if (this.settings.strict && this.mode === 'math' && extraLatin.indexOf(text) >= 0) {\n        this.settings.reportNonstrict(\"unicodeTextInMathMode\", \"Latin-1/Unicode text character \\\"\" + text[0] + \"\\\" used in \" + \"math mode\", nucleus);\n      }\n\n      var group = symbols[this.mode][text].group;\n      var loc = SourceLocation.range(nucleus);\n      var s;\n\n      if (ATOMS.hasOwnProperty(group)) {\n        // $FlowFixMe\n        var family = group;\n        s = {\n          type: \"atom\",\n          mode: this.mode,\n          family,\n          loc,\n          text\n        };\n      } else {\n        // $FlowFixMe\n        s = {\n          type: group,\n          mode: this.mode,\n          loc,\n          text\n        };\n      } // $FlowFixMe\n\n\n      symbol = s;\n    } else if (text.charCodeAt(0) >= 0x80) {\n      // no symbol for e.g. ^\n      if (this.settings.strict) {\n        if (!supportedCodepoint(text.charCodeAt(0))) {\n          this.settings.reportNonstrict(\"unknownSymbol\", \"Unrecognized Unicode character \\\"\" + text[0] + \"\\\"\" + (\" (\" + text.charCodeAt(0) + \")\"), nucleus);\n        } else if (this.mode === \"math\") {\n          this.settings.reportNonstrict(\"unicodeTextInMathMode\", \"Unicode text character \\\"\" + text[0] + \"\\\" used in math mode\", nucleus);\n        }\n      } // All nonmathematical Unicode characters are rendered as if they\n      // are in text mode (wrapped in \\text) because that's what it\n      // takes to render them in LaTeX.  Setting `mode: this.mode` is\n      // another natural choice (the user requested math mode), but\n      // this makes it more difficult for getCharacterMetrics() to\n      // distinguish Unicode characters without metrics and those for\n      // which we want to simulate the letter M.\n\n\n      symbol = {\n        type: \"textord\",\n        mode: \"text\",\n        loc: SourceLocation.range(nucleus),\n        text\n      };\n    } else {\n      return null; // EOF, ^, _, {, }, etc.\n    }\n\n    this.consume(); // Transform combining characters into accents\n\n    if (match) {\n      for (var i = 0; i < match[0].length; i++) {\n        var accent = match[0][i];\n\n        if (!unicodeAccents[accent]) {\n          throw new ParseError(\"Unknown accent ' \" + accent + \"'\", nucleus);\n        }\n\n        var command = unicodeAccents[accent][this.mode] || unicodeAccents[accent].text;\n\n        if (!command) {\n          throw new ParseError(\"Accent \" + accent + \" unsupported in \" + this.mode + \" mode\", nucleus);\n        }\n\n        symbol = {\n          type: \"accent\",\n          mode: this.mode,\n          loc: SourceLocation.range(nucleus),\n          label: command,\n          isStretchy: false,\n          isShifty: true,\n          // $FlowFixMe\n          base: symbol\n        };\n      }\n    } // $FlowFixMe\n\n\n    return symbol;\n  }\n\n}\nParser.endOfExpression = [\"}\", \"\\\\endgroup\", \"\\\\end\", \"\\\\right\", \"&\"];\n\n/**\n * Provides a single function for parsing an expression using a Parser\n * TODO(emily): Remove this\n */\n\n/**\n * Parses an expression using a Parser, then returns the parsed result.\n */\nvar parseTree = function parseTree(toParse, settings) {\n  if (!(typeof toParse === 'string' || toParse instanceof String)) {\n    throw new TypeError('KaTeX can only parse string typed expression');\n  }\n\n  var parser = new Parser(toParse, settings); // Blank out any \\df@tag to avoid spurious \"Duplicate \\tag\" errors\n\n  delete parser.gullet.macros.current[\"\\\\df@tag\"];\n  var tree = parser.parse(); // Prevent a color definition from persisting between calls to katex.render().\n\n  delete parser.gullet.macros.current[\"\\\\current@color\"];\n  delete parser.gullet.macros.current[\"\\\\color\"]; // If the input used \\tag, it will set the \\df@tag macro to the tag.\n  // In this case, we separately parse the tag and wrap the tree.\n\n  if (parser.gullet.macros.get(\"\\\\df@tag\")) {\n    if (!settings.displayMode) {\n      throw new ParseError(\"\\\\tag works only in display equations\");\n    }\n\n    tree = [{\n      type: \"tag\",\n      mode: \"text\",\n      body: tree,\n      tag: parser.subparse([new Token(\"\\\\df@tag\")])\n    }];\n  }\n\n  return tree;\n};\n\n/* eslint no-console:0 */\n\n/**\n * Parse and build an expression, and place that expression in the DOM node\n * given.\n */\nvar render = function render(expression, baseNode, options) {\n  baseNode.textContent = \"\";\n  var node = renderToDomTree(expression, options).toNode();\n  baseNode.appendChild(node);\n}; // KaTeX's styles don't work properly in quirks mode. Print out an error, and\n// disable rendering.\n\n\nif (typeof document !== \"undefined\") {\n  if (document.compatMode !== \"CSS1Compat\") {\n    typeof console !== \"undefined\" && console.warn(\"Warning: KaTeX doesn't work in quirks mode. Make sure your \" + \"website has a suitable doctype.\");\n\n    render = function render() {\n      throw new ParseError(\"KaTeX doesn't work in quirks mode.\");\n    };\n  }\n}\n/**\n * Parse and build an expression, and return the markup for that.\n */\n\n\nvar renderToString = function renderToString(expression, options) {\n  var markup = renderToDomTree(expression, options).toMarkup();\n  return markup;\n};\n/**\n * Parse an expression and return the parse tree.\n */\n\n\nvar generateParseTree = function generateParseTree(expression, options) {\n  var settings = new Settings(options);\n  return parseTree(expression, settings);\n};\n/**\n * If the given error is a KaTeX ParseError and options.throwOnError is false,\n * renders the invalid LaTeX as a span with hover title giving the KaTeX\n * error message.  Otherwise, simply throws the error.\n */\n\n\nvar renderError = function renderError(error, expression, options) {\n  if (options.throwOnError || !(error instanceof ParseError)) {\n    throw error;\n  }\n\n  var node = buildCommon.makeSpan([\"katex-error\"], [new SymbolNode(expression)]);\n  node.setAttribute(\"title\", error.toString());\n  node.setAttribute(\"style\", \"color:\" + options.errorColor);\n  return node;\n};\n/**\n * Generates and returns the katex build tree. This is used for advanced\n * use cases (like rendering to custom output).\n */\n\n\nvar renderToDomTree = function renderToDomTree(expression, options) {\n  var settings = new Settings(options);\n\n  try {\n    var tree = parseTree(expression, settings);\n    return buildTree(tree, expression, settings);\n  } catch (error) {\n    return renderError(error, expression, settings);\n  }\n};\n/**\n * Generates and returns the katex build tree, with just HTML (no MathML).\n * This is used for advanced use cases (like rendering to custom output).\n */\n\n\nvar renderToHTMLTree = function renderToHTMLTree(expression, options) {\n  var settings = new Settings(options);\n\n  try {\n    var tree = parseTree(expression, settings);\n    return buildHTMLTree(tree, expression, settings);\n  } catch (error) {\n    return renderError(error, expression, settings);\n  }\n};\n\nvar version = \"0.16.22\";\nvar __domTree = {\n  Span,\n  Anchor,\n  SymbolNode,\n  SvgNode,\n  PathNode,\n  LineNode\n}; // ESM exports\n\nvar katex = {\n  /**\n   * Current KaTeX version\n   */\n  version,\n\n  /**\n   * Renders the given LaTeX into an HTML+MathML combination, and adds\n   * it as a child to the specified DOM node.\n   */\n  render,\n\n  /**\n   * Renders the given LaTeX into an HTML+MathML combination string,\n   * for sending to the client.\n   */\n  renderToString,\n\n  /**\n   * KaTeX error, usually during parsing.\n   */\n  ParseError,\n\n  /**\n   * The schema of Settings\n   */\n  SETTINGS_SCHEMA,\n\n  /**\n   * Parses the given LaTeX into KaTeX's internal parse tree structure,\n   * without rendering to HTML or MathML.\n   *\n   * NOTE: This method is not currently recommended for public use.\n   * The internal tree representation is unstable and is very likely\n   * to change. Use at your own risk.\n   */\n  __parse: generateParseTree,\n\n  /**\n   * Renders the given LaTeX into an HTML+MathML internal DOM tree\n   * representation, without flattening that representation to a string.\n   *\n   * NOTE: This method is not currently recommended for public use.\n   * The internal tree representation is unstable and is very likely\n   * to change. Use at your own risk.\n   */\n  __renderToDomTree: renderToDomTree,\n\n  /**\n   * Renders the given LaTeX into an HTML internal DOM tree representation,\n   * without MathML and without flattening that representation to a string.\n   *\n   * NOTE: This method is not currently recommended for public use.\n   * The internal tree representation is unstable and is very likely\n   * to change. Use at your own risk.\n   */\n  __renderToHTMLTree: renderToHTMLTree,\n\n  /**\n   * extends internal font metrics object with a new object\n   * each key in the new object represents a font name\n  */\n  __setFontMetrics: setFontMetrics,\n\n  /**\n   * adds a new symbol to builtin symbols table\n   */\n  __defineSymbol: defineSymbol,\n\n  /**\n   * adds a new function to builtin function list,\n   * which directly produce parse tree elements\n   * and have their own html/mathml builders\n   */\n  __defineFunction: defineFunction,\n\n  /**\n   * adds a new macro to builtin macro list\n   */\n  __defineMacro: defineMacro,\n\n  /**\n   * Expose the dom tree node types, which can be useful for type checking nodes.\n   *\n   * NOTE: These methods are not currently recommended for public use.\n   * The internal tree representation is unstable and is very likely\n   * to change. Use at your own risk.\n   */\n  __domTree\n};\n\nexport { ParseError, SETTINGS_SCHEMA, defineFunction as __defineFunction, defineMacro as __defineMacro, defineSymbol as __defineSymbol, __domTree, generateParseTree as __parse, renderToDomTree as __renderToDomTree, renderToHTMLTree as __renderToHTMLTree, setFontMetrics as __setFontMetrics, katex as default, render, renderToString, version };\n",";/*! showdown v 2.1.0 - 21-04-2022 */\r\n(function(){\r\n/**\n * Created by Tivie on 13-07-2015.\n */\n\nfunction getDefaultOpts (simple) {\n  'use strict';\n\n  var defaultOptions = {\n    omitExtraWLInCodeBlocks: {\n      defaultValue: false,\n      describe: 'Omit the default extra whiteline added to code blocks',\n      type: 'boolean'\n    },\n    noHeaderId: {\n      defaultValue: false,\n      describe: 'Turn on/off generated header id',\n      type: 'boolean'\n    },\n    prefixHeaderId: {\n      defaultValue: false,\n      describe: 'Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic \\'section-\\' prefix',\n      type: 'string'\n    },\n    rawPrefixHeaderId: {\n      defaultValue: false,\n      describe: 'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the \" char is used in the prefix)',\n      type: 'boolean'\n    },\n    ghCompatibleHeaderId: {\n      defaultValue: false,\n      describe: 'Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)',\n      type: 'boolean'\n    },\n    rawHeaderId: {\n      defaultValue: false,\n      describe: 'Remove only spaces, \\' and \" from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids',\n      type: 'boolean'\n    },\n    headerLevelStart: {\n      defaultValue: false,\n      describe: 'The header blocks level start',\n      type: 'integer'\n    },\n    parseImgDimensions: {\n      defaultValue: false,\n      describe: 'Turn on/off image dimension parsing',\n      type: 'boolean'\n    },\n    simplifiedAutoLink: {\n      defaultValue: false,\n      describe: 'Turn on/off GFM autolink style',\n      type: 'boolean'\n    },\n    excludeTrailingPunctuationFromURLs: {\n      defaultValue: false,\n      describe: 'Excludes trailing punctuation from links generated with autoLinking',\n      type: 'boolean'\n    },\n    literalMidWordUnderscores: {\n      defaultValue: false,\n      describe: 'Parse midword underscores as literal underscores',\n      type: 'boolean'\n    },\n    literalMidWordAsterisks: {\n      defaultValue: false,\n      describe: 'Parse midword asterisks as literal asterisks',\n      type: 'boolean'\n    },\n    strikethrough: {\n      defaultValue: false,\n      describe: 'Turn on/off strikethrough support',\n      type: 'boolean'\n    },\n    tables: {\n      defaultValue: false,\n      describe: 'Turn on/off tables support',\n      type: 'boolean'\n    },\n    tablesHeaderId: {\n      defaultValue: false,\n      describe: 'Add an id to table headers',\n      type: 'boolean'\n    },\n    ghCodeBlocks: {\n      defaultValue: true,\n      describe: 'Turn on/off GFM fenced code blocks support',\n      type: 'boolean'\n    },\n    tasklists: {\n      defaultValue: false,\n      describe: 'Turn on/off GFM tasklist support',\n      type: 'boolean'\n    },\n    smoothLivePreview: {\n      defaultValue: false,\n      describe: 'Prevents weird effects in live previews due to incomplete input',\n      type: 'boolean'\n    },\n    smartIndentationFix: {\n      defaultValue: false,\n      describe: 'Tries to smartly fix indentation in es6 strings',\n      type: 'boolean'\n    },\n    disableForced4SpacesIndentedSublists: {\n      defaultValue: false,\n      describe: 'Disables the requirement of indenting nested sublists by 4 spaces',\n      type: 'boolean'\n    },\n    simpleLineBreaks: {\n      defaultValue: false,\n      describe: 'Parses simple line breaks as <br> (GFM Style)',\n      type: 'boolean'\n    },\n    requireSpaceBeforeHeadingText: {\n      defaultValue: false,\n      describe: 'Makes adding a space between `#` and the header text mandatory (GFM Style)',\n      type: 'boolean'\n    },\n    ghMentions: {\n      defaultValue: false,\n      describe: 'Enables github @mentions',\n      type: 'boolean'\n    },\n    ghMentionsLink: {\n      defaultValue: 'https://github.com/{u}',\n      describe: 'Changes the link generated by @mentions. Only applies if ghMentions option is enabled.',\n      type: 'string'\n    },\n    encodeEmails: {\n      defaultValue: true,\n      describe: 'Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities',\n      type: 'boolean'\n    },\n    openLinksInNewWindow: {\n      defaultValue: false,\n      describe: 'Open all links in new windows',\n      type: 'boolean'\n    },\n    backslashEscapesHTMLTags: {\n      defaultValue: false,\n      describe: 'Support for HTML Tag escaping. ex: \\<div>foo\\</div>',\n      type: 'boolean'\n    },\n    emoji: {\n      defaultValue: false,\n      describe: 'Enable emoji support. Ex: `this is a :smile: emoji`',\n      type: 'boolean'\n    },\n    underline: {\n      defaultValue: false,\n      describe: 'Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`',\n      type: 'boolean'\n    },\n    ellipsis: {\n      defaultValue: true,\n      describe: 'Replaces three dots with the ellipsis unicode character',\n      type: 'boolean'\n    },\n    completeHTMLDocument: {\n      defaultValue: false,\n      describe: 'Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags',\n      type: 'boolean'\n    },\n    metadata: {\n      defaultValue: false,\n      describe: 'Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).',\n      type: 'boolean'\n    },\n    splitAdjacentBlockquotes: {\n      defaultValue: false,\n      describe: 'Split adjacent blockquote blocks',\n      type: 'boolean'\n    }\n  };\n  if (simple === false) {\n    return JSON.parse(JSON.stringify(defaultOptions));\n  }\n  var ret = {};\n  for (var opt in defaultOptions) {\n    if (defaultOptions.hasOwnProperty(opt)) {\n      ret[opt] = defaultOptions[opt].defaultValue;\n    }\n  }\n  return ret;\n}\n\nfunction allOptionsOn () {\n  'use strict';\n  var options = getDefaultOpts(true),\n      ret = {};\n  for (var opt in options) {\n    if (options.hasOwnProperty(opt)) {\n      ret[opt] = true;\n    }\n  }\n  return ret;\n}\n\r\n/**\n * Created by Tivie on 06-01-2015.\n */\n\n// Private properties\nvar showdown = {},\n    parsers = {},\n    extensions = {},\n    globalOptions = getDefaultOpts(true),\n    setFlavor = 'vanilla',\n    flavor = {\n      github: {\n        omitExtraWLInCodeBlocks:              true,\n        simplifiedAutoLink:                   true,\n        excludeTrailingPunctuationFromURLs:   true,\n        literalMidWordUnderscores:            true,\n        strikethrough:                        true,\n        tables:                               true,\n        tablesHeaderId:                       true,\n        ghCodeBlocks:                         true,\n        tasklists:                            true,\n        disableForced4SpacesIndentedSublists: true,\n        simpleLineBreaks:                     true,\n        requireSpaceBeforeHeadingText:        true,\n        ghCompatibleHeaderId:                 true,\n        ghMentions:                           true,\n        backslashEscapesHTMLTags:             true,\n        emoji:                                true,\n        splitAdjacentBlockquotes:             true\n      },\n      original: {\n        noHeaderId:                           true,\n        ghCodeBlocks:                         false\n      },\n      ghost: {\n        omitExtraWLInCodeBlocks:              true,\n        parseImgDimensions:                   true,\n        simplifiedAutoLink:                   true,\n        excludeTrailingPunctuationFromURLs:   true,\n        literalMidWordUnderscores:            true,\n        strikethrough:                        true,\n        tables:                               true,\n        tablesHeaderId:                       true,\n        ghCodeBlocks:                         true,\n        tasklists:                            true,\n        smoothLivePreview:                    true,\n        simpleLineBreaks:                     true,\n        requireSpaceBeforeHeadingText:        true,\n        ghMentions:                           false,\n        encodeEmails:                         true\n      },\n      vanilla: getDefaultOpts(true),\n      allOn: allOptionsOn()\n    };\n\n/**\n * helper namespace\n * @type {{}}\n */\nshowdown.helper = {};\n\n/**\n * TODO LEGACY SUPPORT CODE\n * @type {{}}\n */\nshowdown.extensions = {};\n\n/**\n * Set a global option\n * @static\n * @param {string} key\n * @param {*} value\n * @returns {showdown}\n */\nshowdown.setOption = function (key, value) {\n  'use strict';\n  globalOptions[key] = value;\n  return this;\n};\n\n/**\n * Get a global option\n * @static\n * @param {string} key\n * @returns {*}\n */\nshowdown.getOption = function (key) {\n  'use strict';\n  return globalOptions[key];\n};\n\n/**\n * Get the global options\n * @static\n * @returns {{}}\n */\nshowdown.getOptions = function () {\n  'use strict';\n  return globalOptions;\n};\n\n/**\n * Reset global options to the default values\n * @static\n */\nshowdown.resetOptions = function () {\n  'use strict';\n  globalOptions = getDefaultOpts(true);\n};\n\n/**\n * Set the flavor showdown should use as default\n * @param {string} name\n */\nshowdown.setFlavor = function (name) {\n  'use strict';\n  if (!flavor.hasOwnProperty(name)) {\n    throw Error(name + ' flavor was not found');\n  }\n  showdown.resetOptions();\n  var preset = flavor[name];\n  setFlavor = name;\n  for (var option in preset) {\n    if (preset.hasOwnProperty(option)) {\n      globalOptions[option] = preset[option];\n    }\n  }\n};\n\n/**\n * Get the currently set flavor\n * @returns {string}\n */\nshowdown.getFlavor = function () {\n  'use strict';\n  return setFlavor;\n};\n\n/**\n * Get the options of a specified flavor. Returns undefined if the flavor was not found\n * @param {string} name Name of the flavor\n * @returns {{}|undefined}\n */\nshowdown.getFlavorOptions = function (name) {\n  'use strict';\n  if (flavor.hasOwnProperty(name)) {\n    return flavor[name];\n  }\n};\n\n/**\n * Get the default options\n * @static\n * @param {boolean} [simple=true]\n * @returns {{}}\n */\nshowdown.getDefaultOptions = function (simple) {\n  'use strict';\n  return getDefaultOpts(simple);\n};\n\n/**\n * Get or set a subParser\n *\n * subParser(name)       - Get a registered subParser\n * subParser(name, func) - Register a subParser\n * @static\n * @param {string} name\n * @param {function} [func]\n * @returns {*}\n */\nshowdown.subParser = function (name, func) {\n  'use strict';\n  if (showdown.helper.isString(name)) {\n    if (typeof func !== 'undefined') {\n      parsers[name] = func;\n    } else {\n      if (parsers.hasOwnProperty(name)) {\n        return parsers[name];\n      } else {\n        throw Error('SubParser named ' + name + ' not registered!');\n      }\n    }\n  }\n};\n\n/**\n * Gets or registers an extension\n * @static\n * @param {string} name\n * @param {object|object[]|function=} ext\n * @returns {*}\n */\nshowdown.extension = function (name, ext) {\n  'use strict';\n\n  if (!showdown.helper.isString(name)) {\n    throw Error('Extension \\'name\\' must be a string');\n  }\n\n  name = showdown.helper.stdExtName(name);\n\n  // Getter\n  if (showdown.helper.isUndefined(ext)) {\n    if (!extensions.hasOwnProperty(name)) {\n      throw Error('Extension named ' + name + ' is not registered!');\n    }\n    return extensions[name];\n\n    // Setter\n  } else {\n    // Expand extension if it's wrapped in a function\n    if (typeof ext === 'function') {\n      ext = ext();\n    }\n\n    // Ensure extension is an array\n    if (!showdown.helper.isArray(ext)) {\n      ext = [ext];\n    }\n\n    var validExtension = validate(ext, name);\n\n    if (validExtension.valid) {\n      extensions[name] = ext;\n    } else {\n      throw Error(validExtension.error);\n    }\n  }\n};\n\n/**\n * Gets all extensions registered\n * @returns {{}}\n */\nshowdown.getAllExtensions = function () {\n  'use strict';\n  return extensions;\n};\n\n/**\n * Remove an extension\n * @param {string} name\n */\nshowdown.removeExtension = function (name) {\n  'use strict';\n  delete extensions[name];\n};\n\n/**\n * Removes all extensions\n */\nshowdown.resetExtensions = function () {\n  'use strict';\n  extensions = {};\n};\n\n/**\n * Validate extension\n * @param {array} extension\n * @param {string} name\n * @returns {{valid: boolean, error: string}}\n */\nfunction validate (extension, name) {\n  'use strict';\n\n  var errMsg = (name) ? 'Error in ' + name + ' extension->' : 'Error in unnamed extension',\n      ret = {\n        valid: true,\n        error: ''\n      };\n\n  if (!showdown.helper.isArray(extension)) {\n    extension = [extension];\n  }\n\n  for (var i = 0; i < extension.length; ++i) {\n    var baseMsg = errMsg + ' sub-extension ' + i + ': ',\n        ext = extension[i];\n    if (typeof ext !== 'object') {\n      ret.valid = false;\n      ret.error = baseMsg + 'must be an object, but ' + typeof ext + ' given';\n      return ret;\n    }\n\n    if (!showdown.helper.isString(ext.type)) {\n      ret.valid = false;\n      ret.error = baseMsg + 'property \"type\" must be a string, but ' + typeof ext.type + ' given';\n      return ret;\n    }\n\n    var type = ext.type = ext.type.toLowerCase();\n\n    // normalize extension type\n    if (type === 'language') {\n      type = ext.type = 'lang';\n    }\n\n    if (type === 'html') {\n      type = ext.type = 'output';\n    }\n\n    if (type !== 'lang' && type !== 'output' && type !== 'listener') {\n      ret.valid = false;\n      ret.error = baseMsg + 'type ' + type + ' is not recognized. Valid values: \"lang/language\", \"output/html\" or \"listener\"';\n      return ret;\n    }\n\n    if (type === 'listener') {\n      if (showdown.helper.isUndefined(ext.listeners)) {\n        ret.valid = false;\n        ret.error = baseMsg + '. Extensions of type \"listener\" must have a property called \"listeners\"';\n        return ret;\n      }\n    } else {\n      if (showdown.helper.isUndefined(ext.filter) && showdown.helper.isUndefined(ext.regex)) {\n        ret.valid = false;\n        ret.error = baseMsg + type + ' extensions must define either a \"regex\" property or a \"filter\" method';\n        return ret;\n      }\n    }\n\n    if (ext.listeners) {\n      if (typeof ext.listeners !== 'object') {\n        ret.valid = false;\n        ret.error = baseMsg + '\"listeners\" property must be an object but ' + typeof ext.listeners + ' given';\n        return ret;\n      }\n      for (var ln in ext.listeners) {\n        if (ext.listeners.hasOwnProperty(ln)) {\n          if (typeof ext.listeners[ln] !== 'function') {\n            ret.valid = false;\n            ret.error = baseMsg + '\"listeners\" property must be an hash of [event name]: [callback]. listeners.' + ln +\n              ' must be a function but ' + typeof ext.listeners[ln] + ' given';\n            return ret;\n          }\n        }\n      }\n    }\n\n    if (ext.filter) {\n      if (typeof ext.filter !== 'function') {\n        ret.valid = false;\n        ret.error = baseMsg + '\"filter\" must be a function, but ' + typeof ext.filter + ' given';\n        return ret;\n      }\n    } else if (ext.regex) {\n      if (showdown.helper.isString(ext.regex)) {\n        ext.regex = new RegExp(ext.regex, 'g');\n      }\n      if (!(ext.regex instanceof RegExp)) {\n        ret.valid = false;\n        ret.error = baseMsg + '\"regex\" property must either be a string or a RegExp object, but ' + typeof ext.regex + ' given';\n        return ret;\n      }\n      if (showdown.helper.isUndefined(ext.replace)) {\n        ret.valid = false;\n        ret.error = baseMsg + '\"regex\" extensions must implement a replace string or function';\n        return ret;\n      }\n    }\n  }\n  return ret;\n}\n\n/**\n * Validate extension\n * @param {object} ext\n * @returns {boolean}\n */\nshowdown.validateExtension = function (ext) {\n  'use strict';\n\n  var validateExtension = validate(ext, null);\n  if (!validateExtension.valid) {\n    console.warn(validateExtension.error);\n    return false;\n  }\n  return true;\n};\n\r\n/**\n * showdownjs helper functions\n */\n\nif (!showdown.hasOwnProperty('helper')) {\n  showdown.helper = {};\n}\n\n/**\n * Check if var is string\n * @static\n * @param {string} a\n * @returns {boolean}\n */\nshowdown.helper.isString = function (a) {\n  'use strict';\n  return (typeof a === 'string' || a instanceof String);\n};\n\n/**\n * Check if var is a function\n * @static\n * @param {*} a\n * @returns {boolean}\n */\nshowdown.helper.isFunction = function (a) {\n  'use strict';\n  var getType = {};\n  return a && getType.toString.call(a) === '[object Function]';\n};\n\n/**\n * isArray helper function\n * @static\n * @param {*} a\n * @returns {boolean}\n */\nshowdown.helper.isArray = function (a) {\n  'use strict';\n  return Array.isArray(a);\n};\n\n/**\n * Check if value is undefined\n * @static\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n */\nshowdown.helper.isUndefined = function (value) {\n  'use strict';\n  return typeof value === 'undefined';\n};\n\n/**\n * ForEach helper function\n * Iterates over Arrays and Objects (own properties only)\n * @static\n * @param {*} obj\n * @param {function} callback Accepts 3 params: 1. value, 2. key, 3. the original array/object\n */\nshowdown.helper.forEach = function (obj, callback) {\n  'use strict';\n  // check if obj is defined\n  if (showdown.helper.isUndefined(obj)) {\n    throw new Error('obj param is required');\n  }\n\n  if (showdown.helper.isUndefined(callback)) {\n    throw new Error('callback param is required');\n  }\n\n  if (!showdown.helper.isFunction(callback)) {\n    throw new Error('callback param must be a function/closure');\n  }\n\n  if (typeof obj.forEach === 'function') {\n    obj.forEach(callback);\n  } else if (showdown.helper.isArray(obj)) {\n    for (var i = 0; i < obj.length; i++) {\n      callback(obj[i], i, obj);\n    }\n  } else if (typeof (obj) === 'object') {\n    for (var prop in obj) {\n      if (obj.hasOwnProperty(prop)) {\n        callback(obj[prop], prop, obj);\n      }\n    }\n  } else {\n    throw new Error('obj does not seem to be an array or an iterable object');\n  }\n};\n\n/**\n * Standardidize extension name\n * @static\n * @param {string} s extension name\n * @returns {string}\n */\nshowdown.helper.stdExtName = function (s) {\n  'use strict';\n  return s.replace(/[_?*+\\/\\\\.^-]/g, '').replace(/\\s/g, '').toLowerCase();\n};\n\nfunction escapeCharactersCallback (wholeMatch, m1) {\n  'use strict';\n  var charCodeToEscape = m1.charCodeAt(0);\n  return '¨E' + charCodeToEscape + 'E';\n}\n\n/**\n * Callback used to escape characters when passing through String.replace\n * @static\n * @param {string} wholeMatch\n * @param {string} m1\n * @returns {string}\n */\nshowdown.helper.escapeCharactersCallback = escapeCharactersCallback;\n\n/**\n * Escape characters in a string\n * @static\n * @param {string} text\n * @param {string} charsToEscape\n * @param {boolean} afterBackslash\n * @returns {XML|string|void|*}\n */\nshowdown.helper.escapeCharacters = function (text, charsToEscape, afterBackslash) {\n  'use strict';\n  // First we have to escape the escape characters so that\n  // we can build a character class out of them\n  var regexString = '([' + charsToEscape.replace(/([\\[\\]\\\\])/g, '\\\\$1') + '])';\n\n  if (afterBackslash) {\n    regexString = '\\\\\\\\' + regexString;\n  }\n\n  var regex = new RegExp(regexString, 'g');\n  text = text.replace(regex, escapeCharactersCallback);\n\n  return text;\n};\n\n/**\n * Unescape HTML entities\n * @param txt\n * @returns {string}\n */\nshowdown.helper.unescapeHTMLEntities = function (txt) {\n  'use strict';\n\n  return txt\n    .replace(/&quot;/g, '\"')\n    .replace(/&lt;/g, '<')\n    .replace(/&gt;/g, '>')\n    .replace(/&amp;/g, '&');\n};\n\nvar rgxFindMatchPos = function (str, left, right, flags) {\n  'use strict';\n  var f = flags || '',\n      g = f.indexOf('g') > -1,\n      x = new RegExp(left + '|' + right, 'g' + f.replace(/g/g, '')),\n      l = new RegExp(left, f.replace(/g/g, '')),\n      pos = [],\n      t, s, m, start, end;\n\n  do {\n    t = 0;\n    while ((m = x.exec(str))) {\n      if (l.test(m[0])) {\n        if (!(t++)) {\n          s = x.lastIndex;\n          start = s - m[0].length;\n        }\n      } else if (t) {\n        if (!--t) {\n          end = m.index + m[0].length;\n          var obj = {\n            left: {start: start, end: s},\n            match: {start: s, end: m.index},\n            right: {start: m.index, end: end},\n            wholeMatch: {start: start, end: end}\n          };\n          pos.push(obj);\n          if (!g) {\n            return pos;\n          }\n        }\n      }\n    }\n  } while (t && (x.lastIndex = s));\n\n  return pos;\n};\n\n/**\n * matchRecursiveRegExp\n *\n * (c) 2007 Steven Levithan <stevenlevithan.com>\n * MIT License\n *\n * Accepts a string to search, a left and right format delimiter\n * as regex patterns, and optional regex flags. Returns an array\n * of matches, allowing nested instances of left/right delimiters.\n * Use the \"g\" flag to return all matches, otherwise only the\n * first is returned. Be careful to ensure that the left and\n * right format delimiters produce mutually exclusive matches.\n * Backreferences are not supported within the right delimiter\n * due to how it is internally combined with the left delimiter.\n * When matching strings whose format delimiters are unbalanced\n * to the left or right, the output is intentionally as a\n * conventional regex library with recursion support would\n * produce, e.g. \"<<x>\" and \"<x>>\" both produce [\"x\"] when using\n * \"<\" and \">\" as the delimiters (both strings contain a single,\n * balanced instance of \"<x>\").\n *\n * examples:\n * matchRecursiveRegExp(\"test\", \"\\\\(\", \"\\\\)\")\n * returns: []\n * matchRecursiveRegExp(\"<t<<e>><s>>t<>\", \"<\", \">\", \"g\")\n * returns: [\"t<<e>><s>\", \"\"]\n * matchRecursiveRegExp(\"<div id=\\\"x\\\">test</div>\", \"<div\\\\b[^>]*>\", \"</div>\", \"gi\")\n * returns: [\"test\"]\n */\nshowdown.helper.matchRecursiveRegExp = function (str, left, right, flags) {\n  'use strict';\n\n  var matchPos = rgxFindMatchPos (str, left, right, flags),\n      results = [];\n\n  for (var i = 0; i < matchPos.length; ++i) {\n    results.push([\n      str.slice(matchPos[i].wholeMatch.start, matchPos[i].wholeMatch.end),\n      str.slice(matchPos[i].match.start, matchPos[i].match.end),\n      str.slice(matchPos[i].left.start, matchPos[i].left.end),\n      str.slice(matchPos[i].right.start, matchPos[i].right.end)\n    ]);\n  }\n  return results;\n};\n\n/**\n *\n * @param {string} str\n * @param {string|function} replacement\n * @param {string} left\n * @param {string} right\n * @param {string} flags\n * @returns {string}\n */\nshowdown.helper.replaceRecursiveRegExp = function (str, replacement, left, right, flags) {\n  'use strict';\n\n  if (!showdown.helper.isFunction(replacement)) {\n    var repStr = replacement;\n    replacement = function () {\n      return repStr;\n    };\n  }\n\n  var matchPos = rgxFindMatchPos(str, left, right, flags),\n      finalStr = str,\n      lng = matchPos.length;\n\n  if (lng > 0) {\n    var bits = [];\n    if (matchPos[0].wholeMatch.start !== 0) {\n      bits.push(str.slice(0, matchPos[0].wholeMatch.start));\n    }\n    for (var i = 0; i < lng; ++i) {\n      bits.push(\n        replacement(\n          str.slice(matchPos[i].wholeMatch.start, matchPos[i].wholeMatch.end),\n          str.slice(matchPos[i].match.start, matchPos[i].match.end),\n          str.slice(matchPos[i].left.start, matchPos[i].left.end),\n          str.slice(matchPos[i].right.start, matchPos[i].right.end)\n        )\n      );\n      if (i < lng - 1) {\n        bits.push(str.slice(matchPos[i].wholeMatch.end, matchPos[i + 1].wholeMatch.start));\n      }\n    }\n    if (matchPos[lng - 1].wholeMatch.end < str.length) {\n      bits.push(str.slice(matchPos[lng - 1].wholeMatch.end));\n    }\n    finalStr = bits.join('');\n  }\n  return finalStr;\n};\n\n/**\n * Returns the index within the passed String object of the first occurrence of the specified regex,\n * starting the search at fromIndex. Returns -1 if the value is not found.\n *\n * @param {string} str string to search\n * @param {RegExp} regex Regular expression to search\n * @param {int} [fromIndex = 0] Index to start the search\n * @returns {Number}\n * @throws InvalidArgumentError\n */\nshowdown.helper.regexIndexOf = function (str, regex, fromIndex) {\n  'use strict';\n  if (!showdown.helper.isString(str)) {\n    throw 'InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string';\n  }\n  if (regex instanceof RegExp === false) {\n    throw 'InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp';\n  }\n  var indexOf = str.substring(fromIndex || 0).search(regex);\n  return (indexOf >= 0) ? (indexOf + (fromIndex || 0)) : indexOf;\n};\n\n/**\n * Splits the passed string object at the defined index, and returns an array composed of the two substrings\n * @param {string} str string to split\n * @param {int} index index to split string at\n * @returns {[string,string]}\n * @throws InvalidArgumentError\n */\nshowdown.helper.splitAtIndex = function (str, index) {\n  'use strict';\n  if (!showdown.helper.isString(str)) {\n    throw 'InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string';\n  }\n  return [str.substring(0, index), str.substring(index)];\n};\n\n/**\n * Obfuscate an e-mail address through the use of Character Entities,\n * transforming ASCII characters into their equivalent decimal or hex entities.\n *\n * Since it has a random component, subsequent calls to this function produce different results\n *\n * @param {string} mail\n * @returns {string}\n */\nshowdown.helper.encodeEmailAddress = function (mail) {\n  'use strict';\n  var encode = [\n    function (ch) {\n      return '&#' + ch.charCodeAt(0) + ';';\n    },\n    function (ch) {\n      return '&#x' + ch.charCodeAt(0).toString(16) + ';';\n    },\n    function (ch) {\n      return ch;\n    }\n  ];\n\n  mail = mail.replace(/./g, function (ch) {\n    if (ch === '@') {\n      // this *must* be encoded. I insist.\n      ch = encode[Math.floor(Math.random() * 2)](ch);\n    } else {\n      var r = Math.random();\n      // roughly 10% raw, 45% hex, 45% dec\n      ch = (\n        r > 0.9 ? encode[2](ch) : r > 0.45 ? encode[1](ch) : encode[0](ch)\n      );\n    }\n    return ch;\n  });\n\n  return mail;\n};\n\n/**\n *\n * @param str\n * @param targetLength\n * @param padString\n * @returns {string}\n */\nshowdown.helper.padEnd = function padEnd (str, targetLength, padString) {\n  'use strict';\n  /*jshint bitwise: false*/\n  // eslint-disable-next-line space-infix-ops\n  targetLength = targetLength>>0; //floor if number or convert non-number to 0;\n  /*jshint bitwise: true*/\n  padString = String(padString || ' ');\n  if (str.length > targetLength) {\n    return String(str);\n  } else {\n    targetLength = targetLength - str.length;\n    if (targetLength > padString.length) {\n      padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed\n    }\n    return String(str) + padString.slice(0,targetLength);\n  }\n};\n\n/**\n * POLYFILLS\n */\n// use this instead of builtin is undefined for IE8 compatibility\nif (typeof (console) === 'undefined') {\n  console = {\n    warn: function (msg) {\n      'use strict';\n      alert(msg);\n    },\n    log: function (msg) {\n      'use strict';\n      alert(msg);\n    },\n    error: function (msg) {\n      'use strict';\n      throw msg;\n    }\n  };\n}\n\n/**\n * Common regexes.\n * We declare some common regexes to improve performance\n */\nshowdown.helper.regexes = {\n  asteriskDashAndColon: /([*_:~])/g\n};\n\n/**\n * EMOJIS LIST\n */\nshowdown.helper.emojis = {\n  '+1':'\\ud83d\\udc4d',\n  '-1':'\\ud83d\\udc4e',\n  '100':'\\ud83d\\udcaf',\n  '1234':'\\ud83d\\udd22',\n  '1st_place_medal':'\\ud83e\\udd47',\n  '2nd_place_medal':'\\ud83e\\udd48',\n  '3rd_place_medal':'\\ud83e\\udd49',\n  '8ball':'\\ud83c\\udfb1',\n  'a':'\\ud83c\\udd70\\ufe0f',\n  'ab':'\\ud83c\\udd8e',\n  'abc':'\\ud83d\\udd24',\n  'abcd':'\\ud83d\\udd21',\n  'accept':'\\ud83c\\ude51',\n  'aerial_tramway':'\\ud83d\\udea1',\n  'airplane':'\\u2708\\ufe0f',\n  'alarm_clock':'\\u23f0',\n  'alembic':'\\u2697\\ufe0f',\n  'alien':'\\ud83d\\udc7d',\n  'ambulance':'\\ud83d\\ude91',\n  'amphora':'\\ud83c\\udffa',\n  'anchor':'\\u2693\\ufe0f',\n  'angel':'\\ud83d\\udc7c',\n  'anger':'\\ud83d\\udca2',\n  'angry':'\\ud83d\\ude20',\n  'anguished':'\\ud83d\\ude27',\n  'ant':'\\ud83d\\udc1c',\n  'apple':'\\ud83c\\udf4e',\n  'aquarius':'\\u2652\\ufe0f',\n  'aries':'\\u2648\\ufe0f',\n  'arrow_backward':'\\u25c0\\ufe0f',\n  'arrow_double_down':'\\u23ec',\n  'arrow_double_up':'\\u23eb',\n  'arrow_down':'\\u2b07\\ufe0f',\n  'arrow_down_small':'\\ud83d\\udd3d',\n  'arrow_forward':'\\u25b6\\ufe0f',\n  'arrow_heading_down':'\\u2935\\ufe0f',\n  'arrow_heading_up':'\\u2934\\ufe0f',\n  'arrow_left':'\\u2b05\\ufe0f',\n  'arrow_lower_left':'\\u2199\\ufe0f',\n  'arrow_lower_right':'\\u2198\\ufe0f',\n  'arrow_right':'\\u27a1\\ufe0f',\n  'arrow_right_hook':'\\u21aa\\ufe0f',\n  'arrow_up':'\\u2b06\\ufe0f',\n  'arrow_up_down':'\\u2195\\ufe0f',\n  'arrow_up_small':'\\ud83d\\udd3c',\n  'arrow_upper_left':'\\u2196\\ufe0f',\n  'arrow_upper_right':'\\u2197\\ufe0f',\n  'arrows_clockwise':'\\ud83d\\udd03',\n  'arrows_counterclockwise':'\\ud83d\\udd04',\n  'art':'\\ud83c\\udfa8',\n  'articulated_lorry':'\\ud83d\\ude9b',\n  'artificial_satellite':'\\ud83d\\udef0',\n  'astonished':'\\ud83d\\ude32',\n  'athletic_shoe':'\\ud83d\\udc5f',\n  'atm':'\\ud83c\\udfe7',\n  'atom_symbol':'\\u269b\\ufe0f',\n  'avocado':'\\ud83e\\udd51',\n  'b':'\\ud83c\\udd71\\ufe0f',\n  'baby':'\\ud83d\\udc76',\n  'baby_bottle':'\\ud83c\\udf7c',\n  'baby_chick':'\\ud83d\\udc24',\n  'baby_symbol':'\\ud83d\\udebc',\n  'back':'\\ud83d\\udd19',\n  'bacon':'\\ud83e\\udd53',\n  'badminton':'\\ud83c\\udff8',\n  'baggage_claim':'\\ud83d\\udec4',\n  'baguette_bread':'\\ud83e\\udd56',\n  'balance_scale':'\\u2696\\ufe0f',\n  'balloon':'\\ud83c\\udf88',\n  'ballot_box':'\\ud83d\\uddf3',\n  'ballot_box_with_check':'\\u2611\\ufe0f',\n  'bamboo':'\\ud83c\\udf8d',\n  'banana':'\\ud83c\\udf4c',\n  'bangbang':'\\u203c\\ufe0f',\n  'bank':'\\ud83c\\udfe6',\n  'bar_chart':'\\ud83d\\udcca',\n  'barber':'\\ud83d\\udc88',\n  'baseball':'\\u26be\\ufe0f',\n  'basketball':'\\ud83c\\udfc0',\n  'basketball_man':'\\u26f9\\ufe0f',\n  'basketball_woman':'\\u26f9\\ufe0f&zwj;\\u2640\\ufe0f',\n  'bat':'\\ud83e\\udd87',\n  'bath':'\\ud83d\\udec0',\n  'bathtub':'\\ud83d\\udec1',\n  'battery':'\\ud83d\\udd0b',\n  'beach_umbrella':'\\ud83c\\udfd6',\n  'bear':'\\ud83d\\udc3b',\n  'bed':'\\ud83d\\udecf',\n  'bee':'\\ud83d\\udc1d',\n  'beer':'\\ud83c\\udf7a',\n  'beers':'\\ud83c\\udf7b',\n  'beetle':'\\ud83d\\udc1e',\n  'beginner':'\\ud83d\\udd30',\n  'bell':'\\ud83d\\udd14',\n  'bellhop_bell':'\\ud83d\\udece',\n  'bento':'\\ud83c\\udf71',\n  'biking_man':'\\ud83d\\udeb4',\n  'bike':'\\ud83d\\udeb2',\n  'biking_woman':'\\ud83d\\udeb4&zwj;\\u2640\\ufe0f',\n  'bikini':'\\ud83d\\udc59',\n  'biohazard':'\\u2623\\ufe0f',\n  'bird':'\\ud83d\\udc26',\n  'birthday':'\\ud83c\\udf82',\n  'black_circle':'\\u26ab\\ufe0f',\n  'black_flag':'\\ud83c\\udff4',\n  'black_heart':'\\ud83d\\udda4',\n  'black_joker':'\\ud83c\\udccf',\n  'black_large_square':'\\u2b1b\\ufe0f',\n  'black_medium_small_square':'\\u25fe\\ufe0f',\n  'black_medium_square':'\\u25fc\\ufe0f',\n  'black_nib':'\\u2712\\ufe0f',\n  'black_small_square':'\\u25aa\\ufe0f',\n  'black_square_button':'\\ud83d\\udd32',\n  'blonde_man':'\\ud83d\\udc71',\n  'blonde_woman':'\\ud83d\\udc71&zwj;\\u2640\\ufe0f',\n  'blossom':'\\ud83c\\udf3c',\n  'blowfish':'\\ud83d\\udc21',\n  'blue_book':'\\ud83d\\udcd8',\n  'blue_car':'\\ud83d\\ude99',\n  'blue_heart':'\\ud83d\\udc99',\n  'blush':'\\ud83d\\ude0a',\n  'boar':'\\ud83d\\udc17',\n  'boat':'\\u26f5\\ufe0f',\n  'bomb':'\\ud83d\\udca3',\n  'book':'\\ud83d\\udcd6',\n  'bookmark':'\\ud83d\\udd16',\n  'bookmark_tabs':'\\ud83d\\udcd1',\n  'books':'\\ud83d\\udcda',\n  'boom':'\\ud83d\\udca5',\n  'boot':'\\ud83d\\udc62',\n  'bouquet':'\\ud83d\\udc90',\n  'bowing_man':'\\ud83d\\ude47',\n  'bow_and_arrow':'\\ud83c\\udff9',\n  'bowing_woman':'\\ud83d\\ude47&zwj;\\u2640\\ufe0f',\n  'bowling':'\\ud83c\\udfb3',\n  'boxing_glove':'\\ud83e\\udd4a',\n  'boy':'\\ud83d\\udc66',\n  'bread':'\\ud83c\\udf5e',\n  'bride_with_veil':'\\ud83d\\udc70',\n  'bridge_at_night':'\\ud83c\\udf09',\n  'briefcase':'\\ud83d\\udcbc',\n  'broken_heart':'\\ud83d\\udc94',\n  'bug':'\\ud83d\\udc1b',\n  'building_construction':'\\ud83c\\udfd7',\n  'bulb':'\\ud83d\\udca1',\n  'bullettrain_front':'\\ud83d\\ude85',\n  'bullettrain_side':'\\ud83d\\ude84',\n  'burrito':'\\ud83c\\udf2f',\n  'bus':'\\ud83d\\ude8c',\n  'business_suit_levitating':'\\ud83d\\udd74',\n  'busstop':'\\ud83d\\ude8f',\n  'bust_in_silhouette':'\\ud83d\\udc64',\n  'busts_in_silhouette':'\\ud83d\\udc65',\n  'butterfly':'\\ud83e\\udd8b',\n  'cactus':'\\ud83c\\udf35',\n  'cake':'\\ud83c\\udf70',\n  'calendar':'\\ud83d\\udcc6',\n  'call_me_hand':'\\ud83e\\udd19',\n  'calling':'\\ud83d\\udcf2',\n  'camel':'\\ud83d\\udc2b',\n  'camera':'\\ud83d\\udcf7',\n  'camera_flash':'\\ud83d\\udcf8',\n  'camping':'\\ud83c\\udfd5',\n  'cancer':'\\u264b\\ufe0f',\n  'candle':'\\ud83d\\udd6f',\n  'candy':'\\ud83c\\udf6c',\n  'canoe':'\\ud83d\\udef6',\n  'capital_abcd':'\\ud83d\\udd20',\n  'capricorn':'\\u2651\\ufe0f',\n  'car':'\\ud83d\\ude97',\n  'card_file_box':'\\ud83d\\uddc3',\n  'card_index':'\\ud83d\\udcc7',\n  'card_index_dividers':'\\ud83d\\uddc2',\n  'carousel_horse':'\\ud83c\\udfa0',\n  'carrot':'\\ud83e\\udd55',\n  'cat':'\\ud83d\\udc31',\n  'cat2':'\\ud83d\\udc08',\n  'cd':'\\ud83d\\udcbf',\n  'chains':'\\u26d3',\n  'champagne':'\\ud83c\\udf7e',\n  'chart':'\\ud83d\\udcb9',\n  'chart_with_downwards_trend':'\\ud83d\\udcc9',\n  'chart_with_upwards_trend':'\\ud83d\\udcc8',\n  'checkered_flag':'\\ud83c\\udfc1',\n  'cheese':'\\ud83e\\uddc0',\n  'cherries':'\\ud83c\\udf52',\n  'cherry_blossom':'\\ud83c\\udf38',\n  'chestnut':'\\ud83c\\udf30',\n  'chicken':'\\ud83d\\udc14',\n  'children_crossing':'\\ud83d\\udeb8',\n  'chipmunk':'\\ud83d\\udc3f',\n  'chocolate_bar':'\\ud83c\\udf6b',\n  'christmas_tree':'\\ud83c\\udf84',\n  'church':'\\u26ea\\ufe0f',\n  'cinema':'\\ud83c\\udfa6',\n  'circus_tent':'\\ud83c\\udfaa',\n  'city_sunrise':'\\ud83c\\udf07',\n  'city_sunset':'\\ud83c\\udf06',\n  'cityscape':'\\ud83c\\udfd9',\n  'cl':'\\ud83c\\udd91',\n  'clamp':'\\ud83d\\udddc',\n  'clap':'\\ud83d\\udc4f',\n  'clapper':'\\ud83c\\udfac',\n  'classical_building':'\\ud83c\\udfdb',\n  'clinking_glasses':'\\ud83e\\udd42',\n  'clipboard':'\\ud83d\\udccb',\n  'clock1':'\\ud83d\\udd50',\n  'clock10':'\\ud83d\\udd59',\n  'clock1030':'\\ud83d\\udd65',\n  'clock11':'\\ud83d\\udd5a',\n  'clock1130':'\\ud83d\\udd66',\n  'clock12':'\\ud83d\\udd5b',\n  'clock1230':'\\ud83d\\udd67',\n  'clock130':'\\ud83d\\udd5c',\n  'clock2':'\\ud83d\\udd51',\n  'clock230':'\\ud83d\\udd5d',\n  'clock3':'\\ud83d\\udd52',\n  'clock330':'\\ud83d\\udd5e',\n  'clock4':'\\ud83d\\udd53',\n  'clock430':'\\ud83d\\udd5f',\n  'clock5':'\\ud83d\\udd54',\n  'clock530':'\\ud83d\\udd60',\n  'clock6':'\\ud83d\\udd55',\n  'clock630':'\\ud83d\\udd61',\n  'clock7':'\\ud83d\\udd56',\n  'clock730':'\\ud83d\\udd62',\n  'clock8':'\\ud83d\\udd57',\n  'clock830':'\\ud83d\\udd63',\n  'clock9':'\\ud83d\\udd58',\n  'clock930':'\\ud83d\\udd64',\n  'closed_book':'\\ud83d\\udcd5',\n  'closed_lock_with_key':'\\ud83d\\udd10',\n  'closed_umbrella':'\\ud83c\\udf02',\n  'cloud':'\\u2601\\ufe0f',\n  'cloud_with_lightning':'\\ud83c\\udf29',\n  'cloud_with_lightning_and_rain':'\\u26c8',\n  'cloud_with_rain':'\\ud83c\\udf27',\n  'cloud_with_snow':'\\ud83c\\udf28',\n  'clown_face':'\\ud83e\\udd21',\n  'clubs':'\\u2663\\ufe0f',\n  'cocktail':'\\ud83c\\udf78',\n  'coffee':'\\u2615\\ufe0f',\n  'coffin':'\\u26b0\\ufe0f',\n  'cold_sweat':'\\ud83d\\ude30',\n  'comet':'\\u2604\\ufe0f',\n  'computer':'\\ud83d\\udcbb',\n  'computer_mouse':'\\ud83d\\uddb1',\n  'confetti_ball':'\\ud83c\\udf8a',\n  'confounded':'\\ud83d\\ude16',\n  'confused':'\\ud83d\\ude15',\n  'congratulations':'\\u3297\\ufe0f',\n  'construction':'\\ud83d\\udea7',\n  'construction_worker_man':'\\ud83d\\udc77',\n  'construction_worker_woman':'\\ud83d\\udc77&zwj;\\u2640\\ufe0f',\n  'control_knobs':'\\ud83c\\udf9b',\n  'convenience_store':'\\ud83c\\udfea',\n  'cookie':'\\ud83c\\udf6a',\n  'cool':'\\ud83c\\udd92',\n  'policeman':'\\ud83d\\udc6e',\n  'copyright':'\\u00a9\\ufe0f',\n  'corn':'\\ud83c\\udf3d',\n  'couch_and_lamp':'\\ud83d\\udecb',\n  'couple':'\\ud83d\\udc6b',\n  'couple_with_heart_woman_man':'\\ud83d\\udc91',\n  'couple_with_heart_man_man':'\\ud83d\\udc68&zwj;\\u2764\\ufe0f&zwj;\\ud83d\\udc68',\n  'couple_with_heart_woman_woman':'\\ud83d\\udc69&zwj;\\u2764\\ufe0f&zwj;\\ud83d\\udc69',\n  'couplekiss_man_man':'\\ud83d\\udc68&zwj;\\u2764\\ufe0f&zwj;\\ud83d\\udc8b&zwj;\\ud83d\\udc68',\n  'couplekiss_man_woman':'\\ud83d\\udc8f',\n  'couplekiss_woman_woman':'\\ud83d\\udc69&zwj;\\u2764\\ufe0f&zwj;\\ud83d\\udc8b&zwj;\\ud83d\\udc69',\n  'cow':'\\ud83d\\udc2e',\n  'cow2':'\\ud83d\\udc04',\n  'cowboy_hat_face':'\\ud83e\\udd20',\n  'crab':'\\ud83e\\udd80',\n  'crayon':'\\ud83d\\udd8d',\n  'credit_card':'\\ud83d\\udcb3',\n  'crescent_moon':'\\ud83c\\udf19',\n  'cricket':'\\ud83c\\udfcf',\n  'crocodile':'\\ud83d\\udc0a',\n  'croissant':'\\ud83e\\udd50',\n  'crossed_fingers':'\\ud83e\\udd1e',\n  'crossed_flags':'\\ud83c\\udf8c',\n  'crossed_swords':'\\u2694\\ufe0f',\n  'crown':'\\ud83d\\udc51',\n  'cry':'\\ud83d\\ude22',\n  'crying_cat_face':'\\ud83d\\ude3f',\n  'crystal_ball':'\\ud83d\\udd2e',\n  'cucumber':'\\ud83e\\udd52',\n  'cupid':'\\ud83d\\udc98',\n  'curly_loop':'\\u27b0',\n  'currency_exchange':'\\ud83d\\udcb1',\n  'curry':'\\ud83c\\udf5b',\n  'custard':'\\ud83c\\udf6e',\n  'customs':'\\ud83d\\udec3',\n  'cyclone':'\\ud83c\\udf00',\n  'dagger':'\\ud83d\\udde1',\n  'dancer':'\\ud83d\\udc83',\n  'dancing_women':'\\ud83d\\udc6f',\n  'dancing_men':'\\ud83d\\udc6f&zwj;\\u2642\\ufe0f',\n  'dango':'\\ud83c\\udf61',\n  'dark_sunglasses':'\\ud83d\\udd76',\n  'dart':'\\ud83c\\udfaf',\n  'dash':'\\ud83d\\udca8',\n  'date':'\\ud83d\\udcc5',\n  'deciduous_tree':'\\ud83c\\udf33',\n  'deer':'\\ud83e\\udd8c',\n  'department_store':'\\ud83c\\udfec',\n  'derelict_house':'\\ud83c\\udfda',\n  'desert':'\\ud83c\\udfdc',\n  'desert_island':'\\ud83c\\udfdd',\n  'desktop_computer':'\\ud83d\\udda5',\n  'male_detective':'\\ud83d\\udd75\\ufe0f',\n  'diamond_shape_with_a_dot_inside':'\\ud83d\\udca0',\n  'diamonds':'\\u2666\\ufe0f',\n  'disappointed':'\\ud83d\\ude1e',\n  'disappointed_relieved':'\\ud83d\\ude25',\n  'dizzy':'\\ud83d\\udcab',\n  'dizzy_face':'\\ud83d\\ude35',\n  'do_not_litter':'\\ud83d\\udeaf',\n  'dog':'\\ud83d\\udc36',\n  'dog2':'\\ud83d\\udc15',\n  'dollar':'\\ud83d\\udcb5',\n  'dolls':'\\ud83c\\udf8e',\n  'dolphin':'\\ud83d\\udc2c',\n  'door':'\\ud83d\\udeaa',\n  'doughnut':'\\ud83c\\udf69',\n  'dove':'\\ud83d\\udd4a',\n  'dragon':'\\ud83d\\udc09',\n  'dragon_face':'\\ud83d\\udc32',\n  'dress':'\\ud83d\\udc57',\n  'dromedary_camel':'\\ud83d\\udc2a',\n  'drooling_face':'\\ud83e\\udd24',\n  'droplet':'\\ud83d\\udca7',\n  'drum':'\\ud83e\\udd41',\n  'duck':'\\ud83e\\udd86',\n  'dvd':'\\ud83d\\udcc0',\n  'e-mail':'\\ud83d\\udce7',\n  'eagle':'\\ud83e\\udd85',\n  'ear':'\\ud83d\\udc42',\n  'ear_of_rice':'\\ud83c\\udf3e',\n  'earth_africa':'\\ud83c\\udf0d',\n  'earth_americas':'\\ud83c\\udf0e',\n  'earth_asia':'\\ud83c\\udf0f',\n  'egg':'\\ud83e\\udd5a',\n  'eggplant':'\\ud83c\\udf46',\n  'eight_pointed_black_star':'\\u2734\\ufe0f',\n  'eight_spoked_asterisk':'\\u2733\\ufe0f',\n  'electric_plug':'\\ud83d\\udd0c',\n  'elephant':'\\ud83d\\udc18',\n  'email':'\\u2709\\ufe0f',\n  'end':'\\ud83d\\udd1a',\n  'envelope_with_arrow':'\\ud83d\\udce9',\n  'euro':'\\ud83d\\udcb6',\n  'european_castle':'\\ud83c\\udff0',\n  'european_post_office':'\\ud83c\\udfe4',\n  'evergreen_tree':'\\ud83c\\udf32',\n  'exclamation':'\\u2757\\ufe0f',\n  'expressionless':'\\ud83d\\ude11',\n  'eye':'\\ud83d\\udc41',\n  'eye_speech_bubble':'\\ud83d\\udc41&zwj;\\ud83d\\udde8',\n  'eyeglasses':'\\ud83d\\udc53',\n  'eyes':'\\ud83d\\udc40',\n  'face_with_head_bandage':'\\ud83e\\udd15',\n  'face_with_thermometer':'\\ud83e\\udd12',\n  'fist_oncoming':'\\ud83d\\udc4a',\n  'factory':'\\ud83c\\udfed',\n  'fallen_leaf':'\\ud83c\\udf42',\n  'family_man_woman_boy':'\\ud83d\\udc6a',\n  'family_man_boy':'\\ud83d\\udc68&zwj;\\ud83d\\udc66',\n  'family_man_boy_boy':'\\ud83d\\udc68&zwj;\\ud83d\\udc66&zwj;\\ud83d\\udc66',\n  'family_man_girl':'\\ud83d\\udc68&zwj;\\ud83d\\udc67',\n  'family_man_girl_boy':'\\ud83d\\udc68&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc66',\n  'family_man_girl_girl':'\\ud83d\\udc68&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc67',\n  'family_man_man_boy':'\\ud83d\\udc68&zwj;\\ud83d\\udc68&zwj;\\ud83d\\udc66',\n  'family_man_man_boy_boy':'\\ud83d\\udc68&zwj;\\ud83d\\udc68&zwj;\\ud83d\\udc66&zwj;\\ud83d\\udc66',\n  'family_man_man_girl':'\\ud83d\\udc68&zwj;\\ud83d\\udc68&zwj;\\ud83d\\udc67',\n  'family_man_man_girl_boy':'\\ud83d\\udc68&zwj;\\ud83d\\udc68&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc66',\n  'family_man_man_girl_girl':'\\ud83d\\udc68&zwj;\\ud83d\\udc68&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc67',\n  'family_man_woman_boy_boy':'\\ud83d\\udc68&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc66&zwj;\\ud83d\\udc66',\n  'family_man_woman_girl':'\\ud83d\\udc68&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc67',\n  'family_man_woman_girl_boy':'\\ud83d\\udc68&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc66',\n  'family_man_woman_girl_girl':'\\ud83d\\udc68&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc67',\n  'family_woman_boy':'\\ud83d\\udc69&zwj;\\ud83d\\udc66',\n  'family_woman_boy_boy':'\\ud83d\\udc69&zwj;\\ud83d\\udc66&zwj;\\ud83d\\udc66',\n  'family_woman_girl':'\\ud83d\\udc69&zwj;\\ud83d\\udc67',\n  'family_woman_girl_boy':'\\ud83d\\udc69&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc66',\n  'family_woman_girl_girl':'\\ud83d\\udc69&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc67',\n  'family_woman_woman_boy':'\\ud83d\\udc69&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc66',\n  'family_woman_woman_boy_boy':'\\ud83d\\udc69&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc66&zwj;\\ud83d\\udc66',\n  'family_woman_woman_girl':'\\ud83d\\udc69&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc67',\n  'family_woman_woman_girl_boy':'\\ud83d\\udc69&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc66',\n  'family_woman_woman_girl_girl':'\\ud83d\\udc69&zwj;\\ud83d\\udc69&zwj;\\ud83d\\udc67&zwj;\\ud83d\\udc67',\n  'fast_forward':'\\u23e9',\n  'fax':'\\ud83d\\udce0',\n  'fearful':'\\ud83d\\ude28',\n  'feet':'\\ud83d\\udc3e',\n  'female_detective':'\\ud83d\\udd75\\ufe0f&zwj;\\u2640\\ufe0f',\n  'ferris_wheel':'\\ud83c\\udfa1',\n  'ferry':'\\u26f4',\n  'field_hockey':'\\ud83c\\udfd1',\n  'file_cabinet':'\\ud83d\\uddc4',\n  'file_folder':'\\ud83d\\udcc1',\n  'film_projector':'\\ud83d\\udcfd',\n  'film_strip':'\\ud83c\\udf9e',\n  'fire':'\\ud83d\\udd25',\n  'fire_engine':'\\ud83d\\ude92',\n  'fireworks':'\\ud83c\\udf86',\n  'first_quarter_moon':'\\ud83c\\udf13',\n  'first_quarter_moon_with_face':'\\ud83c\\udf1b',\n  'fish':'\\ud83d\\udc1f',\n  'fish_cake':'\\ud83c\\udf65',\n  'fishing_pole_and_fish':'\\ud83c\\udfa3',\n  'fist_raised':'\\u270a',\n  'fist_left':'\\ud83e\\udd1b',\n  'fist_right':'\\ud83e\\udd1c',\n  'flags':'\\ud83c\\udf8f',\n  'flashlight':'\\ud83d\\udd26',\n  'fleur_de_lis':'\\u269c\\ufe0f',\n  'flight_arrival':'\\ud83d\\udeec',\n  'flight_departure':'\\ud83d\\udeeb',\n  'floppy_disk':'\\ud83d\\udcbe',\n  'flower_playing_cards':'\\ud83c\\udfb4',\n  'flushed':'\\ud83d\\ude33',\n  'fog':'\\ud83c\\udf2b',\n  'foggy':'\\ud83c\\udf01',\n  'football':'\\ud83c\\udfc8',\n  'footprints':'\\ud83d\\udc63',\n  'fork_and_knife':'\\ud83c\\udf74',\n  'fountain':'\\u26f2\\ufe0f',\n  'fountain_pen':'\\ud83d\\udd8b',\n  'four_leaf_clover':'\\ud83c\\udf40',\n  'fox_face':'\\ud83e\\udd8a',\n  'framed_picture':'\\ud83d\\uddbc',\n  'free':'\\ud83c\\udd93',\n  'fried_egg':'\\ud83c\\udf73',\n  'fried_shrimp':'\\ud83c\\udf64',\n  'fries':'\\ud83c\\udf5f',\n  'frog':'\\ud83d\\udc38',\n  'frowning':'\\ud83d\\ude26',\n  'frowning_face':'\\u2639\\ufe0f',\n  'frowning_man':'\\ud83d\\ude4d&zwj;\\u2642\\ufe0f',\n  'frowning_woman':'\\ud83d\\ude4d',\n  'middle_finger':'\\ud83d\\udd95',\n  'fuelpump':'\\u26fd\\ufe0f',\n  'full_moon':'\\ud83c\\udf15',\n  'full_moon_with_face':'\\ud83c\\udf1d',\n  'funeral_urn':'\\u26b1\\ufe0f',\n  'game_die':'\\ud83c\\udfb2',\n  'gear':'\\u2699\\ufe0f',\n  'gem':'\\ud83d\\udc8e',\n  'gemini':'\\u264a\\ufe0f',\n  'ghost':'\\ud83d\\udc7b',\n  'gift':'\\ud83c\\udf81',\n  'gift_heart':'\\ud83d\\udc9d',\n  'girl':'\\ud83d\\udc67',\n  'globe_with_meridians':'\\ud83c\\udf10',\n  'goal_net':'\\ud83e\\udd45',\n  'goat':'\\ud83d\\udc10',\n  'golf':'\\u26f3\\ufe0f',\n  'golfing_man':'\\ud83c\\udfcc\\ufe0f',\n  'golfing_woman':'\\ud83c\\udfcc\\ufe0f&zwj;\\u2640\\ufe0f',\n  'gorilla':'\\ud83e\\udd8d',\n  'grapes':'\\ud83c\\udf47',\n  'green_apple':'\\ud83c\\udf4f',\n  'green_book':'\\ud83d\\udcd7',\n  'green_heart':'\\ud83d\\udc9a',\n  'green_salad':'\\ud83e\\udd57',\n  'grey_exclamation':'\\u2755',\n  'grey_question':'\\u2754',\n  'grimacing':'\\ud83d\\ude2c',\n  'grin':'\\ud83d\\ude01',\n  'grinning':'\\ud83d\\ude00',\n  'guardsman':'\\ud83d\\udc82',\n  'guardswoman':'\\ud83d\\udc82&zwj;\\u2640\\ufe0f',\n  'guitar':'\\ud83c\\udfb8',\n  'gun':'\\ud83d\\udd2b',\n  'haircut_woman':'\\ud83d\\udc87',\n  'haircut_man':'\\ud83d\\udc87&zwj;\\u2642\\ufe0f',\n  'hamburger':'\\ud83c\\udf54',\n  'hammer':'\\ud83d\\udd28',\n  'hammer_and_pick':'\\u2692',\n  'hammer_and_wrench':'\\ud83d\\udee0',\n  'hamster':'\\ud83d\\udc39',\n  'hand':'\\u270b',\n  'handbag':'\\ud83d\\udc5c',\n  'handshake':'\\ud83e\\udd1d',\n  'hankey':'\\ud83d\\udca9',\n  'hatched_chick':'\\ud83d\\udc25',\n  'hatching_chick':'\\ud83d\\udc23',\n  'headphones':'\\ud83c\\udfa7',\n  'hear_no_evil':'\\ud83d\\ude49',\n  'heart':'\\u2764\\ufe0f',\n  'heart_decoration':'\\ud83d\\udc9f',\n  'heart_eyes':'\\ud83d\\ude0d',\n  'heart_eyes_cat':'\\ud83d\\ude3b',\n  'heartbeat':'\\ud83d\\udc93',\n  'heartpulse':'\\ud83d\\udc97',\n  'hearts':'\\u2665\\ufe0f',\n  'heavy_check_mark':'\\u2714\\ufe0f',\n  'heavy_division_sign':'\\u2797',\n  'heavy_dollar_sign':'\\ud83d\\udcb2',\n  'heavy_heart_exclamation':'\\u2763\\ufe0f',\n  'heavy_minus_sign':'\\u2796',\n  'heavy_multiplication_x':'\\u2716\\ufe0f',\n  'heavy_plus_sign':'\\u2795',\n  'helicopter':'\\ud83d\\ude81',\n  'herb':'\\ud83c\\udf3f',\n  'hibiscus':'\\ud83c\\udf3a',\n  'high_brightness':'\\ud83d\\udd06',\n  'high_heel':'\\ud83d\\udc60',\n  'hocho':'\\ud83d\\udd2a',\n  'hole':'\\ud83d\\udd73',\n  'honey_pot':'\\ud83c\\udf6f',\n  'horse':'\\ud83d\\udc34',\n  'horse_racing':'\\ud83c\\udfc7',\n  'hospital':'\\ud83c\\udfe5',\n  'hot_pepper':'\\ud83c\\udf36',\n  'hotdog':'\\ud83c\\udf2d',\n  'hotel':'\\ud83c\\udfe8',\n  'hotsprings':'\\u2668\\ufe0f',\n  'hourglass':'\\u231b\\ufe0f',\n  'hourglass_flowing_sand':'\\u23f3',\n  'house':'\\ud83c\\udfe0',\n  'house_with_garden':'\\ud83c\\udfe1',\n  'houses':'\\ud83c\\udfd8',\n  'hugs':'\\ud83e\\udd17',\n  'hushed':'\\ud83d\\ude2f',\n  'ice_cream':'\\ud83c\\udf68',\n  'ice_hockey':'\\ud83c\\udfd2',\n  'ice_skate':'\\u26f8',\n  'icecream':'\\ud83c\\udf66',\n  'id':'\\ud83c\\udd94',\n  'ideograph_advantage':'\\ud83c\\ude50',\n  'imp':'\\ud83d\\udc7f',\n  'inbox_tray':'\\ud83d\\udce5',\n  'incoming_envelope':'\\ud83d\\udce8',\n  'tipping_hand_woman':'\\ud83d\\udc81',\n  'information_source':'\\u2139\\ufe0f',\n  'innocent':'\\ud83d\\ude07',\n  'interrobang':'\\u2049\\ufe0f',\n  'iphone':'\\ud83d\\udcf1',\n  'izakaya_lantern':'\\ud83c\\udfee',\n  'jack_o_lantern':'\\ud83c\\udf83',\n  'japan':'\\ud83d\\uddfe',\n  'japanese_castle':'\\ud83c\\udfef',\n  'japanese_goblin':'\\ud83d\\udc7a',\n  'japanese_ogre':'\\ud83d\\udc79',\n  'jeans':'\\ud83d\\udc56',\n  'joy':'\\ud83d\\ude02',\n  'joy_cat':'\\ud83d\\ude39',\n  'joystick':'\\ud83d\\udd79',\n  'kaaba':'\\ud83d\\udd4b',\n  'key':'\\ud83d\\udd11',\n  'keyboard':'\\u2328\\ufe0f',\n  'keycap_ten':'\\ud83d\\udd1f',\n  'kick_scooter':'\\ud83d\\udef4',\n  'kimono':'\\ud83d\\udc58',\n  'kiss':'\\ud83d\\udc8b',\n  'kissing':'\\ud83d\\ude17',\n  'kissing_cat':'\\ud83d\\ude3d',\n  'kissing_closed_eyes':'\\ud83d\\ude1a',\n  'kissing_heart':'\\ud83d\\ude18',\n  'kissing_smiling_eyes':'\\ud83d\\ude19',\n  'kiwi_fruit':'\\ud83e\\udd5d',\n  'koala':'\\ud83d\\udc28',\n  'koko':'\\ud83c\\ude01',\n  'label':'\\ud83c\\udff7',\n  'large_blue_circle':'\\ud83d\\udd35',\n  'large_blue_diamond':'\\ud83d\\udd37',\n  'large_orange_diamond':'\\ud83d\\udd36',\n  'last_quarter_moon':'\\ud83c\\udf17',\n  'last_quarter_moon_with_face':'\\ud83c\\udf1c',\n  'latin_cross':'\\u271d\\ufe0f',\n  'laughing':'\\ud83d\\ude06',\n  'leaves':'\\ud83c\\udf43',\n  'ledger':'\\ud83d\\udcd2',\n  'left_luggage':'\\ud83d\\udec5',\n  'left_right_arrow':'\\u2194\\ufe0f',\n  'leftwards_arrow_with_hook':'\\u21a9\\ufe0f',\n  'lemon':'\\ud83c\\udf4b',\n  'leo':'\\u264c\\ufe0f',\n  'leopard':'\\ud83d\\udc06',\n  'level_slider':'\\ud83c\\udf9a',\n  'libra':'\\u264e\\ufe0f',\n  'light_rail':'\\ud83d\\ude88',\n  'link':'\\ud83d\\udd17',\n  'lion':'\\ud83e\\udd81',\n  'lips':'\\ud83d\\udc44',\n  'lipstick':'\\ud83d\\udc84',\n  'lizard':'\\ud83e\\udd8e',\n  'lock':'\\ud83d\\udd12',\n  'lock_with_ink_pen':'\\ud83d\\udd0f',\n  'lollipop':'\\ud83c\\udf6d',\n  'loop':'\\u27bf',\n  'loud_sound':'\\ud83d\\udd0a',\n  'loudspeaker':'\\ud83d\\udce2',\n  'love_hotel':'\\ud83c\\udfe9',\n  'love_letter':'\\ud83d\\udc8c',\n  'low_brightness':'\\ud83d\\udd05',\n  'lying_face':'\\ud83e\\udd25',\n  'm':'\\u24c2\\ufe0f',\n  'mag':'\\ud83d\\udd0d',\n  'mag_right':'\\ud83d\\udd0e',\n  'mahjong':'\\ud83c\\udc04\\ufe0f',\n  'mailbox':'\\ud83d\\udceb',\n  'mailbox_closed':'\\ud83d\\udcea',\n  'mailbox_with_mail':'\\ud83d\\udcec',\n  'mailbox_with_no_mail':'\\ud83d\\udced',\n  'man':'\\ud83d\\udc68',\n  'man_artist':'\\ud83d\\udc68&zwj;\\ud83c\\udfa8',\n  'man_astronaut':'\\ud83d\\udc68&zwj;\\ud83d\\ude80',\n  'man_cartwheeling':'\\ud83e\\udd38&zwj;\\u2642\\ufe0f',\n  'man_cook':'\\ud83d\\udc68&zwj;\\ud83c\\udf73',\n  'man_dancing':'\\ud83d\\udd7a',\n  'man_facepalming':'\\ud83e\\udd26&zwj;\\u2642\\ufe0f',\n  'man_factory_worker':'\\ud83d\\udc68&zwj;\\ud83c\\udfed',\n  'man_farmer':'\\ud83d\\udc68&zwj;\\ud83c\\udf3e',\n  'man_firefighter':'\\ud83d\\udc68&zwj;\\ud83d\\ude92',\n  'man_health_worker':'\\ud83d\\udc68&zwj;\\u2695\\ufe0f',\n  'man_in_tuxedo':'\\ud83e\\udd35',\n  'man_judge':'\\ud83d\\udc68&zwj;\\u2696\\ufe0f',\n  'man_juggling':'\\ud83e\\udd39&zwj;\\u2642\\ufe0f',\n  'man_mechanic':'\\ud83d\\udc68&zwj;\\ud83d\\udd27',\n  'man_office_worker':'\\ud83d\\udc68&zwj;\\ud83d\\udcbc',\n  'man_pilot':'\\ud83d\\udc68&zwj;\\u2708\\ufe0f',\n  'man_playing_handball':'\\ud83e\\udd3e&zwj;\\u2642\\ufe0f',\n  'man_playing_water_polo':'\\ud83e\\udd3d&zwj;\\u2642\\ufe0f',\n  'man_scientist':'\\ud83d\\udc68&zwj;\\ud83d\\udd2c',\n  'man_shrugging':'\\ud83e\\udd37&zwj;\\u2642\\ufe0f',\n  'man_singer':'\\ud83d\\udc68&zwj;\\ud83c\\udfa4',\n  'man_student':'\\ud83d\\udc68&zwj;\\ud83c\\udf93',\n  'man_teacher':'\\ud83d\\udc68&zwj;\\ud83c\\udfeb',\n  'man_technologist':'\\ud83d\\udc68&zwj;\\ud83d\\udcbb',\n  'man_with_gua_pi_mao':'\\ud83d\\udc72',\n  'man_with_turban':'\\ud83d\\udc73',\n  'tangerine':'\\ud83c\\udf4a',\n  'mans_shoe':'\\ud83d\\udc5e',\n  'mantelpiece_clock':'\\ud83d\\udd70',\n  'maple_leaf':'\\ud83c\\udf41',\n  'martial_arts_uniform':'\\ud83e\\udd4b',\n  'mask':'\\ud83d\\ude37',\n  'massage_woman':'\\ud83d\\udc86',\n  'massage_man':'\\ud83d\\udc86&zwj;\\u2642\\ufe0f',\n  'meat_on_bone':'\\ud83c\\udf56',\n  'medal_military':'\\ud83c\\udf96',\n  'medal_sports':'\\ud83c\\udfc5',\n  'mega':'\\ud83d\\udce3',\n  'melon':'\\ud83c\\udf48',\n  'memo':'\\ud83d\\udcdd',\n  'men_wrestling':'\\ud83e\\udd3c&zwj;\\u2642\\ufe0f',\n  'menorah':'\\ud83d\\udd4e',\n  'mens':'\\ud83d\\udeb9',\n  'metal':'\\ud83e\\udd18',\n  'metro':'\\ud83d\\ude87',\n  'microphone':'\\ud83c\\udfa4',\n  'microscope':'\\ud83d\\udd2c',\n  'milk_glass':'\\ud83e\\udd5b',\n  'milky_way':'\\ud83c\\udf0c',\n  'minibus':'\\ud83d\\ude90',\n  'minidisc':'\\ud83d\\udcbd',\n  'mobile_phone_off':'\\ud83d\\udcf4',\n  'money_mouth_face':'\\ud83e\\udd11',\n  'money_with_wings':'\\ud83d\\udcb8',\n  'moneybag':'\\ud83d\\udcb0',\n  'monkey':'\\ud83d\\udc12',\n  'monkey_face':'\\ud83d\\udc35',\n  'monorail':'\\ud83d\\ude9d',\n  'moon':'\\ud83c\\udf14',\n  'mortar_board':'\\ud83c\\udf93',\n  'mosque':'\\ud83d\\udd4c',\n  'motor_boat':'\\ud83d\\udee5',\n  'motor_scooter':'\\ud83d\\udef5',\n  'motorcycle':'\\ud83c\\udfcd',\n  'motorway':'\\ud83d\\udee3',\n  'mount_fuji':'\\ud83d\\uddfb',\n  'mountain':'\\u26f0',\n  'mountain_biking_man':'\\ud83d\\udeb5',\n  'mountain_biking_woman':'\\ud83d\\udeb5&zwj;\\u2640\\ufe0f',\n  'mountain_cableway':'\\ud83d\\udea0',\n  'mountain_railway':'\\ud83d\\ude9e',\n  'mountain_snow':'\\ud83c\\udfd4',\n  'mouse':'\\ud83d\\udc2d',\n  'mouse2':'\\ud83d\\udc01',\n  'movie_camera':'\\ud83c\\udfa5',\n  'moyai':'\\ud83d\\uddff',\n  'mrs_claus':'\\ud83e\\udd36',\n  'muscle':'\\ud83d\\udcaa',\n  'mushroom':'\\ud83c\\udf44',\n  'musical_keyboard':'\\ud83c\\udfb9',\n  'musical_note':'\\ud83c\\udfb5',\n  'musical_score':'\\ud83c\\udfbc',\n  'mute':'\\ud83d\\udd07',\n  'nail_care':'\\ud83d\\udc85',\n  'name_badge':'\\ud83d\\udcdb',\n  'national_park':'\\ud83c\\udfde',\n  'nauseated_face':'\\ud83e\\udd22',\n  'necktie':'\\ud83d\\udc54',\n  'negative_squared_cross_mark':'\\u274e',\n  'nerd_face':'\\ud83e\\udd13',\n  'neutral_face':'\\ud83d\\ude10',\n  'new':'\\ud83c\\udd95',\n  'new_moon':'\\ud83c\\udf11',\n  'new_moon_with_face':'\\ud83c\\udf1a',\n  'newspaper':'\\ud83d\\udcf0',\n  'newspaper_roll':'\\ud83d\\uddde',\n  'next_track_button':'\\u23ed',\n  'ng':'\\ud83c\\udd96',\n  'no_good_man':'\\ud83d\\ude45&zwj;\\u2642\\ufe0f',\n  'no_good_woman':'\\ud83d\\ude45',\n  'night_with_stars':'\\ud83c\\udf03',\n  'no_bell':'\\ud83d\\udd15',\n  'no_bicycles':'\\ud83d\\udeb3',\n  'no_entry':'\\u26d4\\ufe0f',\n  'no_entry_sign':'\\ud83d\\udeab',\n  'no_mobile_phones':'\\ud83d\\udcf5',\n  'no_mouth':'\\ud83d\\ude36',\n  'no_pedestrians':'\\ud83d\\udeb7',\n  'no_smoking':'\\ud83d\\udead',\n  'non-potable_water':'\\ud83d\\udeb1',\n  'nose':'\\ud83d\\udc43',\n  'notebook':'\\ud83d\\udcd3',\n  'notebook_with_decorative_cover':'\\ud83d\\udcd4',\n  'notes':'\\ud83c\\udfb6',\n  'nut_and_bolt':'\\ud83d\\udd29',\n  'o':'\\u2b55\\ufe0f',\n  'o2':'\\ud83c\\udd7e\\ufe0f',\n  'ocean':'\\ud83c\\udf0a',\n  'octopus':'\\ud83d\\udc19',\n  'oden':'\\ud83c\\udf62',\n  'office':'\\ud83c\\udfe2',\n  'oil_drum':'\\ud83d\\udee2',\n  'ok':'\\ud83c\\udd97',\n  'ok_hand':'\\ud83d\\udc4c',\n  'ok_man':'\\ud83d\\ude46&zwj;\\u2642\\ufe0f',\n  'ok_woman':'\\ud83d\\ude46',\n  'old_key':'\\ud83d\\udddd',\n  'older_man':'\\ud83d\\udc74',\n  'older_woman':'\\ud83d\\udc75',\n  'om':'\\ud83d\\udd49',\n  'on':'\\ud83d\\udd1b',\n  'oncoming_automobile':'\\ud83d\\ude98',\n  'oncoming_bus':'\\ud83d\\ude8d',\n  'oncoming_police_car':'\\ud83d\\ude94',\n  'oncoming_taxi':'\\ud83d\\ude96',\n  'open_file_folder':'\\ud83d\\udcc2',\n  'open_hands':'\\ud83d\\udc50',\n  'open_mouth':'\\ud83d\\ude2e',\n  'open_umbrella':'\\u2602\\ufe0f',\n  'ophiuchus':'\\u26ce',\n  'orange_book':'\\ud83d\\udcd9',\n  'orthodox_cross':'\\u2626\\ufe0f',\n  'outbox_tray':'\\ud83d\\udce4',\n  'owl':'\\ud83e\\udd89',\n  'ox':'\\ud83d\\udc02',\n  'package':'\\ud83d\\udce6',\n  'page_facing_up':'\\ud83d\\udcc4',\n  'page_with_curl':'\\ud83d\\udcc3',\n  'pager':'\\ud83d\\udcdf',\n  'paintbrush':'\\ud83d\\udd8c',\n  'palm_tree':'\\ud83c\\udf34',\n  'pancakes':'\\ud83e\\udd5e',\n  'panda_face':'\\ud83d\\udc3c',\n  'paperclip':'\\ud83d\\udcce',\n  'paperclips':'\\ud83d\\udd87',\n  'parasol_on_ground':'\\u26f1',\n  'parking':'\\ud83c\\udd7f\\ufe0f',\n  'part_alternation_mark':'\\u303d\\ufe0f',\n  'partly_sunny':'\\u26c5\\ufe0f',\n  'passenger_ship':'\\ud83d\\udef3',\n  'passport_control':'\\ud83d\\udec2',\n  'pause_button':'\\u23f8',\n  'peace_symbol':'\\u262e\\ufe0f',\n  'peach':'\\ud83c\\udf51',\n  'peanuts':'\\ud83e\\udd5c',\n  'pear':'\\ud83c\\udf50',\n  'pen':'\\ud83d\\udd8a',\n  'pencil2':'\\u270f\\ufe0f',\n  'penguin':'\\ud83d\\udc27',\n  'pensive':'\\ud83d\\ude14',\n  'performing_arts':'\\ud83c\\udfad',\n  'persevere':'\\ud83d\\ude23',\n  'person_fencing':'\\ud83e\\udd3a',\n  'pouting_woman':'\\ud83d\\ude4e',\n  'phone':'\\u260e\\ufe0f',\n  'pick':'\\u26cf',\n  'pig':'\\ud83d\\udc37',\n  'pig2':'\\ud83d\\udc16',\n  'pig_nose':'\\ud83d\\udc3d',\n  'pill':'\\ud83d\\udc8a',\n  'pineapple':'\\ud83c\\udf4d',\n  'ping_pong':'\\ud83c\\udfd3',\n  'pisces':'\\u2653\\ufe0f',\n  'pizza':'\\ud83c\\udf55',\n  'place_of_worship':'\\ud83d\\uded0',\n  'plate_with_cutlery':'\\ud83c\\udf7d',\n  'play_or_pause_button':'\\u23ef',\n  'point_down':'\\ud83d\\udc47',\n  'point_left':'\\ud83d\\udc48',\n  'point_right':'\\ud83d\\udc49',\n  'point_up':'\\u261d\\ufe0f',\n  'point_up_2':'\\ud83d\\udc46',\n  'police_car':'\\ud83d\\ude93',\n  'policewoman':'\\ud83d\\udc6e&zwj;\\u2640\\ufe0f',\n  'poodle':'\\ud83d\\udc29',\n  'popcorn':'\\ud83c\\udf7f',\n  'post_office':'\\ud83c\\udfe3',\n  'postal_horn':'\\ud83d\\udcef',\n  'postbox':'\\ud83d\\udcee',\n  'potable_water':'\\ud83d\\udeb0',\n  'potato':'\\ud83e\\udd54',\n  'pouch':'\\ud83d\\udc5d',\n  'poultry_leg':'\\ud83c\\udf57',\n  'pound':'\\ud83d\\udcb7',\n  'rage':'\\ud83d\\ude21',\n  'pouting_cat':'\\ud83d\\ude3e',\n  'pouting_man':'\\ud83d\\ude4e&zwj;\\u2642\\ufe0f',\n  'pray':'\\ud83d\\ude4f',\n  'prayer_beads':'\\ud83d\\udcff',\n  'pregnant_woman':'\\ud83e\\udd30',\n  'previous_track_button':'\\u23ee',\n  'prince':'\\ud83e\\udd34',\n  'princess':'\\ud83d\\udc78',\n  'printer':'\\ud83d\\udda8',\n  'purple_heart':'\\ud83d\\udc9c',\n  'purse':'\\ud83d\\udc5b',\n  'pushpin':'\\ud83d\\udccc',\n  'put_litter_in_its_place':'\\ud83d\\udeae',\n  'question':'\\u2753',\n  'rabbit':'\\ud83d\\udc30',\n  'rabbit2':'\\ud83d\\udc07',\n  'racehorse':'\\ud83d\\udc0e',\n  'racing_car':'\\ud83c\\udfce',\n  'radio':'\\ud83d\\udcfb',\n  'radio_button':'\\ud83d\\udd18',\n  'radioactive':'\\u2622\\ufe0f',\n  'railway_car':'\\ud83d\\ude83',\n  'railway_track':'\\ud83d\\udee4',\n  'rainbow':'\\ud83c\\udf08',\n  'rainbow_flag':'\\ud83c\\udff3\\ufe0f&zwj;\\ud83c\\udf08',\n  'raised_back_of_hand':'\\ud83e\\udd1a',\n  'raised_hand_with_fingers_splayed':'\\ud83d\\udd90',\n  'raised_hands':'\\ud83d\\ude4c',\n  'raising_hand_woman':'\\ud83d\\ude4b',\n  'raising_hand_man':'\\ud83d\\ude4b&zwj;\\u2642\\ufe0f',\n  'ram':'\\ud83d\\udc0f',\n  'ramen':'\\ud83c\\udf5c',\n  'rat':'\\ud83d\\udc00',\n  'record_button':'\\u23fa',\n  'recycle':'\\u267b\\ufe0f',\n  'red_circle':'\\ud83d\\udd34',\n  'registered':'\\u00ae\\ufe0f',\n  'relaxed':'\\u263a\\ufe0f',\n  'relieved':'\\ud83d\\ude0c',\n  'reminder_ribbon':'\\ud83c\\udf97',\n  'repeat':'\\ud83d\\udd01',\n  'repeat_one':'\\ud83d\\udd02',\n  'rescue_worker_helmet':'\\u26d1',\n  'restroom':'\\ud83d\\udebb',\n  'revolving_hearts':'\\ud83d\\udc9e',\n  'rewind':'\\u23ea',\n  'rhinoceros':'\\ud83e\\udd8f',\n  'ribbon':'\\ud83c\\udf80',\n  'rice':'\\ud83c\\udf5a',\n  'rice_ball':'\\ud83c\\udf59',\n  'rice_cracker':'\\ud83c\\udf58',\n  'rice_scene':'\\ud83c\\udf91',\n  'right_anger_bubble':'\\ud83d\\uddef',\n  'ring':'\\ud83d\\udc8d',\n  'robot':'\\ud83e\\udd16',\n  'rocket':'\\ud83d\\ude80',\n  'rofl':'\\ud83e\\udd23',\n  'roll_eyes':'\\ud83d\\ude44',\n  'roller_coaster':'\\ud83c\\udfa2',\n  'rooster':'\\ud83d\\udc13',\n  'rose':'\\ud83c\\udf39',\n  'rosette':'\\ud83c\\udff5',\n  'rotating_light':'\\ud83d\\udea8',\n  'round_pushpin':'\\ud83d\\udccd',\n  'rowing_man':'\\ud83d\\udea3',\n  'rowing_woman':'\\ud83d\\udea3&zwj;\\u2640\\ufe0f',\n  'rugby_football':'\\ud83c\\udfc9',\n  'running_man':'\\ud83c\\udfc3',\n  'running_shirt_with_sash':'\\ud83c\\udfbd',\n  'running_woman':'\\ud83c\\udfc3&zwj;\\u2640\\ufe0f',\n  'sa':'\\ud83c\\ude02\\ufe0f',\n  'sagittarius':'\\u2650\\ufe0f',\n  'sake':'\\ud83c\\udf76',\n  'sandal':'\\ud83d\\udc61',\n  'santa':'\\ud83c\\udf85',\n  'satellite':'\\ud83d\\udce1',\n  'saxophone':'\\ud83c\\udfb7',\n  'school':'\\ud83c\\udfeb',\n  'school_satchel':'\\ud83c\\udf92',\n  'scissors':'\\u2702\\ufe0f',\n  'scorpion':'\\ud83e\\udd82',\n  'scorpius':'\\u264f\\ufe0f',\n  'scream':'\\ud83d\\ude31',\n  'scream_cat':'\\ud83d\\ude40',\n  'scroll':'\\ud83d\\udcdc',\n  'seat':'\\ud83d\\udcba',\n  'secret':'\\u3299\\ufe0f',\n  'see_no_evil':'\\ud83d\\ude48',\n  'seedling':'\\ud83c\\udf31',\n  'selfie':'\\ud83e\\udd33',\n  'shallow_pan_of_food':'\\ud83e\\udd58',\n  'shamrock':'\\u2618\\ufe0f',\n  'shark':'\\ud83e\\udd88',\n  'shaved_ice':'\\ud83c\\udf67',\n  'sheep':'\\ud83d\\udc11',\n  'shell':'\\ud83d\\udc1a',\n  'shield':'\\ud83d\\udee1',\n  'shinto_shrine':'\\u26e9',\n  'ship':'\\ud83d\\udea2',\n  'shirt':'\\ud83d\\udc55',\n  'shopping':'\\ud83d\\udecd',\n  'shopping_cart':'\\ud83d\\uded2',\n  'shower':'\\ud83d\\udebf',\n  'shrimp':'\\ud83e\\udd90',\n  'signal_strength':'\\ud83d\\udcf6',\n  'six_pointed_star':'\\ud83d\\udd2f',\n  'ski':'\\ud83c\\udfbf',\n  'skier':'\\u26f7',\n  'skull':'\\ud83d\\udc80',\n  'skull_and_crossbones':'\\u2620\\ufe0f',\n  'sleeping':'\\ud83d\\ude34',\n  'sleeping_bed':'\\ud83d\\udecc',\n  'sleepy':'\\ud83d\\ude2a',\n  'slightly_frowning_face':'\\ud83d\\ude41',\n  'slightly_smiling_face':'\\ud83d\\ude42',\n  'slot_machine':'\\ud83c\\udfb0',\n  'small_airplane':'\\ud83d\\udee9',\n  'small_blue_diamond':'\\ud83d\\udd39',\n  'small_orange_diamond':'\\ud83d\\udd38',\n  'small_red_triangle':'\\ud83d\\udd3a',\n  'small_red_triangle_down':'\\ud83d\\udd3b',\n  'smile':'\\ud83d\\ude04',\n  'smile_cat':'\\ud83d\\ude38',\n  'smiley':'\\ud83d\\ude03',\n  'smiley_cat':'\\ud83d\\ude3a',\n  'smiling_imp':'\\ud83d\\ude08',\n  'smirk':'\\ud83d\\ude0f',\n  'smirk_cat':'\\ud83d\\ude3c',\n  'smoking':'\\ud83d\\udeac',\n  'snail':'\\ud83d\\udc0c',\n  'snake':'\\ud83d\\udc0d',\n  'sneezing_face':'\\ud83e\\udd27',\n  'snowboarder':'\\ud83c\\udfc2',\n  'snowflake':'\\u2744\\ufe0f',\n  'snowman':'\\u26c4\\ufe0f',\n  'snowman_with_snow':'\\u2603\\ufe0f',\n  'sob':'\\ud83d\\ude2d',\n  'soccer':'\\u26bd\\ufe0f',\n  'soon':'\\ud83d\\udd1c',\n  'sos':'\\ud83c\\udd98',\n  'sound':'\\ud83d\\udd09',\n  'space_invader':'\\ud83d\\udc7e',\n  'spades':'\\u2660\\ufe0f',\n  'spaghetti':'\\ud83c\\udf5d',\n  'sparkle':'\\u2747\\ufe0f',\n  'sparkler':'\\ud83c\\udf87',\n  'sparkles':'\\u2728',\n  'sparkling_heart':'\\ud83d\\udc96',\n  'speak_no_evil':'\\ud83d\\ude4a',\n  'speaker':'\\ud83d\\udd08',\n  'speaking_head':'\\ud83d\\udde3',\n  'speech_balloon':'\\ud83d\\udcac',\n  'speedboat':'\\ud83d\\udea4',\n  'spider':'\\ud83d\\udd77',\n  'spider_web':'\\ud83d\\udd78',\n  'spiral_calendar':'\\ud83d\\uddd3',\n  'spiral_notepad':'\\ud83d\\uddd2',\n  'spoon':'\\ud83e\\udd44',\n  'squid':'\\ud83e\\udd91',\n  'stadium':'\\ud83c\\udfdf',\n  'star':'\\u2b50\\ufe0f',\n  'star2':'\\ud83c\\udf1f',\n  'star_and_crescent':'\\u262a\\ufe0f',\n  'star_of_david':'\\u2721\\ufe0f',\n  'stars':'\\ud83c\\udf20',\n  'station':'\\ud83d\\ude89',\n  'statue_of_liberty':'\\ud83d\\uddfd',\n  'steam_locomotive':'\\ud83d\\ude82',\n  'stew':'\\ud83c\\udf72',\n  'stop_button':'\\u23f9',\n  'stop_sign':'\\ud83d\\uded1',\n  'stopwatch':'\\u23f1',\n  'straight_ruler':'\\ud83d\\udccf',\n  'strawberry':'\\ud83c\\udf53',\n  'stuck_out_tongue':'\\ud83d\\ude1b',\n  'stuck_out_tongue_closed_eyes':'\\ud83d\\ude1d',\n  'stuck_out_tongue_winking_eye':'\\ud83d\\ude1c',\n  'studio_microphone':'\\ud83c\\udf99',\n  'stuffed_flatbread':'\\ud83e\\udd59',\n  'sun_behind_large_cloud':'\\ud83c\\udf25',\n  'sun_behind_rain_cloud':'\\ud83c\\udf26',\n  'sun_behind_small_cloud':'\\ud83c\\udf24',\n  'sun_with_face':'\\ud83c\\udf1e',\n  'sunflower':'\\ud83c\\udf3b',\n  'sunglasses':'\\ud83d\\ude0e',\n  'sunny':'\\u2600\\ufe0f',\n  'sunrise':'\\ud83c\\udf05',\n  'sunrise_over_mountains':'\\ud83c\\udf04',\n  'surfing_man':'\\ud83c\\udfc4',\n  'surfing_woman':'\\ud83c\\udfc4&zwj;\\u2640\\ufe0f',\n  'sushi':'\\ud83c\\udf63',\n  'suspension_railway':'\\ud83d\\ude9f',\n  'sweat':'\\ud83d\\ude13',\n  'sweat_drops':'\\ud83d\\udca6',\n  'sweat_smile':'\\ud83d\\ude05',\n  'sweet_potato':'\\ud83c\\udf60',\n  'swimming_man':'\\ud83c\\udfca',\n  'swimming_woman':'\\ud83c\\udfca&zwj;\\u2640\\ufe0f',\n  'symbols':'\\ud83d\\udd23',\n  'synagogue':'\\ud83d\\udd4d',\n  'syringe':'\\ud83d\\udc89',\n  'taco':'\\ud83c\\udf2e',\n  'tada':'\\ud83c\\udf89',\n  'tanabata_tree':'\\ud83c\\udf8b',\n  'taurus':'\\u2649\\ufe0f',\n  'taxi':'\\ud83d\\ude95',\n  'tea':'\\ud83c\\udf75',\n  'telephone_receiver':'\\ud83d\\udcde',\n  'telescope':'\\ud83d\\udd2d',\n  'tennis':'\\ud83c\\udfbe',\n  'tent':'\\u26fa\\ufe0f',\n  'thermometer':'\\ud83c\\udf21',\n  'thinking':'\\ud83e\\udd14',\n  'thought_balloon':'\\ud83d\\udcad',\n  'ticket':'\\ud83c\\udfab',\n  'tickets':'\\ud83c\\udf9f',\n  'tiger':'\\ud83d\\udc2f',\n  'tiger2':'\\ud83d\\udc05',\n  'timer_clock':'\\u23f2',\n  'tipping_hand_man':'\\ud83d\\udc81&zwj;\\u2642\\ufe0f',\n  'tired_face':'\\ud83d\\ude2b',\n  'tm':'\\u2122\\ufe0f',\n  'toilet':'\\ud83d\\udebd',\n  'tokyo_tower':'\\ud83d\\uddfc',\n  'tomato':'\\ud83c\\udf45',\n  'tongue':'\\ud83d\\udc45',\n  'top':'\\ud83d\\udd1d',\n  'tophat':'\\ud83c\\udfa9',\n  'tornado':'\\ud83c\\udf2a',\n  'trackball':'\\ud83d\\uddb2',\n  'tractor':'\\ud83d\\ude9c',\n  'traffic_light':'\\ud83d\\udea5',\n  'train':'\\ud83d\\ude8b',\n  'train2':'\\ud83d\\ude86',\n  'tram':'\\ud83d\\ude8a',\n  'triangular_flag_on_post':'\\ud83d\\udea9',\n  'triangular_ruler':'\\ud83d\\udcd0',\n  'trident':'\\ud83d\\udd31',\n  'triumph':'\\ud83d\\ude24',\n  'trolleybus':'\\ud83d\\ude8e',\n  'trophy':'\\ud83c\\udfc6',\n  'tropical_drink':'\\ud83c\\udf79',\n  'tropical_fish':'\\ud83d\\udc20',\n  'truck':'\\ud83d\\ude9a',\n  'trumpet':'\\ud83c\\udfba',\n  'tulip':'\\ud83c\\udf37',\n  'tumbler_glass':'\\ud83e\\udd43',\n  'turkey':'\\ud83e\\udd83',\n  'turtle':'\\ud83d\\udc22',\n  'tv':'\\ud83d\\udcfa',\n  'twisted_rightwards_arrows':'\\ud83d\\udd00',\n  'two_hearts':'\\ud83d\\udc95',\n  'two_men_holding_hands':'\\ud83d\\udc6c',\n  'two_women_holding_hands':'\\ud83d\\udc6d',\n  'u5272':'\\ud83c\\ude39',\n  'u5408':'\\ud83c\\ude34',\n  'u55b6':'\\ud83c\\ude3a',\n  'u6307':'\\ud83c\\ude2f\\ufe0f',\n  'u6708':'\\ud83c\\ude37\\ufe0f',\n  'u6709':'\\ud83c\\ude36',\n  'u6e80':'\\ud83c\\ude35',\n  'u7121':'\\ud83c\\ude1a\\ufe0f',\n  'u7533':'\\ud83c\\ude38',\n  'u7981':'\\ud83c\\ude32',\n  'u7a7a':'\\ud83c\\ude33',\n  'umbrella':'\\u2614\\ufe0f',\n  'unamused':'\\ud83d\\ude12',\n  'underage':'\\ud83d\\udd1e',\n  'unicorn':'\\ud83e\\udd84',\n  'unlock':'\\ud83d\\udd13',\n  'up':'\\ud83c\\udd99',\n  'upside_down_face':'\\ud83d\\ude43',\n  'v':'\\u270c\\ufe0f',\n  'vertical_traffic_light':'\\ud83d\\udea6',\n  'vhs':'\\ud83d\\udcfc',\n  'vibration_mode':'\\ud83d\\udcf3',\n  'video_camera':'\\ud83d\\udcf9',\n  'video_game':'\\ud83c\\udfae',\n  'violin':'\\ud83c\\udfbb',\n  'virgo':'\\u264d\\ufe0f',\n  'volcano':'\\ud83c\\udf0b',\n  'volleyball':'\\ud83c\\udfd0',\n  'vs':'\\ud83c\\udd9a',\n  'vulcan_salute':'\\ud83d\\udd96',\n  'walking_man':'\\ud83d\\udeb6',\n  'walking_woman':'\\ud83d\\udeb6&zwj;\\u2640\\ufe0f',\n  'waning_crescent_moon':'\\ud83c\\udf18',\n  'waning_gibbous_moon':'\\ud83c\\udf16',\n  'warning':'\\u26a0\\ufe0f',\n  'wastebasket':'\\ud83d\\uddd1',\n  'watch':'\\u231a\\ufe0f',\n  'water_buffalo':'\\ud83d\\udc03',\n  'watermelon':'\\ud83c\\udf49',\n  'wave':'\\ud83d\\udc4b',\n  'wavy_dash':'\\u3030\\ufe0f',\n  'waxing_crescent_moon':'\\ud83c\\udf12',\n  'wc':'\\ud83d\\udebe',\n  'weary':'\\ud83d\\ude29',\n  'wedding':'\\ud83d\\udc92',\n  'weight_lifting_man':'\\ud83c\\udfcb\\ufe0f',\n  'weight_lifting_woman':'\\ud83c\\udfcb\\ufe0f&zwj;\\u2640\\ufe0f',\n  'whale':'\\ud83d\\udc33',\n  'whale2':'\\ud83d\\udc0b',\n  'wheel_of_dharma':'\\u2638\\ufe0f',\n  'wheelchair':'\\u267f\\ufe0f',\n  'white_check_mark':'\\u2705',\n  'white_circle':'\\u26aa\\ufe0f',\n  'white_flag':'\\ud83c\\udff3\\ufe0f',\n  'white_flower':'\\ud83d\\udcae',\n  'white_large_square':'\\u2b1c\\ufe0f',\n  'white_medium_small_square':'\\u25fd\\ufe0f',\n  'white_medium_square':'\\u25fb\\ufe0f',\n  'white_small_square':'\\u25ab\\ufe0f',\n  'white_square_button':'\\ud83d\\udd33',\n  'wilted_flower':'\\ud83e\\udd40',\n  'wind_chime':'\\ud83c\\udf90',\n  'wind_face':'\\ud83c\\udf2c',\n  'wine_glass':'\\ud83c\\udf77',\n  'wink':'\\ud83d\\ude09',\n  'wolf':'\\ud83d\\udc3a',\n  'woman':'\\ud83d\\udc69',\n  'woman_artist':'\\ud83d\\udc69&zwj;\\ud83c\\udfa8',\n  'woman_astronaut':'\\ud83d\\udc69&zwj;\\ud83d\\ude80',\n  'woman_cartwheeling':'\\ud83e\\udd38&zwj;\\u2640\\ufe0f',\n  'woman_cook':'\\ud83d\\udc69&zwj;\\ud83c\\udf73',\n  'woman_facepalming':'\\ud83e\\udd26&zwj;\\u2640\\ufe0f',\n  'woman_factory_worker':'\\ud83d\\udc69&zwj;\\ud83c\\udfed',\n  'woman_farmer':'\\ud83d\\udc69&zwj;\\ud83c\\udf3e',\n  'woman_firefighter':'\\ud83d\\udc69&zwj;\\ud83d\\ude92',\n  'woman_health_worker':'\\ud83d\\udc69&zwj;\\u2695\\ufe0f',\n  'woman_judge':'\\ud83d\\udc69&zwj;\\u2696\\ufe0f',\n  'woman_juggling':'\\ud83e\\udd39&zwj;\\u2640\\ufe0f',\n  'woman_mechanic':'\\ud83d\\udc69&zwj;\\ud83d\\udd27',\n  'woman_office_worker':'\\ud83d\\udc69&zwj;\\ud83d\\udcbc',\n  'woman_pilot':'\\ud83d\\udc69&zwj;\\u2708\\ufe0f',\n  'woman_playing_handball':'\\ud83e\\udd3e&zwj;\\u2640\\ufe0f',\n  'woman_playing_water_polo':'\\ud83e\\udd3d&zwj;\\u2640\\ufe0f',\n  'woman_scientist':'\\ud83d\\udc69&zwj;\\ud83d\\udd2c',\n  'woman_shrugging':'\\ud83e\\udd37&zwj;\\u2640\\ufe0f',\n  'woman_singer':'\\ud83d\\udc69&zwj;\\ud83c\\udfa4',\n  'woman_student':'\\ud83d\\udc69&zwj;\\ud83c\\udf93',\n  'woman_teacher':'\\ud83d\\udc69&zwj;\\ud83c\\udfeb',\n  'woman_technologist':'\\ud83d\\udc69&zwj;\\ud83d\\udcbb',\n  'woman_with_turban':'\\ud83d\\udc73&zwj;\\u2640\\ufe0f',\n  'womans_clothes':'\\ud83d\\udc5a',\n  'womans_hat':'\\ud83d\\udc52',\n  'women_wrestling':'\\ud83e\\udd3c&zwj;\\u2640\\ufe0f',\n  'womens':'\\ud83d\\udeba',\n  'world_map':'\\ud83d\\uddfa',\n  'worried':'\\ud83d\\ude1f',\n  'wrench':'\\ud83d\\udd27',\n  'writing_hand':'\\u270d\\ufe0f',\n  'x':'\\u274c',\n  'yellow_heart':'\\ud83d\\udc9b',\n  'yen':'\\ud83d\\udcb4',\n  'yin_yang':'\\u262f\\ufe0f',\n  'yum':'\\ud83d\\ude0b',\n  'zap':'\\u26a1\\ufe0f',\n  'zipper_mouth_face':'\\ud83e\\udd10',\n  'zzz':'\\ud83d\\udca4',\n\n  /* special emojis :P */\n  'octocat':  '<img alt=\":octocat:\" height=\"20\" width=\"20\" align=\"absmiddle\" src=\"https://assets-cdn.github.com/images/icons/emoji/octocat.png\">',\n  'showdown': '<span style=\"font-family: \\'Anonymous Pro\\', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;\">S</span>'\n};\n\r\n/**\n * Created by Estevao on 31-05-2015.\n */\n\n/**\n * Showdown Converter class\n * @class\n * @param {object} [converterOptions]\n * @returns {Converter}\n */\nshowdown.Converter = function (converterOptions) {\n  'use strict';\n\n  var\n      /**\n       * Options used by this converter\n       * @private\n       * @type {{}}\n       */\n      options = {},\n\n      /**\n       * Language extensions used by this converter\n       * @private\n       * @type {Array}\n       */\n      langExtensions = [],\n\n      /**\n       * Output modifiers extensions used by this converter\n       * @private\n       * @type {Array}\n       */\n      outputModifiers = [],\n\n      /**\n       * Event listeners\n       * @private\n       * @type {{}}\n       */\n      listeners = {},\n\n      /**\n       * The flavor set in this converter\n       */\n      setConvFlavor = setFlavor,\n\n      /**\n       * Metadata of the document\n       * @type {{parsed: {}, raw: string, format: string}}\n       */\n      metadata = {\n        parsed: {},\n        raw: '',\n        format: ''\n      };\n\n  _constructor();\n\n  /**\n   * Converter constructor\n   * @private\n   */\n  function _constructor () {\n    converterOptions = converterOptions || {};\n\n    for (var gOpt in globalOptions) {\n      if (globalOptions.hasOwnProperty(gOpt)) {\n        options[gOpt] = globalOptions[gOpt];\n      }\n    }\n\n    // Merge options\n    if (typeof converterOptions === 'object') {\n      for (var opt in converterOptions) {\n        if (converterOptions.hasOwnProperty(opt)) {\n          options[opt] = converterOptions[opt];\n        }\n      }\n    } else {\n      throw Error('Converter expects the passed parameter to be an object, but ' + typeof converterOptions +\n      ' was passed instead.');\n    }\n\n    if (options.extensions) {\n      showdown.helper.forEach(options.extensions, _parseExtension);\n    }\n  }\n\n  /**\n   * Parse extension\n   * @param {*} ext\n   * @param {string} [name='']\n   * @private\n   */\n  function _parseExtension (ext, name) {\n\n    name = name || null;\n    // If it's a string, the extension was previously loaded\n    if (showdown.helper.isString(ext)) {\n      ext = showdown.helper.stdExtName(ext);\n      name = ext;\n\n      // LEGACY_SUPPORT CODE\n      if (showdown.extensions[ext]) {\n        console.warn('DEPRECATION WARNING: ' + ext + ' is an old extension that uses a deprecated loading method.' +\n          'Please inform the developer that the extension should be updated!');\n        legacyExtensionLoading(showdown.extensions[ext], ext);\n        return;\n        // END LEGACY SUPPORT CODE\n\n      } else if (!showdown.helper.isUndefined(extensions[ext])) {\n        ext = extensions[ext];\n\n      } else {\n        throw Error('Extension \"' + ext + '\" could not be loaded. It was either not found or is not a valid extension.');\n      }\n    }\n\n    if (typeof ext === 'function') {\n      ext = ext();\n    }\n\n    if (!showdown.helper.isArray(ext)) {\n      ext = [ext];\n    }\n\n    var validExt = validate(ext, name);\n    if (!validExt.valid) {\n      throw Error(validExt.error);\n    }\n\n    for (var i = 0; i < ext.length; ++i) {\n      switch (ext[i].type) {\n\n        case 'lang':\n          langExtensions.push(ext[i]);\n          break;\n\n        case 'output':\n          outputModifiers.push(ext[i]);\n          break;\n      }\n      if (ext[i].hasOwnProperty('listeners')) {\n        for (var ln in ext[i].listeners) {\n          if (ext[i].listeners.hasOwnProperty(ln)) {\n            listen(ln, ext[i].listeners[ln]);\n          }\n        }\n      }\n    }\n\n  }\n\n  /**\n   * LEGACY_SUPPORT\n   * @param {*} ext\n   * @param {string} name\n   */\n  function legacyExtensionLoading (ext, name) {\n    if (typeof ext === 'function') {\n      ext = ext(new showdown.Converter());\n    }\n    if (!showdown.helper.isArray(ext)) {\n      ext = [ext];\n    }\n    var valid = validate(ext, name);\n\n    if (!valid.valid) {\n      throw Error(valid.error);\n    }\n\n    for (var i = 0; i < ext.length; ++i) {\n      switch (ext[i].type) {\n        case 'lang':\n          langExtensions.push(ext[i]);\n          break;\n        case 'output':\n          outputModifiers.push(ext[i]);\n          break;\n        default:// should never reach here\n          throw Error('Extension loader error: Type unrecognized!!!');\n      }\n    }\n  }\n\n  /**\n   * Listen to an event\n   * @param {string} name\n   * @param {function} callback\n   */\n  function listen (name, callback) {\n    if (!showdown.helper.isString(name)) {\n      throw Error('Invalid argument in converter.listen() method: name must be a string, but ' + typeof name + ' given');\n    }\n\n    if (typeof callback !== 'function') {\n      throw Error('Invalid argument in converter.listen() method: callback must be a function, but ' + typeof callback + ' given');\n    }\n\n    if (!listeners.hasOwnProperty(name)) {\n      listeners[name] = [];\n    }\n    listeners[name].push(callback);\n  }\n\n  function rTrimInputText (text) {\n    var rsp = text.match(/^\\s*/)[0].length,\n        rgx = new RegExp('^\\\\s{0,' + rsp + '}', 'gm');\n    return text.replace(rgx, '');\n  }\n\n  /**\n   * Dispatch an event\n   * @private\n   * @param {string} evtName Event name\n   * @param {string} text Text\n   * @param {{}} options Converter Options\n   * @param {{}} globals\n   * @returns {string}\n   */\n  this._dispatch = function dispatch (evtName, text, options, globals) {\n    if (listeners.hasOwnProperty(evtName)) {\n      for (var ei = 0; ei < listeners[evtName].length; ++ei) {\n        var nText = listeners[evtName][ei](evtName, text, this, options, globals);\n        if (nText && typeof nText !== 'undefined') {\n          text = nText;\n        }\n      }\n    }\n    return text;\n  };\n\n  /**\n   * Listen to an event\n   * @param {string} name\n   * @param {function} callback\n   * @returns {showdown.Converter}\n   */\n  this.listen = function (name, callback) {\n    listen(name, callback);\n    return this;\n  };\n\n  /**\n   * Converts a markdown string into HTML\n   * @param {string} text\n   * @returns {*}\n   */\n  this.makeHtml = function (text) {\n    //check if text is not falsy\n    if (!text) {\n      return text;\n    }\n\n    var globals = {\n      gHtmlBlocks:     [],\n      gHtmlMdBlocks:   [],\n      gHtmlSpans:      [],\n      gUrls:           {},\n      gTitles:         {},\n      gDimensions:     {},\n      gListLevel:      0,\n      hashLinkCounts:  {},\n      langExtensions:  langExtensions,\n      outputModifiers: outputModifiers,\n      converter:       this,\n      ghCodeBlocks:    [],\n      metadata: {\n        parsed: {},\n        raw: '',\n        format: ''\n      }\n    };\n\n    // This lets us use ¨ trema as an escape char to avoid md5 hashes\n    // The choice of character is arbitrary; anything that isn't\n    // magic in Markdown will work.\n    text = text.replace(/¨/g, '¨T');\n\n    // Replace $ with ¨D\n    // RegExp interprets $ as a special character\n    // when it's in a replacement string\n    text = text.replace(/\\$/g, '¨D');\n\n    // Standardize line endings\n    text = text.replace(/\\r\\n/g, '\\n'); // DOS to Unix\n    text = text.replace(/\\r/g, '\\n'); // Mac to Unix\n\n    // Stardardize line spaces\n    text = text.replace(/\\u00A0/g, '&nbsp;');\n\n    if (options.smartIndentationFix) {\n      text = rTrimInputText(text);\n    }\n\n    // Make sure text begins and ends with a couple of newlines:\n    text = '\\n\\n' + text + '\\n\\n';\n\n    // detab\n    text = showdown.subParser('detab')(text, options, globals);\n\n    /**\n     * Strip any lines consisting only of spaces and tabs.\n     * This makes subsequent regexs easier to write, because we can\n     * match consecutive blank lines with /\\n+/ instead of something\n     * contorted like /[ \\t]*\\n+/\n     */\n    text = text.replace(/^[ \\t]+$/mg, '');\n\n    //run languageExtensions\n    showdown.helper.forEach(langExtensions, function (ext) {\n      text = showdown.subParser('runExtension')(ext, text, options, globals);\n    });\n\n    // run the sub parsers\n    text = showdown.subParser('metadata')(text, options, globals);\n    text = showdown.subParser('hashPreCodeTags')(text, options, globals);\n    text = showdown.subParser('githubCodeBlocks')(text, options, globals);\n    text = showdown.subParser('hashHTMLBlocks')(text, options, globals);\n    text = showdown.subParser('hashCodeTags')(text, options, globals);\n    text = showdown.subParser('stripLinkDefinitions')(text, options, globals);\n    text = showdown.subParser('blockGamut')(text, options, globals);\n    text = showdown.subParser('unhashHTMLSpans')(text, options, globals);\n    text = showdown.subParser('unescapeSpecialChars')(text, options, globals);\n\n    // attacklab: Restore dollar signs\n    text = text.replace(/¨D/g, '$$');\n\n    // attacklab: Restore tremas\n    text = text.replace(/¨T/g, '¨');\n\n    // render a complete html document instead of a partial if the option is enabled\n    text = showdown.subParser('completeHTMLDocument')(text, options, globals);\n\n    // Run output modifiers\n    showdown.helper.forEach(outputModifiers, function (ext) {\n      text = showdown.subParser('runExtension')(ext, text, options, globals);\n    });\n\n    // update metadata\n    metadata = globals.metadata;\n    return text;\n  };\n\n  /**\n   * Converts an HTML string into a markdown string\n   * @param src\n   * @param [HTMLParser] A WHATWG DOM and HTML parser, such as JSDOM. If none is supplied, window.document will be used.\n   * @returns {string}\n   */\n  this.makeMarkdown = this.makeMd = function (src, HTMLParser) {\n\n    // replace \\r\\n with \\n\n    src = src.replace(/\\r\\n/g, '\\n');\n    src = src.replace(/\\r/g, '\\n'); // old macs\n\n    // due to an edge case, we need to find this: > <\n    // to prevent removing of non silent white spaces\n    // ex: <em>this is</em> <strong>sparta</strong>\n    src = src.replace(/>[ \\t]+</, '>¨NBSP;<');\n\n    if (!HTMLParser) {\n      if (window && window.document) {\n        HTMLParser = window.document;\n      } else {\n        throw new Error('HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM');\n      }\n    }\n\n    var doc = HTMLParser.createElement('div');\n    doc.innerHTML = src;\n\n    var globals = {\n      preList: substitutePreCodeTags(doc)\n    };\n\n    // remove all newlines and collapse spaces\n    clean(doc);\n\n    // some stuff, like accidental reference links must now be escaped\n    // TODO\n    // doc.innerHTML = doc.innerHTML.replace(/\\[[\\S\\t ]]/);\n\n    var nodes = doc.childNodes,\n        mdDoc = '';\n\n    for (var i = 0; i < nodes.length; i++) {\n      mdDoc += showdown.subParser('makeMarkdown.node')(nodes[i], globals);\n    }\n\n    function clean (node) {\n      for (var n = 0; n < node.childNodes.length; ++n) {\n        var child = node.childNodes[n];\n        if (child.nodeType === 3) {\n          if (!/\\S/.test(child.nodeValue) && !/^[ ]+$/.test(child.nodeValue)) {\n            node.removeChild(child);\n            --n;\n          } else {\n            child.nodeValue = child.nodeValue.split('\\n').join(' ');\n            child.nodeValue = child.nodeValue.replace(/(\\s)+/g, '$1');\n          }\n        } else if (child.nodeType === 1) {\n          clean(child);\n        }\n      }\n    }\n\n    // find all pre tags and replace contents with placeholder\n    // we need this so that we can remove all indentation from html\n    // to ease up parsing\n    function substitutePreCodeTags (doc) {\n\n      var pres = doc.querySelectorAll('pre'),\n          presPH = [];\n\n      for (var i = 0; i < pres.length; ++i) {\n\n        if (pres[i].childElementCount === 1 && pres[i].firstChild.tagName.toLowerCase() === 'code') {\n          var content = pres[i].firstChild.innerHTML.trim(),\n              language = pres[i].firstChild.getAttribute('data-language') || '';\n\n          // if data-language attribute is not defined, then we look for class language-*\n          if (language === '') {\n            var classes = pres[i].firstChild.className.split(' ');\n            for (var c = 0; c < classes.length; ++c) {\n              var matches = classes[c].match(/^language-(.+)$/);\n              if (matches !== null) {\n                language = matches[1];\n                break;\n              }\n            }\n          }\n\n          // unescape html entities in content\n          content = showdown.helper.unescapeHTMLEntities(content);\n\n          presPH.push(content);\n          pres[i].outerHTML = '<precode language=\"' + language + '\" precodenum=\"' + i.toString() + '\"></precode>';\n        } else {\n          presPH.push(pres[i].innerHTML);\n          pres[i].innerHTML = '';\n          pres[i].setAttribute('prenum', i.toString());\n        }\n      }\n      return presPH;\n    }\n\n    return mdDoc;\n  };\n\n  /**\n   * Set an option of this Converter instance\n   * @param {string} key\n   * @param {*} value\n   */\n  this.setOption = function (key, value) {\n    options[key] = value;\n  };\n\n  /**\n   * Get the option of this Converter instance\n   * @param {string} key\n   * @returns {*}\n   */\n  this.getOption = function (key) {\n    return options[key];\n  };\n\n  /**\n   * Get the options of this Converter instance\n   * @returns {{}}\n   */\n  this.getOptions = function () {\n    return options;\n  };\n\n  /**\n   * Add extension to THIS converter\n   * @param {{}} extension\n   * @param {string} [name=null]\n   */\n  this.addExtension = function (extension, name) {\n    name = name || null;\n    _parseExtension(extension, name);\n  };\n\n  /**\n   * Use a global registered extension with THIS converter\n   * @param {string} extensionName Name of the previously registered extension\n   */\n  this.useExtension = function (extensionName) {\n    _parseExtension(extensionName);\n  };\n\n  /**\n   * Set the flavor THIS converter should use\n   * @param {string} name\n   */\n  this.setFlavor = function (name) {\n    if (!flavor.hasOwnProperty(name)) {\n      throw Error(name + ' flavor was not found');\n    }\n    var preset = flavor[name];\n    setConvFlavor = name;\n    for (var option in preset) {\n      if (preset.hasOwnProperty(option)) {\n        options[option] = preset[option];\n      }\n    }\n  };\n\n  /**\n   * Get the currently set flavor of this converter\n   * @returns {string}\n   */\n  this.getFlavor = function () {\n    return setConvFlavor;\n  };\n\n  /**\n   * Remove an extension from THIS converter.\n   * Note: This is a costly operation. It's better to initialize a new converter\n   * and specify the extensions you wish to use\n   * @param {Array} extension\n   */\n  this.removeExtension = function (extension) {\n    if (!showdown.helper.isArray(extension)) {\n      extension = [extension];\n    }\n    for (var a = 0; a < extension.length; ++a) {\n      var ext = extension[a];\n      for (var i = 0; i < langExtensions.length; ++i) {\n        if (langExtensions[i] === ext) {\n          langExtensions.splice(i, 1);\n        }\n      }\n      for (var ii = 0; ii < outputModifiers.length; ++ii) {\n        if (outputModifiers[ii] === ext) {\n          outputModifiers.splice(ii, 1);\n        }\n      }\n    }\n  };\n\n  /**\n   * Get all extension of THIS converter\n   * @returns {{language: Array, output: Array}}\n   */\n  this.getAllExtensions = function () {\n    return {\n      language: langExtensions,\n      output: outputModifiers\n    };\n  };\n\n  /**\n   * Get the metadata of the previously parsed document\n   * @param raw\n   * @returns {string|{}}\n   */\n  this.getMetadata = function (raw) {\n    if (raw) {\n      return metadata.raw;\n    } else {\n      return metadata.parsed;\n    }\n  };\n\n  /**\n   * Get the metadata format of the previously parsed document\n   * @returns {string}\n   */\n  this.getMetadataFormat = function () {\n    return metadata.format;\n  };\n\n  /**\n   * Private: set a single key, value metadata pair\n   * @param {string} key\n   * @param {string} value\n   */\n  this._setMetadataPair = function (key, value) {\n    metadata.parsed[key] = value;\n  };\n\n  /**\n   * Private: set metadata format\n   * @param {string} format\n   */\n  this._setMetadataFormat = function (format) {\n    metadata.format = format;\n  };\n\n  /**\n   * Private: set metadata raw text\n   * @param {string} raw\n   */\n  this._setMetadataRaw = function (raw) {\n    metadata.raw = raw;\n  };\n};\n\r\n/**\n * Turn Markdown link shortcuts into XHTML <a> tags.\n */\nshowdown.subParser('anchors', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('anchors.before', text, options, globals);\n\n  var writeAnchorTag = function (wholeMatch, linkText, linkId, url, m5, m6, title) {\n    if (showdown.helper.isUndefined(title)) {\n      title = '';\n    }\n    linkId = linkId.toLowerCase();\n\n    // Special case for explicit empty url\n    if (wholeMatch.search(/\\(<?\\s*>? ?(['\"].*['\"])?\\)$/m) > -1) {\n      url = '';\n    } else if (!url) {\n      if (!linkId) {\n        // lower-case and turn embedded newlines into spaces\n        linkId = linkText.toLowerCase().replace(/ ?\\n/g, ' ');\n      }\n      url = '#' + linkId;\n\n      if (!showdown.helper.isUndefined(globals.gUrls[linkId])) {\n        url = globals.gUrls[linkId];\n        if (!showdown.helper.isUndefined(globals.gTitles[linkId])) {\n          title = globals.gTitles[linkId];\n        }\n      } else {\n        return wholeMatch;\n      }\n    }\n\n    //url = showdown.helper.escapeCharacters(url, '*_', false); // replaced line to improve performance\n    url = url.replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);\n\n    var result = '<a href=\"' + url + '\"';\n\n    if (title !== '' && title !== null) {\n      title = title.replace(/\"/g, '&quot;');\n      //title = showdown.helper.escapeCharacters(title, '*_', false); // replaced line to improve performance\n      title = title.replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);\n      result += ' title=\"' + title + '\"';\n    }\n\n    // optionLinksInNewWindow only applies\n    // to external links. Hash links (#) open in same page\n    if (options.openLinksInNewWindow && !/^#/.test(url)) {\n      // escaped _\n      result += ' rel=\"noopener noreferrer\" target=\"¨E95Eblank\"';\n    }\n\n    result += '>' + linkText + '</a>';\n\n    return result;\n  };\n\n  // First, handle reference-style links: [link text] [id]\n  text = text.replace(/\\[((?:\\[[^\\]]*]|[^\\[\\]])*)] ?(?:\\n *)?\\[(.*?)]()()()()/g, writeAnchorTag);\n\n  // Next, inline-style links: [link text](url \"optional title\")\n  // cases with crazy urls like ./image/cat1).png\n  text = text.replace(/\\[((?:\\[[^\\]]*]|[^\\[\\]])*)]()[ \\t]*\\([ \\t]?<([^>]*)>(?:[ \\t]*(([\"'])([^\"]*?)\\5))?[ \\t]?\\)/g,\n    writeAnchorTag);\n\n  // normal cases\n  text = text.replace(/\\[((?:\\[[^\\]]*]|[^\\[\\]])*)]()[ \\t]*\\([ \\t]?<?([\\S]+?(?:\\([\\S]*?\\)[\\S]*?)?)>?(?:[ \\t]*(([\"'])([^\"]*?)\\5))?[ \\t]?\\)/g,\n    writeAnchorTag);\n\n  // handle reference-style shortcuts: [link text]\n  // These must come last in case you've also got [link test][1]\n  // or [link test](/foo)\n  text = text.replace(/\\[([^\\[\\]]+)]()()()()()/g, writeAnchorTag);\n\n  // Lastly handle GithubMentions if option is enabled\n  if (options.ghMentions) {\n    text = text.replace(/(^|\\s)(\\\\)?(@([a-z\\d]+(?:[a-z\\d.-]+?[a-z\\d]+)*))/gmi, function (wm, st, escape, mentions, username) {\n      if (escape === '\\\\') {\n        return st + mentions;\n      }\n\n      //check if options.ghMentionsLink is a string\n      if (!showdown.helper.isString(options.ghMentionsLink)) {\n        throw new Error('ghMentionsLink option must be a string');\n      }\n      var lnk = options.ghMentionsLink.replace(/\\{u}/g, username),\n          target = '';\n      if (options.openLinksInNewWindow) {\n        target = ' rel=\"noopener noreferrer\" target=\"¨E95Eblank\"';\n      }\n      return st + '<a href=\"' + lnk + '\"' + target + '>' + mentions + '</a>';\n    });\n  }\n\n  text = globals.converter._dispatch('anchors.after', text, options, globals);\n  return text;\n});\n\r\n// url allowed chars [a-z\\d_.~:/?#[]@!$&'()*+,;=-]\n\nvar simpleURLRegex  = /([*~_]+|\\b)(((https?|ftp|dict):\\/\\/|www\\.)[^'\">\\s]+?\\.[^'\">\\s]+?)()(\\1)?(?=\\s|$)(?![\"<>])/gi,\n    simpleURLRegex2 = /([*~_]+|\\b)(((https?|ftp|dict):\\/\\/|www\\.)[^'\">\\s]+\\.[^'\">\\s]+?)([.!?,()\\[\\]])?(\\1)?(?=\\s|$)(?![\"<>])/gi,\n    delimUrlRegex   = /()<(((https?|ftp|dict):\\/\\/|www\\.)[^'\">\\s]+)()>()/gi,\n    simpleMailRegex = /(^|\\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)(?=$|\\s)/gmi,\n    delimMailRegex  = /<()(?:mailto:)?([-.\\w]+@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)>/gi,\n\n    replaceLink = function (options) {\n      'use strict';\n      return function (wm, leadingMagicChars, link, m2, m3, trailingPunctuation, trailingMagicChars) {\n        link = link.replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);\n        var lnkTxt = link,\n            append = '',\n            target = '',\n            lmc    = leadingMagicChars || '',\n            tmc    = trailingMagicChars || '';\n        if (/^www\\./i.test(link)) {\n          link = link.replace(/^www\\./i, 'http://www.');\n        }\n        if (options.excludeTrailingPunctuationFromURLs && trailingPunctuation) {\n          append = trailingPunctuation;\n        }\n        if (options.openLinksInNewWindow) {\n          target = ' rel=\"noopener noreferrer\" target=\"¨E95Eblank\"';\n        }\n        return lmc + '<a href=\"' + link + '\"' + target + '>' + lnkTxt + '</a>' + append + tmc;\n      };\n    },\n\n    replaceMail = function (options, globals) {\n      'use strict';\n      return function (wholeMatch, b, mail) {\n        var href = 'mailto:';\n        b = b || '';\n        mail = showdown.subParser('unescapeSpecialChars')(mail, options, globals);\n        if (options.encodeEmails) {\n          href = showdown.helper.encodeEmailAddress(href + mail);\n          mail = showdown.helper.encodeEmailAddress(mail);\n        } else {\n          href = href + mail;\n        }\n        return b + '<a href=\"' + href + '\">' + mail + '</a>';\n      };\n    };\n\nshowdown.subParser('autoLinks', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('autoLinks.before', text, options, globals);\n\n  text = text.replace(delimUrlRegex, replaceLink(options));\n  text = text.replace(delimMailRegex, replaceMail(options, globals));\n\n  text = globals.converter._dispatch('autoLinks.after', text, options, globals);\n\n  return text;\n});\n\nshowdown.subParser('simplifiedAutoLinks', function (text, options, globals) {\n  'use strict';\n\n  if (!options.simplifiedAutoLink) {\n    return text;\n  }\n\n  text = globals.converter._dispatch('simplifiedAutoLinks.before', text, options, globals);\n\n  if (options.excludeTrailingPunctuationFromURLs) {\n    text = text.replace(simpleURLRegex2, replaceLink(options));\n  } else {\n    text = text.replace(simpleURLRegex, replaceLink(options));\n  }\n  text = text.replace(simpleMailRegex, replaceMail(options, globals));\n\n  text = globals.converter._dispatch('simplifiedAutoLinks.after', text, options, globals);\n\n  return text;\n});\n\r\n/**\n * These are all the transformations that form block-level\n * tags like paragraphs, headers, and list items.\n */\nshowdown.subParser('blockGamut', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('blockGamut.before', text, options, globals);\n\n  // we parse blockquotes first so that we can have headings and hrs\n  // inside blockquotes\n  text = showdown.subParser('blockQuotes')(text, options, globals);\n  text = showdown.subParser('headers')(text, options, globals);\n\n  // Do Horizontal Rules:\n  text = showdown.subParser('horizontalRule')(text, options, globals);\n\n  text = showdown.subParser('lists')(text, options, globals);\n  text = showdown.subParser('codeBlocks')(text, options, globals);\n  text = showdown.subParser('tables')(text, options, globals);\n\n  // We already ran _HashHTMLBlocks() before, in Markdown(), but that\n  // was to escape raw HTML in the original Markdown source. This time,\n  // we're escaping the markup we've just created, so that we don't wrap\n  // <p> tags around block-level tags.\n  text = showdown.subParser('hashHTMLBlocks')(text, options, globals);\n  text = showdown.subParser('paragraphs')(text, options, globals);\n\n  text = globals.converter._dispatch('blockGamut.after', text, options, globals);\n\n  return text;\n});\n\r\nshowdown.subParser('blockQuotes', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('blockQuotes.before', text, options, globals);\n\n  // add a couple extra lines after the text and endtext mark\n  text = text + '\\n\\n';\n\n  var rgx = /(^ {0,3}>[ \\t]?.+\\n(.+\\n)*\\n*)+/gm;\n\n  if (options.splitAdjacentBlockquotes) {\n    rgx = /^ {0,3}>[\\s\\S]*?(?:\\n\\n)/gm;\n  }\n\n  text = text.replace(rgx, function (bq) {\n    // attacklab: hack around Konqueror 3.5.4 bug:\n    // \"----------bug\".replace(/^-/g,\"\") == \"bug\"\n    bq = bq.replace(/^[ \\t]*>[ \\t]?/gm, ''); // trim one level of quoting\n\n    // attacklab: clean up hack\n    bq = bq.replace(/¨0/g, '');\n\n    bq = bq.replace(/^[ \\t]+$/gm, ''); // trim whitespace-only lines\n    bq = showdown.subParser('githubCodeBlocks')(bq, options, globals);\n    bq = showdown.subParser('blockGamut')(bq, options, globals); // recurse\n\n    bq = bq.replace(/(^|\\n)/g, '$1  ');\n    // These leading spaces screw with <pre> content, so we need to fix that:\n    bq = bq.replace(/(\\s*<pre>[^\\r]+?<\\/pre>)/gm, function (wholeMatch, m1) {\n      var pre = m1;\n      // attacklab: hack around Konqueror 3.5.4 bug:\n      pre = pre.replace(/^  /mg, '¨0');\n      pre = pre.replace(/¨0/g, '');\n      return pre;\n    });\n\n    return showdown.subParser('hashBlock')('<blockquote>\\n' + bq + '\\n</blockquote>', options, globals);\n  });\n\n  text = globals.converter._dispatch('blockQuotes.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Process Markdown `<pre><code>` blocks.\n */\nshowdown.subParser('codeBlocks', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('codeBlocks.before', text, options, globals);\n\n  // sentinel workarounds for lack of \\A and \\Z, safari\\khtml bug\n  text += '¨0';\n\n  var pattern = /(?:\\n\\n|^)((?:(?:[ ]{4}|\\t).*\\n+)+)(\\n*[ ]{0,3}[^ \\t\\n]|(?=¨0))/g;\n  text = text.replace(pattern, function (wholeMatch, m1, m2) {\n    var codeblock = m1,\n        nextChar = m2,\n        end = '\\n';\n\n    codeblock = showdown.subParser('outdent')(codeblock, options, globals);\n    codeblock = showdown.subParser('encodeCode')(codeblock, options, globals);\n    codeblock = showdown.subParser('detab')(codeblock, options, globals);\n    codeblock = codeblock.replace(/^\\n+/g, ''); // trim leading newlines\n    codeblock = codeblock.replace(/\\n+$/g, ''); // trim trailing newlines\n\n    if (options.omitExtraWLInCodeBlocks) {\n      end = '';\n    }\n\n    codeblock = '<pre><code>' + codeblock + end + '</code></pre>';\n\n    return showdown.subParser('hashBlock')(codeblock, options, globals) + nextChar;\n  });\n\n  // strip sentinel\n  text = text.replace(/¨0/, '');\n\n  text = globals.converter._dispatch('codeBlocks.after', text, options, globals);\n  return text;\n});\n\r\n/**\n *\n *   *  Backtick quotes are used for <code></code> spans.\n *\n *   *  You can use multiple backticks as the delimiters if you want to\n *     include literal backticks in the code span. So, this input:\n *\n *         Just type ``foo `bar` baz`` at the prompt.\n *\n *       Will translate to:\n *\n *         <p>Just type <code>foo `bar` baz</code> at the prompt.</p>\n *\n *    There's no arbitrary limit to the number of backticks you\n *    can use as delimters. If you need three consecutive backticks\n *    in your code, use four for delimiters, etc.\n *\n *  *  You can use spaces to get literal backticks at the edges:\n *\n *         ... type `` `bar` `` ...\n *\n *       Turns to:\n *\n *         ... type <code>`bar`</code> ...\n */\nshowdown.subParser('codeSpans', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('codeSpans.before', text, options, globals);\n\n  if (typeof (text) === 'undefined') {\n    text = '';\n  }\n  text = text.replace(/(^|[^\\\\])(`+)([^\\r]*?[^`])\\2(?!`)/gm,\n    function (wholeMatch, m1, m2, m3) {\n      var c = m3;\n      c = c.replace(/^([ \\t]*)/g, '');\t// leading whitespace\n      c = c.replace(/[ \\t]*$/g, '');\t// trailing whitespace\n      c = showdown.subParser('encodeCode')(c, options, globals);\n      c = m1 + '<code>' + c + '</code>';\n      c = showdown.subParser('hashHTMLSpans')(c, options, globals);\n      return c;\n    }\n  );\n\n  text = globals.converter._dispatch('codeSpans.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Create a full HTML document from the processed markdown\n */\nshowdown.subParser('completeHTMLDocument', function (text, options, globals) {\n  'use strict';\n\n  if (!options.completeHTMLDocument) {\n    return text;\n  }\n\n  text = globals.converter._dispatch('completeHTMLDocument.before', text, options, globals);\n\n  var doctype = 'html',\n      doctypeParsed = '<!DOCTYPE HTML>\\n',\n      title = '',\n      charset = '<meta charset=\"utf-8\">\\n',\n      lang = '',\n      metadata = '';\n\n  if (typeof globals.metadata.parsed.doctype !== 'undefined') {\n    doctypeParsed = '<!DOCTYPE ' +  globals.metadata.parsed.doctype + '>\\n';\n    doctype = globals.metadata.parsed.doctype.toString().toLowerCase();\n    if (doctype === 'html' || doctype === 'html5') {\n      charset = '<meta charset=\"utf-8\">';\n    }\n  }\n\n  for (var meta in globals.metadata.parsed) {\n    if (globals.metadata.parsed.hasOwnProperty(meta)) {\n      switch (meta.toLowerCase()) {\n        case 'doctype':\n          break;\n\n        case 'title':\n          title = '<title>' +  globals.metadata.parsed.title + '</title>\\n';\n          break;\n\n        case 'charset':\n          if (doctype === 'html' || doctype === 'html5') {\n            charset = '<meta charset=\"' + globals.metadata.parsed.charset + '\">\\n';\n          } else {\n            charset = '<meta name=\"charset\" content=\"' + globals.metadata.parsed.charset + '\">\\n';\n          }\n          break;\n\n        case 'language':\n        case 'lang':\n          lang = ' lang=\"' + globals.metadata.parsed[meta] + '\"';\n          metadata += '<meta name=\"' + meta + '\" content=\"' + globals.metadata.parsed[meta] + '\">\\n';\n          break;\n\n        default:\n          metadata += '<meta name=\"' + meta + '\" content=\"' + globals.metadata.parsed[meta] + '\">\\n';\n      }\n    }\n  }\n\n  text = doctypeParsed + '<html' + lang + '>\\n<head>\\n' + title + charset + metadata + '</head>\\n<body>\\n' + text.trim() + '\\n</body>\\n</html>';\n\n  text = globals.converter._dispatch('completeHTMLDocument.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Convert all tabs to spaces\n */\nshowdown.subParser('detab', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('detab.before', text, options, globals);\n\n  // expand first n-1 tabs\n  text = text.replace(/\\t(?=\\t)/g, '    '); // g_tab_width\n\n  // replace the nth with two sentinels\n  text = text.replace(/\\t/g, '¨A¨B');\n\n  // use the sentinel to anchor our regex so it doesn't explode\n  text = text.replace(/¨B(.+?)¨A/g, function (wholeMatch, m1) {\n    var leadingText = m1,\n        numSpaces = 4 - leadingText.length % 4;  // g_tab_width\n\n    // there *must* be a better way to do this:\n    for (var i = 0; i < numSpaces; i++) {\n      leadingText += ' ';\n    }\n\n    return leadingText;\n  });\n\n  // clean up sentinels\n  text = text.replace(/¨A/g, '    ');  // g_tab_width\n  text = text.replace(/¨B/g, '');\n\n  text = globals.converter._dispatch('detab.after', text, options, globals);\n  return text;\n});\n\r\nshowdown.subParser('ellipsis', function (text, options, globals) {\n  'use strict';\n\n  if (!options.ellipsis) {\n    return text;\n  }\n\n  text = globals.converter._dispatch('ellipsis.before', text, options, globals);\n\n  text = text.replace(/\\.\\.\\./g, '…');\n\n  text = globals.converter._dispatch('ellipsis.after', text, options, globals);\n\n  return text;\n});\n\r\n/**\n * Turn emoji codes into emojis\n *\n * List of supported emojis: https://github.com/showdownjs/showdown/wiki/Emojis\n */\nshowdown.subParser('emoji', function (text, options, globals) {\n  'use strict';\n\n  if (!options.emoji) {\n    return text;\n  }\n\n  text = globals.converter._dispatch('emoji.before', text, options, globals);\n\n  var emojiRgx = /:([\\S]+?):/g;\n\n  text = text.replace(emojiRgx, function (wm, emojiCode) {\n    if (showdown.helper.emojis.hasOwnProperty(emojiCode)) {\n      return showdown.helper.emojis[emojiCode];\n    }\n    return wm;\n  });\n\n  text = globals.converter._dispatch('emoji.after', text, options, globals);\n\n  return text;\n});\n\r\n/**\n * Smart processing for ampersands and angle brackets that need to be encoded.\n */\nshowdown.subParser('encodeAmpsAndAngles', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('encodeAmpsAndAngles.before', text, options, globals);\n\n  // Ampersand-encoding based entirely on Nat Irons's Amputator MT plugin:\n  // http://bumppo.net/projects/amputator/\n  text = text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\\w+);)/g, '&amp;');\n\n  // Encode naked <'s\n  text = text.replace(/<(?![a-z\\/?$!])/gi, '&lt;');\n\n  // Encode <\n  text = text.replace(/</g, '&lt;');\n\n  // Encode >\n  text = text.replace(/>/g, '&gt;');\n\n  text = globals.converter._dispatch('encodeAmpsAndAngles.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Returns the string, with after processing the following backslash escape sequences.\n *\n * attacklab: The polite way to do this is with the new escapeCharacters() function:\n *\n *    text = escapeCharacters(text,\"\\\\\",true);\n *    text = escapeCharacters(text,\"`*_{}[]()>#+-.!\",true);\n *\n * ...but we're sidestepping its use of the (slow) RegExp constructor\n * as an optimization for Firefox.  This function gets called a LOT.\n */\nshowdown.subParser('encodeBackslashEscapes', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('encodeBackslashEscapes.before', text, options, globals);\n\n  text = text.replace(/\\\\(\\\\)/g, showdown.helper.escapeCharactersCallback);\n  text = text.replace(/\\\\([`*_{}\\[\\]()>#+.!~=|:-])/g, showdown.helper.escapeCharactersCallback);\n\n  text = globals.converter._dispatch('encodeBackslashEscapes.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Encode/escape certain characters inside Markdown code runs.\n * The point is that in code, these characters are literals,\n * and lose their special Markdown meanings.\n */\nshowdown.subParser('encodeCode', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('encodeCode.before', text, options, globals);\n\n  // Encode all ampersands; HTML entities are not\n  // entities within a Markdown code span.\n  text = text\n    .replace(/&/g, '&amp;')\n  // Do the angle bracket song and dance:\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n  // Now, escape characters that are magic in Markdown:\n    .replace(/([*_{}\\[\\]\\\\=~-])/g, showdown.helper.escapeCharactersCallback);\n\n  text = globals.converter._dispatch('encodeCode.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Within tags -- meaning between < and > -- encode [\\ ` * _ ~ =] so they\n * don't conflict with their use in Markdown for code, italics and strong.\n */\nshowdown.subParser('escapeSpecialCharsWithinTagAttributes', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('escapeSpecialCharsWithinTagAttributes.before', text, options, globals);\n\n  // Build a regex to find HTML tags.\n  var tags     = /<\\/?[a-z\\d_:-]+(?:[\\s]+[\\s\\S]+?)?>/gi,\n      comments = /<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;\n\n  text = text.replace(tags, function (wholeMatch) {\n    return wholeMatch\n      .replace(/(.)<\\/?code>(?=.)/g, '$1`')\n      .replace(/([\\\\`*_~=|])/g, showdown.helper.escapeCharactersCallback);\n  });\n\n  text = text.replace(comments, function (wholeMatch) {\n    return wholeMatch\n      .replace(/([\\\\`*_~=|])/g, showdown.helper.escapeCharactersCallback);\n  });\n\n  text = globals.converter._dispatch('escapeSpecialCharsWithinTagAttributes.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Handle github codeblocks prior to running HashHTML so that\n * HTML contained within the codeblock gets escaped properly\n * Example:\n * ```ruby\n *     def hello_world(x)\n *       puts \"Hello, #{x}\"\n *     end\n * ```\n */\nshowdown.subParser('githubCodeBlocks', function (text, options, globals) {\n  'use strict';\n\n  // early exit if option is not enabled\n  if (!options.ghCodeBlocks) {\n    return text;\n  }\n\n  text = globals.converter._dispatch('githubCodeBlocks.before', text, options, globals);\n\n  text += '¨0';\n\n  text = text.replace(/(?:^|\\n)(?: {0,3})(```+|~~~+)(?: *)([^\\s`~]*)\\n([\\s\\S]*?)\\n(?: {0,3})\\1/g, function (wholeMatch, delim, language, codeblock) {\n    var end = (options.omitExtraWLInCodeBlocks) ? '' : '\\n';\n\n    // First parse the github code block\n    codeblock = showdown.subParser('encodeCode')(codeblock, options, globals);\n    codeblock = showdown.subParser('detab')(codeblock, options, globals);\n    codeblock = codeblock.replace(/^\\n+/g, ''); // trim leading newlines\n    codeblock = codeblock.replace(/\\n+$/g, ''); // trim trailing whitespace\n\n    codeblock = '<pre><code' + (language ? ' class=\"' + language + ' language-' + language + '\"' : '') + '>' + codeblock + end + '</code></pre>';\n\n    codeblock = showdown.subParser('hashBlock')(codeblock, options, globals);\n\n    // Since GHCodeblocks can be false positives, we need to\n    // store the primitive text and the parsed text in a global var,\n    // and then return a token\n    return '\\n\\n¨G' + (globals.ghCodeBlocks.push({text: wholeMatch, codeblock: codeblock}) - 1) + 'G\\n\\n';\n  });\n\n  // attacklab: strip sentinel\n  text = text.replace(/¨0/, '');\n\n  return globals.converter._dispatch('githubCodeBlocks.after', text, options, globals);\n});\n\r\nshowdown.subParser('hashBlock', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('hashBlock.before', text, options, globals);\n  text = text.replace(/(^\\n+|\\n+$)/g, '');\n  text = '\\n\\n¨K' + (globals.gHtmlBlocks.push(text) - 1) + 'K\\n\\n';\n  text = globals.converter._dispatch('hashBlock.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Hash and escape <code> elements that should not be parsed as markdown\n */\nshowdown.subParser('hashCodeTags', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('hashCodeTags.before', text, options, globals);\n\n  var repFunc = function (wholeMatch, match, left, right) {\n    var codeblock = left + showdown.subParser('encodeCode')(match, options, globals) + right;\n    return '¨C' + (globals.gHtmlSpans.push(codeblock) - 1) + 'C';\n  };\n\n  // Hash naked <code>\n  text = showdown.helper.replaceRecursiveRegExp(text, repFunc, '<code\\\\b[^>]*>', '</code>', 'gim');\n\n  text = globals.converter._dispatch('hashCodeTags.after', text, options, globals);\n  return text;\n});\n\r\nshowdown.subParser('hashElement', function (text, options, globals) {\n  'use strict';\n\n  return function (wholeMatch, m1) {\n    var blockText = m1;\n\n    // Undo double lines\n    blockText = blockText.replace(/\\n\\n/g, '\\n');\n    blockText = blockText.replace(/^\\n/, '');\n\n    // strip trailing blank lines\n    blockText = blockText.replace(/\\n+$/g, '');\n\n    // Replace the element text with a marker (\"¨KxK\" where x is its key)\n    blockText = '\\n\\n¨K' + (globals.gHtmlBlocks.push(blockText) - 1) + 'K\\n\\n';\n\n    return blockText;\n  };\n});\n\r\nshowdown.subParser('hashHTMLBlocks', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('hashHTMLBlocks.before', text, options, globals);\n\n  var blockTags = [\n        'pre',\n        'div',\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'h6',\n        'blockquote',\n        'table',\n        'dl',\n        'ol',\n        'ul',\n        'script',\n        'noscript',\n        'form',\n        'fieldset',\n        'iframe',\n        'math',\n        'style',\n        'section',\n        'header',\n        'footer',\n        'nav',\n        'article',\n        'aside',\n        'address',\n        'audio',\n        'canvas',\n        'figure',\n        'hgroup',\n        'output',\n        'video',\n        'p'\n      ],\n      repFunc = function (wholeMatch, match, left, right) {\n        var txt = wholeMatch;\n        // check if this html element is marked as markdown\n        // if so, it's contents should be parsed as markdown\n        if (left.search(/\\bmarkdown\\b/) !== -1) {\n          txt = left + globals.converter.makeHtml(match) + right;\n        }\n        return '\\n\\n¨K' + (globals.gHtmlBlocks.push(txt) - 1) + 'K\\n\\n';\n      };\n\n  if (options.backslashEscapesHTMLTags) {\n    // encode backslash escaped HTML tags\n    text = text.replace(/\\\\<(\\/?[^>]+?)>/g, function (wm, inside) {\n      return '&lt;' + inside + '&gt;';\n    });\n  }\n\n  // hash HTML Blocks\n  for (var i = 0; i < blockTags.length; ++i) {\n\n    var opTagPos,\n        rgx1     = new RegExp('^ {0,3}(<' + blockTags[i] + '\\\\b[^>]*>)', 'im'),\n        patLeft  = '<' + blockTags[i] + '\\\\b[^>]*>',\n        patRight = '</' + blockTags[i] + '>';\n    // 1. Look for the first position of the first opening HTML tag in the text\n    while ((opTagPos = showdown.helper.regexIndexOf(text, rgx1)) !== -1) {\n\n      // if the HTML tag is \\ escaped, we need to escape it and break\n\n\n      //2. Split the text in that position\n      var subTexts = showdown.helper.splitAtIndex(text, opTagPos),\n          //3. Match recursively\n          newSubText1 = showdown.helper.replaceRecursiveRegExp(subTexts[1], repFunc, patLeft, patRight, 'im');\n\n      // prevent an infinite loop\n      if (newSubText1 === subTexts[1]) {\n        break;\n      }\n      text = subTexts[0].concat(newSubText1);\n    }\n  }\n  // HR SPECIAL CASE\n  text = text.replace(/(\\n {0,3}(<(hr)\\b([^<>])*?\\/?>)[ \\t]*(?=\\n{2,}))/g,\n    showdown.subParser('hashElement')(text, options, globals));\n\n  // Special case for standalone HTML comments\n  text = showdown.helper.replaceRecursiveRegExp(text, function (txt) {\n    return '\\n\\n¨K' + (globals.gHtmlBlocks.push(txt) - 1) + 'K\\n\\n';\n  }, '^ {0,3}<!--', '-->', 'gm');\n\n  // PHP and ASP-style processor instructions (<?...?> and <%...%>)\n  text = text.replace(/(?:\\n\\n)( {0,3}(?:<([?%])[^\\r]*?\\2>)[ \\t]*(?=\\n{2,}))/g,\n    showdown.subParser('hashElement')(text, options, globals));\n\n  text = globals.converter._dispatch('hashHTMLBlocks.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Hash span elements that should not be parsed as markdown\n */\nshowdown.subParser('hashHTMLSpans', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('hashHTMLSpans.before', text, options, globals);\n\n  function hashHTMLSpan (html) {\n    return '¨C' + (globals.gHtmlSpans.push(html) - 1) + 'C';\n  }\n\n  // Hash Self Closing tags\n  text = text.replace(/<[^>]+?\\/>/gi, function (wm) {\n    return hashHTMLSpan(wm);\n  });\n\n  // Hash tags without properties\n  text = text.replace(/<([^>]+?)>[\\s\\S]*?<\\/\\1>/g, function (wm) {\n    return hashHTMLSpan(wm);\n  });\n\n  // Hash tags with properties\n  text = text.replace(/<([^>]+?)\\s[^>]+?>[\\s\\S]*?<\\/\\1>/g, function (wm) {\n    return hashHTMLSpan(wm);\n  });\n\n  // Hash self closing tags without />\n  text = text.replace(/<[^>]+?>/gi, function (wm) {\n    return hashHTMLSpan(wm);\n  });\n\n  /*showdown.helper.matchRecursiveRegExp(text, '<code\\\\b[^>]*>', '</code>', 'gi');*/\n\n  text = globals.converter._dispatch('hashHTMLSpans.after', text, options, globals);\n  return text;\n});\n\n/**\n * Unhash HTML spans\n */\nshowdown.subParser('unhashHTMLSpans', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('unhashHTMLSpans.before', text, options, globals);\n\n  for (var i = 0; i < globals.gHtmlSpans.length; ++i) {\n    var repText = globals.gHtmlSpans[i],\n        // limiter to prevent infinite loop (assume 10 as limit for recurse)\n        limit = 0;\n\n    while (/¨C(\\d+)C/.test(repText)) {\n      var num = RegExp.$1;\n      repText = repText.replace('¨C' + num + 'C', globals.gHtmlSpans[num]);\n      if (limit === 10) {\n        console.error('maximum nesting of 10 spans reached!!!');\n        break;\n      }\n      ++limit;\n    }\n    text = text.replace('¨C' + i + 'C', repText);\n  }\n\n  text = globals.converter._dispatch('unhashHTMLSpans.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Hash and escape <pre><code> elements that should not be parsed as markdown\n */\nshowdown.subParser('hashPreCodeTags', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('hashPreCodeTags.before', text, options, globals);\n\n  var repFunc = function (wholeMatch, match, left, right) {\n    // encode html entities\n    var codeblock = left + showdown.subParser('encodeCode')(match, options, globals) + right;\n    return '\\n\\n¨G' + (globals.ghCodeBlocks.push({text: wholeMatch, codeblock: codeblock}) - 1) + 'G\\n\\n';\n  };\n\n  // Hash <pre><code>\n  text = showdown.helper.replaceRecursiveRegExp(text, repFunc, '^ {0,3}<pre\\\\b[^>]*>\\\\s*<code\\\\b[^>]*>', '^ {0,3}</code>\\\\s*</pre>', 'gim');\n\n  text = globals.converter._dispatch('hashPreCodeTags.after', text, options, globals);\n  return text;\n});\n\r\nshowdown.subParser('headers', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('headers.before', text, options, globals);\n\n  var headerLevelStart = (isNaN(parseInt(options.headerLevelStart))) ? 1 : parseInt(options.headerLevelStart),\n\n      // Set text-style headers:\n      //\tHeader 1\n      //\t========\n      //\n      //\tHeader 2\n      //\t--------\n      //\n      setextRegexH1 = (options.smoothLivePreview) ? /^(.+)[ \\t]*\\n={2,}[ \\t]*\\n+/gm : /^(.+)[ \\t]*\\n=+[ \\t]*\\n+/gm,\n      setextRegexH2 = (options.smoothLivePreview) ? /^(.+)[ \\t]*\\n-{2,}[ \\t]*\\n+/gm : /^(.+)[ \\t]*\\n-+[ \\t]*\\n+/gm;\n\n  text = text.replace(setextRegexH1, function (wholeMatch, m1) {\n\n    var spanGamut = showdown.subParser('spanGamut')(m1, options, globals),\n        hID = (options.noHeaderId) ? '' : ' id=\"' + headerId(m1) + '\"',\n        hLevel = headerLevelStart,\n        hashBlock = '<h' + hLevel + hID + '>' + spanGamut + '</h' + hLevel + '>';\n    return showdown.subParser('hashBlock')(hashBlock, options, globals);\n  });\n\n  text = text.replace(setextRegexH2, function (matchFound, m1) {\n    var spanGamut = showdown.subParser('spanGamut')(m1, options, globals),\n        hID = (options.noHeaderId) ? '' : ' id=\"' + headerId(m1) + '\"',\n        hLevel = headerLevelStart + 1,\n        hashBlock = '<h' + hLevel + hID + '>' + spanGamut + '</h' + hLevel + '>';\n    return showdown.subParser('hashBlock')(hashBlock, options, globals);\n  });\n\n  // atx-style headers:\n  //  # Header 1\n  //  ## Header 2\n  //  ## Header 2 with closing hashes ##\n  //  ...\n  //  ###### Header 6\n  //\n  var atxStyle = (options.requireSpaceBeforeHeadingText) ? /^(#{1,6})[ \\t]+(.+?)[ \\t]*#*\\n+/gm : /^(#{1,6})[ \\t]*(.+?)[ \\t]*#*\\n+/gm;\n\n  text = text.replace(atxStyle, function (wholeMatch, m1, m2) {\n    var hText = m2;\n    if (options.customizedHeaderId) {\n      hText = m2.replace(/\\s?\\{([^{]+?)}\\s*$/, '');\n    }\n\n    var span = showdown.subParser('spanGamut')(hText, options, globals),\n        hID = (options.noHeaderId) ? '' : ' id=\"' + headerId(m2) + '\"',\n        hLevel = headerLevelStart - 1 + m1.length,\n        header = '<h' + hLevel + hID + '>' + span + '</h' + hLevel + '>';\n\n    return showdown.subParser('hashBlock')(header, options, globals);\n  });\n\n  function headerId (m) {\n    var title,\n        prefix;\n\n    // It is separate from other options to allow combining prefix and customized\n    if (options.customizedHeaderId) {\n      var match = m.match(/\\{([^{]+?)}\\s*$/);\n      if (match && match[1]) {\n        m = match[1];\n      }\n    }\n\n    title = m;\n\n    // Prefix id to prevent causing inadvertent pre-existing style matches.\n    if (showdown.helper.isString(options.prefixHeaderId)) {\n      prefix = options.prefixHeaderId;\n    } else if (options.prefixHeaderId === true) {\n      prefix = 'section-';\n    } else {\n      prefix = '';\n    }\n\n    if (!options.rawPrefixHeaderId) {\n      title = prefix + title;\n    }\n\n    if (options.ghCompatibleHeaderId) {\n      title = title\n        .replace(/ /g, '-')\n        // replace previously escaped chars (&, ¨ and $)\n        .replace(/&amp;/g, '')\n        .replace(/¨T/g, '')\n        .replace(/¨D/g, '')\n        // replace rest of the chars (&~$ are repeated as they might have been escaped)\n        // borrowed from github's redcarpet (some they should produce similar results)\n        .replace(/[&+$,\\/:;=?@\"#{}|^¨~\\[\\]`\\\\*)(%.!'<>]/g, '')\n        .toLowerCase();\n    } else if (options.rawHeaderId) {\n      title = title\n        .replace(/ /g, '-')\n        // replace previously escaped chars (&, ¨ and $)\n        .replace(/&amp;/g, '&')\n        .replace(/¨T/g, '¨')\n        .replace(/¨D/g, '$')\n        // replace \" and '\n        .replace(/[\"']/g, '-')\n        .toLowerCase();\n    } else {\n      title = title\n        .replace(/[^\\w]/g, '')\n        .toLowerCase();\n    }\n\n    if (options.rawPrefixHeaderId) {\n      title = prefix + title;\n    }\n\n    if (globals.hashLinkCounts[title]) {\n      title = title + '-' + (globals.hashLinkCounts[title]++);\n    } else {\n      globals.hashLinkCounts[title] = 1;\n    }\n    return title;\n  }\n\n  text = globals.converter._dispatch('headers.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Turn Markdown link shortcuts into XHTML <a> tags.\n */\nshowdown.subParser('horizontalRule', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('horizontalRule.before', text, options, globals);\n\n  var key = showdown.subParser('hashBlock')('<hr />', options, globals);\n  text = text.replace(/^ {0,2}( ?-){3,}[ \\t]*$/gm, key);\n  text = text.replace(/^ {0,2}( ?\\*){3,}[ \\t]*$/gm, key);\n  text = text.replace(/^ {0,2}( ?_){3,}[ \\t]*$/gm, key);\n\n  text = globals.converter._dispatch('horizontalRule.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Turn Markdown image shortcuts into <img> tags.\n */\nshowdown.subParser('images', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('images.before', text, options, globals);\n\n  var inlineRegExp      = /!\\[([^\\]]*?)][ \\t]*()\\([ \\t]?<?([\\S]+?(?:\\([\\S]*?\\)[\\S]*?)?)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*(?:([\"'])([^\"]*?)\\6)?[ \\t]?\\)/g,\n      crazyRegExp       = /!\\[([^\\]]*?)][ \\t]*()\\([ \\t]?<([^>]*)>(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*(?:(?:([\"'])([^\"]*?)\\6))?[ \\t]?\\)/g,\n      base64RegExp      = /!\\[([^\\]]*?)][ \\t]*()\\([ \\t]?<?(data:.+?\\/.+?;base64,[A-Za-z0-9+/=\\n]+?)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*(?:([\"'])([^\"]*?)\\6)?[ \\t]?\\)/g,\n      referenceRegExp   = /!\\[([^\\]]*?)] ?(?:\\n *)?\\[([\\s\\S]*?)]()()()()()/g,\n      refShortcutRegExp = /!\\[([^\\[\\]]+)]()()()()()/g;\n\n  function writeImageTagBase64 (wholeMatch, altText, linkId, url, width, height, m5, title) {\n    url = url.replace(/\\s/g, '');\n    return writeImageTag (wholeMatch, altText, linkId, url, width, height, m5, title);\n  }\n\n  function writeImageTag (wholeMatch, altText, linkId, url, width, height, m5, title) {\n\n    var gUrls   = globals.gUrls,\n        gTitles = globals.gTitles,\n        gDims   = globals.gDimensions;\n\n    linkId = linkId.toLowerCase();\n\n    if (!title) {\n      title = '';\n    }\n    // Special case for explicit empty url\n    if (wholeMatch.search(/\\(<?\\s*>? ?(['\"].*['\"])?\\)$/m) > -1) {\n      url = '';\n\n    } else if (url === '' || url === null) {\n      if (linkId === '' || linkId === null) {\n        // lower-case and turn embedded newlines into spaces\n        linkId = altText.toLowerCase().replace(/ ?\\n/g, ' ');\n      }\n      url = '#' + linkId;\n\n      if (!showdown.helper.isUndefined(gUrls[linkId])) {\n        url = gUrls[linkId];\n        if (!showdown.helper.isUndefined(gTitles[linkId])) {\n          title = gTitles[linkId];\n        }\n        if (!showdown.helper.isUndefined(gDims[linkId])) {\n          width = gDims[linkId].width;\n          height = gDims[linkId].height;\n        }\n      } else {\n        return wholeMatch;\n      }\n    }\n\n    altText = altText\n      .replace(/\"/g, '&quot;')\n    //altText = showdown.helper.escapeCharacters(altText, '*_', false);\n      .replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);\n    //url = showdown.helper.escapeCharacters(url, '*_', false);\n    url = url.replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);\n    var result = '<img src=\"' + url + '\" alt=\"' + altText + '\"';\n\n    if (title && showdown.helper.isString(title)) {\n      title = title\n        .replace(/\"/g, '&quot;')\n      //title = showdown.helper.escapeCharacters(title, '*_', false);\n        .replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);\n      result += ' title=\"' + title + '\"';\n    }\n\n    if (width && height) {\n      width  = (width === '*') ? 'auto' : width;\n      height = (height === '*') ? 'auto' : height;\n\n      result += ' width=\"' + width + '\"';\n      result += ' height=\"' + height + '\"';\n    }\n\n    result += ' />';\n\n    return result;\n  }\n\n  // First, handle reference-style labeled images: ![alt text][id]\n  text = text.replace(referenceRegExp, writeImageTag);\n\n  // Next, handle inline images:  ![alt text](url =<width>x<height> \"optional title\")\n\n  // base64 encoded images\n  text = text.replace(base64RegExp, writeImageTagBase64);\n\n  // cases with crazy urls like ./image/cat1).png\n  text = text.replace(crazyRegExp, writeImageTag);\n\n  // normal cases\n  text = text.replace(inlineRegExp, writeImageTag);\n\n  // handle reference-style shortcuts: ![img text]\n  text = text.replace(refShortcutRegExp, writeImageTag);\n\n  text = globals.converter._dispatch('images.after', text, options, globals);\n  return text;\n});\n\r\nshowdown.subParser('italicsAndBold', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('italicsAndBold.before', text, options, globals);\n\n  // it's faster to have 3 separate regexes for each case than have just one\n  // because of backtracing, in some cases, it could lead to an exponential effect\n  // called \"catastrophic backtrace\". Ominous!\n\n  function parseInside (txt, left, right) {\n    /*\n    if (options.simplifiedAutoLink) {\n      txt = showdown.subParser('simplifiedAutoLinks')(txt, options, globals);\n    }\n    */\n    return left + txt + right;\n  }\n\n  // Parse underscores\n  if (options.literalMidWordUnderscores) {\n    text = text.replace(/\\b___(\\S[\\s\\S]*?)___\\b/g, function (wm, txt) {\n      return parseInside (txt, '<strong><em>', '</em></strong>');\n    });\n    text = text.replace(/\\b__(\\S[\\s\\S]*?)__\\b/g, function (wm, txt) {\n      return parseInside (txt, '<strong>', '</strong>');\n    });\n    text = text.replace(/\\b_(\\S[\\s\\S]*?)_\\b/g, function (wm, txt) {\n      return parseInside (txt, '<em>', '</em>');\n    });\n  } else {\n    text = text.replace(/___(\\S[\\s\\S]*?)___/g, function (wm, m) {\n      return (/\\S$/.test(m)) ? parseInside (m, '<strong><em>', '</em></strong>') : wm;\n    });\n    text = text.replace(/__(\\S[\\s\\S]*?)__/g, function (wm, m) {\n      return (/\\S$/.test(m)) ? parseInside (m, '<strong>', '</strong>') : wm;\n    });\n    text = text.replace(/_([^\\s_][\\s\\S]*?)_/g, function (wm, m) {\n      // !/^_[^_]/.test(m) - test if it doesn't start with __ (since it seems redundant, we removed it)\n      return (/\\S$/.test(m)) ? parseInside (m, '<em>', '</em>') : wm;\n    });\n  }\n\n  // Now parse asterisks\n  if (options.literalMidWordAsterisks) {\n    text = text.replace(/([^*]|^)\\B\\*\\*\\*(\\S[\\s\\S]*?)\\*\\*\\*\\B(?!\\*)/g, function (wm, lead, txt) {\n      return parseInside (txt, lead + '<strong><em>', '</em></strong>');\n    });\n    text = text.replace(/([^*]|^)\\B\\*\\*(\\S[\\s\\S]*?)\\*\\*\\B(?!\\*)/g, function (wm, lead, txt) {\n      return parseInside (txt, lead + '<strong>', '</strong>');\n    });\n    text = text.replace(/([^*]|^)\\B\\*(\\S[\\s\\S]*?)\\*\\B(?!\\*)/g, function (wm, lead, txt) {\n      return parseInside (txt, lead + '<em>', '</em>');\n    });\n  } else {\n    text = text.replace(/\\*\\*\\*(\\S[\\s\\S]*?)\\*\\*\\*/g, function (wm, m) {\n      return (/\\S$/.test(m)) ? parseInside (m, '<strong><em>', '</em></strong>') : wm;\n    });\n    text = text.replace(/\\*\\*(\\S[\\s\\S]*?)\\*\\*/g, function (wm, m) {\n      return (/\\S$/.test(m)) ? parseInside (m, '<strong>', '</strong>') : wm;\n    });\n    text = text.replace(/\\*([^\\s*][\\s\\S]*?)\\*/g, function (wm, m) {\n      // !/^\\*[^*]/.test(m) - test if it doesn't start with ** (since it seems redundant, we removed it)\n      return (/\\S$/.test(m)) ? parseInside (m, '<em>', '</em>') : wm;\n    });\n  }\n\n\n  text = globals.converter._dispatch('italicsAndBold.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Form HTML ordered (numbered) and unordered (bulleted) lists.\n */\nshowdown.subParser('lists', function (text, options, globals) {\n  'use strict';\n\n  /**\n   * Process the contents of a single ordered or unordered list, splitting it\n   * into individual list items.\n   * @param {string} listStr\n   * @param {boolean} trimTrailing\n   * @returns {string}\n   */\n  function processListItems (listStr, trimTrailing) {\n    // The $g_list_level global keeps track of when we're inside a list.\n    // Each time we enter a list, we increment it; when we leave a list,\n    // we decrement. If it's zero, we're not in a list anymore.\n    //\n    // We do this because when we're not inside a list, we want to treat\n    // something like this:\n    //\n    //    I recommend upgrading to version\n    //    8. Oops, now this line is treated\n    //    as a sub-list.\n    //\n    // As a single paragraph, despite the fact that the second line starts\n    // with a digit-period-space sequence.\n    //\n    // Whereas when we're inside a list (or sub-list), that line will be\n    // treated as the start of a sub-list. What a kludge, huh? This is\n    // an aspect of Markdown's syntax that's hard to parse perfectly\n    // without resorting to mind-reading. Perhaps the solution is to\n    // change the syntax rules such that sub-lists must start with a\n    // starting cardinal number; e.g. \"1.\" or \"a.\".\n    globals.gListLevel++;\n\n    // trim trailing blank lines:\n    listStr = listStr.replace(/\\n{2,}$/, '\\n');\n\n    // attacklab: add sentinel to emulate \\z\n    listStr += '¨0';\n\n    var rgx = /(\\n)?(^ {0,3})([*+-]|\\d+[.])[ \\t]+((\\[(x|X| )?])?[ \\t]*[^\\r]+?(\\n{1,2}))(?=\\n*(¨0| {0,3}([*+-]|\\d+[.])[ \\t]+))/gm,\n        isParagraphed = (/\\n[ \\t]*\\n(?!¨0)/.test(listStr));\n\n    // Since version 1.5, nesting sublists requires 4 spaces (or 1 tab) indentation,\n    // which is a syntax breaking change\n    // activating this option reverts to old behavior\n    if (options.disableForced4SpacesIndentedSublists) {\n      rgx = /(\\n)?(^ {0,3})([*+-]|\\d+[.])[ \\t]+((\\[(x|X| )?])?[ \\t]*[^\\r]+?(\\n{1,2}))(?=\\n*(¨0|\\2([*+-]|\\d+[.])[ \\t]+))/gm;\n    }\n\n    listStr = listStr.replace(rgx, function (wholeMatch, m1, m2, m3, m4, taskbtn, checked) {\n      checked = (checked && checked.trim() !== '');\n\n      var item = showdown.subParser('outdent')(m4, options, globals),\n          bulletStyle = '';\n\n      // Support for github tasklists\n      if (taskbtn && options.tasklists) {\n        bulletStyle = ' class=\"task-list-item\" style=\"list-style-type: none;\"';\n        item = item.replace(/^[ \\t]*\\[(x|X| )?]/m, function () {\n          var otp = '<input type=\"checkbox\" disabled style=\"margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;\"';\n          if (checked) {\n            otp += ' checked';\n          }\n          otp += '>';\n          return otp;\n        });\n      }\n\n      // ISSUE #312\n      // This input: - - - a\n      // causes trouble to the parser, since it interprets it as:\n      // <ul><li><li><li>a</li></li></li></ul>\n      // instead of:\n      // <ul><li>- - a</li></ul>\n      // So, to prevent it, we will put a marker (¨A)in the beginning of the line\n      // Kind of hackish/monkey patching, but seems more effective than overcomplicating the list parser\n      item = item.replace(/^([-*+]|\\d\\.)[ \\t]+[\\S\\n ]*/g, function (wm2) {\n        return '¨A' + wm2;\n      });\n\n      // m1 - Leading line or\n      // Has a double return (multi paragraph) or\n      // Has sublist\n      if (m1 || (item.search(/\\n{2,}/) > -1)) {\n        item = showdown.subParser('githubCodeBlocks')(item, options, globals);\n        item = showdown.subParser('blockGamut')(item, options, globals);\n      } else {\n        // Recursion for sub-lists:\n        item = showdown.subParser('lists')(item, options, globals);\n        item = item.replace(/\\n$/, ''); // chomp(item)\n        item = showdown.subParser('hashHTMLBlocks')(item, options, globals);\n\n        // Colapse double linebreaks\n        item = item.replace(/\\n\\n+/g, '\\n\\n');\n        if (isParagraphed) {\n          item = showdown.subParser('paragraphs')(item, options, globals);\n        } else {\n          item = showdown.subParser('spanGamut')(item, options, globals);\n        }\n      }\n\n      // now we need to remove the marker (¨A)\n      item = item.replace('¨A', '');\n      // we can finally wrap the line in list item tags\n      item =  '<li' + bulletStyle + '>' + item + '</li>\\n';\n\n      return item;\n    });\n\n    // attacklab: strip sentinel\n    listStr = listStr.replace(/¨0/g, '');\n\n    globals.gListLevel--;\n\n    if (trimTrailing) {\n      listStr = listStr.replace(/\\s+$/, '');\n    }\n\n    return listStr;\n  }\n\n  function styleStartNumber (list, listType) {\n    // check if ol and starts by a number different than 1\n    if (listType === 'ol') {\n      var res = list.match(/^ *(\\d+)\\./);\n      if (res && res[1] !== '1') {\n        return ' start=\"' + res[1] + '\"';\n      }\n    }\n    return '';\n  }\n\n  /**\n   * Check and parse consecutive lists (better fix for issue #142)\n   * @param {string} list\n   * @param {string} listType\n   * @param {boolean} trimTrailing\n   * @returns {string}\n   */\n  function parseConsecutiveLists (list, listType, trimTrailing) {\n    // check if we caught 2 or more consecutive lists by mistake\n    // we use the counterRgx, meaning if listType is UL we look for OL and vice versa\n    var olRgx = (options.disableForced4SpacesIndentedSublists) ? /^ ?\\d+\\.[ \\t]/gm : /^ {0,3}\\d+\\.[ \\t]/gm,\n        ulRgx = (options.disableForced4SpacesIndentedSublists) ? /^ ?[*+-][ \\t]/gm : /^ {0,3}[*+-][ \\t]/gm,\n        counterRxg = (listType === 'ul') ? olRgx : ulRgx,\n        result = '';\n\n    if (list.search(counterRxg) !== -1) {\n      (function parseCL (txt) {\n        var pos = txt.search(counterRxg),\n            style = styleStartNumber(list, listType);\n        if (pos !== -1) {\n          // slice\n          result += '\\n\\n<' + listType + style + '>\\n' + processListItems(txt.slice(0, pos), !!trimTrailing) + '</' + listType + '>\\n';\n\n          // invert counterType and listType\n          listType = (listType === 'ul') ? 'ol' : 'ul';\n          counterRxg = (listType === 'ul') ? olRgx : ulRgx;\n\n          //recurse\n          parseCL(txt.slice(pos));\n        } else {\n          result += '\\n\\n<' + listType + style + '>\\n' + processListItems(txt, !!trimTrailing) + '</' + listType + '>\\n';\n        }\n      })(list);\n    } else {\n      var style = styleStartNumber(list, listType);\n      result = '\\n\\n<' + listType + style + '>\\n' + processListItems(list, !!trimTrailing) + '</' + listType + '>\\n';\n    }\n\n    return result;\n  }\n\n  /** Start of list parsing **/\n  text = globals.converter._dispatch('lists.before', text, options, globals);\n  // add sentinel to hack around khtml/safari bug:\n  // http://bugs.webkit.org/show_bug.cgi?id=11231\n  text += '¨0';\n\n  if (globals.gListLevel) {\n    text = text.replace(/^(( {0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(¨0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm,\n      function (wholeMatch, list, m2) {\n        var listType = (m2.search(/[*+-]/g) > -1) ? 'ul' : 'ol';\n        return parseConsecutiveLists(list, listType, true);\n      }\n    );\n  } else {\n    text = text.replace(/(\\n\\n|^\\n?)(( {0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(¨0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm,\n      function (wholeMatch, m1, list, m3) {\n        var listType = (m3.search(/[*+-]/g) > -1) ? 'ul' : 'ol';\n        return parseConsecutiveLists(list, listType, false);\n      }\n    );\n  }\n\n  // strip sentinel\n  text = text.replace(/¨0/, '');\n  text = globals.converter._dispatch('lists.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Parse metadata at the top of the document\n */\nshowdown.subParser('metadata', function (text, options, globals) {\n  'use strict';\n\n  if (!options.metadata) {\n    return text;\n  }\n\n  text = globals.converter._dispatch('metadata.before', text, options, globals);\n\n  function parseMetadataContents (content) {\n    // raw is raw so it's not changed in any way\n    globals.metadata.raw = content;\n\n    // escape chars forbidden in html attributes\n    // double quotes\n    content = content\n      // ampersand first\n      .replace(/&/g, '&amp;')\n      // double quotes\n      .replace(/\"/g, '&quot;');\n\n    content = content.replace(/\\n {4}/g, ' ');\n    content.replace(/^([\\S ]+): +([\\s\\S]+?)$/gm, function (wm, key, value) {\n      globals.metadata.parsed[key] = value;\n      return '';\n    });\n  }\n\n  text = text.replace(/^\\s*«««+(\\S*?)\\n([\\s\\S]+?)\\n»»»+\\n/, function (wholematch, format, content) {\n    parseMetadataContents(content);\n    return '¨M';\n  });\n\n  text = text.replace(/^\\s*---+(\\S*?)\\n([\\s\\S]+?)\\n---+\\n/, function (wholematch, format, content) {\n    if (format) {\n      globals.metadata.format = format;\n    }\n    parseMetadataContents(content);\n    return '¨M';\n  });\n\n  text = text.replace(/¨M/g, '');\n\n  text = globals.converter._dispatch('metadata.after', text, options, globals);\n  return text;\n});\n\r\n/**\n * Remove one level of line-leading tabs or spaces\n */\nshowdown.subParser('outdent', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('outdent.before', text, options, globals);\n\n  // attacklab: hack around Konqueror 3.5.4 bug:\n  // \"----------bug\".replace(/^-/g,\"\") == \"bug\"\n  text = text.replace(/^(\\t|[ ]{1,4})/gm, '¨0'); // attacklab: g_tab_width\n\n  // attacklab: clean up hack\n  text = text.replace(/¨0/g, '');\n\n  text = globals.converter._dispatch('outdent.after', text, options, globals);\n  return text;\n});\n\r\n/**\n *\n */\nshowdown.subParser('paragraphs', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('paragraphs.before', text, options, globals);\n  // Strip leading and trailing lines:\n  text = text.replace(/^\\n+/g, '');\n  text = text.replace(/\\n+$/g, '');\n\n  var grafs = text.split(/\\n{2,}/g),\n      grafsOut = [],\n      end = grafs.length; // Wrap <p> tags\n\n  for (var i = 0; i < end; i++) {\n    var str = grafs[i];\n    // if this is an HTML marker, copy it\n    if (str.search(/¨(K|G)(\\d+)\\1/g) >= 0) {\n      grafsOut.push(str);\n\n    // test for presence of characters to prevent empty lines being parsed\n    // as paragraphs (resulting in undesired extra empty paragraphs)\n    } else if (str.search(/\\S/) >= 0) {\n      str = showdown.subParser('spanGamut')(str, options, globals);\n      str = str.replace(/^([ \\t]*)/g, '<p>');\n      str += '</p>';\n      grafsOut.push(str);\n    }\n  }\n\n  /** Unhashify HTML blocks */\n  end = grafsOut.length;\n  for (i = 0; i < end; i++) {\n    var blockText = '',\n        grafsOutIt = grafsOut[i],\n        codeFlag = false;\n    // if this is a marker for an html block...\n    // use RegExp.test instead of string.search because of QML bug\n    while (/¨(K|G)(\\d+)\\1/.test(grafsOutIt)) {\n      var delim = RegExp.$1,\n          num   = RegExp.$2;\n\n      if (delim === 'K') {\n        blockText = globals.gHtmlBlocks[num];\n      } else {\n        // we need to check if ghBlock is a false positive\n        if (codeFlag) {\n          // use encoded version of all text\n          blockText = showdown.subParser('encodeCode')(globals.ghCodeBlocks[num].text, options, globals);\n        } else {\n          blockText = globals.ghCodeBlocks[num].codeblock;\n        }\n      }\n      blockText = blockText.replace(/\\$/g, '$$$$'); // Escape any dollar signs\n\n      grafsOutIt = grafsOutIt.replace(/(\\n\\n)?¨(K|G)\\d+\\2(\\n\\n)?/, blockText);\n      // Check if grafsOutIt is a pre->code\n      if (/^<pre\\b[^>]*>\\s*<code\\b[^>]*>/.test(grafsOutIt)) {\n        codeFlag = true;\n      }\n    }\n    grafsOut[i] = grafsOutIt;\n  }\n  text = grafsOut.join('\\n');\n  // Strip leading and trailing lines:\n  text = text.replace(/^\\n+/g, '');\n  text = text.replace(/\\n+$/g, '');\n  return globals.converter._dispatch('paragraphs.after', text, options, globals);\n});\n\r\n/**\n * Run extension\n */\nshowdown.subParser('runExtension', function (ext, text, options, globals) {\n  'use strict';\n\n  if (ext.filter) {\n    text = ext.filter(text, globals.converter, options);\n\n  } else if (ext.regex) {\n    // TODO remove this when old extension loading mechanism is deprecated\n    var re = ext.regex;\n    if (!(re instanceof RegExp)) {\n      re = new RegExp(re, 'g');\n    }\n    text = text.replace(re, ext.replace);\n  }\n\n  return text;\n});\n\r\n/**\n * These are all the transformations that occur *within* block-level\n * tags like paragraphs, headers, and list items.\n */\nshowdown.subParser('spanGamut', function (text, options, globals) {\n  'use strict';\n\n  text = globals.converter._dispatch('spanGamut.before', text, options, globals);\n  text = showdown.subParser('codeSpans')(text, options, globals);\n  text = showdown.subParser('escapeSpecialCharsWithinTagAttributes')(text, options, globals);\n  text = showdown.subParser('encodeBackslashEscapes')(text, options, globals);\n\n  // Process anchor and image tags. Images must come first,\n  // because ![foo][f] looks like an anchor.\n  text = showdown.subParser('images')(text, options, globals);\n  text = showdown.subParser('anchors')(text, options, globals);\n\n  // Make links out of things like `<http://example.com/>`\n  // Must come after anchors, because you can use < and >\n  // delimiters in inline links like [this](<url>).\n  text = showdown.subParser('autoLinks')(text, options, globals);\n  text = showdown.subParser('simplifiedAutoLinks')(text, options, globals);\n  text = showdown.subParser('emoji')(text, options, globals);\n  text = showdown.subParser('underline')(text, options, globals);\n  text = showdown.subParser('italicsAndBold')(text, options, globals);\n  text = showdown.subParser('strikethrough')(text, options, globals);\n  text = showdown.subParser('ellipsis')(text, options, globals);\n\n  // we need to hash HTML tags inside spans\n  text = showdown.subParser('hashHTMLSpans')(text, options, globals);\n\n  // now we encode amps and angles\n  text = showdown.subParser('encodeAmpsAndAngles')(text, options, globals);\n\n  // Do hard breaks\n  if (options.simpleLineBreaks) {\n    // GFM style hard breaks\n    // only add line breaks if the text does not contain a block (special case for lists)\n    if (!/\\n\\n¨K/.test(text)) {\n      text = text.replace(/\\n+/g, '<br />\\n');\n    }\n  } else {\n    // Vanilla hard breaks\n    text = text.replace(/  +\\n/g, '<br />\\n');\n  }\n\n  text = globals.converter._dispatch('spanGamut.after', text, options, globals);\n  return text;\n});\n\r\nshowdown.subParser('strikethrough', function (text, options, globals) {\n  'use strict';\n\n  function parseInside (txt) {\n    if (options.simplifiedAutoLink) {\n      txt = showdown.subParser('simplifiedAutoLinks')(txt, options, globals);\n    }\n    return '<del>' + txt + '</del>';\n  }\n\n  if (options.strikethrough) {\n    text = globals.converter._dispatch('strikethrough.before', text, options, globals);\n    text = text.replace(/(?:~){2}([\\s\\S]+?)(?:~){2}/g, function (wm, txt) { return parseInside(txt); });\n    text = globals.converter._dispatch('strikethrough.after', text, options, globals);\n  }\n\n  return text;\n});\n\r\n/**\n * Strips link definitions from text, stores the URLs and titles in\n * hash references.\n * Link defs are in the form: ^[id]: url \"optional title\"\n */\nshowdown.subParser('stripLinkDefinitions', function (text, options, globals) {\n  'use strict';\n\n  var regex       = /^ {0,3}\\[([^\\]]+)]:[ \\t]*\\n?[ \\t]*<?([^>\\s]+)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"|'(](.+?)[\"|')][ \\t]*)?(?:\\n+|(?=¨0))/gm,\n      base64Regex = /^ {0,3}\\[([^\\]]+)]:[ \\t]*\\n?[ \\t]*<?(data:.+?\\/.+?;base64,[A-Za-z0-9+/=\\n]+?)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"|'(](.+?)[\"|')][ \\t]*)?(?:\\n\\n|(?=¨0)|(?=\\n\\[))/gm;\n\n  // attacklab: sentinel workarounds for lack of \\A and \\Z, safari\\khtml bug\n  text += '¨0';\n\n  var replaceFunc = function (wholeMatch, linkId, url, width, height, blankLines, title) {\n\n    // if there aren't two instances of linkId it must not be a reference link so back out\n    linkId = linkId.toLowerCase();\n    if (text.toLowerCase().split(linkId).length - 1 < 2) {\n      return wholeMatch;\n    }\n    if (url.match(/^data:.+?\\/.+?;base64,/)) {\n      // remove newlines\n      globals.gUrls[linkId] = url.replace(/\\s/g, '');\n    } else {\n      globals.gUrls[linkId] = showdown.subParser('encodeAmpsAndAngles')(url, options, globals);  // Link IDs are case-insensitive\n    }\n\n    if (blankLines) {\n      // Oops, found blank lines, so it's not a title.\n      // Put back the parenthetical statement we stole.\n      return blankLines + title;\n\n    } else {\n      if (title) {\n        globals.gTitles[linkId] = title.replace(/\"|'/g, '&quot;');\n      }\n      if (options.parseImgDimensions && width && height) {\n        globals.gDimensions[linkId] = {\n          width:  width,\n          height: height\n        };\n      }\n    }\n    // Completely remove the definition from the text\n    return '';\n  };\n\n  // first we try to find base64 link references\n  text = text.replace(base64Regex, replaceFunc);\n\n  text = text.replace(regex, replaceFunc);\n\n  // attacklab: strip sentinel\n  text = text.replace(/¨0/, '');\n\n  return text;\n});\n\r\nshowdown.subParser('tables', function (text, options, globals) {\n  'use strict';\n\n  if (!options.tables) {\n    return text;\n  }\n\n  var tableRgx       = /^ {0,3}\\|?.+\\|.+\\n {0,3}\\|?[ \\t]*:?[ \\t]*(?:[-=]){2,}[ \\t]*:?[ \\t]*\\|[ \\t]*:?[ \\t]*(?:[-=]){2,}[\\s\\S]+?(?:\\n\\n|¨0)/gm,\n      //singeColTblRgx = /^ {0,3}\\|.+\\|\\n {0,3}\\|[ \\t]*:?[ \\t]*(?:[-=]){2,}[ \\t]*:?[ \\t]*\\|[ \\t]*\\n(?: {0,3}\\|.+\\|\\n)+(?:\\n\\n|¨0)/gm;\n      singeColTblRgx = /^ {0,3}\\|.+\\|[ \\t]*\\n {0,3}\\|[ \\t]*:?[ \\t]*(?:[-=]){2,}[ \\t]*:?[ \\t]*\\|[ \\t]*\\n( {0,3}\\|.+\\|[ \\t]*\\n)*(?:\\n|¨0)/gm;\n\n  function parseStyles (sLine) {\n    if (/^:[ \\t]*--*$/.test(sLine)) {\n      return ' style=\"text-align:left;\"';\n    } else if (/^--*[ \\t]*:[ \\t]*$/.test(sLine)) {\n      return ' style=\"text-align:right;\"';\n    } else if (/^:[ \\t]*--*[ \\t]*:$/.test(sLine)) {\n      return ' style=\"text-align:center;\"';\n    } else {\n      return '';\n    }\n  }\n\n  function parseHeaders (header, style) {\n    var id = '';\n    header = header.trim();\n    // support both tablesHeaderId and tableHeaderId due to error in documentation so we don't break backwards compatibility\n    if (options.tablesHeaderId || options.tableHeaderId) {\n      id = ' id=\"' + header.replace(/ /g, '_').toLowerCase() + '\"';\n    }\n    header = showdown.subParser('spanGamut')(header, options, globals);\n\n    return '<th' + id + style + '>' + header + '</th>\\n';\n  }\n\n  function parseCells (cell, style) {\n    var subText = showdown.subParser('spanGamut')(cell, options, globals);\n    return '<td' + style + '>' + subText + '</td>\\n';\n  }\n\n  function buildTable (headers, cells) {\n    var tb = '<table>\\n<thead>\\n<tr>\\n',\n        tblLgn = headers.length;\n\n    for (var i = 0; i < tblLgn; ++i) {\n      tb += headers[i];\n    }\n    tb += '</tr>\\n</thead>\\n<tbody>\\n';\n\n    for (i = 0; i < cells.length; ++i) {\n      tb += '<tr>\\n';\n      for (var ii = 0; ii < tblLgn; ++ii) {\n        tb += cells[i][ii];\n      }\n      tb += '</tr>\\n';\n    }\n    tb += '</tbody>\\n</table>\\n';\n    return tb;\n  }\n\n  function parseTable (rawTable) {\n    var i, tableLines = rawTable.split('\\n');\n\n    for (i = 0; i < tableLines.length; ++i) {\n      // strip wrong first and last column if wrapped tables are used\n      if (/^ {0,3}\\|/.test(tableLines[i])) {\n        tableLines[i] = tableLines[i].replace(/^ {0,3}\\|/, '');\n      }\n      if (/\\|[ \\t]*$/.test(tableLines[i])) {\n        tableLines[i] = tableLines[i].replace(/\\|[ \\t]*$/, '');\n      }\n      // parse code spans first, but we only support one line code spans\n      tableLines[i] = showdown.subParser('codeSpans')(tableLines[i], options, globals);\n    }\n\n    var rawHeaders = tableLines[0].split('|').map(function (s) { return s.trim();}),\n        rawStyles = tableLines[1].split('|').map(function (s) { return s.trim();}),\n        rawCells = [],\n        headers = [],\n        styles = [],\n        cells = [];\n\n    tableLines.shift();\n    tableLines.shift();\n\n    for (i = 0; i < tableLines.length; ++i) {\n      if (tableLines[i].trim() === '') {\n        continue;\n      }\n      rawCells.push(\n        tableLines[i]\n          .split('|')\n          .map(function (s) {\n            return s.trim();\n          })\n      );\n    }\n\n    if (rawHeaders.length < rawStyles.length) {\n      return rawTable;\n    }\n\n    for (i = 0; i < rawStyles.length; ++i) {\n      styles.push(parseStyles(rawStyles[i]));\n    }\n\n    for (i = 0; i < rawHeaders.length; ++i) {\n      if (showdown.helper.isUndefined(styles[i])) {\n        styles[i] = '';\n      }\n      headers.push(parseHeaders(rawHeaders[i], styles[i]));\n    }\n\n    for (i = 0; i < rawCells.length; ++i) {\n      var row = [];\n      for (var ii = 0; ii < headers.length; ++ii) {\n        if (showdown.helper.isUndefined(rawCells[i][ii])) {\n\n        }\n        row.push(parseCells(rawCells[i][ii], styles[ii]));\n      }\n      cells.push(row);\n    }\n\n    return buildTable(headers, cells);\n  }\n\n  text = globals.converter._dispatch('tables.before', text, options, globals);\n\n  // find escaped pipe characters\n  text = text.replace(/\\\\(\\|)/g, showdown.helper.escapeCharactersCallback);\n\n  // parse multi column tables\n  text = text.replace(tableRgx, parseTable);\n\n  // parse one column tables\n  text = text.replace(singeColTblRgx, parseTable);\n\n  text = globals.converter._dispatch('tables.after', text, options, globals);\n\n  return text;\n});\n\r\nshowdown.subParser('underline', function (text, options, globals) {\n  'use strict';\n\n  if (!options.underline) {\n    return text;\n  }\n\n  text = globals.converter._dispatch('underline.before', text, options, globals);\n\n  if (options.literalMidWordUnderscores) {\n    text = text.replace(/\\b___(\\S[\\s\\S]*?)___\\b/g, function (wm, txt) {\n      return '<u>' + txt + '</u>';\n    });\n    text = text.replace(/\\b__(\\S[\\s\\S]*?)__\\b/g, function (wm, txt) {\n      return '<u>' + txt + '</u>';\n    });\n  } else {\n    text = text.replace(/___(\\S[\\s\\S]*?)___/g, function (wm, m) {\n      return (/\\S$/.test(m)) ? '<u>' + m + '</u>' : wm;\n    });\n    text = text.replace(/__(\\S[\\s\\S]*?)__/g, function (wm, m) {\n      return (/\\S$/.test(m)) ? '<u>' + m + '</u>' : wm;\n    });\n  }\n\n  // escape remaining underscores to prevent them being parsed by italic and bold\n  text = text.replace(/(_)/g, showdown.helper.escapeCharactersCallback);\n\n  text = globals.converter._dispatch('underline.after', text, options, globals);\n\n  return text;\n});\n\r\n/**\n * Swap back in all the special characters we've hidden.\n */\nshowdown.subParser('unescapeSpecialChars', function (text, options, globals) {\n  'use strict';\n  text = globals.converter._dispatch('unescapeSpecialChars.before', text, options, globals);\n\n  text = text.replace(/¨E(\\d+)E/g, function (wholeMatch, m1) {\n    var charCodeToReplace = parseInt(m1);\n    return String.fromCharCode(charCodeToReplace);\n  });\n\n  text = globals.converter._dispatch('unescapeSpecialChars.after', text, options, globals);\n  return text;\n});\n\r\nshowdown.subParser('makeMarkdown.blockquote', function (node, globals) {\n  'use strict';\n\n  var txt = '';\n  if (node.hasChildNodes()) {\n    var children = node.childNodes,\n        childrenLength = children.length;\n\n    for (var i = 0; i < childrenLength; ++i) {\n      var innerTxt = showdown.subParser('makeMarkdown.node')(children[i], globals);\n\n      if (innerTxt === '') {\n        continue;\n      }\n      txt += innerTxt;\n    }\n  }\n  // cleanup\n  txt = txt.trim();\n  txt = '> ' + txt.split('\\n').join('\\n> ');\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.codeBlock', function (node, globals) {\n  'use strict';\n\n  var lang = node.getAttribute('language'),\n      num  = node.getAttribute('precodenum');\n  return '```' + lang + '\\n' + globals.preList[num] + '\\n```';\n});\n\r\nshowdown.subParser('makeMarkdown.codeSpan', function (node) {\n  'use strict';\n\n  return '`' + node.innerHTML + '`';\n});\n\r\nshowdown.subParser('makeMarkdown.emphasis', function (node, globals) {\n  'use strict';\n\n  var txt = '';\n  if (node.hasChildNodes()) {\n    txt += '*';\n    var children = node.childNodes,\n        childrenLength = children.length;\n    for (var i = 0; i < childrenLength; ++i) {\n      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);\n    }\n    txt += '*';\n  }\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.header', function (node, globals, headerLevel) {\n  'use strict';\n\n  var headerMark = new Array(headerLevel + 1).join('#'),\n      txt = '';\n\n  if (node.hasChildNodes()) {\n    txt = headerMark + ' ';\n    var children = node.childNodes,\n        childrenLength = children.length;\n\n    for (var i = 0; i < childrenLength; ++i) {\n      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);\n    }\n  }\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.hr', function () {\n  'use strict';\n\n  return '---';\n});\n\r\nshowdown.subParser('makeMarkdown.image', function (node) {\n  'use strict';\n\n  var txt = '';\n  if (node.hasAttribute('src')) {\n    txt += '![' + node.getAttribute('alt') + '](';\n    txt += '<' + node.getAttribute('src') + '>';\n    if (node.hasAttribute('width') && node.hasAttribute('height')) {\n      txt += ' =' + node.getAttribute('width') + 'x' + node.getAttribute('height');\n    }\n\n    if (node.hasAttribute('title')) {\n      txt += ' \"' + node.getAttribute('title') + '\"';\n    }\n    txt += ')';\n  }\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.links', function (node, globals) {\n  'use strict';\n\n  var txt = '';\n  if (node.hasChildNodes() && node.hasAttribute('href')) {\n    var children = node.childNodes,\n        childrenLength = children.length;\n    txt = '[';\n    for (var i = 0; i < childrenLength; ++i) {\n      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);\n    }\n    txt += '](';\n    txt += '<' + node.getAttribute('href') + '>';\n    if (node.hasAttribute('title')) {\n      txt += ' \"' + node.getAttribute('title') + '\"';\n    }\n    txt += ')';\n  }\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.list', function (node, globals, type) {\n  'use strict';\n\n  var txt = '';\n  if (!node.hasChildNodes()) {\n    return '';\n  }\n  var listItems       = node.childNodes,\n      listItemsLenght = listItems.length,\n      listNum = node.getAttribute('start') || 1;\n\n  for (var i = 0; i < listItemsLenght; ++i) {\n    if (typeof listItems[i].tagName === 'undefined' || listItems[i].tagName.toLowerCase() !== 'li') {\n      continue;\n    }\n\n    // define the bullet to use in list\n    var bullet = '';\n    if (type === 'ol') {\n      bullet = listNum.toString() + '. ';\n    } else {\n      bullet = '- ';\n    }\n\n    // parse list item\n    txt += bullet + showdown.subParser('makeMarkdown.listItem')(listItems[i], globals);\n    ++listNum;\n  }\n\n  // add comment at the end to prevent consecutive lists to be parsed as one\n  txt += '\\n<!-- -->\\n';\n  return txt.trim();\n});\n\r\nshowdown.subParser('makeMarkdown.listItem', function (node, globals) {\n  'use strict';\n\n  var listItemTxt = '';\n\n  var children = node.childNodes,\n      childrenLenght = children.length;\n\n  for (var i = 0; i < childrenLenght; ++i) {\n    listItemTxt += showdown.subParser('makeMarkdown.node')(children[i], globals);\n  }\n  // if it's only one liner, we need to add a newline at the end\n  if (!/\\n$/.test(listItemTxt)) {\n    listItemTxt += '\\n';\n  } else {\n    // it's multiparagraph, so we need to indent\n    listItemTxt = listItemTxt\n      .split('\\n')\n      .join('\\n    ')\n      .replace(/^ {4}$/gm, '')\n      .replace(/\\n\\n+/g, '\\n\\n');\n  }\n\n  return listItemTxt;\n});\n\r\n\n\nshowdown.subParser('makeMarkdown.node', function (node, globals, spansOnly) {\n  'use strict';\n\n  spansOnly = spansOnly || false;\n\n  var txt = '';\n\n  // edge case of text without wrapper paragraph\n  if (node.nodeType === 3) {\n    return showdown.subParser('makeMarkdown.txt')(node, globals);\n  }\n\n  // HTML comment\n  if (node.nodeType === 8) {\n    return '<!--' + node.data + '-->\\n\\n';\n  }\n\n  // process only node elements\n  if (node.nodeType !== 1) {\n    return '';\n  }\n\n  var tagName = node.tagName.toLowerCase();\n\n  switch (tagName) {\n\n    //\n    // BLOCKS\n    //\n    case 'h1':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 1) + '\\n\\n'; }\n      break;\n    case 'h2':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 2) + '\\n\\n'; }\n      break;\n    case 'h3':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 3) + '\\n\\n'; }\n      break;\n    case 'h4':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 4) + '\\n\\n'; }\n      break;\n    case 'h5':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 5) + '\\n\\n'; }\n      break;\n    case 'h6':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 6) + '\\n\\n'; }\n      break;\n\n    case 'p':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.paragraph')(node, globals) + '\\n\\n'; }\n      break;\n\n    case 'blockquote':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.blockquote')(node, globals) + '\\n\\n'; }\n      break;\n\n    case 'hr':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.hr')(node, globals) + '\\n\\n'; }\n      break;\n\n    case 'ol':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.list')(node, globals, 'ol') + '\\n\\n'; }\n      break;\n\n    case 'ul':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.list')(node, globals, 'ul') + '\\n\\n'; }\n      break;\n\n    case 'precode':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.codeBlock')(node, globals) + '\\n\\n'; }\n      break;\n\n    case 'pre':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.pre')(node, globals) + '\\n\\n'; }\n      break;\n\n    case 'table':\n      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.table')(node, globals) + '\\n\\n'; }\n      break;\n\n    //\n    // SPANS\n    //\n    case 'code':\n      txt = showdown.subParser('makeMarkdown.codeSpan')(node, globals);\n      break;\n\n    case 'em':\n    case 'i':\n      txt = showdown.subParser('makeMarkdown.emphasis')(node, globals);\n      break;\n\n    case 'strong':\n    case 'b':\n      txt = showdown.subParser('makeMarkdown.strong')(node, globals);\n      break;\n\n    case 'del':\n      txt = showdown.subParser('makeMarkdown.strikethrough')(node, globals);\n      break;\n\n    case 'a':\n      txt = showdown.subParser('makeMarkdown.links')(node, globals);\n      break;\n\n    case 'img':\n      txt = showdown.subParser('makeMarkdown.image')(node, globals);\n      break;\n\n    default:\n      txt = node.outerHTML + '\\n\\n';\n  }\n\n  // common normalization\n  // TODO eventually\n\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.paragraph', function (node, globals) {\n  'use strict';\n\n  var txt = '';\n  if (node.hasChildNodes()) {\n    var children = node.childNodes,\n        childrenLength = children.length;\n    for (var i = 0; i < childrenLength; ++i) {\n      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);\n    }\n  }\n\n  // some text normalization\n  txt = txt.trim();\n\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.pre', function (node, globals) {\n  'use strict';\n\n  var num  = node.getAttribute('prenum');\n  return '<pre>' + globals.preList[num] + '</pre>';\n});\n\r\nshowdown.subParser('makeMarkdown.strikethrough', function (node, globals) {\n  'use strict';\n\n  var txt = '';\n  if (node.hasChildNodes()) {\n    txt += '~~';\n    var children = node.childNodes,\n        childrenLength = children.length;\n    for (var i = 0; i < childrenLength; ++i) {\n      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);\n    }\n    txt += '~~';\n  }\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.strong', function (node, globals) {\n  'use strict';\n\n  var txt = '';\n  if (node.hasChildNodes()) {\n    txt += '**';\n    var children = node.childNodes,\n        childrenLength = children.length;\n    for (var i = 0; i < childrenLength; ++i) {\n      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);\n    }\n    txt += '**';\n  }\n  return txt;\n});\n\r\nshowdown.subParser('makeMarkdown.table', function (node, globals) {\n  'use strict';\n\n  var txt = '',\n      tableArray = [[], []],\n      headings   = node.querySelectorAll('thead>tr>th'),\n      rows       = node.querySelectorAll('tbody>tr'),\n      i, ii;\n  for (i = 0; i < headings.length; ++i) {\n    var headContent = showdown.subParser('makeMarkdown.tableCell')(headings[i], globals),\n        allign = '---';\n\n    if (headings[i].hasAttribute('style')) {\n      var style = headings[i].getAttribute('style').toLowerCase().replace(/\\s/g, '');\n      switch (style) {\n        case 'text-align:left;':\n          allign = ':---';\n          break;\n        case 'text-align:right;':\n          allign = '---:';\n          break;\n        case 'text-align:center;':\n          allign = ':---:';\n          break;\n      }\n    }\n    tableArray[0][i] = headContent.trim();\n    tableArray[1][i] = allign;\n  }\n\n  for (i = 0; i < rows.length; ++i) {\n    var r = tableArray.push([]) - 1,\n        cols = rows[i].getElementsByTagName('td');\n\n    for (ii = 0; ii < headings.length; ++ii) {\n      var cellContent = ' ';\n      if (typeof cols[ii] !== 'undefined') {\n        cellContent = showdown.subParser('makeMarkdown.tableCell')(cols[ii], globals);\n      }\n      tableArray[r].push(cellContent);\n    }\n  }\n\n  var cellSpacesCount = 3;\n  for (i = 0; i < tableArray.length; ++i) {\n    for (ii = 0; ii < tableArray[i].length; ++ii) {\n      var strLen = tableArray[i][ii].length;\n      if (strLen > cellSpacesCount) {\n        cellSpacesCount = strLen;\n      }\n    }\n  }\n\n  for (i = 0; i < tableArray.length; ++i) {\n    for (ii = 0; ii < tableArray[i].length; ++ii) {\n      if (i === 1) {\n        if (tableArray[i][ii].slice(-1) === ':') {\n          tableArray[i][ii] = showdown.helper.padEnd(tableArray[i][ii].slice(-1), cellSpacesCount - 1, '-') + ':';\n        } else {\n          tableArray[i][ii] = showdown.helper.padEnd(tableArray[i][ii], cellSpacesCount, '-');\n        }\n      } else {\n        tableArray[i][ii] = showdown.helper.padEnd(tableArray[i][ii], cellSpacesCount);\n      }\n    }\n    txt += '| ' + tableArray[i].join(' | ') + ' |\\n';\n  }\n\n  return txt.trim();\n});\n\r\nshowdown.subParser('makeMarkdown.tableCell', function (node, globals) {\n  'use strict';\n\n  var txt = '';\n  if (!node.hasChildNodes()) {\n    return '';\n  }\n  var children = node.childNodes,\n      childrenLength = children.length;\n\n  for (var i = 0; i < childrenLength; ++i) {\n    txt += showdown.subParser('makeMarkdown.node')(children[i], globals, true);\n  }\n  return txt.trim();\n});\n\r\nshowdown.subParser('makeMarkdown.txt', function (node) {\n  'use strict';\n\n  var txt = node.nodeValue;\n\n  // multiple spaces are collapsed\n  txt = txt.replace(/ +/g, ' ');\n\n  // replace the custom ¨NBSP; with a space\n  txt = txt.replace(/¨NBSP;/g, ' ');\n\n  // \", <, > and & should replace escaped html entities\n  txt = showdown.helper.unescapeHTMLEntities(txt);\n\n  // escape markdown magic characters\n  // emphasis, strong and strikethrough - can appear everywhere\n  // we also escape pipe (|) because of tables\n  // and escape ` because of code blocks and spans\n  txt = txt.replace(/([*_~|`])/g, '\\\\$1');\n\n  // escape > because of blockquotes\n  txt = txt.replace(/^(\\s*)>/g, '\\\\$1>');\n\n  // hash character, only troublesome at the beginning of a line because of headers\n  txt = txt.replace(/^#/gm, '\\\\#');\n\n  // horizontal rules\n  txt = txt.replace(/^(\\s*)([-=]{3,})(\\s*)$/, '$1\\\\$2$3');\n\n  // dot, because of ordered lists, only troublesome at the beginning of a line when preceded by an integer\n  txt = txt.replace(/^( {0,3}\\d+)\\./gm, '$1\\\\.');\n\n  // +, * and -, at the beginning of a line becomes a list, so we need to escape them also (asterisk was already escaped)\n  txt = txt.replace(/^( {0,3})([+-])/gm, '$1\\\\$2');\n\n  // images and links, ] followed by ( is problematic, so we escape it\n  txt = txt.replace(/]([\\s]*)\\(/g, '\\\\]$1\\\\(');\n\n  // reference URIs must also be escaped\n  txt = txt.replace(/^ {0,3}\\[([\\S \\t]*?)]:/gm, '\\\\[$1]:');\n\n  return txt;\n});\n\r\nvar root = this;\n\n// AMD Loader\nif (typeof define === 'function' && define.amd) {\n  define(function () {\n    'use strict';\n    return showdown;\n  });\n\n// CommonJS/nodeJS Loader\n} else if (typeof module !== 'undefined' && module.exports) {\n  module.exports = showdown;\n\n// Regular Browser loader\n} else {\n  root.showdown = showdown;\n}\n}).call(this);\r\n\n//# sourceMappingURL=showdown.js.map\r\n","import createDOMPurify from 'dompurify';\nimport escapeHtml from 'escape-html';\nimport katex from 'katex';\nimport showdown from 'showdown';\n\nconst DOMPurify = createDOMPurify(window);\n\n// Ensure that any links generated either by Showdown or in the markdown/HTML\n// passed to Showdown open in an external window.\nDOMPurify.addHook('afterSanitizeAttributes', node => {\n  if ('target' in node) {\n    node.setAttribute('target', '_blank');\n  }\n});\n\nfunction targetBlank() {\n  function filter(text: string) {\n    return text.replace(/<a href=/g, '<a target=\"_blank\" href=');\n  }\n  return [{ type: 'output', filter }];\n}\n\nlet converter: showdown.Converter;\n\nfunction renderMarkdown(markdown: string) {\n  if (!converter) {\n    // see https://github.com/showdownjs/showdown#valid-options\n    converter = new showdown.Converter({\n      extensions: [targetBlank],\n      simplifiedAutoLink: true,\n      excludeTrailingPunctuationFromURLs: true,\n      // Since we're using simplifiedAutoLink we also use\n      // literalMidWordUnderscores because otherwise _'s in URLs get\n      // transformed into <em>'s.\n      // See https://github.com/showdownjs/showdown/issues/211\n      literalMidWordUnderscores: true,\n      // Enable strikethrough, which is disabled by default\n      strikethrough: true,\n    });\n  }\n  return converter.makeHtml(markdown);\n}\n\nfunction mathPlaceholder(id: number) {\n  return '{math:' + id.toString() + '}';\n}\n\ntype MathBlock = {\n  id: number;\n  inline: boolean;\n  expression: string;\n};\n\n/**\n * Parses a string containing mixed markdown and LaTeX in between\n * '$$..$$' or '\\( ... \\)' delimiters and returns an object containing a\n * list of math blocks found in the string, plus the input string with math\n * blocks replaced by placeholders.\n */\nfunction extractMath(content: string): {\n  content: string;\n  mathBlocks: MathBlock[];\n} {\n  const mathBlocks: MathBlock[] = [];\n  let pos = 0;\n  let replacedContent = content;\n\n  while (true) {\n    const blockMathStart = replacedContent.indexOf('$$', pos);\n    const inlineMathStart = replacedContent.indexOf('\\\\(', pos);\n\n    if (blockMathStart === -1 && inlineMathStart === -1) {\n      break;\n    }\n\n    let mathStart;\n    let mathEnd;\n    if (\n      blockMathStart !== -1 &&\n      (inlineMathStart === -1 || blockMathStart < inlineMathStart)\n    ) {\n      mathStart = blockMathStart;\n      mathEnd = replacedContent.indexOf('$$', mathStart + 2);\n    } else {\n      mathStart = inlineMathStart;\n      mathEnd = replacedContent.indexOf('\\\\)', mathStart + 2);\n    }\n\n    if (mathEnd === -1) {\n      break;\n    } else {\n      mathEnd = mathEnd + 2;\n    }\n\n    const id = mathBlocks.length + 1;\n    const placeholder = mathPlaceholder(id);\n    mathBlocks.push({\n      id,\n      expression: replacedContent.slice(mathStart + 2, mathEnd - 2),\n      inline: inlineMathStart !== -1,\n    });\n\n    let replacement;\n    if (inlineMathStart !== -1) {\n      replacement = placeholder;\n    } else {\n      // Add new lines before and after math blocks so that they render\n      // as separate paragraphs\n      replacement = '\\n\\n' + placeholder + '\\n\\n';\n    }\n\n    replacedContent =\n      replacedContent.slice(0, mathStart) +\n      replacement +\n      replacedContent.slice(mathEnd);\n    pos = mathStart + replacement.length;\n  }\n\n  return {\n    mathBlocks,\n    content: replacedContent,\n  };\n}\n\nfunction insertMath(html: string, mathBlocks: MathBlock[]) {\n  return mathBlocks.reduce((html, block) => {\n    let renderedMath;\n    try {\n      if (block.inline) {\n        renderedMath = katex.renderToString(block.expression);\n      } else {\n        renderedMath = katex.renderToString(block.expression, {\n          displayMode: true,\n        });\n      }\n    } catch {\n      renderedMath = escapeHtml(block.expression);\n    }\n    return html.replace(mathPlaceholder(block.id), renderedMath);\n  }, html);\n}\n\n/**\n * Convert a string of markdown and math into sanitized HTML.\n *\n * Math expressions in the input are written as LaTeX and must be enclosed in\n * `$$ .. $$` or `\\( .. \\)` delimiters to indicate block or inline math\n * expressions. These expressions are extracted and rendered using KaTeX.\n *\n * @return - A string of sanitized HTML.\n */\nexport function renderMathAndMarkdown(markdown: string): string {\n  // KaTeX takes care of escaping its input, so we want to avoid passing its\n  // output through the HTML sanitizer. Therefore we first extract the math\n  // blocks from the input, render and sanitize the remaining markdown and then\n  // render and re-insert the math blocks back into the output.\n  const mathInfo = extractMath(markdown);\n  const markdownHTML = DOMPurify.sanitize(renderMarkdown(mathInfo.content));\n  const mathAndMarkdownHTML = insertMath(markdownHTML, mathInfo.mathBlocks);\n  return mathAndMarkdownHTML;\n}\n","import classnames from 'classnames';\nimport type { ComponentChildren, JSX } from 'preact';\n\nexport type StyledTextProps = JSX.HTMLAttributes<HTMLDivElement> & {\n  children: ComponentChildren;\n  classes?: string;\n};\n\n/**\n * Render children as styled text: basic prose styling for HTML\n */\nexport default function StyledText({\n  children,\n  classes,\n  ...restProps\n}: StyledTextProps) {\n  // The language for the quote may be different than the client's UI (set by\n  // `<html lang=\"...\">`).\n  //\n  // Use a blank string to indicate that it is unknown and it is up to the user\n  // agent to pick a default or analyze the content and guess.\n  //\n  // For web documents we could do better here and gather language information\n  // as part of the annotation anchoring process.\n  const documentLanguage = '';\n\n  return (\n    <div\n      dir=\"auto\"\n      lang={documentLanguage}\n      className={classnames('StyledText', classes)}\n      {...restProps}\n    >\n      {children}\n    </div>\n  );\n}\n","import { formatDateTime, InfoIcon, Link } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nimport type { Mention } from '../../../types/api';\nimport type {\n  InvalidMentionContent,\n  MentionMode,\n} from '../../helpers/mentions';\n\nexport type MentionPopoverContent = {\n  content: Mention | InvalidMentionContent;\n  mentionMode: MentionMode;\n};\n\n/**\n * Information to display in a Popover when hovering over a processed mention.\n */\nexport default function MentionPopoverContent({\n  content,\n  mentionMode,\n}: MentionPopoverContent) {\n  const isUsernameMode = mentionMode === 'username';\n\n  return (\n    <>\n      <div className=\"px-3 py-2\">\n        {typeof content === 'string' ? (\n          <div data-testid=\"user-not-found\">\n            No user with username <span className=\"font-bold\">{content}</span>{' '}\n            exists\n          </div>\n        ) : (\n          <div className=\"flex flex-col gap-y-4\">\n            <div className=\"flex flex-col gap-y-1.5\">\n              {isUsernameMode && (\n                <div data-testid=\"username\" className=\"text-md font-bold\">\n                  @{content.username}\n                </div>\n              )}\n              {content.display_name && (\n                <div\n                  data-testid=\"display-name\"\n                  className={classnames({\n                    'text-color-text-light': isUsernameMode,\n                    'text-md font-bold': !isUsernameMode,\n                  })}\n                >\n                  {content.display_name}\n                </div>\n              )}\n            </div>\n            {content.description && (\n              <div data-testid=\"description\" className=\"line-clamp-2\">\n                {content.description}\n              </div>\n            )}\n            {content.joined && (\n              <div data-testid=\"joined\" className=\"text-color-text-light\">\n                Joined{' '}\n                <b>{formatDateTime(content.joined, { includeTime: false })}</b>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      <div className=\"px-3 py-2 border-t\">\n        <Link\n          variant=\"text-light\"\n          classes=\"flex gap-x-1 items-center\"\n          target=\"_blank\"\n          href={\n            isUsernameMode\n              ? 'https://web.hypothes.is/help/mentions-for-the-hypothesis-web-app/'\n              : 'https://web.hypothes.is/help/mentions-for-the-hypothesis-lms-app/'\n          }\n          data-testid=\"kb-article-link\"\n        >\n          <InfoIcon className=\"w-3 h-3\" /> Learn more about @mentions\n        </Link>\n      </div>\n    </>\n  );\n}\n","import { Popover } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'preact/hooks';\n\nimport type { Mention } from '../../types/api';\nimport type { InvalidMentionContent, MentionMode } from '../helpers/mentions';\nimport { processAndReplaceMentionElements } from '../helpers/mentions';\nimport { replaceLinksWithEmbeds } from '../media-embedder';\nimport { renderMathAndMarkdown } from '../render-markdown';\nimport StyledText from './StyledText';\nimport MentionPopoverContent from './mentions/MentionPopoverContent';\n\n/** Return true if the point (x, y) lies within `rect`. */\nfunction rectContainsPoint(rect: DOMRect, x: number, y: number): boolean {\n  return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n}\n\n/**\n * Return the smallest rect that entirely contains `rect` and has integer\n * coordinates.\n */\nfunction roundRectCoords(rect: DOMRect): DOMRect {\n  const left = Math.floor(rect.x);\n  const top = Math.floor(rect.y);\n  const right = Math.ceil(rect.right);\n  const bottom = Math.ceil(rect.bottom);\n  return new DOMRect(left, top, right - left, bottom - top);\n}\n\n/** Return the smallest rect which contains both `a` and `b`. */\nfunction unionRect(a: DOMRect, b: DOMRect): DOMRect {\n  const left = Math.min(a.x, b.x);\n  const top = Math.min(a.y, b.y);\n  const right = Math.max(a.right, b.right);\n  const bottom = Math.max(a.bottom, b.bottom);\n\n  return DOMRect.fromRect({\n    x: left,\n    y: top,\n    width: right - left,\n    height: bottom - top,\n  });\n}\n\nexport type MarkdownViewProps = {\n  /** The string of markdown to display as HTML. */\n  markdown: string;\n  classes?: string;\n  style?: Record<string, string>;\n  mentions?: Mention[];\n  mentionMode: MentionMode;\n\n  /**\n   * Whether the at-mentions feature ir enabled or not.\n   * Defaults to false.\n   */\n  mentionsEnabled?: boolean;\n\n  // Test seams\n  setTimeout_?: typeof setTimeout;\n  clearTimeout_?: typeof clearTimeout;\n};\n\ntype PopoverContent = Mention | InvalidMentionContent | null;\n\n/**\n * A component which renders markdown as HTML, replaces recognized links with\n * embedded video/audio and processes mention tags.\n */\nexport default function MarkdownView(props: MarkdownViewProps) {\n  /* istanbul ignore next - Unpack here to ignore default values for test seams */\n  const {\n    markdown,\n    classes,\n    style,\n    mentions = [],\n    mentionsEnabled = false,\n    mentionMode,\n    setTimeout_ = setTimeout,\n    clearTimeout_ = clearTimeout,\n  } = props;\n  const html = useMemo(\n    () => (markdown ? renderMathAndMarkdown(markdown) : ''),\n    [markdown],\n  );\n  const content = useRef<HTMLDivElement | null>(null);\n\n  const mentionsPopoverAnchorRef = useRef<HTMLElement | null>(null);\n  const mentionsPopoverRef = useRef<HTMLElement>(null);\n\n  const elementToMentionMap = useRef(\n    new Map<HTMLElement, Mention | InvalidMentionContent>(),\n  );\n  const [popoverContent, setPopoverContent] = useState<PopoverContent>(null);\n  const popoverContentTimeout = useRef<ReturnType<typeof setTimeout> | null>();\n  const setPopoverContentAfterDelay = useCallback(\n    // This allows the content to be set with a small delay, so that popovers\n    // don't flicker simply by hovering an annotation with mentions\n    (content: PopoverContent) => {\n      if (popoverContentTimeout.current) {\n        clearTimeout_(popoverContentTimeout.current);\n      }\n\n      const setContent = () => {\n        setPopoverContent(content);\n        popoverContentTimeout.current = null;\n      };\n\n      // Set the content immediately when resetting, so that there's no delay\n      // when hiding the popover, only when showing it\n      if (content === null) {\n        setContent();\n      } else {\n        popoverContentTimeout.current = setTimeout_(setContent, 400);\n      }\n    },\n    [clearTimeout_, setTimeout_],\n  );\n\n  useEffect(() => {\n    // Clear any potentially in-progress popover timeout when this component is\n    // unmounted\n    return () => {\n      if (popoverContentTimeout.current) {\n        clearTimeout_(popoverContentTimeout.current);\n      }\n    };\n  }, [clearTimeout_]);\n\n  useEffect(() => {\n    replaceLinksWithEmbeds(content.current!, {\n      // Make embeds the full width of the sidebar, unless the sidebar has been\n      // made wider than the `md` breakpoint. In that case, restrict width\n      // to 380px.\n      className: 'w-full md:w-[380px]',\n    });\n  }, [markdown]);\n\n  useEffect(() => {\n    elementToMentionMap.current = processAndReplaceMentionElements(\n      content.current!,\n      mentions,\n      mentionMode,\n    );\n  }, [mentionMode, mentions]);\n\n  // Monitor mouse position when mentions popover is visible and hide when it\n  // goes outside the anchor or popover.\n  useLayoutEffect(() => {\n    const anchor = mentionsPopoverAnchorRef.current;\n    const popover = mentionsPopoverRef.current;\n    if (!anchor || !popover || !popoverContent) {\n      return () => {};\n    }\n\n    const maybeHidePopover = (e: MouseEvent) => {\n      // Element boxes may have fractional coordinates, but mouse event\n      // coordinates are integers (in Chrome at least). Expand the boxes to the\n      // smallest box with integer coordinates. This way a mouse event\n      // dispatched at the exact corner of one of the boxes will still be deemed\n      // \"inside\".\n      const anchorBox = roundRectCoords(anchor.getBoundingClientRect());\n      const popoverBox = roundRectCoords(popover.getBoundingClientRect());\n\n      // There may be a small gap between the anchor and popover. To avoid\n      // hiding the popover when the mouse moves across this gap, we only hide\n      // the popover when it moves outside the union of these two boxes.\n      const unionBox = unionRect(anchorBox, popoverBox);\n\n      if (!rectContainsPoint(unionBox, e.clientX, e.clientY)) {\n        setPopoverContentAfterDelay(null);\n        mentionsPopoverAnchorRef.current = null;\n      }\n    };\n\n    // Use a listener on the body because there isn't a single element that\n    // corresponds to the region which the mouse has to exit before we hide the\n    // popover.\n    document.body.addEventListener('mousemove', maybeHidePopover);\n    return () => {\n      document.body.removeEventListener('mousemove', maybeHidePopover);\n    };\n  }, [popoverContent, setPopoverContentAfterDelay]);\n\n  // NB: The following could be implemented by setting attribute props directly\n  // on `StyledText` (which renders a `div` itself), versus introducing a child\n  // `div` as is done here. However, in initial testing, this interfered with\n  // some overflow calculations in the `Excerpt` element. This could be worth\n  // a review in the future.\n  return (\n    <div\n      className={classnames('w-full break-anywhere cursor-text', {\n        // A `relative` wrapper around the `Popover` component is needed for\n        // when the native Popover API is not supported.\n        relative: mentionsEnabled,\n      })}\n    >\n      <StyledText>\n        <div\n          className={classes}\n          data-testid=\"markdown-text\"\n          ref={content}\n          dangerouslySetInnerHTML={{ __html: html }}\n          style={style}\n          onMouseEnterCapture={\n            mentionsEnabled\n              ? ({ target }) => {\n                  const element = target as HTMLElement;\n                  const mention = elementToMentionMap.current.get(element);\n\n                  if (mention) {\n                    setPopoverContentAfterDelay(mention);\n                    mentionsPopoverAnchorRef.current = element;\n                  }\n                }\n              : undefined\n          }\n          onMouseLeaveCapture={({ target }) => {\n            // If the mouse leaves the mention before the popover has been\n            // shown, cancel the timer that shows the popover.\n            //\n            // Once the popover is shown, hiding it is handled by a separate\n            // effect that fires once the mouse leaves the area containing both\n            // the popover and the anchor.\n            const element = target as HTMLElement;\n            if (\n              mentionsPopoverAnchorRef.current === element &&\n              !popoverContent\n            ) {\n              setPopoverContentAfterDelay(null);\n              mentionsPopoverAnchorRef.current = null;\n            }\n          }}\n        />\n      </StyledText>\n      {mentionsEnabled && (\n        <Popover\n          open={!!popoverContent}\n          onClose={() => setPopoverContentAfterDelay(null)}\n          anchorElementRef={mentionsPopoverAnchorRef}\n          classes=\"!max-w-[75%]\"\n          elementRef={mentionsPopoverRef}\n        >\n          {popoverContent !== null && (\n            <MentionPopoverContent\n              content={popoverContent}\n              mentionMode={mentionMode}\n            />\n          )}\n        </Popover>\n      )}\n    </div>\n  );\n}\n","import type { ComponentChildren } from 'preact';\n\nexport type TagListProps = {\n  children: ComponentChildren;\n};\n\n/**\n * Render a list container for a list of annotation tags.\n */\nexport default function TagList({ children }: TagListProps) {\n  return (\n    <ul\n      className=\"flex flex-wrap gap-2 leading-none\"\n      aria-label=\"Annotation tags\"\n    >\n      {children}\n    </ul>\n  );\n}\n","import { Link, CancelIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nexport type TagListItemProps = {\n  /** If present, tag will be linked to this URL  */\n  href?: string;\n\n  /**\n   * Callback for deleting this tag. If present, a delete button will be\n   * rendered for the tag.\n   */\n  onRemoveTag?: (tag: string) => void;\n  tag: string;\n};\n\n/**\n * Render a single annotation tag as part of a list of tags\n */\nexport default function TagListItem({\n  href,\n  onRemoveTag,\n  tag,\n}: TagListItemProps) {\n  return (\n    <li className=\"flex items-center border rounded bg-grey-0\">\n      <div className=\"grow px-1.5 py-1 touch:p-2\">\n        {href ? (\n          <Link\n            variant=\"text-light\"\n            href={href}\n            lang=\"\"\n            target=\"_blank\"\n            aria-label={`Tag: ${tag}`}\n            title={`View annotations with tag: ${tag}`}\n            underline=\"none\"\n          >\n            {tag}\n          </Link>\n        ) : (\n          <span\n            className=\"text-color-text-light cursor-default\"\n            aria-label={`Tag: ${tag}`}\n            lang=\"\"\n          >\n            {tag}\n          </span>\n        )}\n      </div>\n      {onRemoveTag && (\n        <button\n          className={classnames(\n            // More padding for mobile users to make touch target larger\n            'px-1.5 py-1 touch:p-2',\n            // Rounded border to match container edges and make keyboard focus\n            // ring shape conform. Turn off left side\n            // border radius to maintain a straight dividing line\n            'border-l rounded rounded-l-none',\n            'text-grey-6 hover:text-color-text hover:bg-grey-2',\n            // Emulates transitions on *Button shared component styling\n            'transition-colors duration-200',\n            'focus-visible-ring ring-inset',\n          )}\n          onClick={() => {\n            onRemoveTag(tag);\n          }}\n          title={`Remove tag: ${tag}`}\n        >\n          <CancelIcon className=\"font-base w-em h-em\" title={`Remove ${tag}`} />\n        </button>\n      )}\n    </li>\n  );\n}\n","import { Button, CollapseIcon, ExpandIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useMemo, useState } from 'preact/hooks';\n\nimport type { Annotation } from '../../../types/api';\nimport type { SidebarSettings } from '../../../types/config';\nimport { isThirdPartyUser } from '../../helpers/account-id';\nimport { isHidden } from '../../helpers/annotation-metadata';\nimport type { MentionMode } from '../../helpers/mentions';\nimport { applyTheme } from '../../helpers/theme';\nimport { withServices } from '../../service-context';\nimport { useSidebarStore } from '../../store';\nimport Excerpt from '../Excerpt';\nimport MarkdownView from '../MarkdownView';\nimport TagList from '../TagList';\nimport TagListItem from '../TagListItem';\n\ntype ToggleExcerptButtonProps = {\n  classes?: string;\n  setCollapsed: (collapse: boolean) => void;\n  collapsed: boolean;\n};\n\n/**\n * Button to expand or collapse the annotation excerpt (content)\n */\nfunction ToggleExcerptButton({\n  classes,\n  setCollapsed,\n  collapsed,\n}: ToggleExcerptButtonProps) {\n  const toggleText = collapsed ? 'More' : 'Less';\n  return (\n    <Button\n      classes={classnames('text-grey-7 font-normal', classes)}\n      expanded={!collapsed}\n      onClick={() => setCollapsed(!collapsed)}\n      title={`Toggle visibility of full annotation text: Show ${toggleText}`}\n    >\n      <div className=\"flex items-center gap-x-2\">\n        {collapsed ? (\n          <ExpandIcon className=\"w-3 h-3\" />\n        ) : (\n          <CollapseIcon className=\"w-3 h-3\" />\n        )}\n        <div>{toggleText}</div>\n      </div>\n    </Button>\n  );\n}\n\nexport type AnnotationBodyProps = {\n  annotation: Annotation;\n\n  // injected\n  settings: SidebarSettings;\n};\n\n/**\n * Display the rendered content of an annotation.\n */\nfunction AnnotationBody({ annotation, settings }: AnnotationBodyProps) {\n  // Should the text content of `Excerpt` be rendered in a collapsed state,\n  // assuming it is collapsible (exceeds allotted collapsed space)?\n  const [collapsed, setCollapsed] = useState(true);\n\n  // Does the text content of `Excerpt` take up enough vertical space that\n  // collapsing/expanding is relevant?\n  const [collapsible, setCollapsible] = useState(false);\n\n  const store = useSidebarStore();\n  const defaultAuthority = store.defaultAuthority();\n  const draft = store.getDraft(annotation);\n  const mentionsEnabled = store.isFeatureEnabled('at_mentions');\n\n  // If there is a draft use the tag and text from it.\n  const tags = draft?.tags ?? annotation.tags;\n  const text = draft?.text ?? annotation.text;\n  const showExcerpt = text.length > 0;\n  const showTagList = tags.length > 0;\n\n  const textStyle = applyTheme(['annotationFontFamily'], settings);\n\n  const authorIsThirdParty = useMemo(\n    () => isThirdPartyUser(annotation.user, defaultAuthority),\n    [annotation, defaultAuthority],\n  );\n  const mentionMode: MentionMode = authorIsThirdParty\n    ? 'display-name'\n    : 'username';\n\n  const createTagSearchURL = (tag: string) => {\n    return store.getLink('search.tag', { tag });\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      {showExcerpt && (\n        <Excerpt\n          collapse={collapsed}\n          collapsedHeight={400}\n          inlineControls={false}\n          onCollapsibleChanged={setCollapsible}\n          onToggleCollapsed={setCollapsed}\n          overflowThreshold={20}\n        >\n          <MarkdownView\n            markdown={text}\n            classes={classnames({\n              'p-redacted-text': isHidden(annotation),\n            })}\n            style={textStyle}\n            mentions={annotation.mentions}\n            mentionsEnabled={mentionsEnabled}\n            mentionMode={mentionMode}\n          />\n        </Excerpt>\n      )}\n      {(collapsible || showTagList) && (\n        <div className=\"flex flex-row gap-x-2\">\n          <div className=\"grow\">\n            {showTagList && (\n              <TagList>\n                {tags.map(tag => {\n                  return (\n                    <TagListItem\n                      key={tag}\n                      tag={tag}\n                      href={\n                        !authorIsThirdParty\n                          ? createTagSearchURL(tag)\n                          : undefined\n                      }\n                    />\n                  );\n                })}\n              </TagList>\n            )}\n          </div>\n          {collapsible && (\n            <div>\n              <ToggleExcerptButton\n                classes={classnames(\n                  // Pull button up toward bottom of excerpt content\n                  '-mt-3',\n                )}\n                collapsed={collapsed}\n                setCollapsed={setCollapsed}\n              />\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default withServices(AnnotationBody, ['settings']);\n","/**\n * Commands for toggling markdown formatting of a selection\n * in an input field.\n *\n * All of the functions in this module take as input the current state\n * of the input field, parameters for the operation to perform and return the\n * new state of the input field.\n */\n\n/**\n * Describes the state of a plain text input field.\n */\nexport type EditorState = {\n  text: string;\n  selectionStart: number;\n  selectionEnd: number;\n};\n\n/**\n * Types of Markdown link that can be inserted with\n * {@link convertSelectionToLink}.\n */\nexport enum LinkType {\n  ANCHOR_LINK = 'ANCHOR_LINK',\n  IMAGE_LINK = 'IMAGE_LINK',\n}\n\n/**\n * Replace text in an input field and return the new state.\n *\n * @param state - The state of the input field.\n * @param pos - The start position of the text to remove.\n * @param length - The number of characters to remove.\n * @param text - The replacement text to insert at `pos`.\n * @return The new state of the input field.\n */\nfunction replaceText(\n  state: EditorState,\n  pos: number,\n  length: number,\n  text: string,\n): EditorState {\n  let newSelectionStart = state.selectionStart;\n  let newSelectionEnd = state.selectionEnd;\n\n  if (newSelectionStart >= pos + length) {\n    // 1. Selection is after replaced text:\n    //    Increment (start, end) by difference in length between original and\n    //    replaced text\n    newSelectionStart += text.length - length;\n    newSelectionEnd += text.length - length;\n  } else if (newSelectionEnd <= pos) {\n    // 2. Selection is before replaced text: Leave selection unchanged\n  } else if (newSelectionStart <= pos && newSelectionEnd >= pos + length) {\n    // 3. Selection fully contains replaced text:\n    //    Increment end by difference in length between original and replaced\n    //    text\n    newSelectionEnd += text.length - length;\n  } else if (newSelectionStart < pos && newSelectionEnd < pos + length) {\n    // 4. Selection overlaps start but not end of replaced text:\n    //    Decrement start to start of replacement text\n    newSelectionStart = pos;\n  } else if (\n    newSelectionStart < pos + length &&\n    newSelectionEnd > pos + length\n  ) {\n    // 5. Selection overlaps end but not start of replaced text:\n    //    Increment end by difference in length between original and replaced\n    //    text\n    newSelectionEnd += text.length - length;\n  } else if (pos < newSelectionStart && pos + length > newSelectionEnd) {\n    // 6. Replaced text fully contains selection:\n    //    Expand selection to replaced text\n    newSelectionStart = pos;\n    newSelectionEnd = pos + length;\n  }\n\n  return {\n    text: state.text.slice(0, pos) + text + state.text.slice(pos + length),\n    selectionStart: newSelectionStart,\n    selectionEnd: newSelectionEnd,\n  };\n}\n\n/**\n * Convert the selected text into a Markdown link.\n *\n * @param state - The current state of the input field.\n * @param [linkType] - The type of link to insert.\n * @return The new state of the input field.\n */\nexport function convertSelectionToLink(\n  state: EditorState,\n  linkType: LinkType = LinkType.ANCHOR_LINK,\n): EditorState {\n  const selection = state.text.slice(state.selectionStart, state.selectionEnd);\n\n  let linkPrefix = '';\n  if (linkType === LinkType.IMAGE_LINK) {\n    linkPrefix = '!';\n  }\n\n  let newState;\n  if (selection.match(/[a-z]+:\\/\\/.*/)) {\n    // Selection is a URL, wrap it with a link and use the selection as\n    // the target.\n    const dummyLabel = 'Description';\n    newState = replaceText(\n      state,\n      state.selectionStart,\n      selection.length,\n      linkPrefix + '[' + dummyLabel + '](' + selection + ')',\n    );\n    newState.selectionStart = state.selectionStart + linkPrefix.length + 1;\n    newState.selectionEnd = newState.selectionStart + dummyLabel.length;\n    return newState;\n  } else {\n    // Selection is not a URL, wrap it with a link and use the selection as\n    // the label. Change the selection to the dummy link.\n    const beforeURL = linkPrefix + '[' + selection + '](';\n    const dummyLink = 'http://insert-your-link-here.com';\n    newState = replaceText(\n      state,\n      state.selectionStart,\n      selection.length,\n      beforeURL + dummyLink + ')',\n    );\n    newState.selectionStart = state.selectionStart + beforeURL.length;\n    newState.selectionEnd = newState.selectionStart + dummyLink.length;\n    return newState;\n  }\n}\n\n/**\n * Toggle Markdown-style formatting around a span of text.\n *\n * @param state - The current state of the input field.\n * @param prefix - The prefix to add or remove before the selection.\n * @param suffix - The suffix to add or remove after the selection, defaults to\n *   being the same as the prefix.\n * @param placeholder - The text to insert between 'prefix' and 'suffix' if the\n *   input text is empty.\n * @return The new state of the input field.\n */\nexport function toggleSpanStyle(\n  state: EditorState,\n  prefix: string,\n  suffix: string | undefined,\n  placeholder: string,\n): EditorState {\n  if (typeof suffix === 'undefined') {\n    suffix = prefix;\n  }\n\n  const selectionPrefix = state.text.slice(\n    state.selectionStart - prefix.length,\n    state.selectionStart,\n  );\n  const selectionSuffix = state.text.slice(\n    state.selectionEnd,\n    state.selectionEnd + prefix.length,\n  );\n  let newState = state;\n\n  if (state.selectionStart === state.selectionEnd && placeholder) {\n    newState = replaceText(state, state.selectionStart, 0, placeholder);\n    newState.selectionStart = newState.selectionEnd - placeholder.length;\n  }\n\n  if (selectionPrefix === prefix && selectionSuffix === suffix) {\n    newState = replaceText(\n      newState,\n      newState.selectionStart - prefix.length,\n      prefix.length,\n      '',\n    );\n    newState = replaceText(newState, newState.selectionEnd, suffix.length, '');\n  } else {\n    newState = replaceText(newState, newState.selectionStart, 0, prefix);\n    newState = replaceText(newState, newState.selectionEnd, 0, suffix);\n  }\n\n  return newState;\n}\n\n/**\n * Find the nearest line beginning searching backwards from `pos`.\n */\nfunction startOfLine(str: string, pos: number) {\n  const start = str.lastIndexOf('\\n', pos);\n  if (start < 0) {\n    return 0;\n  } else {\n    return start + 1;\n  }\n}\n\n/**\n * Find the nearest line ending searching forwards from `pos`.\n */\nfunction endOfLine(str: string, pos: number) {\n  const end = str.indexOf('\\n', pos);\n  if (end < 0) {\n    return str.length;\n  } else {\n    return end;\n  }\n}\n\ntype TransformLinesCallback = (\n  state: EditorState,\n  start: number,\n  end: number,\n  lineIndex: number,\n) => EditorState;\n\n/**\n * Transform lines between two positions in an input field.\n *\n * @param state - The initial state of the input field\n * @param start - The start position within the input text\n * @param end - The end position within the input text\n * @param callback\n *  - Callback which is invoked with the current state of the input and\n *    the start of the current line and returns the new state of the input.\n */\nfunction transformLines(\n  state: EditorState,\n  start: number,\n  end: number,\n  callback: TransformLinesCallback,\n) {\n  let lineStart = startOfLine(state.text, start);\n  let lineEnd = endOfLine(state.text, start);\n  let lineIndex = 0;\n\n  while (lineEnd <= endOfLine(state.text, end)) {\n    const isLastLine = lineEnd === state.text.length;\n    const currentLineLength = lineEnd - lineStart;\n\n    state = callback(state, lineStart, lineEnd, lineIndex);\n\n    const newLineLength = endOfLine(state.text, lineStart) - lineStart;\n    end += newLineLength - currentLineLength;\n\n    if (isLastLine) {\n      break;\n    }\n    lineStart = lineStart + newLineLength + 1;\n    lineEnd = endOfLine(state.text, lineStart);\n    lineIndex += 1;\n  }\n  return state;\n}\n\n/**\n * Toggle Markdown-style formatting around a block of text.\n *\n * @param state - The current state of the input field.\n * @param prefix - The prefix to add or remove before each line of the\n *   selection, or a callback which returns said prefix for a specific line\n *   index (useful for multi-line selections that require different prefixes\n *   per line).\n * @return The new state of the input field.\n */\nexport function toggleBlockStyle(\n  state: EditorState,\n  prefix: string | ((lineIndex: number) => string),\n): EditorState {\n  const start = state.selectionStart;\n  const end = state.selectionEnd;\n  const prefixToString = (lineIndex: number) =>\n    typeof prefix === 'function' ? prefix(lineIndex) : prefix;\n\n  // Test whether all lines in the selected range already have the style\n  // applied\n  let blockHasStyle = true;\n  transformLines(state, start, end, (state, lineStart, _lineEnd, lineIndex) => {\n    const prefix = prefixToString(lineIndex);\n    if (state.text.slice(lineStart, lineStart + prefix.length) !== prefix) {\n      blockHasStyle = false;\n    }\n    return state;\n  });\n\n  if (blockHasStyle) {\n    // Remove the formatting.\n    return transformLines(\n      state,\n      start,\n      end,\n      (state, lineStart, _lineEnd, lineIndex) => {\n        const prefix = prefixToString(lineIndex);\n        return replaceText(state, lineStart, prefix.length, '');\n      },\n    );\n  } else {\n    // Add the block style to any lines which do not already have it applied\n    return transformLines(\n      state,\n      start,\n      end,\n      (state, lineStart, _lineEnd, lineIndex) => {\n        const prefix = prefixToString(lineIndex);\n        if (state.text.slice(lineStart, lineStart + prefix.length) === prefix) {\n          return state;\n        } else {\n          return replaceText(state, lineStart, 0, prefix);\n        }\n      },\n    );\n  }\n}\n","// Hidden div used by `getCaretCoordinates` to mirror content of text area.\nlet mirrorDiv: HTMLElement | undefined;\n\n// Enable debug mode. This makes the hidden div used to measure the caret\n// position visible and keeps it in the DOM after the position is calculated.\nconst mirrorDebug = false;\n\n/**\n * Calculate the coordinates of the caret position within a textarea.\n *\n * @return Coordinates of the caret relative to the textarea's top-left corner\n */\nexport function getCaretCoordinates(textarea: HTMLTextAreaElement): {\n  x: number;\n  y: number;\n} {\n  if (!mirrorDiv) {\n    mirrorDiv = document.createElement('div');\n    document.body.append(mirrorDiv);\n  }\n\n  try {\n    const textareaRect = textarea.getBoundingClientRect();\n\n    // Style text in the mirror to match the textarea\n    const styles = window.getComputedStyle(textarea);\n    mirrorDiv.style.font = styles.font;\n    mirrorDiv.style.padding = styles.padding;\n    mirrorDiv.style.whiteSpace = 'pre-wrap';\n    mirrorDiv.style.wordWrap = 'break-word';\n    mirrorDiv.style.position = 'fixed';\n\n    /* istanbul ignore next */\n    if (!mirrorDebug) {\n      mirrorDiv.style.visibility = 'hidden';\n    } else {\n      mirrorDiv.style.pointerEvents = 'none';\n      mirrorDiv.style.background = 'rgba(255, 0, 0, 0.5)';\n    }\n\n    // Position mirror above the textarea\n    mirrorDiv.style.width = `${textareaRect.width}px`;\n    mirrorDiv.style.height = `${textareaRect.height}px`;\n    mirrorDiv.style.top = `${textareaRect.top}px`;\n    mirrorDiv.style.left = `${textareaRect.left}px`;\n\n    // Update mirror content to match textarea and insert an element at the\n    // caret position.\n    //\n    // We need to include the text before and after the caret so that the scroll\n    // height is the same as the text area.\n    const caretPosition = textarea.selectionStart;\n    const caretSpan = document.createElement('span');\n\n    // Align top of caret indicator with bottom of line. This makes the precise\n    // position a little easier to reason about. Otherwise it will be aligned\n    // with the baseline.\n    caretSpan.style.display = 'inline-block';\n    caretSpan.style.verticalAlign = 'bottom';\n\n    const textBeforeCaret = textarea.value.substring(0, caretPosition);\n    const textAfterCaret = textarea.value.slice(caretPosition);\n\n    // Add a non-empty line at the end. This avoids a problem where the mirror's\n    // scrollable height can be less than the textarea if the text content ends\n    // with a new line.\n    const suffix = '\\nx';\n\n    mirrorDiv.innerHTML = '';\n    mirrorDiv.append(textBeforeCaret, caretSpan, textAfterCaret, suffix);\n\n    // Adjust scroll position to match the textarea. For this to work, the\n    // scrollable height of the mirror must be at least equal to the scrollable\n    // height of the text area.\n    mirrorDiv.style.overflowY = 'auto';\n    mirrorDiv.scrollTop = textarea.scrollTop;\n\n    // Capture caret position relative to top-left corner of textarea.\n    const rect = caretSpan.getBoundingClientRect();\n\n    return {\n      x: rect.left - textareaRect.left,\n      y: rect.top - textareaRect.top,\n    };\n  } finally {\n    if (!mirrorDebug) {\n      mirrorDiv.remove();\n      mirrorDiv = undefined;\n    }\n  }\n}\n","import { Popover } from '@hypothesis/frontend-shared';\nimport type { PopoverProps } from '@hypothesis/frontend-shared/lib/components/feedback/Popover';\nimport classnames from 'classnames';\n\nimport type { UserItem } from '../helpers/mention-suggestions';\nimport type { MentionMode } from '../helpers/mentions';\n\ntype SuggestionItemProps = {\n  user: UserItem;\n  usersListboxId: string;\n  highlighted: boolean;\n  mentionMode: MentionMode;\n  onSelect: () => void;\n  onHighlight: () => void;\n};\n\nfunction SuggestionItem({\n  user,\n  usersListboxId,\n  highlighted,\n  mentionMode,\n  onSelect,\n  onHighlight,\n}: SuggestionItemProps) {\n  const showUsername = mentionMode === 'username';\n\n  return (\n    // These options are indirectly handled via keyboard event\n    // handlers in the textarea, hence, we don't want to add keyboard\n    // event handlers here, but we want to handle click events.\n    // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n    <li\n      key={user.username}\n      id={`${usersListboxId}-${user.username}`}\n      className={classnames(\n        'flex justify-between items-center gap-x-2 rounded p-2',\n        // Adjust line height relative to the font size. This avoids\n        // vertically cropped usernames due to the use of `truncate`.\n        'leading-tight',\n        {\n          'bg-grey-2': highlighted,\n        },\n      )}\n      onClick={e => {\n        e.stopPropagation();\n        onSelect();\n      }}\n      // Using onMouseMove instead of onMouseEnter, so that if the mouse is\n      // already hovering this item, and then we change the highlighted\n      // suggestion via arrow keys, when the mouse is moved again, this item\n      // becomes highlighted without having to first leave it and enter again.\n      onMouseMove={onHighlight}\n      role=\"option\"\n      aria-selected={highlighted}\n    >\n      {showUsername && (\n        <span className=\"truncate\" data-testid={`username-${user.username}`}>\n          {user.username}\n        </span>\n      )}\n      <span className={classnames({ 'text-color-text-light': showUsername })}>\n        {user.displayName}\n      </span>\n    </li>\n  );\n}\n\nexport type MentionSuggestionsPopoverProps = Pick<\n  PopoverProps,\n  'open' | 'onClose' | 'anchorElementRef'\n> & {\n  /** Whether the list of users is currently being loaded */\n  loadingUsers: boolean;\n  /** List of users to suggest */\n  users: UserItem[];\n  /** Index for currently highlighted suggestion */\n  highlightedSuggestion: number;\n  /** Invoked when currently highlighted suggestion index is changed */\n  onHighlightSuggestion: (index: number) => void;\n  /** Invoked when a user is selected */\n  onSelectUser: (selectedSuggestion: UserItem) => void;\n  /** Element ID for the user suggestions listbox */\n  usersListboxId: string;\n  /** Determines what information to display in suggestions */\n  mentionMode: MentionMode;\n};\n\n/**\n * A Popover component that displays a list of user suggestions for @mentions.\n */\nexport default function MentionSuggestionsPopover({\n  loadingUsers,\n  users,\n  onSelectUser,\n  highlightedSuggestion,\n  onHighlightSuggestion,\n  usersListboxId,\n  mentionMode,\n  ...popoverProps\n}: MentionSuggestionsPopoverProps) {\n  return (\n    <Popover\n      {...popoverProps}\n      classes={classnames('p-1', [\n        // Popovers have a default max-h-80, which only fits a bit more than 9\n        // suggestions at their current height.\n        // Since we cap at 10 suggestions, increasing this max height prevents\n        // scrollbars to appear.\n        '!max-h-96',\n      ])}\n    >\n      <ul\n        className=\"flex-col gap-y-0.5\"\n        role=\"listbox\"\n        aria-orientation=\"vertical\"\n        id={usersListboxId}\n      >\n        {loadingUsers ? (\n          <li\n            className=\"italic p-2\"\n            data-testid=\"suggestions-loading-indicator\"\n          >\n            Loading suggestions…\n          </li>\n        ) : (\n          <>\n            {users.map((u, index) => (\n              <SuggestionItem\n                key={u.username}\n                user={u}\n                highlighted={highlightedSuggestion === index}\n                mentionMode={mentionMode}\n                usersListboxId={usersListboxId}\n                onSelect={() => onSelectUser(u)}\n                onHighlight={() => onHighlightSuggestion(index)}\n              />\n            ))}\n            {users.length === 0 && (\n              <li className=\"italic p-2\" data-testid=\"suggestions-fallback\">\n                No matches. You can still write the username\n              </li>\n            )}\n          </>\n        )}\n      </ul>\n    </Popover>\n  );\n}\n","import {\n  Button,\n  IconButton,\n  Link,\n  MentionIcon,\n  useSyncedRef,\n} from '@hypothesis/frontend-shared';\nimport {\n  EditorLatexIcon,\n  EditorQuoteIcon,\n  EditorTextBoldIcon,\n  EditorTextItalicIcon,\n  HelpIcon,\n  ImageIcon,\n  LinkIcon,\n  ListOrderedIcon,\n  ListUnorderedIcon,\n  useArrowKeyNavigation,\n} from '@hypothesis/frontend-shared';\nimport type { IconComponent } from '@hypothesis/frontend-shared/lib/types';\nimport classnames from 'classnames';\nimport type { Ref, JSX } from 'preact';\nimport {\n  useCallback,\n  useEffect,\n  useId,\n  useMemo,\n  useRef,\n  useState,\n} from 'preact/hooks';\n\nimport { isMacOS } from '../../shared/user-agent';\nimport type { Mention } from '../../types/api';\nimport type {\n  UserItem,\n  UsersForMentions,\n} from '../helpers/mention-suggestions';\nimport { usersMatchingMention } from '../helpers/mention-suggestions';\nimport type { MentionMode } from '../helpers/mentions';\nimport {\n  getContainingMentionOffsets,\n  termBeforePosition,\n  toPlainTextMention,\n  unwrapMentions,\n} from '../helpers/mentions';\nimport {\n  LinkType,\n  convertSelectionToLink,\n  toggleBlockStyle,\n  toggleSpanStyle,\n} from '../markdown-commands';\nimport type { EditorState } from '../markdown-commands';\nimport { getCaretCoordinates } from '../util/textarea-caret-position';\nimport MarkdownView from './MarkdownView';\nimport MentionSuggestionsPopover from './MentionSuggestionsPopover';\n\n/**\n * Toolbar commands that modify the editor state. This excludes the Help link\n * and Preview buttons.\n */\ntype Command =\n  | 'bold'\n  | 'image'\n  | 'italic'\n  | 'link'\n  | 'list'\n  | 'math'\n  | 'numlist'\n  | 'quote'\n  | 'mention';\n\n/**\n * Mapping of toolbar command name to key for Ctrl+<key> keyboard shortcuts.\n * The shortcuts are taken from Stack Overflow's editor.\n */\nconst SHORTCUT_KEYS: Partial<Record<Command, string>> = {\n  bold: 'b',\n  image: 'g',\n  italic: 'i',\n  link: 'l',\n  list: 'u',\n  math: 'm',\n  numlist: 'o',\n  quote: 'q',\n};\n\n/**\n * Apply a toolbar command to an editor input field.\n */\nfunction handleToolbarCommand(\n  command: Command,\n  inputEl: HTMLInputElement | HTMLTextAreaElement,\n) {\n  const update = (newStateFn: (prevState: EditorState) => EditorState) => {\n    // Apply the toolbar command to the current state of the input field.\n    const newState = newStateFn({\n      text: inputEl.value,\n      selectionStart: inputEl.selectionStart!,\n      selectionEnd: inputEl.selectionEnd!,\n    });\n\n    // Update the input field to match the new state.\n    inputEl.value = newState.text;\n    inputEl.selectionStart = newState.selectionStart;\n    inputEl.selectionEnd = newState.selectionEnd;\n\n    // Restore input field focus which is lost when its contents are changed.\n    inputEl.focus();\n  };\n\n  const insertMath = (state: EditorState) => {\n    const before = state.text.slice(0, state.selectionStart);\n    if (\n      before.length === 0 ||\n      before.slice(-1) === '\\n' ||\n      before.slice(-2) === '$$'\n    ) {\n      return toggleSpanStyle(state, '$$', '$$', 'Insert LaTeX');\n    } else {\n      return toggleSpanStyle(state, '\\\\(', '\\\\)', 'Insert LaTeX');\n    }\n  };\n\n  switch (command) {\n    case 'bold':\n      update(state => toggleSpanStyle(state, '**', '**', 'Bold'));\n      break;\n    case 'italic':\n      update(state => toggleSpanStyle(state, '*', '*', 'Italic'));\n      break;\n    case 'quote':\n      update(state => toggleBlockStyle(state, '> '));\n      break;\n    case 'link':\n      update(state => convertSelectionToLink(state));\n      break;\n    case 'image':\n      update(state => convertSelectionToLink(state, LinkType.IMAGE_LINK));\n      break;\n    case 'math':\n      update(insertMath);\n      break;\n    case 'numlist':\n      update(state =>\n        toggleBlockStyle(state, lineIndex => `${lineIndex + 1}. `),\n      );\n      break;\n    case 'list':\n      update(state => toggleBlockStyle(state, '* '));\n      break;\n    case 'mention':\n      update(state => toggleSpanStyle(state, '@', '', ''));\n      // Dispatch input event with `@` key, to open the suggestions popover\n      inputEl.dispatchEvent(new KeyboardEvent('input', { key: '@' }));\n      break;\n  }\n}\n\ntype ToolbarButtonProps = {\n  disabled?: boolean;\n  icon?: IconComponent;\n  label?: string;\n  onClick: (e: MouseEvent) => void;\n  shortcutKey?: string;\n  title?: string;\n  classes?: string | string[];\n};\n\nfunction ToolbarButton({\n  disabled = false,\n  icon: Icon,\n  label,\n  onClick,\n  shortcutKey,\n  title = '',\n  classes,\n}: ToolbarButtonProps) {\n  const modifierKey = useMemo(() => (isMacOS() ? 'Cmd' : 'Ctrl'), []);\n\n  let tooltip = title;\n  if (shortcutKey) {\n    tooltip += ` (${modifierKey}-${shortcutKey.toUpperCase()})`;\n  }\n\n  const buttonProps = {\n    disabled,\n    onClick,\n    title: tooltip,\n  };\n\n  if (label) {\n    return (\n      <Button\n        classes={classnames('p-1.5 text-grey-7 hover:text-grey-9', classes)}\n        {...buttonProps}\n        size=\"custom\"\n        variant=\"custom\"\n      >\n        {label}\n      </Button>\n    );\n  }\n  return (\n    <IconButton classes={classnames('px-2 py-2.5', classes)} {...buttonProps}>\n      {Icon && (\n        <Icon className=\"w-[10px] h-[10px] touch:w-[13px] touch:h-[13px]\" />\n      )}\n    </IconButton>\n  );\n}\n\ntype TextAreaProps = {\n  classes?: string;\n  containerRef?: Ref<HTMLTextAreaElement>;\n  mentionsEnabled: boolean;\n  usersForMentions: UsersForMentions;\n  onEditText: (text: string) => void;\n  mentionMode: MentionMode;\n  onInsertMentionSuggestion?: (user: UserItem) => void;\n};\n\nfunction TextArea({\n  classes,\n  containerRef,\n  mentionsEnabled,\n  usersForMentions,\n  onEditText,\n  onKeyDown,\n  mentionMode,\n  onInsertMentionSuggestion,\n  ...restProps\n}: TextAreaProps & JSX.TextareaHTMLAttributes) {\n  const [suggestionsPopoverOpen, setSuggestionsPopoverOpen] = useState(false);\n  const [activeMention, setActiveMention] = useState<string>();\n  const textareaRef = useSyncedRef(containerRef);\n  const [highlightedSuggestion, setHighlightedSuggestion] = useState(0);\n  const caretElementRef = useRef<HTMLDivElement>(null);\n  const userSuggestions = useMemo(\n    () =>\n      mentionsEnabled\n        ? usersMatchingMention(activeMention, usersForMentions, { mentionMode })\n        : [],\n    [activeMention, mentionMode, mentionsEnabled, usersForMentions],\n  );\n\n  const checkForMentionAtCaret = useCallback(\n    (textarea: HTMLTextAreaElement) => {\n      if (!mentionsEnabled) {\n        return;\n      }\n\n      // Re-position mention popover anchor element at the caret.\n      const { x, y } = getCaretCoordinates(textarea);\n      if (caretElementRef.current) {\n        caretElementRef.current.style.transform = `translate(${x}px, ${y}px)`;\n      }\n\n      const term = termBeforePosition(textarea.value, textarea.selectionStart);\n      const isAtMention = term.startsWith('@');\n      setSuggestionsPopoverOpen(isAtMention);\n      setActiveMention(isAtMention ? term.substring(1) : undefined);\n    },\n    [mentionsEnabled],\n  );\n  const insertMention = useCallback(\n    (suggestion: UserItem) => {\n      const textarea = textareaRef.current!;\n      const { value } = textarea;\n      const { start, end } = getContainingMentionOffsets(\n        value,\n        textarea.selectionStart,\n      );\n      const beforeMention = value.slice(0, start);\n      const beforeCaret = `${beforeMention}${toPlainTextMention(suggestion, mentionMode)} `;\n      const afterMention = value.slice(end);\n\n      // Set textarea value directly, set new caret position and keep it focused.\n      textarea.value = `${beforeCaret}${afterMention}`;\n      textarea.selectionStart = beforeCaret.length;\n      textarea.selectionEnd = beforeCaret.length;\n      textarea.focus();\n      // Then update state to keep it in sync.\n      onEditText(textarea.value);\n\n      // Additionally, notify that a mention was inserted from a suggestion\n      onInsertMentionSuggestion?.(suggestion);\n\n      // Close popover and reset highlighted suggestion once the value is\n      // replaced\n      setSuggestionsPopoverOpen(false);\n      setHighlightedSuggestion(0);\n    },\n    [mentionMode, onEditText, onInsertMentionSuggestion, textareaRef],\n  );\n\n  const usersListboxId = useId();\n  const accessibilityAttributes = useMemo((): JSX.TextareaHTMLAttributes => {\n    if (!suggestionsPopoverOpen) {\n      return {};\n    }\n\n    const selectedSuggestion = userSuggestions[highlightedSuggestion];\n    const activeDescendant = selectedSuggestion\n      ? `${usersListboxId}-${selectedSuggestion.username}`\n      : undefined;\n\n    return {\n      // These attributes follow the MDN instructions for aria-autocomplete\n      // See https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-autocomplete\n      role: 'combobox',\n      'aria-controls': usersListboxId,\n      'aria-expanded': true,\n      'aria-autocomplete': 'list',\n      'aria-haspopup': 'listbox',\n      'aria-activedescendant': activeDescendant,\n    };\n  }, [\n    highlightedSuggestion,\n    suggestionsPopoverOpen,\n    userSuggestions,\n    usersListboxId,\n  ]);\n\n  return (\n    <div className=\"relative\">\n      <textarea\n        className={classnames(\n          'border rounded p-2',\n          'placeholder:text-grey-6 bg-grey-0',\n          'focus:bg-white focus:outline-none focus:shadow-focus-inner',\n          classes,\n        )}\n        onInput={(e: Event) => {\n          const textarea = e.target as HTMLTextAreaElement;\n          onEditText(textarea.value);\n          // Reset highlighted suggestion every time text is edited, as that\n          // could affect the list of suggestions\n          setHighlightedSuggestion(0);\n          checkForMentionAtCaret(textarea);\n        }}\n        {...restProps}\n        // We listen for `keyup` to make sure the text in the textarea reflects\n        // the just-pressed key when we evaluate it\n        onKeyUp={e => {\n          // Check if suggestions need to be closed, maybe because the pressed\n          // key caused the caret to move \"out\" of a mention.\n          // If already closed we don't need to do anything, as opening the\n          // popover is handled in `onInput`.\n          if (suggestionsPopoverOpen) {\n            checkForMentionAtCaret(e.target as HTMLTextAreaElement);\n          }\n        }}\n        onKeyDown={e => {\n          // Invoke original handler if present\n          onKeyDown?.(e);\n\n          if (!suggestionsPopoverOpen || userSuggestions.length === 0) {\n            return;\n          }\n\n          // When vertical arrows are pressed while the popover is open with\n          // user suggestions, highlight the right one.\n          // When `Enter` is pressed, insert highlighted one.\n          if (e.key === 'ArrowDown') {\n            e.preventDefault();\n            setHighlightedSuggestion(prev =>\n              Math.min(prev + 1, userSuggestions.length - 1),\n            );\n          } else if (e.key === 'ArrowUp') {\n            e.preventDefault();\n            setHighlightedSuggestion(prev => Math.max(prev - 1, 0));\n          } else if (e.key === 'Enter') {\n            e.preventDefault();\n            insertMention(userSuggestions[highlightedSuggestion]);\n          }\n        }}\n        ref={textareaRef}\n        {...accessibilityAttributes}\n      />\n      <div\n        ref={caretElementRef}\n        className=\"absolute top-0 left-0 w-0 h-0 pointer-events-none\"\n      />\n      {mentionsEnabled && (\n        <MentionSuggestionsPopover\n          open={suggestionsPopoverOpen}\n          onClose={() => setSuggestionsPopoverOpen(false)}\n          anchorElementRef={caretElementRef}\n          loadingUsers={usersForMentions.status === 'loading'}\n          users={userSuggestions}\n          highlightedSuggestion={highlightedSuggestion}\n          onHighlightSuggestion={setHighlightedSuggestion}\n          onSelectUser={insertMention}\n          usersListboxId={usersListboxId}\n          mentionMode={mentionMode}\n        />\n      )}\n    </div>\n  );\n}\n\ntype ToolbarProps = {\n  /** Editor's \"Preview\" mode is active */\n  isPreviewing: boolean;\n\n  /** Callback invoked when a toolbar button is clicked */\n  onCommand: (command: Command) => void;\n\n  showHelpLink: boolean;\n  mentionsEnabled: boolean;\n\n  /** Callback invoked when the \"Preview\" toggle button is clicked */\n  onTogglePreview: () => void;\n};\n\n/**\n * An array of toolbar elements with a roving tab stop. Left and right\n * array keys can be used to change focus of the elements. Home and end\n * keys will navigate to the first and last elements respectively.\n *\n * Canonical example\n * https://www.w3.org/TR/wai-aria-practices/examples/toolbar/toolbar.html\n */\nfunction Toolbar({\n  isPreviewing,\n  onCommand,\n  onTogglePreview,\n  showHelpLink,\n  mentionsEnabled,\n}: ToolbarProps) {\n  const toolbarContainer = useRef(null);\n  useArrowKeyNavigation(toolbarContainer);\n\n  return (\n    <div\n      className={classnames(\n        // Allow buttons to wrap to second line if necessary.\n        'flex flex-wrap w-full items-center',\n        'p-1 border-x border-t rounded-t bg-white',\n        // For touch interfaces, allow height to scale to larger button targets.\n        // Don't wrap buttons but instead scroll horizontally. Add bottom\n        // padding to provide some space for scrollbar.\n        'touch:h-auto touch:overflow-x-scroll touch:flex-nowrap touch:pb-2.5',\n      )}\n      data-testid=\"markdown-toolbar\"\n      role=\"toolbar\"\n      aria-label=\"Markdown editor toolbar\"\n      ref={toolbarContainer}\n    >\n      <ToolbarButton\n        disabled={isPreviewing}\n        icon={EditorTextBoldIcon}\n        onClick={() => onCommand('bold')}\n        shortcutKey={SHORTCUT_KEYS.bold}\n        title=\"Bold\"\n      />\n      <ToolbarButton\n        disabled={isPreviewing}\n        icon={EditorTextItalicIcon}\n        onClick={() => onCommand('italic')}\n        shortcutKey={SHORTCUT_KEYS.italic}\n        title=\"Italic\"\n      />\n      <ToolbarButton\n        disabled={isPreviewing}\n        icon={EditorQuoteIcon}\n        onClick={() => onCommand('quote')}\n        shortcutKey={SHORTCUT_KEYS.quote}\n        title=\"Quote\"\n      />\n      <ToolbarButton\n        disabled={isPreviewing}\n        icon={LinkIcon}\n        onClick={() => onCommand('link')}\n        shortcutKey={SHORTCUT_KEYS.link}\n        title=\"Insert link\"\n      />\n      <ToolbarButton\n        disabled={isPreviewing}\n        icon={ImageIcon}\n        onClick={() => onCommand('image')}\n        shortcutKey={SHORTCUT_KEYS.image}\n        title=\"Insert image\"\n      />\n      <ToolbarButton\n        disabled={isPreviewing}\n        icon={EditorLatexIcon}\n        onClick={() => onCommand('math')}\n        title=\"Insert math (LaTeX is supported)\"\n      />\n      <ToolbarButton\n        disabled={isPreviewing}\n        icon={ListOrderedIcon}\n        onClick={() => onCommand('numlist')}\n        shortcutKey={SHORTCUT_KEYS.numlist}\n        title=\"Numbered list\"\n      />\n      <ToolbarButton\n        disabled={isPreviewing}\n        icon={ListUnorderedIcon}\n        onClick={() => onCommand('list')}\n        shortcutKey={SHORTCUT_KEYS.list}\n        title=\"Bulleted list\"\n      />\n      {mentionsEnabled && (\n        <ToolbarButton\n          disabled={isPreviewing}\n          icon={MentionIcon}\n          onClick={() => onCommand('mention')}\n          title=\"Mention\"\n          // We temporarily add text-brand so that the mention feature is easier\n          // to discover. We'll remove it after some time.\n          classes=\"!text-brand\"\n        />\n      )}\n      <div className=\"grow flex justify-end\">\n        {showHelpLink && (\n          <Link\n            classes=\"text-grey-7 hover:!text-grey-7\"\n            href=\"https://web.hypothes.is/help/formatting-annotations-with-markdown/\"\n            target=\"_blank\"\n            title=\"Formatting help\"\n            aria-label=\"Formatting help\"\n            underline=\"none\"\n            variant=\"custom\"\n          >\n            <div\n              className={classnames(\n                'flex justify-center items-center',\n                'touch:h-touch-minimum touch:w-touch-minimum',\n                'px-2 py-2.5 touch:p-0',\n              )}\n            >\n              <HelpIcon className=\"w-2.5 h-2.5\" />\n            </div>\n          </Link>\n        )}\n\n        <ToolbarButton\n          label={isPreviewing ? 'Write' : 'Preview'}\n          onClick={onTogglePreview}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport type MarkdownEditorProps = {\n  /**\n   * Whether the at-mentions feature ir enabled or not.\n   * Defaults to false.\n   */\n  mentionsEnabled?: boolean;\n\n  /** An accessible label for the input field */\n  label: string;\n\n  /** Additional CSS properties to apply to the input field and rendered preview */\n  textStyle?: Record<string, string>;\n\n  /** The markdown text to edit */\n  text: string;\n\n  onEditText?: (text: string) => void;\n\n  /** Whether to display the formatting help link in the toolbar. */\n  showHelpLink?: boolean;\n\n  /**\n   * Base list of users used to populate the @mentions suggestions, when\n   * `mentionsEnabled` is `true`.\n   * The list will be filtered and narrowed down based on the partial mention.\n   * The mention can still be set manually. It is not restricted to the items on\n   * this list.\n   */\n  usersForMentions: UsersForMentions;\n\n  /** List of mentions extracted from the annotation text. */\n  mentions?: Mention[];\n  mentionMode: MentionMode;\n\n  /** Invoked when a mention is inserted from a suggestion */\n  onInsertMentionSuggestion?: (suggestion: UserItem) => void;\n};\n\n/**\n * Viewer/editor for the body of an annotation in markdown format.\n */\nexport default function MarkdownEditor({\n  mentionsEnabled = false,\n  label,\n  onEditText = () => {},\n  text,\n  textStyle = {},\n  showHelpLink = true,\n  usersForMentions,\n  mentions,\n  mentionMode,\n  onInsertMentionSuggestion,\n}: MarkdownEditorProps) {\n  // Whether the preview mode is currently active.\n  const [preview, setPreview] = useState(false);\n\n  // The input element where the user inputs their comment.\n  const input = useRef<HTMLTextAreaElement>(null);\n\n  const textWithoutMentionTags = useMemo(\n    () => unwrapMentions({ text, mentionMode, mentions }),\n    [mentionMode, mentions, text],\n  );\n\n  useEffect(() => {\n    if (!preview) {\n      input.current?.focus();\n    }\n  }, [preview]);\n\n  const togglePreview = () => setPreview(!preview);\n\n  const handleCommand = (command: Command) => {\n    if (input.current) {\n      handleToolbarCommand(command, input.current);\n      onEditText(input.current.value);\n    }\n  };\n\n  const handleKeyDown = (event: KeyboardEvent) => {\n    if (!event.ctrlKey && !event.metaKey) {\n      return;\n    }\n\n    for (const [command, key] of Object.entries(SHORTCUT_KEYS)) {\n      if (key === event.key) {\n        event.stopPropagation();\n        event.preventDefault();\n        handleCommand(command as Command);\n      }\n    }\n  };\n\n  return (\n    <div className=\"leading-none\">\n      <Toolbar\n        onCommand={handleCommand}\n        isPreviewing={preview}\n        onTogglePreview={togglePreview}\n        showHelpLink={showHelpLink}\n        mentionsEnabled={mentionsEnabled}\n      />\n      {preview ? (\n        <MarkdownView\n          markdown={text}\n          classes=\"border bg-grey-1 p-2\"\n          style={textStyle}\n          mentions={mentions}\n          mentionsEnabled={mentionsEnabled}\n          mentionMode={mentionMode}\n        />\n      ) : (\n        <TextArea\n          aria-label={label}\n          placeholder={label}\n          dir=\"auto\"\n          classes={classnames(\n            'w-full min-h-[8em] resize-y',\n            // Turn off border-radius on top edges to align with toolbar above\n            'rounded-t-none',\n            // Larger font on touch devices\n            'text-base touch:text-touch-base',\n          )}\n          containerRef={input}\n          onKeyDown={handleKeyDown}\n          onEditText={onEditText}\n          value={textWithoutMentionTags}\n          style={textStyle}\n          mentionsEnabled={mentionsEnabled}\n          usersForMentions={usersForMentions}\n          mentionMode={mentionMode}\n          onInsertMentionSuggestion={onInsertMentionSuggestion}\n        />\n      )}\n    </div>\n  );\n}\n","import type { FocusedGroupMembers } from '../store/modules/groups';\nimport type { MentionMode } from './mentions';\n\nexport type UserItem = {\n  /** User ID in the form of acct:[username]@[authority] */\n  userid: string;\n  username: string;\n  displayName: string | null;\n};\n\nexport type UsersForMentions =\n  | { status: 'loading' }\n  | { status: 'loaded'; users: UserItem[] };\n\nexport type CombineUsersOptions = {\n  usersWhoAnnotated: UserItem[];\n  usersWhoWereMentioned: UserItem[];\n  focusedGroupMembers: FocusedGroupMembers;\n  mentionMode: MentionMode;\n};\n\n/**\n * Merge, deduplicate and sort a list of users to be used for mention suggestions.\n * The list includes both users who already annotated the document, and members\n * of the currently focused group.\n *\n * The list is sorted differently depending on the mentionMode:\n * - `username`: By username only, as it's a unique field\n * - `display-name`: By display name first, then by username, in case of same\n *                   display name\n *\n * We won't return any users if the group members are being loaded, preventing a\n * mix of some already-fetched users and a loading indicator from being shown at\n * the same time.\n */\nexport function combineUsersForMentions({\n  usersWhoAnnotated,\n  usersWhoWereMentioned,\n  focusedGroupMembers,\n  mentionMode,\n}: CombineUsersOptions): UsersForMentions {\n  if (focusedGroupMembers.status !== 'loaded') {\n    return { status: 'loading' };\n  }\n\n  // Once group members are loaded, we can merge them with the users who\n  // already annotated the document, then deduplicate and sort the result.\n  const focusedGroupUsers: UserItem[] = focusedGroupMembers.members.map(\n    ({ userid, username, display_name: displayName }) => ({\n      userid,\n      username,\n      displayName,\n    }),\n  );\n  const addedUserIds = new Set<string>();\n  const users = [\n    ...usersWhoAnnotated,\n    ...usersWhoWereMentioned,\n    ...focusedGroupUsers,\n  ]\n    .filter(({ userid }) => {\n      const usernameAlreadyAdded = addedUserIds.has(userid);\n      addedUserIds.add(userid);\n      return !usernameAlreadyAdded;\n    })\n    .sort((a, b) => {\n      if (mentionMode === 'username') {\n        return a.username.localeCompare(b.username);\n      }\n\n      const displayNameA = a.displayName ?? '';\n      const displayNameB = b.displayName ?? '';\n\n      // For display-name mentions, sort by display name first, then by username\n      return (\n        displayNameA.localeCompare(displayNameB, undefined, {\n          sensitivity: 'base',\n        }) || a.username.localeCompare(b.username)\n      );\n    });\n\n  return { status: 'loaded', users };\n}\n\nexport type UsersMatchingMentionOptions = {\n  mentionMode: MentionMode;\n  /** Maximum amount of users to return. Defaults to 10 */\n  maxUsers?: number;\n};\n\n/**\n * Finds the users that match a mention\n */\nexport function usersMatchingMention(\n  mentionToMatch: string | undefined,\n  usersForMentions: UsersForMentions,\n  { mentionMode, maxUsers = 10 }: UsersMatchingMentionOptions,\n): UserItem[] {\n  if (mentionToMatch === undefined || usersForMentions.status === 'loading') {\n    return [];\n  }\n\n  return usersForMentions.users\n    .filter(u => {\n      if (!mentionToMatch) {\n        // Match all users if the active mention is empty, which happens right\n        // after typing `@`\n        return true;\n      }\n\n      const displayName = u.displayName ?? '';\n      const contentToMatch =\n        mentionMode === 'username'\n          ? `${u.username} ${displayName}`\n          : displayName;\n\n      return contentToMatch.match(new RegExp(mentionToMatch, 'i'));\n    })\n    .slice(0, maxUsers);\n}\n","import { Card } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useMemo } from 'preact/hooks';\n\nimport MenuArrow from './MenuArrow';\n\nconst defaultListFormatter = <Item,>(item: Item) => item;\n\nexport type AutocompleteListProps<Item> = {\n  /**\n   * The index of the highlighted item in the `list` of items. Defaults to `-1`\n   * (no item selected)\n   */\n  activeItem?: number;\n\n  /**\n   * Optional unique HTML attribute id. This can be used for parent\n   * `aria-controls` coupling.\n   */\n  id?: string;\n\n  /**\n   * Optional unique HTML attribute id prefix for each item in the list. The\n   * final value of each items' id is `{itemPrefixId}{activeItem}`\n   */\n  itemPrefixId?: string;\n\n  /**\n   * The list of items to render. This can be a simple list of strings or a list\n   * of objects when used with listFormatter.\n   */\n  list: Item[];\n\n  /**\n   * An optional formatter to render each item inside an <li> tag This is useful\n   * if the list is an array of objects rather than just strings.\n   */\n  listFormatter?: (item: Item, index?: number) => any;\n\n  /** Callback when an item is clicked */\n  onSelectItem: (item: Item) => void;\n\n  /** Is the AutocompleteList currently open (visible)? */\n  open?: boolean;\n};\n\n/**\n * Custom autocomplete component. Use this in conjunction with an <input> field.\n * To make this component W3 accessibility compliant, it is is intended to be\n * coupled to an <input> field or the TagEditor component and can not be\n * used by itself.\n *\n * Modeled after the \"ARIA 1.1 Combobox with Listbox Popup\"\n */\nexport default function AutocompleteList<Item>({\n  activeItem = -1,\n  id,\n  itemPrefixId,\n  list,\n  listFormatter = defaultListFormatter,\n  onSelectItem,\n  open = false,\n}: AutocompleteListProps<Item>) {\n  const items = useMemo(() => {\n    return list.map((item, index) => {\n      // only add an id if itemPrefixId is passed\n      const props = itemPrefixId ? { id: `${itemPrefixId}${index}` } : {};\n\n      return (\n        // The parent <input> field should capture keyboard events\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <li\n          key={`AutocompleteList-${index}`}\n          role=\"option\"\n          aria-selected={activeItem === index}\n          className={classnames(\n            'flex items-center',\n            'border-l-4 py-1 px-3 cursor-pointer hover:bg-grey-2',\n            'touch:h-touch-minimum',\n            {\n              'border-brand bg-grey-1': activeItem === index,\n              'border-transparent': activeItem !== index,\n            },\n          )}\n          onClick={() => {\n            onSelectItem(item);\n          }}\n          {...props}\n        >\n          {listFormatter(item, index)}\n        </li>\n      );\n    });\n  }, [activeItem, itemPrefixId, list, listFormatter, onSelectItem]);\n\n  const props = id ? { id } : {}; // only add the id if its passed\n  const isHidden = list.length === 0 || !open;\n  return (\n    <div className=\"relative\">\n      <div\n        className={classnames(\n          { hidden: isHidden },\n          // Move the Card down a bit to make room for the up-pointing arrow\n          'absolute top-[3px] z-3',\n          // Ensure Card width is not too narrow\n          'min-w-[10em]',\n        )}\n        data-testid=\"autocomplete-list-container\"\n      >\n        <Card width=\"auto\" classes=\"overflow-hidden\">\n          <ul tabIndex={-1} aria-label=\"Suggestions\" role=\"listbox\" {...props}>\n            {items}\n          </ul>\n          <MenuArrow direction=\"up\" classes=\"top-[-8px] left-2\" />\n        </Card>\n      </div>\n    </div>\n  );\n}\n","import { usePopoverShouldClose } from '@hypothesis/frontend-shared';\nimport { Input } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useRef, useState } from 'preact/hooks';\n\nimport { withServices } from '../service-context';\nimport type { TagsService } from '../services/tags';\nimport AutocompleteList from './AutocompleteList';\nimport TagList from './TagList';\nimport TagListItem from './TagListItem';\n\n// Global counter used to create a unique id for each instance of a TagEditor\nlet tagEditorIdCounter = 0;\n\nexport type TagEditorProps = {\n  onAddTag: (tag: string) => boolean;\n  onRemoveTag: (tag: string) => boolean;\n  onTagInput: (tag: string) => void;\n  tagList: string[];\n\n  // injected\n  tags: TagsService;\n};\n/**\n * Component to edit annotation's tags.\n *\n * Component accessibility is modeled after \"Combobox with Listbox Autocomplete Example\" found here:\n * https://www.w3.org/WAI/ARIA/apg/example-index/combobox/combobox-autocomplete-list.html\n */\nfunction TagEditor({\n  onAddTag,\n  onRemoveTag,\n  onTagInput,\n  tagList,\n  tags: tagsService,\n}: TagEditorProps) {\n  const inputEl = useRef<HTMLInputElement>();\n  const [suggestions, setSuggestions] = useState([] as string[]);\n  const [activeItem, setActiveItem] = useState(-1); // -1 is unselected\n  const [suggestionsListOpen, setSuggestionsListOpen] = useState(false);\n  const [tagEditorId] = useState(() => {\n    ++tagEditorIdCounter;\n    return `TagEditor-${tagEditorIdCounter}`;\n  });\n\n  // Set up callback to monitor outside click events to close the AutocompleteList\n  const closeWrapperRef = useRef<HTMLDivElement>(null);\n  usePopoverShouldClose(closeWrapperRef, () => setSuggestionsListOpen(false), {\n    enabled: suggestionsListOpen,\n  });\n\n  /**\n   * Retrieve the current trimmed text value of the tag <input>\n   */\n  const pendingTag = () => inputEl.current!.value.trim();\n  const hasPendingTag = () => pendingTag() && pendingTag().length > 0;\n  const clearPendingTag = () => {\n    inputEl.current!.value = '';\n    onTagInput?.('');\n  };\n\n  /**\n   * Helper function that returns a list of suggestions less any\n   * results also found from the duplicates list.\n   */\n  const removeDuplicates = (suggestions: string[], duplicates: string[]) => {\n    const suggestionsSet = [];\n    for (const suggestion of suggestions) {\n      if (duplicates.indexOf(suggestion) < 0) {\n        suggestionsSet.push(suggestion);\n      }\n    }\n    return suggestionsSet.sort();\n  };\n\n  /**\n   * Get a list of suggestions returned from the tagsService\n   * reset the activeItem and open the AutocompleteList\n   */\n  const updateSuggestions = () => {\n    if (!hasPendingTag()) {\n      // If there is no input, just hide the suggestions\n      setSuggestionsListOpen(false);\n    } else {\n      // Call filter() with a query value to return all matching suggestions.\n      const suggestions = tagsService.filter(pendingTag());\n      // Remove any repeated suggestions that are already tags\n      // and set those to state.\n      setSuggestions(removeDuplicates(suggestions, tagList));\n      setSuggestionsListOpen(suggestions.length > 0);\n    }\n    setActiveItem(-1);\n  };\n\n  /**\n   * Invokes callback to add tag. If the tag was added, close the suggestions\n   * list, clear the field content and maintain focus.\n   */\n  const addTag = (newTag: string) => {\n    if (onAddTag(newTag)) {\n      setSuggestionsListOpen(false);\n      setActiveItem(-1);\n\n      clearPendingTag();\n      inputEl.current!.focus();\n    }\n  };\n\n  const handleOnInput = () => {\n    onTagInput?.(pendingTag());\n    updateSuggestions();\n  };\n\n  /**\n   *  Callback when the user clicked one of the items in the suggestions list.\n   *  This will add a new tag.\n   */\n  const handleSelect = (item: string) => {\n    if (item) {\n      addTag(item);\n    }\n  };\n\n  /**\n   * Opens the AutocompleteList on focus if there is a value in the input\n   */\n  const handleFocus = () => {\n    if (hasPendingTag()) {\n      setSuggestionsListOpen(true);\n    }\n  };\n\n  /**\n   *  Called when the user uses keyboard navigation to move\n   *  up or down the suggestions list creating a highlighted\n   *  item.\n   *\n   *  The first value in the list is an unselected value (-1).\n   *  A user can arrive at this value by pressing the up arrow back to\n   *  the beginning or the down arrow until the end.\n   *\n   * @param {number} direction - Pass 1 for the next item or -1 for the previous\n   */\n  const changeSelectedItem = (direction: -1 | 1) => {\n    let nextActiveItem = activeItem + direction;\n    if (nextActiveItem < -1) {\n      nextActiveItem = suggestions.length - 1;\n    } else if (nextActiveItem >= suggestions.length) {\n      nextActiveItem = -1;\n    }\n    setActiveItem(nextActiveItem);\n  };\n\n  /**\n   * Keydown handler for keyboard navigation of the tag editor field and the\n   * suggested-tags list.\n   */\n  const handleKeyDown = (e: KeyboardEvent) => {\n    switch (e.key) {\n      case 'ArrowUp':\n        // Select the previous item in the suggestion list\n        changeSelectedItem(-1);\n        e.preventDefault();\n        break;\n      case 'ArrowDown':\n        // Select the next item in the suggestion list\n        changeSelectedItem(1);\n        e.preventDefault();\n        break;\n      case 'Escape':\n        // Clear any entered text, but retain focus\n        clearPendingTag();\n        e.preventDefault();\n        break;\n      case 'Enter':\n      case ',':\n        // Commit a tag\n        if (activeItem === -1) {\n          // nothing selected, just add the typed text\n          addTag(pendingTag());\n        } else {\n          // Add the selected tag\n          addTag(suggestions[activeItem]);\n        }\n        e.preventDefault();\n        break;\n      case 'Tab':\n        // Commit a tag, or tab out of the field if it is empty (default browser\n        // behavior)\n        if (!hasPendingTag()) {\n          // If the tag field is empty, allow `Tab` to have its default\n          // behavior: continue to the next element in tab order\n          break;\n        }\n        if (activeItem !== -1) {\n          // If there is a selected item in the suggested tag list,\n          // commit that tag (just like `Enter` and `,` in this case)\n          addTag(suggestions[activeItem]);\n        } else if (suggestions.length === 1) {\n          // If there is exactly one suggested tag match, commit that tag\n          // This emulates a \"tab-complete\" behavior\n          addTag(suggestions[0]);\n        } else {\n          // Commit the tag as typed in the field\n          addTag(pendingTag());\n        }\n        // Retain focus\n        e.preventDefault();\n        break;\n    }\n  };\n\n  /**\n   * Callback for formatting a suggested tag item. Use selective bolding\n   * to help delineate which part of the entered tag text matches the\n   * suggestion.\n   */\n  const formatSuggestedItem = (item: string) => {\n    // filtering of tags is case-insensitive\n    const curVal = pendingTag().toLowerCase();\n    const suggestedTag = item.toLowerCase();\n    const matchIndex = suggestedTag.indexOf(curVal);\n\n    // If the current input doesn't seem to match the suggested tag,\n    // just render the tag as-is.\n    if (matchIndex === -1) {\n      return <span>{item}</span>;\n    }\n\n    // Break the suggested tag into three parts:\n    // 1. Substring of the suggested tag that occurs before the match\n    //    with the current input\n    const prefix = item.slice(0, matchIndex);\n    // 2. Substring of the suggested tag that matches the input text. NB:\n    //    This may be in a different case than the input text.\n    const matchString = item.slice(matchIndex, matchIndex + curVal.length);\n    // 3. Substring of the suggested tag that occurs after the matched input\n    const suffix = item.slice(matchIndex + curVal.length);\n\n    return (\n      <span>\n        <strong>{prefix}</strong>\n        {matchString}\n        <strong>{suffix}</strong>\n      </span>\n    );\n  };\n\n  // The activedescendant prop should match the activeItem's value except\n  // when its -1 (no item selected), and in this case set the activeDescendant to \"\".\n  const activeDescendant =\n    activeItem >= 0 ? `${tagEditorId}-AutocompleteList-item-${activeItem}` : '';\n\n  return (\n    <div className=\"space-y-4\">\n      <TagList>\n        {tagList.map(tag => {\n          return <TagListItem key={tag} onRemoveTag={onRemoveTag} tag={tag} />;\n        })}\n      </TagList>\n      <div\n        id={tagEditorId}\n        data-testid=\"combobox-container\"\n        ref={closeWrapperRef}\n      >\n        <Input\n          onInput={handleOnInput}\n          onKeyDown={handleKeyDown}\n          onFocus={handleFocus}\n          elementRef={inputEl}\n          placeholder=\"Add new tags\"\n          type=\"text\"\n          autoComplete=\"off\"\n          aria-autocomplete=\"list\"\n          aria-activedescendant={activeDescendant}\n          aria-controls={`${tagEditorId}-AutocompleteList`}\n          aria-expanded={suggestionsListOpen}\n          aria-label=\"Add tags\"\n          dir=\"auto\"\n          role=\"combobox\"\n          classes={classnames(\n            // Larger font on touch devices\n            'text-base touch:text-touch-base',\n          )}\n        />\n        <AutocompleteList\n          id={`${tagEditorId}-AutocompleteList`}\n          list={suggestions}\n          listFormatter={formatSuggestedItem}\n          open={suggestionsListOpen}\n          onSelectItem={handleSelect}\n          itemPrefixId={`${tagEditorId}-AutocompleteList-item-`}\n          activeItem={activeItem}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default withServices(TagEditor, ['tags']);\n","import { Link, CcStdIcon, CcZeroIcon } from '@hypothesis/frontend-shared';\n\n/**\n * Render information about CC licensing\n */\nexport default function AnnotationLicense() {\n  return (\n    <div className=\"pt-2 border-t text-xs leading-none\">\n      <Link\n        href=\"http://creativecommons.org/publicdomain/zero/1.0/\"\n        target=\"_blank\"\n        title=\"View more information about the Creative Commons Public Domain dedication\"\n        underline=\"none\"\n        variant=\"text-light\"\n      >\n        <div className=\"flex items-center\">\n          <CcStdIcon className=\"w-[10px] h-[10px]\" />\n          <CcZeroIcon className=\"w-[10px] h-[10px] ml-px\" />\n          <div className=\"ml-1\">\n            Annotations can be freely reused by anyone for any purpose.\n          </div>\n        </div>\n      </Link>\n    </div>\n  );\n}\n","import type { ComponentChildren } from 'preact';\nimport { useEffect, useRef } from 'preact/hooks';\n\nfunction isElementVisible(element: HTMLElement) {\n  return element.offsetParent !== null;\n}\n\nexport type MenuKeyboardNavigationProps = {\n  className?: string;\n\n  /** Callback invoked when the menu is closed via a keyboard command. */\n  closeMenu?: (e: KeyboardEvent) => void;\n\n  /**\n   * If true, the first element in children with `role=menuitem` is focused when\n   * this component is mounted.\n   */\n  visible?: boolean;\n\n  /** Content to display, which is typically a list of `<MenuItem>` elements. */\n  children: ComponentChildren;\n};\n\n/**\n * Helper component used by Menu and MenuItem to facilitate keyboard navigation of a\n * list of <MenuItem> components. This component should not be used directly.\n *\n * Note that `ArrowRight` shall be handled by the parent <MenuItem> directly and\n * all other focus() related navigation is handled here.\n */\nexport default function MenuKeyboardNavigation({\n  className,\n  closeMenu,\n  children,\n  visible,\n}: MenuKeyboardNavigationProps) {\n  const menuRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(() => {\n    let focusTimer: number | undefined;\n    if (visible) {\n      focusTimer = setTimeout(() => {\n        // The focus won't work without delaying rendering.\n        const firstItem = menuRef.current!.querySelector(\n          '[role^=\"menuitem\"]',\n        ) as HTMLElement;\n        if (firstItem) {\n          firstItem.focus();\n        }\n      });\n    }\n    return () => {\n      // unmount\n      clearTimeout(focusTimer);\n    };\n  }, [visible]);\n\n  const onKeyDown = (event: KeyboardEvent) => {\n    const menuItems = Array.from(\n      menuRef.current!.querySelectorAll(\n        '[role^=\"menuitem\"]',\n      ) as NodeListOf<HTMLElement>,\n    ).filter(isElementVisible);\n\n    let focusedIndex = menuItems.findIndex(el =>\n      el.contains(document.activeElement),\n    );\n\n    let handled = false;\n\n    switch (event.key) {\n      case 'ArrowLeft':\n      case 'Escape':\n        if (closeMenu) {\n          closeMenu(event);\n          handled = true;\n        }\n        break;\n      case 'ArrowUp':\n        focusedIndex -= 1;\n        if (focusedIndex < 0) {\n          focusedIndex = menuItems.length - 1;\n        }\n        handled = true;\n        break;\n      case 'ArrowDown':\n        focusedIndex += 1;\n        if (focusedIndex === menuItems.length) {\n          focusedIndex = 0;\n        }\n        handled = true;\n        break;\n      case 'Home':\n        focusedIndex = 0;\n        handled = true;\n        break;\n      case 'End':\n        focusedIndex = menuItems.length - 1;\n        handled = true;\n        break;\n    }\n\n    if (handled && focusedIndex >= 0) {\n      event.stopPropagation();\n      event.preventDefault();\n      menuItems[focusedIndex].focus();\n    }\n  };\n\n  return (\n    // This element needs to have role=\"menu\" to facilitate readers\n    // correctly enumerating discrete submenu items, but it also needs\n    // to facilitate keydown events for navigation. Disable the linter\n    // error so it can do both.\n    // eslint-disable-next-line jsx-a11y/interactive-supports-focus\n    <div role=\"menu\" className={className} ref={menuRef} onKeyDown={onKeyDown}>\n      {children}\n    </div>\n  );\n}\n","import { usePopoverShouldClose } from '@hypothesis/frontend-shared';\nimport { MenuExpandIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport type { ComponentChildren } from 'preact';\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks';\n\nimport MenuKeyboardNavigation from './MenuKeyboardNavigation';\n\n/**\n * Flag indicating whether the next click event on the menu's toggle button\n * should be ignored, because the action it would trigger has already been\n * triggered by a preceding \"mousedown\" event.\n */\nlet ignoreNextClick = false;\n\nexport type MenuProps = {\n  /**\n   * Whether the menu content is aligned with the left (default) or right edges\n   * of the toggle element.\n   */\n  align?: 'left' | 'right';\n\n  /**\n   * Label element or string for the toggle button that hides and shows the menu\n   */\n  label: ComponentChildren;\n\n  /** Menu content, typically `MenuSection` and `MenuItem` components  */\n  children: ComponentChildren;\n\n  /**\n   * Whether the menu elements should be positioned relative to the Menu\n   * container. When `false`, the consumer is responsible for positioning.\n   */\n  containerPositioned?: boolean;\n\n  /** Additional CSS classes to apply to the Menu */\n  contentClass?: string;\n\n  /**\n   * Whether the menu is open when initially rendered. Ignored if `open` is\n   * present.\n   */\n  defaultOpen?: boolean;\n\n  disabled?: boolean;\n\n  /** Whether to render an (arrow) indicator next to the Menu label */\n  menuIndicator?: boolean;\n\n  /** Callback when the Menu is opened or closed. */\n  onOpenChanged?: (open: boolean) => void;\n\n  /**\n   * Whether the Menu is currently open, when the Menu is being used as a\n   * controlled component. In these cases, an `onOpenChanged` handler should\n   * be provided to respond to the user opening or closing the menu.\n   */\n  open?: boolean;\n\n  /**\n   * A title for the menu. This is important for accessibility if the menu's\n   * toggle button has only an icon as a label.\n   */\n  title: string;\n};\n\nconst noop = () => {};\n\n/**\n * A drop-down menu.\n *\n * Menus consist of a button which toggles whether the menu is open, an\n * an arrow indicating the state of the menu and content when is shown when\n * the menu is open. The children of the menu component are rendered as the\n * content of the menu when open. Typically this consists of a list of\n * `MenuSection` and/or `MenuItem` components.\n *\n * @example\n *   <Menu label=\"Preferences\">\n *     <MenuItem label=\"View\" onClick={showViewSettings}/>\n *     <MenuItem label=\"Theme\" onClick={showThemeSettings}/>\n *     <MenuSection>\n *       <MenuItem label=\"Log out\"/>\n *     </MenuSection>\n *   </Menu>\n */\nexport default function Menu({\n  align = 'left',\n  children,\n  containerPositioned = true,\n  contentClass,\n  defaultOpen = false,\n  disabled = false,\n  label,\n  open,\n  onOpenChanged,\n  menuIndicator = true,\n  title,\n}: MenuProps) {\n  let [isOpen, setOpen]: [boolean, (open: boolean) => void] =\n    useState(defaultOpen);\n  if (typeof open === 'boolean') {\n    isOpen = open;\n    setOpen = onOpenChanged || noop;\n  }\n\n  // Notify parent when menu is opened or closed.\n  const wasOpen = useRef(isOpen);\n  useEffect(() => {\n    if (typeof onOpenChanged === 'function' && wasOpen.current !== isOpen) {\n      wasOpen.current = isOpen;\n      onOpenChanged(isOpen);\n    }\n  }, [isOpen, onOpenChanged]);\n\n  /**\n   * Toggle menu when user presses toggle button. The menu is shown on mouse\n   * press for a more responsive/native feel but also handles a click event for\n   * activation via other input methods.\n   */\n  const toggleMenu = (event: Event) => {\n    // If the menu was opened on press, don't close it again on the subsequent\n    // mouse up (\"click\") event.\n    if (event.type === 'mousedown') {\n      ignoreNextClick = true;\n    } else if (event.type === 'click' && ignoreNextClick) {\n      // Ignore \"click\" event triggered from the mouse up action.\n      ignoreNextClick = false;\n      event.stopPropagation();\n      event.preventDefault();\n      return;\n    }\n\n    setOpen(!isOpen);\n  };\n  const closeMenu = useCallback(() => setOpen(false), [setOpen]);\n\n  // Set up an effect which adds document-level event handlers when the menu\n  // is open and removes them when the menu is closed or removed.\n  //\n  // These handlers close the menu when the user taps or clicks outside the\n  // menu or presses Escape.\n  const menuRef = useRef<HTMLDivElement | null>(null);\n\n  // Menu element should close via `closeMenu` whenever it's open and there\n  // are user interactions outside of it (e.g. clicks) in the document\n  usePopoverShouldClose(menuRef, closeMenu, { enabled: isOpen });\n\n  const stopPropagation = (e: Event) => e.stopPropagation();\n\n  // It should also close if the user presses a key which activates menu items.\n  const handleMenuKeyDown = (event: KeyboardEvent) => {\n    const key = event.key;\n    if (key === 'Enter' || key === ' ') {\n      // The browser will not open the link if the link element is removed\n      // from within the keypress event that triggers it. Add a little\n      // delay to work around that.\n      setTimeout(() => {\n        closeMenu();\n      });\n    }\n  };\n\n  const containerStyle = {\n    position: containerPositioned ? 'relative' : 'static',\n  };\n\n  return (\n    // See https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/no-static-element-interactions.md#case-the-event-handler-is-only-being-used-to-capture-bubbled-events\n    // eslint-disable-next-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events\n    <div\n      className=\"relative\"\n      data-testid=\"menu-container\"\n      ref={menuRef}\n      // Add inline styles for positioning\n      style={containerStyle}\n      // Don't close the menu if the mouse is released over one of the menu\n      // elements outside the content area (eg. the arrow at the top of the\n      // content).\n      onClick={stopPropagation}\n      // Don't close the menu if the user presses the mouse down on menu elements\n      // except for the toggle button.\n      onMouseDown={stopPropagation}\n    >\n      <button\n        aria-expanded={isOpen ? 'true' : 'false'}\n        aria-haspopup={true}\n        className={classnames(\n          'focus-visible-ring',\n          'flex items-center justify-center rounded transition-colors',\n          {\n            'text-grey-7 hover:text-grey-9': !isOpen,\n            'text-brand': isOpen,\n          },\n        )}\n        data-testid=\"menu-toggle-button\"\n        disabled={disabled}\n        onMouseDown={toggleMenu}\n        onClick={toggleMenu}\n        aria-label={title}\n        title={title}\n      >\n        <span\n          // wrapper is needed to serve as the flex layout for the label and indicator content.\n          className=\"flex items-center gap-x-1\"\n        >\n          {label}\n          {menuIndicator && (\n            <span\n              className={classnames({\n                'rotate-180 text-color-text': isOpen,\n              })}\n            >\n              <MenuExpandIcon className=\"w-2.5 h-2.5\" />\n            </span>\n          )}\n        </span>\n      </button>\n      {isOpen && (\n        <div\n          className={classnames(\n            'focus-visible-ring',\n            // Position menu content near bottom of menu label/toggle control\n            'absolute top-[calc(100%+3px)] z-1',\n            'border shadow-intense rounded-lg overflow-hidden bg-white text-md',\n            {\n              'left-0': align === 'left',\n              'right-0': align === 'right',\n            },\n            contentClass,\n          )}\n          data-testid=\"menu-content\"\n          role=\"menu\"\n          tabIndex={-1}\n          onClick={closeMenu}\n          onKeyDown={handleMenuKeyDown}\n        >\n          <MenuKeyboardNavigation visible={true}>\n            {children}\n          </MenuKeyboardNavigation>\n        </div>\n      )}\n    </div>\n  );\n}\n","import {\n  MenuCollapseIcon,\n  MenuExpandIcon,\n  Slider,\n} from '@hypothesis/frontend-shared';\nimport type { IconComponent } from '@hypothesis/frontend-shared/lib/types';\nimport classnames from 'classnames';\nimport type { ComponentChildren, Ref } from 'preact';\nimport { useEffect, useRef } from 'preact/hooks';\n\nimport MenuKeyboardNavigation from './MenuKeyboardNavigation';\n\ntype SubmenuToggleProps = {\n  title: string;\n  isExpanded: boolean;\n  onToggleSubmenu?: (e: Event) => void;\n};\n\nfunction SubmenuToggle({\n  title,\n  isExpanded,\n  onToggleSubmenu,\n}: SubmenuToggleProps) {\n  const Icon = isExpanded ? MenuCollapseIcon : MenuExpandIcon;\n  return (\n    <div\n      data-testid=\"submenu-toggle\"\n      // We should not have a <button> inside of the menu item itself\n      // but we have a non-standard mechanism with the toggle control\n      // requiring an onClick event nested inside a \"menuitemradio|menuitem\".\n      // Therefore, a static element with a role=\"none\" is necessary here.\n      role=\"none\"\n      className={classnames(\n        // Center content in a 40px square. The entire element is clickable\n        'flex flex-col items-center justify-center w-10 h-10',\n        'text-grey-6 bg-grey-1',\n        // Clip the background (color) such that it only shows within the\n        // content box, which is a 24px rounded square formed by the large\n        // borders\n        'bg-clip-content border-[8px] border-transparent rounded-xl',\n        // When the menu item is hovered AND this element is hovered, darken\n        // the text color so it is clear that the toggle is the hovered element\n        'group-hover:hover:text-grey-8',\n        {\n          // When the submenu is expanded, this element always has a darker\n          // background color regardless of hover state.\n          'bg-grey-4': isExpanded,\n          // When the parent menu item is hovered, it gets a darker background.\n          // Make the toggle background darker also.\n          'group-hover:bg-grey-3': !isExpanded,\n        },\n      )}\n      onClick={onToggleSubmenu}\n      title={title}\n    >\n      <Icon className=\"w-3 h-3\" viewBox=\"0 0 16 16\" />\n    </div>\n  );\n}\n\nexport type MenuItemProps = {\n  /**\n   * URL of the external link to open when this item is clicked. Either the\n   * `href` or an `onClick` callback should be supplied.\n   */\n  href?: string;\n\n  /**\n   * Icon to render for this item. This will show to the left of the item label\n   * unless this is a submenu item, in which case it goes on the right. Ignored\n   * if this is not a submenu item and `leftChannelContent` is also provided.\n   */\n  icon?: IconComponent;\n\n  /**\n   * Dim the label to indicate that this item is not currently available.  The\n   * `onClick` callback will still be invoked when this item is clicked and the\n   * submenu, if any, can still be toggled.\n   */\n  isDisabled?: boolean;\n\n  /** Indicates that the submenu associated with this item is currently open */\n  isExpanded?: boolean;\n\n  /**\n   * Display an indicator to show that this menu item represents something which\n   * is currently selected/active/focused.\n   */\n  isSelected?: boolean;\n\n  /**\n   * True if this item is part of a submenu, in which case it is rendered with a\n   * different style (shaded background)\n   */\n  isSubmenuItem?: boolean;\n\n  /**\n   * If present, display a button to toggle the sub-menu associated with this\n   * item and indicate the current state; `true` if the submenu is visible.\n   * Note. Omit this prop, or set it to null, if there is no `submenu`.\n   */\n  isSubmenuVisible?: boolean;\n\n  label: ComponentChildren;\n\n  /**\n   * Optional content to render into a left channel. This accommodates small\n   * non-icon images or spacing and will supersede any provided icon if this\n   * is not a submenu item.\n   */\n  leftChannelContent?: ComponentChildren;\n\n  onClick?: (e: Event) => void;\n  onToggleSubmenu?: (e: Event) => void;\n\n  /**\n   * Contents of the submenu for this item.  This is typically a list of\n   * `MenuItem` components with the `isSubmenuItem` prop set to `true`, but can\n   * include other content as well. The submenu is only rendered if\n   * `isSubmenuVisible` is `true`.\n   */\n  submenu?: ComponentChildren;\n\n  /**\n   * Custom title for the submenu toggle button.\n   * Omit this prop if there is no submenu.\n   */\n  submenuToggleTitle?: string;\n};\n\n/**\n * An item in a dropdown menu.\n *\n * Dropdown menu items display an icon, a label and can optionally have a submenu\n * associated with them.\n *\n * When clicked, menu items either open an external link, if the `href` prop\n * is provided, or perform a custom action via the `onClick` callback.\n *\n * The icon can either be an external SVG image, referenced by URL, or the\n * name of an icon registered in the application.\n *\n * For items that have submenus, the `MenuItem` will call the `renderSubmenu`\n * prop to render the content of the submenu, when the submenu is visible.\n * Note that the `submenu` is not supported for link (`href`) items.\n */\nexport default function MenuItem({\n  href,\n  icon: Icon,\n  isDisabled,\n  isExpanded,\n  isSelected,\n  isSubmenuItem,\n  isSubmenuVisible,\n  label,\n  leftChannelContent,\n  onClick,\n  onToggleSubmenu,\n  submenu,\n  submenuToggleTitle,\n}: MenuItemProps) {\n  const menuItemRef = useRef<HTMLAnchorElement | HTMLDivElement | null>(null);\n\n  let focusTimer: number | undefined;\n\n  // menuItem can be either a link or a button\n  let menuItem;\n  const hasSubmenuVisible = typeof isSubmenuVisible === 'boolean';\n  const isRadioButtonType = typeof isSelected === 'boolean';\n\n  useEffect(() => {\n    return () => {\n      // unmount\n      clearTimeout(focusTimer);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onCloseSubmenu = (event: Event) => {\n    if (onToggleSubmenu) {\n      onToggleSubmenu(event);\n    }\n    // The focus won't work without delaying rendering.\n    focusTimer = setTimeout(() => {\n      menuItemRef.current!.focus();\n    });\n  };\n\n  const onKeyDown = (event: KeyboardEvent) => {\n    switch (event.key) {\n      case 'ArrowRight':\n        if (onToggleSubmenu) {\n          event.stopPropagation();\n          event.preventDefault();\n          onToggleSubmenu(event);\n        }\n        break;\n      case 'Enter':\n      case ' ':\n        if (onClick) {\n          // Let event propagate so the menu closes\n          onClick(event);\n        }\n    }\n  };\n\n  const renderedIcon = Icon ? <Icon className=\"h-3 w-3\" /> : null;\n  const leftIcon = !isSubmenuItem ? renderedIcon : null;\n  const rightIcon = isSubmenuItem ? renderedIcon : null;\n\n  const hasLeftChannel = leftChannelContent || isSubmenuItem || !!leftIcon;\n  const hasRightContent = !!rightIcon;\n\n  const menuItemContent = (\n    <>\n      {hasLeftChannel && (\n        <div\n          className=\"w-7 flex items-center justify-center\"\n          data-testid=\"left-item-container\"\n        >\n          {leftChannelContent ?? leftIcon}\n        </div>\n      )}\n      <span className=\"flex items-center grow whitespace-nowrap px-1\">\n        {label}\n      </span>\n      {hasRightContent && (\n        <div\n          className=\"w-8 flex items-center justify-center\"\n          data-testid=\"right-item-container\"\n        >\n          {rightIcon}\n        </div>\n      )}\n      {hasSubmenuVisible && (\n        <SubmenuToggle\n          title={\n            submenuToggleTitle ??\n            (typeof label === 'string'\n              ? `Show actions for ${label}`\n              : `Toggle submenu`)\n          }\n          isExpanded={isSubmenuVisible}\n          onToggleSubmenu={onToggleSubmenu}\n        />\n      )}\n    </>\n  );\n\n  const wrapperClasses = classnames(\n    'focus-visible-ring ring-inset',\n    'w-full min-w-[150px] flex items-center select-none',\n    'rounded-none',\n    {\n      'focus-visible:rounded-lg': !isSelected,\n      'focus-visible:rounded-r-lg': isSelected,\n      'cursor-pointer': !isDisabled,\n    },\n    // Set this container as a \"group\" so that children may style based on its\n    // layout state.\n    // See https://tailwindcss.com/docs/hover-focus-and-other-states#styling-based-on-parent-state\n    'group',\n    {\n      'min-h-[30px] font-normal': isSubmenuItem,\n      'min-h-[40px] font-medium': !isSubmenuItem,\n      'bg-grey-1': isSubmenuItem || isExpanded,\n      'hover:bg-grey-3': !isDisabled && (isSubmenuItem || isExpanded),\n      'bg-white': !isSubmenuItem && !isExpanded,\n      'hover:bg-grey-1': !isDisabled && !isSubmenuItem && !isExpanded,\n      // visual \"padding\" on the right is part of SubmenuToggle when rendered,\n      // but when not rendering a SubmenuToggle, we need to add some padding here\n      'pr-1': !hasSubmenuVisible,\n    },\n    {\n      // When the item is selected, show a left border to indicate it\n      'border-l-[4px] border-l-brand': isSelected,\n      // Add equivalent padding to border size when not selected. This instead\n      // of a transparent left border to make focus ring cover the full\n      // menu item. Otherwise the focus ring will be inset on the left too far.\n      'pl-[4px]': !isSelected,\n      'text-color-text-light': isDisabled,\n      'text-color-text hover:text-color-text': !isDisabled,\n    },\n  );\n\n  if (href) {\n    // The menu item is a link\n    menuItem = (\n      <a\n        ref={menuItemRef as Ref<HTMLAnchorElement>}\n        className={wrapperClasses}\n        data-testid=\"menu-item\"\n        href={href}\n        target=\"_blank\"\n        tabIndex={-1}\n        rel=\"noopener noreferrer\"\n        role=\"menuitem\"\n        onKeyDown={onKeyDown}\n      >\n        {menuItemContent}\n      </a>\n    );\n  } else {\n    // The menu item is a clickable button or radio button.\n    // In either case there may be an optional submenu.\n    menuItem = (\n      <div\n        ref={menuItemRef as Ref<HTMLDivElement>}\n        className={wrapperClasses}\n        data-testid=\"menu-item\"\n        tabIndex={-1}\n        onKeyDown={onKeyDown}\n        onClick={onClick}\n        role={isRadioButtonType ? 'menuitemradio' : 'menuitem'}\n        aria-checked={isRadioButtonType ? isSelected : undefined}\n        aria-haspopup={hasSubmenuVisible}\n        aria-expanded={hasSubmenuVisible ? isSubmenuVisible : undefined}\n      >\n        {menuItemContent}\n      </div>\n    );\n  }\n  return (\n    <>\n      {menuItem}\n      {hasSubmenuVisible && (\n        <Slider direction={isSubmenuVisible ? 'in' : 'out'}>\n          <MenuKeyboardNavigation\n            closeMenu={onCloseSubmenu}\n            visible={isSubmenuVisible}\n            className=\"border-y border-grey-3\"\n          >\n            {submenu}\n          </MenuKeyboardNavigation>\n        </Slider>\n      )}\n    </>\n  );\n}\n","import {\n  Button,\n  CancelIcon,\n  GlobeIcon,\n  GroupsIcon,\n  LockFilledIcon,\n  MenuExpandIcon,\n} from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nimport type { Group } from '../../../types/api';\nimport type { SidebarSettings } from '../../../types/config';\nimport { applyTheme } from '../../helpers/theme';\nimport { withServices } from '../../service-context';\nimport Menu from '../Menu';\nimport MenuItem from '../MenuItem';\n\nexport type AnnotationPublishControlProps = {\n  /** The group this annotation or draft would publish to */\n  group: Group;\n\n  /**\n   * Should the save button be disabled? Hint: it will be if the annotation has\n   * no content\n   */\n  isDisabled?: boolean;\n\n  /** Annotation or draft is \"Only Me\" */\n  isPrivate: boolean;\n\n  /** Callback for cancel button click */\n  onCancel: () => void;\n\n  /** Callback for save button click */\n  onSave: () => void;\n\n  /** Callback when privacy level is changed (publish to group vs. Only me) */\n  onSetPrivate: (isPrivate: boolean) => void;\n\n  // Injected\n  settings: SidebarSettings;\n};\n\n/**\n * Render a compound control button for publishing (saving) an annotation:\n * - Save the annotation — left side of button\n * - Choose sharing/privacy option - drop-down menu on right side of button\n *\n * @param {AnnotationPublishControlProps} props\n */\nfunction AnnotationPublishControl({\n  group,\n  isDisabled,\n  isPrivate,\n  onCancel,\n  onSave,\n  onSetPrivate,\n  settings,\n}: AnnotationPublishControlProps) {\n  const buttonStyle = applyTheme(\n    ['ctaTextColor', 'ctaBackgroundColor'],\n    settings,\n  );\n\n  const menuLabel = (\n    <div\n      className=\"w-9 h-9 flex items-center justify-center text-color-text-inverted\"\n      style={buttonStyle}\n    >\n      <MenuExpandIcon className=\"w-4 h-4\" />\n    </div>\n  );\n\n  return (\n    <div className=\"flex flex-row gap-x-3\">\n      <div className=\"flex relative\">\n        <Button\n          classes={classnames(\n            // Turn off right-side border radius to align with menu-open button\n            'rounded-r-none',\n          )}\n          data-testid=\"publish-control-button\"\n          style={buttonStyle}\n          onClick={onSave}\n          disabled={isDisabled}\n          size=\"lg\"\n          variant=\"primary\"\n        >\n          Post to {isPrivate ? 'Only Me' : group.name}\n        </Button>\n        {/* This wrapper div is necessary because of peculiarities with\n             Safari: see https://github.com/hypothesis/client/issues/2302 */}\n        <div\n          className={classnames(\n            // Round the right side of this menu-open button only\n            'flex flex-row rounded-r bg-grey-7 hover:bg-grey-8',\n          )}\n          style={buttonStyle}\n        >\n          <Menu\n            containerPositioned={false}\n            contentClass={classnames(\n              // Ensure the menu is wide enough to \"reach\" the right-aligned\n              // up-pointing menu arrow\n              'min-w-full',\n            )}\n            label={menuLabel}\n            menuIndicator={false}\n            title=\"Change annotation sharing setting\"\n            align=\"left\"\n          >\n            <MenuItem\n              icon={group.type === 'open' ? GlobeIcon : GroupsIcon}\n              label={group.name}\n              isSelected={!isPrivate}\n              onClick={() => onSetPrivate(false)}\n            />\n            <MenuItem\n              icon={LockFilledIcon}\n              label=\"Only Me\"\n              isSelected={isPrivate}\n              onClick={() => onSetPrivate(true)}\n            />\n          </Menu>\n        </div>\n      </div>\n      <div>\n        <Button data-testid=\"cancel-button\" onClick={onCancel} size=\"lg\">\n          <CancelIcon />\n          Cancel\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default withServices(AnnotationPublishControl, ['settings']);\n","import {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'preact/hooks';\n\nimport type { Annotation } from '../../../types/api';\nimport type { SidebarSettings } from '../../../types/config';\nimport { serviceConfig } from '../../config/service-config';\nimport { isThirdPartyUser } from '../../helpers/account-id';\nimport {\n  annotationRole,\n  isReply,\n  isSaved,\n} from '../../helpers/annotation-metadata';\nimport type { UserItem } from '../../helpers/mention-suggestions';\nimport { combineUsersForMentions } from '../../helpers/mention-suggestions';\nimport type { MentionMode } from '../../helpers/mentions';\nimport { applyTheme } from '../../helpers/theme';\nimport { withServices } from '../../service-context';\nimport type { AnnotationsService } from '../../services/annotations';\nimport type { GroupsService } from '../../services/groups';\nimport type { TagsService } from '../../services/tags';\nimport type { ToastMessengerService } from '../../services/toast-messenger';\nimport { useSidebarStore } from '../../store';\nimport type { Draft } from '../../store/modules/drafts';\nimport MarkdownEditor from '../MarkdownEditor';\nimport TagEditor from '../TagEditor';\nimport AnnotationLicense from './AnnotationLicense';\nimport AnnotationPublishControl from './AnnotationPublishControl';\n\ntype AnnotationEditorProps = {\n  /** The annotation under edit */\n  annotation: Annotation;\n  /** The annotation's draft */\n  draft: Draft;\n\n  // Injected\n  annotationsService: AnnotationsService;\n  groups: GroupsService;\n  settings: SidebarSettings;\n  toastMessenger: ToastMessengerService;\n  tags: TagsService;\n};\n\n/**\n * Display annotation content in an editable format.\n */\nfunction AnnotationEditor({\n  annotation,\n  draft,\n  annotationsService,\n  groups: groupsService,\n  settings,\n  tags: tagsService,\n  toastMessenger,\n}: AnnotationEditorProps) {\n  // Track the currently-entered text in the tag editor's input\n  const [pendingTag, setPendingTag] = useState<string | null>(null);\n\n  const store = useSidebarStore();\n  const group = store.getGroup(annotation.group);\n  const isReplyAnno = useMemo(() => isReply(annotation), [annotation]);\n\n  const shouldShowLicense =\n    !draft.isPrivate && group && group.type !== 'private';\n\n  // When the Help panel is disabled, also hide other help links in the app\n  // which link to external websites.\n  const showHelpLink = serviceConfig(settings)?.enableHelpPanel ?? true;\n\n  const tags = draft.tags;\n  const text = draft.text;\n  const isEmpty = !text && !tags.length;\n\n  const onEditTags = useCallback(\n    (tags: string[]) => {\n      store.createDraft(draft.annotation, { ...draft, tags });\n    },\n    [draft, store],\n  );\n\n  const onAddTag = useCallback(\n    /**\n     * Verify `newTag` has content and is not a duplicate; add the tag\n     *\n     * @return `true` if tag was added to the draft; `false` if duplicate or\n     * empty\n     */\n    (newTag: string) => {\n      if (!newTag || tags.indexOf(newTag) >= 0) {\n        // don't add empty or duplicate tags\n        return false;\n      }\n      const tagList = [...tags, newTag];\n      // Update the tag locally for the suggested-tag list\n      tagsService.store(tagList);\n      onEditTags(tagList);\n      return true;\n    },\n    [onEditTags, tags, tagsService],\n  );\n\n  const onRemoveTag = useCallback(\n    /**\n     * Remove tag from draft if present.\n     *\n     * @return `true` if tag removed from draft, `false` if tag not found in\n     * draft tags\n     */\n    (tag: string) => {\n      const newTagList = [...tags]; // make a copy\n      const index = newTagList.indexOf(tag);\n      if (index >= 0) {\n        newTagList.splice(index, 1);\n        onEditTags(newTagList);\n        return true;\n      }\n      return false;\n    },\n    [onEditTags, tags],\n  );\n\n  const onEditText = useCallback(\n    (text: string) => {\n      store.createDraft(draft.annotation, { ...draft, text });\n    },\n    [draft, store],\n  );\n\n  const onSetPrivate = useCallback(\n    (isPrivate: boolean) => {\n      store.createDraft(annotation, {\n        ...draft,\n        isPrivate,\n      });\n      // Persist this as privacy default for future annotations unless this is a reply\n      if (!isReplyAnno) {\n        store.setDefault('annotationPrivacy', isPrivate ? 'private' : 'shared');\n      }\n    },\n    [annotation, draft, isReplyAnno, store],\n  );\n\n  const defaultAuthority = store.defaultAuthority();\n  const mentionMode = useMemo(\n    (): MentionMode =>\n      isThirdPartyUser(annotation.user, defaultAuthority)\n        ? 'display-name'\n        : 'username',\n    [annotation.user, defaultAuthority],\n  );\n  // Map to track users that have been mentioned, based on their display name,\n  // so that we can wrap user-name mentions in mention tags when the annotation\n  // is eventually saved.\n  const displayNameToUserMap = useRef<Map<string, UserItem>>(\n    new Map(\n      mentionMode === 'username'\n        ? []\n        : // If the annotation is being edited, it may have mentions. Use them to\n          // initialize the display names map\n          annotation.mentions\n            ?.filter(mention => !!mention.display_name)\n            .map(({ userid, username, display_name: displayName }) => [\n              displayName!,\n              { userid, username, displayName },\n            ]),\n    ),\n  );\n  const onInsertMentionSuggestion = useCallback(\n    (user: UserItem) => {\n      const { displayName } = user;\n      // We need to track the user info for every mention in display-name\n      // mode, so that it is possible to wrap those mentions in tags\n      // afterward.\n      if (displayName && mentionMode === 'display-name') {\n        displayNameToUserMap.current.set(displayName, user);\n      }\n    },\n    [mentionMode],\n  );\n\n  const onSave = async () => {\n    // If there is any content in the tag editor input field that has\n    // not been committed as a tag, go ahead and add it as a tag\n    // See https://github.com/hypothesis/product-backlog/issues/1122\n    if (pendingTag) {\n      onAddTag(pendingTag);\n    }\n    const successMessage = `${annotationRole(annotation)} ${\n      isSaved(annotation) ? 'updated' : 'saved'\n    }`;\n    try {\n      await annotationsService.save(\n        annotation,\n        mentionMode === 'username'\n          ? { mentionMode }\n          : { mentionMode, usersMap: displayNameToUserMap.current },\n      );\n      toastMessenger.success(successMessage, { visuallyHidden: true });\n      displayNameToUserMap.current = new Map();\n    } catch {\n      toastMessenger.error('Saving annotation failed');\n    }\n  };\n\n  // Revert changes to this annotation\n  const onCancel = useCallback(() => {\n    store.removeDraft(annotation);\n    displayNameToUserMap.current = new Map();\n    if (!isSaved(annotation)) {\n      store.removeAnnotations([annotation]);\n    }\n  }, [annotation, store]);\n\n  // Allow saving of annotation by pressing CMD/CTRL-Enter\n  const onKeyDown = (event: KeyboardEvent) => {\n    const key = event.key;\n    if (isEmpty) {\n      return;\n    }\n    if ((event.metaKey || event.ctrlKey) && key === 'Enter') {\n      event.stopPropagation();\n      event.preventDefault();\n      onSave();\n    }\n  };\n\n  const textStyle = applyTheme(['annotationFontFamily'], settings);\n\n  const mentionsEnabled = store.isFeatureEnabled('at_mentions');\n  const usersWhoAnnotated = store.usersWhoAnnotated();\n  const usersWhoWereMentioned = store.usersWhoWereMentioned();\n  const focusedGroupMembers = store.getFocusedGroupMembers();\n  const usersForMentions = useMemo(\n    () =>\n      combineUsersForMentions({\n        usersWhoAnnotated,\n        usersWhoWereMentioned,\n        focusedGroupMembers,\n        mentionMode,\n      }),\n    [\n      focusedGroupMembers,\n      mentionMode,\n      usersWhoAnnotated,\n      usersWhoWereMentioned,\n    ],\n  );\n\n  useEffect(() => {\n    // Load members for focused group only if not yet loaded\n    if (mentionsEnabled && focusedGroupMembers.status === 'not-loaded') {\n      groupsService.loadFocusedGroupMembers();\n    }\n  }, [focusedGroupMembers, groupsService, mentionsEnabled]);\n\n  return (\n    /* eslint-disable-next-line jsx-a11y/no-static-element-interactions */\n    <div\n      data-testid=\"annotation-editor\"\n      className=\"space-y-4\"\n      onKeyDown={onKeyDown}\n    >\n      <MarkdownEditor\n        textStyle={textStyle}\n        label={isReplyAnno ? 'Enter reply' : 'Enter comment'}\n        text={text}\n        onEditText={onEditText}\n        mentionsEnabled={mentionsEnabled}\n        usersForMentions={usersForMentions}\n        showHelpLink={showHelpLink}\n        mentions={annotation.mentions}\n        mentionMode={mentionMode}\n        onInsertMentionSuggestion={onInsertMentionSuggestion}\n      />\n      <TagEditor\n        onAddTag={onAddTag}\n        onRemoveTag={onRemoveTag}\n        onTagInput={setPendingTag}\n        tagList={tags}\n      />\n      {group && (\n        <AnnotationPublishControl\n          group={group}\n          isDisabled={isEmpty}\n          isPrivate={draft.isPrivate}\n          onCancel={onCancel}\n          onSave={onSave}\n          onSetPrivate={onSetPrivate}\n        />\n      )}\n      {shouldShowLicense && <AnnotationLicense />}\n    </div>\n  );\n}\n\nexport default withServices(AnnotationEditor, [\n  'annotationsService',\n  'groups',\n  'settings',\n  'tags',\n  'toastMessenger',\n]);\n","import { Link } from '@hypothesis/frontend-shared';\n\nexport type AnnotationDocumentInfoProps = {\n  /** The domain associated with the document */\n  domain?: string;\n  /** A direct link to the document */\n  link?: string;\n  title: string;\n};\n/**\n * Render some metadata about an annotation's document and link to it\n * if a link is available.\n *\n * @param {AnnotationDocumentInfoProps} props\n */\nexport default function AnnotationDocumentInfo({\n  domain,\n  link,\n  title,\n}: AnnotationDocumentInfoProps) {\n  return (\n    <div className=\"flex gap-x-1\">\n      <div className=\"text-color-text-light\">\n        on &quot;\n        {link ? (\n          <Link href={link} target=\"_blank\" underline=\"none\">\n            {title}\n          </Link>\n        ) : (\n          <span>{title}</span>\n        )}\n        &quot;\n      </div>\n      {domain && <span className=\"text-color-text-light\">({domain})</span>}\n    </div>\n  );\n}\n","import { Link, GlobeIcon, GroupsIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nimport type { Group } from '../../../types/api';\n\nexport type AnnotationGroupInfoProps = {\n  /** Group to which the annotation belongs */\n  group: Group;\n};\n\n/**\n * Render information about what group an annotation is in.\n *\n * @param {AnnotationGroupInfoProps} props\n */\nfunction AnnotationGroupInfo({ group }: AnnotationGroupInfoProps) {\n  // Only show the name of the group and link to it if there is a\n  // URL (link) returned by the API for this group. Some groups do not have links\n  const linkToGroup = group?.links.html;\n\n  return (\n    <>\n      {group && linkToGroup && (\n        <Link\n          // The light-text hover color is not a standard color for a Link, so\n          // a custom variant is used\n          classes={classnames(\n            'text-color-text-light hover:text-color-text-light',\n          )}\n          href={group.links.html}\n          target=\"_blank\"\n          underline=\"hover\"\n          variant=\"custom\"\n        >\n          <div className=\"flex items-baseline gap-x-1\">\n            {group.type === 'open' ? (\n              <GlobeIcon className=\"w-2.5 h-2.5\" />\n            ) : (\n              <GroupsIcon className=\"w-2.5 h-2.5\" />\n            )}\n            <span>{group.name}</span>\n          </div>\n        </Link>\n      )}\n    </>\n  );\n}\n\nexport default AnnotationGroupInfo;\n","import {\n  Link,\n  decayingInterval,\n  formatRelativeDate,\n  formatDateTime,\n} from '@hypothesis/frontend-shared';\nimport { useEffect, useMemo, useState } from 'preact/hooks';\n\nexport type AnnotationTimestampProps = {\n  annotationCreated: string;\n  annotationUpdated: string;\n  annotationURL?: string;\n  /** Display a relative last-updated timestamp */\n  withEditedTimestamp?: boolean;\n};\n\n/**\n * Render textual timestamp information for an annotation. This includes\n * a relative date string (e.g. \"5 hours ago\") for the annotation's creation,\n * and, if `withEditedTimestamp` is `true`, a relative date string for when it\n * was last edited. If the `annotation` has an HTML link, the created-date\n * timestamp will be linked to that URL (the single-annotation view\n * for this annotation).\n *\n * @param {AnnotationTimestampsProps} props\n */\nexport default function AnnotationTimestamps({\n  annotationCreated,\n  annotationUpdated,\n  annotationURL,\n  withEditedTimestamp,\n}: AnnotationTimestampProps) {\n  // \"Current\" time, used when calculating the relative age of `timestamp`.\n  const [now, setNow] = useState(() => new Date());\n  const createdDate = useMemo(\n    () => new Date(annotationCreated),\n    [annotationCreated],\n  );\n  const updatedDate = useMemo(\n    () => withEditedTimestamp && new Date(annotationUpdated),\n    [annotationUpdated, withEditedTimestamp],\n  );\n\n  const created = useMemo(() => {\n    return {\n      absolute: formatDateTime(createdDate, { includeWeekday: true }),\n      relative: formatRelativeDate(createdDate, now),\n    };\n  }, [createdDate, now]);\n\n  const updated = useMemo(() => {\n    if (!updatedDate) {\n      return {};\n    }\n    return {\n      absolute: formatDateTime(updatedDate, { includeWeekday: true }),\n      relative: formatRelativeDate(updatedDate, now),\n    };\n  }, [updatedDate, now]);\n\n  // Refresh relative timestamp, at a frequency appropriate for the age.\n  useEffect(() => {\n    // Determine which of the two Dates to use for the `decayingInterval`\n    // It should be the latest relevant date, as the interval will be\n    // shorter the closer the date is to \"now\"\n    const laterDate = updatedDate ? annotationUpdated : annotationCreated;\n    const cancelRefresh = decayingInterval(laterDate, () => setNow(new Date()));\n    return cancelRefresh;\n  }, [annotationCreated, annotationUpdated, createdDate, updatedDate, now]);\n\n  // Do not show the relative timestamp for the edited date if it is the same\n  // as the relative timestamp for the created date\n  const editedString =\n    updated && updated.relative !== created.relative\n      ? `edited ${updated.relative}`\n      : 'edited';\n\n  return (\n    <div>\n      {withEditedTimestamp && (\n        <span\n          className=\"text-color-text-light text-xs italic\"\n          data-testid=\"timestamp-edited\"\n          title={updated.absolute}\n        >\n          ({editedString}){' '}\n        </span>\n      )}\n      {annotationURL ? (\n        <Link\n          // The light-text hover color is not a standard color for a Link, so\n          // LinkBase is used here\n          classes=\"text-color-text-light hover:text-color-text-light\"\n          target=\"_blank\"\n          title={created.absolute}\n          href={annotationURL}\n          underline=\"hover\"\n          variant=\"custom\"\n        >\n          {created.relative}\n        </Link>\n      ) : (\n        <span\n          className=\"color-text-color-light\"\n          data-testid=\"timestamp-created\"\n          title={created.absolute}\n        >\n          {created.relative}\n        </span>\n      )}\n    </div>\n  );\n}\n","import { Link } from '@hypothesis/frontend-shared';\n\ntype AnnotationUserProps = {\n  authorLink?: string;\n  displayName: string;\n};\n\n/**\n * Display information about an annotation's user. Link to the user's\n * activity if `authorLink` is present.\n */\nfunction AnnotationUser({ authorLink, displayName }: AnnotationUserProps) {\n  const user = <h3 className=\"text-color-text font-bold\">{displayName}</h3>;\n\n  if (authorLink) {\n    return (\n      <Link href={authorLink} target=\"_blank\" underline=\"none\" variant=\"custom\">\n        {user}\n      </Link>\n    );\n  }\n\n  return <div>{user}</div>;\n}\n\nexport default AnnotationUser;\n","import {\n  LinkButton,\n  HighlightIcon,\n  LockFilledIcon,\n} from '@hypothesis/frontend-shared';\nimport { useMemo } from 'preact/hooks';\n\nimport type { Annotation } from '../../../types/api';\nimport type { SidebarSettings } from '../../../types/config';\nimport {\n  domainAndTitle,\n  isHighlight,\n  isReply,\n  hasBeenEdited,\n  pageLabel as getPageLabel,\n} from '../../helpers/annotation-metadata';\nimport {\n  annotationAuthorLink,\n  annotationDisplayName,\n} from '../../helpers/annotation-user';\nimport { isPrivate } from '../../helpers/permissions';\nimport { withServices } from '../../service-context';\nimport { useSidebarStore } from '../../store';\nimport AnnotationDocumentInfo from './AnnotationDocumentInfo';\nimport AnnotationGroupInfo from './AnnotationGroupInfo';\nimport AnnotationTimestamps from './AnnotationTimestamps';\nimport AnnotationUser from './AnnotationUser';\n\nexport type AnnotationHeaderProps = {\n  annotation: Annotation;\n  isEditing?: boolean;\n  replyCount: number;\n  threadIsCollapsed: boolean;\n\n  // injected\n  settings: SidebarSettings;\n};\n\n/**\n * Render an annotation's header summary, including metadata about its user,\n * sharing status, document and timestamp. It also allows the user to\n * toggle sub-threads/replies in certain cases.\n *\n * @param {AnnotationHeaderProps} props\n */\nfunction AnnotationHeader({\n  annotation,\n  isEditing,\n  replyCount,\n  threadIsCollapsed,\n  settings,\n}: AnnotationHeaderProps) {\n  const store = useSidebarStore();\n\n  const defaultAuthority = store.defaultAuthority();\n  const displayNamesEnabled = store.isFeatureEnabled('client_display_names');\n  const userURL = store.getLink('user', { user: annotation.user });\n\n  const authorName = useMemo(\n    () =>\n      annotationDisplayName(annotation, defaultAuthority, displayNamesEnabled),\n    [annotation, defaultAuthority, displayNamesEnabled],\n  );\n\n  const authorLink = useMemo(\n    () => annotationAuthorLink(annotation, settings, defaultAuthority, userURL),\n    [annotation, settings, defaultAuthority, userURL],\n  );\n\n  const isCollapsedReply = isReply(annotation) && threadIsCollapsed;\n\n  // Link (URL) to single-annotation view for this annotation, if it has\n  // been provided by the service. Note: this property is not currently\n  // present on third-party annotations.\n  const annotationURL = annotation.links?.html || '';\n\n  const showEditedTimestamp = useMemo(() => {\n    return hasBeenEdited(annotation) && !isCollapsedReply;\n  }, [annotation, isCollapsedReply]);\n\n  // Pull together some document metadata related to this annotation\n  const documentInfo = domainAndTitle(annotation);\n  // There are some cases at present in which linking directly to an\n  // annotation's document is not immediately feasible—e.g in an LMS context\n  // where the original document might not be available outside of an\n  // assignment (e.g. Canvas files), and/or wouldn't be able to present\n  // any associated annotations.\n  // For the present, disable links to annotation documents for all third-party\n  // annotations until we have a more nuanced way of making linking determinations.\n  // The absence of a link to a single-annotation view is a signal that this\n  // is a third-party annotation.\n  // Also, of course, verify that there is a URL to the document (titleLink)\n  const documentLink =\n    annotationURL && documentInfo.titleLink ? documentInfo.titleLink : '';\n  // Show document information on non-sidebar routes, assuming there is a title\n  // to show, at the least\n  const showDocumentInfo =\n    store.route() !== 'sidebar' && documentInfo.titleText;\n\n  const onReplyCountClick = () =>\n    // If an annotation has replies it must have been saved and therefore have\n    // an ID.\n    store.setExpanded(annotation.id!, true);\n\n  // As part of the `page_numbers` feature, we are hiding the group on cards in\n  // contexts where it is the same for all cards and is shown elsewhere in the\n  // UI (eg. the top bar). This is to reduce visual clutter.\n  let group;\n  if (store.route() !== 'sidebar') {\n    group = store.getGroup(annotation.group);\n  }\n  const pageNumber = getPageLabel(annotation);\n\n  return (\n    <header>\n      <div className=\"flex gap-x-1 items-center flex-wrap-reverse\">\n        {isPrivate(annotation.permissions) && !isEditing && (\n          <LockFilledIcon\n            className=\"w-[12px] h-[12px]\"\n            title=\"This annotation is visible only to you\"\n          />\n        )}\n        <AnnotationUser authorLink={authorLink} displayName={authorName} />\n        {replyCount > 0 && isCollapsedReply && (\n          <LinkButton\n            variant=\"text-light\"\n            onClick={onReplyCountClick}\n            title=\"Expand replies\"\n            underline=\"hover\"\n          >\n            {`${replyCount} ${replyCount > 1 ? 'replies' : 'reply'}`}\n          </LinkButton>\n        )}\n\n        {!isEditing && annotation.created && (\n          <div className=\"flex justify-end grow\">\n            <AnnotationTimestamps\n              annotationCreated={annotation.created}\n              annotationUpdated={annotation.updated}\n              annotationURL={annotationURL}\n              withEditedTimestamp={showEditedTimestamp}\n            />\n          </div>\n        )}\n      </div>\n\n      {!isReply(annotation) && (\n        <div\n          className=\"flex gap-x-1 items-baseline flex-wrap-reverse\"\n          data-testid=\"extended-header-info\"\n        >\n          {group && <AnnotationGroupInfo group={group} />}\n          {!isEditing && isHighlight(annotation) && (\n            <HighlightIcon\n              title=\"This is a highlight. Click 'edit' to add a note or tag.\"\n              className=\"w-[10px] h-[10px] text-color-text-light\"\n            />\n          )}\n          {(showDocumentInfo || pageNumber) && (\n            <span className=\"flex\">\n              {showDocumentInfo && (\n                <AnnotationDocumentInfo\n                  domain={documentInfo.domain}\n                  link={documentLink}\n                  title={documentInfo.titleText}\n                />\n              )}\n              {pageNumber && (\n                <span className=\"text-grey-6\" data-testid=\"page-number\">\n                  {showDocumentInfo && ', '}p. {pageNumber}\n                </span>\n              )}\n            </span>\n          )}\n        </div>\n      )}\n    </header>\n  );\n}\n\nexport default withServices(AnnotationHeader, ['settings']);\n","import classnames from 'classnames';\n\nimport type { SidebarSettings } from '../../../types/config';\nimport { applyTheme } from '../../helpers/theme';\nimport { withServices } from '../../service-context';\nimport Excerpt from '../Excerpt';\nimport StyledText from '../StyledText';\n\ntype AnnotationQuoteProps = {\n  quote: string;\n  isHovered?: boolean;\n  isOrphan?: boolean;\n  settings: SidebarSettings;\n};\n\n/**\n * Display the selected text from the document associated with an annotation.\n */\nfunction AnnotationQuote({\n  quote,\n  isHovered,\n  isOrphan,\n  settings,\n}: AnnotationQuoteProps) {\n  return (\n    <Excerpt collapsedHeight={35} inlineControls={true} overflowThreshold={20}>\n      <StyledText classes={classnames({ 'p-redacted-text': isOrphan })}>\n        <blockquote\n          className={classnames('hover:border-l-blue-quote', {\n            'border-l-blue-quote': isHovered,\n          })}\n          style={applyTheme(['selectionFontFamily'], settings)}\n        >\n          {quote}\n        </blockquote>\n      </StyledText>\n    </Excerpt>\n  );\n}\n\nexport default withServices(AnnotationQuote, ['settings']);\n","import { Button } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nexport type AnnotationReplyToggleProps = {\n  onToggleReplies: () => void;\n  replyCount: number;\n  threadIsCollapsed: boolean;\n};\n/**\n * Render a thread-card control to toggle (expand or collapse) all of this\n * thread's children.\n */\nfunction AnnotationReplyToggle({\n  onToggleReplies,\n  replyCount,\n  threadIsCollapsed,\n}: AnnotationReplyToggleProps) {\n  const toggleAction = threadIsCollapsed ? 'Show replies' : 'Hide replies';\n  const toggleText = `${toggleAction} (${replyCount})`;\n\n  return (\n    <Button\n      classes={classnames(\n        // This button has a non-standard color combination: it uses a lighter\n        // text color than other Buttons\n        'text-grey-7 enabled:hover:text-brand-dark',\n        'enabled:hover:underline',\n      )}\n      onClick={onToggleReplies}\n      title={toggleText}\n      variant=\"custom\"\n    >\n      {toggleText}\n    </Button>\n  );\n}\n\nexport default AnnotationReplyToggle;\n","import {\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'preact/hooks';\n\nimport { withServices } from '../../service-context';\nimport type { ThumbnailService } from '../../services/thumbnail';\n\ntype BitmapImageProps = {\n  alt: string;\n  bitmap: ImageBitmap;\n  classes?: string;\n  scale?: number;\n};\n\n/** An `<img>`-like component which renders an {@link ImageBitmap}. */\nfunction BitmapImage({ alt, bitmap, classes, scale = 1.0 }: BitmapImageProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useLayoutEffect(() => {\n    const ctx = canvasRef.current!.getContext('2d')!;\n    ctx.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height);\n  }, [bitmap]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={bitmap.width}\n      height={bitmap.height}\n      role=\"img\"\n      aria-label={alt}\n      className={classes}\n      style={{\n        width: `${bitmap.width / scale}px`,\n        height: `${bitmap.height / scale}px`,\n      }}\n    />\n  );\n}\n\nexport type AnnotationThumbnailProps = {\n  tag: string;\n  thumbnailService: ThumbnailService;\n};\n\nfunction AnnotationThumbnail({\n  tag,\n  thumbnailService,\n}: AnnotationThumbnailProps) {\n  // If a cached thumbnail is available then render it immediately, otherwise\n  // we'll request one be generated.\n  const [thumbnail, setThumbnail] = useState<ImageBitmap | null>(() =>\n    thumbnailService.get(tag),\n  );\n  const [error, setError] = useState<string>();\n\n  const devicePixelRatio = useMemo(() => window.devicePixelRatio, []);\n  const maxWidth = 196;\n\n  useEffect(() => {\n    if (!thumbnail && !error) {\n      thumbnailService\n        .fetch(tag, { maxWidth: maxWidth * devicePixelRatio, devicePixelRatio })\n        .then(setThumbnail)\n        .catch(err => setError(err.message));\n    }\n  }, [error, devicePixelRatio, tag, thumbnail, thumbnailService]);\n\n  return (\n    <div\n      className=\"flex flex-row justify-center\"\n      data-testid=\"thumbnail-container\"\n    >\n      {thumbnail && (\n        <BitmapImage\n          alt=\"annotated content thumbnail\"\n          bitmap={thumbnail}\n          classes=\"border rounded-md\"\n          scale={devicePixelRatio}\n        />\n      )}\n      {!thumbnail && !error && (\n        // TODO - Adjust size here so it matches the thumbnail after it has\n        // finished loading.\n        <span data-testid=\"placeholder\">Loading thumbnail...</span>\n      )}\n      {!thumbnail && error && (\n        <span data-testid=\"error\">Unable to render thumbnail</span>\n      )}\n    </div>\n  );\n}\n\nexport default withServices(AnnotationThumbnail, ['thumbnailService']);\n","import { CardActions, Spinner } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useMemo } from 'preact/hooks';\n\nimport type { Annotation as IAnnotation } from '../../../types/api';\nimport {\n  annotationRole,\n  isOrphan,\n  isSaved,\n  quote,\n  shape,\n} from '../../helpers/annotation-metadata';\nimport { annotationDisplayName } from '../../helpers/annotation-user';\nimport { withServices } from '../../service-context';\nimport type { AnnotationsService } from '../../services/annotations';\nimport { useSidebarStore } from '../../store';\nimport AnnotationActionBar from './AnnotationActionBar';\nimport AnnotationBody from './AnnotationBody';\nimport AnnotationEditor from './AnnotationEditor';\nimport AnnotationHeader from './AnnotationHeader';\nimport AnnotationQuote from './AnnotationQuote';\nimport AnnotationReplyToggle from './AnnotationReplyToggle';\nimport AnnotationThumbnail from './AnnotationThumbnail';\n\nfunction SavingMessage() {\n  return (\n    <div\n      className={classnames(\n        'flex grow justify-end items-center gap-x-1',\n        // Make sure height matches that of action-bar icons so that there\n        // isn't a height change when transitioning in and out of saving state\n        'h-8 touch:h-touch-minimum',\n      )}\n      data-testid=\"saving-message\"\n    >\n      <span\n        // Slowly fade in the Spinner such that it only shows up if the saving\n        // is slow\n        className=\"text-[16px] animate-fade-in-slow\"\n      >\n        <Spinner size=\"sm\" />\n      </span>\n      <div className=\"text-color-text-light font-medium\">Saving...</div>\n    </div>\n  );\n}\n\nexport type AnnotationProps = {\n  annotation: IAnnotation;\n  isReply: boolean;\n  /** Number of replies to this annotation's thread */\n  replyCount: number;\n  /** Is the thread to which this annotation belongs currently collapsed? */\n  threadIsCollapsed: boolean;\n  /**\n   * Callback to expand/collapse reply threads. The presence of a function\n   * indicates a toggle should be rendered.\n   */\n  onToggleReplies?: () => void;\n\n  // injected\n  annotationsService: AnnotationsService;\n};\n\n/**\n * A single annotation.\n *\n * @param {AnnotationProps} props\n */\nfunction Annotation({\n  annotation,\n  isReply,\n  onToggleReplies,\n  replyCount,\n  threadIsCollapsed,\n  annotationsService,\n}: AnnotationProps) {\n  const store = useSidebarStore();\n\n  const annotationQuote = quote(annotation);\n  const draft = store.getDraft(annotation);\n  const userid = store.profile().userid;\n\n  const isHovered = store.isAnnotationHovered(annotation.$tag);\n  const isSaving = store.isSavingAnnotation(annotation);\n\n  const isEditing = !!draft && !isSaving;\n  const isCollapsedReply = isReply && threadIsCollapsed;\n\n  const showActions = !isSaving && !isEditing && isSaved(annotation);\n\n  const defaultAuthority = store.defaultAuthority();\n  const displayNamesEnabled = store.isFeatureEnabled('client_display_names');\n\n  const onReply = () => {\n    if (isSaved(annotation) && userid) {\n      annotationsService.reply(annotation, userid);\n    }\n  };\n\n  const authorName = useMemo(\n    () =>\n      annotationDisplayName(annotation, defaultAuthority, displayNamesEnabled),\n    [annotation, defaultAuthority, displayNamesEnabled],\n  );\n\n  const annotationDescription = isSaved(annotation)\n    ? annotationRole(annotation)\n    : `New ${annotationRole(annotation).toLowerCase()}`;\n  const state = store.isAnnotationHighlighted(annotation)\n    ? ' - Highlighted'\n    : '';\n\n  const targetShape = useMemo(() => shape(annotation), [annotation]);\n\n  return (\n    <article\n      className=\"space-y-4\"\n      aria-label={`${annotationDescription} by ${authorName}${state}`}\n    >\n      <AnnotationHeader\n        annotation={annotation}\n        isEditing={isEditing}\n        replyCount={replyCount}\n        threadIsCollapsed={threadIsCollapsed}\n      />\n      {targetShape && <AnnotationThumbnail tag={annotation.$tag} />}\n      {annotationQuote && (\n        <AnnotationQuote\n          quote={annotationQuote}\n          isHovered={isHovered}\n          isOrphan={isOrphan(annotation)}\n        />\n      )}\n\n      {!isCollapsedReply && !isEditing && (\n        <AnnotationBody annotation={annotation} />\n      )}\n\n      {isEditing && <AnnotationEditor annotation={annotation} draft={draft} />}\n\n      {!isCollapsedReply && (\n        <footer className=\"flex items-center\">\n          {onToggleReplies && (\n            <AnnotationReplyToggle\n              onToggleReplies={onToggleReplies}\n              replyCount={replyCount}\n              threadIsCollapsed={threadIsCollapsed}\n            />\n          )}\n          {isSaving && <SavingMessage />}\n          {showActions && (\n            <CardActions classes=\"grow\">\n              <AnnotationActionBar annotation={annotation} onReply={onReply} />\n            </CardActions>\n          )}\n        </footer>\n      )}\n    </article>\n  );\n}\n\nexport default withServices(Annotation, ['annotationsService']);\n","import type { AnnotationProps } from './Annotation';\nimport AnnotationReplyToggle from './AnnotationReplyToggle';\n\ntype EmptyAnnotationProps = Omit<\n  AnnotationProps,\n  'annotation' | 'annotationsService'\n>;\n\n/**\n * Render an \"annotation\" when the annotation itself is missing. This can\n * happen when an annotation is deleted by its author but there are still\n * replies that pertain to it.\n */\nexport default function EmptyAnnotation({\n  isReply,\n  replyCount,\n  threadIsCollapsed,\n  onToggleReplies,\n}: EmptyAnnotationProps) {\n  return (\n    <article\n      className=\"space-y-4\"\n      aria-label={`${\n        isReply ? 'Reply' : 'Annotation'\n      } with unavailable content`}\n    >\n      <div>\n        <em>Message not available.</em>\n      </div>\n      {onToggleReplies && (\n        <footer className=\"flex items-center\">\n          <AnnotationReplyToggle\n            onToggleReplies={onToggleReplies}\n            replyCount={replyCount}\n            threadIsCollapsed={threadIsCollapsed}\n          />\n        </footer>\n      )}\n    </article>\n  );\n}\n","import { Button, FlagIcon, HideIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nimport type { Annotation } from '../../types/api';\nimport * as annotationMetadata from '../helpers/annotation-metadata';\nimport { withServices } from '../service-context';\nimport type { APIService } from '../services/api';\nimport type { ToastMessengerService } from '../services/toast-messenger';\nimport { useSidebarStore } from '../store';\n\nexport type ModerationBannerProps = {\n  annotation: Annotation;\n\n  // injected\n  api: APIService;\n  toastMessenger: ToastMessengerService;\n};\n\n/**\n * Banner allows moderators to hide/unhide the flagged annotation from other\n * users.\n */\nfunction ModerationBanner({\n  annotation,\n  api,\n  toastMessenger,\n}: ModerationBannerProps) {\n  const store = useSidebarStore();\n  const flagCount = annotationMetadata.flagCount(annotation);\n\n  const isHiddenOrFlagged =\n    flagCount !== null && (flagCount > 0 || annotation.hidden);\n\n  /**\n   * Hide an annotation from non-moderator users.\n   */\n  const hideAnnotation = () => {\n    const id = annotation.id!;\n    api.annotation\n      .hide({ id })\n      .then(() => {\n        store.hideAnnotation(id);\n      })\n      .catch(() => {\n        toastMessenger.error('Failed to hide annotation');\n      });\n  };\n\n  /**\n   * Un-hide an annotation from non-moderator users.\n   */\n  const unhideAnnotation = () => {\n    const id = annotation.id!;\n    api.annotation\n      .unhide({ id })\n      .then(() => {\n        store.unhideAnnotation(id);\n      })\n      .catch(() => {\n        toastMessenger.error('Failed to unhide annotation');\n      });\n  };\n\n  if (!isHiddenOrFlagged) {\n    return null;\n  }\n  return (\n    <div\n      className={classnames(\n        'flex gap-x-3 bg-grey-1 text-color-text font-semibold',\n        // Match the card's border radius and hide overflow\n        'rounded-t-lg overflow-hidden',\n        // FIXME: Refactor margins: where possible manage them in a parent\n        'mb-2 ',\n        {\n          // For top-level annotations, use negative margins to \"break out\" of\n          // the parent card's 3-unit padding and have the banner span the\n          // full card width with no padding\n          '-mt-3 -ml-3 -mr-3': !annotationMetadata.isReply(annotation),\n          // For replies, break out of the right padding only\n          '-mr-3': annotationMetadata.isReply(annotation),\n        },\n      )}\n    >\n      <div\n        className={classnames('p-3 text-white', {\n          'bg-red-error': !annotation.hidden,\n          'bg-grey-6': annotation.hidden,\n        })}\n      >\n        {annotation.hidden ? (\n          <HideIcon className=\"w-em h-em\" />\n        ) : (\n          <FlagIcon className=\"w-em h-em\" />\n        )}\n      </div>\n      <div className=\"self-center grow\">\n        {!annotation.hidden && (\n          <span>\n            Flagged for review by {flagCount}{' '}\n            {flagCount === 1 ? 'user' : 'users'}\n          </span>\n        )}\n        {annotation.hidden && <span>Hidden from users</span>}\n      </div>\n      <div className=\"self-center pr-2\">\n        <Button\n          classes={classnames(\n            'px-1.5 py-1',\n            'bg-slate-1 text-grey-7 bg-grey-2',\n            'enabled:hover:text-grey-9 enabled:hover:bg-grey-3 disabled:text-grey-5',\n            'aria-pressed:bg-grey-3 aria-expanded:bg-grey-3',\n          )}\n          onClick={annotation.hidden ? unhideAnnotation : hideAnnotation}\n          title={\n            annotation.hidden\n              ? 'Make this annotation visible to everyone'\n              : 'Hide this annotation from non-moderators'\n          }\n          size=\"custom\"\n          variant=\"custom\"\n        >\n          {annotation.hidden ? 'Unhide' : 'Hide'}\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default withServices(ModerationBanner, ['api', 'toastMessenger']);\n","import {\n  Button,\n  CaretRightIcon,\n  MenuExpandIcon,\n} from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useCallback, useMemo } from 'preact/hooks';\n\nimport type { Thread as IThread } from '../helpers/build-thread';\nimport { countHidden, countVisible } from '../helpers/thread';\nimport { withServices } from '../service-context';\nimport type { ThreadsService } from '../services/threads';\nimport { useSidebarStore } from '../store';\nimport Annotation from './Annotation';\nimport AnnotationHeader from './Annotation/AnnotationHeader';\nimport EmptyAnnotation from './Annotation/EmptyAnnotation';\nimport ModerationBanner from './ModerationBanner';\n\ntype ThreadCollapseControlProps = {\n  threadIsCollapsed: boolean;\n  onToggleReplies: () => void;\n};\n\n/**\n * Render a gutter area to the left of a thread's content with a control for\n * expanding/collapsing the thread and a visual vertical line showing the\n * extent of the thread.\n */\nfunction ThreadCollapseControl({\n  threadIsCollapsed,\n  onToggleReplies,\n}: ThreadCollapseControlProps) {\n  const ToggleIcon = threadIsCollapsed ? CaretRightIcon : MenuExpandIcon;\n  const toggleTitle = threadIsCollapsed ? 'Expand replies' : 'Collapse replies';\n  return (\n    <div\n      className={classnames(\n        // ThreadCards set a pointer cursor. Set cursor to auto so that\n        // hovering over non-clickable parts of this gutter area do not show a\n        // pointer.\n        'cursor-auto',\n        {\n          'bg-thread-line': !threadIsCollapsed,\n        },\n      )}\n      data-testid=\"thread-collapse-channel\"\n    >\n      <div\n        className={classnames(\n          // Set a background color so the dashed line in the background\n          // doesn't show through the button\n          'bg-white',\n        )}\n      >\n        <Button\n          classes={classnames(\n            // Pull the button up a little to align horizontally with the\n            // thread/annotation's header. Override large touch targets for\n            // touch interfaces; we need to conserve space here\n            '-mt-1 touch:min-w-[auto] touch:min-h-[auto] p-[6.5px]',\n            'text-grey-5 hover:text-grey-7',\n          )}\n          data-testid=\"toggle-button\"\n          expanded={!threadIsCollapsed}\n          title={toggleTitle}\n          onClick={onToggleReplies}\n          size=\"custom\"\n          variant=\"custom\"\n        >\n          <ToggleIcon className=\"w-em h-em\" />\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport type ThreadProps = {\n  thread: IThread;\n\n  // injected\n  threadsService: ThreadsService;\n};\n\n/**\n * A thread, which contains a single annotation at its top level, and its\n * recursively-rendered children (i.e. replies).\n *\n * - Threads with parents (replies) may be \"collapsed\". Top-level threads are\n *   never collapsed.\n * - Any thread may be \"hidden\" because it does not match current filters.\n *\n * Each reply thread renders as a two-column \"row\", with a control to toggle\n * the thread's collapsed state at left and the content for the thread and its\n * children to the right.\n *\n * Top-level threads do not render a collapse control, as they are not\n * collapsible.\n */\nfunction Thread({ thread, threadsService }: ThreadProps) {\n  const isReply = !!thread.parent;\n\n  // If rendering child threads, only render those that have at least one\n  // visible item within them—i.e. don't render empty/totally-hidden threads.\n  const visibleChildren = thread.children.filter(\n    child => countVisible(child) > 0,\n  );\n\n  const store = useSidebarStore();\n  const hasAppliedFilter = store.hasAppliedFilter();\n  const isSaving =\n    thread.annotation && store.isSavingAnnotation(thread.annotation);\n  const isEditing =\n    thread.annotation && !!store.getDraft(thread.annotation) && !isSaving;\n\n  const onToggleReplies = useCallback(\n    () => store.setExpanded(thread.id, !!thread.collapsed),\n    [store, thread.id, thread.collapsed],\n  );\n\n  const showReplyToggle =\n    !isReply && !isEditing && !hasAppliedFilter && thread.replyCount > 0;\n\n  // Memoize annotation content to avoid re-rendering an annotation when content\n  // in other annotations/threads change.\n  const annotationContent = useMemo(\n    () =>\n      thread.visible && (\n        <>\n          {thread.annotation ? (\n            <>\n              <ModerationBanner annotation={thread.annotation} />\n              <Annotation\n                annotation={thread.annotation}\n                isReply={isReply}\n                onToggleReplies={showReplyToggle ? onToggleReplies : undefined}\n                replyCount={thread.replyCount}\n                threadIsCollapsed={thread.collapsed}\n              />\n            </>\n          ) : (\n            <EmptyAnnotation\n              isReply={isReply}\n              onToggleReplies={showReplyToggle ? onToggleReplies : undefined}\n              replyCount={thread.replyCount}\n              threadIsCollapsed={thread.collapsed}\n            />\n          )}\n        </>\n      ),\n    [\n      isReply,\n      onToggleReplies,\n      showReplyToggle,\n      thread.annotation,\n      thread.replyCount,\n      thread.collapsed,\n      thread.visible,\n    ],\n  );\n\n  return (\n    <section className=\"flex\" data-testid=\"thread-container\">\n      {isReply && (\n        <ThreadCollapseControl\n          threadIsCollapsed={thread.collapsed}\n          onToggleReplies={onToggleReplies}\n        />\n      )}\n\n      <div\n        className={classnames(\n          // Set a max-width to ensure that annotation content does not exceed\n          // the width of the container\n          'grow max-w-full min-w-0',\n        )}\n        data-testid=\"thread-content\"\n      >\n        {annotationContent}\n\n        {countHidden(thread) > 0 && (\n          <div className=\"space-y-2\">\n            {\n              // Every ThreadCard should have a header of some sort representing\n              // its top-level thread. When a thread is visible, an Annotation\n              // is rendered which in turn renders an AnnotationHeader. But when\n              // a thread is hidden, Annotation is not rendered: reander a header\n              // here instead for hidden top-level threads.\n            }\n            {!thread.parent && thread.annotation && (\n              <AnnotationHeader\n                annotation={thread.annotation}\n                isEditing={isEditing}\n                replyCount={thread.replyCount}\n                threadIsCollapsed={thread.collapsed}\n              />\n            )}\n            <div>\n              <Button\n                data-testid=\"show-hidden-button\"\n                onClick={() => threadsService.forceVisible(thread)}\n              >\n                Show {countHidden(thread)} more in conversation\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {!thread.collapsed && (\n          <ul\n            className={classnames(\n              // Pull this list to the left to bring it closer to the left edge\n              // of the ThreadCard and give more space for nested replies' content\n              '-ml-3',\n            )}\n            data-testid=\"thread-children\"\n          >\n            {visibleChildren.map(child => (\n              <li\n                key={child.id}\n                className={classnames(\n                  'mt-2',\n                  // Ensure correct rendering of replies with RTL content.\n                  // See https://github.com/hypothesis/client/issues/4705.\n                  '[text-align:start]',\n                )}\n              >\n                <Thread thread={child} threadsService={threadsService} />\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n    </section>\n  );\n}\n\nexport default withServices(Thread, ['threadsService']);\n","import { Card, CardContent } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport debounce from 'lodash.debounce';\nimport { useCallback, useEffect, useMemo, useRef } from 'preact/hooks';\n\nimport type { Annotation } from '../../types/api';\nimport type { Thread as IThread } from '../helpers/build-thread';\nimport { withServices } from '../service-context';\nimport type { FrameSyncService } from '../services/frame-sync';\nimport { useSidebarStore } from '../store';\nimport Thread from './Thread';\n\nexport type ThreadCardProps = {\n  thread: IThread;\n\n  // injected\n  frameSync: FrameSyncService;\n};\n\n/**\n * A \"top-level\" `Thread`, rendered as a \"card\" in the sidebar. A `Thread`\n * renders its own child `Thread`s within itself.\n */\nfunction ThreadCard({ frameSync, thread }: ThreadCardProps) {\n  const store = useSidebarStore();\n  const threadTag = thread.annotation?.$tag ?? null;\n  const isHovered = !!(threadTag && store.isAnnotationHovered(threadTag));\n  const setThreadHovered = useMemo(\n    () =>\n      debounce((ann: Annotation | null) => frameSync.hoverAnnotation(ann), 10),\n    [frameSync],\n  );\n  const isHighlighted = store.isAnnotationHighlighted(thread.annotation);\n\n  const scrollToAnnotation = useCallback(\n    (ann: Annotation) => {\n      frameSync.scrollToAnnotation(ann);\n    },\n    [frameSync],\n  );\n\n  /**\n   * Is the target's event an <a> or <button> element, or does it have\n   * either as an ancestor?\n   *\n   * @param {Element} target\n   */\n  const isFromButtonOrLink = (target: Element) => {\n    return !!target.closest('button') || !!target.closest('a');\n  };\n\n  // Memoize threads to reduce avoid re-rendering when something changes in a\n  // parent component but the `Thread` itself has not changed.\n  const threadContent = useMemo(() => <Thread thread={thread} />, [thread]);\n\n  // Handle requests to give this thread keyboard focus.\n  const focusRequest = store.annotationFocusRequest();\n  const cardRef = useRef<HTMLElement | null>(null);\n  useEffect(() => {\n    if (focusRequest !== thread.id || !cardRef.current) {\n      return;\n    }\n    cardRef.current.focus();\n    store.clearAnnotationFocusRequest();\n  }, [focusRequest, store, thread.id]);\n\n  return (\n    <Card\n      active={isHovered}\n      classes={classnames(\n        'cursor-pointer focus-visible-ring theme-clean:border-none',\n        { 'border-brand': isHighlighted },\n      )}\n      data-testid=\"thread-card\"\n      elementRef={cardRef}\n      tabIndex={-1}\n      onClick={e => {\n        // Prevent click events intended for another action from\n        // triggering a page scroll.\n        if (!isFromButtonOrLink(e.target as Element) && thread.annotation) {\n          scrollToAnnotation(thread.annotation);\n        }\n      }}\n      onMouseEnter={() => setThreadHovered(thread.annotation ?? null)}\n      onMouseLeave={() => setThreadHovered(null)}\n      key={thread.id}\n    >\n      <CardContent>{threadContent}</CardContent>\n    </Card>\n  );\n}\n\nexport default withServices(ThreadCard, ['frameSync']);\n","import { ListenerCollection } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport debounce from 'lodash.debounce';\nimport { useEffect, useLayoutEffect, useMemo, useState } from 'preact/hooks';\n\nimport type { Annotation, EPUBContentSelector } from '../../types/api';\nimport type { Thread } from '../helpers/build-thread';\nimport { mostRelevantAnnotation } from '../helpers/highlighted-annotations';\nimport {\n  calculateVisibleThreads,\n  THREAD_DIMENSION_DEFAULTS,\n} from '../helpers/visible-threads';\nimport { useSidebarStore } from '../store';\nimport { getElementHeightWithMargins } from '../util/dom';\nimport ThreadCard from './ThreadCard';\n\n// The precision of the `scrollPosition` value in pixels; values will be rounded\n// down to the nearest multiple of this scale value\nconst SCROLL_PRECISION = 50;\n\nfunction getScrollContainer() {\n  const container = document.querySelector('.js-thread-list-scroll-root');\n  if (!container) {\n    throw new Error('Scroll container is missing');\n  }\n  return container;\n}\n\nfunction roundScrollPosition(pos: number) {\n  return Math.max(pos - (pos % SCROLL_PRECISION), 0);\n}\n\nexport type ThreadListProps = {\n  threads: Thread[];\n};\n\n/**\n * Find the selector identifying the document segment which an annotation\n * belongs to.\n */\nfunction getSegmentSelector(ann: Annotation): EPUBContentSelector | undefined {\n  const target = ann.target[0];\n  if (!target) {\n    // Page Notes that have just been created do not have a target. All saved\n    // annotations and new annotations/highlights do.\n    //\n    // FIXME - Fix this inconsistency for page notes.\n    return undefined;\n  }\n  return target.selector?.find(s => s.type === 'EPUBContentSelector') as\n    | EPUBContentSelector\n    | undefined;\n}\n\n/**\n * Return a key that identifies the document section to which an annotation\n * belongs.\n */\nfunction headingKey(thread: Thread): string | null {\n  if (!thread.annotation) {\n    return null;\n  }\n  const chapter = getSegmentSelector(thread.annotation);\n  return chapter?.cfi ?? null;\n}\n\n/** Build a map of heading key (see {@link headingKey}) to section heading. */\nfunction headingMap(threads: Thread[]): Map<string, string> {\n  const headings = new Map();\n\n  for (const thread of threads) {\n    if (!thread.annotation) {\n      continue;\n    }\n    const selector = getSegmentSelector(thread.annotation);\n    if (selector?.title) {\n      headings.set(selector.cfi, selector.title);\n    }\n  }\n\n  return headings;\n}\n\n/**\n * Render a list of threads.\n *\n * The thread list is \"virtualized\", meaning that only threads in or near the\n * viewport are rendered. This is critical for performance and memory usage as\n * annotations (and replies) are complex interactive components whose\n * user-defined content may include rich media such as images, audio clips,\n * embedded YouTube videos, rendered math and more.\n */\nexport default function ThreadList({ threads }: ThreadListProps) {\n  // Client height of the scroll container.\n  const [scrollContainerHeight, setScrollContainerHeight] = useState(0);\n\n  // Scroll offset of scroll container, rounded to a multiple of `SCROLL_PRECISION`\n  // to avoid excessive re-renderings.\n  const [scrollPosition, setScrollPosition] = useState(0);\n\n  // Measure the initial size and offset of the scroll container once rendering\n  // is complete and attach listeners to observe future size or scroll offset changes.\n  useLayoutEffect(() => {\n    const listeners = new ListenerCollection();\n    const scrollContainer = getScrollContainer();\n\n    setScrollContainerHeight(scrollContainer.clientHeight);\n    setScrollPosition(roundScrollPosition(scrollContainer.scrollTop));\n\n    const updateScrollPosition = debounce(\n      () => {\n        setScrollContainerHeight(scrollContainer.clientHeight);\n        setScrollPosition(roundScrollPosition(scrollContainer.scrollTop));\n      },\n      10,\n      { maxWait: 100 },\n    );\n\n    listeners.add(scrollContainer, 'scroll', updateScrollPosition);\n\n    // We currently assume that the scroll container's size only changes with\n    // the window as a whole. A more general approach would involve using\n    // ResizeObserver via the `observeElementSize` utility.\n    listeners.add(window, 'resize', updateScrollPosition);\n\n    return () => {\n      listeners.removeAll();\n      updateScrollPosition.cancel();\n    };\n  }, []);\n\n  // Map of thread ID to measured height of thread. The height of each thread\n  // includes any headings displayed immediately above it.\n  const [threadHeights, setThreadHeights] = useState(() => new Map());\n\n  // ID of thread to scroll to after the next render. If the thread is not\n  // present, the value persists until it can be \"consumed\".\n  const [scrollToId, setScrollToId] = useState<string | null>(null);\n\n  const topLevelThreads = threads;\n\n  const { offscreenLowerHeight, offscreenUpperHeight, visibleThreads } =\n    useMemo(\n      () =>\n        calculateVisibleThreads(\n          topLevelThreads,\n          threadHeights,\n          scrollPosition,\n          scrollContainerHeight,\n        ),\n      [topLevelThreads, threadHeights, scrollPosition, scrollContainerHeight],\n    );\n\n  // Compute the heading to display above each thread. Headings are only shown\n  // in some document types (eg. VitalSource books).\n  //\n  // We compute the map based on the full list of threads, not just the rendered\n  // ones, so the association doesn't change while scrolling.\n  const headings = useMemo(() => {\n    let prevHeadingKey: string | null = null;\n    let prevHeading: string | null = null;\n\n    const headingForKey = headingMap(threads);\n\n    const headings = new Map();\n    for (const thread of threads) {\n      const key = headingKey(thread);\n      if (!key || prevHeadingKey === key) {\n        continue;\n      }\n\n      prevHeadingKey = key;\n\n      const heading = headingForKey.get(key) ?? 'Untitled chapter';\n      if (prevHeading === heading) {\n        // In some books (eg. VitalSource PDF-based books) a single logical\n        // chapter gets split into many content documents and the heading is\n        // repeated for each of them. We only want to render distinct headings.\n        continue;\n      }\n\n      prevHeading = heading;\n      headings.set(thread, heading);\n    }\n    return headings;\n  }, [threads]);\n\n  const store = useSidebarStore();\n  const currentUserId = store.profile().userid;\n  const editing = store.countDrafts() > 0;\n  const highlightedAnnotations = store.highlightedAnnotations();\n  const allAnnotations = store.allAnnotations();\n\n  // Get the `$tag` of the most recently created unsaved annotation.\n  const newAnnotationTag = (() => {\n    // If multiple unsaved annotations exist, assume that the last one in the\n    // list is the most recently created one.\n    const newAnnotations = store.unsavedAnnotations();\n    if (!newAnnotations.length) {\n      return null;\n    }\n    return newAnnotations[newAnnotations.length - 1].$tag;\n  })();\n\n  // Scroll to newly created annotations and replies.\n  //\n  // nb. If there are multiple unsaved annotations and the newest one is saved\n  // or removed, `newAnnotationTag` will revert to the previous unsaved annotation\n  // and the thread list will scroll to that.\n  useEffect(() => {\n    if (newAnnotationTag) {\n      store.setForcedVisible(newAnnotationTag, true);\n      setScrollToId(newAnnotationTag);\n    }\n  }, [store, newAnnotationTag]);\n\n  const mostRelevantHighlightedAnnotationId = useMemo(\n    () =>\n      mostRelevantAnnotation(allAnnotations, {\n        highlightedAnnotations,\n        currentUserId,\n      })?.id,\n    [allAnnotations, currentUserId, highlightedAnnotations],\n  );\n\n  // Scroll to the most relevant highlighted annotation, unless creating/editing\n  // another annotation\n  useEffect(() => {\n    if (!editing && mostRelevantHighlightedAnnotationId) {\n      setScrollToId(mostRelevantHighlightedAnnotationId);\n    }\n  }, [editing, mostRelevantHighlightedAnnotationId]);\n\n  // Effect to scroll a particular thread into view. This is mainly used to\n  // scroll a newly created annotation into view.\n  useEffect(() => {\n    if (!scrollToId) {\n      return;\n    }\n\n    const threadIndex = topLevelThreads.findIndex(t => t.id === scrollToId);\n    if (threadIndex === -1) {\n      // Thread is not currently present. The `scrollToId` will be consumed\n      // when this thread appears.\n      return;\n    }\n\n    // Clear `scrollToId` so we don't scroll again after the next render.\n    setScrollToId(null);\n\n    const getThreadHeight = (thread: Thread) =>\n      threadHeights.get(thread.id) || THREAD_DIMENSION_DEFAULTS.defaultHeight;\n\n    const yOffset = topLevelThreads\n      .slice(0, threadIndex)\n      .reduce((total, thread) => total + getThreadHeight(thread), 0);\n\n    const scrollContainer = getScrollContainer();\n    scrollContainer.scrollTop = yOffset;\n  }, [scrollToId, topLevelThreads, threadHeights]);\n\n  // When the set of visible threads changes, recalculate the real rendered\n  // heights of thread cards and update `threadHeights` state if there are changes.\n  useEffect(() => {\n    setThreadHeights(prevHeights => {\n      const changedHeights = new Map();\n      for (const { id } of visibleThreads) {\n        const threadElement = document.getElementById(id)!;\n\n        if (!threadElement) {\n          // This could happen if the `ThreadList` DOM is not connected to the document.\n          //\n          // Errors earlier in the render can also potentially cause this (see\n          // https://github.com/hypothesis/client/pull/3665#issuecomment-895857072),\n          // although we don't in general try to make all effects robust to that\n          // as it is a problem that needs to be handled elsewhere.\n          console.warn(\n            'ThreadList could not measure thread. Element not found.',\n          );\n          return prevHeights;\n        }\n\n        const height = getElementHeightWithMargins(threadElement);\n        if (height !== prevHeights.get(id)) {\n          changedHeights.set(id, height);\n        }\n      }\n\n      // Skip update if no heights changed from previous measured values\n      // (or defaults).\n      if (changedHeights.size === 0) {\n        return prevHeights;\n      }\n\n      return new Map([...prevHeights, ...changedHeights]);\n    });\n  }, [visibleThreads]);\n\n  return (\n    <div>\n      <div style={{ height: offscreenUpperHeight }} />\n      {visibleThreads.map(child => (\n        <div\n          className={classnames(\n            // The goal is to space out each annotation card vertically. Typically\n            // this is better handled by applying vertical spacing to the parent\n            // element (e.g. `space-y-3`) but in this case, the constraints of\n            // sibling divs before and after the list of annotation cards prevents\n            // this, so a bottom margin is added to each card's wrapping element.\n            'mb-3',\n          )}\n          data-testid=\"thread-card-container\"\n          id={child.id}\n          key={child.id}\n        >\n          {headings.get(child) && (\n            <h3 className=\"text-md text-grey-7 font-bold pt-3 pb-2\">\n              {headings.get(child)}\n            </h3>\n          )}\n          <ThreadCard thread={child} />\n        </div>\n      ))}\n      <div style={{ height: offscreenLowerHeight }} />\n    </div>\n  );\n}\n","import type { Annotation } from '../../types/api';\n\nexport type AnnotationId = string;\n\nexport type MostRelevantAnnotationOptions = {\n  /** The list of highlighted annotation IDs to filter by */\n  highlightedAnnotations: AnnotationId[];\n  currentUserId: string | null;\n};\n\n/**\n * Finds the most relevant annotation in a list.\n *\n * The most relevant annotation is:\n * 1. The most recent annotation which is highlighted, with mentions of current user, or\n * 2. The most recent annotation which is highlighted, or\n * 3. `null`\n *\n * @param annotations - The list of annotations to search from\n */\nexport function mostRelevantAnnotation(\n  annotations: Annotation[],\n  { highlightedAnnotations, currentUserId }: MostRelevantAnnotationOptions,\n): Annotation | null {\n  if (highlightedAnnotations.length === 0) {\n    return null;\n  }\n\n  // To determine which is the most relevant annotation, we first sort them\n  // from newest to oldest\n  const sortedHighlightedAnnos = annotations\n    .filter(anno => anno.id && highlightedAnnotations.includes(anno.id))\n    // The `updated` field contains a date in ISO format. This means their\n    // alphabetical and chronological orders match.\n    .sort((a, b) => {\n      if (b.updated === a.updated) {\n        return 0;\n      }\n      return b.updated > a.updated ? 1 : -1;\n    });\n\n  // Then we find the most recent one with mentions of current user\n  const mostRelevantHighlightedAnnotation = currentUserId\n    ? sortedHighlightedAnnos.find(\n        anno =>\n          anno.mentions &&\n          anno.mentions.some(({ userid }) => userid === currentUserId),\n      )\n    : null;\n\n  // Finally we try to fall back to the most recent one\n  return mostRelevantHighlightedAnnotation ?? sortedHighlightedAnnos[0] ?? null;\n}\n","import { hasOwn } from '../../shared/has-own';\nimport type { Annotation } from '../../types/api';\n\nexport type Thread = {\n  /**\n   * The thread's id, which equivalent to the id of its annotation. For unsaved\n   * annotations, the id is derived from the annotation's local `$tag` property.\n   */\n  id: string;\n\n  /**\n   * This thread's annotation. Undefined in cases when an annotation _should_\n   * exist—it's implied by a reference from another annotation—but is not\n   * present in our collection of annotations.\n   * This can happen when a reply has been deleted, but still has children that\n   * exist.\n   */\n  annotation?: Annotation;\n\n  /** The id of this thread's parent. Top-level threads do not have parents */\n  parent?: string;\n\n  /**\n   * Whether this thread should be visible when rendered. true when the thread's\n   * annotation matches current annotation filters.\n   */\n  visible: boolean;\n\n  /**\n   * Whether the replies in this thread should be rendered as collapsed\n   * (when true) or expanded (when false).\n   */\n  collapsed: boolean;\n\n  children: Thread[];\n\n  /** Computed count of all replies to a thread */\n  replyCount: number;\n\n  /** The thread's depth in the hierarchy */\n  depth: number;\n};\n\n/**\n * Default state for new threads\n */\nconst DEFAULT_THREAD_STATE = {\n  collapsed: false,\n  depth: 0,\n  visible: true,\n  replyCount: 0,\n};\n\n/**\n * Returns a persistent identifier for an Annotation.\n * If the Annotation has been created on the server, it will have\n * an id assigned, otherwise we fall back to the local-only '$tag'\n * property.\n */\nfunction annotationId(annotation: Annotation): string {\n  return annotation.id || annotation.$tag;\n}\n\n/**\n * Is there a valid path from the thread indicated by `id` to the root thread,\n * with no circular references?\n *\n * @param id - The id of the thread to be verified\n * @param ancestorId - The ancestor of the thread indicated by id that is to be\n *        verified: is it extant and not a circular reference?\n */\nfunction hasPathToRoot(\n  threads: Record<string, Thread>,\n  id: string,\n  ancestorId: string,\n): boolean {\n  const ancestor = threads[ancestorId];\n  if (!ancestor || ancestor.parent === id) {\n    // Thread for ancestor not found, or points at itself: circular reference\n    return false;\n  } else if (!ancestor.parent) {\n    // Top of the tree: we've made it\n    return true;\n  }\n  return hasPathToRoot(threads, id, ancestor.parent);\n}\n\n/**\n * Link the thread's annotation to its parent\n * @param parents - ids of parent annotations, from the annotation's\n *        `references` field. Immediate parent is last entry.\n */\nfunction setParent(\n  threads: Record<string, Thread>,\n  id: string,\n  parents: string[],\n) {\n  if (threads[id].parent || !parents.length) {\n    // Parent already assigned, do not try to change it.\n    return;\n  }\n  const parentId = parents[parents.length - 1];\n\n  if (!threads[parentId]) {\n    // Parent does not exist. This may be a reply to an annotation which has\n    // been deleted. Create a placeholder Thread with no annotation to\n    // represent the missing annotation.\n    threads[parentId] = {\n      ...DEFAULT_THREAD_STATE,\n      children: [],\n      id: parentId,\n    };\n    // Link up this new thread to _its_ parent, which should be the original\n    // thread's grandparent\n    setParent(threads, parentId, parents.slice(0, -1));\n  }\n\n  if (hasPathToRoot(threads, id, parentId)) {\n    threads[id].parent = parentId;\n    threads[parentId].children.push(threads[id]);\n  }\n}\n\n/**\n * Creates a thread tree of annotations from a list of annotations.\n *\n * Given a flat list of annotations and replies, this generates a hierarchical\n * thread, using the `references` field of an annotation to link together\n * annotations and their replies. The `references` field is a possibly\n * incomplete ordered list of the parents of an annotation, from furthest to\n * nearest ancestor.\n *\n * @param annotations - The input annotations to thread.\n * @return The input annotations threaded into a tree structure.\n */\nfunction threadAnnotations(annotations: Annotation[]): Thread {\n  const threads: Record<string, Thread> = {};\n\n  // Create a `Thread` for each annotation\n  annotations.forEach(annotation => {\n    const id = annotationId(annotation);\n    threads[id] = {\n      ...DEFAULT_THREAD_STATE,\n      children: [],\n      annotation,\n      id,\n    };\n  });\n\n  // Establish ancestral relationships between annotations\n  annotations.forEach(annotation => {\n    // Remove references to self from `references` to avoid circular references\n    const parents = (annotation.references || []).filter(\n      id => id !== annotation.id,\n    );\n    return setParent(threads, annotationId(annotation), parents);\n  });\n\n  // Collect the set of threads which have no parent as\n  // children of the thread root\n  const rootThreads = [];\n  for (const rootThreadId in threads) {\n    if (!threads[rootThreadId].parent) {\n      // Top-level threads are collapsed by default\n      threads[rootThreadId].collapsed = true;\n      rootThreads.push(threads[rootThreadId]);\n    }\n  }\n\n  const rootThread = {\n    ...DEFAULT_THREAD_STATE,\n    id: 'root',\n    children: rootThreads,\n  };\n\n  return rootThread;\n}\n\n/**\n * Returns a copy of `thread` with the thread\n * and each of its children transformed by mapFn(thread).\n */\nfunction mapThread(thread: Thread, mapFn: (t: Thread) => Thread): Thread {\n  return Object.assign({}, mapFn(thread), {\n    children: thread.children.map(child => {\n      return mapThread(child, mapFn);\n    }),\n  });\n}\n\n/**\n * Return a new `Thread` object with all (recursive) `children` arrays sorted.\n * Sort the children of top-level threads using `compareFn` and all other\n * children using `replyCompareFn`.\n *\n * @param compareFn - comparison function for sorting top-level annotations\n * @param replyCompareFn - comparison function for sorting replies\n */\nfunction sortThread(\n  thread: Thread,\n  compareFn: (a: Thread, b: Thread) => number,\n  replyCompareFn: (a: Thread, b: Thread) => number,\n): Thread {\n  const children = thread.children.map(child =>\n    sortThread(child, replyCompareFn, replyCompareFn),\n  );\n\n  const sortedChildren = children.slice().sort(compareFn);\n\n  return { ...thread, children: sortedChildren };\n}\n\n/**\n * Return a copy of `thread` with the `replyCount` and `depth` properties\n * updated.\n */\nfunction countRepliesAndDepth(thread: Thread, depth: number): Thread {\n  const children = thread.children.map(c => countRepliesAndDepth(c, depth + 1));\n  const replyCount = children.reduce(\n    (total, child) => total + 1 + child.replyCount,\n    0,\n  );\n  return {\n    ...thread,\n    children,\n    depth,\n    replyCount,\n  };\n}\n\n/**\n * Does this thread have any visible children?\n */\nfunction hasVisibleChildren(thread: Thread): boolean {\n  return thread.children.some(child => {\n    return child.visible || hasVisibleChildren(child);\n  });\n}\n\nexport type BuildThreadOptions = {\n  /** Map of thread id => expansion state */\n  expanded: Record<string, boolean>;\n\n  /**\n   * List of $tags of annotations that have been explicitly expanded by the\n   * user, even if they don't match current filters\n   */\n  forcedVisible: string[];\n\n  /** List of currently-selected annotation ids, from the data store */\n  selected: string[];\n\n  /** Comparison function for sorting top-level annotations */\n  sortCompareFn: (a: Thread, b: Thread) => number;\n\n  /** Predicate function that returns `true` if annotation should be visible */\n  filterFn?: (a: Annotation) => boolean;\n\n  /**\n   * Predicate function that returns `true` if the annotation should be included\n   * in the thread tree\n   */\n  threadFilterFn?: (t: Thread) => boolean;\n};\n\n/**\n * Sort by reply (Annotation) `created` date\n */\nconst replySortCompareFn = (a: Thread, b: Thread): number => {\n  if (!a.annotation || !b.annotation) {\n    return 0;\n  }\n  if (a.annotation.created < b.annotation.created) {\n    return -1;\n  } else if (a.annotation.created > b.annotation.created) {\n    return 1;\n  }\n  return 0;\n};\n\n/**\n * Project, filter and sort a list of annotations into a thread structure for\n * display by the <Thread> component.\n *\n * buildThread() takes as inputs a flat list of annotations,\n * the current visibility filters and sort function and returns\n * the thread structure that should be rendered.\n *\n * An Annotation present in `annotations` will not be present in the returned threads if:\n * - The annotation does not match thread-level filters (options.threadFilterFn), OR\n * - The annotation is not in the current selection (options.selected), OR\n * - The annotation's thread is hidden and has no visible children\n *\n * Annotations that do not match the currently-applied annotation filters\n * (options.filterFn) will have their thread's `visible` property set to `hidden`\n * (an exception is made if that annotation's thead has been forced visible by\n * a user).\n *\n * @return The root thread, whose children are the top-level annotations to display.\n */\nexport function buildThread(\n  annotations: Annotation[],\n  options: BuildThreadOptions,\n): Thread {\n  const hasSelection = options.selected.length > 0;\n  const hasForcedVisible = options.forcedVisible.length > 0;\n\n  let thread = threadAnnotations(annotations);\n\n  // When a selection is present, it overrides other filters.\n  if (hasSelection) {\n    thread.children = thread.children.filter(child => {\n      const isSelected = options.selected.includes(child.id);\n      const isForcedVisible =\n        hasForcedVisible && options.forcedVisible.includes(child.id);\n      return isSelected || isForcedVisible;\n    });\n  } else if (options.threadFilterFn) {\n    // Remove threads not matching thread-level filters\n    const threadFilterFn = options.threadFilterFn;\n    thread.children = thread.children.filter(thread => {\n      if (hasForcedVisible && options.forcedVisible.includes(thread.id)) {\n        return true;\n      }\n      return threadFilterFn(thread);\n    });\n  }\n\n  // Set visibility for threads.\n  // The root thread itself should be set as non-visible, to avoid confusion\n  // when counting visible threads. It's a container thread: its children\n  // are the top-level annotations.\n  thread.visible = false;\n  thread = mapThread(thread, thread => {\n    if (hasSelection) {\n      // When a selection is active, make the full conversation thread for\n      // each selected annotation visible.\n      return { ...thread, visible: true };\n    }\n\n    let threadIsVisible = thread.visible;\n\n    if (options.filterFn) {\n      if (hasForcedVisible && options.forcedVisible.includes(thread.id)) {\n        // This thread may or may not match the filter, but we should\n        // make sure it is visible because it has been forced visible by user\n        threadIsVisible = true;\n      } else if (thread.annotation) {\n        // Otherwise, visibility depends on whether its annotation matches the filter\n        threadIsVisible = !!options.filterFn(thread.annotation);\n      } else {\n        threadIsVisible = false;\n      }\n    }\n    return { ...thread, visible: threadIsVisible };\n  });\n\n  // Remove top-level threads which contain no visible annotations\n  thread.children = thread.children.filter(\n    child => child.visible || hasVisibleChildren(child),\n  );\n\n  // Determine collapsed state for UI\n  thread = mapThread(thread, thread => {\n    const threadStates = {\n      collapsed: thread.collapsed,\n    };\n\n    if (hasOwn(options.expanded, thread.id)) {\n      // This thread has been explicitly expanded/collapsed by user\n      threadStates.collapsed = !options.expanded[thread.id];\n    } else {\n      // If annotations are filtered, and at least one child matches\n      // those filters, make sure thread is not collapsed\n      const hasUnfilteredChildren =\n        options.filterFn && hasVisibleChildren(thread);\n      threadStates.collapsed = thread.collapsed && !hasUnfilteredChildren;\n    }\n    return { ...thread, ...threadStates };\n  });\n\n  // Sort the root thread according to the current search criteria\n  //const compareFn = options.sortCompareFn ?? defaultSortCompareFn;\n  thread = sortThread(thread, options.sortCompareFn, replySortCompareFn);\n\n  // Update `replyCount` and `depth` properties\n  thread = countRepliesAndDepth(thread, -1);\n\n  return thread;\n}\n","/**\n * Functions for working with EPUB Canonical Fragment Identifiers.\n *\n * See https://idpf.org/epub/linking/cfi/.\n */\n\n/**\n * Compare two arrays.\n *\n * Arrays are compared as a sequence of values in priority order. If the two\n * arrays are of different length but their common indexes have the same values,\n * the shorter array is considered less than the longer one.\n *\n * This logic is similar to how eg. tuples are compared in Python.\n */\nfunction compareArrays(\n  a: Array<number | string>,\n  b: Array<number | string>,\n): number {\n  for (let i = 0; i < Math.min(a.length, b.length); i++) {\n    if (a[i] === b[i]) {\n      continue;\n    } else if (typeof a[i] !== typeof b[i]) {\n      // The result of comparing a number with a string is undefined if the\n      // string cannot be coerced to a number. To simplify things, we just\n      // decide that numbers sort before strings.\n      return typeof a[i] === 'number' ? -1 : 1;\n    } else if (a[i] < b[i]) {\n      return -1;\n    } else if (a[i] > b[i]) {\n      return 1;\n    }\n  }\n  return a.length - b.length;\n}\n\n/**\n * Split a hyphen-separated CFI range.\n *\n * CFI assertions are stripped in the process. If `range` does not contain a\n * hyphen, the result will be an empty range with the end point being the same\n * as the start point.\n *\n * @example\n *   splitCFIRange(\"/2/4[chap-02]-/2/6[chap-03]\") // returns `[\"/2/4\", \"/2/6\"]`.\n */\nexport function splitCFIRange(range: string): [string, string] {\n  const rangeWithoutAssertions = stripCFIAssertions(range);\n  const [start, end] = rangeWithoutAssertions.split('-', 2);\n  return [start, end ?? start];\n}\n\n/**\n * Strip assertions from a Canonical Fragment Identifier.\n *\n * Assertions are `[...]` enclosed sections which act as checks on the validity\n * of numbers but do not affect the sort order.\n *\n * @example\n *   stripCFIAssertions(\"/6/14[chap05ref]\") // returns \"/6/14\"\n */\nexport function stripCFIAssertions(cfi: string): string {\n  // Fast path for CFIs with no assertions.\n  if (!cfi.includes('[')) {\n    return cfi;\n  }\n\n  let result = '';\n\n  // Has next char been escaped?\n  let escaped = false;\n\n  // Are we in a `[...]` assertion section?\n  let inAssertion = false;\n\n  for (const ch of cfi) {\n    if (!escaped && ch === '^') {\n      escaped = true;\n      continue;\n    }\n\n    if (!escaped && ch === '[') {\n      inAssertion = true;\n    } else if (!escaped && inAssertion && ch === ']') {\n      inAssertion = false;\n    } else if (!inAssertion) {\n      result += ch;\n    }\n\n    escaped = false;\n  }\n\n  return result;\n}\n\n/**\n * Compare two Canonical Fragment Identifiers.\n *\n * The full sorting rules for CFIs are specified by https://idpf.org/epub/linking/cfi/#sec-sorting.\n *\n * This function only considers the part of the CFI up to the first step\n * indirection (\"!\"), which identify a location within the EPUB's Package\n * Document. These portions of CFIs consist of a \"/\"-delimited sequence of\n * numbers, with optional assertions in `[...]` brackets (eg.\n * \"/2/4[chapter2ref]\").\n *\n * Per the sorting rules linked above, the input CFIs are assumed to be\n * unescaped. This means that they may contain circumflex (^) escape characters,\n * but don't have the additional escaping that is needed when CFIs are used\n * inside URIs or HTML.\n *\n * @example\n *   compareCFIs(\"/2/3[chap3ref]\", \"/2/10[chap10ref]\") // returns -1\n *\n * @param a - The first CFI\n * @param b - The second CFI\n * @return A value that is negative, zero or positive depending on\n *   whether `a` is less-than, equal-to or greater-than `b`\n */\nexport function compareCFIs(a: string, b: string): number {\n  const parseCFI = (cfi: string) => {\n    return documentCFI(cfi)\n      .split('/')\n      .map(str => {\n        // CFI step values _should_ always be integers. We currently handle\n        // invalid values by using a string comparison instead. We could\n        // alternatively treat all invalid CFIs as equal.\n        const intVal = parseInt(str, 10);\n        return Number.isNaN(intVal) ? str : intVal;\n      });\n  };\n  return compareArrays(parseCFI(a), parseCFI(b));\n}\n\n/**\n * Return true if the CFI `cfi` lies in the range [start, end).\n *\n * Only the part of the CFI up to the first step indirection (\"!\") is\n * considered. See {@link documentCFI}.\n */\nexport function cfiInRange(cfi: string, start: string, end: string): boolean {\n  return compareCFIs(cfi, start) >= 0 && compareCFIs(cfi, end) < 0;\n}\n\n/**\n * Return a slice of `cfi` up to the first step indirection [1], with assertions\n * removed.\n *\n * A typical CFI consists of a path within the table of contents to indicate\n * a content document, a step indirection (\"!\"), then the path of an element\n * within the content document. For such a CFI, this function will retain only\n * the content document path.\n *\n * [1] https://idpf.org/epub/linking/cfi/#sec-path-indirection\n *\n * @example\n *   documentCFI('/6/152[;vnd.vst.idref=ch13_01]!/4/2[ch13_sec_1]') // Returns \"/6/152\"\n */\nexport function documentCFI(cfi: string): string {\n  const stripped = stripCFIAssertions(cfi);\n  const sepIndex = stripped.indexOf('!');\n  return sepIndex === -1 ? stripped : stripped.slice(0, sepIndex);\n}\n","/**\n * Parse a page number or range into a `[start, end]` integer pair. The `start`\n * or `end` may be `null` if the range is open.\n *\n * Ranges can be specified as:\n *\n *  - A single number. This is treated as a range that starts and ends on the\n *    same page.\n *  - A range that may be closed (\"5-10\"), half-open (\"5-\" or \"-5\") or fully\n *    open (\"-\").\n *\n * Returns `null` if the page range could not be parsed.\n */\nfunction parseRange(range: string): [number | null, number | null] | null {\n  if (!range) {\n    return null;\n  }\n\n  const [start, end] = range.includes('-') ? range.split('-') : [range, range];\n\n  let startInt = null;\n  if (start) {\n    startInt = parseInt(start);\n    if (!Number.isInteger(startInt)) {\n      return null;\n    }\n  }\n\n  let endInt = null;\n  if (end) {\n    endInt = parseInt(end);\n    if (!Number.isInteger(endInt)) {\n      return null;\n    }\n  }\n\n  if (startInt === null || endInt === null) {\n    return [startInt, endInt];\n  }\n\n  return [Math.min(startInt, endInt), Math.max(startInt, endInt)];\n}\n\n/** Describes whether two page ranges overlap. */\nexport enum RangeOverlap {\n  Overlap,\n  NoOverlap,\n  Unknown,\n}\n\n/**\n * Return true if the page number `label` is within `range`.\n *\n * Returns `false` if the label is outside `range` or the relation between the\n * label and the range could not be determined.\n *\n * @param label - A page number such as \"10\", \"iv\"\n * @param range - A page range expressed as a single page number, or a hyphen\n *   separated range (eg. \"10-12\"). Page ranges are inclusive, so the page\n *   range \"10-12\" matches \"10\", \"11\" and \"12\". This means there is no way to\n *   specify an empty range.\n */\nexport function pageLabelInRange(label: string, range: string): boolean {\n  return pageRangeOverlap(label, range) === RangeOverlap.Overlap;\n}\n\n/** Convert an open range into an integer range. */\nfunction normalizeRange(\n  range: [number | null, number | null],\n  min: number,\n  max: number,\n): [number, number] {\n  return [range[0] ?? min, range[1] ?? max];\n}\n\n/**\n * Return true if two page ranges overlap.\n *\n * Each range may be specified as a single page number, or a hyphen-separated\n * range.\n *\n * Returns true if the ranges overlap, false if the ranges do not overlap, or\n * `null` if the relation could not be determined.\n */\nexport function pageRangeOverlap(rangeA: string, rangeB: string): RangeOverlap {\n  const intRangeA = parseRange(rangeA);\n  const intRangeB = parseRange(rangeB);\n\n  if (!intRangeA || !intRangeB) {\n    if (rangeA && rangeB && rangeA === rangeB) {\n      // As a special case for non-numeric ranges, we consider them overlapping\n      // if both are equal. This means `pageRangesOverlap(\"iv\", \"iv\")` is true\n      // for example.\n      return RangeOverlap.Overlap;\n    }\n\n    // We could not determine whether the ranges overlap.\n    return RangeOverlap.Unknown;\n  }\n\n  const minPage = 1;\n  const maxPage = 2 ** 31;\n  const [aStart, aEnd] = normalizeRange(intRangeA, minPage, maxPage);\n  const [bStart, bEnd] = normalizeRange(intRangeB, minPage, maxPage);\n\n  if (aStart <= bStart) {\n    return bStart <= aEnd ? RangeOverlap.Overlap : RangeOverlap.NoOverlap;\n  } else {\n    return aStart <= bEnd ? RangeOverlap.Overlap : RangeOverlap.NoOverlap;\n  }\n}\n","/**\n * Unicode combining characters\n * from http://xregexp.com/addons/unicode/unicode-categories.js line:30\n */\n\n// Lint warning suppressed to facilitate ESLint upgrade. The warning may still\n// be valid.\n//\nconst COMBINING_MARKS =\n  // eslint-disable-next-line no-misleading-character-class\n  /[\\u0300-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08E4-\\u08FE\\u0900-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2\\u0AE3\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C01-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C82\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D02\\u0D03\\u0D3E-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102B-\\u103E\\u1056-\\u1059\\u105E-\\u1060\\u1062-\\u1064\\u1067-\\u106D\\u1071-\\u1074\\u1082-\\u108D\\u108F\\u109A-\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4-\\u17D3\\u17DD\\u180B-\\u180D\\u18A9\\u1920-\\u192B\\u1930-\\u193B\\u19B0-\\u19C0\\u19C8\\u19C9\\u1A17-\\u1A1B\\u1A55-\\u1A5E\\u1A60-\\u1A7C\\u1A7F\\u1B00-\\u1B04\\u1B34-\\u1B44\\u1B6B-\\u1B73\\u1B80-\\u1B82\\u1BA1-\\u1BAD\\u1BE6-\\u1BF3\\u1C24-\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE8\\u1CED\\u1CF2-\\u1CF4\\u1DC0-\\u1DE6\\u1DFC-\\u1DFF\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA823-\\uA827\\uA880\\uA881\\uA8B4-\\uA8C4\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA953\\uA980-\\uA983\\uA9B3-\\uA9C0\\uAA29-\\uAA36\\uAA43\\uAA4C\\uAA4D\\uAA7B\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEB-\\uAAEF\\uAAF5\\uAAF6\\uABE3-\\uABEA\\uABEC\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE26]/g;\n\nexport function fold(str: string): string {\n  return str.replace(COMBINING_MARKS, '');\n}\n\nexport function normalize(str: string): string {\n  return str.normalize('NFKD');\n}\n\n/**\n * Truncate a string to `maxLength` code points.\n *\n * Note this is different from `str.slice(0, maxLength)` which slices UTF-16\n * code units.\n */\nexport function truncate(str: string, maxLength: number) {\n  const chars = Array.from(str);\n  if (chars.length <= maxLength) {\n    return str;\n  }\n  return chars.slice(0, maxLength).join('');\n}\n","import {\n  cfiInRange,\n  splitCFIRange,\n  stripCFIAssertions,\n} from '../../shared/cfi';\nimport type { Annotation } from '../../types/api';\nimport { pageLabelInRange } from '../util/page-range';\nimport * as unicodeUtils from '../util/unicode';\nimport { cfi as getCFI, quote, pageLabel } from './annotation-metadata';\nimport type { Facet } from './query-parser';\n\ntype Filter = {\n  matches: (ann: Annotation) => boolean;\n};\n\n/**\n * A Matcher specifies how to test whether an annotation matches a query term\n * for a specific field.\n */\ntype Matcher<T = string> = {\n  /** Extract the field values to be matched against a query term */\n  fieldValues: (ann: Annotation) => T[];\n\n  /**\n   * Test whether a query term matches a field value. Both value and term will\n   * have been normalized using `normalize`.\n   */\n  matches: (value: T, term: T) => boolean;\n\n  /** Normalize a parsed term or field value for comparison */\n  normalize: (val: T) => T;\n};\n\n/**\n * Normalize a string query term or field value.\n */\nfunction normalizeStr(val: string): string {\n  return unicodeUtils.fold(unicodeUtils.normalize(val)).toLowerCase();\n}\n\n/**\n * Filter that matches annotations against a single query term.\n */\nclass TermFilter<TermType extends string> implements Filter {\n  term: TermType;\n  matcher: Matcher<TermType>;\n\n  constructor(term: TermType, matcher: Matcher<TermType>) {\n    this.term = matcher.normalize(term);\n    this.matcher = matcher;\n  }\n\n  /**\n   * Return true if an annotation matches this filter.\n   */\n  matches(ann: Annotation): boolean {\n    const matcher = this.matcher;\n    return matcher\n      .fieldValues(ann)\n      .some(value => matcher.matches(matcher.normalize(value), this.term));\n  }\n}\n\n/**\n * Filter that combines other filters using AND or OR combinators.\n */\nclass BooleanOpFilter implements Filter {\n  operator: 'and' | 'or';\n  filters: Filter[];\n\n  /**\n   * @param op - Boolean operator\n   * @param filters - Array of filters to test against\n   */\n  constructor(op: 'and' | 'or', filters: Filter[]) {\n    this.operator = op;\n    this.filters = filters;\n  }\n\n  /**\n   * Return true if an annotation matches this filter.\n   */\n  matches(ann: Annotation): boolean {\n    if (this.operator === 'and') {\n      return this.filters.every(filter => filter.matches(ann));\n    } else {\n      return this.filters.some(filter => filter.matches(ann));\n    }\n  }\n}\n\n/**\n * Create a matcher that tests whether a query term appears anywhere in a\n * string field value.\n */\nfunction stringFieldMatcher(\n  fieldValues: (ann: Annotation) => string[],\n): Matcher {\n  return {\n    fieldValues,\n    matches: (value, term) => value.includes(term),\n    normalize: normalizeStr,\n  };\n}\n\n/**\n * Map of field name (from a parsed query) to matcher for that field.\n */\nconst fieldMatchers: Record<string, Matcher | Matcher<number>> = {\n  quote: stringFieldMatcher(ann => [quote(ann) ?? '']),\n\n  cfi: {\n    fieldValues: ann => [getCFI(ann)?.trim() ?? ''],\n    matches: (cfi: string, cfiTerm: string) => {\n      // Here we use \"-\" as a separator between the start and end part of the\n      // range, as it is easy to parse.\n      //\n      // If we wanted to use a more standard CFI range representation,\n      // we could follow https://idpf.org/epub/linking/cfi/#sec-ranges.\n      //\n      // If `cfiTerm` does not contain a hyphen, the result will be an empty\n      // range that does not match any CFIs.\n      const [start, end] = splitCFIRange(cfiTerm);\n      return cfiInRange(cfi, start, end);\n    },\n    normalize: (val: string) => stripCFIAssertions(val.trim()),\n  },\n\n  page: {\n    fieldValues: ann => [pageLabel(ann)?.trim() ?? ''],\n    matches: (pageLabel: string, pageTerm: string) =>\n      pageLabelInRange(pageLabel, pageTerm),\n    normalize: (val: string) => val.trim(),\n  },\n\n  since: {\n    fieldValues: ann => [new Date(ann.updated).valueOf()],\n    matches: (updatedTime: number, age: number) => {\n      const delta = (Date.now() - updatedTime) / 1000;\n      return delta <= age;\n    },\n    normalize: (timestamp: number) => timestamp,\n  },\n\n  tag: stringFieldMatcher(ann => ann.tags),\n  text: stringFieldMatcher(ann => [ann.text]),\n  uri: stringFieldMatcher(ann => [ann.uri]),\n  user: stringFieldMatcher(ann => [\n    ann.user,\n    ann.user_info?.display_name ?? '',\n  ]),\n};\n\n/**\n * Filter a set of annotations against a parsed query.\n */\nexport function filterAnnotations(\n  annotations: Annotation[],\n  filters: Record<string, Facet>,\n): Annotation[] {\n  const makeTermFilter = <TermType>(field: string, term: TermType) =>\n    new TermFilter(\n      term,\n      // Suppress error about potential mismatch of query term type\n      // and what the matcher expects. We assume these match up.\n      fieldMatchers[field] as Matcher<any>,\n    );\n\n  // Convert the input filter object into a filter tree, expanding \"any\"\n  // filters.\n  const fieldFilters = Object.entries(filters)\n    .filter(([, filter]) => filter.terms.length > 0)\n    .map(([field, filter]) => {\n      let termFilters;\n      if (field === 'any') {\n        const anyFields = ['quote', 'text', 'tag', 'user'];\n        termFilters = filter.terms.map(\n          term =>\n            new BooleanOpFilter(\n              'or',\n              anyFields.map(field => makeTermFilter(field, term)),\n            ),\n        );\n      } else {\n        termFilters = filter.terms.map(term => makeTermFilter(field, term));\n      }\n      return new BooleanOpFilter(filter.operator, termFilters);\n    });\n\n  const rootFilter = new BooleanOpFilter('and', fieldFilters);\n\n  return annotations.filter(ann => rootFilter.matches(ann));\n}\n","const filterFields = [\n  'cfi',\n  'quote',\n  'page',\n  'since',\n  'tag',\n  'text',\n  'uri',\n  'user',\n] as const;\n\n/**\n * Names of supported fields that can be specified via `{filename}:{term}`\n * in {@link parseFilterQuery}.\n */\nexport type FilterField = (typeof filterFields)[number];\n\nconst searchFields = ['group', 'quote', 'tag', 'text', 'uri', 'user'] as const;\n\n/**\n * Names of fields that can be used in `{field}:{term}` queries with\n * {@link parseHypothesisSearchQuery}.\n */\nexport type SearchField = (typeof searchFields)[number];\n\n/**\n * Splits a search term into filter and data.\n *\n * eg. 'user:johndoe' -> ['user', 'johndoe']\n *     'example:text' -> [null, 'example:text']\n *\n * @param term - The query term to parse\n * @param fieldNames - The set of recognized field names\n */\nfunction splitTerm(\n  term: string,\n  fieldNames: readonly string[],\n): [null | string, string] {\n  const filter = term.slice(0, term.indexOf(':'));\n  if (!filter) {\n    // The whole term is data\n    return [null, term];\n  }\n\n  if (fieldNames.includes(filter)) {\n    const data = term.slice(filter.length + 1);\n    return [filter, data];\n  } else {\n    // The filter is not a power search filter, so the whole term is data\n    return [null, term];\n  }\n}\n\n/**\n * Remove a quote character from the beginning and end of the string, but\n * only if they match. ie:\n *\n *   'foo' -> foo\n *   \"bar\" -> bar\n *   'foo\" -> 'foo\"\n *    bar\"  -> bar\"\n */\nfunction removeSurroundingQuotes(text: string) {\n  const start = text.slice(0, 1);\n  const end = text.slice(-1);\n  if ((start === '\"' || start === \"'\") && start === end) {\n    text = text.slice(1, text.length - 1);\n  }\n  return text;\n}\n\n/**\n * Tokenize a search query.\n *\n * Split `query` into an array of non-empty tokens. Terms not contained\n * within quotes are split on whitespace. Terms inside single or double quotes\n * are returned as whole tokens, with the surrounding quotes removed.\n */\nfunction tokenize(query: string, fieldNames: readonly string[]): string[] {\n  const tokenMatches = query.match(/(?:[^\\s\"']+|\"[^\"]*\"|'[^']*')+/g);\n  if (!tokenMatches) {\n    return [];\n  }\n\n  return tokenMatches\n    .map(removeSurroundingQuotes)\n    .filter(token => token.length > 0)\n    .map(token => {\n      // Strip quotes from field values.\n      // eg. `tag:\"foo bar\"` => `tag:foo bar`.\n      const [filter, data] = splitTerm(token, fieldNames);\n      if (filter) {\n        return filter + ':' + removeSurroundingQuotes(data);\n      } else {\n        return token;\n      }\n    });\n}\n\n/**\n * Parse a user-provided query (\"term:value ...\") into a key/value map that can\n * be used when constructing queries to the Hypothesis search API.\n */\nexport function parseHypothesisSearchQuery(\n  query: string,\n): Record<string, string[]> {\n  const obj = {} as Record<string, string[]>;\n\n  const backendFilter = (field: string) => (field === 'tag' ? 'tags' : field);\n\n  const terms = tokenize(query, searchFields);\n  for (const term of terms) {\n    let [field, data] = splitTerm(term, searchFields);\n    if (!field) {\n      field = 'any';\n      data = term;\n    }\n\n    const backendField = backendFilter(field);\n    if (obj[backendField]) {\n      obj[backendField].push(data);\n    } else {\n      obj[backendField] = [data];\n    }\n  }\n\n  return obj;\n}\n\nexport type Facet = {\n  /**\n   * Whether to require annotations match all values in `terms` (\"and\") or at\n   * least one value in `terms` (\"or\").\n   */\n  operator: 'and' | 'or';\n  terms: string[] | number[];\n\n  /**\n   * Whether this facet is relevant for replies.\n   *\n   * This is true for facets such as annotation bodies, which both annotations\n   * and replies have, but false for eg. page numbers, which only annotations\n   * have.\n   */\n  filterReplies: boolean;\n};\n\nexport type ParsedQuery = Record<FilterField | 'any', Facet>;\n\n/**\n * Parse a user-provided query into a map of filter field to term.\n *\n * Terms that are not associated with any particular field are stored under the\n * \"any\" property.\n *\n * @param query - Filter query to parse\n * @param addedFilters - Additional query terms to merge with the results of\n *   parsing `query`.\n */\nexport function parseFilterQuery(\n  query: string,\n  addedFilters: Partial<Record<FilterField, string>> = {},\n): ParsedQuery {\n  const initialTerms = (field: FilterField) => {\n    const init = addedFilters[field];\n    if (typeof init === 'string') {\n      return [init];\n    } else {\n      return [];\n    }\n  };\n\n  const cfi = initialTerms('cfi');\n  const page = initialTerms('page');\n  const quote = initialTerms('quote');\n  const tag = initialTerms('tag');\n  const text = initialTerms('text');\n  const uri = initialTerms('uri');\n  const user = initialTerms('user');\n\n  const any = [];\n  const since: number[] = [];\n\n  const terms = tokenize(query, filterFields);\n\n  for (const term of terms) {\n    const filter = term.slice(0, term.indexOf(':'));\n    const fieldValue = term.slice(filter.length + 1);\n\n    switch (filter) {\n      case 'cfi':\n        cfi.push(fieldValue);\n        break;\n      case 'quote':\n        quote.push(fieldValue);\n        break;\n      case 'page':\n        page.push(fieldValue);\n        break;\n      case 'since':\n        {\n          const time = term.slice(6).toLowerCase();\n          const secondsPerDay = 24 * 60 * 60;\n          const secondsPerUnit = {\n            sec: 1,\n            min: 60,\n            hour: 60 * 60,\n            day: secondsPerDay,\n            week: 7 * secondsPerDay,\n            month: 30 * secondsPerDay,\n            year: 365 * secondsPerDay,\n          };\n          const match = time.match(\n            /^(\\d+)(sec|min|hour|day|week|month|year)?$/,\n          );\n          if (match) {\n            const value = parseFloat(match[1]);\n            const unit = (match[2] || 'sec') as keyof typeof secondsPerUnit;\n            since.push(value * secondsPerUnit[unit]);\n          }\n        }\n        break;\n      case 'tag':\n        tag.push(fieldValue);\n        break;\n      case 'text':\n        text.push(fieldValue);\n        break;\n      case 'uri':\n        uri.push(fieldValue);\n        break;\n      case 'user':\n        user.push(fieldValue);\n        break;\n      default:\n        any.push(term);\n    }\n  }\n\n  // Filter terms use an \"AND\" operator if it is possible for an annotation to\n  // match more than one term (eg. an annotation can have multiple tags) or \"OR\"\n  // otherwise (eg. an annotation cannot match two distinct user terms).\n\n  return {\n    any: {\n      terms: any,\n      operator: 'and',\n      filterReplies: true,\n    },\n    cfi: {\n      terms: cfi,\n      operator: 'or',\n      filterReplies: false,\n    },\n    quote: {\n      terms: quote,\n      operator: 'and',\n      filterReplies: false,\n    },\n    page: {\n      terms: page,\n      operator: 'or',\n      filterReplies: false,\n    },\n    since: {\n      terms: since,\n      operator: 'and',\n      filterReplies: true,\n    },\n    tag: {\n      terms: tag,\n      operator: 'and',\n      filterReplies: true,\n    },\n    text: {\n      terms: text,\n      operator: 'and',\n      filterReplies: true,\n    },\n    uri: {\n      terms: uri,\n      operator: 'or',\n      filterReplies: false,\n    },\n    user: {\n      terms: user,\n      operator: 'or',\n      filterReplies: true,\n    },\n  };\n}\n","// Functions that determine which tab an annotation should be displayed in.\nimport type { Annotation } from '../../types/api';\nimport type { TabName } from '../../types/sidebar';\nimport * as metadata from '../helpers/annotation-metadata';\n\n/**\n * Return the tab in which an annotation should be displayed.\n */\nexport function tabForAnnotation(ann: Annotation): TabName {\n  if (metadata.isOrphan(ann)) {\n    return 'orphan';\n  } else if (metadata.isPageNote(ann)) {\n    return 'note';\n  } else {\n    return 'annotation';\n  }\n}\n\n/**\n * Return true if an annotation should be displayed in a given tab.\n */\nexport function shouldShowInTab(ann: Annotation, tab: TabName): boolean {\n  if (metadata.isWaitingToAnchor(ann)) {\n    // Until this annotation anchors or fails to anchor, we do not know which\n    // tab it should be displayed in.\n    return false;\n  }\n  return tabForAnnotation(ann) === tab;\n}\n","import { compareCFIs } from '../../shared/cfi';\nimport { location } from './annotation-metadata';\nimport type { Thread } from './build-thread';\nimport { rootAnnotations } from './thread';\n\n/**\n * Sort comparison function when one or both threads being compared is lacking\n * an annotation.\n * Sort such that a thread without an annotation sorts to the top\n */\nfunction compareHeadlessThreads(a: Thread, b: Thread): number {\n  if (!a.annotation && !b.annotation) {\n    return 0;\n  } else {\n    return !a.annotation ? -1 : 1;\n  }\n}\n\n/**\n * Find the most recent created date amongst a thread's root annotation set\n */\nfunction newestRootAnnotationDate(thread: Thread): string {\n  const annotations = rootAnnotations([thread]);\n  return annotations.reduce(\n    (newestDate, annotation) =>\n      annotation.created > newestDate ? annotation.created : newestDate,\n    '',\n  );\n}\n\n/**\n * Find the oldest created date amongst a thread's root annotation set\n */\nfunction oldestRootAnnotationDate(thread: Thread): string {\n  const annotations = rootAnnotations([thread]);\n  return annotations.reduce((oldestDate, annotation) => {\n    if (!oldestDate) {\n      oldestDate = annotation.created;\n    }\n    return annotation.created < oldestDate ? annotation.created : oldestDate;\n  }, '');\n}\n\n/**\n * Compare optional numeric values.\n */\nfunction compareNumbers(\n  a: number | undefined,\n  b: number | undefined,\n): number | undefined {\n  if (typeof a === 'number' && typeof b === 'number') {\n    return Math.sign(a - b);\n  } else {\n    return undefined;\n  }\n}\n\n/** Perform a lexicographic, locale-insensitive comparison of strings. */\nfunction compareStrings(a: string, b: string): number {\n  if (a === b) {\n    return 0;\n  } else if (a < b) {\n    return -1;\n  } else {\n    return 1;\n  }\n}\n\nexport type Options = {\n  /**\n   * Specifies which field to sort by.\n   *\n   * \"newest\" - Sort by creation date, newest first\n   * \"oldest\" - Sort by creation date, oldest first\n   * \"location\" - Sort by location with the document\n   */\n  sortBy: 'newest' | 'oldest' | 'location';\n};\n\n/**\n * Return a number indicating the sort ordering for two annotation threads.\n */\nexport function compareThreads(a: Thread, b: Thread, options: Options): number {\n  switch (options.sortBy) {\n    case 'newest': {\n      const dateA = newestRootAnnotationDate(a);\n      const dateB = newestRootAnnotationDate(b);\n      return compareStrings(dateB, dateA);\n    }\n    case 'oldest': {\n      const dateA = oldestRootAnnotationDate(a);\n      const dateB = oldestRootAnnotationDate(b);\n      return compareStrings(dateA, dateB);\n    }\n    case 'location':\n      return compareByLocation(a, b);\n    /* istanbul ignore next */\n    default:\n      return 0;\n  }\n}\n\nfunction compareByLocation(a: Thread, b: Thread): number {\n  if (!a.annotation || !b.annotation) {\n    return compareHeadlessThreads(a, b);\n  }\n\n  const aLocation = location(a.annotation);\n  const bLocation = location(b.annotation);\n\n  // Compare by chapter. Applicable for annotations on EPUBs with CFIs.\n  if (aLocation.cfi && bLocation.cfi) {\n    const cfiResult = compareCFIs(aLocation.cfi, bLocation.cfi);\n    if (cfiResult !== 0) {\n      // Annotations are in different chapters.\n      return Math.sign(cfiResult);\n    }\n  }\n\n  // Compare by page index.\n  const pageOrder = compareNumbers(aLocation.pageIndex, bLocation.pageIndex);\n  if (pageOrder !== undefined && pageOrder !== 0) {\n    return pageOrder;\n  }\n\n  // Compare by position relative to top of page.\n  const topOrder = compareNumbers(aLocation.top, bLocation.top);\n  if (topOrder !== undefined && topOrder !== 0) {\n    return topOrder;\n  }\n\n  // Compare by character offset within the document text.\n  const textOrder = compareNumbers(aLocation.charOffset, bLocation.charOffset);\n  if (textOrder !== undefined && textOrder !== 0) {\n    return textOrder;\n  }\n\n  // If we can't order the annotations by location, fall back to comparing\n  // by creation date.\n  return compareStrings(a.annotation.created, b.annotation.created);\n}\n","import type { Annotation } from '../../types/api';\nimport { memoize } from '../util/memoize';\nimport { isWaitingToAnchor } from './annotation-metadata';\nimport { buildThread } from './build-thread';\nimport type { Thread, BuildThreadOptions } from './build-thread';\nimport { filterAnnotations } from './filter-annotations';\nimport { parseFilterQuery } from './query-parser';\nimport type { FilterField, ParsedQuery } from './query-parser';\nimport { tabForAnnotation } from './tabs';\nimport { compareThreads } from './thread-sorters';\n\nexport type ThreadState = {\n  annotations: Annotation[];\n  showTabs: boolean;\n  selection: {\n    expanded: Record<string, boolean>;\n    filterQuery: string | null;\n    filters: Partial<Record<FilterField, string>>;\n    forcedVisible: string[];\n    selected: string[];\n    sortKey: 'oldest' | 'newest' | 'location';\n    selectedTab: 'annotation' | 'note' | 'orphan';\n  };\n};\n\nexport type ThreadAnnotationsResult = {\n  /**\n   * Count of annotations for each tab.\n   *\n   * These are only computed if {@link ThreadState.showTabs} is true.\n   */\n  tabCounts: {\n    annotation: number;\n    note: number;\n    orphan: number;\n  };\n\n  /**\n   * Root thread containing all annotation threads that match the current\n   * filters and selected tab.\n   */\n  rootThread: Thread;\n};\n\n/**\n * Cobble together the right set of options and filters based on current\n * `threadState` to build the root thread.\n */\nfunction threadAnnotationsImpl(\n  threadState: ThreadState,\n): ThreadAnnotationsResult {\n  const selection = threadState.selection;\n  const options: BuildThreadOptions = {\n    expanded: selection.expanded,\n    forcedVisible: selection.forcedVisible,\n    selected: selection.selected,\n    sortCompareFn: (a, b) =>\n      compareThreads(a, b, { sortBy: selection.sortKey }),\n  };\n\n  // Is there a filter query present, or an applied user (focus) filter?\n  // If so, we'll need to filter the annotations\n  const annotationsFiltered =\n    !!selection.filterQuery || Object.keys(selection.filters).length > 0;\n\n  if (annotationsFiltered) {\n    const filters = parseFilterQuery(\n      selection.filterQuery || '',\n      selection.filters,\n    );\n\n    // Split filters into those which apply to both annotations and replies,\n    // and those which should only be applied to threads.\n    const annotationFilters: Partial<ParsedQuery> = {};\n    const threadFilters: Partial<ParsedQuery> = {};\n    for (const [field, facet] of Object.entries(filters)) {\n      if (facet.filterReplies) {\n        annotationFilters[field as FilterField] = facet;\n      } else {\n        threadFilters[field as FilterField] = facet;\n      }\n    }\n\n    options.filterFn = ann =>\n      filterAnnotations([ann], annotationFilters).length > 0;\n\n    if (Object.values(threadFilters).some(facet => facet.terms.length > 0)) {\n      options.threadFilterFn = thread =>\n        !!thread.annotation &&\n        filterAnnotations([thread.annotation], threadFilters).length > 0;\n    }\n  }\n\n  const rootThread = buildThread(threadState.annotations, options);\n\n  const tabCounts = {\n    annotation: 0,\n    note: 0,\n    orphan: 0,\n  };\n\n  if (threadState.showTabs) {\n    rootThread.children = rootThread.children.filter(thread => {\n      // If the root annotation in this thread has been deleted, we don't know\n      // which tab it used to be in.\n      if (!thread.annotation) {\n        return false;\n      }\n\n      // If this annotation is still anchoring, we do not know whether it should\n      // appear in the \"Annotations\" or \"Orphans\" tab.\n      if (isWaitingToAnchor(thread.annotation)) {\n        return false;\n      }\n\n      const tab = tabForAnnotation(thread.annotation);\n      tabCounts[tab] += 1;\n      return tab === selection.selectedTab;\n    });\n  }\n\n  return { tabCounts, rootThread };\n}\n\nexport const threadAnnotations = memoize(threadAnnotationsImpl);\n","/**\n * A simple memoization function which caches the last result of\n * a single-argument function.\n *\n * The argument to the input function may be of any type and is compared\n * using reference equality.\n */\nexport function memoize<Arg, Result>(\n  fn: (arg: Arg) => Result,\n): (arg: Arg) => Result {\n  if (fn.length !== 1) {\n    throw new Error('Memoize input must be a function of one argument');\n  }\n\n  let lastArg: Arg;\n  let lastResult: Result;\n\n  return function (arg) {\n    if (arg === lastArg) {\n      return lastResult;\n    }\n    lastArg = arg;\n    lastResult = fn(arg);\n    return lastResult;\n  };\n}\n","import { useMemo } from 'preact/hooks';\n\nimport { threadAnnotations } from '../../helpers/thread-annotations';\nimport type {\n  ThreadAnnotationsResult,\n  ThreadState,\n} from '../../helpers/thread-annotations';\nimport { useSidebarStore } from '../../store';\n\n/**\n * Gather together state relevant to building a root thread of annotations and\n * replies and return an updated root thread when changes occur.\n */\nexport function useRootThread(): ThreadAnnotationsResult {\n  const store = useSidebarStore();\n  const annotations = store.allAnnotations();\n  const query = store.filterQuery();\n  const route = store.route();\n  const selectionState = store.selectionState();\n  const filters = store.getFilterValues();\n  const showTabs = route === 'sidebar';\n\n  const threadState = useMemo((): ThreadState => {\n    const selection = { ...selectionState, filterQuery: query, filters };\n    return {\n      annotations,\n      selection,\n      showTabs,\n    };\n  }, [annotations, query, selectionState, filters, showTabs]);\n\n  return threadAnnotations(threadState);\n}\n","import { useEffect, useState } from 'preact/hooks';\n\nimport { withServices } from '../service-context';\nimport type { LoadAnnotationsService } from '../services/load-annotations';\nimport { useSidebarStore } from '../store';\nimport SidebarContentError from './SidebarContentError';\nimport ThreadList from './ThreadList';\nimport { useRootThread } from './hooks/use-root-thread';\n\ntype AnnotationViewProps = {\n  onLogin: () => void;\n\n  // Injected\n  loadAnnotationsService: LoadAnnotationsService;\n};\n\n/**\n * The main content for the single annotation page (aka. https://hypothes.is/a/<annotation ID>)\n */\nfunction AnnotationView({\n  loadAnnotationsService,\n  onLogin,\n}: AnnotationViewProps) {\n  const store = useSidebarStore();\n  const annotationId = store.routeParams().id ?? '';\n  const { rootThread } = useRootThread();\n  const userid = store.profile().userid;\n\n  const [fetchError, setFetchError] = useState(false);\n\n  useEffect(() => {\n    setFetchError(false);\n    store.clearAnnotations();\n\n    loadAnnotationsService\n      .loadThread(annotationId)\n      .then(annots => {\n        // Find the top-level annotation in the thread that `annotationId` is\n        // part of. This will be different to `annotationId` if `annotationId`\n        // is a reply. A top-level annotation will not have any references.\n        const topLevelAnnot = annots.filter(\n          ann => (ann.references || []).length === 0,\n        )[0];\n\n        if (!topLevelAnnot) {\n          // We were able to fetch annotations in the thread that `annotationId`\n          // is part of (note that `annotationId` may refer to a reply) but\n          // couldn't find a top-level (non-reply) annotation in that thread.\n          //\n          // This might happen if the top-level annotation was deleted or\n          // moderated or had its permissions changed.\n          //\n          // We need to decide what what be the most useful behavior in this case\n          // and implement it.\n          /* istanbul ignore next */\n          return;\n        }\n\n        // Make the full thread of annotations visible. By default replies are\n        // not shown until the user expands the thread.\n        annots.forEach(annot => annot.id && store.setExpanded(annot.id, true));\n\n        if (topLevelAnnot.id !== annotationId) {\n          store.highlightAnnotations([annotationId]);\n        }\n      })\n      .catch(() => {\n        setFetchError(true);\n      });\n  }, [\n    annotationId,\n\n    // This is not used by the effect but ensures that the annotation is\n    // fetched after the user logs in/out, in case the annotation is private.\n    userid,\n\n    // Static dependencies.\n    loadAnnotationsService,\n    store,\n  ]);\n\n  return (\n    <>\n      {fetchError && (\n        // This is the same error shown if a direct-linked annotation cannot\n        // be fetched in the sidebar. Fortunately the error message makes sense\n        // for this scenario as well.\n        <SidebarContentError errorType=\"annotation\" onLoginRequest={onLogin} />\n      )}\n      <ThreadList threads={rootThread.children} />\n    </>\n  );\n}\n\nexport default withServices(AnnotationView, ['loadAnnotationsService']);\n","import type { SegmentInfo } from '../../types/annotator';\nimport type { Frame } from '../store/modules/frames';\n\ntype UserDetails = {\n  userid?: string | null;\n  displayName?: string;\n};\n\nexport class VersionData {\n  version: string;\n  userAgent: string;\n  urls: string;\n  fingerprint: string;\n  account: string;\n  timestamp: string;\n  segment: string | undefined;\n\n  /**\n   * @param documentFrames - Metadata for connected frames.\n   *   If there are multiple frames, the \"main\" one should be listed first.\n   * @param window_ - test seam\n   */\n  constructor(\n    userInfo: UserDetails,\n    documentFrames: Frame[],\n    window_: Window = window,\n  ) {\n    const noValueString = 'N/A';\n\n    let accountString = noValueString;\n    if (userInfo.userid) {\n      accountString = userInfo.userid;\n      if (userInfo.displayName) {\n        accountString = `${userInfo.displayName} (${accountString})`;\n      }\n    }\n\n    this.version = '__VERSION__';\n    this.userAgent = window_.navigator.userAgent;\n    this.urls = documentFrames.map(df => df.uri).join(', ') || noValueString;\n\n    // We currently assume that only the main (first) frame may have a fingerprint.\n    this.fingerprint =\n      documentFrames[0]?.metadata?.documentFingerprint ?? noValueString;\n\n    this.account = accountString;\n    this.timestamp = new Date().toString();\n\n    const segmentInfo: SegmentInfo | undefined = documentFrames[0]?.segment;\n    if (segmentInfo) {\n      const segmentFields = [];\n      if (segmentInfo.cfi) {\n        segmentFields.push(['CFI', segmentInfo.cfi]);\n      }\n      if (segmentInfo.pages) {\n        const range = `${segmentInfo.pages.start}-${segmentInfo.pages.end}`;\n        segmentFields.push(['Pages', range]);\n      }\n      if (segmentInfo.url) {\n        segmentFields.push(['URL', segmentInfo.url]);\n      }\n\n      this.segment = segmentFields\n        .map(([field, value]) => `${field}: ${value}`)\n        .join(', ');\n    }\n  }\n\n  /**\n   * Return a single formatted string representing version data, suitable for\n   * copying to the clipboard.\n   *\n   * @return Single, multiline string representing current version data\n   */\n  asFormattedString(): string {\n    return `Version: ${this.version}\nUser Agent: ${this.userAgent}\nURL: ${this.urls}\nFingerprint: ${this.fingerprint}\nAccount: ${this.account}\nDate: ${this.timestamp}\n`;\n  }\n\n  /**\n   * Return a single, encoded URL string of version data suitable for use in\n   * a querystring (as the value of a single parameter)\n   *\n   * @return URI-encoded string\n   */\n  asEncodedURLString(): string {\n    return encodeURIComponent(this.asFormattedString());\n  }\n}\n","var COMPLETE = 'complete',\n    CANCELED = 'canceled';\n\nfunction raf(task){\n    if('requestAnimationFrame' in window){\n        return window.requestAnimationFrame(task);\n    }\n\n    setTimeout(task, 16);\n}\n\nfunction setElementScroll(element, x, y){\n    Math.max(0, x);\n    Math.max(0, y);\n\n    if(element.self === element){\n        element.scrollTo(x, y);\n    }else{\n        element.scrollLeft = x;\n        element.scrollTop = y;\n    }\n}\n\nfunction getTargetScrollLocation(scrollSettings, parent){\n    var align = scrollSettings.align,\n        target = scrollSettings.target,\n        targetPosition = target.getBoundingClientRect(),\n        parentPosition,\n        x,\n        y,\n        differenceX,\n        differenceY,\n        targetWidth,\n        targetHeight,\n        leftAlign = align && align.left != null ? align.left : 0.5,\n        topAlign = align && align.top != null ? align.top : 0.5,\n        leftOffset = align && align.leftOffset != null ? align.leftOffset : 0,\n        topOffset = align && align.topOffset != null ? align.topOffset : 0,\n        leftScalar = leftAlign,\n        topScalar = topAlign;\n\n    if(scrollSettings.isWindow(parent)){\n        targetWidth = Math.min(targetPosition.width, parent.innerWidth);\n        targetHeight = Math.min(targetPosition.height, parent.innerHeight);\n        x = targetPosition.left + parent.pageXOffset - parent.innerWidth * leftScalar + targetWidth * leftScalar;\n        y = targetPosition.top + parent.pageYOffset - parent.innerHeight * topScalar + targetHeight * topScalar;\n        x -= leftOffset;\n        y -= topOffset;\n        x = scrollSettings.align.lockX ? parent.pageXOffset : x;\n        y = scrollSettings.align.lockY ? parent.pageYOffset : y;\n        differenceX = x - parent.pageXOffset;\n        differenceY = y - parent.pageYOffset;\n    }else{\n        targetWidth = targetPosition.width;\n        targetHeight = targetPosition.height;\n        parentPosition = parent.getBoundingClientRect();\n        var offsetLeft = targetPosition.left - (parentPosition.left - parent.scrollLeft);\n        var offsetTop = targetPosition.top - (parentPosition.top - parent.scrollTop);\n        x = offsetLeft + (targetWidth * leftScalar) - parent.clientWidth * leftScalar;\n        y = offsetTop + (targetHeight * topScalar) - parent.clientHeight * topScalar;\n        x -= leftOffset;\n        y -= topOffset;\n        x = Math.max(Math.min(x, parent.scrollWidth - parent.clientWidth), 0);\n        y = Math.max(Math.min(y, parent.scrollHeight - parent.clientHeight), 0);\n        x = scrollSettings.align.lockX ? parent.scrollLeft : x;\n        y = scrollSettings.align.lockY ? parent.scrollTop : y;\n        differenceX = x - parent.scrollLeft;\n        differenceY = y - parent.scrollTop;\n    }\n\n    return {\n        x: x,\n        y: y,\n        differenceX: differenceX,\n        differenceY: differenceY\n    };\n}\n\nfunction animate(parent){\n    var scrollSettings = parent._scrollSettings;\n\n    if(!scrollSettings){\n        return;\n    }\n\n    var maxSynchronousAlignments = scrollSettings.maxSynchronousAlignments;\n\n    var location = getTargetScrollLocation(scrollSettings, parent),\n        time = Date.now() - scrollSettings.startTime,\n        timeValue = Math.min(1 / scrollSettings.time * time, 1);\n\n    if(scrollSettings.endIterations >= maxSynchronousAlignments){\n        setElementScroll(parent, location.x, location.y);\n        parent._scrollSettings = null;\n        return scrollSettings.end(COMPLETE);\n    }\n\n    var easeValue = 1 - scrollSettings.ease(timeValue);\n\n    setElementScroll(parent,\n        location.x - location.differenceX * easeValue,\n        location.y - location.differenceY * easeValue\n    );\n\n    if(time >= scrollSettings.time){\n        scrollSettings.endIterations++;\n        // Align ancestor synchronously\n        scrollSettings.scrollAncestor && animate(scrollSettings.scrollAncestor);\n        animate(parent);\n        return;\n    }\n\n    raf(animate.bind(null, parent));\n}\n\nfunction defaultIsWindow(target){\n    return target.self === target\n}\n\nfunction transitionScrollTo(target, parent, settings, scrollAncestor, callback){\n    var idle = !parent._scrollSettings,\n        lastSettings = parent._scrollSettings,\n        now = Date.now(),\n        cancelHandler,\n        passiveOptions = { passive: true };\n\n    if(lastSettings){\n        lastSettings.end(CANCELED);\n    }\n\n    function end(endType){\n        parent._scrollSettings = null;\n\n        if(parent.parentElement && parent.parentElement._scrollSettings){\n            parent.parentElement._scrollSettings.end(endType);\n        }\n\n        if(settings.debug){\n            console.log('Scrolling ended with type', endType, 'for', parent)\n        }\n\n        callback(endType);\n        if(cancelHandler){\n            parent.removeEventListener('touchstart', cancelHandler, passiveOptions);\n            parent.removeEventListener('wheel', cancelHandler, passiveOptions);\n        }\n    }\n\n    var maxSynchronousAlignments = settings.maxSynchronousAlignments;\n\n    if(maxSynchronousAlignments == null){\n        maxSynchronousAlignments = 3;\n    }\n\n    parent._scrollSettings = {\n        startTime: now,\n        endIterations: 0,\n        target: target,\n        time: settings.time,\n        ease: settings.ease,\n        align: settings.align,\n        isWindow: settings.isWindow || defaultIsWindow,\n        maxSynchronousAlignments: maxSynchronousAlignments,\n        end: end,\n        scrollAncestor\n    };\n\n    if(!('cancellable' in settings) || settings.cancellable){\n        cancelHandler = end.bind(null, CANCELED);\n        parent.addEventListener('touchstart', cancelHandler, passiveOptions);\n        parent.addEventListener('wheel', cancelHandler, passiveOptions);\n    }\n\n    if(idle){\n        animate(parent);\n    }\n\n    return cancelHandler\n}\n\nfunction defaultIsScrollable(element){\n    return (\n        'pageXOffset' in element ||\n        (\n            element.scrollHeight !== element.clientHeight ||\n            element.scrollWidth !== element.clientWidth\n        ) &&\n        getComputedStyle(element).overflow !== 'hidden'\n    );\n}\n\nfunction defaultValidTarget(){\n    return true;\n}\n\nfunction findParentElement(el){\n    if (el.assignedSlot) {\n        return findParentElement(el.assignedSlot);\n    }\n\n    if (el.parentElement) {\n        if(el.parentElement.tagName.toLowerCase() === 'body'){\n            return el.parentElement.ownerDocument.defaultView || el.parentElement.ownerDocument.ownerWindow;\n        }\n        return el.parentElement;\n    }\n\n    if (el.getRootNode){\n        var parent = el.getRootNode()\n        if(parent.nodeType === 11) {\n            return parent.host;\n        }\n    }\n}\n\nmodule.exports = function(target, settings, callback){\n    if(!target){\n        return;\n    }\n\n    if(typeof settings === 'function'){\n        callback = settings;\n        settings = null;\n    }\n\n    if(!settings){\n        settings = {};\n    }\n\n    settings.time = isNaN(settings.time) ? 1000 : settings.time;\n    settings.ease = settings.ease || function(v){return 1 - Math.pow(1 - v, v / 2);};\n    settings.align = settings.align || {};\n\n    var parent = findParentElement(target),\n        parents = 1;\n\n    function done(endType){\n        parents--;\n        if(!parents){\n            callback && callback(endType);\n        }\n    }\n\n    var validTarget = settings.validTarget || defaultValidTarget;\n    var isScrollable = settings.isScrollable;\n\n    if(settings.debug){\n        console.log('About to scroll to', target)\n\n        if(!parent){\n            console.error('Target did not have a parent, is it mounted in the DOM?')\n        }\n    }\n\n    var scrollingElements = [];\n\n    while(parent){\n        if(settings.debug){\n            console.log('Scrolling parent node', parent)\n        }\n\n        if(validTarget(parent, parents) && (isScrollable ? isScrollable(parent, defaultIsScrollable) : defaultIsScrollable(parent))){\n            parents++;\n            scrollingElements.push(parent);\n        }\n\n        parent = findParentElement(parent);\n\n        if(!parent){\n            done(COMPLETE)\n            break;\n        }\n    }\n\n    return scrollingElements.reduce((cancel, parent, index) => transitionScrollTo(target, parent, settings, scrollingElements[index + 1], done), null);\n};\n","import type { DialogProps } from '@hypothesis/frontend-shared';\nimport { Dialog, Slider } from '@hypothesis/frontend-shared';\nimport type { IconComponent } from '@hypothesis/frontend-shared/lib/types';\nimport type { ComponentChildren } from 'preact';\nimport { useCallback, useEffect, useRef } from 'preact/hooks';\nimport scrollIntoView from 'scroll-into-view';\n\nimport type { PanelName } from '../../types/sidebar';\nimport { useSidebarStore } from '../store';\n\nexport type SidebarPanelProps = {\n  children: ComponentChildren;\n  /** An optional icon name for display next to the panel's title */\n  icon?: IconComponent;\n  /**\n   * A string identifying this panel. Only one `panelName` may be active at any\n   * time. Multiple panels with the same `panelName` would be \"in sync\", opening\n   * and closing together.\n   */\n  panelName: PanelName;\n  title: string;\n  /** Optional callback to invoke when this panel's active status changes */\n  onActiveChanged?: (active: boolean) => void;\n  /** What Dialog variant to use */\n  variant?: 'panel' | 'custom';\n  initialFocus?: DialogProps['initialFocus'];\n};\n\n/**\n * Base component for a sidebar panel. Only one sidebar panel\n * (as defined by the panel's `panelName`) is active (visible) at one time.\n */\nexport default function SidebarPanel({\n  children,\n  icon,\n  panelName,\n  title,\n  variant = 'panel',\n  onActiveChanged,\n  initialFocus,\n}: SidebarPanelProps) {\n  const store = useSidebarStore();\n  const panelIsActive = store.isSidebarPanelOpen(panelName);\n\n  const panelElement = useRef<HTMLDivElement | null>(null);\n  const panelWasActive = useRef(panelIsActive);\n\n  // Scroll the panel into view if it has just been opened\n  useEffect(() => {\n    if (panelWasActive.current !== panelIsActive) {\n      panelWasActive.current = panelIsActive;\n      if (panelIsActive && panelElement.current) {\n        scrollIntoView(panelElement.current);\n      }\n      onActiveChanged?.(panelIsActive);\n    }\n  }, [panelIsActive, onActiveChanged]);\n\n  const closePanel = useCallback(() => {\n    store.toggleSidebarPanel(panelName, false);\n  }, [store, panelName]);\n\n  return (\n    <>\n      {panelIsActive && (\n        <Dialog\n          initialFocus={initialFocus}\n          restoreFocus\n          ref={panelElement}\n          classes=\"mb-4\"\n          title={title}\n          icon={icon}\n          onClose={closePanel}\n          transitionComponent={Slider}\n          variant={variant}\n          scrollable={false}\n        >\n          {children}\n        </Dialog>\n      )}\n    </>\n  );\n}\n","import {\n  Link,\n  AnnotateIcon,\n  HighlightIcon,\n  ReplyIcon,\n} from '@hypothesis/frontend-shared';\nimport type { IconComponent } from '@hypothesis/frontend-shared/lib/types';\nimport classnames from 'classnames';\n\nimport type { SidebarSettings } from '../../types/config';\nimport { isThirdPartyService } from '../helpers/is-third-party-service';\nimport { withServices } from '../service-context';\n\ntype LabeledIconProps = {\n  /** Name of the \"command\" the instruction represents */\n  commandName: string;\n  icon: IconComponent;\n};\n\nfunction LabeledIcon({ commandName, icon: Icon }: LabeledIconProps) {\n  return (\n    <span className=\"whitespace-nowrap\" data-testid=\"instruction\">\n      <Icon\n        className={classnames(\n          'w-em h-em',\n          'mx-1 -mt-1', // Give horizontal space; pull up top margin a little\n          'text-color-text-light inline',\n        )}\n        // The icon is just a visual hint representing the command, but it\n        // provides no extra information\n        aria-hidden\n      />\n      <em data-testid=\"command-name\">{commandName}</em>\n    </span>\n  );\n}\n\nexport type TutorialProps = {\n  // injected\n  settings: SidebarSettings;\n};\n\n/**\n * Tutorial for using the sidebar app\n */\nfunction Tutorial({ settings }: TutorialProps) {\n  const canCreatePrivateGroups = !isThirdPartyService(settings);\n  return (\n    <ol className=\"list-decimal pl-10 space-y-2\">\n      <li>\n        To create an annotation, select text and then select the{' '}\n        <LabeledIcon icon={AnnotateIcon} commandName=\"Annotate\" /> button.\n      </li>\n      <li>\n        To create a highlight (\n        <Link\n          href=\"https://web.hypothes.is/help/why-are-highlights-private-by-default/\"\n          target=\"_blank\"\n          underline=\"always\"\n        >\n          visible only to you\n        </Link>\n        ), select text and then select the{' '}\n        <LabeledIcon icon={HighlightIcon} commandName=\"Highlight\" /> button.\n      </li>\n      {canCreatePrivateGroups && (\n        <li>\n          To annotate in a private group, select the group from the groups\n          dropdown. Don&apos;t see your group? Ask the group creator to send a{' '}\n          <Link\n            href=\"https://web.hypothes.is/help/how-to-join-a-private-group/\"\n            target=\"_blank\"\n            underline=\"always\"\n          >\n            join link\n          </Link>\n          .\n        </li>\n      )}\n      <li>\n        To reply to an annotation, select the{' '}\n        <LabeledIcon icon={ReplyIcon} commandName=\"Reply\" /> button.\n      </li>\n    </ol>\n  );\n}\n\nexport default withServices(Tutorial, ['settings']);\n","import { Button, CopyIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport type { ComponentChildren } from 'preact';\n\nimport type { VersionData } from '../helpers/version-data';\nimport { withServices } from '../service-context';\nimport type { ToastMessengerService } from '../services/toast-messenger';\nimport { copyPlainText } from '../util/copy-to-clipboard';\n\ntype VersionInfoItemProps = {\n  label: string;\n  children: ComponentChildren;\n  classes?: string;\n};\n\nfunction VersionInfoItem({ label, children, classes }: VersionInfoItemProps) {\n  return (\n    <>\n      <dt className=\"col-span-1 sm:text-right font-medium\">{label}</dt>\n      <dd\n        className={classnames(\n          'col-span-1 sm:col-span-3 text-color-text-light break-words',\n          classes,\n        )}\n      >\n        {children}\n      </dd>\n    </>\n  );\n}\n\nexport type VersionInfoProps = {\n  versionData: VersionData;\n\n  // injected\n  toastMessenger: ToastMessengerService;\n};\n\nfunction VersionInfo({ toastMessenger, versionData }: VersionInfoProps) {\n  const copyVersionData = async () => {\n    try {\n      await copyPlainText(versionData.asFormattedString());\n      toastMessenger.success('Copied version info to clipboard');\n    } catch {\n      toastMessenger.error('Unable to copy version info');\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <dl className=\"grid grid-cols-1 sm:grid-cols-4 sm:gap-x-2\">\n        <VersionInfoItem label=\"Version\">{versionData.version}</VersionInfoItem>\n        <VersionInfoItem label=\"User Agent\">\n          {versionData.userAgent}\n        </VersionInfoItem>\n        <VersionInfoItem\n          classes={classnames(\n            // Intermittent odd overflow behavior in Safari causes long strings\n            // with no wrap points to break layout — `overflow-wrap: break-words`\n            // is not reliable in this case. Use `break-all` here, which causes\n            // more inelgant wrapping in all browsers, but is safely contained\n            // in the layout.\n            // See: https://github.com/hypothesis/client/issues/4469\n            'break-all',\n          )}\n          label=\"URL\"\n        >\n          {versionData.urls}\n        </VersionInfoItem>\n        <VersionInfoItem label=\"Fingerprint\">\n          {versionData.fingerprint}\n        </VersionInfoItem>\n        {versionData.segment && (\n          <VersionInfoItem label=\"Segment\">\n            {versionData.segment}\n          </VersionInfoItem>\n        )}\n        <VersionInfoItem label=\"Account\">{versionData.account}</VersionInfoItem>\n        <VersionInfoItem label=\"Date\">{versionData.timestamp}</VersionInfoItem>\n      </dl>\n      <div className=\"flex items-center justify-center\">\n        <Button onClick={copyVersionData} icon={CopyIcon}>\n          Copy version details\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default withServices(VersionInfo, ['toastMessenger']);\n","import { CloseButton, TabList } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport type { ComponentChildren } from 'preact';\n\nexport type TabHeaderProps = {\n  children: ComponentChildren;\n  /** Title for the close button. */\n  closeTitle: string;\n};\n\n/**\n * Render a header to go above a Card, with contents in a TabList\n */\nexport default function TabHeader({ children, closeTitle }: TabHeaderProps) {\n  return (\n    <div data-testid=\"tab-header\" className=\"flex items-center\">\n      <CloseButton\n        classes={classnames(\n          // This element comes first in source order before tabs, but is\n          // positioned last. This puts this button earlier in the tab\n          // sequence than the tabs, allowing tabs to be immediately adjacent\n          // to their controlled tab panels/tab content in the tab sequence.\n          'order-last',\n          // Always render this button at 16px square regardless of parent\n          // font size\n          'text-[16px]',\n          'text-grey-6 hover:text-grey-7 hover:bg-grey-3/50',\n\n          // Keep the close button the same height on touch devices.\n          //\n          // This is needed so that the close button remains the same height as\n          // the `Tab` components rendered inside the `TabList`. See issue #6131.\n          'touch:!min-h-0',\n        )}\n        title={closeTitle}\n        variant=\"custom\"\n        size=\"sm\"\n      />\n      <TabList classes=\"grow gap-x-1 -mb-[1px] z-2\">{children}</TabList>\n    </div>\n  );\n}\n","import { CardTitle } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport type { ComponentChildren, JSX } from 'preact';\n\nexport type TabPanelProps = {\n  active?: boolean;\n  title?: ComponentChildren;\n} & JSX.HTMLAttributes<HTMLDivElement>;\n\n/**\n * Render a `role=\"tabpanel\"` element within a Card layout. It will be\n *  hidden unless `active`.\n */\nexport default function TabPanel({\n  children,\n  active,\n  title,\n  ...htmlAttributes\n}: TabPanelProps) {\n  return (\n    <div\n      role=\"tabpanel\"\n      {...htmlAttributes}\n      className={classnames('p-3 focus-visible-ring ring-inset', {\n        hidden: !active,\n      })}\n      hidden={!active}\n    >\n      {title && <CardTitle>{title}</CardTitle>}\n      <div className=\"space-y-3 pt-2\">{children}</div>\n    </div>\n  );\n}\n","import { Card, Link, Tab } from '@hypothesis/frontend-shared';\nimport { ExternalIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useCallback, useId, useMemo, useState } from 'preact/hooks';\n\nimport { username } from '../helpers/account-id';\nimport { VersionData } from '../helpers/version-data';\nimport { withServices } from '../service-context';\nimport type { SessionService } from '../services/session';\nimport { useSidebarStore } from '../store';\nimport SidebarPanel from './SidebarPanel';\nimport Tutorial from './Tutorial';\nimport VersionInfo from './VersionInfo';\nimport TabHeader from './tabs/TabHeader';\nimport TabPanel from './tabs/TabPanel';\n\ntype HelpPanelTabProps = {\n  /** What the tab's link should say. */\n  linkText: string;\n  /** Where the tab's link should go. */\n  url: string;\n};\n\n/**\n * External link \"tabs\" at the bottom of the help panel.\n */\nfunction HelpPanelTab({ linkText, url }: HelpPanelTabProps) {\n  return (\n    <div\n      // Set this element's flex-basis and also establish\n      // a flex container (centered on both axes)\n      className=\"flex-1 flex items-center justify-center border-r last-of-type:border-r-0 text-md font-medium\"\n    >\n      <Link variant=\"text-light\" href={url} target=\"_blank\" underline=\"none\">\n        <div className=\"flex items-center gap-x-2\">\n          <span>{linkText}</span> <ExternalIcon className=\"w-3 h-3\" />\n        </div>\n      </Link>\n    </div>\n  );\n}\n\ntype HelpPanelProps = {\n  session: SessionService;\n};\n\ntype PanelKey = 'tutorial' | 'versionInfo';\n\n/**\n * A help sidebar panel with two sub-panels: tutorial and version info.\n */\nfunction HelpPanel({ session }: HelpPanelProps) {\n  const store = useSidebarStore();\n  const frames = store.frames();\n  const mainFrame = store.mainFrame();\n  const profile = store.profile();\n  const displayName =\n    profile.user_info?.display_name ?? username(profile.userid);\n  const tutorialTabId = useId();\n  const tutorialPanelId = useId();\n  const versionTabId = useId();\n  const versionPanelId = useId();\n\n  // Should this panel be auto-opened at app launch? Note that the actual\n  // auto-open triggering of this panel is owned by the `HypothesisApp` component.\n  // This reference is such that we know whether we should \"dismiss\" the tutorial\n  // (permanently for this user) when it is closed.\n  const hasAutoDisplayPreference =\n    !!store.profile().preferences.show_sidebar_tutorial;\n\n  // The \"Tutorial\" (getting started) subpanel is the default panel shown\n  const [activeSubPanel, setActiveSubPanel] = useState<PanelKey>('tutorial');\n\n  // Build version details about this session/app\n  const versionData = useMemo(() => {\n    // Sort frames so the main frame is listed first. Other frames will retain\n    // their original order, assuming a stable sort.\n    const documentFrames = [...frames].sort((a, b) => {\n      if (a === mainFrame) {\n        return -1;\n      } else if (b === mainFrame) {\n        return 1;\n      } else {\n        return 0;\n      }\n    });\n\n    return new VersionData(\n      { userid: profile.userid, displayName },\n      documentFrames,\n    );\n  }, [profile, displayName, frames, mainFrame]);\n\n  // The support ticket URL encodes some version info in it to pre-fill in the\n  // create-new-ticket form\n  const supportTicketURL = `https://web.hypothes.is/get-help/?sys_info=${versionData.asEncodedURLString()}`;\n\n  const onActiveChanged = useCallback(\n    (active: boolean) => {\n      if (!active && hasAutoDisplayPreference) {\n        // If the tutorial is currently being auto-displayed, update the user\n        // preference to disable the auto-display from happening on subsequent\n        // app launches\n        session.dismissSidebarTutorial();\n      }\n    },\n    [session, hasAutoDisplayPreference],\n  );\n\n  return (\n    <SidebarPanel\n      title=\"Help\"\n      panelName=\"help\"\n      onActiveChanged={onActiveChanged}\n      variant=\"custom\"\n    >\n      <TabHeader closeTitle=\"Close help panel\">\n        <Tab\n          id={tutorialTabId}\n          aria-controls={tutorialPanelId}\n          variant=\"tab\"\n          textContent=\"Help\"\n          selected={activeSubPanel === 'tutorial'}\n          onClick={() => setActiveSubPanel('tutorial')}\n          data-testid=\"tutorial-tab\"\n        >\n          Help\n        </Tab>\n        <Tab\n          id={versionTabId}\n          aria-controls={versionPanelId}\n          variant=\"tab\"\n          textContent=\"Version\"\n          selected={activeSubPanel === 'versionInfo'}\n          onClick={() => setActiveSubPanel('versionInfo')}\n          data-testid=\"version-info-tab\"\n        >\n          Version\n        </Tab>\n      </TabHeader>\n      <Card\n        classes={classnames({\n          'rounded-tl-none': activeSubPanel === 'tutorial',\n        })}\n      >\n        <div className=\"border-b\">\n          <TabPanel\n            id={tutorialPanelId}\n            aria-labelledby={tutorialTabId}\n            active={activeSubPanel === 'tutorial'}\n            title=\"Getting started\"\n          >\n            <Tutorial />\n          </TabPanel>\n          <TabPanel\n            id={versionPanelId}\n            aria-labelledby={versionTabId}\n            active={activeSubPanel === 'versionInfo'}\n            title=\"Version details\"\n          >\n            <VersionInfo versionData={versionData} />\n          </TabPanel>\n        </div>\n        <div className=\"flex items-center p-3\">\n          <HelpPanelTab\n            linkText=\"Help topics\"\n            url=\"https://web.hypothes.is/help/\"\n          />\n          <HelpPanelTab linkText=\"New support ticket\" url={supportTicketURL} />\n        </div>\n      </Card>\n    </SidebarPanel>\n  );\n}\n\nexport default withServices(HelpPanel, ['session']);\n","export type EventMap = Record<string, (...args: any) => void>;\n\n/**\n * A simple event emitter with an API similar to Node's `EventEmitter`.\n *\n * `Event` is an object type that maps event names to the function signatures of\n * subscribers for those events. For example, this defines an emitter which\n * emits one event, `uriChanged`, with a single string argument:\n *\n * ```\n * type Events = {\n *   uriChanged(uri: string): void;\n * }\n * ```\n */\nexport class EventEmitter<out Event extends EventMap> {\n  // Use a private field here to avoid conflicts with subclasses.\n  #listeners: Array<{ name: string; callback: (...args: any) => void }> = [];\n\n  /** Remove all event listeners. */\n  destroy() {\n    this.#listeners = [];\n  }\n\n  /** Add an event handler. */\n  on<K extends keyof Event & string>(name: K, callback: Event[K]) {\n    this.#listeners.push({ name, callback });\n  }\n\n  /** Remove an event handler. */\n  off<K extends keyof Event>(name: K, callback: Event[K]) {\n    this.#listeners = this.#listeners.filter(\n      ln => !(ln.name === name && ln.callback === callback),\n    );\n  }\n\n  /** Emit an event. */\n  emit<K extends keyof Event>(name: K, ...args: Parameters<Event[K]>) {\n    for (const listener of this.#listeners) {\n      if (listener.name !== name) {\n        continue;\n      }\n      // Ensure callback is invoked without `this`.\n      const callback = listener.callback;\n      callback(...args);\n    }\n  }\n}\n","import { EventEmitter } from '../shared/event-emitter';\nimport type { Annotation, SearchQuery, SearchResponse } from '../types/api';\n\n/**\n * Indicates that there are more annotations matching the current API\n * search request than the interface can currently handle displaying\n * (Notebook).\n */\nexport class ResultSizeError extends Error {\n  constructor(limit: number) {\n    super(`Results size exceeds ${limit}`);\n  }\n}\n\nexport type SortBy = 'created' | 'updated';\n\nexport type SortOrder = 'asc' | 'desc';\n\n/**\n * Default implementation of {@link SearchOptions.getPageSize}.\n *\n * This uses a small number for the first page to reduce the time until some\n * results are displayed and a larger number for remaining pages to lower the\n * total fetch time.\n */\nfunction defaultPageSize(index: number) {\n  return index === 0 ? 50 : 200;\n}\n\nexport type SearchOptions = {\n  /**\n   * Callback that returns the page size to use when fetching the index'th page\n   * of results.  Callers can vary this to balance the latency of getting some\n   * results against the time taken to fetch all results.\n   *\n   * The returned page size must be at least 1 and no more than the maximum\n   * value of the `limit` query param for the search API.\n   */\n  getPageSize?: (index: number) => number;\n\n  /**\n   * When `true`, request that top-level annotations and replies be returned\n   * separately. NOTE: This has issues with annotations that have large numbers\n   * of replies.\n   */\n  separateReplies?: boolean;\n\n  /** Emit `results` events incrementally as pages of annotations are fetched. */\n  incremental?: boolean;\n\n  /**\n   * Safety valve for protection when loading all annotations in a group in the\n   * NotebookView. If the Notebook is opened while focused on a group that\n   * contains many thousands of annotations, it could cause rendering and\n   * network misery in the browser.  When present, do not load annotations if\n   * the result set size exceeds this value.\n   */\n  maxResults?: number | null;\n\n  /**\n   * Specifies which annotation field to sort results by. Together with\n   * {@link SearchOptions.sortOrder} this controls how the results are ordered.\n   */\n  sortBy?: SortBy;\n\n  sortOrder?: SortOrder;\n};\n\nexport type Events = {\n  resultCount(count: number): void;\n  results(anns: Annotation[]): void;\n  error(err: Error): void;\n  end(): void;\n};\n\n/**\n * Client for the Hypothesis annotation search API [1].\n *\n * SearchClient does not directly call the `/api/search` endpoint, but uses a\n * consumer-provided callback for that. What it does handle is generating query\n * params for the API call, paging through results and emitting events as\n * results are received.\n *\n * [1] https://h.readthedocs.io/en/latest/api-reference/#tag/annotations/paths/~1search/get\n */\nexport class SearchClient extends EventEmitter<Events> {\n  private _canceled: boolean;\n  private _getPageSize: (pageIndex: number) => number;\n  private _incremental: boolean;\n  private _maxResults: number | null;\n\n  /** Total number of results we expect to receive, from the `total` field. */\n  private _expectedCount: null | number;\n\n  /** Total number of results we have received. */\n  private _fetchedCount: number;\n\n  /** Results received so far, if we are not emitting results incrementally. */\n  private _results: Annotation[];\n\n  private _searchFn: (query: SearchQuery) => Promise<SearchResponse>;\n  private _separateReplies: boolean;\n  private _sortBy: SortBy;\n  private _sortOrder: SortOrder;\n\n  /**\n   * @param searchFn - Callback that executes a search request against the Hypothesis API\n   */\n  constructor(\n    searchFn: (query: SearchQuery) => Promise<SearchResponse>,\n    {\n      getPageSize = defaultPageSize,\n      separateReplies = true,\n      incremental = true,\n      maxResults = null,\n      sortBy = 'created',\n      sortOrder = 'asc',\n    }: SearchOptions = {},\n  ) {\n    super();\n    this._searchFn = searchFn;\n    this._getPageSize = getPageSize;\n    this._separateReplies = separateReplies;\n    this._incremental = incremental;\n    this._maxResults = maxResults;\n    this._sortBy = sortBy;\n    this._sortOrder = sortOrder;\n\n    this._canceled = false;\n    this._expectedCount = null;\n    this._fetchedCount = 0;\n    this._results = [];\n  }\n\n  /**\n   * Fetch a page of annotations.\n   *\n   * @param query - Query params for /api/search call\n   * @param [searchAfter] - Cursor value to use when paginating\n   *   through results. Omitted for the first page. See docs for `search_after`\n   *   query param for /api/search API.\n   */\n  async _getPage(query: SearchQuery, searchAfter?: string, pageIndex = 0) {\n    const pageSize = this._getPageSize(pageIndex);\n\n    const searchQuery: SearchQuery = {\n      limit: pageSize,\n      sort: this._sortBy,\n      order: this._sortOrder,\n      _separate_replies: this._separateReplies,\n\n      ...query,\n    };\n\n    if (searchAfter) {\n      searchQuery.search_after = searchAfter;\n    }\n\n    try {\n      const results = await this._searchFn(searchQuery);\n      if (this._canceled) {\n        return;\n      }\n\n      if (this._expectedCount === null) {\n        // Emit the result count (total) on first encountering it\n        this._expectedCount = results.total;\n        this.emit('resultCount', this._expectedCount);\n      }\n\n      // For now, abort loading of annotations if `maxResults` is set and the\n      // number of annotations in the results set exceeds that value.\n      //\n      // NB: We can’t currently, reliably load a subset of a group’s\n      // annotations, as replies are mixed in with top-level annotations—when\n      // `separateReplies` is false, which it is in most or all cases—so we’d\n      // end up with partially-loaded threads.\n      //\n      // This change has no effect on loading annotations in the SidebarView,\n      // where the `maxResults` option is not used.\n      if (this._maxResults && results.total > this._maxResults) {\n        this.emit('error', new ResultSizeError(this._maxResults));\n        this.emit('end');\n        return;\n      }\n\n      const page = results.rows.concat(results.replies || []);\n\n      if (this._incremental) {\n        this.emit('results', page);\n      } else {\n        this._results = this._results.concat(page);\n      }\n      this._fetchedCount += page.length;\n\n      // Check if we're expecting more results. If the `total` value from the\n      // API is \"small\" it will be exact. If large, it may be a lower bound, in\n      // which case we'll keep fetching until we get no more. Calculating this\n      // is just an optimization to reduce the number of search API calls and\n      // make the loading state disappear sooner.\n      //\n      // See also https://www.elastic.co/guide/en/elasticsearch/reference/7.17/search-your-data.html#track-total-hits.\n      const expectMore =\n        this._fetchedCount < this._expectedCount || this._expectedCount > 1000;\n\n      // Get the cursor for the start of the next page.\n      //\n      // Ideally this would be part of the API response (see\n      // https://github.com/hypothesis/h/issues/7841), but since it isn't yet,\n      // we have to construct this ourselves.\n      let nextSearchAfter = null;\n      if (page.length > 0 && expectMore) {\n        nextSearchAfter = page[page.length - 1][this._sortBy];\n      }\n\n      if (nextSearchAfter) {\n        this._getPage(query, nextSearchAfter, pageIndex + 1);\n      } else {\n        if (!this._incremental) {\n          this.emit('results', this._results);\n        }\n        this.emit('end');\n      }\n    } catch (err) {\n      if (this._canceled) {\n        return;\n      }\n      this.emit('error', err);\n      this.emit('end');\n    }\n  }\n\n  /**\n   * Perform a search against the Hypothesis API.\n   *\n   * Emits a 'results' event with an array of annotations as they become\n   * available (in incremental mode) or when all annotations are available\n   * (in non-incremental mode).\n   *\n   * Emits an 'error' event if the search fails.\n   * Emits an 'end' event once the search completes.\n   */\n  get(query: SearchQuery) {\n    this._expectedCount = null;\n    this._fetchedCount = 0;\n    this._results = [];\n    this._getPage(query);\n  }\n\n  /**\n   * Cancel the current search and emit the 'end' event.\n   *\n   * No further events will be emitted after this.\n   */\n  cancel() {\n    this._canceled = true;\n    this.emit('end');\n  }\n}\n","import type { IconComponent } from '@hypothesis/frontend-shared/lib/types';\nimport classnames from 'classnames';\n\nimport type { FilterOption } from '../store/modules/filters';\nimport Menu from './Menu';\nimport MenuItem from './MenuItem';\n\ntype FilterSelectProps = {\n  defaultOption: FilterOption;\n  icon?: IconComponent;\n  onSelect: (selectedFilter: FilterOption) => void;\n  options: FilterOption[];\n  selectedOption?: FilterOption;\n  title: string;\n};\n\n/**\n * A select-element-like control for selecting one of a defined set of\n * options.\n */\nfunction FilterSelect({\n  defaultOption,\n  icon: Icon,\n  onSelect,\n  options,\n  selectedOption,\n  title,\n}: FilterSelectProps) {\n  const filterOptions = [defaultOption, ...options];\n  const selected = selectedOption ?? defaultOption;\n\n  const menuLabel = (\n    <span\n      className={classnames(\n        // Don't allow the label text to wrap\n        'shrink-0 flex items-center gap-x-2',\n        'text-color-text font-bold text-md',\n      )}\n    >\n      {Icon && <Icon className=\"w-4 h-4\" />}\n      {selected.display}\n    </span>\n  );\n\n  return (\n    <Menu\n      label={menuLabel}\n      title={title}\n      contentClass={classnames(\n        // Don't let filter list get too terribly tall. Where space allows,\n        // use `504px` (this odd number is to maximize the likelihood that the\n        // overflow cutoff is in the middle of an option, making it more obvious\n        // that the list is scrollable), but don't exceed 60vh.\n        'max-h-[min(60vh,504px)] overflow-y-auto',\n      )}\n    >\n      {filterOptions.map(filterOption => (\n        <MenuItem\n          onClick={() => onSelect(filterOption)}\n          key={filterOption.value}\n          isSelected={filterOption.value === selected.value}\n          label={filterOption.display}\n        />\n      ))}\n    </Menu>\n  );\n}\n\nexport default FilterSelect;\n","import { ProfileIcon } from '@hypothesis/frontend-shared';\n\nimport { useSidebarStore } from '../store';\nimport FilterSelect from './FilterSelect';\nimport { useUserFilterOptions } from './hooks/use-filter-options';\n\n/**\n * Filters for the Notebook\n */\nfunction NotebookFilters() {\n  const store = useSidebarStore();\n\n  const userFilter = store.getFilter('user');\n  const userFilterOptions = useUserFilterOptions();\n\n  return (\n    <FilterSelect\n      defaultOption={{ value: '', display: 'Everybody' }}\n      icon={ProfileIcon}\n      onSelect={userFilter => store.setFilter('user', userFilter)}\n      options={userFilterOptions}\n      selectedOption={userFilter}\n      title=\"Filter by user\"\n    />\n  );\n}\n\nexport default NotebookFilters;\n","import { useMemo } from 'preact/hooks';\n\nimport { username } from '../../helpers/account-id';\nimport { annotationDisplayName } from '../../helpers/annotation-user';\nimport { useSidebarStore } from '../../store';\nimport type { FilterOption } from '../../store/modules/filters';\n\n/**\n * Generate a list of users for filtering annotations; update when set of\n * annotations or filter state changes meaningfully.\n */\nexport function useUserFilterOptions(): FilterOption[] {\n  const store = useSidebarStore();\n  const annotations = store.allAnnotations();\n  const focusFilters = store.getFocusFilters();\n  const currentUsername = username(store.profile().userid);\n  const defaultAuthority = store.defaultAuthority();\n  const displayNamesEnabled = store.isFeatureEnabled('client_display_names');\n\n  return useMemo(() => {\n    // Determine unique users (authors) in annotation collection\n    const users: Record<string, string> = {};\n    annotations.forEach(annotation => {\n      const username_ = username(annotation.user);\n      users[username_] = annotationDisplayName(\n        annotation,\n        defaultAuthority,\n        displayNamesEnabled,\n      );\n    });\n\n    // If user-focus is configured (even if not applied) add a filter\n    // option for that user. Note that this always respects the display\n    // value, even if `client_display_names` feature flags is not enabled:\n    // this matches current implementation of focus mode.\n    if (focusFilters.user) {\n      const username_ =\n        username(focusFilters.user.value) || focusFilters.user.value;\n      users[username_] = focusFilters.user.display;\n    }\n\n    // Convert to an array of `FilterOption` objects\n    const userOptions = Object.keys(users).map(user => {\n      // If the user is the current user, add \"(Me)\" to the displayed name\n      const display =\n        user === currentUsername ? `${users[user]} (Me)` : users[user];\n      return { display, value: user };\n    });\n\n    userOptions.sort((a, b) => {\n      // Ensure that the current user \"Me\" resides at the front of the list\n      if (currentUsername === a.value) {\n        return -1;\n      } else if (currentUsername === b.value) {\n        return 1;\n      } else {\n        return a.display.localeCompare(b.display);\n      }\n    });\n\n    return userOptions;\n  }, [\n    annotations,\n    currentUsername,\n    defaultAuthority,\n    displayNamesEnabled,\n    focusFilters.user,\n  ]);\n}\n","import { Spinner } from '@hypothesis/frontend-shared';\n\nimport { countVisible } from '../helpers/thread';\nimport { useRootThread } from './hooks/use-root-thread';\n\nexport type NotebookResultCountProps = {\n  /**\n   * Number of items that don't match applied filters but have been\n   * \"forced visible\" (expanded) by user interaction. These are described as\n   * \"and <forcedVisibleCount> more\" in filter descriptions\n   */\n  forcedVisibleCount: number;\n\n  isFiltered: boolean;\n  isLoading: boolean;\n  resultCount: number;\n};\n/**\n * Render count of annotations (or filtered results) visible in the notebook view\n *\n * There are three possible overall states:\n * - No results (regardless of whether annotations are filtered): \"No results\"\n * - Annotations are unfiltered: \"X threads (Y annotations)\"\n *     Thread count does not render until all annotations are loaded\n * - Annotations are filtered: \"X results [(and Y more)]\"\n *\n * @param {NotebookResultCountProps} props\n */\nfunction NotebookResultCount({\n  forcedVisibleCount,\n  isFiltered,\n  isLoading,\n  resultCount,\n}: NotebookResultCountProps) {\n  const { rootThread } = useRootThread();\n  const visibleCount = isLoading ? resultCount : countVisible(rootThread);\n\n  const hasResults = rootThread.children.length > 0;\n\n  const hasForcedVisible = isFiltered && forcedVisibleCount > 0;\n  const matchCount = visibleCount - forcedVisibleCount;\n  const threadCount = rootThread.children.length;\n\n  return (\n    <div className=\"flex gap-x-1 leading-none\">\n      {isLoading && <Spinner size=\"sm\" />}\n      {!isLoading && (\n        <h2 className=\"font-bold\">\n          {!hasResults && <span>No results</span>}\n          {hasResults && isFiltered && (\n            <span>\n              {matchCount} {matchCount === 1 ? 'result' : 'results'}\n            </span>\n          )}\n          {hasResults && !isFiltered && (\n            <span>\n              {threadCount} {threadCount === 1 ? 'thread' : 'threads'}\n            </span>\n          )}\n        </h2>\n      )}\n      {hasForcedVisible && (\n        <h3 className=\"italic font-normal\">(and {forcedVisibleCount} more)</h3>\n      )}\n      {!isFiltered && hasResults && (\n        <h3 className=\"italic font-normal\">\n          ({visibleCount} {visibleCount === 1 ? 'annotation' : 'annotations'})\n        </h3>\n      )}\n    </div>\n  );\n}\n\nexport default NotebookResultCount;\n","import { Pagination } from '@hypothesis/frontend-shared';\nimport { useMemo } from 'preact/hooks';\n\nimport type { Thread } from '../helpers/build-thread';\nimport { countVisible } from '../helpers/thread';\nimport ThreadList from './ThreadList';\n\nexport type PaginatedThreadListProps = {\n  currentPage: number;\n  isLoading: boolean;\n  onChangePage: (page: number) => void;\n  threads: Thread[];\n  pageSize?: number;\n};\n\n/**\n * Determine which subset of all current `threads` to show on the current\n * page of results, and how many pages of results there are total.\n *\n * Render the threads for the current page of results, and pagination controls.\n */\nexport default function PaginatedThreadList({\n  currentPage,\n  isLoading,\n  onChangePage,\n  threads,\n  pageSize = 25,\n}: PaginatedThreadListProps) {\n  const { paginatedThreads, totalPages } = useMemo(() => {\n    const visibleThreads = threads.filter(thread => countVisible(thread) > 0);\n    const startIndex = (currentPage - 1) * pageSize;\n    const endIndex = startIndex + pageSize;\n    const totalPages = Math.ceil(visibleThreads.length / pageSize);\n    return {\n      paginatedThreads: visibleThreads.slice(startIndex, endIndex),\n      totalPages,\n    };\n  }, [threads, currentPage, pageSize]);\n\n  return (\n    <>\n      <ThreadList threads={paginatedThreads} />\n      {!isLoading && (\n        <Pagination\n          currentPage={currentPage}\n          onChangePage={onChangePage}\n          totalPages={totalPages}\n        />\n      )}\n    </>\n  );\n}\n","/**\n * Naive simple English pluralization\n */\nexport function pluralize(count: number, singular: string, plural: string) {\n  return count === 1 ? singular : plural;\n}\n","import { useEffect } from 'preact/hooks';\n\n/**\n * Bit flags indicating modifiers required by a shortcut or pressed in a key event.\n */\nconst modifiers = {\n  alt: 1,\n  ctrl: 2,\n  meta: 4,\n  shift: 8,\n} as Record<string, number>;\n\n/**\n * Match a `shortcut` key sequence against a keydown event.\n *\n * A shortcut key sequence is a string of \"+\"-separated keyboard modifiers and\n * keys. The list may contain zero or more modifiers and must contain exactly\n * one non-modifier key. The key and modifier names are case-insensitive.\n * For example \"Ctrl+Enter\", \"shift+a\".\n *\n * Key names are matched against {@link KeyboardEvent.key}. Be aware that this\n * property is affected by the modifiers for certain keys. For example on a US\n * QWERTY keyboard, \"Shift+1\" would not match any event because the key value\n * would be \"!\" instead. See also https://github.com/w3c/uievents/issues/247.\n */\nexport function matchShortcut(event: KeyboardEvent, shortcut: string): boolean {\n  // Work around an issue where Chrome autofill can dispatch \"keydown\" events\n  // with an argument that is not a `KeyboardEvent`.\n  //\n  // See https://bugs.chromium.org/p/chromium/issues/detail?id=739792.\n  if (!(event instanceof KeyboardEvent)) {\n    return false;\n  }\n\n  const parts = shortcut.split('+').map(p => p.toLowerCase());\n\n  let requiredModifiers = 0;\n  let requiredKey = null;\n\n  for (const part of parts) {\n    const modifierFlag = modifiers[part];\n    if (modifierFlag) {\n      requiredModifiers |= modifierFlag;\n    } else if (requiredKey === null) {\n      requiredKey = part;\n    } else {\n      throw new Error('Multiple non-modifier keys specified');\n    }\n  }\n\n  if (!requiredKey) {\n    throw new Error(`Invalid shortcut: ${shortcut}`);\n  }\n\n  const actualModifiers =\n    (event.ctrlKey ? modifiers.ctrl : 0) |\n    (event.metaKey ? modifiers.meta : 0) |\n    (event.altKey ? modifiers.alt : 0) |\n    (event.shiftKey ? modifiers.shift : 0);\n\n  return (\n    actualModifiers === requiredModifiers &&\n    event.key.toLowerCase() === requiredKey\n  );\n}\n\nexport type ShortcutOptions = {\n  /**\n   * Element on which the key event listener should be installed. Defaults to\n   * `document.body`.\n   */\n  rootElement?: HTMLElement;\n};\n\n/**\n * Install a shortcut key listener on the document.\n *\n * This can be used directly outside of a component. To use within a Preact\n * component, you probably want {@link useShortcut}.\n *\n * @param shortcut - Shortcut key sequence. See {@link matchShortcut}.\n * @param onPress - A function to call when the shortcut matches\n * @return A function that removes the shortcut\n */\nexport function installShortcut(\n  shortcut: string,\n  onPress: (e: KeyboardEvent) => void,\n  {\n    // We use `documentElement` as the root element rather than `document.body`\n    // which is used as a root element in some other places because the body\n    // element is not keyboard-focusable in XHTML documents in Safari/Chrome.\n    // See https://github.com/hypothesis/client/issues/4364.\n    //\n    // nb. `documentElement` is non-null in TS types, but it can be null if\n    // the root element is explicitly removed. We don't know how this happens,\n    // but it has been observed on some ChromeOS devices. See\n    // https://hypothesis.sentry.io/issues/3987992034.\n    rootElement = (document.documentElement as HTMLElement | null) ?? undefined,\n  }: ShortcutOptions = {},\n) {\n  const onKeydown = (event: KeyboardEvent) => {\n    if (matchShortcut(event, shortcut)) {\n      onPress(event);\n    }\n  };\n  /* istanbul ignore next */\n  if (!rootElement) {\n    return () => {};\n  }\n  rootElement.addEventListener('keydown', onKeydown);\n  return () => rootElement.removeEventListener('keydown', onKeydown);\n}\n\n/**\n * An effect hook that installs a shortcut using {@link installShortcut} and\n * removes it when the component is unmounted.\n *\n * This provides a convenient way to enable a document-level shortcut while\n * a component is mounted. This differs from adding an `onKeyDown` handler to\n * one of the component's DOM elements in that it doesn't require the component\n * to have focus.\n *\n * To conditionally disable the shortcut, set `shortcut` to `null`.\n *\n * @param shortcut - A shortcut key sequence to match or `null` to disable. See {@link matchShortcut}.\n * @param onPress - A function to call when the shortcut matches\n */\nexport function useShortcut(\n  shortcut: string | null,\n  onPress: (e: KeyboardEvent) => void,\n  { rootElement }: ShortcutOptions = {},\n) {\n  useEffect(() => {\n    if (!shortcut) {\n      return undefined;\n    }\n    return installShortcut(shortcut, onPress, { rootElement });\n  }, [shortcut, onPress, rootElement]);\n}\n","import { Button, DownloadIcon, MentionIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport type { ComponentChildren } from 'preact';\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks';\n\nimport { pluralize } from '../../shared/pluralize';\nimport { useShortcut } from '../../shared/shortcut';\nimport { withServices } from '../service-context';\nimport type { AnalyticsService } from '../services/analytics';\nimport type { StreamerService } from '../services/streamer';\nimport { useSidebarStore } from '../store';\n\nexport type PendingUpdatesNotificationProps = {\n  // Injected\n  streamer: StreamerService;\n  analytics: AnalyticsService;\n\n  // Test seams\n  setTimeout_?: typeof setTimeout;\n  clearTimeout_?: typeof clearTimeout;\n};\n\ntype HideableBlockProps = {\n  hidden: boolean;\n  children: ComponentChildren;\n};\n\n/**\n * A component that can be hidden but will be unconditionally displayed when the\n * group it belongs to is focused or hovered\n */\nfunction HideableBlock({ hidden, children }: HideableBlockProps) {\n  return (\n    <span\n      className={classnames('group-hover:inline group-focus:inline', {\n        hidden,\n      })}\n    >\n      {children}\n    </span>\n  );\n}\n\ntype UpdateBlockProps = {\n  type: 'updates' | 'mentions';\n  collapsed: boolean;\n  count: number;\n};\n\nfunction UpdateBlock({ type, collapsed, count }: UpdateBlockProps) {\n  const singular = type === 'updates' ? 'update' : 'mention';\n  const plural = type === 'updates' ? 'updates' : 'mentions';\n  const Icon = type === 'updates' ? DownloadIcon : MentionIcon;\n\n  return (\n    <div\n      className={classnames(\n        'flex gap-1.5 items-center px-2 py-1',\n        'border-l first:border-l-0 border-white/60',\n      )}\n    >\n      <Icon className=\"w-em h-em\" />\n      <div className=\"flex gap-1\">\n        <span className=\"font-bold\">{count}</span>\n        <HideableBlock hidden={collapsed}>\n          {pluralize(count, singular, plural)}\n        </HideableBlock>\n      </div>\n    </div>\n  );\n}\n\nconst collapseDelay = 5000;\n\nfunction PendingUpdatesNotification({\n  streamer,\n  analytics,\n  /* istanbul ignore next - test seam */\n  setTimeout_ = setTimeout,\n  /* istanbul ignore next - test seam */\n  clearTimeout_ = clearTimeout,\n}: PendingUpdatesNotificationProps) {\n  const store = useSidebarStore();\n  const pendingUpdateCount = store.pendingUpdateCount();\n  const pendingMentionCount = store.pendingMentionCount();\n  const mentionsEnabled = store.isFeatureEnabled('at_mentions');\n  const hasPendingChanges = store.hasPendingUpdatesOrDeletions();\n  const applyPendingUpdates = useCallback(() => {\n    streamer.applyPendingUpdates();\n    analytics.trackEvent('client.realtime.apply_updates');\n  }, [analytics, streamer]);\n  const [collapsed, setCollapsed] = useState(false);\n  const timeout = useRef<number | null>(null);\n\n  useShortcut('l', () => hasPendingChanges && applyPendingUpdates());\n\n  useEffect(() => {\n    if (hasPendingChanges) {\n      timeout.current = setTimeout_(() => {\n        setCollapsed(true);\n        timeout.current = null;\n      }, collapseDelay);\n    } else {\n      setCollapsed(false);\n    }\n\n    return () => timeout.current && clearTimeout_(timeout.current);\n  }, [clearTimeout_, hasPendingChanges, setTimeout_]);\n\n  if (!hasPendingChanges) {\n    return null;\n  }\n\n  return (\n    <div\n      role=\"status\"\n      className=\"absolute right-0 animate-updates-notification-slide-in\"\n    >\n      <Button\n        onClick={applyPendingUpdates}\n        unstyled\n        classes={classnames(\n          'flex items-center',\n          'rounded shadow-lg bg-gray-900 text-white',\n          'group focus-visible-ring',\n        )}\n        data-testid=\"notification\"\n        data-collapsed={collapsed}\n      >\n        <UpdateBlock\n          type=\"updates\"\n          collapsed={collapsed}\n          count={pendingUpdateCount}\n        />\n        {mentionsEnabled && pendingMentionCount > 0 && (\n          <UpdateBlock\n            type=\"mentions\"\n            collapsed={collapsed}\n            count={pendingMentionCount}\n          />\n        )}\n        <span className=\"sr-only\">load them by pressing l</span>\n      </Button>\n    </div>\n  );\n}\n\nexport default withServices(PendingUpdatesNotification, [\n  'streamer',\n  'analytics',\n]);\n","import { Link, Panel } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useEffect, useLayoutEffect, useRef, useState } from 'preact/hooks';\nimport scrollIntoView from 'scroll-into-view';\n\nimport { ResultSizeError } from '../search-client';\nimport { withServices } from '../service-context';\nimport type { LoadAnnotationsService } from '../services/load-annotations';\nimport type { StreamerService } from '../services/streamer';\nimport { useSidebarStore } from '../store';\nimport NotebookFilters from './NotebookFilters';\nimport NotebookResultCount from './NotebookResultCount';\nimport PaginatedThreadList from './PaginatedThreadList';\nimport PendingUpdatesNotification from './PendingUpdatesNotification';\nimport { useRootThread } from './hooks/use-root-thread';\n\nexport type NotebookViewProps = {\n  // injected\n  loadAnnotationsService: LoadAnnotationsService;\n  streamer: StreamerService;\n};\n/**\n * The main content of the \"notebook\" route (https://hypothes.is/notebook)\n *\n * @param {NotebookViewProps} props\n */\nfunction NotebookView({ loadAnnotationsService, streamer }: NotebookViewProps) {\n  const store = useSidebarStore();\n\n  const filters = store.getFilterValues();\n  const focusedGroup = store.focusedGroup();\n  const forcedVisibleCount = store.forcedVisibleThreads().length;\n  const hasAppliedFilter = store.hasAppliedFilter();\n  const isLoading = store.isLoading();\n  const resultCount = store.annotationResultCount();\n\n  const { rootThread } = useRootThread();\n\n  const groupName = focusedGroup?.name ?? '…';\n\n  // Get the ID of the group to fetch annotations from.\n  //\n  // Once groups have been fetched and one has been focused, use its ID. If\n  // groups haven't been fetched yet but we know the ID of the group that is\n  // likely to be focused (eg. because the notebook has been configured to\n  // display a particular group when launched), we can optimistically fetch\n  // annotations from that group.\n  const groupId = focusedGroup?.id || store.directLinkedGroupId();\n\n  const lastPaginationPage = useRef(1);\n  const [paginationPage, setPaginationPage] = useState(1);\n\n  const [hasTooManyAnnotationsError, setHasTooManyAnnotationsError] =\n    useState(false);\n\n  // Load all annotations in the group, unless there are more than 5000\n  // of them: this is a performance safety valve.\n  const maxResults = 5000;\n\n  const onLoadError = (error: Error) => {\n    if (error instanceof ResultSizeError) {\n      setHasTooManyAnnotationsError(true);\n    }\n  };\n\n  const hasFetchedProfile = store.hasFetchedProfile();\n\n  // Establish websocket connection\n  useEffect(() => {\n    if (hasFetchedProfile) {\n      streamer.connect({ applyUpdatesImmediately: false });\n    }\n  }, [hasFetchedProfile, streamer]);\n\n  // Load all annotations; re-load if `focusedGroup` changes\n  useEffect(() => {\n    // NB: In current implementation, this will only happen/load once (initial\n    // annotation fetch on application startup), as there is no mechanism\n    // within the Notebook to change the `focusedGroup`. If the focused group\n    // is changed within the sidebar and the Notebook re-opened, an entirely\n    // new iFrame/app is created. This will need to be revisited.\n    store.setSortKey('newest');\n    if (groupId) {\n      loadAnnotationsService.load({\n        groupId,\n        // Load annotations in reverse-chronological order because that is how\n        // threads are sorted in the notebook view. By aligning the fetch\n        // order with the thread display order we reduce the changes in visible\n        // content as annotations are loaded. This reduces the amount of time\n        // the user has to wait for the content to load before they can start\n        // reading it.\n        //\n        // Fetching is still suboptimal because we fetch both annotations and\n        // replies together from the backend, but the user initially sees only\n        // the top-level threads.\n        sortBy: 'updated',\n        sortOrder: 'desc',\n        maxResults,\n        onError: onLoadError,\n        streamFilterBy: 'group',\n      });\n    }\n  }, [loadAnnotationsService, groupId, store]);\n\n  const onChangePage = (newPage: number) => {\n    setPaginationPage(newPage);\n  };\n\n  // When filter values or focused group are changed, reset pagination to page 1\n  useEffect(() => {\n    onChangePage(1);\n  }, [filters, focusedGroup]);\n\n  // Scroll back to here when pagination page changes\n  const threadListScrollTop = useRef<HTMLElement | null>(null);\n  useLayoutEffect(() => {\n    // TODO: Transition and effects here should be improved\n    if (paginationPage !== lastPaginationPage.current) {\n      if (threadListScrollTop.current) {\n        scrollIntoView(threadListScrollTop.current);\n      }\n      lastPaginationPage.current = paginationPage;\n    }\n  }, [paginationPage]);\n\n  return (\n    <div className=\"grid gap-2 lg:grid-cols-2\" data-testid=\"notebook-container\">\n      <header className=\"leading-none lg:col-span-2\" ref={threadListScrollTop}>\n        <h1 className=\"text-xl font-bold\" data-testid=\"notebook-group-name\">\n          {groupName}\n        </h1>\n      </header>\n      <div className=\"absolute w-full z-5 left-0 lg:top-8 top-5\">\n        <div\n          className={classnames(\n            'container flex flex-row-reverse relative',\n            // Compensate for container's right padding, which is defined in\n            // tailwind.config.js\n            'right-[4rem]',\n          )}\n        >\n          <PendingUpdatesNotification />\n        </div>\n      </div>\n      <div className=\"justify-self-start\">\n        <NotebookFilters />\n      </div>\n      <div className=\"flex items-center lg:justify-self-end text-md font-medium\">\n        <NotebookResultCount\n          forcedVisibleCount={forcedVisibleCount}\n          isFiltered={hasAppliedFilter}\n          isLoading={isLoading}\n          resultCount={resultCount ?? 0}\n        />\n      </div>\n      <div className=\"lg:col-span-2\">\n        {hasTooManyAnnotationsError && (\n          <div className=\"py-4\" data-testid=\"notebook-messages\">\n            <Panel title=\"Too many results to show\">\n              <p>\n                This preview of the Notebook can show{' '}\n                <strong>up to {maxResults} results</strong> at a time (there are{' '}\n                {resultCount} to show here).\n              </p>\n              <p>\n                <Link\n                  href=\"mailto:support@hypothes.is?subject=Hypothesis%20Notebook&body=Please%20notify%20me%20when%20the%20Hypothesis%20Notebook%20is%20updated%20to%20support%20more%20than%205000%20annotations\"\n                  underline=\"always\"\n                >\n                  Contact us\n                </Link>{' '}\n                if you would like to be notified when support for more\n                annotations is available.\n              </p>\n            </Panel>\n          </div>\n        )}\n        <PaginatedThreadList\n          currentPage={paginationPage}\n          isLoading={isLoading}\n          onChangePage={onChangePage}\n          threads={rootThread.children}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default withServices(NotebookView, [\n  'loadAnnotationsService',\n  'streamer',\n]);\n","import {\n  Card,\n  CardContent,\n  Checkbox,\n  CheckIcon,\n  Scroll,\n  SpinnerSpokesIcon,\n} from '@hypothesis/frontend-shared';\nimport type { PresentationalProps } from '@hypothesis/frontend-shared/lib/types';\nimport classnames from 'classnames';\nimport type { ComponentChildren, JSX } from 'preact';\nimport { useEffect, useState } from 'preact/hooks';\n\nimport { useSidebarStore } from '../store';\n\ntype ToastBadgeProps = PresentationalProps & {\n  children: ComponentChildren;\n  /**\n   * Callback invoked when toast is \"done\" and is requesting to be\n   * closed/removed\n   */\n  onClose?: () => void;\n} & JSX.HTMLAttributes<HTMLDivElement>;\n\n/**\n * Render a success \"toast\" badge.\n *\n * This uses an animation to pulse on render, then slowly fade out over several\n * seconds. After its animation is complete, any provided `onClose` will be\n * invoked.\n */\n/* istanbul ignore next: Prototyped UI; add tests when solidified */\nfunction ToastBadge({\n  classes,\n  children,\n  onClose = () => {},\n  ...htmlAttributes\n}: ToastBadgeProps) {\n  return (\n    <div\n      className={classnames(\n        'flex items-center gap-x-1 py-1 px-2 rounded',\n        'bg-green-success/10 animate-pulse-fade-out',\n        classes,\n      )}\n      onAnimationEnd={onClose}\n      {...htmlAttributes}\n    >\n      <CheckIcon className=\"text-green-success w-em h-em p-[0.125em]\" />\n      <div className=\"text-sm\">{children}</div>\n    </div>\n  );\n}\n\n/**\n * Prototype of a subset of user-preferences/-profile management.\n */\n/* istanbul ignore next: Prototyped UI; add tests when solidified */\nexport default function ProfileView() {\n  const store = useSidebarStore();\n  /** Is there a \"request in flight\" (fake) to save the digest preference? */\n  const [loading, setLoading] = useState(false);\n\n  /**\n   * Increment each time a save is completed, then reset to 0 to close (remove)\n   * the success toast badge\n   */\n  const [saveCount, setSaveCount] = useState(0);\n\n  useEffect(\n    /**\n     * Fake a 1s network request delay after checkbox is checked or unchecked.\n     * This exercises the \"loading\" UI state for the checkbox.\n     */\n    () => {\n      let savingTimeout: number;\n\n      if (loading) {\n        savingTimeout = setTimeout(() => {\n          setLoading(false);\n          // \"Save was successful\": increment the save count to ensure the\n          // toast badge gets re-rendered\n          setSaveCount(prevCount => prevCount + 1);\n        }, 1000);\n      }\n\n      return () => {\n        clearTimeout(savingTimeout);\n      };\n    },\n    [loading],\n  );\n\n  if (!store.isFeatureEnabled('client_user_profile')) {\n    return null;\n  }\n\n  // Render save-success message after each successful save, but do not render\n  // it when a \"request is in flight\". This removal and re-adding across a\n  // sequence of saves ensures that the browser sees the message as newly-added\n  // to the accessibility DOM and screen readers should announce it at the\n  // appropriate times.\n  const withSaveMessage = saveCount > 0 && !loading;\n\n  return (\n    <Card data-testid=\"profile-container\" classes=\"overflow-hidden\">\n      <div\n        className={classnames(\n          // Ensure there is enough height to clear both the heading text and the\n          // success toast message without any danger of a jiggle\n          'h-12',\n          'px-3 border-b flex items-center',\n        )}\n      >\n        <div className=\"grow\">\n          <h1 className=\"text-xl text-slate-7 font-normal\">Notifications</h1>\n        </div>\n        <ul className=\"sr-only\" aria-live=\"polite\">\n          {withSaveMessage && (\n            <li key={saveCount}>Notification preferences saved</li>\n          )}\n        </ul>\n        {saveCount > 0 && (\n          <ToastBadge\n            key={\n              // The key is used here to ensure the `ToastBadge` re-renders and\n              // thus restarts its animation each time a save completes.\n              saveCount\n            }\n            onClose={() => setSaveCount(0)}\n          >\n            Saved\n          </ToastBadge>\n        )}\n      </div>\n      <Scroll>\n        <CardContent size=\"lg\">\n          <Checkbox\n            defaultChecked={true}\n            disabled={loading}\n            onChange={() => setLoading(true)}\n            checkedIcon={loading ? SpinnerSpokesIcon : undefined}\n            icon={loading ? SpinnerSpokesIcon : undefined}\n          >\n            Email me a daily summary of activity in my courses\n          </Checkbox>\n        </CardContent>\n      </Scroll>\n    </Card>\n  );\n}\n","import type { APIAnnotationData } from '../../types/api';\nimport { isReply } from './annotation-metadata';\n\n/**\n * Details of a user and their annotations that are available to import or export.\n */\nexport type UserAnnotations = {\n  userid: string;\n  displayName: string;\n  annotations: APIAnnotationData[];\n};\n\nexport type AnnotationsByUserOptions = {\n  annotations: APIAnnotationData[];\n  getDisplayName: (ann: APIAnnotationData) => string;\n\n  /** If true, replies will be excluded from returned annotations */\n  excludeReplies?: boolean;\n};\n\n/**\n * Generate an alphabetized list of authors and their importable/exportable\n * annotations.\n */\nexport function annotationsByUser({\n  annotations,\n  getDisplayName,\n  excludeReplies = false,\n}: AnnotationsByUserOptions): UserAnnotations[] {\n  const userInfo = new Map<string, UserAnnotations>();\n  for (const ann of annotations) {\n    if (excludeReplies && isReply(ann)) {\n      continue;\n    }\n    let info = userInfo.get(ann.user);\n    if (!info) {\n      info = {\n        userid: ann.user,\n        displayName: getDisplayName(ann),\n        annotations: [],\n      };\n      userInfo.set(ann.user, info);\n    }\n    info.annotations.push(ann);\n  }\n  const userInfos = [...userInfo.values()];\n  userInfos.sort((a, b) => a.displayName.localeCompare(b.displayName));\n  return userInfos;\n}\n","import type { DocumentMetadata } from '../../types/annotator';\nimport { truncate } from '../util/unicode';\n\n/** Format a date as an ISO `YYYY-MM-DD` string. */\nexport function formatDate(date: Date): string {\n  const year = date.getFullYear();\n  const month = `${date.getMonth() + 1}`.padStart(2, '0');\n  const day = `${date.getDate()}`.padStart(2, '0');\n\n  return `${year}-${month}-${day}`;\n}\n\nexport type SuggestedFilenameOptions = {\n  /** Metadata of the document the annotations are associated with. */\n  documentMetadata?: DocumentMetadata;\n\n  /** Name of the group containing the exported annotations. */\n  groupName?: string;\n\n  /** Date of the export. Defaults to the current date. */\n  date?: Date;\n};\n\n/**\n * Generate a default filename for a file containing an exported set of\n * annotations.\n *\n * The generated filename may not meet the character, length or other\n * restrictions of the user's system. It is assumed the browser will modify the\n * filename as needed when it downloads the file.\n */\nexport function suggestedFilename({\n  documentMetadata,\n  groupName,\n  date = new Date(),\n}: SuggestedFilenameOptions) {\n  const filenameSegments = [formatDate(date)];\n\n  if (documentMetadata?.title) {\n    filenameSegments.push(truncate(documentMetadata.title, 50));\n  } else {\n    filenameSegments.push('Hypothesis');\n  }\n\n  if (groupName) {\n    filenameSegments.push(groupName.replace(/ /g, '-'));\n  }\n\n  return filenameSegments.join('-');\n}\n","import { Spinner } from '@hypothesis/frontend-shared';\n\n/**\n * Render a consistently sized and positioned loading spinner for dialog or\n * tab content\n */\nexport default function LoadingSpinner() {\n  return (\n    <div\n      className=\"flex flex-row items-center justify-center\"\n      data-testid=\"loading-spinner\"\n    >\n      <Spinner size=\"md\" />\n    </div>\n  );\n}\n","import type { UserAnnotations } from '../../helpers/annotations-by-user';\n\nexport type UserAnnotationsListItemProps = {\n  userAnnotations: Omit<UserAnnotations, 'userid'>;\n};\n\n/**\n * UserAnnotations representation to use inside `Select.Option`.\n */\nexport function UserAnnotationsListItem({\n  userAnnotations,\n}: UserAnnotationsListItemProps) {\n  return (\n    <div className=\"flex gap-x-2\">\n      {userAnnotations.displayName}\n      <div className=\"rounded px-1 bg-grey-7 text-white\">\n        {userAnnotations.annotations.length}\n      </div>\n    </div>\n  );\n}\n","import {\n  Button,\n  CardActions,\n  Link,\n  Input,\n  CopyIcon,\n  Select,\n} from '@hypothesis/frontend-shared';\nimport { useCallback, useId, useMemo, useState } from 'preact/hooks';\n\nimport { downloadFile } from '../../../shared/download-file';\nimport { pluralize } from '../../../shared/pluralize';\nimport type { APIAnnotationData } from '../../../types/api';\nimport { annotationDisplayName } from '../../helpers/annotation-user';\nimport type { UserAnnotations } from '../../helpers/annotations-by-user';\nimport { annotationsByUser } from '../../helpers/annotations-by-user';\nimport { suggestedFilename } from '../../helpers/export-annotations';\nimport { withServices } from '../../service-context';\nimport type { AnnotationsExporter } from '../../services/annotations-exporter';\nimport type { ToastMessengerService } from '../../services/toast-messenger';\nimport { useSidebarStore } from '../../store';\nimport { copyPlainText, copyHTML } from '../../util/copy-to-clipboard';\nimport LoadingSpinner from './LoadingSpinner';\nimport { UserAnnotationsListItem } from './UserAnnotationsListItem';\n\nexport type ExportAnnotationsProps = {\n  // injected\n  annotationsExporter: AnnotationsExporter;\n  toastMessenger: ToastMessengerService;\n};\n\ntype ExportFormat = {\n  /** Unique format identifier used also as file extension */\n  value: 'json' | 'csv' | 'txt' | 'html';\n  /** The title to be displayed in the listbox item */\n  title: string;\n\n  /**\n   * The title to be displayed in the Select button.\n   * Falls back to `title` when not provided.\n   */\n  shortTitle?: string;\n\n  description: string;\n};\n\nconst exportFormats: ExportFormat[] = [\n  {\n    value: 'json',\n    title: 'JSON',\n    description: 'For import into another Hypothesis group or document',\n  },\n  {\n    value: 'txt',\n    title: 'Plain text (TXT)',\n    shortTitle: 'Text',\n    description: 'For import into word processors as plain text',\n  },\n  {\n    value: 'html',\n    title: 'Rich text (HTML)',\n    shortTitle: 'HTML',\n    description: 'For import into word processors as rich text',\n  },\n  {\n    value: 'csv',\n    title: 'Table (CSV)',\n    shortTitle: 'CSV',\n    description: 'For import into a spreadsheet',\n  },\n];\n\nfunction formatToMimeType(format: ExportFormat['value']): string {\n  const typeForFormat: Record<ExportFormat['value'], string> = {\n    json: 'application/json',\n    txt: 'text/plain',\n    csv: 'text/csv',\n    html: 'text/html',\n  };\n  return typeForFormat[format];\n}\n\n/**\n * Render content for \"export\" tab panel: allow user to export annotations\n * with a specified filename.\n */\nfunction ExportAnnotations({\n  annotationsExporter,\n  toastMessenger,\n}: ExportAnnotationsProps) {\n  const store = useSidebarStore();\n  const group = store.focusedGroup();\n  const exportReady = group && !store.isLoading();\n  const contentFrame = store.defaultContentFrame();\n\n  const exportableAnnotations = store.savedAnnotations();\n  const defaultAuthority = store.defaultAuthority();\n  const displayNamesEnabled = store.isFeatureEnabled('client_display_names');\n  const getDisplayName = useCallback(\n    (ann: APIAnnotationData) =>\n      annotationDisplayName(ann, defaultAuthority, displayNamesEnabled),\n    [defaultAuthority, displayNamesEnabled],\n  );\n  const userList = useMemo(\n    () =>\n      annotationsByUser({ annotations: exportableAnnotations, getDisplayName }),\n    [exportableAnnotations, getDisplayName],\n  );\n\n  // User whose annotations are going to be exported.\n  const profile = store.profile();\n  const currentUser = profile.userid;\n  const allAnnotationsOption: Omit<UserAnnotations, 'userid'> = useMemo(\n    () => ({\n      annotations: exportableAnnotations,\n      displayName: 'All annotations',\n    }),\n    [exportableAnnotations],\n  );\n\n  // Try to preselect current user\n  const [selectedUserId, setSelectedUserId] = useState(currentUser);\n  // Re-compute selectedUserAnnotations if:\n  //  - `userList` changes: This means annotations where created/deleted/updated\n  //  - `selectedUserId` changes: This means user was manually changed\n  const selectedUserAnnotations = useMemo(\n    () =>\n      userList.find(user => user.userid === selectedUserId) ??\n      allAnnotationsOption,\n    [allAnnotationsOption, selectedUserId, userList],\n  );\n\n  const [exportFormat, setExportFormat] = useState(exportFormats[0]);\n\n  const fileInputId = useId();\n  const userSelectId = useId();\n\n  const draftCount = store.countDrafts();\n\n  const defaultFilename = useMemo(\n    () =>\n      suggestedFilename({\n        documentMetadata: contentFrame?.metadata,\n        groupName: group?.name,\n      }),\n    [contentFrame, group],\n  );\n  const [customFilename, setCustomFilename] = useState<string>();\n\n  const buildExportContent = useCallback(\n    (format: ExportFormat['value'], context: 'file' | 'clipboard'): string => {\n      const annotationsToExport =\n        selectedUserAnnotations?.annotations ?? exportableAnnotations;\n      switch (format) {\n        case 'json': {\n          const data = annotationsExporter.buildJSONExportContent(\n            annotationsToExport,\n            { profile },\n          );\n          return JSON.stringify(data, null, 2);\n        }\n        case 'txt': {\n          return annotationsExporter.buildTextExportContent(\n            annotationsToExport,\n            {\n              groupName: group?.name,\n              defaultAuthority,\n              displayNamesEnabled,\n            },\n          );\n        }\n        case 'csv': {\n          return annotationsExporter.buildCSVExportContent(\n            annotationsToExport,\n            {\n              // We want to use tabs when copying to clipboard, so that it's\n              // possible to paste in apps like Google Sheets or OneDrive Excel.\n              // They do not properly populate a grid for comma-based CSV.\n              separator: context === 'file' ? ',' : '\\t',\n              groupName: group?.name,\n              defaultAuthority,\n              displayNamesEnabled,\n            },\n          );\n        }\n        case 'html': {\n          return annotationsExporter.buildHTMLExportContent(\n            annotationsToExport,\n            {\n              groupName: group?.name,\n              defaultAuthority,\n              displayNamesEnabled,\n            },\n          );\n        }\n        /* istanbul ignore next - This should never happen */\n        default:\n          throw new Error(`Invalid format: ${format}`);\n      }\n    },\n    [\n      annotationsExporter,\n      defaultAuthority,\n      displayNamesEnabled,\n      exportableAnnotations,\n      group?.name,\n      profile,\n      selectedUserAnnotations?.annotations,\n    ],\n  );\n  const exportAnnotations = useCallback(\n    (e: Event) => {\n      e.preventDefault();\n\n      try {\n        const format = exportFormat.value;\n        const filename = `${customFilename ?? defaultFilename}.${format}`;\n        const exportData = buildExportContent(format, 'file');\n        const mimeType = formatToMimeType(format);\n\n        downloadFile(exportData, mimeType, filename);\n      } catch (e) {\n        toastMessenger.error(`Exporting annotations failed: ${e.message}`, {\n          autoDismiss: false,\n        });\n      }\n    },\n    [\n      buildExportContent,\n      customFilename,\n      defaultFilename,\n      exportFormat.value,\n      toastMessenger,\n    ],\n  );\n  const copyAnnotationsExport = useCallback(async () => {\n    const format = exportFormat.value;\n    const exportData = buildExportContent(format, 'clipboard');\n\n    try {\n      if (format === 'html') {\n        await copyHTML(exportData);\n      } else {\n        await copyPlainText(exportData);\n      }\n\n      toastMessenger.success('Annotations copied');\n    } catch (e) {\n      toastMessenger.error(`Copying annotations failed: ${e.message}`, {\n        autoDismiss: false,\n      });\n    }\n  }, [buildExportContent, exportFormat.value, toastMessenger]);\n\n  if (!exportReady) {\n    return <LoadingSpinner />;\n  }\n\n  return (\n    <form\n      className=\"space-y-3\"\n      onSubmit={exportAnnotations}\n      data-testid=\"export-form\"\n    >\n      {exportableAnnotations.length > 0 ? (\n        <>\n          <p className=\"text-color-text-light\">\n            <Link\n              variant=\"text-light\"\n              underline=\"always\"\n              href=\"https://web.hypothes.is/help/exporting-and-importing-annotations-in-the-hypothesis-web-app/\"\n              target=\"_blank\"\n            >\n              Learn more\n            </Link>{' '}\n            about copying and exporting annotations.\n          </p>\n          <div className=\"flex flex-col gap-y-3\">\n            <label htmlFor={userSelectId} className=\"font-medium\">\n              Select which user{\"'\"}s annotations to export:\n            </label>\n            <Select\n              value={selectedUserId}\n              onChange={setSelectedUserId}\n              buttonId={userSelectId}\n              buttonContent={\n                <UserAnnotationsListItem\n                  userAnnotations={selectedUserAnnotations}\n                />\n              }\n              data-testid=\"user-select\"\n            >\n              <Select.Option value={undefined}>\n                <UserAnnotationsListItem\n                  userAnnotations={allAnnotationsOption}\n                />\n              </Select.Option>\n              {userList.map(userInfo => (\n                <Select.Option key={userInfo.userid} value={userInfo.userid}>\n                  <UserAnnotationsListItem userAnnotations={userInfo} />\n                </Select.Option>\n              ))}\n            </Select>\n            <label\n              data-testid=\"export-count\"\n              htmlFor={fileInputId}\n              className=\"font-medium\"\n            >\n              Name of export file:\n            </label>\n            <div className=\"flex\">\n              <Input\n                classes=\"grow\"\n                data-testid=\"export-filename\"\n                id={fileInputId}\n                defaultValue={defaultFilename}\n                value={customFilename}\n                onChange={e =>\n                  setCustomFilename((e.target as HTMLInputElement).value)\n                }\n                required\n                maxLength={250}\n              />\n              <div className=\"grow-0 ml-2 min-w-[5rem]\">\n                <Select\n                  aria-label=\"Export format\"\n                  value={exportFormat}\n                  onChange={setExportFormat}\n                  buttonContent={exportFormat.shortTitle ?? exportFormat.title}\n                  data-testid=\"export-format-select\"\n                  alignListbox=\"right\"\n                  listboxOverflow=\"wrap\"\n                >\n                  {exportFormats.map(exportFormat => (\n                    <Select.Option\n                      key={exportFormat.value}\n                      value={exportFormat}\n                    >\n                      <div className=\"flex-col gap-y-2\">\n                        <div className=\"font-bold\" data-testid=\"format-name\">\n                          {exportFormat.title}\n                        </div>\n                        <div data-testid=\"format-description\">\n                          {exportFormat.description}\n                        </div>\n                      </div>\n                    </Select.Option>\n                  ))}\n                </Select>\n              </div>\n            </div>\n          </div>\n        </>\n      ) : (\n        <p data-testid=\"no-annotations-message\">\n          There are no annotations available for export.\n        </p>\n      )}\n      {draftCount > 0 && (\n        <p data-testid=\"drafts-message\">\n          You have {draftCount} unsaved{' '}\n          {pluralize(draftCount, 'draft', 'drafts')}\n          {exportableAnnotations.length > 0 && <> that will not be included</>}.\n        </p>\n      )}\n      <CardActions>\n        <Button\n          data-testid=\"copy-button\"\n          icon={CopyIcon}\n          onClick={copyAnnotationsExport}\n          disabled={exportableAnnotations.length === 0}\n        >\n          Copy to clipboard\n        </Button>\n        <Button\n          data-testid=\"export-button\"\n          variant=\"primary\"\n          disabled={exportableAnnotations.length === 0}\n          type=\"submit\"\n        >\n          Export\n        </Button>\n      </CardActions>\n    </form>\n  );\n}\n\nexport default withServices(ExportAnnotations, [\n  'annotationsExporter',\n  'toastMessenger',\n]);\n","export function downloadFile(\n  content: string,\n  type: string,\n  filename: string,\n  /* istanbul ignore next - test seam */\n  document_ = document,\n): void {\n  const blob = new Blob([content], { type });\n  const url = URL.createObjectURL(blob);\n\n  const link = document_.createElement('a');\n  link.setAttribute('href', url);\n  link.setAttribute('download', filename);\n  link.style.visibility = 'hidden';\n\n  document_.body.appendChild(link);\n  link.click();\n  document_.body.removeChild(link);\n\n  URL.revokeObjectURL(url);\n}\n","import { promiseWithResolvers } from './promise-with-resolvers';\n\n/**\n * Reads and tries to JSON-parse a file\n * @return - Promise that resolves to parsed content or rejects with any error\n *           that occurred during parsing\n */\nexport function readJSONFile(\n  file: File,\n  /* istanbul ignore next - test seam */\n  fileReader = new FileReader(),\n): Promise<unknown> {\n  const { promise, resolve, reject } = promiseWithResolvers();\n\n  fileReader.addEventListener('loadend', (e: ProgressEvent<FileReader>) => {\n    try {\n      const content = e.target?.result?.toString() ?? '';\n      const parsed = JSON.parse(content);\n\n      resolve(parsed);\n    } catch (error) {\n      reject(error);\n    }\n  });\n  fileReader.readAsText(file);\n\n  return promise;\n}\n","export type PromiseWithResolvers<T> = {\n  promise: Promise<T>;\n  resolve: (value: T) => void;\n  reject: (error: any) => void;\n};\n\n/**\n * This function behaves like Promise.withResolvers\n * See https://tc39.es/proposal-promise-with-resolvers/\n */\nexport function promiseWithResolvers<T = unknown>(): PromiseWithResolvers<T> {\n  let resolve: PromiseWithResolvers<T>['resolve'];\n  let reject: PromiseWithResolvers<T>['reject'];\n  const promise = new Promise<T>((resolve_, reject_) => {\n    resolve = resolve_;\n    reject = reject_;\n  });\n\n  return { promise, resolve: resolve!, reject: reject! };\n}\n","export type CircularProgressProps = {\n  /** Width and height of the indicator in pixels. */\n  size: number;\n\n  /** Progress value between 0 and 100. */\n  value: number;\n};\n\n/**\n * A compact circular progress indicator.\n */\nexport default function CircularProgress({\n  size,\n  value,\n}: CircularProgressProps) {\n  const strokeWidth = 2;\n\n  // Internal diameter of circle.\n  const diameter = size - 2 * strokeWidth;\n  const circumference = Math.PI * diameter;\n\n  return (\n    <span\n      // This assumes a dark background. We'll need a variant for light\n      // backgrounds at some point.\n      className=\"text-grey-3\"\n      role=\"progressbar\"\n      aria-valuenow={value}\n      style={{\n        width: `${size}px`,\n        height: `${size}px`,\n\n        // Orient circle so that stroke is drawn starting from the top. By\n        // default it starts from 3 o'clock and goes clockwise.\n        transform: 'rotate(-90deg)',\n      }}\n    >\n      <svg viewBox={`0 0 ${size} ${size}`}>\n        <circle\n          cx={size / 2}\n          cy={size / 2}\n          r={diameter / 2}\n          fill=\"none\"\n          stroke=\"currentColor\"\n          stroke-width={strokeWidth}\n          style={{\n            // Stroke circle with a single dash, shortened by an offset that\n            // depends on the value.\n            strokeDasharray: circumference,\n            strokeDashoffset: `${\n              circumference - circumference * (value / 100)\n            }px`,\n            transitionDuration: '300ms',\n            transitionProperty: 'stroke-dashoffset',\n          }}\n        />\n      </svg>\n    </span>\n  );\n}\n","import { Button, FileGenericIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useRef, useState } from 'preact/hooks';\n\nexport type FileInputProps = {\n  onFileSelected: (file: File) => void;\n  disabled?: boolean;\n\n  /** ID for the `<input type=\"file\">` element. */\n  id?: string;\n};\n\nexport default function FileInput({\n  onFileSelected,\n  disabled,\n  id,\n}: FileInputProps) {\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [filename, setFilename] = useState<string | null>(null);\n\n  return (\n    <Button\n      variant=\"custom\"\n      classes={classnames(\n        'w-full relative overflow-hidden border rounded',\n        'bg-grey-0 hover:bg-grey-0',\n      )}\n      title={filename ? `${filename}, Select a file` : 'Select a file'}\n      onClick={() => fileInputRef.current?.click()}\n      disabled={disabled}\n      data-testid=\"file-input-proxy-button\"\n    >\n      <input\n        ref={fileInputRef}\n        accept=\".json\"\n        id={id}\n        type=\"file\"\n        disabled={disabled}\n        className=\"invisible absolute w-0 h-0\"\n        aria-hidden\n        data-testid=\"file-input\"\n        onChange={e => {\n          const files = (e.target as HTMLInputElement)!.files;\n          setFilename(files?.[0]?.name ?? null);\n\n          if (files !== null && files.length > 0) {\n            onFileSelected(files[0]);\n          }\n        }}\n      />\n      <div\n        className=\"max-w-full pr-10 truncate\"\n        data-testid=\"filename-container\"\n      >\n        {filename ?? 'Select a file'}\n      </div>\n      <div className=\"absolute right-0 h-full p-2 border-l bg-grey-2\">\n        <FileGenericIcon />\n      </div>\n    </Button>\n  );\n}\n","import { Button, CardActions, Link, Select } from '@hypothesis/frontend-shared';\nimport { useCallback, useEffect, useId, useMemo, useState } from 'preact/hooks';\n\nimport type { APIAnnotationData } from '../../../types/api';\nimport { annotationDisplayName } from '../../helpers/annotation-user';\nimport { annotationsByUser } from '../../helpers/annotations-by-user';\nimport { readExportFile } from '../../helpers/import';\nimport { withServices } from '../../service-context';\nimport type { ImportAnnotationsService } from '../../services/import-annotations';\nimport { useSidebarStore } from '../../store';\nimport CircularProgress from '../CircularProgress';\nimport FileInput from './FileInput';\nimport { UserAnnotationsListItem } from './UserAnnotationsListItem';\n\nexport type ImportAnnotationsProps = {\n  importAnnotationsService: ImportAnnotationsService;\n};\n\n/**\n * Content of \"Import\" tab of annotation share dialog.\n *\n * This allows the user to select a previously exported file of annotations\n * and initiate an import via {@link ImportAnnotationsService}.\n */\nfunction ImportAnnotations({\n  importAnnotationsService,\n}: ImportAnnotationsProps) {\n  const [file, setFile] = useState<File | null>(null);\n\n  // Annotations extracted from `file`.\n  const [annotations, setAnnotations] = useState<APIAnnotationData[] | null>(\n    null,\n  );\n  const [error, setError] = useState<string | null>(null);\n\n  const store = useSidebarStore();\n  const currentUser = store.profile().userid;\n\n  const defaultAuthority = store.defaultAuthority();\n  const displayNamesEnabled = store.isFeatureEnabled('client_display_names');\n  const getDisplayName = useCallback(\n    (ann: APIAnnotationData) =>\n      annotationDisplayName(ann, defaultAuthority, displayNamesEnabled),\n    [defaultAuthority, displayNamesEnabled],\n  );\n  const userList = useMemo(\n    () =>\n      annotations\n        ? annotationsByUser({\n            annotations,\n            getDisplayName,\n            // We decided to exclude replies from the initial implementation of\n            // annotation import, to simplify the feature.\n            excludeReplies: true,\n          })\n        : null,\n    [annotations, getDisplayName],\n  );\n\n  // User whose annotations are going to be imported.\n  const [selectedUserId, setSelectedUserId] = useState<string | null>(null);\n  const selectedUser = useMemo(\n    () => userList?.find(user => user.userid === selectedUserId) ?? null,\n    [selectedUserId, userList],\n  );\n\n  // Parse input file, extract annotations and update the user list.\n  useEffect(() => {\n    if (!currentUser || !file) {\n      return;\n    }\n    setAnnotations(null);\n    setError(null);\n    setSelectedUserId(null);\n    readExportFile(file)\n      .then(annotations => {\n        setAnnotations(annotations);\n\n        // Pre-select the current user in the list, if at least one of the\n        // annotations was authored by them.\n        const userMatch = annotations.some(ann => ann.user === currentUser);\n        setSelectedUserId(userMatch ? currentUser : null);\n      })\n      .catch(err => {\n        setError(err.message);\n      });\n  }, [currentUser, file]);\n\n  let importAnnotations;\n  if (selectedUser) {\n    importAnnotations = async () => {\n      // nb. In the event of an error, `import` will report that directly via\n      // a toast message, so we don't do that ourselves.\n      importAnnotationsService.import(selectedUser.annotations);\n    };\n  }\n\n  const fileInputId = useId();\n  const userSelectId = useId();\n\n  if (!currentUser) {\n    // TODO - Make \"Log in\" a link.\n    return (\n      <p data-testid=\"log-in-message\">You must log in to import annotations.</p>\n    );\n  }\n\n  // In order to perform an import, we need:\n  //\n  //  1. A group to import into\n  //  2. A frame from which to get the document URI and metadata\n  //  3. Existing annotations for the group loaded so we can de-duplicate against\n  //     them\n  //  4. A file to import from and a selection of what to import\n  //     (`importAnnotations` will be falsey if this is not the case).\n  const importReady = Boolean(\n    store.focusedGroup() &&\n      store.defaultContentFrame() &&\n      store.hasFetchedAnnotations() &&\n      !store.isFetchingAnnotations() &&\n      importAnnotations,\n  );\n\n  // True if we're validating a JSON file after it has been selected.\n  const parseInProgress = file && !annotations && !error;\n\n  // True if we're validating or importing.\n  const importsPending = store.importsPending();\n  const importsTotal = store.importsTotal();\n  const importsCompleted = importsTotal - importsPending;\n\n  const busy = parseInProgress || importsPending > 0;\n\n  const importProgress =\n    importsPending > 0\n      ? Math.round((importsCompleted / importsTotal) * 100)\n      : null;\n\n  return (\n    <>\n      <p className=\"text-color-text-light mb-3\">\n        <Link\n          variant=\"text-light\"\n          underline=\"always\"\n          href=\"https://web.hypothes.is/help/exporting-and-importing-annotations/\"\n          target=\"_blank\"\n        >\n          Learn more\n        </Link>{' '}\n        about importing annotations.\n      </p>\n      <label htmlFor={fileInputId} className=\"font-medium\">\n        Select Hypothesis export file:\n      </label>\n      <FileInput onFileSelected={setFile} disabled={busy} id={fileInputId} />\n      {userList && (\n        <>\n          <label htmlFor={userSelectId} className=\"block font-medium\">\n            Select which user&apos;s annotations to import:\n          </label>\n          <Select\n            value={selectedUser}\n            onChange={newValue => setSelectedUserId(newValue?.userid ?? null)}\n            buttonId={userSelectId}\n            buttonContent={\n              selectedUser ? (\n                <UserAnnotationsListItem userAnnotations={selectedUser} />\n              ) : (\n                <span className=\"text-grey-6\">Select a user...</span>\n              )\n            }\n          >\n            {userList.map(userInfo => (\n              <Select.Option key={userInfo.userid} value={userInfo}>\n                <UserAnnotationsListItem userAnnotations={userInfo} />\n              </Select.Option>\n            ))}\n          </Select>\n        </>\n      )}\n      {error && (\n        // TODO - Add a support link here.\n        <p data-testid=\"error-info\">\n          <b>Unable to find annotations to import:</b> {error}\n        </p>\n      )}\n      <CardActions>\n        {importProgress !== null && (\n          <span data-testid=\"progress-text\" className=\"text-grey-6\">\n            {importProgress}% complete\n          </span>\n        )}\n        <Button\n          data-testid=\"import-button\"\n          disabled={!importReady || busy}\n          onClick={importAnnotations}\n          variant=\"primary\"\n        >\n          {importProgress !== null && (\n            <CircularProgress size={22} value={importProgress} />\n          )}\n          Import\n        </Button>\n      </CardActions>\n    </>\n  );\n}\n\nexport default withServices(ImportAnnotations, ['importAnnotationsService']);\n","import { isObject } from '../../shared/is-object';\nimport { readJSONFile } from '../../shared/read-json-file';\nimport type { APIAnnotationData } from '../../types/api';\nimport type { JSONExportContent } from '../services/annotations-exporter';\n\n/**\n * Parse a file generated by the annotation exporter and return the extracted\n * annotations.\n */\nexport async function readExportFile(file: File): Promise<APIAnnotationData[]> {\n  let json;\n  try {\n    json = await readJSONFile(file);\n  } catch {\n    throw new Error('Not a valid JSON file');\n  }\n\n  // Perform some very rudimentary validation of the file content, just enough\n  // to catch issues where the user picked the wrong kind of JSON file.\n  if (!isObject(json) || !Array.isArray((json as any).annotations)) {\n    throw new Error('Not a valid Hypothesis JSON file');\n  }\n\n  return (json as JSONExportContent).annotations;\n}\n","export function isObject(value: unknown): value is object {\n  return value !== null && typeof value === 'object';\n}\n","import {\n  CopyIcon,\n  Input,\n  InputGroup,\n  IconButton,\n  LockFilledIcon,\n} from '@hypothesis/frontend-shared';\nimport { useCallback } from 'preact/hooks';\n\nimport { pageSharingLink } from '../../helpers/annotation-sharing';\nimport { withServices } from '../../service-context';\nimport type { ToastMessengerService } from '../../services/toast-messenger';\nimport { useSidebarStore } from '../../store';\nimport { copyPlainText } from '../../util/copy-to-clipboard';\nimport ShareLinks from '../ShareLinks';\nimport LoadingSpinner from './LoadingSpinner';\n\nexport type ShareAnnotationsProps = {\n  // injected\n  toastMessenger: ToastMessengerService;\n};\n\n/**\n * Render UI for sharing annotations (by URL) within the currently-focused group\n */\nfunction ShareAnnotations({ toastMessenger }: ShareAnnotationsProps) {\n  const store = useSidebarStore();\n  const mainFrame = store.mainFrame();\n  const focusedGroup = store.focusedGroup();\n  const sharingReady = focusedGroup && mainFrame;\n\n  const shareURI =\n    sharingReady && pageSharingLink(mainFrame.uri, focusedGroup.id);\n\n  const copyShareLink = useCallback(async () => {\n    try {\n      if (shareURI) {\n        await copyPlainText(shareURI);\n        toastMessenger.success('Copied share link to clipboard');\n      }\n    } catch {\n      toastMessenger.error('Unable to copy link');\n    }\n  }, [shareURI, toastMessenger]);\n\n  if (!sharingReady) {\n    return <LoadingSpinner />;\n  }\n\n  return (\n    <div className=\"text-color-text-light space-y-3\">\n      {shareURI ? (\n        <>\n          <div\n            className=\"text-color-text font-medium\"\n            data-testid=\"sharing-intro\"\n          >\n            {focusedGroup.type === 'private' ? (\n              <p>\n                Use this link to share these annotations with other group\n                members:\n              </p>\n            ) : (\n              <p>Use this link to share these annotations with anyone:</p>\n            )}\n          </div>\n          <div>\n            <InputGroup>\n              <Input\n                aria-label=\"Use this URL to share these annotations\"\n                type=\"text\"\n                value={shareURI}\n                readOnly\n              />\n              <IconButton\n                icon={CopyIcon}\n                onClick={copyShareLink}\n                title=\"Copy share link\"\n                variant=\"dark\"\n              />\n            </InputGroup>\n          </div>\n          <p data-testid=\"sharing-details\">\n            {focusedGroup.type === 'private' ? (\n              <span>\n                Annotations in the private group <em>{focusedGroup.name}</em>{' '}\n                are only visible to group members.\n              </span>\n            ) : (\n              <span>\n                Anyone using this link may view the annotations in the group{' '}\n                <em>{focusedGroup.name}</em>.\n              </span>\n            )}{' '}\n            <span>\n              Private (\n              <LockFilledIcon className=\"inline w-[14px] h-[14px] -mt-0.5\" />{' '}\n              <em>Only Me</em>) annotations are only visible to you.\n            </span>\n          </p>\n          <div className=\"text-[24px]\">\n            <ShareLinks shareURI={shareURI} />\n          </div>\n        </>\n      ) : (\n        <p data-testid=\"no-sharing\">\n          These annotations cannot be shared because this document is not\n          available on the web.\n        </p>\n      )}\n    </div>\n  );\n}\n\nexport default withServices(ShareAnnotations, ['toastMessenger']);\n","import { Card, Tab } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useState } from 'preact/hooks';\n\nimport { useSidebarStore } from '../../store';\nimport SidebarPanel from '../SidebarPanel';\nimport TabHeader from '../tabs/TabHeader';\nimport TabPanel from '../tabs/TabPanel';\nimport ExportAnnotations from './ExportAnnotations';\nimport ImportAnnotations from './ImportAnnotations';\nimport ShareAnnotations from './ShareAnnotations';\n\nexport type ShareDialogProps = {\n  /** If true, the share tab will be rendered. Defaults to false */\n  shareTab?: boolean;\n};\n\n/**\n * Panel with sharing options.\n * - If provided tabs include `export` or `import`, will show a tabbed interface\n * - Else, shows a single \"Share annotations\" interface\n */\nexport default function ShareDialog({ shareTab }: ShareDialogProps) {\n  const store = useSidebarStore();\n  const focusedGroup = store.focusedGroup();\n  const groupName = (focusedGroup && focusedGroup.name) || '...';\n  const panelTitle = `Share Annotations in ${groupName}`;\n\n  // Determine initial selected tab, based on the first tab that will be displayed\n  const initialTab = shareTab ? 'share' : 'export';\n  const [selectedTab, setSelectedTab] = useState<'share' | 'export' | 'import'>(\n    initialTab,\n  );\n  const isFirstTabSelected = selectedTab === initialTab;\n\n  return (\n    <SidebarPanel\n      title={panelTitle}\n      panelName=\"shareGroupAnnotations\"\n      variant=\"custom\"\n    >\n      <TabHeader closeTitle=\"Close share panel\">\n        {shareTab && (\n          <Tab\n            id=\"share-panel-tab\"\n            aria-controls=\"share-panel\"\n            variant=\"tab\"\n            selected={selectedTab === 'share'}\n            onClick={() => setSelectedTab('share')}\n            textContent=\"Share\"\n          >\n            Share\n          </Tab>\n        )}\n        <Tab\n          id=\"export-panel-tab\"\n          aria-controls=\"export-panel\"\n          variant=\"tab\"\n          selected={selectedTab === 'export'}\n          onClick={() => setSelectedTab('export')}\n          textContent=\"Export\"\n        >\n          Export\n        </Tab>\n        <Tab\n          id=\"import-panel-tab\"\n          aria-controls=\"import-panel\"\n          variant=\"tab\"\n          selected={selectedTab === 'import'}\n          onClick={() => setSelectedTab('import')}\n          textContent=\"Import\"\n        >\n          Import\n        </Tab>\n      </TabHeader>\n      <Card classes={classnames({ 'rounded-tl-none': isFirstTabSelected })}>\n        <TabPanel\n          id=\"share-panel\"\n          active={selectedTab === 'share'}\n          aria-labelledby=\"share-panel-tab\"\n          title={panelTitle}\n        >\n          <ShareAnnotations />\n        </TabPanel>\n        <TabPanel\n          id=\"export-panel\"\n          active={selectedTab === 'export'}\n          aria-labelledby=\"export-panel-tab\"\n          title={`Export from ${groupName}`}\n        >\n          <ExportAnnotations />\n        </TabPanel>\n        <TabPanel\n          id=\"import-panel\"\n          active={selectedTab === 'import'}\n          aria-labelledby=\"import-panel-tab\"\n          title={`Import into ${groupName}`}\n        >\n          <ImportAnnotations />\n        </TabPanel>\n      </Card>\n    </SidebarPanel>\n  );\n}\n","import { Link, LinkButton, LogoIcon } from '@hypothesis/frontend-shared';\n\nimport { useSidebarStore } from '../store';\n\nexport type LoggedOutMessageProps = {\n  onLogin: () => void;\n};\n\n/**\n * Render a call-to-action to log in or sign up. This message is intended to be\n * displayed to non-auth'd users when viewing a single annotation in a\n * direct-linked context (i.e. URL with syntax `/#annotations:<annotation_id>`)\n */\nfunction LoggedOutMessage({ onLogin }: LoggedOutMessageProps) {\n  const store = useSidebarStore();\n\n  return (\n    <div className=\"flex flex-col items-center m-6 space-y-6\">\n      <span className=\"text-center\">\n        This is a public annotation created with Hypothesis. <br />\n        To reply or make your own annotations on this document,{' '}\n        <Link\n          variant=\"text\"\n          href={store.getLink('signup')}\n          target=\"_blank\"\n          underline=\"always\"\n        >\n          create a free account\n        </Link>{' '}\n        or{' '}\n        <LinkButton inline variant=\"text\" onClick={onLogin} underline=\"always\">\n          log in\n        </LinkButton>\n        .\n      </span>\n      <div>\n        <Link\n          href=\"https://hypothes.is\"\n          aria-label=\"Hypothesis homepage\"\n          target=\"_blank\"\n          title=\"Hypothesis homepage\"\n          underline=\"none\"\n          variant=\"custom\"\n        >\n          <LogoIcon className=\"w-16 h-16 text-grey-7\" />\n        </Link>\n      </div>\n    </div>\n  );\n}\n\nexport default LoggedOutMessage;\n","import {\n  Button,\n  CardActions,\n  RestrictedIcon,\n} from '@hypothesis/frontend-shared';\n\nimport { useSidebarStore } from '../store';\nimport SidebarPanel from './SidebarPanel';\n\nexport type LoginPromptPanelProps = {\n  onLogin: () => void;\n  onSignUp: () => void;\n};\n\n/**\n * A sidebar panel that prompts a user to log in (or sign up) to annotate.\n */\nexport default function LoginPromptPanel({\n  onLogin,\n  onSignUp,\n}: LoginPromptPanelProps) {\n  const store = useSidebarStore();\n  const isLoggedIn = store.isLoggedIn();\n  if (isLoggedIn) {\n    return null;\n  }\n  return (\n    <SidebarPanel\n      icon={RestrictedIcon}\n      title=\"Login needed\"\n      panelName=\"loginPrompt\"\n    >\n      <p>Please log in to create annotations or highlights.</p>\n      <CardActions>\n        <Button title=\"Sign up\" onClick={onSignUp}>\n          Sign up\n        </Button>\n        <Button title=\"Log in\" variant=\"primary\" onClick={onLogin}>\n          Log in\n        </Button>\n      </CardActions>\n    </SidebarPanel>\n  );\n}\n","import {\n  AnnotateIcon,\n  Button,\n  Card,\n  CardContent,\n  LinkButton,\n  PlusIcon,\n} from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport type { ComponentChildren } from 'preact';\n\nimport { pluralize } from '../../shared/pluralize';\nimport type { SidebarSettings } from '../../types/config';\nimport type { TabName } from '../../types/sidebar';\nimport { applyTheme } from '../helpers/theme';\nimport { withServices } from '../service-context';\nimport type { AnnotationsService } from '../services/annotations';\nimport { useSidebarStore } from '../store';\nimport ThreadList from './ThreadList';\nimport { useRootThread } from './hooks/use-root-thread';\n\nconst idForTab = (name: TabName) => `${name}-tab`;\nconst idForPanel = (name: TabName) => `${name}-panel`;\n\ntype TabProps = {\n  children: ComponentChildren;\n\n  /** The total number of annotations for this tab */\n  count: number;\n\n  /** Is this tab the currently-active tab? */\n  isSelected: boolean;\n\n  /** Are there any annotations still waiting to anchor? */\n  isWaitingToAnchor: boolean;\n\n  label: string;\n  name: TabName;\n\n  /** Callback to invoke when this tab is selected */\n  onSelect: () => void;\n};\n\n/**\n * Display name of the tab and annotation count\n */\nfunction Tab({\n  children,\n  count,\n  isWaitingToAnchor,\n  isSelected,\n  label,\n  onSelect,\n  name,\n}: TabProps) {\n  const selectTab = () => {\n    if (!isSelected) {\n      onSelect();\n    }\n  };\n\n  const title = count > 0 ? `${label} (${count} available)` : label;\n\n  return (\n    <LinkButton\n      classes={classnames('bg-transparent min-w-[5.25rem]', {\n        'font-bold': isSelected,\n      })}\n      variant=\"text\"\n      // Listen for `onMouseDown` so that the tab is selected when _pressed_\n      // as this makes the UI feel faster. Also listen for `onClick` as a fallback\n      // to enable selecting the tab via other input methods.\n      onClick={selectTab}\n      onMouseDown={selectTab}\n      pressed={!!isSelected}\n      role=\"tab\"\n      id={idForTab(name)}\n      aria-controls={idForPanel(name)}\n      tabIndex={0}\n      title={title}\n      underline=\"none\"\n    >\n      <>\n        {children}\n        {count > 0 && !isWaitingToAnchor && (\n          <span className=\"relative bottom-[3px] left-[2px] text-[10px]\">\n            {count}\n          </span>\n        )}\n      </>\n    </LinkButton>\n  );\n}\n\nexport type SidebarTabsProps = {\n  /** Are we waiting on any annotations from the server? */\n  isLoading: boolean;\n\n  // injected\n  settings: SidebarSettings;\n  annotationsService: AnnotationsService;\n};\n\n/**\n * Tabbed display of annotations and notes\n */\nfunction SidebarTabs({\n  annotationsService,\n  isLoading,\n  settings,\n}: SidebarTabsProps) {\n  const { rootThread, tabCounts } = useRootThread();\n  const store = useSidebarStore();\n  const selectedTab = store.selectedTab();\n  const noteCount = tabCounts.note;\n  const annotationCount = tabCounts.annotation;\n  const orphanCount = tabCounts.orphan;\n  const isWaitingToAnchorAnnotations = store.isWaitingToAnchorAnnotations();\n\n  const selectTab = (tabId: TabName) => {\n    store.selectTab(tabId);\n  };\n\n  const showAnnotationsUnavailableMessage =\n    selectedTab === 'annotation' &&\n    annotationCount === 0 &&\n    !isWaitingToAnchorAnnotations;\n\n  const showNotesUnavailableMessage = selectedTab === 'note' && noteCount === 0;\n\n  const tabCountsSummaryPieces = [];\n  if (annotationCount > 0) {\n    const term = pluralize(annotationCount, 'annotation', 'annotations');\n    tabCountsSummaryPieces.push(`${annotationCount} ${term}`);\n  }\n  if (noteCount > 0) {\n    const term = pluralize(noteCount, 'note', 'notes');\n    tabCountsSummaryPieces.push(`${noteCount} ${term}`);\n  }\n  if (orphanCount > 0) {\n    const term = pluralize(noteCount, 'orphan', 'orphans');\n    tabCountsSummaryPieces.push(`${orphanCount} ${term}`);\n  }\n  const tabCountsSummary = tabCountsSummaryPieces.join(', ');\n\n  return (\n    <>\n      <div aria-live=\"polite\" role=\"status\" className=\"sr-only\">\n        {tabCountsSummary}\n      </div>\n      <div\n        className={classnames(\n          // 9px balances out the space above the tabs\n          'space-y-3 pb-[9px]',\n        )}\n      >\n        <div className=\"flex gap-x-6 theme-clean:ml-[15px] mt-1\" role=\"tablist\">\n          <Tab\n            count={annotationCount}\n            isWaitingToAnchor={isWaitingToAnchorAnnotations}\n            isSelected={selectedTab === 'annotation'}\n            label=\"Annotations\"\n            name=\"annotation\"\n            onSelect={() => selectTab('annotation')}\n          >\n            Annotations\n          </Tab>\n          <Tab\n            count={noteCount}\n            isWaitingToAnchor={isWaitingToAnchorAnnotations}\n            isSelected={selectedTab === 'note'}\n            label=\"Page notes\"\n            name=\"note\"\n            onSelect={() => selectTab('note')}\n          >\n            Page Notes\n          </Tab>\n          {orphanCount > 0 && (\n            <Tab\n              count={orphanCount}\n              isWaitingToAnchor={isWaitingToAnchorAnnotations}\n              isSelected={selectedTab === 'orphan'}\n              label=\"Orphans\"\n              name=\"orphan\"\n              onSelect={() => selectTab('orphan')}\n            >\n              Orphans\n            </Tab>\n          )}\n        </div>\n        <div\n          className=\"space-y-3\"\n          role=\"tabpanel\"\n          id={idForPanel(selectedTab)}\n          aria-labelledby={idForTab(selectedTab)}\n        >\n          {selectedTab === 'note' &&\n            settings.enableExperimentalNewNoteButton && (\n              <div className=\"flex justify-end\">\n                <Button\n                  data-testid=\"new-note-button\"\n                  onClick={() => annotationsService.createPageNote()}\n                  variant=\"primary\"\n                  style={applyTheme(['ctaBackgroundColor'], settings)}\n                >\n                  <PlusIcon />\n                  New note\n                </Button>\n              </div>\n            )}\n          {!isLoading && showNotesUnavailableMessage && (\n            <Card data-testid=\"notes-unavailable-message\" variant=\"flat\">\n              <CardContent classes=\"text-center\">\n                There are no page notes in this group.\n              </CardContent>\n            </Card>\n          )}\n          {!isLoading && showAnnotationsUnavailableMessage && (\n            <Card data-testid=\"annotations-unavailable-message\" variant=\"flat\">\n              <CardContent\n                // TODO: Remove !important spacing class after\n                // https://github.com/hypothesis/frontend-shared/issues/676 is addressed\n                classes=\"text-center !space-y-1\"\n              >\n                <p>There are no annotations in this group.</p>\n                <p>\n                  Create one by selecting some text and clicking the{' '}\n                  <AnnotateIcon\n                    className=\"w-em h-em inline m-0.5 -mt-0.5\"\n                    title=\"Annotate\"\n                  />{' '}\n                  button.\n                </p>\n              </CardContent>\n            </Card>\n          )}\n          <ThreadList threads={rootThread.children} />\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default withServices(SidebarTabs, ['annotationsService', 'settings']);\n","import {\n  Card,\n  CardContent,\n  Button,\n  FileGenericIcon,\n  MinusIcon,\n  PlusIcon,\n  ProfileIcon,\n} from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { Fragment } from 'preact';\nimport type { ComponentChildren } from 'preact';\n\nimport { useSidebarStore } from '../../store';\n\ntype IconComponent = typeof FileGenericIcon;\n\ntype FilterToggleProps = {\n  /** A short description of what the filter matches (eg. \"Pages 10-20\") */\n  label: string;\n\n  /**\n   * Icon representation of the filter controlled by this toggle, displayed\n   * alongside the label.\n   */\n  icon?: IconComponent;\n\n  /**\n   * A longer description of what the filter matches (eg. \"Show annotations\n   * on pages 10-20\").\n   */\n  description: string;\n\n  /** Is the filter currently active? */\n  active: boolean;\n\n  /** Toggle whether the filter is active. */\n  setActive: (active: boolean) => void;\n\n  testId?: string;\n\n  disabled?: boolean;\n};\n\n/**\n * A switch for toggling whether a filter is active or not.\n */\nfunction FilterToggle({\n  label,\n  icon: IconComponent,\n  description,\n  active,\n  disabled = false,\n  setActive,\n  testId,\n}: FilterToggleProps) {\n  return (\n    <Button\n      data-testid={testId}\n      classes={classnames({\n        // Compared to our regular buttons, these have less vertical padding,\n        // stronger rounding and slightly thinner text.\n        'font-medium rounded-lg py-1': true,\n        'text-grey-7 bg-grey-2': !active,\n        'text-grey-1 bg-grey-7': active,\n        'opacity-50': disabled,\n      })}\n      disabled={disabled}\n      onClick={() => setActive(!active)}\n      pressed={active}\n      variant=\"custom\"\n      title={description}\n    >\n      {IconComponent && <IconComponent className=\"w-em h-em\" />}\n      <span className=\"max-w-36 truncate\">{label}</span>\n      <div\n        // Vertical divider line between label and active/inactive state.\n        // This should fill the button vertically.\n        className={classnames({\n          'h-[2em] w-[1.5px] -mt-1 -mb-1': true,\n          'bg-grey-3': !active,\n          'bg-grey-5': active,\n        })}\n      />\n      {active ? (\n        <MinusIcon className=\"w-em h-em\" />\n      ) : (\n        <PlusIcon className=\"w-em h-em\" />\n      )}\n    </Button>\n  );\n}\n\n/**\n * Container for the filter controls when it is rendered standalone, outside\n * the search panel.\n */\nfunction CardContainer({ children }: { children: ComponentChildren }) {\n  return (\n    <div className=\"mb-3\">\n      <Card>\n        <CardContent>{children}</CardContent>\n      </Card>\n    </div>\n  );\n}\n\nexport type FilterControlsProps = {\n  /**\n   * Whether to render the controls in a card container.\n   *\n   * The container is rendered by `FilterControls` rather than the parent,\n   * because `FilterControls` can conditionally render nothing if no filter is\n   * configured.\n   */\n  withCardContainer?: boolean;\n};\n\n/**\n * Displays the state of various filters and allows the user to toggle them.\n *\n * This includes:\n *\n *  - Focus filters which show anotations from particular user, page range\n *    etc.\n *  - Selection state\n *\n * This doesn't include the state of other layers of filters which have their\n * own UI controls such as search or the annotation type tabs.\n */\nexport default function FilterControls({\n  withCardContainer = false,\n}: FilterControlsProps) {\n  const store = useSidebarStore();\n\n  const selectedCount = store.selectedAnnotations().length;\n  const hasSelection = selectedCount > 0;\n\n  const focusActive = store.getFocusActive();\n  const focusFilters = store.getFocusFilters();\n\n  // Are any focus filters configured?\n  const hasFocusFilters = Object.keys(focusFilters).length > 0;\n\n  const hasFilters = hasSelection || hasFocusFilters;\n\n  // When there are no active filters, remove the container so its padding\n  // doesn't unnecessarily take up empty space.\n  if (!hasFilters) {\n    return null;\n  }\n\n  const Container = withCardContainer ? CardContainer : Fragment;\n\n  return (\n    <Container>\n      <div\n        className=\"flex flex-row flex-wrap gap-2 items-center\"\n        data-testid=\"filter-controls\"\n      >\n        <b>Filters</b>\n        {hasSelection && (\n          <FilterToggle\n            label={`${selectedCount} selected`}\n            description={`Show ${selectedCount} selected annotations`}\n            active={true}\n            setActive={() => store.clearSelection()}\n            testId=\"selection-toggle\"\n          />\n        )}\n        {focusFilters.user && (\n          <FilterToggle\n            icon={ProfileIcon}\n            label={`By ${focusFilters.user.display}`}\n            description={`Show annotations by ${focusFilters.user.display}`}\n            active={focusActive.has('user')}\n            // When a selection exists, it replaces other filters.\n            disabled={hasSelection}\n            setActive={() => store.toggleFocusMode({ key: 'user' })}\n            testId=\"user-focus-toggle\"\n          />\n        )}\n        {focusFilters.page && (\n          <FilterToggle\n            icon={FileGenericIcon}\n            label={`Pages ${focusFilters.page.display}`}\n            description={`Show annotations on pages ${focusFilters.page.display}`}\n            active={focusActive.has('page')}\n            disabled={hasSelection}\n            setActive={() => store.toggleFocusMode({ key: 'page' })}\n            testId=\"page-focus-toggle\"\n          />\n        )}\n        {focusFilters.cfi && (\n          <FilterToggle\n            icon={FileGenericIcon}\n            label=\"Selected chapter\"\n            description=\"Show annotations on selected book chapter(s)\"\n            active={focusActive.has('cfi')}\n            disabled={hasSelection}\n            setActive={() => store.toggleFocusMode({ key: 'cfi' })}\n            testId=\"cfi-focus-toggle\"\n          />\n        )}\n      </div>\n    </Container>\n  );\n}\n","import classnames from 'classnames';\nimport { useEffect, useRef } from 'preact/hooks';\n\nimport { tabForAnnotation } from '../helpers/tabs';\nimport { withServices } from '../service-context';\nimport type { FrameSyncService } from '../services/frame-sync';\nimport type { LoadAnnotationsService } from '../services/load-annotations';\nimport type { StreamerService } from '../services/streamer';\nimport { useSidebarStore } from '../store';\nimport LoggedOutMessage from './LoggedOutMessage';\nimport LoginPromptPanel from './LoginPromptPanel';\nimport PendingUpdatesNotification from './PendingUpdatesNotification';\nimport SidebarContentError from './SidebarContentError';\nimport SidebarTabs from './SidebarTabs';\nimport FilterControls from './search/FilterControls';\n\nexport type SidebarViewProps = {\n  onLogin: () => void;\n  onSignUp: () => void;\n\n  // injected\n  frameSync: FrameSyncService;\n  loadAnnotationsService: LoadAnnotationsService;\n  streamer: StreamerService;\n};\n\n/**\n * Render the content of the sidebar, including tabs and threads (annotations)\n */\nfunction SidebarView({\n  frameSync,\n  onLogin,\n  onSignUp,\n  loadAnnotationsService,\n  streamer,\n}: SidebarViewProps) {\n  // Store state values\n  const store = useSidebarStore();\n  const focusedGroupId = store.focusedGroupId();\n  const isLoading = store.isLoading();\n  const isLoggedIn = store.isLoggedIn();\n\n  const linkedAnnotationId = store.directLinkedAnnotationId();\n  const linkedAnnotation = linkedAnnotationId\n    ? store.findAnnotationByID(linkedAnnotationId)\n    : undefined;\n  const directLinkedTab = linkedAnnotation\n    ? tabForAnnotation(linkedAnnotation)\n    : 'annotation';\n\n  const searchUris = store.searchUris();\n  const sidebarHasOpened = store.hasSidebarOpened();\n  const userId = store.profile().userid;\n\n  // If, after loading completes, no `linkedAnnotation` object is present when\n  // a `linkedAnnotationId` is set, that indicates an error\n  const hasDirectLinkedAnnotationError =\n    !isLoading && linkedAnnotationId ? !linkedAnnotation : false;\n\n  const hasDirectLinkedGroupError = store.directLinkedGroupFetchFailed();\n\n  const hasContentError =\n    hasDirectLinkedAnnotationError || hasDirectLinkedGroupError;\n\n  // Whether to render the new filter UI. Note that when the search panel is\n  // open, filter controls are integrated into it. The UI may render nothing\n  // if no filters are configured or selection is active.\n  const isSearchPanelOpen = store.isSidebarPanelOpen('searchAnnotations');\n  const showFilterControls = !hasContentError && !isSearchPanelOpen;\n\n  // Show a CTA to log in if successfully viewing a direct-linked annotation\n  // and not logged in\n  const showLoggedOutMessage =\n    linkedAnnotationId &&\n    !isLoggedIn &&\n    !hasDirectLinkedAnnotationError &&\n    !isLoading;\n\n  const prevGroupId = useRef(focusedGroupId);\n\n  // Reload annotations when group, user or document search URIs change\n  useEffect(() => {\n    if (!prevGroupId.current || prevGroupId.current !== focusedGroupId) {\n      // Clear any selected annotations and filters when the focused group\n      // changes.\n      // We don't clear the selection/filters on the initial load when\n      // the focused group transitions from null to non-null, as this would clear\n      // any filters intended to be used for the initial display (eg. to focus\n      // on a particular user).\n      if (prevGroupId.current) {\n        // Respect applied focus-mode filtering when changing focused group\n        const restoreFocus = store.focusState().active;\n\n        store.clearSelection();\n        if (restoreFocus) {\n          store.toggleFocusMode({ active: true });\n        }\n      }\n      prevGroupId.current = focusedGroupId;\n    }\n    if (focusedGroupId && searchUris.length) {\n      loadAnnotationsService.load({\n        groupId: focusedGroupId,\n        uris: searchUris,\n      });\n    }\n  }, [store, loadAnnotationsService, focusedGroupId, userId, searchUris]);\n\n  // When a `linkedAnnotationAnchorTag` becomes available, scroll to it\n  // and focus it\n  useEffect(() => {\n    if (linkedAnnotation && linkedAnnotation.$orphan === false) {\n      frameSync.hoverAnnotation(linkedAnnotation);\n      frameSync.scrollToAnnotation(linkedAnnotation);\n      store.selectTab(directLinkedTab);\n    } else if (linkedAnnotation) {\n      // Make sure to allow for orphaned annotations (which won't have an anchor)\n      store.selectTab(directLinkedTab);\n    }\n  }, [directLinkedTab, frameSync, linkedAnnotation, store]);\n\n  // Connect to the streamer when the sidebar has opened or if user is logged in\n  const hasFetchedProfile = store.hasFetchedProfile();\n  useEffect(() => {\n    if (hasFetchedProfile && (sidebarHasOpened || isLoggedIn)) {\n      streamer.connect({ applyUpdatesImmediately: false });\n    }\n  }, [hasFetchedProfile, isLoggedIn, sidebarHasOpened, streamer]);\n\n  return (\n    <div className=\"relative\">\n      <h2 className=\"sr-only\">Annotations</h2>\n      <div\n        className={classnames(\n          // z-10 ensures this appears over sidebar panels, which use the same\n          // z-index but render lower in the DOM\n          'fixed z-10',\n          // Setting 9px to the right instead of some standard tailwind size,\n          // so that it matches the padding of the sidebar's container.\n          // DEFAULT `.container` padding is defined in tailwind.conf.js\n          'right-[9px] top-12',\n        )}\n      >\n        <PendingUpdatesNotification />\n      </div>\n      {showFilterControls && <FilterControls withCardContainer />}\n      <LoginPromptPanel onLogin={onLogin} onSignUp={onSignUp} />\n      {hasDirectLinkedAnnotationError && (\n        <SidebarContentError\n          errorType=\"annotation\"\n          onLoginRequest={onLogin}\n          showClearSelection={true}\n        />\n      )}\n      {hasDirectLinkedGroupError && (\n        <SidebarContentError errorType=\"group\" onLoginRequest={onLogin} />\n      )}\n      {!hasContentError && <SidebarTabs isLoading={isLoading} />}\n      {showLoggedOutMessage && <LoggedOutMessage onLogin={onLogin} />}\n    </div>\n  );\n}\n\nexport default withServices(SidebarView, [\n  'frameSync',\n  'loadAnnotationsService',\n  'streamer',\n]);\n","import { useCallback, useEffect } from 'preact/hooks';\n\nimport { parseHypothesisSearchQuery } from '../helpers/query-parser';\nimport { withServices } from '../service-context';\nimport type { APIService } from '../services/api';\nimport type { ToastMessengerService } from '../services/toast-messenger';\nimport { useSidebarStore } from '../store';\nimport ThreadList from './ThreadList';\nimport { useRootThread } from './hooks/use-root-thread';\n\nexport type StreamViewProps = {\n  // injected\n  api: APIService;\n  toastMessenger: ToastMessengerService;\n};\n\n/**\n * The main content of the \"stream\" route (https://hypothes.is/stream)\n */\nfunction StreamView({ api, toastMessenger }: StreamViewProps) {\n  const store = useSidebarStore();\n  const currentQuery = store.routeParams().q;\n\n  /**\n   * Fetch annotations from the API and display them in the stream.\n   */\n  const loadAnnotations = useCallback(\n    async (query: string) => {\n      const queryParams = {\n        _separate_replies: true,\n\n        // nb. There is currently no way to load anything except the first\n        // 20 matching annotations in the UI.\n        offset: 0,\n        limit: 20,\n\n        ...parseHypothesisSearchQuery(query),\n      };\n      try {\n        store.annotationFetchStarted();\n        const results = await api.search(queryParams);\n        store.addAnnotations([...results.rows, ...results.replies]);\n      } finally {\n        store.annotationFetchFinished();\n      }\n    },\n    [api, store],\n  );\n\n  // Update the stream when this route is initially displayed and whenever\n  // the search query is updated.\n  useEffect(() => {\n    // Sort the stream so that the newest annotations are at the top\n    store.setSortKey('newest');\n    store.clearAnnotations();\n    loadAnnotations(currentQuery ?? '').catch(err => {\n      toastMessenger.error(`Unable to fetch annotations: ${err.message}`);\n    });\n  }, [currentQuery, loadAnnotations, store, toastMessenger]);\n\n  const { rootThread } = useRootThread();\n\n  return <ThreadList threads={rootThread.children} />;\n}\n\nexport default withServices(StreamView, ['api', 'toastMessenger']);\n","import { ToastMessages as BaseToastMessages } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nimport { withServices } from '../service-context';\nimport type { ToastMessengerService } from '../services/toast-messenger';\nimport { useSidebarStore } from '../store';\n\nexport type ToastMessageProps = {\n  // injected\n  toastMessenger: ToastMessengerService;\n};\n\n/**\n * Component that renders the active toast messages from the sidebar store\n */\nfunction ToastMessages({ toastMessenger }: ToastMessageProps) {\n  const store = useSidebarStore();\n  const messages = store.getToastMessages();\n\n  return (\n    <div\n      className={classnames(\n        // Ensure toast messages are rendered above other content\n        'z-10',\n        'absolute left-0 w-full',\n      )}\n    >\n      <BaseToastMessages\n        messages={messages}\n        onMessageDismiss={(id: string) => toastMessenger.dismiss(id)}\n        transitionClasses={{\n          transitionIn:\n            'motion-safe:animate-slide-in-from-right lg:animate-fade-in motion-reduce:animate-fade-in',\n        }}\n      />\n    </div>\n  );\n}\n\nexport default withServices(ToastMessages, ['toastMessenger']);\n","import type { Group } from '../../types/api';\n\nexport function orgName(group: Group): string {\n  return group.organization && group.organization.name;\n}\n","import type { Group, Organization } from '../../types/api';\nimport { immutable } from '../util/immutable';\n\ntype OrganizationWithGroups = Organization & { groups: Group[] };\n\n// TODO: Update when this is a property available on the API response\nconst DEFAULT_ORG_ID = '__default__';\n\n/**\n * Generate consistent object keys for organizations so that they\n * may be sorted\n */\nfunction orgKey(organization: Organization): string {\n  if (organization.id === DEFAULT_ORG_ID) {\n    return DEFAULT_ORG_ID;\n  }\n  return `${organization.name.toLowerCase()}${organization.id}`;\n}\n\n/**\n * Add a clone of the group object to the given organization object's\n * groups Array.\n */\nfunction addGroup(group: Group, organization: OrganizationWithGroups) {\n  // Object.assign won't suffice because of nested objects on groups\n  const groupObj = Object.assign({}, group);\n  const groupList = organization.groups;\n\n  if (!groupList.length && group.organization.logo) {\n    groupObj.logo = group.organization.logo;\n  }\n\n  groupList.push(immutable(groupObj));\n}\n\n/**\n * Iterate over groups and locate unique organizations. Slot groups into\n * their appropriate \"parent\" organizations.\n *\n * @return A collection of all unique organizations, containing their groups.\n *         Keyed by each org's \"orgKey\"\n */\nfunction organizations(\n  groups: Group[],\n): Record<string, OrganizationWithGroups> {\n  const orgs: Record<string, OrganizationWithGroups> = {};\n  groups.forEach(group => {\n    // Ignore groups with undefined or non-object organizations\n    if (typeof group.organization !== 'object') {\n      return;\n    }\n    const orgId = orgKey(group.organization);\n    if (typeof orgs[orgId] === 'undefined') {\n      // First time we've seen this org\n      orgs[orgId] = { ...group.organization, groups: [] };\n    }\n    addGroup(group, orgs[orgId]); // Add the current group to its organization's groups\n  });\n  return orgs;\n}\n\n/**\n * Take groups as returned from API service and sort them by which organization\n * they are in (all groups within a given organization will be contiguous\n * in the resulting Array).\n *\n * Groups with no organization or an unexpanded organization\n * will be omitted from the resulting Array.\n *\n * Organization ordering is by name, secondarily (pub)ID. Groups in the default\n * organization will appear at the end of the list. The first group\n * in each organization will have a logo property (if available on the\n * organization).\n *\n * @return groups sorted by which organization they're in\n */\nexport function groupsByOrganization(groups: Group[]): Group[] {\n  const orgs = organizations(groups);\n  const defaultOrganizationGroups: Group[] = [];\n  const sortedGroups = [];\n\n  const sortedOrgKeys = Object.keys(orgs).sort();\n  sortedOrgKeys.forEach(orgKey => {\n    if (orgKey === DEFAULT_ORG_ID) {\n      // Handle default groups separately\n      defaultOrganizationGroups.push(...orgs[orgKey].groups);\n    } else {\n      sortedGroups.push(...orgs[orgKey].groups);\n    }\n  });\n\n  if (defaultOrganizationGroups.length) {\n    // Put default groups at end\n    sortedGroups.push(...defaultOrganizationGroups);\n  }\n\n  return sortedGroups;\n}\n","import { toChildArray } from 'preact';\nimport type { ComponentChildren, VNode } from 'preact';\n\nexport type MenuSectionProps = {\n  /** Heading displayed at the top of the menu. */\n  heading?: string;\n\n  /** Menu items to display in this section. */\n  children: ComponentChildren;\n};\n\n/**\n * Group a set of menu items together visually, with an optional header.\n *\n * @example\n *   <Menu label=\"Things\">\n *     <MenuSection heading=\"Big things\">\n *       <MenuItem .../>\n *       <MenuItem .../>\n *     </MenuSection>\n *     <MenuSection heading=\"Little things\">\n *       <MenuItem .../>\n *       <MenuItem .../>\n *     </MenuSection>\n *   </Menu>\n *\n * @param {MenuSectionProps} props\n */\nexport default function MenuSection({ heading, children }: MenuSectionProps) {\n  return (\n    <>\n      {heading && (\n        <h2 className=\"text-color-text-light p-3 leading-none uppercase\">\n          {heading}\n        </h2>\n      )}\n      <ul className=\"border-b\">\n        {toChildArray(children).map(child => (\n          <li key={(child as VNode).key}>{child}</li>\n        ))}\n      </ul>\n    </>\n  );\n}\n","import {\n  confirm,\n  CopyIcon,\n  ExternalIcon,\n  GlobeIcon,\n  GlobeLockIcon,\n  LeaveIcon,\n  LockFilledIcon,\n} from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nimport type { Group, GroupType } from '../../../types/api';\nimport { orgName } from '../../helpers/group-list-item-common';\nimport { withServices } from '../../service-context';\nimport type { GroupsService } from '../../services/groups';\nimport type { ToastMessengerService } from '../../services/toast-messenger';\nimport { useSidebarStore } from '../../store';\nimport { copyPlainText } from '../../util/copy-to-clipboard';\nimport MenuItem from '../MenuItem';\n\nfunction GroupIcon({ type }: { type: GroupType }) {\n  const title =\n    type === 'open'\n      ? 'Public group'\n      : type === 'restricted'\n        ? 'Restricted group'\n        : 'Private group';\n\n  return (\n    <div\n      className=\"text-color-text-light\"\n      title={title}\n      data-testid=\"group-icon\"\n    >\n      {type === 'open' && <GlobeIcon />}\n      {type === 'restricted' && <GlobeLockIcon />}\n      {type === 'private' && <LockFilledIcon />}\n    </div>\n  );\n}\n\nexport type GroupListItemProps = {\n  group: Group;\n\n  /** Whether the submenu for this group is expanded. */\n  isExpanded?: boolean;\n\n  /** Callback invoked to expand or collapse the current group. */\n  onExpand: (expand: boolean) => void;\n\n  groups: GroupsService;\n  toastMessenger: ToastMessengerService;\n};\n\n/**\n * An item in the groups selection menu.\n *\n * The item has a primary action which selects the group, along with a set of\n * secondary actions accessible via a toggle menu.\n */\nfunction GroupListItem({\n  isExpanded,\n  group,\n  groups: groupsService,\n  onExpand,\n  toastMessenger,\n}: GroupListItemProps) {\n  const activityUrl = group.links.html;\n  const hasActionMenu = activityUrl || group.canLeave;\n  const isSelectable =\n    (group.scopes && !group.scopes.enforced) || group.isScopedToUri;\n\n  const store = useSidebarStore();\n  const focusedGroupId = store.focusedGroupId();\n  const isSelected = group.id === focusedGroupId;\n\n  const focusGroup = () => {\n    store.clearDirectLinkedGroupFetchFailed();\n    store.clearDirectLinkedIds();\n    groupsService.focus(group.id);\n  };\n\n  const leaveGroup = async () => {\n    const message = `Are you sure you want to leave the group \"${group.name}\"?`;\n    if (\n      await confirm({\n        title: 'Leave group?',\n        message,\n        confirmAction: 'Leave',\n      })\n    ) {\n      groupsService.leave(group.id);\n    }\n  };\n\n  const toggleSubmenu = (event: Event) => {\n    event.stopPropagation();\n\n    // Prevents group items opening a new window when clicked.\n    // TODO - Fix this more cleanly in `MenuItem`.\n    event.preventDefault();\n\n    onExpand(!isExpanded);\n  };\n\n  const copyLink = async (url: string) => {\n    try {\n      await copyPlainText(url);\n      toastMessenger.success(`Copied link for \"${group.name}\"`);\n    } catch {\n      toastMessenger.error('Unable to copy link');\n    }\n  };\n\n  const copyLinkLabel =\n    group.type === 'private' ? 'Copy invite link' : 'Copy activity link';\n\n  const leftChannelContent = group.logo ? (\n    <img className=\"w-4 h-4\" alt={orgName(group)} src={group.logo} />\n  ) : (\n    <span className=\"sr-only\">{orgName(group)}</span>\n  );\n\n  return (\n    <MenuItem\n      isDisabled={!isSelectable}\n      isExpanded={hasActionMenu ? isExpanded : false}\n      isSelected={isSelected}\n      isSubmenuVisible={hasActionMenu ? isExpanded : undefined}\n      label={\n        <div className=\"grow flex items-center justify-between gap-x-2\">\n          {group.name}\n          <GroupIcon type={group.type} />\n        </div>\n      }\n      leftChannelContent={leftChannelContent}\n      onClick={isSelectable ? focusGroup : toggleSubmenu}\n      onToggleSubmenu={toggleSubmenu}\n      submenuToggleTitle={`Show actions for ${group.name}`}\n      submenu={\n        <>\n          <ul>\n            {activityUrl && (\n              <li>\n                <MenuItem\n                  href={activityUrl}\n                  icon={ExternalIcon}\n                  isSubmenuItem={true}\n                  label=\"View group activity\"\n                />\n              </li>\n            )}\n            {activityUrl && (\n              <li>\n                <MenuItem\n                  onClick={() => copyLink(activityUrl)}\n                  icon={CopyIcon}\n                  isSubmenuItem={true}\n                  label={copyLinkLabel}\n                />\n              </li>\n            )}\n            {group.canLeave && (\n              <li>\n                <MenuItem\n                  icon={LeaveIcon}\n                  isSubmenuItem={true}\n                  label=\"Leave group\"\n                  onClick={leaveGroup}\n                />\n              </li>\n            )}\n          </ul>\n          {!isSelectable && (\n            <p\n              className={classnames(\n                // Left padding to match submenu items above. Turn off hyphenation\n                // as it causes this content to hyphenate awkwardly.\n                'p-2 pl-9 bg-grey-1 hyphens-none',\n              )}\n              data-testid=\"unselectable-group-note\"\n            >\n              This group is restricted to specific URLs.\n            </p>\n          )}\n        </>\n      }\n    />\n  );\n}\n\nexport default withServices(GroupListItem, ['groups', 'toastMessenger']);\n","import type { Group } from '../../../types/api';\nimport MenuSection from '../MenuSection';\nimport GroupListItem from './GroupListItem';\n\nexport type GroupListSectionProps = {\n  /** The group whose submenu is currently expanded. */\n  expandedGroup?: Group | null;\n\n  /** List of groups to be displayed in the section. */\n  groups: Group[];\n\n  /** Heading displayed at top of section. */\n  heading?: string;\n\n  /**\n   * Callback invoked when a group is expanded or collapsed.\n   *\n   * Set to either the group that is being expanded or `null` if the group given\n   * by {@link GroupListSectionProps.expandedGroup} is being collapsed.\n   */\n  onExpandGroup: (group: Group | null) => void;\n};\n\n/**\n * A labeled section of the groups list.\n */\nexport default function GroupListSection({\n  expandedGroup,\n  onExpandGroup,\n  groups,\n  heading,\n}: GroupListSectionProps) {\n  return (\n    <MenuSection heading={heading}>\n      {groups.map(group => (\n        <GroupListItem\n          key={group.id}\n          isExpanded={group === expandedGroup}\n          onExpand={expanded => onExpandGroup(expanded ? group : null)}\n          group={group}\n        />\n      ))}\n    </MenuSection>\n  );\n}\n","import { PlusIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useMemo, useState } from 'preact/hooks';\n\nimport type { Group } from '../../../types/api';\nimport type { SidebarSettings } from '../../../types/config';\nimport { serviceConfig } from '../../config/service-config';\nimport { isThirdPartyUser } from '../../helpers/account-id';\nimport { orgName } from '../../helpers/group-list-item-common';\nimport { groupsByOrganization } from '../../helpers/group-organizations';\nimport { isThirdPartyService } from '../../helpers/is-third-party-service';\nimport { withServices } from '../../service-context';\nimport { useSidebarStore } from '../../store';\nimport Menu from '../Menu';\nimport MenuItem from '../MenuItem';\nimport GroupListSection from './GroupListSection';\n\n/**\n * Return the custom icon for the top bar configured by the publisher in\n * the Hypothesis client configuration.\n */\nfunction publisherProvidedIcon(settings: SidebarSettings) {\n  const svc = serviceConfig(settings);\n  return svc && svc.icon ? svc.icon : null;\n}\n\nexport type GroupListProps = {\n  settings: SidebarSettings;\n};\n\n/**\n * Menu allowing the user to select which group to show and also access\n * additional actions related to groups.\n */\nfunction GroupList({ settings }: GroupListProps) {\n  const store = useSidebarStore();\n  const currentGroups = store.getCurrentlyViewingGroups();\n  const featuredGroups = store.getFeaturedGroups();\n  const myGroups = store.getMyGroups();\n  const focusedGroup = store.focusedGroup();\n  const userid = store.profile().userid;\n\n  // Prevent changing groups during an import\n  const disabled = store.importsPending() > 0;\n\n  const myGroupsSorted = useMemo(\n    () => groupsByOrganization(myGroups),\n    [myGroups],\n  );\n\n  const featuredGroupsSorted = useMemo(\n    () => groupsByOrganization(featuredGroups),\n    [featuredGroups],\n  );\n\n  const currentGroupsSorted = useMemo(\n    () => groupsByOrganization(currentGroups),\n    [currentGroups],\n  );\n\n  const defaultAuthority = store.defaultAuthority();\n  const canCreateNewGroup =\n    userid && !isThirdPartyUser(userid, defaultAuthority);\n  const newGroupLink = store.getLink('groups.new');\n\n  // The group whose submenu is currently open, or `null` if no group item is\n  // currently expanded.\n  //\n  // nb. If we create other menus that behave similarly in future, we may want\n  // to move this state to the `Menu` component.\n  const [expandedGroup, setExpandedGroup] = useState<Group | null>(null);\n\n  let label;\n  if (focusedGroup) {\n    const icon =\n      focusedGroup.organization.logo || publisherProvidedIcon(settings) || '';\n\n    // If org name is missing, then treat this icon like decoration\n    // and pass an empty string.\n    const altName = orgName(focusedGroup) ? orgName(focusedGroup) : '';\n    label = (\n      <span\n        className={classnames(\n          // Add some vertical padding so that the dropdown has some space\n          'py-1',\n        )}\n      >\n        <span\n          className={classnames(\n            // Don't allow this label to shrink (wrap to next line)\n            'shrink-0 flex items-center gap-x-1 text-md text-color-text font-bold',\n          )}\n        >\n          {icon && (\n            <img\n              className={classnames(\n                // Tiny adjustment to make H logo align better with group name\n                'relative top-[1px] w-4 h-4',\n              )}\n              src={icon}\n              alt={altName}\n            />\n          )}\n          {focusedGroup.name}\n        </span>\n      </span>\n    );\n  } else {\n    label = <span>…</span>;\n  }\n\n  // If there is only one group and no actions available for that group,\n  // just show the group name as a label.\n  const actionsAvailable = !isThirdPartyService(settings);\n  if (\n    !actionsAvailable &&\n    currentGroups.length + featuredGroups.length + myGroups.length < 2\n  ) {\n    return label;\n  }\n\n  const menuTitle = focusedGroup\n    ? `Select group (now viewing: ${focusedGroup.name})`\n    : 'Select group';\n\n  return (\n    <Menu\n      align=\"left\"\n      contentClass=\"min-w-[250px]\"\n      disabled={disabled}\n      label={label}\n      onOpenChanged={() => setExpandedGroup(null)}\n      title={menuTitle}\n    >\n      {currentGroupsSorted.length > 0 && (\n        <GroupListSection\n          expandedGroup={expandedGroup}\n          onExpandGroup={setExpandedGroup}\n          heading=\"Currently Viewing\"\n          groups={currentGroupsSorted}\n        />\n      )}\n      {featuredGroupsSorted.length > 0 && (\n        <GroupListSection\n          expandedGroup={expandedGroup}\n          onExpandGroup={setExpandedGroup}\n          heading=\"Featured Groups\"\n          groups={featuredGroupsSorted}\n        />\n      )}\n      {myGroupsSorted.length > 0 && (\n        <GroupListSection\n          expandedGroup={expandedGroup}\n          onExpandGroup={setExpandedGroup}\n          heading=\"My Groups\"\n          groups={myGroupsSorted}\n        />\n      )}\n\n      {canCreateNewGroup && (\n        <MenuItem\n          icon={PlusIcon}\n          href={newGroupLink}\n          label=\"Create new group\"\n        />\n      )}\n    </Menu>\n  );\n}\n\nexport default withServices(GroupList, ['settings']);\n","import { SortIcon } from '@hypothesis/frontend-shared';\n\nimport { useSidebarStore } from '../store';\nimport type { SortKey } from '../store/modules/selection';\nimport Menu from './Menu';\nimport MenuItem from './MenuItem';\n\nexport const itemLabels: Record<SortKey, string> = {\n  newest: 'Newest',\n  oldest: 'Oldest',\n  location: 'Location',\n};\n\n/**\n * A drop-down menu of sorting options for a collection of annotations.\n */\nexport default function SortMenu() {\n  const store = useSidebarStore();\n  // The currently-applied sort order\n  const sortKey = store.sortKey();\n  // All available sorting options. These change depending on current\n  // \"tab\" or context.\n  const sortKeysAvailable = store.sortKeys();\n\n  const menuItems = sortKeysAvailable.map(sortOption => {\n    return (\n      <MenuItem\n        key={sortOption}\n        label={itemLabels[sortOption]}\n        onClick={() => store.setSortKey(sortOption)}\n        isSelected={sortOption === sortKey}\n      />\n    );\n  });\n\n  const menuLabel = (\n    <span className=\"p-1\">\n      <SortIcon />\n    </span>\n  );\n\n  return (\n    <div data-component=\"SortMenu\">\n      <Menu\n        label={menuLabel}\n        title={`Sort by ${sortKey}`}\n        align=\"right\"\n        menuIndicator={false}\n      >\n        {menuItems}\n      </Menu>\n    </div>\n  );\n}\n","import type { IconButtonProps } from '@hypothesis/frontend-shared';\nimport { IconButton } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nexport type PressableIconButtonProps = IconButtonProps;\n\n/**\n * An IconButton which can be used as a toggle with a more visible pressed state.\n * Appropriate when the pressed state is not otherwise obvious from the context.\n */\nexport default function PressableIconButton({\n  classes,\n  ...rest\n}: PressableIconButtonProps) {\n  return (\n    <IconButton\n      {...rest}\n      classes={classnames(\n        classes,\n        'border border-transparent',\n        'aria-pressed:border-grey-3 aria-pressed:bg-grey-1',\n      )}\n    />\n  );\n}\n","import type { IconButtonProps } from '@hypothesis/frontend-shared';\n\nimport PressableIconButton from './PressableIconButton';\n\n/**\n * Toggle button for the top bar, with a background to indicate its \"pressed\"\n * state.\n */\nexport default function TopBarToggleButton(buttonProps: IconButtonProps) {\n  return (\n    <PressableIconButton\n      // The containing form has a white background. The top bar is only\n      // 40px high. If we allow standard touch-minimum height here (44px),\n      // the visible white background exceeds the height of the top bar in\n      // touch contexts. Disable touch sizing via `size=\"custom\"`, then\n      // add back the width rule and padding to keep horizontal spacing\n      // consistent.\n      size=\"custom\"\n      classes=\"touch:min-w-touch-minimum p-1\"\n      {...buttonProps}\n    />\n  );\n}\n","import { useCallback, useEffect, useState } from 'preact/hooks';\n\nimport { withServices } from '../service-context';\nimport type { DashboardService } from '../services/dashboard';\nimport type { ToastMessengerService } from '../services/toast-messenger';\nimport MenuItem from './MenuItem';\n\nexport type OpenDashboardMenuItemProps = {\n  isMenuOpen: boolean;\n\n  // Injected\n  dashboard: DashboardService;\n  toastMessenger: ToastMessengerService;\n};\n\nfunction OpenDashboardMenuItem({\n  dashboard,\n  isMenuOpen,\n  toastMessenger,\n}: OpenDashboardMenuItemProps) {\n  const [authTokenOrError, setAuthTokenOrError] = useState<string | Error>();\n  // Token is loading until we get it or an error occurs\n  const loading = !authTokenOrError;\n\n  const onClick = useCallback(() => {\n    if (typeof authTokenOrError === 'string') {\n      dashboard.open(authTokenOrError);\n      return;\n    }\n\n    if (authTokenOrError) {\n      toastMessenger.error(\"Can't open dashboard: You must reload the page.\", {\n        autoDismiss: false,\n      });\n    }\n  }, [authTokenOrError, dashboard, toastMessenger]);\n\n  useEffect(() => {\n    // Fetch a new auth token every time the menu containing this item is open,\n    // to make sure we always have an up-to-date one\n    if (isMenuOpen) {\n      dashboard\n        .getAuthToken()\n        .then(setAuthTokenOrError)\n        .catch(error => {\n          console.warn('An error occurred while getting auth token', error);\n          setAuthTokenOrError(error);\n        });\n    }\n\n    // Discard previous token and error, just before trying to fetch a new one\n    return () => setAuthTokenOrError(undefined);\n  }, [dashboard, isMenuOpen]);\n\n  return (\n    <MenuItem label=\"Open dashboard\" isDisabled={loading} onClick={onClick} />\n  );\n}\n\nexport default withServices(OpenDashboardMenuItem, [\n  'dashboard',\n  'toastMessenger',\n]);\n","import { ProfileIcon } from '@hypothesis/frontend-shared';\nimport { useState } from 'preact/hooks';\n\nimport type { Service, SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\nimport {\n  isThirdPartyUser,\n  username as getUsername,\n} from '../helpers/account-id';\nimport { withServices } from '../service-context';\nimport type { FrameSyncService } from '../services/frame-sync';\nimport { useSidebarStore } from '../store';\nimport Menu from './Menu';\nimport MenuItem from './MenuItem';\nimport MenuSection from './MenuSection';\nimport OpenDashboardMenuItem from './OpenDashboardMenuItem';\n\nexport type UserMenuProps = {\n  onLogout: () => void;\n\n  // Injected\n  frameSync: FrameSyncService;\n  settings: SidebarSettings;\n};\n\n/**\n * A menu with user and account links.\n *\n * This menu will contain different items depending on service configuration,\n * context and whether the user is first- or third-party.\n */\nfunction UserMenu({ frameSync, onLogout, settings }: UserMenuProps) {\n  const store = useSidebarStore();\n  const defaultAuthority = store.defaultAuthority();\n  const profile = store.profile();\n\n  const isThirdParty = isThirdPartyUser(profile.userid, defaultAuthority);\n  const service = serviceConfig(settings);\n  const username = getUsername(profile.userid);\n  const displayName = profile.user_info?.display_name ?? username;\n  const [isOpen, setOpen] = useState(false);\n\n  const serviceSupports = (feature: keyof Service) =>\n    service && !!service[feature];\n\n  const isSelectableProfile =\n    !isThirdParty || serviceSupports('onProfileRequestProvided');\n\n  // Is logging out generally possible for the current user?\n  const logoutAvailable =\n    !isThirdParty || serviceSupports('onLogoutRequestProvided');\n\n  // Is logging out possible right now?\n  const logoutDisabled = store.importsPending() > 0;\n\n  const isProfileEnabled = store.isFeatureEnabled('client_user_profile');\n\n  const onSelectNotebook = () => {\n    const groupId = store.focusedGroupId();\n    if (groupId) {\n      frameSync.notifyHost('openNotebook', groupId);\n    }\n  };\n  const onSelectProfile = () => frameSync.notifyHost('openProfile');\n\n  // Access to the Notebook:\n  // type the key 'n' when user menu is focused/open\n  const onKeyDown = (event: KeyboardEvent) => {\n    if (event.key === 'n') {\n      onSelectNotebook();\n      setOpen(false);\n    } else if (isProfileEnabled && event.key === 'p') {\n      onSelectProfile();\n      setOpen(false);\n    }\n  };\n\n  const onProfileSelected = () =>\n    isThirdParty && frameSync.notifyHost('profileRequested');\n  const profileHref =\n    isSelectableProfile && !isThirdParty\n      ? store.getLink('user', { user: username })\n      : undefined;\n\n  const menuLabel = (\n    <span className=\"p-1\">\n      <ProfileIcon />\n    </span>\n  );\n  return (\n    // Allow keyboard shortcut 'n' to open Notebook\n    /* eslint-disable-next-line jsx-a11y/no-static-element-interactions */\n    <div data-testid=\"user-menu\" onKeyDown={onKeyDown}>\n      <Menu\n        label={menuLabel}\n        title={displayName}\n        align=\"right\"\n        open={isOpen}\n        onOpenChanged={setOpen}\n      >\n        <MenuSection>\n          <MenuItem\n            label={displayName}\n            isDisabled={!isSelectableProfile}\n            href={profileHref}\n            onClick={isSelectableProfile ? onProfileSelected : undefined}\n          />\n          {!isThirdParty && (\n            <MenuItem\n              label=\"Account settings\"\n              href={store.getLink('account.settings')}\n            />\n          )}\n          {isProfileEnabled && (\n            <MenuItem label=\"Your profile\" onClick={() => onSelectProfile()} />\n          )}\n          <MenuItem label=\"Open notebook\" onClick={() => onSelectNotebook()} />\n        </MenuSection>\n        {settings.dashboard?.showEntryPoint && (\n          <MenuSection>\n            <OpenDashboardMenuItem isMenuOpen={isOpen} />\n          </MenuSection>\n        )}\n        {logoutAvailable && (\n          <MenuSection>\n            <MenuItem\n              isDisabled={logoutDisabled}\n              label=\"Log out\"\n              onClick={onLogout}\n            />\n          </MenuSection>\n        )}\n      </Menu>\n    </div>\n  );\n}\n\nexport default withServices(UserMenu, ['frameSync', 'settings']);\n","import { SearchIcon, Spinner } from '@hypothesis/frontend-shared';\nimport { useCallback, useRef } from 'preact/hooks';\n\nimport { useShortcut } from '../../../shared/shortcut';\nimport { isMacOS } from '../../../shared/user-agent';\nimport type { SidebarStore } from '../../store';\nimport { useSidebarStore } from '../../store';\nimport TopBarToggleButton from '../TopBarToggleButton';\n\n/**\n * Respond to keydown events on the document (shortcut keys):\n *\n * - Open the search panel when the user presses '/', unless the user is\n *   currently typing in or focused on an input field.\n * - Open the search panel when the user presses CMD-K (MacOS) or CTRL-K\n *   (everyone else)\n */\nfunction useSearchKeyboardShortcuts(store: SidebarStore) {\n  const prevFocusRef = useRef<HTMLOrSVGElement | null>(null);\n\n  const openSearch = useCallback(\n    (event: KeyboardEvent) => {\n      // When user is in an input field, respond to CMD-/CTRL-K keypresses,\n      // but ignore '/' keypresses\n      if (\n        !event.metaKey &&\n        !event.ctrlKey &&\n        event.target instanceof HTMLElement &&\n        ['INPUT', 'TEXTAREA'].includes(event.target.tagName)\n      ) {\n        return;\n      }\n      prevFocusRef.current = document.activeElement as HTMLOrSVGElement | null;\n      if (!store.isSidebarPanelOpen('searchAnnotations')) {\n        store.openSidebarPanel('searchAnnotations');\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    },\n    [store],\n  );\n\n  const modifierKey = isMacOS() ? 'meta' : 'ctrl';\n\n  useShortcut('/', openSearch);\n  useShortcut(`${modifierKey}+k`, openSearch);\n}\n\nexport default function SearchIconButton() {\n  const store = useSidebarStore();\n  const isLoading = store.isLoading();\n  const isSearchPanelOpen = store.isSidebarPanelOpen('searchAnnotations');\n\n  const toggleSearchPanel = useCallback(() => {\n    store.toggleSidebarPanel('searchAnnotations');\n  }, [store]);\n\n  useSearchKeyboardShortcuts(store);\n\n  return (\n    <>\n      {isLoading && <Spinner />}\n      {!isLoading && (\n        <TopBarToggleButton\n          icon={SearchIcon}\n          expanded={isSearchPanelOpen}\n          pressed={isSearchPanelOpen}\n          onClick={toggleSearchPanel}\n          title=\"Search annotations\"\n        />\n      )}\n    </>\n  );\n}\n","import {\n  CancelIcon,\n  IconButton,\n  Input,\n  SearchIcon,\n  useSyncedRef,\n} from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport type { RefObject, JSX } from 'preact';\nimport { useState } from 'preact/hooks';\n\nimport { useShortcut } from '../../../shared/shortcut';\nimport { useSidebarStore } from '../../store';\n\nexport type SearchFieldProps = {\n  /** The currently-active filter query */\n  query: string | null;\n\n  onClearSearch: () => void;\n\n  /** Disable input editing or submitting the search field. */\n  disabled?: boolean;\n\n  /** Callback for when the current filter query changes */\n  onSearch: (value: string) => void;\n\n  /** Callback for when a key is pressed in the input itself */\n  onKeyDown?: JSX.KeyboardEventHandler<HTMLInputElement>;\n\n  /** The input's ref object, in case it needs to be handled by consumers */\n  inputRef?: RefObject<HTMLInputElement | undefined>;\n\n  /** Classes to be added to the outermost element */\n  classes?: string | string[];\n};\n\n/**\n * An input field for entering a query that filters annotations (in the sidebar)\n * or searches annotations (in the stream/single annotation view).\n */\nexport default function SearchField({\n  classes,\n  disabled = false,\n  inputRef,\n  onClearSearch,\n  onKeyDown,\n  onSearch,\n  query,\n}: SearchFieldProps) {\n  const store = useSidebarStore();\n  const isLoading = store.isLoading();\n  const input = useSyncedRef(inputRef);\n\n  // The active filter query from the previous render.\n  const [prevQuery, setPrevQuery] = useState(query);\n\n  // The query that the user is currently typing, but may not yet have applied.\n  const [pendingQuery, setPendingQuery] = useState(query);\n\n  // As long as this input is mounted, pressing `/` should make it recover focus\n  useShortcut('/', e => {\n    if (document.activeElement !== input.current) {\n      e.preventDefault();\n      input.current?.focus();\n    }\n  });\n\n  const onSubmit = (e: Event) => {\n    e.preventDefault();\n    if (input.current?.value || prevQuery) {\n      // Don't set an initial empty query, but allow a later empty query to\n      // clear `prevQuery`\n      onSearch(input.current?.value ?? '');\n    }\n  };\n  // When the active query changes outside of this component, update the input\n  // field to match. This happens when clearing the current filter for example.\n  if (query !== prevQuery) {\n    setPendingQuery(query);\n    setPrevQuery(query);\n  }\n\n  return (\n    <form\n      name=\"searchForm\"\n      onSubmit={onSubmit}\n      className={classnames('space-y-3', classes)}\n    >\n      <div className=\"relative\">\n        <IconButton\n          // Vertically center icon on left side of input. Increase the text\n          // size to make the icon the same size as the top bar icons.\n          classes=\"absolute left-0 text-[16px] top-[50%] translate-y-[-50%]\"\n          icon={SearchIcon}\n          size=\"lg\"\n          title=\"Search\"\n          type=\"submit\"\n          disabled={disabled}\n        />\n        <Input\n          aria-label=\"Search annotations\"\n          classes={classnames(\n            'pl-8 pr-8', // Add padding so input does not overlap search/clear buttons.\n            'disabled:text-grey-6', // Dim text when input is disabled\n            'text-base touch:text-touch-base', // Larger font on touch devices\n          )}\n          data-testid=\"search-input\"\n          dir=\"auto\"\n          name=\"query\"\n          placeholder={(isLoading && 'Loading…') || 'Search annotations…'}\n          disabled={disabled || isLoading}\n          elementRef={input}\n          value={pendingQuery || ''}\n          onInput={(e: Event) =>\n            setPendingQuery((e.target as HTMLInputElement).value)\n          }\n          onKeyDown={onKeyDown}\n        />\n        {pendingQuery && (\n          <IconButton\n            classes=\"absolute right-0 text-[16px] top-[50%] translate-y-[-50%]\"\n            size=\"lg\"\n            icon={CancelIcon}\n            data-testid=\"clear-button\"\n            title=\"Clear search\"\n            onClick={onClearSearch}\n            disabled={disabled}\n          />\n        )}\n      </div>\n    </form>\n  );\n}\n","import { withServices } from '../../service-context';\nimport type { RouterService } from '../../services/router';\nimport { useSidebarStore } from '../../store';\nimport SearchField from './SearchField';\n\nexport type StreamSearchInputProps = {\n  router: RouterService;\n};\n\n/**\n * Search input for the single annotation view and stream.\n *\n * This displays and updates the \"q\" query param in the URL.\n */\nfunction StreamSearchInput({ router }: StreamSearchInputProps) {\n  const store = useSidebarStore();\n  const { q } = store.routeParams();\n  const setQuery = (query: string) => {\n    // Re-route the user to `/stream` if they are on `/a/:id` and then set\n    // the search query.\n    router.navigate('stream', { q: query });\n  };\n\n  return (\n    <SearchField\n      query={q ?? ''}\n      onSearch={setQuery}\n      onClearSearch={() => setQuery('')}\n    />\n  );\n}\n\nexport default withServices(StreamSearchInput, ['router']);\n","import { LinkButton, HelpIcon, ShareIcon } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nimport type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\nimport { applyTheme } from '../helpers/theme';\nimport { withServices } from '../service-context';\nimport type { FrameSyncService } from '../services/frame-sync';\nimport { useSidebarStore } from '../store';\nimport GroupList from './GroupList';\nimport SortMenu from './SortMenu';\nimport TopBarToggleButton from './TopBarToggleButton';\nimport UserMenu from './UserMenu';\nimport SearchIconButton from './search/SearchIconButton';\nimport StreamSearchInput from './search/StreamSearchInput';\n\nexport type TopBarProps = {\n  /** Flag indicating whether the app is in a sidebar context */\n  isSidebar: boolean;\n\n  /** Callback invoked when user clicks \"Login\" button */\n  onLogin: () => void;\n\n  /** Callback invoked when user clicks \"Logout\" action in account menu */\n  onLogout: () => void;\n\n  /** Callback invoked when user clicks \"Sign up\" button */\n  onSignUp: () => void;\n\n  // injected\n  frameSync: FrameSyncService;\n  settings: SidebarSettings;\n};\n\ntype ControlName = 'share' | 'account' | 'help';\n\nfunction controlEnabled(settings: SidebarSettings, name: ControlName) {\n  const config = serviceConfig(settings);\n  if (!config) {\n    return true;\n  }\n  switch (name) {\n    case 'share':\n      return config.enableShareImportExportPanel ?? true;\n    case 'account':\n      return config.enableAccountMenu ?? true;\n    case 'help':\n      return config.enableHelpPanel ?? true;\n    /* istanbul ignore next: unused default */\n    default:\n      return true;\n  }\n}\n\n/**\n * The toolbar which appears at the top of the sidebar providing actions\n * to switch groups, view account information, sort/filter annotations etc.\n */\nfunction TopBar({\n  isSidebar,\n  onLogin,\n  onLogout,\n  onSignUp,\n  frameSync,\n  settings,\n}: TopBarProps) {\n  const loginLinkStyle = applyTheme(['accentColor'], settings);\n\n  const store = useSidebarStore();\n  const isLoggedIn = store.isLoggedIn();\n  const hasFetchedProfile = store.hasFetchedProfile();\n\n  const toggleSharePanel = () => {\n    store.toggleSidebarPanel('shareGroupAnnotations');\n  };\n\n  const isHelpPanelOpen = store.isSidebarPanelOpen('help');\n  const isAnnotationsPanelOpen = store.isSidebarPanelOpen(\n    'shareGroupAnnotations',\n  );\n\n  /**\n   * Open the help panel, or, if a service callback is configured to handle\n   * help requests, fire a relevant event instead\n   */\n  const requestHelp = () => {\n    const service = serviceConfig(settings);\n    if (service && service.onHelpRequestProvided) {\n      frameSync.notifyHost('helpRequested');\n    } else {\n      store.toggleSidebarPanel('help');\n    }\n  };\n\n  return (\n    <div\n      className={classnames(\n        'absolute h-10 left-0 top-0 right-0 z-4',\n        'text-grey-7 border-b theme-clean:border-b-0 bg-white',\n      )}\n      data-testid=\"top-bar\"\n    >\n      <div\n        className={classnames(\n          'container flex items-center h-full',\n          // Text sizing will size icons in buttons correctly\n          'text-[16px]',\n        )}\n        data-testid=\"top-bar-content\"\n      >\n        {isSidebar ? <GroupList /> : <StreamSearchInput />}\n        <div className=\"grow flex items-center justify-end\">\n          {isSidebar && (\n            <>\n              <SearchIconButton />\n              <SortMenu />\n              {controlEnabled(settings, 'share') && (\n                <TopBarToggleButton\n                  icon={ShareIcon}\n                  expanded={isAnnotationsPanelOpen}\n                  pressed={isAnnotationsPanelOpen}\n                  onClick={toggleSharePanel}\n                  title=\"Share annotations on this page\"\n                  data-testid=\"share-icon-button\"\n                />\n              )}\n            </>\n          )}\n          {controlEnabled(settings, 'help') && (\n            <TopBarToggleButton\n              icon={HelpIcon}\n              expanded={isHelpPanelOpen}\n              pressed={isHelpPanelOpen}\n              onClick={requestHelp}\n              title=\"Help\"\n              data-testid=\"help-icon-button\"\n            />\n          )}\n          {isLoggedIn ? (\n            controlEnabled(settings, 'account') && (\n              <UserMenu onLogout={onLogout} />\n            )\n          ) : (\n            <div\n              className=\"flex items-center text-md font-medium space-x-1 pl-1\"\n              data-testid=\"login-links\"\n            >\n              {!isLoggedIn && !hasFetchedProfile && <span>⋯</span>}\n              {!isLoggedIn && hasFetchedProfile && (\n                <>\n                  <LinkButton\n                    classes=\"inline\"\n                    onClick={onSignUp}\n                    style={loginLinkStyle}\n                    underline=\"none\"\n                  >\n                    Sign up\n                  </LinkButton>\n                  <div>/</div>\n                  <LinkButton\n                    classes=\"inline\"\n                    onClick={onLogin}\n                    style={loginLinkStyle}\n                    underline=\"none\"\n                  >\n                    Log in\n                  </LinkButton>\n                </>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default withServices(TopBar, ['frameSync', 'settings']);\n","import { Card, CardContent } from '@hypothesis/frontend-shared';\nimport { useRef } from 'preact/hooks';\n\nimport { useSidebarStore } from '../../store';\nimport SidebarPanel from '../SidebarPanel';\nimport FilterControls from './FilterControls';\nimport SearchField from './SearchField';\n\nexport default function SearchPanel() {\n  const store = useSidebarStore();\n  const filterQuery = store.filterQuery();\n  const inputRef = useRef<HTMLInputElement | null>(null);\n  const hasSelection = store.hasSelectedAnnotations();\n\n  const clearSearch = () => {\n    store.closeSidebarPanel('searchAnnotations');\n  };\n\n  return (\n    <SidebarPanel\n      panelName=\"searchAnnotations\"\n      variant=\"custom\"\n      title=\"Search annotations\"\n      initialFocus={inputRef}\n      onActiveChanged={active => {\n        if (!active) {\n          store.setFilterQuery(null);\n        }\n      }}\n    >\n      <Card>\n        <CardContent>\n          <div className=\"flex gap-x-3\">\n            <SearchField\n              inputRef={inputRef}\n              classes=\"grow\"\n              // Disable the input when there is a selection, as the selection\n              // replaces any other filters.\n              disabled={hasSelection}\n              query={filterQuery || null}\n              onClearSearch={clearSearch}\n              onSearch={store.setFilterQuery}\n              onKeyDown={e => {\n                if (e.key === 'Escape') {\n                  clearSearch();\n                }\n              }}\n            />\n          </div>\n          <FilterControls />\n        </CardContent>\n      </Card>\n    </SidebarPanel>\n  );\n}\n","import { confirm } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\nimport { useEffect, useMemo } from 'preact/hooks';\n\nimport type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\nimport { isThirdPartyService } from '../helpers/is-third-party-service';\nimport { shouldAutoDisplayTutorial } from '../helpers/session';\nimport { applyTheme } from '../helpers/theme';\nimport { withServices } from '../service-context';\nimport type { AuthService } from '../services/auth';\nimport type { FrameSyncService } from '../services/frame-sync';\nimport type { SessionService } from '../services/session';\nimport type { ToastMessengerService } from '../services/toast-messenger';\nimport { useSidebarStore } from '../store';\nimport AnnotationView from './AnnotationView';\nimport HelpPanel from './HelpPanel';\nimport NotebookView from './NotebookView';\nimport ProfileView from './ProfileView';\nimport ShareDialog from './ShareDialog';\nimport SidebarView from './SidebarView';\nimport StreamView from './StreamView';\nimport ToastMessages from './ToastMessages';\nimport TopBar from './TopBar';\nimport SearchPanel from './search/SearchPanel';\n\nexport type HypothesisAppProps = {\n  auth: AuthService;\n  frameSync: FrameSyncService;\n  settings: SidebarSettings;\n  session: SessionService;\n  toastMessenger: ToastMessengerService;\n};\n\n/**\n * The root component for the Hypothesis client.\n *\n * This handles login/logout actions and renders the top navigation bar\n * and content appropriate for the current route.\n */\nfunction HypothesisApp({\n  auth,\n  frameSync,\n  settings,\n  session,\n  toastMessenger,\n}: HypothesisAppProps) {\n  const store = useSidebarStore();\n  const profile = store.profile();\n  const route = store.route();\n  const isModalRoute = route === 'notebook' || route === 'profile';\n\n  const backgroundStyle = useMemo(\n    () => applyTheme(['appBackgroundColor'], settings),\n    [settings],\n  );\n  const isThemeClean = settings.theme === 'clean';\n\n  const isSidebar = route === 'sidebar';\n\n  useEffect(() => {\n    if (shouldAutoDisplayTutorial(isSidebar, profile, settings)) {\n      store.openSidebarPanel('help');\n    }\n  }, [isSidebar, profile, settings, store]);\n\n  const isThirdParty = isThirdPartyService(settings);\n\n  const login = async () => {\n    if (serviceConfig(settings)) {\n      // Let the host page handle the login request\n      frameSync.notifyHost('loginRequested');\n      return;\n    }\n\n    try {\n      await auth.login();\n\n      store.closeSidebarPanel('loginPrompt');\n      store.clearGroups();\n      session.reload();\n    } catch (err) {\n      toastMessenger.error(err.message);\n    }\n  };\n\n  const signUp = () => {\n    if (serviceConfig(settings)) {\n      // Let the host page handle the signup request\n      frameSync.notifyHost('signupRequested');\n      return;\n    }\n    window.open(store.getLink('signup'));\n  };\n\n  const promptToLogout = async () => {\n    const drafts = store.countDrafts();\n    if (drafts === 0) {\n      return true;\n    }\n\n    let message = '';\n    if (drafts === 1) {\n      message =\n        'You have an unsaved annotation.\\n' +\n        'Do you really want to discard this draft?';\n    } else if (drafts > 1) {\n      message =\n        'You have ' +\n        drafts +\n        ' unsaved annotations.\\n' +\n        'Do you really want to discard these drafts?';\n    }\n    return confirm({\n      title: 'Discard drafts?',\n      message,\n      confirmAction: 'Discard',\n    });\n  };\n\n  const logout = async () => {\n    if (!(await promptToLogout())) {\n      return;\n    }\n    store.clearGroups();\n    store.removeAnnotations(store.unsavedAnnotations());\n    store.discardAllDrafts();\n\n    if (serviceConfig(settings)) {\n      frameSync.notifyHost('logoutRequested');\n      return;\n    }\n\n    session.logout();\n  };\n\n  return (\n    <div\n      className={classnames(\n        'h-full min-h-full overflow-auto',\n        // Precise padding to align with annotation cards in content\n        // Larger padding on bottom for wide screens\n        'lg:pb-16 bg-grey-2',\n        'js-thread-list-scroll-root',\n        {\n          'theme-clean': isThemeClean,\n          // Make room at top for the TopBar (40px) plus custom padding (9px)\n          // but not in the Notebook or Profile, which don't use the TopBar\n          'pt-[49px]': !isModalRoute,\n          'p-4 lg:p-12': isModalRoute,\n        },\n      )}\n      data-testid=\"hypothesis-app\"\n      style={backgroundStyle}\n    >\n      {!isModalRoute && (\n        <TopBar\n          onLogin={login}\n          onSignUp={signUp}\n          onLogout={logout}\n          isSidebar={isSidebar}\n        />\n      )}\n      <div className=\"container\">\n        <ToastMessages />\n        <HelpPanel />\n        <SearchPanel />\n        <ShareDialog shareTab={!isThirdParty} />\n\n        {route && (\n          <main>\n            {route === 'annotation' && <AnnotationView onLogin={login} />}\n            {route === 'notebook' && <NotebookView />}\n            {route === 'profile' && <ProfileView />}\n            {route === 'stream' && <StreamView />}\n            {route === 'sidebar' && (\n              <SidebarView onLogin={login} onSignUp={signUp} />\n            )}\n          </main>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default withServices(HypothesisApp, [\n  'auth',\n  'frameSync',\n  'session',\n  'settings',\n  'toastMessenger',\n]);\n","import type { Profile } from '../../types/api';\nimport type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\n\n/**\n * The following things must all be true for the tutorial component to auto-display\n * on app launch:\n * - The app must be operating within the \"sidebar\" (i.e. not single-annotation\n *   or stream mode); AND\n * - No configuration is present in `settings.services` indicating\n *   that the host wants to handle its own help requests (i.e. no event handler\n *   is provided to intercept the default help panel), AND\n * - A user profile is loaded in the current state that indicates a `true` value\n *   for the `show_sidebar_tutorial` preference (i.e. the tutorial has not been\n *   dismissed by this user yet). This implies the presence of a profile, which\n *   in turn implies that there is an authenticated user.\n *\n * @param isSidebar - is the app currently displayed in a sidebar?\n * @param profile - User profile returned from the API\n * @return Tutorial panel should be displayed automatically\n */\nexport function shouldAutoDisplayTutorial(\n  isSidebar: boolean,\n  profile: Profile,\n  settings: SidebarSettings,\n): boolean {\n  if (!isSidebar) {\n    return false;\n  }\n\n  const shouldShowBasedOnProfile =\n    typeof profile.preferences === 'object' &&\n    !!profile.preferences.show_sidebar_tutorial;\n  if (!shouldShowBasedOnProfile) {\n    return false;\n  }\n\n  const config = serviceConfig(settings);\n  if (config?.onHelpRequestProvided || config?.enableHelpPanel === false) {\n    return false;\n  }\n\n  return true;\n}\n","import { Panel } from '@hypothesis/frontend-shared';\nimport classnames from 'classnames';\n\nexport type LaunchErrorPanelProps = {\n  /** The error that prevented the client from launching */\n  error: Error;\n};\n/**\n * An error panel displayed when a fatal error occurs during app startup.\n *\n * Note that this component cannot use any of the services or store that are\n * normally available to UI components in the client.\n */\nexport default function LaunchErrorPanel({ error }: LaunchErrorPanelProps) {\n  return (\n    <div\n      className={classnames(\n        // The large top-margin is to ensure the panel clears the close button\n        // in the Notebook\n        'm-2 mt-12',\n      )}\n    >\n      <Panel title=\"Unable to start Hypothesis\">{error.message}</Panel>\n    </div>\n  );\n}\n","function byteToHex(val: number): string {\n  const str = val.toString(16);\n  return str.length === 1 ? '0' + str : str;\n}\n\n/**\n * Generate a random hex string of `len` chars.\n *\n * @param len - An even-numbered length string to generate.\n */\nexport function generateHexString(len: number): string {\n  const bytes = new Uint8Array(len / 2);\n  window.crypto.getRandomValues(bytes);\n  return Array.from(bytes).map(byteToHex).join('');\n}\n","import { generateHexString } from '../../shared/random';\n\n/**\n * Return a Promise that rejects with an error after `delay` ms.\n */\nfunction createTimeout(delay: number, message: string) {\n  return new Promise((_, reject) => {\n    setTimeout(() => reject(new Error(message)), delay);\n  });\n}\n\n/**\n * Make a JSON-RPC call to a server in another frame using `postMessage`.\n *\n * @param frame - Frame to send call to\n * @param origin - Origin filter for `window.postMessage` call\n * @param method - Name of the JSON-RPC method\n * @param params - Parameters of the JSON-RPC method\n * @param timeout - Maximum time to wait in ms\n * @param window_ - Test seam.\n * @return A Promise for the response to the call\n */\nexport function call<T>(\n  frame: Window,\n  origin: string,\n  method: string,\n  /* istanbul ignore next */\n  params: unknown[] = [],\n  /* istanbul ignore next */\n  timeout = 2000,\n  /* istanbul ignore next */\n  window_: Window = window,\n): Promise<T> {\n  const id = generateHexString(10);\n\n  // Send RPC request.\n  const request = {\n    jsonrpc: '2.0',\n    method,\n    params,\n    id,\n  };\n\n  try {\n    frame.postMessage(request, origin);\n  } catch (err) {\n    return Promise.reject(err);\n  }\n\n  // Await response or timeout.\n  let listener: (e: MessageEvent) => void;\n  const response = new Promise((resolve, reject) => {\n    listener = event => {\n      if (event.origin !== origin) {\n        // Not from the frame that we sent the request to.\n        return;\n      }\n\n      if (\n        !(event.data instanceof Object) ||\n        event.data.jsonrpc !== '2.0' ||\n        event.data.id !== id\n      ) {\n        // Not a valid JSON-RPC response.\n        return;\n      }\n\n      const { error, result } = event.data;\n      if (error !== undefined) {\n        reject(error);\n      } else if (result !== undefined) {\n        resolve(result);\n      } else {\n        reject(new Error('RPC reply had no result or error'));\n      }\n    };\n    window_.addEventListener('message', listener);\n  });\n\n  const responseOrTimeout = [response];\n  if (timeout) {\n    responseOrTimeout.push(\n      createTimeout(timeout, `Request to ${origin} timed out`),\n    );\n  }\n\n  // Cleanup and return.\n  // FIXME: If we added a `Promise.finally` polyfill we could simplify this.\n  return Promise.race(responseOrTimeout)\n    .then(result => {\n      window_.removeEventListener('message', listener);\n      return result as T;\n    })\n    .catch(err => {\n      window_.removeEventListener('message', listener);\n      throw err;\n    });\n}\n\n/**\n * Send a JSON-RPC 2.0 notification request to another frame via `postMessage`.\n * No response is expected.\n *\n * @param frame - Frame to send call to\n * @param origin - Origin filter for `window.postMessage` call\n * @param method - Name of the JSON-RPC method\n * @param params - Parameters of the JSON-RPC method\n */\nexport function notify(\n  frame: Window,\n  origin: string,\n  method: string,\n  /* istanbul ignore next */\n  params: unknown[] = [],\n) {\n  const request = {\n    jsonrpc: '2.0',\n    method,\n    params,\n  };\n  frame.postMessage(request, origin);\n}\n","/**\n * Encode app configuration in a URL fragment.\n *\n * This is used by the annotator to pass configuration to the sidebar and\n * notebook apps, which they can easily read on startup. The configuration is\n * passed in the fragment to avoid invalidating cache entries for the URL\n * or adding noise to server logs.\n *\n * @return URL with added fragment\n */\nexport function addConfigFragment(baseURL: string, config: object): string {\n  const url = new URL(baseURL);\n  const params = new URLSearchParams();\n  params.append('config', JSON.stringify(config));\n  url.hash = params.toString();\n  return url.toString();\n}\n\n/**\n * Parse configuration from a URL generated by {@link addConfigFragment}.\n */\nexport function parseConfigFragment(url: string): Record<string, unknown> {\n  const configStr = new URL(url).hash.slice(1);\n  const configJSON = new URLSearchParams(configStr).get('config');\n  return JSON.parse(configJSON || '{}');\n}\n","/**\n * Type conversion methods that coerce incoming configuration values to an\n * expected type or format that other parts of the UI may make assumptions\n * on. This is needed for incoming configuration values that are otherwise\n * not sanitized.\n *\n * Note that if the values passed are plain javascript values (such as ones\n * produced from JSON.parse), then these methods do not throw errors.\n */\nimport type { Ref } from 'preact';\n\nexport function toBoolean(value: any): boolean {\n  if (typeof value === 'string') {\n    if (value.trim().toLocaleLowerCase() === 'false') {\n      // \"false\", \"False\", \" false\", \"FALSE\" all return false\n      return false;\n    }\n  }\n  const numericalVal = Number(value);\n  if (!isNaN(numericalVal)) {\n    return Boolean(numericalVal);\n  }\n  // Any non-numerical or falsely string should return true, otherwise return false\n  return typeof value === 'string';\n}\n\n/**\n * Returns either an integer or NaN\n */\nexport function toInteger(value: any): number {\n  // Acts as a simple wrapper\n  return parseInt(value);\n}\n\n/**\n * Returns either the value if it's an object or an empty object\n */\nexport function toObject(value: any): object {\n  if (typeof value === 'object' && value !== null) {\n    return value;\n  }\n  // Don't attempt to fix the values, just ensure type correctness\n  return {};\n}\n\n/**\n * Returns the value as a string or an empty string if the\n * value undefined, null or otherwise falsely.\n */\nexport function toString(value: any): string {\n  if (value && typeof value.toString === 'function') {\n    return value.toString();\n  }\n  return '';\n}\n\n/**\n * Helper for downcasting a ref to a more specific type, where that is safe\n * to do.\n *\n * This is mainly useful to cast a generic `Ref<HTMLElement>` to a more specific\n * element type (eg. `Ref<HTMLDivElement>`) for use with the `ref` prop of a JSX element.\n * Since Preact only writes to the `ref` prop, such a cast is safe.\n *\n * @fixme Ignoring from code coverage, as this function is currently not used\n */\n/* istanbul ignore next */\nexport function downcastRef<T, U>(ref: Ref<T> | undefined): Ref<U> | undefined {\n  return ref as Ref<U> | undefined;\n}\n","import type {\n  ConfigFromHost,\n  ConfigFromAnnotator,\n  ConfigFromEmbedder,\n  ConfigFromSidebar,\n  RPCSettings,\n  SidebarSettings,\n} from '../../types/config';\nimport * as postMessageJsonRpc from '../util/postmessage-json-rpc';\nimport { getApiUrl } from './get-api-url';\nimport { hostPageConfig } from './host-config';\n\n/**\n * Ascend `levels` from `window_` to find the designated embedder frame.\n *\n * @param levels - Number of ancestor levels to ascend\n */\nfunction getEmbedderFrame(levels: number, window_: Window = window): Window {\n  let ancestorWindow = window_;\n  for (let i = 0; i < levels; i++) {\n    if (ancestorWindow === ancestorWindow.top) {\n      throw new Error(\n        'The target parent frame has exceeded the ancestor tree. Try reducing the `requestConfigFromFrame.ancestorLevel` value in the `hypothesisConfig`',\n      );\n    }\n    ancestorWindow = ancestorWindow.parent;\n  }\n  return ancestorWindow;\n}\n\n/**\n * Which groups to load and show in the sidebar may be dictated in\n * ConfigFromHost configuration: the special value `$rpc:requestGroups`\n * indicates that the list of groups should be requested asynchronously.\n *\n * This function (maybe) mutates values in the provided `configFromHost`'s\n * ServiceGroups: `$rpc:requestGroups` values are replaced with\n * `Promise<string[]>`.\n */\nfunction fetchServiceGroups(\n  configFromHost: ConfigFromHost,\n  rpcSettings: RPCSettings,\n): ConfigFromHost {\n  const services = configFromHost.services;\n  if (!Array.isArray(services)) {\n    return configFromHost;\n  }\n  services.forEach((service, index) => {\n    if (service.groups === '$rpc:requestGroups') {\n      // The `groups` need to be fetched from a secondary RPC call and\n      // there should be no timeout as it may be waiting for user input.\n      service.groups = postMessageJsonRpc\n        .call<string[]>(\n          rpcSettings.targetFrame,\n          rpcSettings.origin,\n          'requestGroups',\n          [index],\n          0, // no timeout\n        )\n        .catch(() => {\n          throw new Error('Unable to fetch groups');\n        });\n    }\n  });\n  return configFromHost;\n}\n\n/**\n * Derive RPC settings from the provided `ConfigFromAnnotator`, if any are present.\n */\nfunction buildRPCSettings(\n  configFromAnnotator: ConfigFromAnnotator,\n  window_: Window,\n): RPCSettings | null {\n  const rpcConfig = configFromAnnotator.requestConfigFromFrame;\n  if (!rpcConfig) {\n    return null;\n  } else if (\n    typeof rpcConfig.ancestorLevel !== 'number' ||\n    typeof rpcConfig.origin !== 'string'\n  ) {\n    throw new Error(\n      'Improper `requestConfigFromFrame` object. Both `ancestorLevel` and `origin` need to be specified',\n    );\n  }\n  return {\n    targetFrame: getEmbedderFrame(rpcConfig.ancestorLevel, window_),\n    origin: rpcConfig.origin,\n  };\n}\n\n/**\n * Retrieve host configuration from embedder frame\n */\nasync function getEmbedderConfig(\n  configFromAnnotator: ConfigFromAnnotator,\n  rpcSettings: RPCSettings,\n): Promise<ConfigFromEmbedder> {\n  const configFromEmbedder = await postMessageJsonRpc.call<ConfigFromEmbedder>(\n    rpcSettings.targetFrame,\n    rpcSettings.origin,\n    'requestConfig',\n    [],\n    3000,\n  );\n\n  // In cases where host configuration is requested from the embedder frame\n  // (`ConfigFromEmbedder`), `ConfigFromAnnotator` values are discarded.\n  //\n  // The `group` property, however, is currently not provided by\n  // `ConfigFromEmbedder` and needs to be restored. This property is used by the\n  // Notebook.\n  // TODO: Notebook group should be set by alternate means\n  return {\n    ...configFromEmbedder,\n    ...(configFromAnnotator.group ? { group: configFromAnnotator.group } : {}),\n  };\n}\n\n/**\n * Build a `SidebarSettings` object by merging the provided `ConfigFromSidebar`\n * with host configuration (`ConfigFromAnnotator` OR `ConfigFromEmbedder`).\n *\n * @see {ConfigFromAnnotator}\n * @see {ConfigFromEmbedder}\n * @see {ConfigFromHost}\n *\n * @return The merged settings\n */\nexport async function buildSettings(\n  configFromSidebar: ConfigFromSidebar,\n  window_: Window = window,\n): Promise<SidebarSettings> {\n  const configFromAnnotator = hostPageConfig(window);\n\n  const rpcSettings = buildRPCSettings(configFromAnnotator, window_);\n  let configFromHost;\n  if (rpcSettings) {\n    // The presence of RPCSettings indicates that we should\n    // source the ConfigFromHost from another frame, and potentially load\n    // the correct groups asynchronously as well.\n    const configFromEmbedder = await getEmbedderConfig(\n      configFromAnnotator,\n      rpcSettings,\n    );\n    configFromHost = fetchServiceGroups(configFromEmbedder, rpcSettings);\n  } else {\n    configFromHost = configFromAnnotator;\n  }\n\n  const sidebarSettings: SidebarSettings = {\n    ...configFromSidebar,\n    ...configFromHost,\n  };\n  if (rpcSettings) {\n    sidebarSettings.rpc = rpcSettings;\n  }\n  sidebarSettings.apiUrl = getApiUrl(sidebarSettings);\n\n  return sidebarSettings;\n}\n","const shownWarnings = new Set<string>();\n\n/**\n * Log a warning if it has not already been reported.\n *\n * This is useful to avoid spamming the console if a warning is emitted in a\n * context that may be called frequently.\n *\n * @param args -\n *   Arguments to forward to `console.warn`. The arguments `toString()` values\n *   are concatenated into a string key which is used to determine if the warning\n *   has been logged before.\n */\nexport function warnOnce(...args: unknown[]) {\n  const key = args.join();\n  if (shownWarnings.has(key)) {\n    return;\n  }\n  console.warn(...args);\n  shownWarnings.add(key);\n}\n\nwarnOnce.reset = () => {\n  shownWarnings.clear();\n};\n","'use strict';\n\nmodule.exports = string => {\n\tif (typeof string !== 'string') {\n\t\tthrow new TypeError('Expected a string');\n\t}\n\n\t// Escape characters with special meaning either inside or outside character sets.\n\t// Use a simple backslash escape when it’s always valid, and a \\unnnn escape when the simpler form would be disallowed by Unicode patterns’ stricter grammar.\n\treturn string\n\t\t.replace(/[|\\\\{}()[\\]^$+*?.]/g, '\\\\$&')\n\t\t.replace(/-/g, '\\\\x2d');\n};\n","import escapeStringRegexp from 'escape-string-regexp';\n\nimport type { Group, GroupIdentifier } from '../../types/api';\nimport type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\n\n/**\n * Return true if users are allowed to leave groups.\n *\n * Third-party authorities currently have to opt-in to enabling this, since\n * users may not have a way to rejoin a group after leaving.\n */\nfunction allowLeavingGroups(settings: SidebarSettings): boolean {\n  const config = serviceConfig(settings);\n  if (!config) {\n    return true;\n  }\n  return !!config.allowLeavingGroups;\n}\n\nexport const PUBLIC_GROUP_ID = '__world__';\n\n/**\n * Combine groups from multiple api calls together to form a unique list of groups.\n * Add an isMember property to each group indicating whether the logged in user is a member.\n * Add an isScopedToUri property to each group indicating whether the uri matches the group's\n *   uri patterns. If no uri patterns are specified, defaults to True.\n *\n * @param userGroups - groups the user is a member of\n * @param featuredGroups - all other groups, may include some duplicates from the userGroups\n * @param uri - uri of the current page\n */\nexport function combineGroups(\n  userGroups: Group[],\n  featuredGroups: Group[],\n  uri: string | null,\n  settings: SidebarSettings,\n) {\n  const worldGroup = featuredGroups.find(g => g.id === PUBLIC_GROUP_ID);\n  if (worldGroup) {\n    userGroups.unshift(worldGroup);\n  }\n\n  const myGroupIds = userGroups.map(g => g.id);\n  featuredGroups = featuredGroups.filter(g => !myGroupIds.includes(g.id));\n\n  // Set flag indicating whether user is a member of the group.\n  featuredGroups.forEach(group => (group.isMember = false));\n  userGroups.forEach(group => (group.isMember = true));\n\n  const groups = userGroups.concat(featuredGroups);\n\n  // Set flag indicating whether user can leave group.\n  for (const group of groups) {\n    group.canLeave =\n      allowLeavingGroups(settings) &&\n      group.isMember &&\n      // People should not be able to leave the \"Public\" group.\n      group.id !== PUBLIC_GROUP_ID;\n  }\n\n  // Add isScopedToUri property indicating whether a group is within scope\n  // of the given uri. If the scope check cannot be performed, isScopedToUri\n  // defaults to true.\n  groups.forEach(group => (group.isScopedToUri = isScopedToUri(group, uri)));\n\n  return groups;\n}\n\nfunction isScopedToUri(group: Group, uri: string | null): boolean {\n  /* If a scope check cannot be performed, meaning:\n   * - the group doesn't have a scopes attribute\n   * - the group has no scopes.uri_patterns present\n   * - there is no uri to compare against (aka: uri=null)\n   * the group is defaulted to in-scope.\n   */\n  if (group.scopes && group.scopes.uri_patterns.length > 0 && uri) {\n    return uriMatchesScopes(uri, group.scopes.uri_patterns);\n  }\n  return true;\n}\n\nfunction uriMatchesScopes(uri: string, scopes: string[]): boolean {\n  return scopes.some(uriRegex =>\n    uri.match(\n      // Convert *'s to .*'s for regex matching and escape all other special characters.\n      uriRegex.split('*').map(escapeStringRegexp).join('.*'),\n    ),\n  );\n}\n\n/**\n * Find groups in `groups` by GroupIdentifier, which may be either an `id` or\n * `groupid`.\n */\nfunction findGroupsByAnyIds(\n  groupIds: GroupIdentifier[],\n  groups: Group[],\n): Group[] {\n  return groups.filter(\n    g => groupIds.includes(g.id) || (g.groupid && groupIds.includes(g.groupid)),\n  );\n}\n\n/**\n * Attempt to convert a list in which each entry might be either an `id`\n * (pubid) or a `groupid` into a list of `id`s by locating associated groups\n * in the set of all `groups`. Only return entries for groups that can be\n * found in `groups`.\n */\nexport function normalizeGroupIds(\n  groupIds: GroupIdentifier[],\n  groups: Group[],\n): Group['id'][] {\n  return findGroupsByAnyIds(groupIds, groups).map(g => g.id);\n}\n","import { warnOnce } from '../shared/warn-once';\nimport type { ContentInfoConfig } from '../types/annotator';\nimport type { SidebarSettings } from '../types/config';\nimport type { FocusUserInfo } from '../types/rpc';\nimport { normalizeGroupIds } from './helpers/groups';\nimport type { SidebarStore } from './store';\n\n/**\n * List of not-yet-processed messages received during application startup.\n */\nlet preStartQueue: MessageEvent[] = [];\n\n/**\n * Return the mapped methods that can be called remotely via this server.\n *\n * @param store - The global store\n */\nconst registeredMethods = (store: SidebarStore) => {\n  return {\n    changeFocusModeUser: (userInfo: FocusUserInfo) => {\n      store.changeFocusModeUser(userInfo);\n\n      const groupIds = userInfo?.groups ?? [];\n      const filteredGroupIds = normalizeGroupIds(groupIds, store.allGroups());\n      if (groupIds.length && !filteredGroupIds.length) {\n        console.error('No matching groups found in list of filtered group IDs');\n      }\n      store.filterGroups(filteredGroupIds);\n    },\n\n    showContentInfo: (contentInfo: ContentInfoConfig) => {\n      store.setContentInfo(contentInfo);\n    },\n  };\n};\n\n/**\n * See https://www.jsonrpc.org/specification#request_object.\n */\ntype JSONRPCRequest = {\n  jsonrpc: string;\n  id: string;\n  method: string;\n  params?: unknown[];\n};\n\n/**\n * Return true if `data` \"looks like\" a JSON-RPC message.\n */\nfunction isJSONRPCRequest(data: any): data is JSONRPCRequest {\n  // eslint-disable-next-line eqeqeq\n  if (data == null || typeof data !== 'object') {\n    return false;\n  }\n  return data.jsonrpc === '2.0';\n}\n\n/**\n * Begin responding to JSON-RPC requests from frames on other origins.\n *\n * Register a window.postMessage() event listener that receives and responds to\n * JSON-RPC requests sent by frames on other origins using postMessage() as the\n * transport layer.\n *\n * Only frames whose origin is in the rpcAllowedOrigins config setting will be\n * responded to.\n *\n * This is a very partial implementation of a JSON-RPC 2.0 server:\n *\n * http://www.jsonrpc.org/specification\n *\n * The only part that we support so far is receiving JSON-RPC 2.0 requests (not\n * notifications) and sending back a successful \"ok\" response.\n *\n * All methods called upon must be mapped in the `registeredMethods` function.\n *\n * @inject\n */\nexport function startServer(\n  store: SidebarStore,\n  settings: SidebarSettings,\n  $window: Window,\n) {\n  const methods: Record<string, (...args: any[]) => void> =\n    registeredMethods(store);\n\n  // Process the pre-start incoming RPC requests\n  preStartQueue.forEach(event => {\n    receiveMessage(event);\n  });\n  // Clear the queue and remove the preStartMessageListener\n  preStartQueue = [];\n  window.removeEventListener('message', preStartMessageListener);\n\n  // Start listening to new RPC requests\n  $window.addEventListener('message', receiveMessage);\n\n  function receiveMessage(event: MessageEvent) {\n    const allowedOrigins = settings.rpcAllowedOrigins || [];\n\n    if (!isJSONRPCRequest(event.data)) {\n      return;\n    }\n\n    if (!allowedOrigins.includes(event.origin)) {\n      warnOnce(\n        `Ignoring JSON-RPC request from non-whitelisted origin ${event.origin}`,\n      );\n      return;\n    }\n\n    // The entire JSON-RPC request object is contained in the postMessage()\n    // data param.\n    const jsonRpcRequest = event.data;\n\n    const source = event.source as Window;\n    source.postMessage(jsonRpcResponse(jsonRpcRequest), event.origin);\n  }\n\n  /**\n   * Return a JSON-RPC response to the given JSON-RPC request object.\n   */\n  function jsonRpcResponse(request: JSONRPCRequest) {\n    const method = methods[request.method];\n\n    // Return an error response if the method name is not registered with\n    // registeredMethods.\n    if (method === undefined) {\n      return {\n        jsonrpc: '2.0',\n        id: request.id,\n        error: { code: -32601, message: 'Method not found' },\n      };\n    }\n\n    // Call the method and return the result response.\n    if (request.params) {\n      method(...request.params);\n    } else {\n      method();\n    }\n    return { jsonrpc: '2.0', result: 'ok', id: request.id };\n  }\n}\n\n/**\n * Queues all incoming RPC requests so they can be handled later.\n *\n * @param event - RPC event payload\n */\nfunction preStartMessageListener(event: MessageEvent) {\n  preStartQueue.push(event);\n}\n\n/**\n * Start listening to incoming RPC requests right away so they don't timeout. These\n * requests are saved until the server starts up and then they can be handled accordingly.\n *\n * Why?\n *\n * This allows the client to fetch its config from the parent app frame and potentially\n * receive new unsolicited incoming requests that the parent app may send before this\n * RPC server starts.\n */\nexport function preStartServer(window_: Window = window) {\n  window_.addEventListener('message', preStartMessageListener);\n}\n","import type { AnalyticsEventName, APIService } from './api';\n\n/**\n * @inject\n */\nexport class AnalyticsService {\n  private _api: APIService;\n\n  constructor(api: APIService) {\n    this._api = api;\n  }\n\n  trackEvent(name: AnalyticsEventName): void {\n    this._api.analytics.events\n      .create({}, { event: name })\n      .catch(e => console.warn(`Could not track event \"${name}\"`, e));\n  }\n}\n","import type { Annotation } from '../../types/api';\nimport type { AnnotationEventType, SidebarSettings } from '../../types/config';\nimport { isShared } from '../helpers/permissions';\nimport * as postMessageJsonRpc from '../util/postmessage-json-rpc';\n\n/**\n * Send messages to configured ancestor frame on annotation activity\n */\n// @inject\nexport class AnnotationActivityService {\n  private _rpc: SidebarSettings['rpc'];\n  private _reportConfig: SidebarSettings['reportActivity'];\n\n  constructor(settings: SidebarSettings) {\n    this._rpc = settings.rpc;\n    this._reportConfig = settings.reportActivity;\n  }\n\n  reportActivity(eventType: AnnotationEventType, annotation: Annotation) {\n    if (!this._rpc || !this._reportConfig) {\n      return;\n    }\n\n    // Determine the appropriate ISO-8601 timestamp for this \"activity\"\n    let activityDate;\n    switch (eventType) {\n      case 'create':\n        activityDate = new Date(annotation.created).toISOString();\n        break;\n      case 'update':\n        activityDate = new Date(annotation.updated).toISOString();\n        break;\n      default:\n        activityDate = new Date().toISOString();\n    }\n\n    const data = {\n      date: activityDate,\n      annotation: {\n        id: annotation.id,\n        isShared: isShared(annotation.permissions),\n      },\n    };\n\n    if (this._reportConfig.events.includes(eventType)) {\n      postMessageJsonRpc.notify(\n        this._rpc.targetFrame,\n        this._rpc.origin,\n        this._reportConfig.method,\n        [eventType, data],\n      );\n    }\n  }\n}\n","import { generateHexString } from '../../shared/random';\nimport type { AnnotationData } from '../../types/annotator';\nimport type {\n  APIAnnotationData,\n  Annotation,\n  SavedAnnotation,\n} from '../../types/api';\nimport type { AnnotationEventType, SidebarSettings } from '../../types/config';\nimport { parseAccountID } from '../helpers/account-id';\nimport * as metadata from '../helpers/annotation-metadata';\nimport type { UserItem } from '../helpers/mention-suggestions';\nimport { wrapDisplayNameMentions, wrapMentions } from '../helpers/mentions';\nimport {\n  defaultPermissions,\n  privatePermissions,\n  sharedPermissions,\n} from '../helpers/permissions';\nimport type { SidebarStore } from '../store';\nimport type { AnnotationActivityService } from './annotation-activity';\nimport type { APIService } from './api';\n\nexport type MentionsOptions =\n  | {\n      mentionMode: 'username';\n    }\n  | {\n      mentionMode: 'display-name';\n      /**\n       * A display-name/user-info map so that mention tags can be generated from\n       * display-name mentions\n       */\n      usersMap: Map<string, UserItem>;\n    };\n\n/**\n * A service for creating, updating and persisting annotations both in the\n * local store and on the backend via the API.\n */\n// @inject\nexport class AnnotationsService {\n  private _activity: AnnotationActivityService;\n  private _api: APIService;\n  private _settings: SidebarSettings;\n  private _store: SidebarStore;\n\n  constructor(\n    annotationActivity: AnnotationActivityService,\n    api: APIService,\n    settings: SidebarSettings,\n    store: SidebarStore,\n  ) {\n    this._activity = annotationActivity;\n    this._api = api;\n    this._settings = settings;\n    this._store = store;\n  }\n\n  /**\n   * Apply changes for the given `annotation` from its draft in the store (if\n   * any) and return a new object with those changes integrated.\n   */\n  private _applyDraftChanges(\n    annotation: Annotation,\n    mentionsOptions: MentionsOptions,\n  ): Annotation {\n    const changes: Partial<Annotation> = {};\n    const draft = this._store.getDraft(annotation);\n    const authority =\n      parseAccountID(this._store.profile().userid)?.provider ??\n      this._store.defaultAuthority();\n    const mentionsEnabled = this._store.isFeatureEnabled('at_mentions');\n\n    if (!draft) {\n      return { ...annotation };\n    }\n\n    if (!mentionsEnabled) {\n      changes.text = draft.text;\n    } else if (mentionsOptions.mentionMode === 'username') {\n      changes.text = wrapMentions(draft.text, authority);\n    } else {\n      changes.text = wrapDisplayNameMentions(\n        draft.text,\n        mentionsOptions.usersMap,\n      );\n    }\n\n    changes.tags = draft.tags;\n    changes.permissions = draft.isPrivate\n      ? privatePermissions(annotation.user)\n      : sharedPermissions(annotation.user, annotation.group);\n\n    // Integrate changes from draft into object to be persisted\n    return { ...annotation, ...changes };\n  }\n\n  /**\n   * Create a new {@link Annotation} object from a set of field values.\n   *\n   * All fields not set in `annotationData` will be populated with default\n   * values.\n   */\n  annotationFromData(\n    annotationData: Partial<APIAnnotationData> &\n      Pick<AnnotationData, 'uri' | 'target'>,\n    /* istanbul ignore next */\n    now: Date = new Date(),\n  ): Annotation {\n    const defaultPrivacy = this._store.getDefault('annotationPrivacy');\n    const groupid = this._store.focusedGroupId();\n    const profile = this._store.profile();\n\n    if (!groupid) {\n      throw new Error('Cannot create annotation without a group');\n    }\n\n    const userid = profile.userid;\n    if (!userid) {\n      throw new Error('Cannot create annotation when logged out');\n    }\n\n    const userInfo = profile.user_info;\n\n    // We need a unique local/app identifier for this new annotation such\n    // that we might look it up later in the store. It won't have an ID yet,\n    // as it has not been persisted to the service.\n    const $tag = `s:${generateHexString(8)}`;\n    const annotation: Annotation = Object.assign(\n      {\n        created: now.toISOString(),\n        group: groupid,\n        permissions: defaultPermissions(userid, groupid, defaultPrivacy),\n        tags: [],\n        text: '',\n        updated: now.toISOString(),\n        user: userid,\n        user_info: userInfo,\n        $tag,\n        hidden: false,\n        links: {},\n        document: { title: '' },\n      },\n      annotationData,\n    );\n\n    // Highlights are peculiar in that they always have private permissions\n    if (metadata.isHighlight(annotation)) {\n      annotation.permissions = privatePermissions(userid);\n    }\n\n    // Attach information about the current context (eg. LMS assignment).\n    if (this._settings.annotationMetadata) {\n      annotation.metadata = { ...this._settings.annotationMetadata };\n    }\n\n    return annotation;\n  }\n\n  /**\n   * Populate a new annotation object from `annotation` and add it to the store.\n   * Create a draft for it unless it's a highlight and clear other empty\n   * drafts out of the way.\n   */\n  create(annotationData: Omit<AnnotationData, '$tag'>, now = new Date()) {\n    const annotation = this.annotationFromData(annotationData, now);\n\n    this._store.addAnnotations([annotation]);\n\n    // Remove other drafts that are in the way, and their annotations (if new)\n    this._store.deleteNewAndEmptyDrafts();\n\n    // Create a draft unless it's a highlight\n    if (!metadata.isHighlight(annotation)) {\n      this._store.createDraft(annotation, {\n        tags: annotation.tags,\n        text: annotation.text,\n        isPrivate: !metadata.isPublic(annotation),\n      });\n    }\n\n    // NB: It may make sense to move the following code at some point to\n    // the UI layer\n    // Select the correct tab\n    // If the annotation is of type note or annotation, make sure\n    // the appropriate tab is selected. If it is of type reply, user\n    // stays in the selected tab.\n    if (metadata.isPageNote(annotation)) {\n      this._store.selectTab('note');\n    } else if (metadata.isAnnotation(annotation)) {\n      this._store.selectTab('annotation');\n    }\n\n    (annotation.references || []).forEach(parent => {\n      // Expand any parents of this annotation.\n      this._store.setExpanded(parent, true);\n    });\n  }\n\n  /**\n   * Create a new empty \"page note\" annotation and add it to the store. If the\n   * user is not logged in, open the `loginPrompt` panel instead.\n   */\n  createPageNote() {\n    const topLevelFrame = this._store.mainFrame();\n    if (!this._store.isLoggedIn()) {\n      this._store.openSidebarPanel('loginPrompt');\n      return;\n    }\n    if (!topLevelFrame) {\n      return;\n    }\n    const pageNoteAnnotation = {\n      target: [\n        {\n          source: topLevelFrame.uri,\n        },\n      ],\n      uri: topLevelFrame.uri,\n    };\n    this.create(pageNoteAnnotation);\n  }\n\n  /**\n   * Delete an annotation via the API and update the store.\n   */\n  async delete(annotation: SavedAnnotation) {\n    await this._api.annotation.delete({ id: annotation.id });\n    this._activity.reportActivity('delete', annotation);\n    this._store.removeAnnotations([annotation]);\n  }\n\n  /**\n   * Flag an annotation for review by a moderator.\n   */\n  async flag(annotation: SavedAnnotation) {\n    await this._api.annotation.flag({ id: annotation.id });\n    this._activity.reportActivity('flag', annotation);\n    this._store.updateFlagStatus(annotation.id, true);\n  }\n\n  /**\n   * Create a reply to `annotation` by the user `userid` and add to the store.\n   */\n  reply(annotation: SavedAnnotation, userid: string) {\n    const replyAnnotation = {\n      group: annotation.group,\n      permissions: metadata.isPublic(annotation)\n        ? sharedPermissions(userid, annotation.group)\n        : privatePermissions(userid),\n      references: (annotation.references || []).concat(annotation.id),\n      target: [{ source: annotation.target[0].source }],\n      uri: annotation.uri,\n    };\n    this.create(replyAnnotation);\n  }\n\n  /**\n   * Save new (or update existing) annotation. On success,\n   * the annotation's `Draft` will be removed and the annotation added\n   * to the store.\n   */\n  async save(\n    annotation: Annotation,\n    mentionsOptions: MentionsOptions = { mentionMode: 'username' },\n  ) {\n    let saved: Promise<Annotation>;\n    let eventType: AnnotationEventType;\n\n    const annotationWithChanges = this._applyDraftChanges(\n      annotation,\n      mentionsOptions,\n    );\n\n    if (!metadata.isSaved(annotation)) {\n      saved = this._api.annotation.create({}, annotationWithChanges);\n      eventType = 'create';\n    } else {\n      saved = this._api.annotation.update(\n        { id: annotation.id },\n        annotationWithChanges,\n      );\n      eventType = 'update';\n    }\n\n    let savedAnnotation: Annotation;\n    this._store.annotationSaveStarted(annotation);\n    try {\n      savedAnnotation = await saved;\n      this._activity.reportActivity(eventType, savedAnnotation);\n    } finally {\n      this._store.annotationSaveFinished(annotation);\n    }\n\n    // Copy local/internal fields from the original annotation to the saved\n    // version.\n    for (const [key, value] of Object.entries(annotation)) {\n      if (key.startsWith('$')) {\n        const fields: Record<string, any> = savedAnnotation;\n        fields[key] = value;\n      }\n    }\n\n    // Clear out any pending changes (draft)\n    this._store.removeDraft(annotation);\n\n    // Add (or, in effect, update) the annotation to the store's collection\n    this._store.addAnnotations([savedAnnotation]);\n    return savedAnnotation;\n  }\n}\n","import{options as t,Fragment as e}from\"preact\";if(\"function\"!=typeof Symbol){var n=0;Symbol=function(t){return\"@@\"+t+ ++n},Symbol.for=function(t){return\"@@\"+t}}var r=/^(?:area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,o=/[\\s\\n\\\\/='\"\\0<>]/,i=/^(xlink|xmlns|xml)([A-Z])/,a=/^(?:accessK|auto[A-Z]|cell|ch|col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z])/,c=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,l=/[\"&<]/;function s(t){if(0===t.length||!1===l.test(t))return t;for(var e=0,n=0,r=\"\",o=\"\";n<t.length;n++){switch(t.charCodeAt(n)){case 34:o=\"&quot;\";break;case 38:o=\"&amp;\";break;case 60:o=\"&lt;\";break;default:continue}n!==e&&(r+=t.slice(e,n)),r+=o,e=n+1}return n!==e&&(r+=t.slice(e,n)),r}var u=function(t,e){return String(t).replace(/(\\n+)/g,\"$1\"+(e||\"\\t\"))},f=function(t,e,n){return String(t).length>(e||40)||!n&&-1!==String(t).indexOf(\"\\n\")||-1!==String(t).indexOf(\"<\")},p={},d=new Set([\"animation-iteration-count\",\"border-image-outset\",\"border-image-slice\",\"border-image-width\",\"box-flex\",\"box-flex-group\",\"box-ordinal-group\",\"column-count\",\"fill-opacity\",\"flex\",\"flex-grow\",\"flex-negative\",\"flex-order\",\"flex-positive\",\"flex-shrink\",\"flood-opacity\",\"font-weight\",\"grid-column\",\"grid-row\",\"line-clamp\",\"line-height\",\"opacity\",\"order\",\"orphans\",\"stop-opacity\",\"stroke-dasharray\",\"stroke-dashoffset\",\"stroke-miterlimit\",\"stroke-opacity\",\"stroke-width\",\"tab-size\",\"widows\",\"z-index\",\"zoom\"]),g=/[A-Z]/g;function y(t){var e=\"\";for(var n in t){var r=t[n];if(null!=r&&\"\"!==r){var o=\"-\"==n[0]?n:p[n]||(p[n]=n.replace(g,\"-$&\").toLowerCase()),i=\";\";\"number\"!=typeof r||o.startsWith(\"--\")||d.has(o)||(i=\"px;\"),e=e+o+\":\"+r+i}}return e||void 0}function b(t,e){return Array.isArray(e)?e.reduce(b,t):null!=e&&!1!==e&&t.push(e),t}function m(){this.__d=!0}function h(t,e){return{__v:t,context:e,props:t.props,setState:m,forceUpdate:m,__d:!0,__h:new Array(0)}}function v(t,e){var n=t.contextType,r=n&&e[n.__c];return null!=n?r?r.props.value:n.__:e}var _=[],x=[];function j(e,n,r,o){var i=t.__s;t.__s=!0;try{return S(e,n||{},r,o)}finally{t.__c&&t.__c(e,x),t.__s=i,x.length=0}}function S(n,l,p,d,g,m){if(null==n||\"boolean\"==typeof n)return\"\";if(\"object\"!=typeof n)return\"function\"==typeof n?\"\":s(n+\"\");var _=p.pretty,x=_&&\"string\"==typeof _?_:\"\\t\";if(Array.isArray(n)){for(var j=\"\",A=0;A<n.length;A++)_&&A>0&&(j+=\"\\n\"),j+=S(n[A],l,p,d,g,m);return j}if(void 0!==n.constructor)return\"\";t.__b&&t.__b(n);var w,O=n.type,C=n.props,F=!1;if(\"function\"==typeof O){if(F=!0,!p.shallow||!d&&!1!==p.renderRootComponent||O===e){if(O===e){var E=[];return b(E,n.props.children),S(E,l,p,!1!==p.shallowHighOrder,g,m)}var M,$=n.__c=h(n,l),H=t.__r;if(O.prototype&&\"function\"==typeof O.prototype.render){var L=v(O,l);($=n.__c=new O(C,L)).__v=n,$._dirty=$.__d=!0,$.props=C,null==$.state&&($.state={}),null==$._nextState&&null==$.__s&&($._nextState=$.__s=$.state),$.context=L,O.getDerivedStateFromProps?$.state=Object.assign({},$.state,O.getDerivedStateFromProps($.props,$.state)):$.componentWillMount&&($.componentWillMount(),$.state=$._nextState!==$.state?$._nextState:$.__s!==$.state?$.__s:$.state),H&&H(n),M=$.render($.props,$.state,$.context)}else for(var I=v(O,l),N=0;$.__d&&N++<25;)$.__d=!1,H&&H(n),M=O.call(n.__c,C,I);$.getChildContext&&(l=Object.assign({},l,$.getChildContext()));var D=S(M,l,p,!1!==p.shallowHighOrder,g,m);return t.diffed&&t.diffed(n),D}O=(w=O).displayName||w!==Function&&w.name||k(w)}var W,T,U=\"<\"+O;if(C){var Z=Object.keys(C);p&&!0===p.sortAttributes&&Z.sort();for(var P=0;P<Z.length;P++){var R=Z[P],z=C[R];if(\"children\"!==R){if(!o.test(R)&&(p&&p.allAttributes||\"key\"!==R&&\"ref\"!==R&&\"__self\"!==R&&\"__source\"!==R)){if(\"defaultValue\"===R)R=\"value\";else if(\"defaultChecked\"===R)R=\"checked\";else if(\"defaultSelected\"===R)R=\"selected\";else if(\"className\"===R){if(void 0!==C.class)continue;R=\"class\"}else\"acceptCharset\"===R?R=\"accept-charset\":\"httpEquiv\"===R?R=\"http-equiv\":i.test(R)?R=R.replace(i,\"$1:$2\").toLowerCase():g?c.test(R)&&(R=\"panose1\"===R?\"panose-1\":R.replace(/([A-Z])/g,\"-$1\").toLowerCase()):a.test(R)&&(R=R.toLowerCase());if(\"htmlFor\"===R){if(C.for)continue;R=\"for\"}\"style\"===R&&z&&\"object\"==typeof z&&(z=y(z)),\"a\"===R[0]&&\"r\"===R[1]&&\"boolean\"==typeof z&&(z=String(z));var q=p.attributeHook&&p.attributeHook(R,z,l,p,F);if(q||\"\"===q)U+=q;else if(\"dangerouslySetInnerHTML\"===R)T=z&&z.__html;else if(\"textarea\"===O&&\"value\"===R)W=z;else if((z||0===z||\"\"===z)&&\"function\"!=typeof z){if(!(!0!==z&&\"\"!==z||(z=R,p&&p.xml))){U=U+\" \"+R;continue}if(\"value\"===R){if(\"select\"===O){m=z;continue}\"option\"===O&&m==z&&void 0===C.selected&&(U+=\" selected\")}U=U+\" \"+R+'=\"'+s(z+\"\")+'\"'}}}else W=z}}if(_){var J=U.replace(/\\n\\s*/,\" \");J===U||~J.indexOf(\"\\n\")?_&&~U.indexOf(\"\\n\")&&(U+=\"\\n\"):U=J}if(U+=\">\",o.test(O))throw new Error(O+\" is not a valid HTML tag name in \"+U);var V,B=r.test(O)||p.voidElements&&p.voidElements.test(O),G=[];if(T)_&&f(T)&&(T=\"\\n\"+x+u(T,x)),U+=T;else if(null!=W&&b(V=[],W).length){for(var K=_&&~U.indexOf(\"\\n\"),Q=!1,X=0;X<V.length;X++){var Y=V[X];if(null!=Y&&!1!==Y){var tt=S(Y,l,p,!0,\"svg\"===O||\"foreignObject\"!==O&&g,m);if(_&&!K&&f(tt)&&(K=!0),tt)if(_){var et=tt.length>0&&\"<\"!=tt[0];Q&&et?G[G.length-1]+=tt:G.push(tt),Q=et}else G.push(tt)}}if(_&&K)for(var nt=G.length;nt--;)G[nt]=\"\\n\"+x+u(G[nt],x)}if(t.diffed&&t.diffed(n),G.length||T)U+=G.join(\"\");else if(p&&p.xml)return U.substring(0,U.length-1)+\" />\";return!B||V||T?(_&&~U.indexOf(\"\\n\")&&(U+=\"\\n\"),U=U+\"</\"+O+\">\"):U=U.replace(/>$/,\" />\"),U}function k(t){var e=(Function.prototype.toString.call(t).match(/^\\s*function\\s+([^( ]+)/)||\"\")[1];if(!e){for(var n=-1,r=_.length;r--;)if(_[r]===t){n=r;break}n<0&&(n=_.push(t)-1),e=\"UnnamedComponent\"+n}return e}const A=/(\\\\|\\\"|\\')/g;var w=function(t){return t.replace(A,\"\\\\$1\")};const O=Object.prototype.toString,C=Date.prototype.toISOString,F=Error.prototype.toString,E=RegExp.prototype.toString,M=Symbol.prototype.toString,$=/^Symbol\\((.*)\\)(.*)$/,H=/\\n/gi,L=Object.getOwnPropertySymbols||(t=>[]);function I(t){return\"[object Array]\"===t||\"[object ArrayBuffer]\"===t||\"[object DataView]\"===t||\"[object Float32Array]\"===t||\"[object Float64Array]\"===t||\"[object Int8Array]\"===t||\"[object Int16Array]\"===t||\"[object Int32Array]\"===t||\"[object Uint8Array]\"===t||\"[object Uint8ClampedArray]\"===t||\"[object Uint16Array]\"===t||\"[object Uint32Array]\"===t}function N(t){return t!=+t?\"NaN\":0===t&&1/t<0?\"-0\":\"\"+t}function D(t){return\"\"===t.name?\"[Function anonymous]\":\"[Function \"+t.name+\"]\"}function W(t){return M.call(t).replace($,\"Symbol($1)\")}function T(t){return\"[\"+F.call(t)+\"]\"}function U(t){if(!0===t||!1===t)return\"\"+t;if(void 0===t)return\"undefined\";if(null===t)return\"null\";const e=typeof t;if(\"number\"===e)return N(t);if(\"string\"===e)return'\"'+w(t)+'\"';if(\"function\"===e)return D(t);if(\"symbol\"===e)return W(t);const n=O.call(t);return\"[object WeakMap]\"===n?\"WeakMap {}\":\"[object WeakSet]\"===n?\"WeakSet {}\":\"[object Function]\"===n||\"[object GeneratorFunction]\"===n?D(t,min):\"[object Symbol]\"===n?W(t):\"[object Date]\"===n?C.call(t):\"[object Error]\"===n?T(t):\"[object RegExp]\"===n?E.call(t):\"[object Arguments]\"===n&&0===t.length?\"Arguments []\":I(n)&&0===t.length?t.constructor.name+\" []\":t instanceof Error&&T(t)}function Z(t,e,n,r,o,i,a,c,l,s){let u=\"\";if(t.length){u+=o;const f=n+e;for(let n=0;n<t.length;n++)u+=f+G(t[n],e,f,r,o,i,a,c,l,s),n<t.length-1&&(u+=\",\"+r);u+=o+n}return\"[\"+u+\"]\"}function P(t,e,n,r,o,i,a,c,l,s){return(s?\"\":\"Arguments \")+Z(t,e,n,r,o,i,a,c,l,s)}function R(t,e,n,r,o,i,a,c,l,s){return(s?\"\":t.constructor.name+\" \")+Z(t,e,n,r,o,i,a,c,l,s)}function z(t,e,n,r,o,i,a,c,l,s){let u=\"Map {\";const f=t.entries();let p=f.next();if(!p.done){u+=o;const t=n+e;for(;!p.done;)u+=t+G(p.value[0],e,t,r,o,i,a,c,l,s)+\" => \"+G(p.value[1],e,t,r,o,i,a,c,l,s),p=f.next(),p.done||(u+=\",\"+r);u+=o+n}return u+\"}\"}function q(t,e,n,r,o,i,a,c,l,s){let u=(s?\"\":t.constructor?t.constructor.name+\" \":\"Object \")+\"{\",f=Object.keys(t).sort();const p=L(t);if(p.length&&(f=f.filter(t=>!(\"symbol\"==typeof t||\"[object Symbol]\"===O.call(t))).concat(p)),f.length){u+=o;const p=n+e;for(let n=0;n<f.length;n++){const d=f[n];u+=p+G(d,e,p,r,o,i,a,c,l,s)+\": \"+G(t[d],e,p,r,o,i,a,c,l,s),n<f.length-1&&(u+=\",\"+r)}u+=o+n}return u+\"}\"}function J(t,e,n,r,o,i,a,c,l,s){let u=\"Set {\";const f=t.entries();let p=f.next();if(!p.done){u+=o;const t=n+e;for(;!p.done;)u+=t+G(p.value[1],e,t,r,o,i,a,c,l,s),p=f.next(),p.done||(u+=\",\"+r);u+=o+n}return u+\"}\"}function V(t,e,n,r,o,i,a,c,l,s){if((i=i.slice()).indexOf(t)>-1)return\"[Circular]\";i.push(t);const u=++c>a;if(!u&&t.toJSON&&\"function\"==typeof t.toJSON)return G(t.toJSON(),e,n,r,o,i,a,c,l,s);const f=O.call(t);return\"[object Arguments]\"===f?u?\"[Arguments]\":P(t,e,n,r,o,i,a,c,l,s):I(f)?u?\"[Array]\":R(t,e,n,r,o,i,a,c,l,s):\"[object Map]\"===f?u?\"[Map]\":z(t,e,n,r,o,i,a,c,l,s):\"[object Set]\"===f?u?\"[Set]\":J(t,e,n,r,o,i,a,c,l,s):\"object\"==typeof t?u?\"[Object]\":q(t,e,n,r,o,i,a,c,l,s):void 0}function B(t,e,n,r,o,i,a,c,l,s){let u,f=!1;for(let e=0;e<l.length;e++)if(u=l[e],u.test(t)){f=!0;break}return!!f&&u.print(t,function(t){return G(t,e,n,r,o,i,a,c,l,s)},function(t){const r=n+e;return r+t.replace(H,\"\\n\"+r)},{edgeSpacing:o,spacing:r})}function G(t,e,n,r,o,i,a,c,l,s){return U(t)||B(t,e,n,r,o,i,a,c,l,s)||V(t,e,n,r,o,i,a,c,l,s)}const K={indent:2,min:!1,maxDepth:Infinity,plugins:[]};function Q(t){if(Object.keys(t).forEach(t=>{if(!K.hasOwnProperty(t))throw new Error(\"prettyFormat: Invalid option: \"+t)}),t.min&&void 0!==t.indent&&0!==t.indent)throw new Error(\"prettyFormat: Cannot run with min option and indent\")}function X(t){const e={};return Object.keys(K).forEach(n=>e[n]=t.hasOwnProperty(n)?t[n]:K[n]),e.min&&(e.indent=0),e}function Y(t){return new Array(t+1).join(\" \")}var tt=function(t,e){let n,r;e?(Q(e),e=X(e)):e=K;const o=e.min?\" \":\"\\n\",i=e.min?\"\":\"\\n\";if(e&&e.plugins.length){n=Y(e.indent),r=[];var a=B(t,n,\"\",o,i,r,e.maxDepth,0,e.plugins,e.min);if(a)return a}return U(t)||(n||(n=Y(e.indent)),r||(r=[]),V(t,n,\"\",o,i,r,e.maxDepth,0,e.plugins,e.min))},et={test:function(t){return t&&\"object\"==typeof t&&\"type\"in t&&\"props\"in t&&\"key\"in t},print:function(t,e,n){return j(t,et.context,et.opts,!0)}},nt={plugins:[et]},rt={attributeHook:function(t,e,n,r,o){var i=typeof e;if(\"dangerouslySetInnerHTML\"===t)return!1;if(null==e||\"function\"===i&&!r.functions)return\"\";if(r.skipFalseAttributes&&!o&&(!1===e||(\"class\"===t||\"style\"===t)&&\"\"===e))return\"\";var a=\"string\"==typeof r.pretty?r.pretty:\"\\t\";return\"string\"!==i?(\"function\"!==i||r.functionNames?(et.context=n,et.opts=r,~(e=tt(e,nt)).indexOf(\"\\n\")&&(e=u(\"\\n\"+e,a)+\"\\n\")):e=\"Function\",u(\"\\n\"+t+\"={\"+e+\"}\",a)):\"\\n\"+a+t+'=\"'+s(e)+'\"'},jsx:!0,xml:!1,functions:!0,functionNames:!0,skipFalseAttributes:!0,pretty:\"  \"};function ot(t,e,n){var r=Object.assign({},rt,n||{});return r.jsx||(r.attributeHook=null),j(t,e,r)}var it={shallow:!0};function at(t,e,n){return ot(t,e,Object.assign({},it,n||{}))}export default ot;export{ot as render,at as shallowRender};\n//# sourceMappingURL=index.module.js.map\n","function trimLeadingAndTrailingEmptyLines(str: string): string {\n  return str.replace(/^\\s*\\n|\\n\\s*$/g, '');\n}\n\n/**\n * Remove specified indentation from each line of a string.\n */\nfunction dedentStr(str: string, indent: number) {\n  const indentRegexp = new RegExp(`^ {${indent}}`, 'gm');\n  return str.replace(indentRegexp, '');\n}\n\n/**\n * Remove common indentation from each line of every string, then interpolate\n * params verbatim.\n */\nfunction dedent(strings: string[], ...params: any[]) {\n  // Match the smallest indentation among all lines of the full string before\n  // interpolating params\n  const match = strings.join('').match(/^[ \\t]*(?=\\S)/gm);\n  const smallestIndent = match ? Math.min(...match.map(el => el.length)) : 0;\n\n  // Dedent every individual string while interpolating params\n  // Those strings which are not the beginning of a line will have zero-indent\n  // and dedenting will have no effect\n  let result = '';\n  for (const [i, param] of params.entries()) {\n    result += dedentStr(strings[i], smallestIndent);\n    result += param;\n  }\n\n  return result + dedentStr(strings[strings.length - 1], smallestIndent);\n}\n\n/**\n * Remove leading and trailing empty lines from a string, then remove common\n * indentation from each line.\n *\n * This is useful to improve readability for multi-line template literals,\n * where you don't want to\n *  1) start the first line right after the first backtick.\n *  2) indent the string inconsistently with the rest of the code.\n *\n * This function allows to move from this:\n *   function foo(arg) {\n *     if (arg === 3) {\n *       console.log(`First line\n *   Second line\n *   ${var}\n *   Fourth line`);\n *     }\n *   }\n *\n * to this:\n *   function foo(arg) {\n *     if (arg === 3) {\n *       console.log(trimAndDedent`\n *         First line\n *         Second line\n *         ${var}\n *         Fourth line\n *       `);\n *     }\n *   }\n */\nexport function trimAndDedent(\n  strings: TemplateStringsArray,\n  ...params: any[]\n): string {\n  return trimLeadingAndTrailingEmptyLines(dedent([...strings], ...params));\n}\n","/**\n * Return a shallow clone of `obj` with all client-only properties removed.\n * Client-only properties are marked by a '$' prefix.\n */\nexport function stripInternalProperties(\n  obj: Record<string, unknown>,\n): Record<string, unknown> {\n  const result: Record<string, unknown> = {};\n  for (const [key, value] of Object.entries(obj)) {\n    if (!key.startsWith('$')) {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n","/**\n * Formats a date as `YYYY-MM-DD hh:mm`, using 24h and system timezone.\n *\n * This format has these useful characteristics:\n * - Easy to read (compared to an ISO date).\n * - Lexicographic and chronological order match.\n * - It is detected and correctly parsed as \"date\" when pasted in common\n *   spreadsheet editors, making it useful when exporting dates for CSV\n *   documents.\n */\nexport function formatSortableDateTime(date: Date): string {\n  const year = date.getFullYear();\n  const month = `${date.getMonth() + 1}`.padStart(2, '0');\n  const day = `${date.getDate()}`.padStart(2, '0');\n  const hours = `${date.getHours()}`.padStart(2, '0');\n  const minutes = `${date.getMinutes()}`.padStart(2, '0');\n\n  return `${year}-${month}-${day} ${hours}:${minutes}`;\n}\n","import renderToString from 'preact-render-to-string/jsx';\n\nimport type { CSVSeparator } from '../../shared/csv';\nimport { escapeCSVValue } from '../../shared/csv';\nimport { trimAndDedent } from '../../shared/trim-and-dedent';\nimport type { APIAnnotationData, Profile } from '../../types/api';\nimport {\n  annotationRole,\n  documentMetadata,\n  isReply,\n  pageLabel,\n  quote,\n} from '../helpers/annotation-metadata';\nimport { annotationDisplayName } from '../helpers/annotation-user';\nimport { stripInternalProperties } from '../helpers/strip-internal-properties';\nimport { VersionData } from '../helpers/version-data';\nimport { renderMathAndMarkdown } from '../render-markdown';\nimport { formatSortableDateTime } from '../util/time';\n\nexport type JSONExportContent = {\n  export_date: string;\n  export_userid: string;\n  client_version: string;\n  annotations: APIAnnotationData[];\n};\n\nexport type JSONExportOptions = {\n  profile: Profile;\n  now?: Date;\n};\n\ntype CommonExportOptions = {\n  defaultAuthority?: string;\n  displayNamesEnabled?: boolean;\n  groupName?: string;\n};\n\nexport type TextExportOptions = CommonExportOptions & {\n  now?: Date;\n};\n\nexport type CSVExportOptions = CommonExportOptions & {\n  separator?: CSVSeparator;\n};\n\nexport type HTMLExportOptions = TextExportOptions;\n\n/**\n * Generates annotations exports\n *\n * @inject\n */\nexport class AnnotationsExporter {\n  buildJSONExportContent(\n    annotations: APIAnnotationData[],\n    {\n      profile,\n      /* istanbul ignore next - test seam */\n      now = new Date(),\n    }: JSONExportOptions,\n  ): JSONExportContent {\n    const versionData = new VersionData(profile, []);\n\n    return {\n      export_date: now.toISOString(),\n      export_userid: profile.userid ?? '',\n      client_version: versionData.version,\n      annotations: annotations.map(\n        stripInternalProperties,\n      ) as APIAnnotationData[],\n    };\n  }\n\n  buildTextExportContent(\n    annotations: APIAnnotationData[],\n    {\n      groupName = '',\n      displayNamesEnabled = false,\n      defaultAuthority = '',\n      /* istanbul ignore next - test seam */\n      now = new Date(),\n    }: TextExportOptions = {},\n  ): string {\n    const { uri, title, uniqueUsers, replies, extractUsername } =\n      this._exportCommon(annotations, {\n        displayNamesEnabled,\n        defaultAuthority,\n      });\n\n    const annotationsAsText = annotations.map((annotation, index) => {\n      const page = pageLabel(annotation);\n      const annotationQuote = quote(annotation);\n      const lines = [\n        `Created at: ${formatSortableDateTime(new Date(annotation.created))}`,\n        `Author: ${extractUsername(annotation)}`,\n        page ? `Page: ${page}` : undefined,\n        `Type: ${annotationRole(annotation)}`,\n        annotationQuote ? `Quote: \"${annotationQuote}\"` : undefined,\n        `Comment: ${annotation.text}`,\n        annotation.tags.length > 0\n          ? `Tags: ${annotation.tags.join(', ')}`\n          : undefined,\n      ].filter(Boolean);\n\n      return trimAndDedent`\n        Annotation ${index + 1}:\n        ${lines.join('\\n')}`;\n    });\n\n    return trimAndDedent`\n      ${formatSortableDateTime(now)}\n      ${title}\n      ${uri}\n      Group: ${groupName}\n      Total users: ${uniqueUsers.length}\n      Users: ${uniqueUsers.join(', ')}\n      Total annotations: ${annotations.length}\n      Total replies: ${replies.length}\n      \n      ${annotationsAsText.join('\\n\\n')}`;\n  }\n\n  buildCSVExportContent(\n    annotations: APIAnnotationData[],\n    {\n      groupName = '',\n      defaultAuthority = '',\n      displayNamesEnabled = false,\n      separator = ',',\n    }: CSVExportOptions = {},\n  ): string {\n    const { uri, extractUsername } = this._exportCommon(annotations, {\n      displayNamesEnabled,\n      defaultAuthority,\n    });\n    const annotationToRow = (annotation: APIAnnotationData) =>\n      [\n        formatSortableDateTime(new Date(annotation.created)),\n        extractUsername(annotation),\n        pageLabel(annotation) ?? '',\n        uri,\n        groupName,\n        annotationRole(annotation),\n        quote(annotation) ?? '',\n        annotation.text,\n        annotation.tags.join(','),\n      ]\n        .map(value => escapeCSVValue(value, separator))\n        .join(separator);\n\n    const headers = [\n      'Created at',\n      'Author',\n      'Page',\n      'URL',\n      'Group',\n      'Type',\n      'Quote',\n      'Comment',\n      'Tags',\n    ].join(separator);\n    const annotationsContent = annotations\n      .map(anno => annotationToRow(anno))\n      .join('\\n');\n\n    return `${headers}\\n${annotationsContent}`;\n  }\n\n  buildHTMLExportContent(\n    annotations: APIAnnotationData[],\n    {\n      groupName = '',\n      displayNamesEnabled = false,\n      defaultAuthority = '',\n      /* istanbul ignore next - test seam */\n      now = new Date(),\n    }: HTMLExportOptions = {},\n  ): string {\n    const { uri, title, uniqueUsers, replies, extractUsername } =\n      this._exportCommon(annotations, {\n        displayNamesEnabled,\n        defaultAuthority,\n      });\n\n    return renderToString(\n      <html lang=\"en\">\n        <head>\n          <title>{`Annotations on \"${title}\"`}</title>\n          <meta charSet=\"UTF-8\" />\n        </head>\n        <body>\n          <section>\n            <h1>Summary</h1>\n            <p>\n              <time dateTime={now.toISOString()}>\n                {formatSortableDateTime(now)}\n              </time>\n            </p>\n            <p>\n              <strong>{title}</strong>\n            </p>\n            <p>\n              <a href={uri} target=\"_blank\" rel=\"noopener noreferrer\">\n                {uri}\n              </a>\n            </p>\n\n            <table>\n              <tbody style={{ verticalAlign: 'top' }}>\n                <tr>\n                  <td>Group:</td>\n                  <td>{groupName}</td>\n                </tr>\n                <tr>\n                  <td>Total users:</td>\n                  <td>{uniqueUsers.length}</td>\n                </tr>\n                <tr>\n                  <td>Users:</td>\n                  <td>{uniqueUsers.join(', ')}</td>\n                </tr>\n                <tr>\n                  <td>Total annotations:</td>\n                  <td>{annotations.length}</td>\n                </tr>\n                <tr>\n                  <td>Total replies:</td>\n                  <td>{replies.length}</td>\n                </tr>\n              </tbody>\n            </table>\n          </section>\n          <hr />\n          <section>\n            <h1>Annotations</h1>\n            {annotations.map((annotation, index) => {\n              const page = pageLabel(annotation);\n              const annotationQuote = quote(annotation);\n              const renderedComment = renderMathAndMarkdown(annotation.text);\n\n              // When the result of rendering the text's markdown is just a\n              // single paragraph, we fall back to the annotation text, to\n              // avoid extra margins added by some editors, like Google Docs\n              const comment =\n                renderedComment === `<p>${annotation.text}</p>`\n                  ? annotation.text\n                  : renderedComment;\n\n              return (\n                <article key={annotation.id}>\n                  <h2>Annotation {index + 1}:</h2>\n                  <table>\n                    <tbody style={{ verticalAlign: 'top' }}>\n                      <tr>\n                        <td>Created at:</td>\n                        <td>\n                          <time dateTime={annotation.created}>\n                            {formatSortableDateTime(\n                              new Date(annotation.created),\n                            )}\n                          </time>\n                        </td>\n                      </tr>\n                      <tr>\n                        <td>Author:</td>\n                        <td>{extractUsername(annotation)}</td>\n                      </tr>\n                      {page && (\n                        <tr>\n                          <td>Page:</td>\n                          <td>{page}</td>\n                        </tr>\n                      )}\n                      <tr>\n                        <td>Type:</td>\n                        <td>{annotationRole(annotation)}</td>\n                      </tr>\n                      {annotationQuote && (\n                        <tr>\n                          <td>Quote:</td>\n                          <td>\n                            <blockquote style={{ margin: 0 }}>\n                              {annotationQuote}\n                            </blockquote>\n                          </td>\n                        </tr>\n                      )}\n                      <tr>\n                        <td>Comment:</td>\n                        <td\n                          dangerouslySetInnerHTML={{\n                            __html: comment,\n                          }}\n                        />\n                      </tr>\n                      {annotation.tags.length > 0 && (\n                        <tr>\n                          <td>Tags:</td>\n                          <td>{annotation.tags.join(', ')}</td>\n                        </tr>\n                      )}\n                    </tbody>\n                  </table>\n                </article>\n              );\n            })}\n          </section>\n        </body>\n      </html>,\n      {},\n      { pretty: true },\n      // `renderToString` indents lines with tabs when using `pretty: true`.\n      // Replacing them with double spaces we avoid side effects when pasting\n      // the result in a web app.\n    ).replace(/\\t/g, '  ');\n  }\n\n  private _exportCommon(\n    annotations: APIAnnotationData[],\n    {\n      displayNamesEnabled,\n      defaultAuthority,\n    }: Required<Omit<CommonExportOptions, 'groupName'>>,\n  ) {\n    const [firstAnnotation] = annotations;\n    if (!firstAnnotation) {\n      throw new Error('No annotations to export');\n    }\n\n    const extractUsername = (annotation: APIAnnotationData) =>\n      annotationDisplayName(annotation, defaultAuthority, displayNamesEnabled);\n\n    const { uri, title } = documentMetadata(firstAnnotation);\n    const uniqueUsers = [\n      ...new Set(\n        annotations.map(anno => extractUsername(anno)).filter(Boolean),\n      ),\n    ];\n    const replies = annotations.filter(anno => isReply(anno));\n\n    return { uri, title, uniqueUsers, replies, extractUsername };\n  }\n}\n","export type CSVSeparator = ',' | '\\t';\n\n/**\n * Escape a CSV field value (see https://www.ietf.org/rfc/rfc4180.txt)\n *\n * - foo -> foo\n * - foo,bar -> \"foo,bar\"\n * - with \"quoted\" text -> \"with \"\"quoted\"\" text\"\n *\n * @param separator - Indicates the separator used in the CSV\n */\nexport function escapeCSVValue(value: string, separator: CSVSeparator): string {\n  const regexp = new RegExp(`[\"\\n\\r${separator}]`);\n  return regexp.test(value) ? `\"${value.replace(/\"/g, '\"\"')}\"` : value;\n}\n","/**\n * An error indicating a failed network request.\n *\n * Failures that this error can represent include:\n *\n *  - Failures to send an HTTP request\n *  - Requests that returned non-2xx responses\n *  - Failures to parse the response in the expected format (eg. JSON)\n */\nexport class FetchError extends Error {\n  url: string;\n  response: Response | null;\n  reason: string;\n\n  /**\n   * @param url - The URL that was requested. This may be different than the\n   *   final URL of the response if a redirect happened.\n   * @param response - The response to the `fetch` request or `null` if the\n   *   fetch failed\n   * @param reason - Additional details about the error. This might include\n   *   context of the network request or a server-provided error in the response.\n   */\n  constructor(url: string, response: Response | null, reason = '') {\n    let message = 'Network request failed';\n    if (response) {\n      message += ` (${response.status})`;\n    }\n    if (reason) {\n      message += `: ${reason}`;\n    }\n    super(message);\n\n    this.url = url;\n    this.response = response;\n    this.reason = reason;\n  }\n}\n\n/**\n * Execute a network request and return the parsed JSON response.\n *\n * fetchJSON wraps the browser's `fetch` API to standardize error handling when\n * making network requests that return JSON responses.\n *\n * @param init - Parameters for `fetch` request\n * @return Parsed JSON response or `null` if response status is 204 (No Content)\n * @throws {FetchError} if the request fails, returns a non-2xx status or a JSON\n *   response is expected but cannot be parsed\n */\nexport async function fetchJSON(\n  url: string,\n  init?: RequestInit,\n): Promise<unknown> {\n  let response;\n  try {\n    response = await fetch(url, init);\n  } catch (err) {\n    // If the request fails for any reason, wrap the result in a `FetchError`.\n    // Different browsers use different error messages for `fetch` failures, so\n    // wrapping the error allows downstream clients to handle this uniformly.\n    throw new FetchError(url, null, err.message);\n  }\n\n  if (response.status === 204 /* No Content */) {\n    return null;\n  }\n\n  // Attempt to parse a JSON response. This may fail even if the status code\n  // indicates success.\n  let data;\n  try {\n    data = await response.json();\n  } catch {\n    throw new FetchError(url, response, 'Failed to parse response');\n  }\n\n  // If the HTTP status indicates failure, attempt to extract a server-provided\n  // reason from the response, assuming certain conventions for the formatting\n  // of error responses.\n  if (!response.ok) {\n    throw new FetchError(url, response, data?.reason);\n  }\n\n  return data;\n}\n","import type {\n  Annotation,\n  Group,\n  RouteMap,\n  RouteMetadata,\n  Profile,\n  GroupMembers,\n} from '../../types/api';\nimport { stripInternalProperties } from '../helpers/strip-internal-properties';\nimport type { SidebarStore } from '../store';\nimport { fetchJSON } from '../util/fetch';\nimport { replaceURLParams } from '../util/url';\nimport type { APIRoutesService } from './api-routes';\nimport type { AuthService } from './auth';\n\n/**\n * Types of value that can be passed as a parameter to API calls.\n */\ntype Param = string | number | boolean;\n\n/**\n * Function which makes an API request.\n * @param params - A map of URL and query string parameters to include with the request.\n * @param data - The body of the request.\n */\ntype APICall<\n  Params = Record<string, Param | Param[]>,\n  Body = void,\n  Result = void,\n> = (params: Params, data?: Body, signal?: AbortSignal) => Promise<Result>;\n\n/**\n * Callbacks invoked at various points during an API call to get an access token etc.\n */\ntype APIMethodCallbacks = {\n  /** Function which acquires a valid access token for making an API request */\n  getAccessToken: () => Promise<string | null>;\n\n  /**\n   * Function that returns a per-session client ID to include with the request\n   * or `null`.\n   */\n  getClientId: () => string | null;\n\n  /** Callback invoked when the API request starts */\n  onRequestStarted: () => void;\n  /** Callback invoked when the API request finishes */\n  onRequestFinished: () => void;\n};\n\nfunction isRouteMetadata(\n  link: RouteMap | RouteMetadata,\n): link is RouteMetadata {\n  return 'url' in link;\n}\n\n/**\n * Lookup metadata for an API route in the result of an `/api/` response.\n *\n * @param route - Dot-separated path of route in `routeMap`\n */\nfunction findRouteMetadata(\n  routeMap: RouteMap,\n  route: string,\n): RouteMetadata | null {\n  let cursor = routeMap;\n  const pathSegments = route.split('.');\n  for (const [index, segment] of pathSegments.entries()) {\n    const nextCursor = cursor[segment];\n    if (!nextCursor || isRouteMetadata(nextCursor)) {\n      if (nextCursor && index === pathSegments.length - 1) {\n        // Found the RouteMetadata at the end of the path.\n        return nextCursor;\n      }\n      // Didn't find the route, or found a RouteMetadata before we reached the\n      // end of the path.\n      break;\n    }\n    cursor = nextCursor;\n  }\n  return null;\n}\n\n/**\n * Creates a function that will make an API call to a named route.\n *\n * @param links - API route data from API index endpoint (`/api/`)\n * @param route - The dotted path of the named API route (eg. `annotation.create`)\n * @return Function that makes an API call. The returned `APICall` has generic\n *   parameter, body and return types.\n *   This can be cast to an `APICall` with more specific types.\n */\nfunction createAPICall(\n  links: Promise<RouteMap>,\n  route: string,\n  {\n    getAccessToken,\n    getClientId,\n    onRequestStarted,\n    onRequestFinished,\n  }: APIMethodCallbacks,\n): APICall<Record<string, any>, Record<string, any> | void, unknown> {\n  return async (params, data, signal) => {\n    onRequestStarted();\n    try {\n      const [linksMap, token] = await Promise.all([links, getAccessToken()]);\n      const descriptor = findRouteMetadata(linksMap, route);\n      if (!descriptor) {\n        throw new Error(`Missing API route: ${route}`);\n      }\n\n      const headers: Record<string, string> = {\n        'Content-Type': 'application/json',\n        'Hypothesis-Client-Version': '__VERSION__',\n      };\n\n      if (token) {\n        headers.Authorization = 'Bearer ' + token;\n      }\n\n      const clientId = getClientId();\n      if (clientId) {\n        headers['X-Client-Id'] = clientId;\n      }\n\n      const { url, unusedParams: queryParams } = replaceURLParams(\n        descriptor.url,\n        params,\n      );\n\n      const apiURL = new URL(url);\n      for (const [key, value] of Object.entries(queryParams)) {\n        const values = Array.isArray(value) ? value : [value];\n        for (const item of values) {\n          // eslint-disable-next-line eqeqeq\n          if (item == null) {\n            // Skip all parameters with nullish values.\n            continue;\n          }\n          apiURL.searchParams.append(key, item.toString());\n        }\n      }\n\n      // nb. Don't \"simplify\" the lines below to `return fetchJSON(...)` as this\n      // would cause `onRequestFinished` to be called before the API response\n      // is received.\n      return await fetchJSON(apiURL.toString(), {\n        body: data ? JSON.stringify(stripInternalProperties(data)) : null,\n        headers,\n        method: descriptor.method,\n        signal,\n      });\n    } finally {\n      onRequestFinished();\n    }\n  };\n}\n\ntype AnnotationSearchResult = {\n  rows: Annotation[];\n  replies: Annotation[];\n  total: number;\n};\n\ntype IDParam = {\n  id: string;\n};\n\ntype ListGroupParams = {\n  authority?: string;\n  document_uri?: string;\n  expand?: string[];\n};\n\nexport type AnalyticsEventName = 'client.realtime.apply_updates';\n\nexport type AnalyticsEvent = {\n  event: AnalyticsEventName;\n};\n\n/**\n * API client for the Hypothesis REST API.\n *\n * Returns an object that with keys that match the routes in\n * the Hypothesis API (see http://h.readthedocs.io/en/latest/api/).\n * @see APICall for the syntax of API calls. For example:\n *\n * ```\n * api.annotations.update({ id: '1234' }, annotation).then(ann => {\n *   // Do something with the updated annotation.\n * }).catch(err => {\n *   // Do something if the API call fails.\n * });\n * ```\n *\n * This service makes authenticated calls to the API, using `AuthService`\n * to get auth tokens. The URLs for API endpoints are provided by the `APIRoutesService`\n * service.\n */\n// @inject\nexport class APIService {\n  /**\n   * Client session identifier included with requests. Used by the backend\n   * to associate API requests with WebSocket connections from the same client.\n   */\n  private _clientId: string | null;\n\n  search: APICall<Record<string, unknown>, void, AnnotationSearchResult>;\n  annotation: {\n    create: APICall<Record<string, unknown>, Partial<Annotation>, Annotation>;\n    delete: APICall<IDParam>;\n    get: APICall<IDParam, void, Annotation>;\n    update: APICall<IDParam, Partial<Annotation>, Annotation>;\n    flag: APICall<IDParam>;\n    hide: APICall<IDParam>;\n    unhide: APICall<IDParam>;\n  };\n  group: {\n    member: {\n      delete: APICall<{ pubid: string; userid: string }>;\n    };\n    members: {\n      read: APICall<\n        {\n          pubid: string;\n          'page[number]'?: number;\n          'page[size]'?: number;\n        },\n        void,\n        GroupMembers\n      >;\n    };\n    read: APICall<{ id: string; expand: string[] }, void, Group>;\n  };\n  groups: {\n    list: APICall<ListGroupParams, void, Group[]>;\n  };\n  profile: {\n    groups: {\n      read: APICall<{ expand: string[] }, void, Group[]>;\n    };\n    read: APICall<{ authority?: string }, void, Profile>;\n    update: APICall<Record<string, unknown>, Partial<Profile>, Profile>;\n  };\n  analytics: {\n    events: {\n      create: APICall<Record<string, unknown>, AnalyticsEvent>;\n    };\n  };\n\n  constructor(\n    apiRoutes: APIRoutesService,\n    auth: AuthService,\n    store: SidebarStore,\n  ) {\n    this._clientId = null;\n\n    const links = apiRoutes.routes();\n    const getClientId = () => this._clientId;\n    const apiCall = (route: string) =>\n      createAPICall(links, route, {\n        getAccessToken: () => auth.getAccessToken(),\n        getClientId,\n        onRequestStarted: store.apiRequestStarted,\n        onRequestFinished: store.apiRequestFinished,\n      });\n\n    // Define available API calls.\n    //\n    // The type syntax is APICall<Parameters, Body, Result>, where `void` means\n    // no body / empty response.\n\n    this.search = apiCall('search') as APICall<\n      Record<string, unknown>,\n      void,\n      AnnotationSearchResult\n    >;\n    this.annotation = {\n      create: apiCall('annotation.create') as APICall<\n        Record<string, unknown>,\n        Partial<Annotation>,\n        Annotation\n      >,\n      delete: apiCall('annotation.delete') as APICall<IDParam>,\n      get: apiCall('annotation.read') as APICall<IDParam, void, Annotation>,\n      update: apiCall('annotation.update') as APICall<\n        IDParam,\n        Partial<Annotation>,\n        Annotation\n      >,\n      flag: apiCall('annotation.flag') as APICall<IDParam>,\n      hide: apiCall('annotation.hide') as APICall<IDParam>,\n      unhide: apiCall('annotation.unhide') as APICall<IDParam>,\n    };\n    this.group = {\n      member: {\n        delete: apiCall('group.member.delete') as APICall<{\n          pubid: string;\n          userid: string;\n        }>,\n      },\n      members: {\n        read: apiCall('group.members.read') as APICall<\n          {\n            pubid: string;\n            'page[number]'?: number;\n            'page[size]'?: number;\n          },\n          void,\n          GroupMembers\n        >,\n      },\n      read: apiCall('group.read') as APICall<\n        { id: string; expand: string[] },\n        void,\n        Group\n      >,\n    };\n    this.groups = {\n      list: apiCall('groups.read') as APICall<ListGroupParams, void, Group[]>,\n    };\n    this.profile = {\n      groups: {\n        read: apiCall('profile.groups.read') as APICall<\n          { expand: string[] },\n          void,\n          Group[]\n        >,\n      },\n      read: apiCall('profile.read') as APICall<\n        { authority?: string },\n        void,\n        Profile\n      >,\n      update: apiCall('profile.update') as APICall<\n        Record<string, unknown>,\n        Partial<Profile>,\n        Profile\n      >,\n    };\n    this.analytics = {\n      events: {\n        create: apiCall('analytics.events.create') as APICall<\n          Record<string, unknown>,\n          AnalyticsEvent\n        >,\n      },\n    };\n  }\n\n  /**\n   * Set the \"client ID\" sent with API requests.\n   *\n   * This is a per-session unique ID which the client sends with REST API\n   * requests and in the configuration for the real-time API to prevent the\n   * client from receiving real-time notifications about its own actions.\n   */\n  setClientId(clientId: string) {\n    this._clientId = clientId;\n  }\n}\n","var RetryOperation = require('./retry_operation');\n\nexports.operation = function(options) {\n  var timeouts = exports.timeouts(options);\n  return new RetryOperation(timeouts, {\n      forever: options && (options.forever || options.retries === Infinity),\n      unref: options && options.unref,\n      maxRetryTime: options && options.maxRetryTime\n  });\n};\n\nexports.timeouts = function(options) {\n  if (options instanceof Array) {\n    return [].concat(options);\n  }\n\n  var opts = {\n    retries: 10,\n    factor: 2,\n    minTimeout: 1 * 1000,\n    maxTimeout: Infinity,\n    randomize: false\n  };\n  for (var key in options) {\n    opts[key] = options[key];\n  }\n\n  if (opts.minTimeout > opts.maxTimeout) {\n    throw new Error('minTimeout is greater than maxTimeout');\n  }\n\n  var timeouts = [];\n  for (var i = 0; i < opts.retries; i++) {\n    timeouts.push(this.createTimeout(i, opts));\n  }\n\n  if (options && options.forever && !timeouts.length) {\n    timeouts.push(this.createTimeout(i, opts));\n  }\n\n  // sort the array numerically ascending\n  timeouts.sort(function(a,b) {\n    return a - b;\n  });\n\n  return timeouts;\n};\n\nexports.createTimeout = function(attempt, opts) {\n  var random = (opts.randomize)\n    ? (Math.random() + 1)\n    : 1;\n\n  var timeout = Math.round(random * Math.max(opts.minTimeout, 1) * Math.pow(opts.factor, attempt));\n  timeout = Math.min(timeout, opts.maxTimeout);\n\n  return timeout;\n};\n\nexports.wrap = function(obj, options, methods) {\n  if (options instanceof Array) {\n    methods = options;\n    options = null;\n  }\n\n  if (!methods) {\n    methods = [];\n    for (var key in obj) {\n      if (typeof obj[key] === 'function') {\n        methods.push(key);\n      }\n    }\n  }\n\n  for (var i = 0; i < methods.length; i++) {\n    var method   = methods[i];\n    var original = obj[method];\n\n    obj[method] = function retryWrapper(original) {\n      var op       = exports.operation(options);\n      var args     = Array.prototype.slice.call(arguments, 1);\n      var callback = args.pop();\n\n      args.push(function(err) {\n        if (op.retry(err)) {\n          return;\n        }\n        if (err) {\n          arguments[0] = op.mainError();\n        }\n        callback.apply(this, arguments);\n      });\n\n      op.attempt(function() {\n        original.apply(obj, args);\n      });\n    }.bind(obj, original);\n    obj[method].options = options;\n  }\n};\n","function RetryOperation(timeouts, options) {\n  // Compatibility for the old (timeouts, retryForever) signature\n  if (typeof options === 'boolean') {\n    options = { forever: options };\n  }\n\n  this._originalTimeouts = JSON.parse(JSON.stringify(timeouts));\n  this._timeouts = timeouts;\n  this._options = options || {};\n  this._maxRetryTime = options && options.maxRetryTime || Infinity;\n  this._fn = null;\n  this._errors = [];\n  this._attempts = 1;\n  this._operationTimeout = null;\n  this._operationTimeoutCb = null;\n  this._timeout = null;\n  this._operationStart = null;\n  this._timer = null;\n\n  if (this._options.forever) {\n    this._cachedTimeouts = this._timeouts.slice(0);\n  }\n}\nmodule.exports = RetryOperation;\n\nRetryOperation.prototype.reset = function() {\n  this._attempts = 1;\n  this._timeouts = this._originalTimeouts.slice(0);\n}\n\nRetryOperation.prototype.stop = function() {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n  if (this._timer) {\n    clearTimeout(this._timer);\n  }\n\n  this._timeouts       = [];\n  this._cachedTimeouts = null;\n};\n\nRetryOperation.prototype.retry = function(err) {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n\n  if (!err) {\n    return false;\n  }\n  var currentTime = new Date().getTime();\n  if (err && currentTime - this._operationStart >= this._maxRetryTime) {\n    this._errors.push(err);\n    this._errors.unshift(new Error('RetryOperation timeout occurred'));\n    return false;\n  }\n\n  this._errors.push(err);\n\n  var timeout = this._timeouts.shift();\n  if (timeout === undefined) {\n    if (this._cachedTimeouts) {\n      // retry forever, only keep last error\n      this._errors.splice(0, this._errors.length - 1);\n      timeout = this._cachedTimeouts.slice(-1);\n    } else {\n      return false;\n    }\n  }\n\n  var self = this;\n  this._timer = setTimeout(function() {\n    self._attempts++;\n\n    if (self._operationTimeoutCb) {\n      self._timeout = setTimeout(function() {\n        self._operationTimeoutCb(self._attempts);\n      }, self._operationTimeout);\n\n      if (self._options.unref) {\n          self._timeout.unref();\n      }\n    }\n\n    self._fn(self._attempts);\n  }, timeout);\n\n  if (this._options.unref) {\n      this._timer.unref();\n  }\n\n  return true;\n};\n\nRetryOperation.prototype.attempt = function(fn, timeoutOps) {\n  this._fn = fn;\n\n  if (timeoutOps) {\n    if (timeoutOps.timeout) {\n      this._operationTimeout = timeoutOps.timeout;\n    }\n    if (timeoutOps.cb) {\n      this._operationTimeoutCb = timeoutOps.cb;\n    }\n  }\n\n  var self = this;\n  if (this._operationTimeoutCb) {\n    this._timeout = setTimeout(function() {\n      self._operationTimeoutCb();\n    }, self._operationTimeout);\n  }\n\n  this._operationStart = new Date().getTime();\n\n  this._fn(this._attempts);\n};\n\nRetryOperation.prototype.try = function(fn) {\n  console.log('Using RetryOperation.try() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = function(fn) {\n  console.log('Using RetryOperation.start() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = RetryOperation.prototype.try;\n\nRetryOperation.prototype.errors = function() {\n  return this._errors;\n};\n\nRetryOperation.prototype.attempts = function() {\n  return this._attempts;\n};\n\nRetryOperation.prototype.mainError = function() {\n  if (this._errors.length === 0) {\n    return null;\n  }\n\n  var counts = {};\n  var mainError = null;\n  var mainErrorCount = 0;\n\n  for (var i = 0; i < this._errors.length; i++) {\n    var error = this._errors[i];\n    var message = error.message;\n    var count = (counts[message] || 0) + 1;\n\n    counts[message] = count;\n\n    if (count >= mainErrorCount) {\n      mainError = error;\n      mainErrorCount = count;\n    }\n  }\n\n  return mainError;\n};\n","module.exports = require('./lib/retry');","import retry from 'retry';\n\n/**\n * Options passed that control how the operation is retried.\n *\n * See https://github.com/tim-kos/node-retry#retrytimeoutsoptions\n */\nexport type RetryOptions = {\n  minTimeout: number;\n};\n\n/**\n * Retry a Promise-returning operation until it succeeds or\n * fails after a set number of attempts.\n *\n * @param callback - The operation to retry\n * @return Result of first successful `callback` call (ie. that did not reject)\n */\nexport function retryPromiseOperation<T>(\n  callback: () => Promise<T>,\n  options?: RetryOptions,\n): Promise<T> {\n  return new Promise((resolve, reject) => {\n    const operation = retry.operation(options);\n    operation.attempt(async () => {\n      try {\n        const result = await callback();\n\n        // After a successful call `retry` still needs to be invoked without\n        // arguments to clear internal timeouts.\n        operation.retry();\n\n        resolve(result);\n      } catch (err) {\n        if (!operation.retry(err)) {\n          reject(err);\n        }\n      }\n    });\n  });\n}\n","import type {\n  IndexResponse,\n  LinksResponse,\n  RouteMap,\n  RouteMetadata,\n} from '../../types/api';\nimport type { SidebarSettings } from '../../types/config';\nimport { fetchJSON } from '../util/fetch';\nimport { retryPromiseOperation } from '../util/retry';\n\n/**\n * Fetch an API metadata file, retrying the operation if it fails.\n */\nfunction getJSON<T>(url: string): Promise<T> {\n  return retryPromiseOperation(\n    () =>\n      // nb. The `/api/` and `/api/links` routes are fetched without specifying\n      // any additional headers/config so that we can use `<link rel=\"preload\">` in\n      // the `/app.html` response to fetch them early, while the client JS app\n      // is loading.\n      fetchJSON(url) as Promise<T>,\n  );\n}\n\n/**\n * A service which fetches and caches API route metadata.\n */\n// @inject\nexport class APIRoutesService {\n  private _apiURL: string;\n  private _routeCache: Promise<RouteMap> | null;\n  private _linkCache: Promise<LinksResponse> | null;\n\n  constructor(settings: SidebarSettings) {\n    this._apiURL = settings.apiUrl;\n    this._routeCache = null;\n    this._linkCache = null;\n  }\n\n  /**\n   * Fetch and cache API route metadata.\n   *\n   * Routes are fetched without any authentication and therefore assumed to be\n   * the same regardless of whether the user is authenticated or not.\n   *\n   * @return Map of routes to route metadata.\n   */\n  routes(): Promise<RouteMap> {\n    if (!this._routeCache) {\n      this._routeCache = getJSON<IndexResponse>(this._apiURL).then(\n        result => result.links,\n      );\n    }\n    return this._routeCache;\n  }\n\n  /**\n   * Fetch and cache service page links from the API.\n   */\n  links(): Promise<LinksResponse> {\n    if (!this._linkCache) {\n      this._linkCache = this.routes().then(async routes => {\n        const linksRoute = routes.links as RouteMetadata;\n        return getJSON<LinksResponse>(linksRoute.url);\n      });\n    }\n    return this._linkCache;\n  }\n}\n","import { generateHexString } from '../../shared/random';\nimport { fetchJSON } from './fetch';\n\n/**\n * OAuth access token response.\n *\n * See https://datatracker.ietf.org/doc/html/rfc6749#section-5.1\n */\ntype AccessTokenResponse = {\n  access_token: string;\n  expires_in: number;\n  refresh_token: string;\n};\n\n/**\n * OAuth authorization code response.\n *\n * See https://datatracker.ietf.org/doc/html/rfc6749#section-4.1.2\n */\ntype AuthorizationCodeResponse = {\n  code: string;\n  state?: string;\n\n  /** Non-standard field to differentiate this from an unsuccessful response. */\n  type: 'authorization_response';\n};\n\n/**\n * Response sent back from popup window if the user closes the popup before\n * completing authorization.\n */\ntype AuthorizationCanceledResponse = {\n  state?: string;\n  type: 'authorization_canceled';\n};\n\n/**\n * Response from the authorization popup window.\n */\ntype AuthorizationResponse =\n  | AuthorizationCodeResponse\n  | AuthorizationCanceledResponse;\n\n/**\n * Access token and associated metadata received from the Hypothesis server.\n */\nexport type TokenInfo = {\n  /**\n   * The access token that should be passed to the API in an `Authorization: Bearer ${TOKEN}`\n   * header.\n   */\n  accessToken: string;\n\n  /**\n   * The date when the timestamp will expire.\n   *\n   * This uses the same epoch and units as {@link Date.now}.\n   */\n  expiresAt: number;\n\n  /** The refresh token that can be used to get a new access token. */\n  refreshToken: string;\n};\n\n/**\n * Error thrown if fetching or revoking an access token fails.\n */\nexport class TokenError extends Error {\n  /**\n   * Original cause of this error.\n   *\n   * See also https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/cause.\n   */\n  cause: Error;\n\n  /**\n   * @param cause - The error which caused the token fetch to fail\n   */\n  constructor(message: string, cause: Error) {\n    super(message);\n    this.cause = cause;\n  }\n}\n\n/**\n * OAuthClient configuration.\n */\nexport type Config = {\n  /** OAuth client ID */\n  clientId: string;\n\n  /**\n   * OAuth token exchange / refresh endpoint.\n   *\n   * See https://datatracker.ietf.org/doc/html/rfc6749#section-3.2.\n   */\n  tokenEndpoint: string;\n\n  /**\n   * OAuth authorization endpoint.\n   *\n   * See https://datatracker.ietf.org/doc/html/rfc6749#section-3.1.\n   */\n  authorizationEndpoint: string;\n\n  /** RFC 7009 token revocation endpoint. */\n  revokeEndpoint: string;\n};\n\n/**\n * OAuthClient handles interaction with the annotation service's OAuth\n * endpoints.\n */\nexport class OAuthClient {\n  clientId: string;\n  tokenEndpoint: string;\n  authorizationEndpoint: string;\n  revokeEndpoint: string;\n\n  /**\n   * Create a new OAuthClient\n   */\n  constructor(config: Config) {\n    this.clientId = config.clientId;\n    this.tokenEndpoint = config.tokenEndpoint;\n    this.authorizationEndpoint = config.authorizationEndpoint;\n    this.revokeEndpoint = config.revokeEndpoint;\n  }\n\n  /**\n   * Exchange an authorization code for access and refresh tokens.\n   */\n  exchangeAuthCode(code: string): Promise<TokenInfo> {\n    return this._getAccessToken({\n      client_id: this.clientId,\n      grant_type: 'authorization_code',\n      code,\n    });\n  }\n\n  /**\n   * Exchange a grant token for access and refresh tokens.\n   *\n   * See https://tools.ietf.org/html/rfc7523#section-4\n   */\n  exchangeGrantToken(token: string): Promise<TokenInfo> {\n    return this._getAccessToken({\n      grant_type: 'urn:ietf:params:oauth:grant-type:jwt-bearer',\n      assertion: token,\n    });\n  }\n\n  /**\n   * Refresh an access and refresh token pair.\n   *\n   * See https://tools.ietf.org/html/rfc6749#section-6\n   */\n  refreshToken(refreshToken: string): Promise<TokenInfo> {\n    return this._getAccessToken({\n      grant_type: 'refresh_token',\n      refresh_token: refreshToken,\n    });\n  }\n\n  /**\n   * Revoke an access and refresh token pair.\n   */\n  async revokeToken(accessToken: string): Promise<void> {\n    try {\n      await this._formPost(this.revokeEndpoint, { token: accessToken });\n    } catch (err) {\n      throw new TokenError('Failed to revoke access token', err);\n    }\n  }\n\n  /**\n   * Prompt the user for permission to access their data.\n   *\n   * @param $window - Window which will receive the auth response.\n   * @return - Authorization code which can be passed to {@link exchangeAuthCode}.\n   */\n  authorize($window: Window): Promise<string> {\n    // Random state string used to check that auth messages came from the popup\n    // window that we opened.\n    //\n    // See https://tools.ietf.org/html/rfc6749#section-4.1.1.\n    const state = generateHexString(16);\n\n    // Promise which resolves or rejects when the user accepts or closes the\n    // auth popup.\n    const authResponse = new Promise<AuthorizationCodeResponse>(\n      (resolve, reject) => {\n        function authRespListener(event: MessageEvent) {\n          if (typeof event.data !== 'object') {\n            return;\n          }\n          const response = event.data as AuthorizationResponse;\n          if (response.state !== state) {\n            // This message came from a different popup window.\n            return;\n          }\n\n          if (response.type === 'authorization_response') {\n            resolve(event.data);\n          }\n          if (response.type === 'authorization_canceled') {\n            reject(new Error('Authorization window was closed'));\n          }\n          $window.removeEventListener('message', authRespListener);\n        }\n        $window.addEventListener('message', authRespListener);\n      },\n    );\n\n    // Authorize user and retrieve grant token\n    const authURL = new URL(this.authorizationEndpoint);\n    authURL.searchParams.set('client_id', this.clientId);\n    authURL.searchParams.set('origin', $window.location.origin);\n    authURL.searchParams.set('response_mode', 'web_message');\n    authURL.searchParams.set('response_type', 'code');\n    authURL.searchParams.set('state', state);\n\n    // In Chrome & Firefox the sizes passed to `window.open` are used for the\n    // viewport size. In Safari the size is used for the window size including\n    // title bar etc. There is enough vertical space at the bottom to allow for\n    // this.\n    //\n    // See https://bugs.webkit.org/show_bug.cgi?id=143678\n    const width = 475;\n    const height = 430;\n    const left = $window.screen.width / 2 - width / 2;\n    const top = $window.screen.height / 2 - height / 2;\n\n    // Generate settings for `window.open` in the required comma-separated\n    // key=value format.\n    const authWindowSettings = `left=${left},top=${top},width=${width},height=${height}`;\n    const authWindow = $window.open(\n      authURL.toString(),\n      'Log in to Hypothesis',\n      authWindowSettings,\n    );\n\n    if (!authWindow) {\n      throw new Error('Failed to open login window');\n    }\n\n    return authResponse.then(rsp => rsp.code);\n  }\n\n  /**\n   * Make an `application/x-www-form-urlencoded` POST request.\n   *\n   * @param data - Form field name/value dictionary\n   */\n  private async _formPost(url: string, data: Record<string, string>) {\n    const params = new URLSearchParams();\n    for (const [key, value] of Object.entries(data)) {\n      params.set(key, value);\n    }\n\n    // Tests currently expect sorted parameters.\n    params.sort();\n\n    const headers = {\n      'Content-Type': 'application/x-www-form-urlencoded',\n    };\n    return fetchJSON(url, {\n      method: 'POST',\n      headers,\n      body: params.toString(),\n    });\n  }\n\n  /**\n   * Fetch an OAuth access token.\n   *\n   * See https://datatracker.ietf.org/doc/html/rfc6749#section-4.1.3\n   *\n   * @param data - Fields for form POST request\n   */\n  private async _getAccessToken(\n    data: Record<string, string>,\n  ): Promise<TokenInfo> {\n    let response;\n    try {\n      response = (await this._formPost(\n        this.tokenEndpoint,\n        data,\n      )) as AccessTokenResponse;\n    } catch (err) {\n      throw new TokenError('Failed to fetch access token', err);\n    }\n\n    return {\n      accessToken: response.access_token,\n\n      // Set the expiry date to some time slightly before that implied by\n      // `expires_in` to account for the delay in the client receiving the\n      // response.\n      expiresAt: Date.now() + (response.expires_in - 10) * 1000,\n\n      refreshToken: response.refresh_token,\n    };\n  }\n}\n","import { EventEmitter } from '../../shared/event-emitter';\nimport type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\nimport { OAuthClient } from '../util/oauth-client';\nimport type { TokenInfo } from '../util/oauth-client';\nimport { resolve } from '../util/url';\nimport type { APIRoutesService } from './api-routes';\nimport type { LocalStorageService } from './local-storage';\nimport type { ToastMessengerService } from './toast-messenger';\n\ntype RefreshOptions = {\n  /** True if access tokens should be persisted for use in future sessions. */\n  persist: boolean;\n};\n\nconst isTokenInfo = (token: unknown): token is TokenInfo =>\n  !!token &&\n  typeof token === 'object' &&\n  'accessToken' in token &&\n  typeof token.accessToken === 'string' &&\n  'refreshToken' in token &&\n  typeof token.refreshToken === 'string' &&\n  'expiresAt' in token &&\n  typeof token.expiresAt === 'number';\n\nexport type Events = {\n  oauthTokensChanged(): void;\n};\n\n/**\n * Authorization service.\n *\n * This service is responsible for acquiring access tokens for making API\n * requests and making them available via the `getAccessToken()` method.\n *\n * Access tokens are acquired via the OAuth authorization flow, loading valid\n * tokens from a previous session or, on some websites, by exchanging a grant\n * token provided by the host page.\n *\n * Interaction with OAuth endpoints in the annotation service is delegated to\n * the `OAuthClient` class.\n *\n * @inject\n */\nexport class AuthService extends EventEmitter<Events> {\n  /**\n   * Authorization code from auth popup window. Set by the login method\n   * and exchanged for an Access Token on the next API call.\n   */\n  private _authCode: string | null;\n\n  /** Cached OAuthClient */\n  private _client: OAuthClient | null;\n\n  /**\n   * Token info retrieved via `POST /api/token` endpoint.\n   *\n   * Resolves to `null` if the user is not logged in.\n   */\n  private _tokenInfoPromise: Promise<TokenInfo | null> | null;\n\n  // Injected services\n  private _apiRoutes: APIRoutesService;\n  private _localStorage: LocalStorageService;\n  private _settings: SidebarSettings;\n  private _toastMessenger: ToastMessengerService;\n  private _window: Window;\n\n  constructor(\n    $window: Window,\n    apiRoutes: APIRoutesService,\n    localStorage: LocalStorageService,\n    settings: SidebarSettings,\n    toastMessenger: ToastMessengerService,\n  ) {\n    super();\n\n    this._authCode = null;\n    this._client = null;\n    this._tokenInfoPromise = null;\n\n    this._apiRoutes = apiRoutes;\n    this._localStorage = localStorage;\n    this._settings = settings;\n    this._toastMessenger = toastMessenger;\n    this._window = $window;\n\n    this._listenForTokenStorageEvents();\n  }\n\n  /**\n   * Listen for updated access and refresh tokens saved by other instances of\n   * the client.\n   */\n  private _listenForTokenStorageEvents() {\n    this._window.addEventListener('storage', ({ key }) => {\n      if (key === this._storageKey()) {\n        // Reset cached token information. Tokens will be reloaded from storage\n        // on the next call to `getAccessToken()`.\n        this._tokenInfoPromise = null;\n        this.emit('oauthTokensChanged');\n      }\n    });\n  }\n\n  /**\n   * Fetch the last-saved access/refresh tokens from local storage.\n   */\n  private _loadToken() {\n    const token = this._localStorage.getObject(this._storageKey());\n\n    if (!isTokenInfo(token)) {\n      return null;\n    }\n\n    return {\n      accessToken: token.accessToken,\n      refreshToken: token.refreshToken,\n      expiresAt: token.expiresAt,\n    };\n  }\n\n  /**\n   * Return a cached OAuthClient if available, or configure one and return it.\n   */\n  async _oauthClient() {\n    if (this._client) {\n      return this._client;\n    }\n\n    const links = await this._apiRoutes.links();\n    this._client = new OAuthClient({\n      clientId: this._settings.oauthClientId,\n      authorizationEndpoint: links['oauth.authorize'],\n      revokeEndpoint: links['oauth.revoke'],\n      tokenEndpoint: resolve('token', this._settings.apiUrl),\n    });\n    return this._client;\n  }\n\n  /**\n   * Exchange the authorization code retrieved from login popup for a new\n   * access token.\n   */\n  private async _exchangeAuthCodeForToken(code: string) {\n    const client = await this._oauthClient();\n    const tokenInfo = await client.exchangeAuthCode(code);\n    this._saveToken(tokenInfo);\n    return tokenInfo;\n  }\n\n  /**\n   * Attempt to exchange a grant token for an access token.\n   *\n   * Publishers or other embedders can set a grant token for a user in service\n   * configuration.\n   */\n  private async _exchangeGrantToken(grantToken: string) {\n    const client = await this._oauthClient();\n    try {\n      return await client.exchangeGrantToken(grantToken);\n    } catch (err) {\n      this._toastMessenger.error(\n        `Hypothesis login lost: You must reload the page to annotate.`,\n        {\n          autoDismiss: false,\n        },\n      );\n      throw err;\n    }\n  }\n\n  /**\n   * Retrieve any grant token set by service configuration\n   */\n  private _getGrantToken(): string | undefined {\n    return serviceConfig(this._settings)?.grantToken;\n  }\n\n  /**\n   * Return the storage key used for storing access/refresh token data for a\n   * given annotation service.\n   */\n  private _storageKey() {\n    // Use a unique key per annotation service. Currently OAuth tokens are only\n    // persisted for the default annotation service. If in future we support\n    // logging into other services from the client, this function will need to\n    // take the API URL as an argument.\n    let apiDomain = new URL(this._settings.apiUrl).hostname;\n\n    // Percent-encode periods to avoid conflict with section delimeters.\n    apiDomain = apiDomain.replace(/\\./g, '%2E');\n\n    return `hypothesis.oauth.${apiDomain}.token`;\n  }\n\n  /**\n   * Persist access and refresh tokens for later reuse\n   */\n  private _saveToken(token: TokenInfo) {\n    this._localStorage.setObject(this._storageKey(), token);\n  }\n\n  /**\n   * Exchange a refresh token for a new access token and refresh token pair\n   */\n  private async _refreshAccessToken(\n    refreshToken: string,\n    options: RefreshOptions,\n  ): Promise<TokenInfo | null> {\n    const client = await this._oauthClient();\n\n    let token;\n    try {\n      token = await client.refreshToken(refreshToken);\n\n      // Sanity check that prevents an infinite loop. Mostly useful in\n      // tests.\n      if (Date.now() > token.expiresAt) {\n        /* istanbul ignore next */\n        throw new Error('Refreshed token expired in the past');\n      }\n    } catch {\n      // If refreshing the token fails, the user is simply logged out.\n      return null;\n    }\n\n    if (options.persist) {\n      this._saveToken(token);\n    }\n\n    return token;\n  }\n\n  /**\n   * Retrieve an access token for use with the API\n   */\n  async getAccessToken(): Promise<string | null> {\n    if (!this._tokenInfoPromise) {\n      // No access token is set: determine how to get one. This will depend on\n      // which type of login is being used\n      const grantToken = this._getGrantToken();\n      if (grantToken !== undefined) {\n        // The user is logged in through a publisher/embedder's site and\n        // a grant token has been included in service configuration\n        if (!grantToken) {\n          // Grant token is present but empty: this user is anonymous on the\n          // publisher/embedder website\n          this._tokenInfoPromise = Promise.resolve(null);\n        } else {\n          this._tokenInfoPromise = this._exchangeGrantToken(grantToken);\n        }\n      } else if (this._authCode) {\n        // User has authorized through pop-up window and we have an\n        // authorization code we can exchange for an access token\n        this._tokenInfoPromise = this._exchangeAuthCodeForToken(this._authCode);\n        this._authCode = null; // Consume the single-use auth code\n      } else {\n        // Attempt to retrieve stored token from previous session\n        this._tokenInfoPromise = Promise.resolve(this._loadToken());\n      }\n    }\n\n    // Wait for the token to resolve. Ensure that it is valid and that\n    // it wasn't invalidated while it was being fetched. Refresh if needed.\n\n    const origToken = this._tokenInfoPromise;\n    const token = await this._tokenInfoPromise;\n\n    if (!token) {\n      // No token available. User will need to log in.\n      return null;\n    }\n\n    if (origToken !== this._tokenInfoPromise) {\n      // The token source was changed while waiting for the token to be fetched.\n      // This can happen for various reasons. We'll just need to try again.\n      return this.getAccessToken();\n    }\n\n    if (Date.now() > token.expiresAt) {\n      // Token has expired, so we need to fetch a new one.\n      const grantToken = this._getGrantToken();\n      this._tokenInfoPromise = this._refreshAccessToken(token.refreshToken, {\n        // Only persist tokens if automatic login is not being used.\n        persist: typeof grantToken === 'undefined',\n      });\n      return this.getAccessToken();\n    }\n\n    return token.accessToken;\n  }\n\n  /**\n   * Log in to the service using OAuth.\n   *\n   * Authorize through OAuthClient (this shows a pop-up window to the user).\n   * Store the resulting authorization code to exchange for an access token in\n   * the next API call ( {@see getAccessToken} )\n   */\n  async login() {\n    // Any async steps before the call to `client.authorize` must complete\n    // in less than ~1 second, otherwise the browser's popup blocker may block\n    // the popup.\n    //\n    // `oauthClient` is async in case it needs to fetch links from the API.\n    // This should already have happened by the time this function is called\n    // however, so it will just be returning a cached value.\n    const client = await this._oauthClient();\n    const authCode = await client.authorize(this._window);\n\n    // Save the auth code. It will be exchanged for an access token when the\n    // next API request is made.\n    this._authCode = authCode;\n    this._tokenInfoPromise = null;\n  }\n\n  /**\n   * Log out of the service (in the client only).\n   *\n   * This revokes and then forgets any OAuth credentials that the user has.\n   */\n  async logout() {\n    const [token, client] = await Promise.all([\n      this._tokenInfoPromise,\n      this._oauthClient(),\n    ]);\n\n    if (token) {\n      await client.revokeToken(token.accessToken);\n    }\n\n    this._tokenInfoPromise = null;\n\n    this._localStorage.removeItem(this._storageKey());\n  }\n}\n","import { quote } from '../helpers/annotation-metadata';\nimport type { SidebarStore } from '../store';\nimport { retryPromiseOperation } from '../util/retry';\nimport type { AnnotationsService } from './annotations';\nimport type { ToastMessengerService } from './toast-messenger';\n\n/**\n * A service for automatically saving new highlights.\n *\n * @inject\n */\nexport class AutosaveService {\n  private _annotationsService: AnnotationsService;\n  private _toastMessenger: ToastMessengerService;\n  private _store: SidebarStore;\n\n  /** A set of annotation $tags that have save requests in-flight */\n  private _saving: Set<string>;\n  /** A set of annotation $tags that have failed to save after retries */\n  private _failed: Set<string>;\n\n  constructor(\n    annotationsService: AnnotationsService,\n    toastMessenger: ToastMessengerService,\n    store: SidebarStore,\n  ) {\n    this._annotationsService = annotationsService;\n    this._toastMessenger = toastMessenger;\n    this._store = store;\n\n    this._saving = new Set();\n    this._failed = new Set();\n  }\n\n  /**\n   * Begin watching the store for new unsaved highlights and save them in\n   * response.\n   */\n  init() {\n    /**\n     * Determine whether we should try to send a save request for the highlight\n     * indicated by `htag`\n     *\n     * @param htag - The local unique identifier for the unsaved highlight\n     */\n    const shouldSaveHighlight = (htag: string): boolean => {\n      return !this._saving.has(htag) && !this._failed.has(htag);\n    };\n\n    /**\n     * Store-subscribed call back. Automatically save new highlights.\n     */\n    const autosaveNewHighlights = () => {\n      const newHighlights = this._store.newHighlights();\n\n      newHighlights.forEach(highlight => {\n        // Because this is a new annotation object, it does not yet have an `id`\n        // property. Use the local `$tag` for uniqueness instead.\n        const htag = highlight.$tag;\n\n        if (!shouldSaveHighlight(htag)) {\n          return;\n        }\n\n        this._saving.add(htag);\n\n        retryPromiseOperation(() => this._annotationsService.save(highlight))\n          .then(() => {\n            this._toastMessenger.success(`Highlighted \"${quote(highlight)}\"`, {\n              visuallyHidden: true,\n            });\n          })\n          .catch(() => {\n            // save failed after retries\n            this._failed.add(htag);\n          })\n          .finally(() => {\n            // Request is complete, no longer attempting to save\n            this._saving.delete(htag);\n          });\n      });\n    };\n\n    this._store.subscribe(autosaveNewHighlights);\n  }\n\n  /**\n   * Return `true` if any new highlights are currently being saved.\n   */\n  isSaving() {\n    return this._saving.size > 0;\n  }\n}\n","import type { SidebarSettings } from '../../types/config';\nimport * as postMessageJsonRpc from '../util/postmessage-json-rpc';\n\n/**\n * @inject\n */\nexport class DashboardService {\n  private _rpc: SidebarSettings['rpc'];\n  private _dashboardConfig: SidebarSettings['dashboard'];\n\n  constructor(settings: SidebarSettings) {\n    this._rpc = settings.rpc;\n    this._dashboardConfig = settings.dashboard;\n  }\n\n  /**\n   * Get the auth token via JSON RPC.\n   * This method should be called before `open`, to get the authToken that needs\n   * to be passed there.\n   */\n  async getAuthToken(): Promise<string | undefined> {\n    if (!this._rpc || !this._dashboardConfig) {\n      return undefined;\n    }\n\n    return postMessageJsonRpc.call<string>(\n      this._rpc.targetFrame,\n      this._rpc.origin,\n      this._dashboardConfig.authTokenRPCMethod,\n    );\n  }\n\n  /**\n   * Open the dashboard with provided auth token.\n   *\n   * The auth token should be fetched separately, by calling `getAuthToken`\n   * first.\n   * It is not done here transparently, so that we can invoke this method as\n   * part of a user gesture, and browsers don't end up blocking the new tab\n   * opened by the form being submitted later.\n   *\n   * Related Firefox bug: https://bugzilla.mozilla.org/show_bug.cgi?id=1469422\n   *\n   * @see {getAuthToken}\n   */\n  open(authToken: string, document_ = document) {\n    if (!this._rpc || !this._dashboardConfig) {\n      throw new Error(\n        'Dashboard cannot be opened due to missing configuration',\n      );\n    }\n\n    const form = document_.createElement('form');\n    form.action = this._dashboardConfig.entryPointURL;\n    form.target = '_blank';\n    form.method = 'POST';\n\n    const authInput = document_.createElement('input');\n    authInput.type = 'hidden';\n    authInput.name = this._dashboardConfig.authFieldName;\n    authInput.value = authToken;\n\n    form.append(authInput);\n    document_.body.append(form);\n    form.submit();\n    form.remove();\n  }\n}\n","export type Frame = 'guest' | 'host' | 'notebook' | 'profile' | 'sidebar';\n\n/**\n * Message sent by `PortProvider` and `PortFinder` to establish a\n * MessageChannel-based connection between two frames.\n */\nexport type Message = {\n  /** Role of the source frame. */\n  frame1: Frame;\n\n  /** Role of the target frame. */\n  frame2: Frame;\n\n  /**\n   * Message type. \"request\" messages are sent by the source frame to the host\n   * frame to request a connection. \"offer\" messages are sent from the host\n   * frame back to the source frame and also to the target frame, accompanied by\n   * a MessagePort.\n   */\n  type: 'offer' | 'request';\n\n  /** If set on an `offer` message, indicates that the request was rejected. */\n  error?: string;\n\n  /**\n   * ID of the request. Used to associate \"offer\" messages with their\n   * corresponding \"request\" messages.\n   */\n  requestId: string;\n\n  /**\n   * Identifier for the source frame. This is useful in cases where multiple\n   * source frames with a given role may connect to the same destination frame.\n   */\n  sourceId?: string;\n};\n\n/**\n * Return true if an object, eg. from the `data` field of a `MessageEvent`, is a\n * valid `Message`.\n */\nexport function isMessage(data: any): data is Message {\n  if (data === null || typeof data !== 'object') {\n    return false;\n  }\n\n  for (const property of ['frame1', 'frame2', 'type', 'requestId']) {\n    if (typeof data[property] !== 'string') {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Return true if the data payload from a MessageEvent matches `message`.\n */\nexport function isMessageEqual(data: any, message: Partial<Message>) {\n  if (!isMessage(data)) {\n    return false;\n  }\n\n  // We assume `JSON.stringify` cannot throw because `isMessage` verifies that\n  // all the fields we serialize here are serializable values.\n  return (\n    JSON.stringify(data, Object.keys(message).sort()) ===\n    JSON.stringify(message, Object.keys(message).sort())\n  );\n}\n\n/**\n * Check that source is of type Window.\n */\nexport function isSourceWindow(\n  source: MessageEventSource | null,\n): source is Window {\n  if (\n    // `source` can be of type Window, MessagePort, ServiceWorker, or null.\n    // `source instanceof Window` doesn't work in Chrome if `source` is a\n    // cross-origin window.\n    source === null ||\n    source instanceof MessagePort ||\n    (window.ServiceWorker && source instanceof ServiceWorker)\n  ) {\n    return false;\n  }\n\n  return true;\n}\n","import { ListenerCollection } from '@hypothesis/frontend-shared';\n\nimport type { Destroyable } from '../../types/annotator';\nimport { generateHexString } from '../random';\nimport { isMessage } from './port-util';\nimport type { Frame } from './port-util';\n\n/** Timeout for waiting for the host frame to respond to a port request. */\nexport const MAX_WAIT_FOR_PORT = 1000 * 20;\n\n/** Polling interval for requests to the host frame for a port. */\nexport const POLLING_INTERVAL_FOR_PORT = 250;\n\nexport type Options = {\n  /** The role of this frame. */\n  source: Exclude<Frame, 'host'>;\n\n  /** Identifier for this frame. */\n  sourceId?: string;\n\n  /** The frame where the `PortProvider` is listening for messages. */\n  hostFrame: Window;\n};\n\n/** Error thrown when a {@link PortFinder.discover} request fails. */\nexport class PortRequestError extends Error {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n/**\n * PortFinder is used by non-host frames in the client to establish a\n * MessagePort-based connection to other frames. It is used together with\n * PortProvider which runs in the host frame. See PortProvider for an overview.\n */\nexport class PortFinder implements Destroyable {\n  private _hostFrame: Window;\n  private _listeners: ListenerCollection;\n  private _source: Exclude<Frame, 'host'>;\n  private _sourceId: string | undefined;\n\n  constructor({ hostFrame, source, sourceId }: Options) {\n    this._hostFrame = hostFrame;\n    this._source = source;\n    this._sourceId = sourceId;\n    this._listeners = new ListenerCollection();\n  }\n\n  destroy() {\n    this._listeners.removeAll();\n  }\n\n  /**\n   * Request a specific port from the host frame\n   *\n   * @param target - the frame aiming to be discovered\n   */\n  async discover(target: Frame): Promise<MessagePort> {\n    const requestId = generateHexString(6);\n\n    return new Promise((resolve, reject) => {\n      const postRequest = () => {\n        this._hostFrame.postMessage(\n          {\n            frame1: this._source,\n            frame2: target,\n            type: 'request',\n            requestId,\n            sourceId: this._sourceId,\n          },\n          '*',\n        );\n      };\n\n      // Because `guest` iframes load in parallel to the `host` frame, we can\n      // not assume that the code in the `host` frame is executed before the\n      // code in a `guest` frame. Hence, we can't assume that `PortProvider` (in\n      // the `host` frame) is initialized before `PortFinder` (in the non-host\n      // frames). Therefore, for the `PortFinder`, we implement a polling\n      // strategy (sending a message every N milliseconds) until a response is\n      // received.\n      const intervalId = setInterval(postRequest, POLLING_INTERVAL_FOR_PORT);\n\n      // The `host` frame maybe busy, that's why we should wait.\n      const timeoutId = setTimeout(() => {\n        clearInterval(intervalId);\n        reject(\n          new PortRequestError(\n            `Unable to establish ${this._source}-${target} communication channel`,\n          ),\n        );\n      }, MAX_WAIT_FOR_PORT);\n\n      const listenerId = this._listeners.add(window, 'message', event => {\n        const { data, ports } = event;\n\n        // Ignore messages that are:\n        //\n        // - Not related to port discovery\n        // - Not a response to the request we sent above. Note that the host\n        //   frame may be the same as the current window, since eg. the host\n        //   frame can also be a guest frame. Therefore we check `data.type` as\n        //   well to make sure this is a response.\n        if (\n          !isMessage(data) ||\n          data.requestId !== requestId ||\n          data.type === 'request'\n        ) {\n          return;\n        }\n\n        clearInterval(intervalId);\n        clearTimeout(timeoutId);\n        this._listeners.remove(listenerId);\n\n        if (typeof data.error === 'string') {\n          reject(new PortRequestError(data.error));\n        } else if (ports.length > 0) {\n          resolve(ports[0]);\n        } else {\n          reject(\n            new PortRequestError(\n              `${this._source}-${target} port request failed`,\n            ),\n          );\n        }\n      });\n\n      postRequest();\n    });\n  }\n}\n","let errorDestination: Window | null = null;\n\n/**\n * Wrap a callback with an error handler which forwards errors to another frame\n * using {@link sendError}.\n *\n * @param context - A short message indicating where the error happened.\n */\nexport function captureErrors<Result, Args = unknown>(\n  callback: (...args: Args[]) => Result,\n  context: string,\n): (...args: Args[]) => Result {\n  return (...args) => {\n    try {\n      return callback(...args);\n    } catch (err) {\n      sendError(err, context);\n      throw err;\n    }\n  };\n}\n\ntype ErrorData = {\n  message: string;\n  stack?: string;\n};\n\n/**\n * Return a cloneable representation of an Error.\n *\n * This is needed in browsers that don't support structured-cloning of Error\n * objects, or if the error is not cloneable for some reason.\n */\nfunction serializeError(err: Error | unknown): ErrorData {\n  if (!(err instanceof Error)) {\n    return { message: String(err), stack: undefined };\n  }\n\n  return {\n    message: err.message,\n    stack: err.stack,\n  };\n}\n\n/**\n * Convert error data serialized by {@link serializeError} back into an Error.\n */\nfunction deserializeError(data: ErrorData): Error {\n  const err = new Error(data.message);\n  err.stack = data.stack;\n  return err;\n}\n\n/**\n * Forward an error to the frame registered with {@link sendErrorsTo}.\n *\n * Errors are delivered on a best-effort basis. If no error handling frame has\n * been registered or the frame is still loading, the error will not be received.\n *\n * Ideally we would use a more robust delivery system which can queue messages\n * until they can be processed (eg. using MessagePort). We use `window.postMessage`\n * for the moment because we are trying to rule out problems with\n * MessageChannel/MessagePort when setting up sidebar <-> host communication.\n *\n * @param context - A short message indicating where the error happened.\n */\nexport function sendError(error: unknown, context: string) {\n  if (!errorDestination) {\n    return;\n  }\n\n  const data = {\n    type: 'hypothesis-error',\n    error: error instanceof Error ? error : serializeError(error),\n    context,\n  };\n\n  try {\n    // Try to send the error. If this fails because the browser doesn't support\n    // structured cloning of errors, use a fallback.\n    try {\n      errorDestination.postMessage(data, '*');\n    } catch (postErr) {\n      if (\n        postErr instanceof DOMException &&\n        postErr.name === 'DataCloneError'\n      ) {\n        data.error = serializeError(data.error);\n        errorDestination.postMessage(data, '*');\n      } else {\n        throw postErr;\n      }\n    }\n  } catch (sendErr) {\n    console.warn('Unable to report Hypothesis error', sendErr);\n  }\n}\n\n/**\n * Register a handler for errors sent to the current frame using {@link sendError}\n *\n * @return A function that unregisters the handler\n */\nexport function handleErrorsInFrames(\n  callback: (error: unknown, context: string) => void,\n): () => void {\n  const handleMessage = (event: MessageEvent) => {\n    const { data } = event;\n    if (data && data?.type === 'hypothesis-error') {\n      const { context, error } = data;\n      callback(\n        error instanceof Error ? error : deserializeError(error),\n        context,\n      );\n    }\n  };\n  window.addEventListener('message', handleMessage);\n  return () => window.removeEventListener('message', handleMessage);\n}\n\n/**\n * Register a destination frame that {@link sendError} should submit errors to.\n */\nexport function sendErrorsTo(destination: Window | null) {\n  errorDestination = destination;\n}\n","import { ListenerCollection } from '@hypothesis/frontend-shared';\n\nimport type { Destroyable } from '../../types/annotator';\n\n/*\n  This module was adapted from `index.js` in https://github.com/substack/frame-rpc.\n\n  This software is released under the MIT license:\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n */\n\nconst VERSION = '1.0.0';\nconst PROTOCOL = 'frame-rpc';\n\n/**\n * Format of messages sent between frames.\n *\n * See https://github.com/substack/frame-rpc#protocol\n */\ntype RequestMessage = {\n  arguments: unknown[];\n  method: string;\n  protocol: typeof PROTOCOL;\n  sequence: number;\n  version: typeof VERSION;\n};\n\ntype ResponseMessage = {\n  arguments: unknown[];\n  protocol: typeof PROTOCOL;\n  response: number;\n  version: typeof VERSION;\n};\n\ntype Message = RequestMessage | ResponseMessage;\n\nfunction makeRequestMessage(\n  method: string,\n  args: unknown[] = [],\n  sequence = -1,\n): RequestMessage {\n  return {\n    protocol: PROTOCOL,\n    version: VERSION,\n    arguments: args,\n    method,\n    sequence,\n  };\n}\n\n/**\n * Send a PortRPC method call.\n *\n * @param [sequence] - Sequence number used for replies\n */\nfunction sendCall(\n  port: MessagePort,\n  method: string,\n  args: unknown[] = [],\n  sequence = -1,\n) {\n  port.postMessage(makeRequestMessage(method, args, sequence));\n}\n\n/**\n * Install a message listener that ensures proper delivery of \"close\" notifications\n * from {@link PortRPC}s in Safari <= 15.\n *\n * This must be called in the _parent_ frame of the frame that owns the port.\n * In Hypothesis this means for example that the workaround would be installed\n * in the host frame to ensure delivery of \"close\" notifications from \"guest\"\n * frames.\n *\n * @param [userAgent] - Test seam\n * @return Callback that removes the listener\n */\nexport function installPortCloseWorkaroundForSafari(\n  /* istanbul ignore next */\n  userAgent = navigator.userAgent,\n): () => void {\n  if (!shouldUseSafariWorkaround(userAgent)) {\n    return () => {};\n  }\n\n  const handler = (event: MessageEvent) => {\n    if (event.data?.type === 'hypothesisPortClosed' && event.ports[0]) {\n      const port = event.ports[0];\n      sendCall(port, 'close');\n      port.close();\n    }\n  };\n\n  window.addEventListener('message', handler);\n  return () => window.removeEventListener('message', handler);\n}\n\n/**\n * Test whether this browser needs the workaround for https://bugs.webkit.org/show_bug.cgi?id=231167.\n */\nfunction shouldUseSafariWorkaround(userAgent: string) {\n  // Test whether this is a WebKit-based browser.\n  const webkitVersionMatch = userAgent.match(/\\bAppleWebKit\\/([0-9]+)\\b/);\n  if (!webkitVersionMatch) {\n    return false;\n  }\n  const webkitVersion = parseInt(webkitVersionMatch[1]);\n\n  // Chrome's user agent contains the token \"AppleWebKit/537.36\", where the\n  // version number is frozen. This corresponds to a version of Safari from 2013,\n  // which is older than all supported Safari versions.\n  if (webkitVersion <= 537) {\n    return false;\n  }\n\n  // The bug was fixed in Safari 16, which according to\n  // https://github.com/mdn/browser-compat-data/blob/main/browsers/safari.json\n  // corresponds to WebKit 614.* and later. However, the WebKit version was\n  // frozen before then, so we instead need to check the `Version` token.\n  // This identifies the _browser_, not the engine.\n  const versionMatch = userAgent.match(/\\bVersion\\/([0-9]+)\\b/);\n  if (!versionMatch) {\n    // If no version info, we guess that the browser is a new version of\n    // WebKit which is not affected.\n    return false;\n  }\n\n  const version = parseInt(versionMatch[1]);\n\n  // The bug was fixed in Safari 16.\n  if (version >= 16) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Callback type used for RPC method handlers and result callbacks.\n */\ntype Callback = (...args: unknown[]) => void;\n\nfunction isCallback(value: any): value is Callback {\n  return typeof value === 'function';\n}\n\nexport type CallMap = Record<string, (...args: any) => void>;\nexport type HandlerMap = Record<string, (...args: any) => void>;\n\n/**\n * PortRPC provides remote procedure calls between frames or workers. It uses\n * the Channel Messaging API [1] as a transport.\n *\n * To communicate between two frames with this class, construct a PortRPC\n * instance in each and register method handlers with {@link on}. Create a\n * {@link MessageChannel} and send one of its two ports to each frame. Then call\n * {@link connect} to make the PortRPC instance in each frame use the corresponding\n * port.\n *\n * In addition to the custom methods that a PortRPC handles, there are several\n * built-in handlers which are invoked automatically:\n *\n * - \"connect\" is sent when a PortRPC connects to a port. This event can\n *   be used to confirm that the sending frame has received the port and will\n *   send a \"close\" event when it goes away.\n * - \"close\" is sent when a PortRPC is destroyed or the owning frame is\n *   unloaded. This event may not be dispatched if the guest frame terminates\n *   abnormally (eg. due to an OS process crash).\n *\n * [1] https://developer.mozilla.org/en-US/docs/Web/API/Channel_Messaging_API\n *\n * @template Handlers - Object type describing the calls handled by this port,\n *   using {@link PortRPC.on}.\n * @template Calls - Object type describing the calls made by this port,\n *   using {@link PortRPC.prototype.call}.\n */\nexport class PortRPC<Handlers extends HandlerMap, Calls extends CallMap>\n  implements Destroyable\n{\n  /**\n   * Map of sequence number to response callback, for RPC calls sent from\n   * this instance.\n   */\n  private _callbacks: Map<number, Callback>;\n\n  private _destroyed: boolean;\n  private _listeners: ListenerCollection;\n\n  /** Map of method name to handler for RPC calls received by this instance. */\n  private _methods: Map<keyof Handlers, Callback>;\n\n  /** The underlying communication channel. */\n  private _port: MessagePort | null;\n\n  /** Sequence number for next call. */\n  private _sequence: number;\n\n  /**\n   * Method and arguments of pending RPC calls made before a port was connected.\n   */\n  private _pendingCalls: Array<[keyof Calls, unknown[]]>;\n\n  private _receivedCloseEvent: boolean;\n\n  constructor({\n    userAgent = navigator.userAgent,\n    currentWindow = window,\n    forceUnloadListener = false,\n  }: {\n    userAgent?: string;\n    currentWindow?: Window;\n\n    // Test seam. Force the use of a Window \"unload\" listener even if the\n    // browser supports \"close\" events for MessagePort.\n    forceUnloadListener?: boolean;\n  } = {}) {\n    this._port = null;\n    this._methods = new Map();\n    this._sequence = 1;\n    this._callbacks = new Map();\n\n    this._listeners = new ListenerCollection();\n\n    // In browsers that emit a \"close\" event when the other end of a MessagePort\n    // goes away, we can listen for that directly. In other browsers, we have to\n    // send the \"close\" event through the message channel when the window\n    // containing the sending port is unloaded.\n    if (!('onclose' in MessagePort.prototype) || forceUnloadListener) {\n      this._listeners.add(currentWindow, 'unload', event => {\n        // Ignore custom events which use the same name. This works around an\n        // issue in VitalSource.\n        //\n        // See https://github.com/hypothesis/support/issues/161#issuecomment-2454560641.\n        if (event instanceof CustomEvent) {\n          return;\n        }\n\n        if (this._port) {\n          // Send \"close\" notification directly. This works in Chrome, Firefox and\n          // Safari >= 16.\n          sendCall(this._port, 'close');\n\n          // To work around a bug in Safari <= 15 which prevents sending messages\n          // while a window is unloading, try transferring the port to the parent frame\n          // and re-sending the \"close\" event from there.\n          if (\n            currentWindow !== currentWindow.parent &&\n            shouldUseSafariWorkaround(userAgent)\n          ) {\n            currentWindow.parent.postMessage(\n              { type: 'hypothesisPortClosed' },\n              '*',\n              [this._port],\n            );\n          }\n        }\n      });\n    }\n\n    this._pendingCalls = [];\n\n    this._destroyed = false;\n    this._receivedCloseEvent = false;\n  }\n\n  /**\n   * Register a method handler for incoming RPC requests.\n   *\n   * The arguments to the handler will be the arguments passed to {@link call}\n   * plus a final callback arg that can be used to return results to the caller.\n   *\n   * This can also be used to register a handler for the built-in \"connect\"\n   * and \"close\" events.\n   *\n   * All handlers must be registered before {@link connect} is invoked.\n   */\n  on<M extends keyof Handlers>(method: M, handler: Handlers[M]) {\n    if (this._port) {\n      throw new Error('Cannot add a method handler after a port is connected');\n    }\n    this._methods.set(method, handler);\n  }\n\n  /**\n   * Connect to a MessagePort and process any queued RPC requests.\n   */\n  connect(port: MessagePort) {\n    this._port = port;\n    this._listeners.add(port, 'message', event => this._handle(event));\n\n    // For browsers that support a `close` event for MessagePort, we use that\n    // to identify when the other end disconnects. This is translated into a\n    // message event that is similar to what we receive in older browsers\n    // which use a Window unload handler instead.\n    this._listeners.add(port, 'close', () => {\n      port.dispatchEvent(\n        new MessageEvent('message', {\n          data: makeRequestMessage('close'),\n        }),\n      );\n    });\n\n    port.start();\n    sendCall(port, 'connect');\n\n    for (const [method, args] of this._pendingCalls) {\n      this.call(method, ...(args as Parameters<Calls[keyof Calls]>));\n    }\n    this._pendingCalls = [];\n  }\n\n  /**\n   * Disconnect the RPC channel and close the MessagePort.\n   */\n  destroy() {\n    if (this._port) {\n      sendCall(this._port, 'close');\n      this._port.close();\n    }\n    this._destroyed = true;\n    this._listeners.removeAll();\n  }\n\n  /**\n   * Send an RPC request via the connected port.\n   *\n   * If this client is not yet connected to a port, the call will be queued and\n   * sent when {@link connect} is called.\n   *\n   * If the final argument in `args` is a function, it is treated as a callback\n   * which is invoked with the response in the form of (error, result) arguments.\n   */\n  call<M extends keyof Calls>(method: M, ...args: Parameters<Calls[M]>) {\n    if (!this._port) {\n      this._pendingCalls.push([method, args]);\n    }\n\n    if (!this._port || this._destroyed) {\n      return;\n    }\n\n    const seq = this._sequence++;\n    const finalArg = args[args.length - 1];\n    if (isCallback(finalArg)) {\n      this._callbacks.set(seq, finalArg);\n      args = args.slice(0, -1) as Parameters<Calls[M]>;\n    }\n\n    sendCall(this._port, method as string, args, seq);\n  }\n\n  /**\n   * Validate message\n   */\n  private _parseMessage({ data }: MessageEvent): Message | null {\n    if (!data || typeof data !== 'object') {\n      return null;\n    }\n    if (data.protocol !== PROTOCOL) {\n      return null;\n    }\n    if (data.version !== VERSION) {\n      return null;\n    }\n    if (!Array.isArray(data.arguments)) {\n      return null;\n    }\n\n    return data;\n  }\n\n  private _handle(event: MessageEvent) {\n    const msg = this._parseMessage(event);\n    const port = this._port;\n\n    if (!msg || !port) {\n      return;\n    }\n\n    if ('method' in msg) {\n      // Only allow close event to fire once.\n      if (msg.method === 'close') {\n        if (this._receivedCloseEvent) {\n          return;\n        } else {\n          this._receivedCloseEvent = true;\n        }\n      }\n\n      const handler = this._methods.get(msg.method);\n      if (!handler) {\n        return;\n      }\n\n      const callback = (...args: unknown[]) => {\n        const message: ResponseMessage = {\n          arguments: args,\n          protocol: PROTOCOL,\n          response: msg.sequence,\n          version: VERSION,\n        };\n\n        port.postMessage(message);\n      };\n      handler(...msg.arguments, callback);\n    } else if ('response' in msg) {\n      const cb = this._callbacks.get(msg.response);\n      this._callbacks.delete(msg.response);\n      if (cb) {\n        cb(...msg.arguments);\n      }\n    }\n  }\n}\n","import {\n  cfiInRange,\n  splitCFIRange,\n  stripCFIAssertions,\n} from '../../shared/cfi';\nimport type { SegmentInfo } from '../../types/annotator';\nimport type { Annotation, EPUBContentSelector } from '../../types/api';\nimport type { Filters } from '../store/modules/filters';\nimport { RangeOverlap, pageRangeOverlap } from '../util/page-range';\n\n/**\n * Return true if an annotation matches the currently loaded segment of a document.\n *\n * For web pages and PDFs, this is always true. In EPUBs, this is used to send\n * only the annotations for the current chapter to the guest frame.\n */\nexport function annotationMatchesSegment(\n  ann: Annotation,\n  segment: SegmentInfo,\n) {\n  const selector = ann.target[0].selector?.find(\n    s => s.type === 'EPUBContentSelector',\n  ) as EPUBContentSelector;\n\n  if (!selector) {\n    return true;\n  }\n\n  return Boolean(\n    // nb. The URL comparison here assumes that both URLs are either absolute\n    // or relative to the same root.\n    (segment.url && selector.url === segment.url) ||\n      (segment.cfi &&\n        selector.cfi &&\n        stripCFIAssertions(selector.cfi) === stripCFIAssertions(segment.cfi)),\n  );\n}\n\n/**\n * Return true if the document segment displayed in a guest frame matches the\n * configured focus filters.\n */\nexport function segmentMatchesFocusFilters(\n  segment: SegmentInfo,\n  filters: Filters,\n): boolean {\n  if (segment.cfi && filters.cfi) {\n    const [cfiStart, cfiEnd] = splitCFIRange(filters.cfi.value);\n    return cfiInRange(segment.cfi, cfiStart, cfiEnd);\n  }\n  if (segment.pages && filters.page) {\n    const segmentRange = `${segment.pages.start}-${segment.pages.end}`;\n    return (\n      pageRangeOverlap(segmentRange, filters.page.value) ===\n      RangeOverlap.Overlap\n    );\n  }\n  return true;\n}\n","/**\n * Watch a data source for changes to a subset of its data.\n *\n * `watch` subscribes to change notifications from a data source, computes\n * values using the data in it, and runs a callback with the current and\n * previous computed values each time the computed result changes.\n *\n * @example\n *   const unsubscribe = watch(\n *     store.subscribe,\n *\n *     // Extract some data of interest from the store.\n *     () => store.getValue(),\n *\n *     // Callback that is invoked each time the extracted data changes.\n *     (currentValue, prevValue) => { ... }\n *   );\n *   unsubcribe(); // Remove the subscription\n *\n * To watch multiple values, make {@link getValue} return an array and set\n * {@link compare} to a function that compares each element of the array:\n *\n * @example\n *   watch(\n *     store.subscribe,\n *     () => [store.getValueA(), store.getValueB()],\n *\n *     ([currentValueA, currentValueB], [prevValueA, prevValueB]) => { ... },\n *\n *     // Compare each element of the result\n *     shallowEqual,\n *   );\n *\n * @template T\n * @param subscribe - Function to subscribe to changes from the data source.\n * @param getValue - Callback that extracts information of interest from the\n *   data source.\n * @param callback - A callback that receives the data extracted by `getValue`.\n *   It is called each time the result of `getValue` changes.\n * @param compare - Comparison function that tests whether the results of two\n *   `getValue` calls are equal. If omitted, a strict equality check is used\n * @return Return value of `subscribe`\n */\nexport function watch<T>(\n  subscribe: (callback: VoidFunction) => VoidFunction,\n  getValue: () => T,\n  callback: (current: T, previous: T) => void,\n  compare?: (current: T, previous: T) => boolean,\n): VoidFunction {\n  let prevValue = getValue();\n  const unsubscribe = subscribe(() => {\n    const currentValue = getValue();\n    if (\n      compare ? compare(currentValue, prevValue) : currentValue === prevValue\n    ) {\n      return;\n    }\n\n    // Save and then update `prevValues` before invoking `callback` in case\n    // `callback` triggers another update.\n    const savedPrevValue = prevValue;\n    prevValue = currentValue;\n\n    callback(currentValue, savedPrevValue);\n  });\n\n  return unsubscribe;\n}\n","import type { ToastMessage } from '@hypothesis/frontend-shared';\nimport { ListenerCollection } from '@hypothesis/frontend-shared';\nimport debounce from 'lodash.debounce';\nimport type { DebouncedFunction } from 'lodash.debounce';\nimport shallowEqual from 'shallowequal';\n\nimport {\n  PortFinder,\n  PortRPC,\n  isMessage,\n  isMessageEqual,\n} from '../../shared/messaging';\nimport type { Message } from '../../shared/messaging';\nimport type {\n  AnnotationData,\n  DocumentInfo,\n  RenderToBitmapOptions,\n} from '../../types/annotator';\nimport type { Annotation } from '../../types/api';\nimport type {\n  SidebarToHostCalls,\n  HostToSidebarCalls,\n  SidebarToGuestCalls,\n  GuestToSidebarCalls,\n} from '../../types/port-rpc-calls';\nimport { isReply, isPublic } from '../helpers/annotation-metadata';\nimport {\n  annotationMatchesSegment,\n  segmentMatchesFocusFilters,\n} from '../helpers/annotation-segment';\nimport type { SidebarStore } from '../store';\nimport type { Frame } from '../store/modules/frames';\nimport { watch } from '../util/watch';\nimport type { AnnotationsService } from './annotations';\nimport type { ToastMessengerService } from './toast-messenger';\n\n/**\n * Return a minimal representation of an annotation that can be sent from the\n * sidebar app to a guest frame.\n *\n * Because this representation will be exposed to untrusted third-party\n * JavaScript, it includes only the information needed to uniquely identify it\n * within the current session and anchor it in the document.\n */\nexport function formatAnnot({\n  $cluster,\n  $tag,\n  target,\n  uri,\n}: Annotation): AnnotationData {\n  return {\n    $cluster,\n    $tag,\n    target,\n    uri,\n  };\n}\n\n/**\n * Return the frame which best matches an annotation.\n */\nfunction frameForAnnotation(frames: Frame[], ann: Annotation): Frame | null {\n  // Choose frame with an exact URL match if possible. In the unlikely situation\n  // where multiple frames have the same URL, we'll use whichever connected first.\n  const uriMatch = frames.find(f => f.uri === ann.uri);\n  if (uriMatch) {\n    return uriMatch;\n  }\n\n  // If there is no exact URL match, choose the main/host frame for consistent results.\n  const mainFrame = frames.find(f => f.id === null);\n  if (mainFrame) {\n    return mainFrame;\n  }\n\n  // If there is no main frame (eg. in VitalSource), fall back to whichever\n  // frame connected first.\n  return frames[0] ?? null;\n}\n\n/**\n * Service that handles communication between the sidebar and guest and host\n * frames.\n *\n * The service's main responsibility is to synchronize annotations between the\n * sidebar and guests. New annotations created in guest frames are added to the\n * store in the sidebar and persisted to the backend.  Annotations fetched from\n * the API and added to the sidebar's store are sent to the appropriate guest\n * to display highlights in the document.\n *\n * Only a minimal subset of annotation data is sent from the sidebar to guests.\n * This is a security/privacy feature to prevent guest frames (which often\n * contain third-party JavaScript) from observing the contents or authors of\n * annotations.\n *\n * In addition to annotation data, this service also handles:\n *\n *  - Synchronizing the selection and hover states of annotations between the\n *    sidebar and guest frames\n *  - Triggering scrolling or navigation of guest frames when an annotation is\n *    clicked in the sidebar\n *  - Sending feature flags to host and guest frames\n *  - Various other interactions with guest and host frames\n *\n * @inject\n */\nexport class FrameSyncService {\n  private _annotationsService: AnnotationsService;\n\n  /**\n   * Map of guest frame ID to channel for communicating with guest.\n   *\n   * The ID will be `null` for the \"main\" guest, which is usually the one in\n   * the host frame.\n   */\n  private _guestRPC: Map<\n    string | null,\n    PortRPC<GuestToSidebarCalls, SidebarToGuestCalls>\n  >;\n\n  /** Whether highlights are visible in guest frames. */\n  private _highlightsVisible: boolean;\n\n  /**\n   * Channel for sidebar-host communication.\n   */\n  private _hostRPC: PortRPC<HostToSidebarCalls, SidebarToHostCalls>;\n\n  /**\n   * Tags of annotations that are currently loaded into guest frames.\n   */\n  private _inFrame: Set<string>;\n\n  private _listeners: ListenerCollection;\n  private _portFinder: PortFinder;\n  private _store: SidebarStore;\n  private _toastMessenger: ToastMessengerService;\n\n  /**\n   * Tag of an annotation that should be scrolled to after anchoring completes.\n   *\n   * This is set when {@link scrollToAnnotation} is called and the document\n   * needs to be navigated to a different URL. This can happen in EPUBs.\n   */\n  private _pendingScrollToTag: string | null;\n\n  /**\n   * Tag of an annotation that should be hovered after anchoring completes.\n   *\n   * See notes for {@link _pendingScrollToTag}.\n   */\n  private _pendingHoverTag: string | null;\n\n  /**\n   * Map of annotation tag to anchoring status. This holds status updates\n   * which have been received from guest frames but not yet committed to the store.\n   *\n   * Commits are batched to reduce the reduce the overhead from re-rendering\n   * etc. triggered by `SidebarStore.updateAnchorStatus` calls.\n   */\n  private _pendingAnchorStatusUpdates: Map<string, 'anchored' | 'orphan'>;\n\n  /**\n   * Schedule a commit of the anchoring status updates in\n   * {@link _pendingAnchorStatusUpdates} to the store.\n   */\n  private _scheduleAnchorStatusUpdate: DebouncedFunction<[]>;\n\n  /** Indicates if the sidebar is currently open or closed */\n  private _sidebarIsOpen: boolean;\n\n  // Test seam\n  private _window: Window;\n\n  constructor(\n    $window: Window,\n    annotationsService: AnnotationsService,\n    store: SidebarStore,\n    toastMessenger: ToastMessengerService,\n  ) {\n    this._window = $window;\n    this._annotationsService = annotationsService;\n    this._store = store;\n    this._toastMessenger = toastMessenger;\n    this._portFinder = new PortFinder({\n      hostFrame: this._window.parent,\n      source: 'sidebar',\n    });\n    this._listeners = new ListenerCollection();\n\n    this._hostRPC = new PortRPC();\n    this._guestRPC = new Map();\n    this._inFrame = new Set<string>();\n    this._highlightsVisible = false;\n\n    this._pendingScrollToTag = null;\n    this._pendingHoverTag = null;\n    this._pendingAnchorStatusUpdates = new Map();\n\n    this._scheduleAnchorStatusUpdate = debounce(() => {\n      const records = Object.fromEntries(\n        this._pendingAnchorStatusUpdates.entries(),\n      );\n      this._store.updateAnchorStatus(records);\n      this._pendingAnchorStatusUpdates.clear();\n    }, 10);\n\n    this._sidebarIsOpen = false;\n\n    this._setupSyncToGuests();\n    this._setupHostEvents();\n    this._setupFeatureFlagSync();\n    this._setupToastMessengerEvents();\n  }\n\n  /**\n   * Watch for changes to the set of annotations loaded in the sidebar and\n   * notify connected guests about new/updated/deleted annotations.\n   */\n  private _setupSyncToGuests() {\n    let prevPublicAnns = 0;\n\n    /**\n     * Handle annotations or frames being added or removed in the store.\n     */\n    const onStoreAnnotationsChanged = (\n      annotations: Annotation[],\n      frames: Frame[],\n      prevAnnotations: Annotation[],\n    ) => {\n      let publicAnns = 0;\n      const inSidebar = new Set<string>();\n      const added = [] as Annotation[];\n\n      // Determine which annotations have been added or deleted in the sidebar.\n      annotations.forEach(annot => {\n        if (isReply(annot)) {\n          // The frame does not need to know about replies\n          return;\n        }\n\n        if (isPublic(annot)) {\n          ++publicAnns;\n        }\n\n        inSidebar.add(annot.$tag);\n        if (!this._inFrame.has(annot.$tag)) {\n          added.push(annot);\n        }\n      });\n      const deleted = prevAnnotations.filter(\n        annot => !inSidebar.has(annot.$tag),\n      );\n\n      // Send added annotations to matching frame.\n      if (added.length > 0) {\n        const addedByFrame = new Map<string | null, Annotation[]>();\n\n        // List of annotations to immediately mark as anchored, as opposed to\n        // waiting for the guest to report the status. This is used for\n        // annotations associated with content that is different from what is\n        // currently loaded in the guest frame (eg. different EPUB chapter).\n        //\n        // For these annotations, we optimistically assume they will anchor\n        // when the appropriate content is loaded.\n        const anchorImmediately = [];\n\n        for (const annotation of added) {\n          const frame = frameForAnnotation(frames, annotation);\n          if (\n            !frame ||\n            (frame.segment &&\n              !annotationMatchesSegment(annotation, frame.segment))\n          ) {\n            anchorImmediately.push(annotation.$tag);\n            continue;\n          }\n          const anns = addedByFrame.get(frame.id) ?? [];\n          anns.push(annotation);\n          addedByFrame.set(frame.id, anns);\n        }\n\n        if (anchorImmediately.length > 0) {\n          this._updateAnchorStatus(anchorImmediately, 'anchored');\n        }\n\n        for (const [frameId, anns] of addedByFrame) {\n          const rpc = this._guestRPC.get(frameId);\n          if (rpc) {\n            rpc.call('loadAnnotations', anns.map(formatAnnot));\n          }\n        }\n\n        added.forEach(annot => {\n          this._inFrame.add(annot.$tag);\n        });\n      }\n\n      // Remove deleted annotations from frames.\n      deleted.forEach(annot => {\n        // Delete from all frames. If a guest is not displaying a particular\n        // annotation, it will just ignore the request.\n        this._guestRPC.forEach(rpc => rpc.call('deleteAnnotation', annot.$tag));\n        this._inFrame.delete(annot.$tag);\n      });\n\n      // Update elements in host page which display annotation counts.\n      if (frames.length > 0) {\n        if (frames.every(frame => frame.isAnnotationFetchComplete)) {\n          if (publicAnns === 0 || publicAnns !== prevPublicAnns) {\n            this._hostRPC.call('publicAnnotationCountChanged', publicAnns);\n            prevPublicAnns = publicAnns;\n          }\n        }\n      }\n    };\n\n    watch(\n      this._store.subscribe,\n      () => [this._store.allAnnotations(), this._store.frames()] as const,\n      ([annotations, frames], [prevAnnotations]) =>\n        onStoreAnnotationsChanged(annotations, frames, prevAnnotations),\n      shallowEqual,\n    );\n\n    watch(\n      this._store.subscribe,\n      () => this._store.getContentInfo(),\n      contentInfo => {\n        // We send the content info to all guests, even though it is only needed\n        // by the main one. See notes in `_connectGuest`.\n        this._guestRPC.forEach(guest => {\n          guest.call('showContentInfo', contentInfo);\n        });\n      },\n    );\n  }\n\n  /**\n   * Schedule an update of the anchoring status of annotation(s) in the store.\n   */\n  private _updateAnchorStatus(\n    tag: string | string[],\n    state: 'orphan' | 'anchored',\n  ) {\n    const tags = Array.isArray(tag) ? tag : [tag];\n    for (const tag of tags) {\n      this._pendingAnchorStatusUpdates.set(tag, state);\n    }\n    this._scheduleAnchorStatusUpdate();\n  }\n\n  /**\n   * Set up a connection to a new guest frame.\n   *\n   * @param port - Port for communicating with the guest\n   * @param sourceId - Identifier for the guest frame\n   */\n  private _connectGuest(port: MessagePort, sourceId: string | null) {\n    const guestRPC = new PortRPC<GuestToSidebarCalls, SidebarToGuestCalls>();\n\n    this._guestRPC.set(sourceId, guestRPC);\n\n    // Update document metadata for this guest. The guest will call this method\n    // immediately after it connects to the sidebar. It may call it again\n    // later if the document in the guest frame is navigated.\n    guestRPC.on('documentInfoChanged', (info: DocumentInfo) => {\n      const focusFilters = this._store.getFocusFilters();\n\n      // If we are in a classroom assignment with an associated page range,\n      // tell the user if they have navigated outside that range.\n      if (info.segmentInfo && Object.keys(focusFilters).length > 0) {\n        const match = segmentMatchesFocusFilters(\n          info.segmentInfo,\n          focusFilters,\n        );\n        guestRPC.call('setOutsideAssignmentNoticeVisible', !match);\n      }\n\n      this._store.connectFrame({\n        id: sourceId,\n        metadata: info.metadata,\n        uri: info.uri,\n        segment: info.segmentInfo,\n        persistent: info.persistent,\n      });\n    });\n\n    // TODO - Close connection if we don't receive a \"connect\" message within\n    // a certain time frame.\n\n    guestRPC.on('close', () => {\n      const frame = this._store.frames().find(f => f.id === sourceId);\n      if (frame && !frame.persistent) {\n        this._store.destroyFrame(frame);\n      }\n\n      // Mark annotations as no longer being loaded in the guest, even if\n      // the frame was marked as `persistent`. In that case if a new guest\n      // connects with the same ID as the one that just went away, we'll send\n      // the already-loaded annotations to the new guest.\n      this._inFrame.clear();\n\n      guestRPC.destroy();\n      this._guestRPC.delete(sourceId);\n    });\n\n    // A new annotation, note or highlight was created in the frame\n    guestRPC.on('createAnnotation', (annot: AnnotationData) => {\n      // If user is not logged in, or groups haven't loaded yet, we can't create\n      // a meaningful highlight or annotation. Instead, we need to open the\n      // sidebar, show an error, and delete the (unsaved) annotation so it gets\n      // un-selected in the target document\n      const isLoggedIn = this._store.isLoggedIn();\n      const hasGroup = this._store.focusedGroup() !== null;\n\n      if (!isLoggedIn || !hasGroup) {\n        this._hostRPC.call('openSidebar');\n        if (!isLoggedIn) {\n          this._store.openSidebarPanel('loginPrompt');\n        }\n        this._guestRPC.forEach(rpc => rpc.call('deleteAnnotation', annot.$tag));\n        return;\n      }\n\n      this._inFrame.add(annot.$tag);\n\n      // Open the sidebar so that the user can immediately edit the draft\n      // annotation.\n      if (!annot.$highlight) {\n        this._hostRPC.call('openSidebar');\n      }\n\n      // Ensure that the highlight for the newly-created annotation is visible.\n      // Currently we only support a single, shared visibility state for all highlights\n      // in all frames, so this will make all existing highlights visible too.\n      this._hostRPC.call('showHighlights');\n\n      // Create the new annotation in the sidebar.\n      this._annotationsService.create(annot);\n    });\n\n    // Anchoring an annotation in the frame completed\n    guestRPC.on('syncAnchoringStatus', ({ $tag, $orphan }: AnnotationData) => {\n      this._inFrame.add($tag);\n      this._updateAnchorStatus($tag, $orphan ? 'orphan' : 'anchored');\n\n      if ($tag === this._pendingHoverTag) {\n        this._pendingHoverTag = null;\n        guestRPC.call('hoverAnnotations', [$tag]);\n      }\n      if (this._pendingScrollToTag) {\n        if ($tag === this._pendingScrollToTag) {\n          this._pendingScrollToTag = null;\n          guestRPC.call('scrollToAnnotation', $tag);\n        }\n      }\n    });\n\n    guestRPC.on(\n      'showAnnotations',\n      (tags: string[], focusFirstInSelection = false) => {\n        // Since annotations are selected by ID rather than tag, this logic\n        // currently only supports saved annotations.\n        const ids = this._store.findIDsForTags(tags);\n        this._store.selectAnnotations(ids);\n        this._store.selectTab('annotation');\n\n        // Attempt to transfer keyboard focus to the first selected annotation.\n        //\n        // To do this we need to focus both the annotation card and the frame\n        // itself. It doesn't matter in which order.\n        if (ids.length > 0 && focusFirstInSelection) {\n          // Request the annotation card to be focused. This is handled asynchronously.\n          this._store.setAnnotationFocusRequest(ids[0]);\n\n          // Focus the sidebar frame. This may fail in WebKit-based browsers\n          // if the user has no interacted with the frame since it loaded.\n          window.focus();\n        }\n      },\n    );\n\n    guestRPC.on('hoverAnnotations', (tags: string[]) => {\n      this._store.hoverAnnotations(tags || []);\n    });\n\n    guestRPC.on('toggleAnnotationSelection', (tags: string[]) => {\n      this._store.toggleSelectedAnnotations(this._store.findIDsForTags(tags));\n    });\n\n    guestRPC.on('openSidebar', () => {\n      this._hostRPC.call('openSidebar');\n    });\n\n    guestRPC.on('closeSidebar', () => {\n      this._hostRPC.call('closeSidebar');\n    });\n\n    guestRPC.connect(port);\n\n    // Synchronize highlight visibility in this guest with the sidebar's controls.\n    guestRPC.call('setHighlightsVisible', this._highlightsVisible);\n    guestRPC.call('featureFlagsUpdated', this._store.features());\n\n    // If we have content banner data, send it to the guest. If there are\n    // multiple guests the banner is likely only appropriate for the main one.\n    // Current contexts that use the banner only have one guest, so we can get\n    // the data to the guest faster by sending it immediately, rather than\n    // waiting for the `documentInfoChanged` event to tell us which is the main\n    // guest.\n    const contentInfo = this._store.getContentInfo();\n    if (contentInfo) {\n      guestRPC.call('showContentInfo', contentInfo);\n    }\n  }\n\n  /**\n   * Listen for messages coming from the host frame.\n   */\n  private _setupHostEvents() {\n    this._hostRPC.on('sidebarOpened', () => {\n      this._sidebarIsOpen = true;\n      this._store.setSidebarOpened(true);\n    });\n    this._hostRPC.on('sidebarClosed', () => {\n      this._sidebarIsOpen = false;\n    });\n\n    // When user toggles the highlight visibility control in the sidebar container,\n    // update the visibility in all the guest frames.\n    this._hostRPC.on('setHighlightsVisible', (visible: boolean) => {\n      this._highlightsVisible = visible;\n      this._guestRPC.forEach(rpc => rpc.call('setHighlightsVisible', visible));\n    });\n  }\n\n  /**\n   * Set up synchronization of feature flags to host and guest frames.\n   */\n  private _setupFeatureFlagSync() {\n    const getFlags = () => this._store.features();\n\n    const sendFlags = (flags: Record<string, boolean>) => {\n      this._hostRPC.call('featureFlagsUpdated', flags);\n      for (const guest of this._guestRPC.values()) {\n        guest.call('featureFlagsUpdated', flags);\n      }\n    };\n\n    // Send current flags to host when it connects, and any already-connected\n    // guests.\n    sendFlags(getFlags());\n\n    // Watch for future flag changes.\n    watch(this._store.subscribe, getFlags, sendFlags);\n  }\n\n  private _setupToastMessengerEvents() {\n    this._toastMessenger.on('toastMessageAdded', (message: ToastMessage) => {\n      // Forward hidden messages to \"host\" when sidebar is collapsed, with the\n      // intention that another container can be used to render those messages\n      // there, ensuring screen readers announce them.\n      if (message.visuallyHidden && !this._sidebarIsOpen) {\n        this.notifyHost('toastMessageAdded', message);\n      }\n    });\n    this._toastMessenger.on('toastMessageDismissed', (messageId: string) => {\n      this.notifyHost('toastMessageDismissed', messageId);\n    });\n  }\n\n  /**\n   * Connect to the host frame and guest frame(s) in the current browser tab.\n   */\n  async connect() {\n    // Create channel for sidebar-host communication.\n    const hostPort = await this._portFinder.discover('host');\n    this._hostRPC.connect(hostPort);\n\n    // Listen for guests connecting to the sidebar.\n    this._listeners.add(hostPort, 'message', event => {\n      const { data, ports } = event;\n\n      const message = data as Message | unknown;\n      if (!isMessage(message)) {\n        return;\n      }\n\n      if (\n        isMessageEqual(message, {\n          frame1: 'guest',\n          frame2: 'sidebar',\n          type: 'offer',\n        })\n      ) {\n        this._connectGuest(ports[0], message.sourceId ?? null);\n      }\n    });\n  }\n\n  /**\n   * Send an RPC message to the host frame.\n   */\n  notifyHost<M extends keyof SidebarToHostCalls>(\n    method: M,\n    ...args: Parameters<SidebarToHostCalls[M]>\n  ) {\n    this._hostRPC.call(method, ...args);\n  }\n\n  /**\n   * Mark annotation as hovered.\n   *\n   * This is used to indicate the highlights in the document that correspond\n   * to a hovered annotation in the sidebar.\n   *\n   * This function only accepts a single annotation because the user can only\n   * hover one annotation card in the sidebar at a time. Hover updates in the\n   * other direction (guest to sidebar) support multiple annotations since a\n   * user can hover multiple highlights in the document at once.\n   */\n  hoverAnnotation(ann: Annotation | null) {\n    this._pendingHoverTag = null;\n\n    const tags = ann ? [ann.$tag] : [];\n    this._store.hoverAnnotations(tags);\n\n    if (!ann) {\n      this._guestRPC.forEach(rpc => rpc.call('hoverAnnotations', []));\n      return;\n    }\n\n    // If annotation is not currently anchored in a guest, schedule hover for\n    // when annotation is anchored. This can happen if an annotation is for a\n    // different chapter of an EPUB than the currently loaded one. See notes in\n    // `scrollToAnnotation`.\n    const frame = frameForAnnotation(this._store.frames(), ann);\n    if (\n      !frame ||\n      (frame.segment && !annotationMatchesSegment(ann, frame.segment))\n    ) {\n      this._pendingHoverTag = ann.$tag;\n      return;\n    }\n    this._guestRPC.forEach(rpc => rpc.call('hoverAnnotations', tags));\n  }\n\n  /**\n   * Scroll the frame to the highlight for an annotation.\n   */\n  scrollToAnnotation(ann: Annotation) {\n    const frame = frameForAnnotation(this._store.frames(), ann);\n    if (!frame) {\n      return;\n    }\n    const guest = this._guestRPC.get(frame?.id);\n    if (!guest) {\n      return;\n    }\n\n    // If this annotation is for a different segment of a book than is loaded\n    // in the guest, then ask the guest to navigate to the appropriate segment.\n    //\n    // In EPUBs, this will cause the guest to disconnect and a new guest will\n    // connect when the new content has loaded. We will then need to wait for\n    // the annotation to anchor in the new guest frame before we can actually\n    // scroll to it.\n    if (frame.segment && !annotationMatchesSegment(ann, frame.segment)) {\n      // Schedule scroll once anchoring completes.\n      this._pendingScrollToTag = ann.$tag;\n      guest.call('navigateToSegment', formatAnnot(ann));\n      return;\n    }\n\n    guest.call('scrollToAnnotation', ann.$tag);\n  }\n\n  /**\n   * Request a thumbnail from an annotated region of the document.\n   *\n   * @param tag - Annotation identifier. See {@link Annotation.$tag}.\n   */\n  async requestThumbnail(\n    tag: string,\n    options: RenderToBitmapOptions = {},\n  ): Promise<ImageBitmap> {\n    // Get the guest for the main frame. This assumes that the annotation is\n    // anchored in the main frame.\n    const guest = this._guestRPC.get(null);\n    if (!guest) {\n      throw new Error('No guest connected');\n    }\n\n    return new Promise((resolve, reject) => {\n      guest.call('renderThumbnail', tag, options, result => {\n        if (result.ok) {\n          resolve(result.value);\n        } else {\n          reject(new Error(result.error));\n        }\n      });\n    });\n  }\n\n  // Only used to cleanup tests\n  destroy() {\n    this._portFinder.destroy();\n    this._listeners.removeAll();\n  }\n}\n","import shallowEqual from 'shallowequal';\n\n// @ts-ignore - TS doesn't know about SVG files.\nimport { default as logo } from '../../images/icons/logo.svg';\nimport type { Group, GroupMember, GroupMembers } from '../../types/api';\nimport type { SidebarSettings } from '../../types/config';\nimport type { Service } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\nimport { isReply } from '../helpers/annotation-metadata';\nimport { combineGroups, PUBLIC_GROUP_ID } from '../helpers/groups';\nimport type { SidebarStore } from '../store';\nimport { awaitStateChange } from '../store/util';\nimport { watch } from '../util/watch';\nimport type { APIService } from './api';\nimport type { AuthService } from './auth';\nimport type { ToastMessengerService } from './toast-messenger';\n\nconst DEFAULT_ORG_ID = '__default__';\n\nconst DEFAULT_ORGANIZATION = {\n  id: DEFAULT_ORG_ID,\n  name: '__DEFAULT__',\n  logo: 'data:image/svg+xml;utf8,' + encodeURIComponent(logo),\n};\n\nexport const MEMBERS_PAGE_SIZE = 100;\n\n/**\n * For any group that does not have an associated organization, populate with\n * the default Hypothesis organization.\n *\n * Mutates group objects in place\n */\nfunction injectOrganizations(groups: Group[]) {\n  groups.forEach(group => {\n    if (!group.organization || typeof group.organization !== 'object') {\n      group.organization = DEFAULT_ORGANIZATION;\n    }\n  });\n}\n\nfunction isPromise(value: any): value is Promise<unknown> {\n  return typeof value?.then === 'function';\n}\n\n// `expand` parameter for various groups API calls.\nconst expandParam = ['organization', 'scopes'];\n\n/**\n * Service for fetching groups from the API and adding them to the store.\n *\n * The service also provides a `focus` method for switching the active group\n * and `leave` method to remove the current user from a private group.\n *\n * @inject\n */\nexport class GroupsService {\n  private _store: SidebarStore;\n  private _api: APIService;\n  private _auth: AuthService;\n  private _settings: SidebarSettings;\n  private _toastMessenger: ToastMessengerService;\n  private _serviceConfig: Service | null;\n  private _reloadSetUp: boolean;\n\n  /**\n   * Tracks the loading of the focused group members.\n   * If this is null it means we are not loading members yet.\n   */\n  private _focusedMembersController: AbortController | null = null;\n\n  constructor(\n    store: SidebarStore,\n    api: APIService,\n    auth: AuthService,\n    settings: SidebarSettings,\n    toastMessenger: ToastMessengerService,\n  ) {\n    this._store = store;\n    this._api = api;\n    this._auth = auth;\n    this._settings = settings;\n    this._toastMessenger = toastMessenger;\n\n    this._serviceConfig = serviceConfig(settings);\n    this._reloadSetUp = false;\n  }\n\n  /**\n   * Return the main document URI that is used to fetch groups associated with\n   * the site that the user is on.\n   */\n  private _mainURI(): string | null {\n    return this._store.defaultContentFrame()?.uri ?? null;\n  }\n\n  /**\n   * Filter the returned list of groups from the API.\n   *\n   * `filterGroups` performs client-side filtering to hide the \"Public\" group\n   * for logged-out users under certain conditions.\n   */\n  private async _filterGroups(\n    groups: Group[],\n    isLoggedIn: boolean,\n    directLinkedAnnotationGroupId: string | null,\n    directLinkedGroupId: string | null,\n  ): Promise<Group[]> {\n    // Filter the directLinkedGroup out if it is out of scope and scope is enforced.\n    if (directLinkedGroupId) {\n      const directLinkedGroup = groups.find(g => g.id === directLinkedGroupId);\n      if (\n        directLinkedGroup &&\n        !directLinkedGroup.isScopedToUri &&\n        directLinkedGroup.scopes &&\n        directLinkedGroup.scopes.enforced\n      ) {\n        groups = groups.filter(g => g.id !== directLinkedGroupId);\n        this._store.setDirectLinkedGroupFetchFailed();\n        directLinkedGroupId = null;\n      }\n    }\n\n    // Logged-in users always see the \"Public\" group.\n    if (isLoggedIn) {\n      return groups;\n    }\n\n    // If the main document URL has no groups associated with it, always show\n    // the \"Public\" group.\n    const pageHasAssociatedGroups = groups.some(\n      g => g.id !== PUBLIC_GROUP_ID && g.isScopedToUri,\n    );\n    if (!pageHasAssociatedGroups) {\n      return groups;\n    }\n\n    // If directLinkedGroup or directLinkedAnnotationGroupId is the \"Public\" group,\n    // always return groups.\n    if (\n      directLinkedGroupId === PUBLIC_GROUP_ID ||\n      directLinkedAnnotationGroupId === PUBLIC_GROUP_ID\n    ) {\n      return groups;\n    }\n\n    // Return non-world groups.\n    return groups.filter(g => g.id !== PUBLIC_GROUP_ID);\n  }\n\n  /**\n   * Set up automatic re-fetching of groups in response to various events\n   * in the sidebar.\n   */\n  private _setupAutoReload() {\n    if (this._reloadSetUp) {\n      return;\n    }\n    this._reloadSetUp = true;\n\n    // Reload groups when main document URI changes.\n    watch(\n      this._store.subscribe,\n      () => this._mainURI(),\n      () => this.load(),\n    );\n\n    // Reload groups when user ID changes. This is a bit inefficient since it\n    // means we are not fetching the groups and profile concurrently after\n    // logging in or logging out.\n    watch(\n      this._store.subscribe,\n      () =>\n        [\n          this._store.hasFetchedProfile(),\n          this._store.profile().userid,\n        ] as const,\n      (_, [prevFetchedProfile]) => {\n        if (!prevFetchedProfile) {\n          // Ignore the first time that the profile is loaded.\n          return;\n        }\n        this.load();\n      },\n      shallowEqual,\n    );\n  }\n\n  /**\n   * Add groups to the store and set the initial focused group.\n   */\n  private _addGroupsToStore(groups: Group[], groupToFocus: string | null) {\n    // Add a default organization to groups that don't have one. The organization\n    // provides the logo to display when the group is selected and is also used\n    // to order groups.\n    injectOrganizations(groups);\n\n    const isFirstLoad = this._store.allGroups().length === 0;\n    const prevFocusedGroup = this._store.getDefault('focusedGroup');\n\n    this._store.loadGroups(groups);\n\n    if (isFirstLoad) {\n      if (groupToFocus && groups.some(g => g.id === groupToFocus)) {\n        this.focus(groupToFocus);\n      } else if (\n        prevFocusedGroup &&\n        groups.some(g => g.id === prevFocusedGroup)\n      ) {\n        this.focus(prevFocusedGroup);\n      }\n    }\n  }\n\n  /**\n   * Fetch a specific group.\n   */\n  private _fetchGroup(id: string): Promise<Group> {\n    return this._api.group.read({ id, expand: expandParam });\n  }\n\n  /**\n   * Fetch the groups associated with the current user and document, as well\n   * as any groups that have been direct-linked to.\n   */\n  private async _loadGroupsForUserAndDocument(): Promise<Group[]> {\n    const getDocumentUriForGroupSearch = () =>\n      awaitStateChange(this._store, () => this._mainURI());\n\n    // Step 1: Get the URI of the active document, so we can fetch groups\n    // associated with that document.\n    let documentUri = null;\n    if (this._store.route() === 'sidebar') {\n      documentUri = await getDocumentUriForGroupSearch();\n    }\n\n    this._setupAutoReload();\n\n    // Step 2: Concurrently fetch the groups the user is a member of,\n    // the groups associated with the current document and the annotation\n    // and/or group that was direct-linked (if any).\n\n    // If there is a direct-linked annotation, fetch the annotation in case\n    // the associated group has not already been fetched and we need to make\n    // an additional request for it.\n    const directLinkedAnnId = this._store.directLinkedAnnotationId();\n    let directLinkedAnnApi = null;\n    if (directLinkedAnnId) {\n      directLinkedAnnApi = this._api.annotation\n        .get({ id: directLinkedAnnId })\n        .catch(() => {\n          // If the annotation does not exist or the user doesn't have permission.\n          return null;\n        });\n    }\n\n    // If there is a direct-linked group, add an API request to get that\n    // particular group since it may not be in the set of groups that are\n    // fetched by other requests.\n    const directLinkedGroupId = this._store.directLinkedGroupId();\n    let directLinkedGroupApi = null;\n    if (directLinkedGroupId) {\n      directLinkedGroupApi = this._fetchGroup(directLinkedGroupId)\n        .then(group => {\n          this._store.clearDirectLinkedGroupFetchFailed();\n          return group;\n        })\n        .catch(() => {\n          // If the group does not exist or the user doesn't have permission.\n          this._store.setDirectLinkedGroupFetchFailed();\n          return null;\n        });\n    }\n\n    const listParams: {\n      authority?: string;\n      expand: string[];\n      document_uri?: string;\n    } = {\n      expand: expandParam,\n    };\n    const authority = this._serviceConfig?.authority;\n    if (authority) {\n      listParams.authority = authority;\n    }\n    if (documentUri) {\n      listParams.document_uri = documentUri;\n    }\n\n    const [\n      myGroups,\n      featuredGroups,\n      token,\n      directLinkedAnn,\n      directLinkedGroup,\n    ] = await Promise.all([\n      this._api.profile.groups.read({ expand: expandParam }),\n      this._api.groups.list(listParams),\n      this._auth.getAccessToken(),\n      directLinkedAnnApi,\n      directLinkedGroupApi,\n    ]);\n\n    // Step 3. Add the direct-linked group to the list of featured groups,\n    // and if there was a direct-linked annotation, fetch its group if we\n    // don't already have it.\n\n    // If there is a direct-linked group, add it to the featured groups list.\n    if (\n      directLinkedGroup &&\n      !featuredGroups.some(g => g.id === directLinkedGroup.id)\n    ) {\n      featuredGroups.push(directLinkedGroup);\n    }\n\n    // If there's a direct-linked annotation it may require an extra API call\n    // to fetch its group.\n    let directLinkedAnnotationGroupId = null;\n    if (directLinkedAnn) {\n      // Set the directLinkedAnnotationGroupId to be used later in\n      // the filterGroups method.\n      directLinkedAnnotationGroupId = directLinkedAnn.group;\n\n      // If the direct-linked annotation's group has not already been fetched,\n      // fetch it.\n      const directLinkedAnnGroup = myGroups\n        .concat(featuredGroups)\n        .find(g => g.id === directLinkedAnn.group);\n\n      if (!directLinkedAnnGroup) {\n        try {\n          const directLinkedAnnGroup = await this._fetchGroup(\n            directLinkedAnn.group,\n          );\n          featuredGroups.push(directLinkedAnnGroup);\n        } catch {\n          this._toastMessenger.error(\n            'Unable to fetch group for linked annotation',\n          );\n        }\n      }\n    }\n\n    // Step 4. Combine all the groups into a single list and set additional\n    // metadata on them that will be used elsewhere in the app.\n    const isLoggedIn = token !== null;\n    const groups = await this._filterGroups(\n      combineGroups(myGroups, featuredGroups, documentUri, this._settings),\n      isLoggedIn,\n      directLinkedAnnotationGroupId,\n      directLinkedGroupId,\n    );\n\n    const groupToFocus =\n      directLinkedAnnotationGroupId || directLinkedGroupId || null;\n    this._addGroupsToStore(groups, groupToFocus);\n\n    return groups;\n  }\n\n  /**\n   * Load the specific groups configured by the annotation service.\n   *\n   * @param groupIds - `id` or `groupid`s of groups to fetch\n   */\n  private async _loadServiceSpecifiedGroups(\n    groupIds: string[],\n  ): Promise<Group[]> {\n    // Fetch the groups that the user is a member of in one request and then\n    // fetch any other groups not returned in that request directly.\n    //\n    // This reduces the number of requests to the backend on the assumption\n    // that most or all of the group IDs that the service configures the client\n    // to show are groups that the user is a member of.\n    const userGroups = await this._api.profile.groups.read({\n      expand: expandParam,\n    });\n\n    let error: Error | null = null;\n    const tryFetchGroup = async (id: string) => {\n      try {\n        return await this._fetchGroup(id);\n      } catch (e) {\n        error = e;\n        return null;\n      }\n    };\n\n    const getGroup = (id: string) =>\n      userGroups.find(g => g.id === id || g.groupid === id) ||\n      tryFetchGroup(id);\n\n    const groupResults = await Promise.all(groupIds.map(getGroup));\n    const groups = groupResults.filter(g => g !== null) as Group[];\n\n    // Optional direct linked group id. This is used in the Notebook context.\n    const focusedGroupId = this._store.directLinkedGroupId();\n\n    this._addGroupsToStore(groups, focusedGroupId);\n\n    if (error) {\n      // @ts-ignore - TS can't track the type of `error` here.\n      this._toastMessenger.error(`Unable to fetch groups: ${error.message}`, {\n        autoDismiss: false,\n      });\n    }\n\n    return groups;\n  }\n\n  /**\n   * Fetch groups from the API, load them into the store and set the focused\n   * group.\n   *\n   * There are two main scenarios:\n   *\n   * 1. The groups loaded depend on the current user, current document URI and\n   *    active direct links. This is the default.\n   *\n   *    On startup, `load()` must be called to trigger the initial groups fetch.\n   *    Subsequently groups are automatically reloaded if the logged-in user or\n   *    main document URI changes.\n   *\n   * 2. The annotation service specifies exactly which groups to load via the\n   *    configuration it passes to the client.\n   */\n  async load(): Promise<Group[]> {\n    // The `groups` property may be a list of group IDs or a promise for one,\n    // if we're in the LMS app and the group list is being fetched asynchronously.\n    const groupIdsOrPromise = this._serviceConfig?.groups;\n\n    if (Array.isArray(groupIdsOrPromise) || isPromise(groupIdsOrPromise)) {\n      let groupIds: string[] = [];\n      try {\n        groupIds = await groupIdsOrPromise;\n      } catch (e) {\n        this._toastMessenger.error(\n          `Unable to fetch group configuration: ${e.message}`,\n        );\n      }\n      return this._loadServiceSpecifiedGroups(groupIds);\n    } else {\n      return this._loadGroupsForUserAndDocument();\n    }\n  }\n\n  /**\n   * Update the focused group. Update the store, then check to see if\n   * there are any new (unsaved) annotations—if so, update those annotations\n   * such that they are associated with the newly-focused group.\n   */\n  focus(groupId: string) {\n    const prevGroupId = this._store.focusedGroupId();\n\n    this._store.focusGroup(groupId);\n\n    const newGroupId = this._store.focusedGroupId();\n\n    const groupHasChanged = prevGroupId !== newGroupId && prevGroupId !== null;\n    if (groupHasChanged && newGroupId) {\n      // Abort previous in-flight members loading if the group was different\n      // from the focused one\n      this._focusedMembersController?.abort();\n\n      // Move any top-level new annotations to the newly-focused group.\n      // Leave replies where they are.\n      const updatedAnnotations = this._store\n        .newAnnotations()\n        .filter(ann => !isReply(ann))\n        .map(ann => ({ ...ann, group: newGroupId }));\n\n      if (updatedAnnotations.length) {\n        this._store.addAnnotations(updatedAnnotations);\n      }\n\n      // Persist this group as the last focused group default\n      this._store.setDefault('focusedGroup', newGroupId);\n    }\n  }\n\n  /**\n   * Request to remove the current user from a group.\n   */\n  leave(id: string): Promise<void> {\n    // The groups list will be updated in response to a session state\n    // change notification from the server. We could improve the UX here\n    // by optimistically updating the session state\n    return this._api.group.member.delete({\n      pubid: id,\n      userid: 'me',\n    });\n  }\n\n  /**\n   * Fetch members for focused group from the API and load them into the store.\n   */\n  async loadFocusedGroupMembers(): Promise<void> {\n    const groupId = this._store.focusedGroupId();\n    if (!groupId) {\n      return;\n    }\n\n    // Abort previous loading, if any\n    this._focusedMembersController?.abort();\n\n    this._focusedMembersController = new AbortController();\n    const { signal } = this._focusedMembersController;\n\n    this._store.startLoadingFocusedGroupMembers();\n    const members = await this._fetchAllMembers(groupId, signal);\n    this._store.loadFocusedGroupMembers(signal?.aborted ? null : members);\n  }\n\n  private async _fetchAllMembers(\n    groupId: string,\n    signal?: AbortSignal,\n  ): Promise<GroupMember[]> {\n    // Fetch first page of members, to determine how many more pages there are\n    const firstPage = await this._fetchMembers({ groupId, signal });\n    const pages = Math.min(\n      Math.ceil(firstPage.meta.page.total / MEMBERS_PAGE_SIZE),\n      // Do not try to load more than 10 pages, to avoid long loading times and\n      // hitting the server too much\n      10,\n    );\n    let members = firstPage.data;\n\n    // Fetch remaining pages. Start at 2 to skip first one which was already\n    // loaded.\n    // TODO Consider parallelizing requests\n    for (let page = 2; page <= pages; page++) {\n      // Do not attempt any further request once the signal has been aborted\n      if (signal?.aborted) {\n        break;\n      }\n\n      const membersPage = await this._fetchMembers({ groupId, page, signal });\n      members = members.concat(membersPage.data);\n    }\n\n    return members;\n  }\n\n  private _fetchMembers({\n    groupId,\n    page = 1,\n    signal,\n  }: {\n    groupId: string;\n    page?: number;\n    signal?: AbortSignal;\n  }): Promise<GroupMembers> {\n    return this._api.group.members.read(\n      {\n        pubid: groupId,\n        'page[number]': page,\n        'page[size]': MEMBERS_PAGE_SIZE,\n      },\n      undefined,\n      signal,\n    );\n  }\n}\n","import type { Store } from 'redux';\n\n/**\n * Return an object where each key in `updateFns` is mapped to the key itself.\n *\n * @param reducers - Object containing reducer functions\n */\nexport function actionTypes<T extends Record<string, unknown>>(\n  reducers: T,\n): { [index in keyof T]: string } {\n  return Object.keys(reducers).reduce<any>((types, key) => {\n    types[key] = key;\n    return types;\n  }, {});\n}\n\n/**\n * Return a value from app state when it meets certain criteria.\n *\n * `await` returns a Promise which resolves when a selector function,\n * which reads values from a Redux store, returns non-null.\n *\n * @param selector - Function which returns a value from the store if the\n *   criteria is met or `null` otherwise.\n */\nexport function awaitStateChange<T>(\n  store: Store,\n  selector: (s: Store) => T | null,\n): Promise<T> {\n  const result = selector(store);\n  if (result !== null) {\n    return Promise.resolve(result);\n  }\n  return new Promise(resolve => {\n    const unsubscribe = store.subscribe(() => {\n      const result = selector(store);\n      if (result !== null) {\n        unsubscribe();\n        resolve(result);\n      }\n    });\n  });\n}\n","/**\n * This serves as a build time flag that will be true by default, but false in non-debug builds or if users replace `__SENTRY_DEBUG__` in their generated code.\n *\n * ATTENTION: This constant must never cross package boundaries (i.e. be exported) to guarantee that it can be used for tree shaking.\n */\nconst DEBUG_BUILD = (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__);\n\nexport { DEBUG_BUILD };\n//# sourceMappingURL=debug-build.js.map\n","/** Internal global with common properties and Sentry extensions  */\n\n/** Get's the global object for the current JavaScript runtime */\nconst GLOBAL_OBJ = globalThis ;\n\nexport { GLOBAL_OBJ };\n//# sourceMappingURL=worldwide.js.map\n","/**\n * This serves as a build time flag that will be true by default, but false in non-debug builds or if users replace `__SENTRY_DEBUG__` in their generated code.\n *\n * ATTENTION: This constant must never cross package boundaries (i.e. be exported) to guarantee that it can be used for tree shaking.\n */\nconst DEBUG_BUILD = (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__);\n\nexport { DEBUG_BUILD };\n//# sourceMappingURL=debug-build.js.map\n","// This is a magic string replaced by rollup\n\nconst SDK_VERSION = \"9.13.0\" ;\n\nexport { SDK_VERSION };\n//# sourceMappingURL=version.js.map\n","import { SDK_VERSION } from './utils-hoist/version.js';\nimport { GLOBAL_OBJ } from './utils-hoist/worldwide.js';\n\n/**\n * An object that contains globally accessible properties and maintains a scope stack.\n * @hidden\n */\n\n/**\n * Returns the global shim registry.\n *\n * FIXME: This function is problematic, because despite always returning a valid Carrier,\n * it has an optional `__SENTRY__` property, which then in turn requires us to always perform an unnecessary check\n * at the call-site. We always access the carrier through this function, so we can guarantee that `__SENTRY__` is there.\n **/\nfunction getMainCarrier() {\n  // This ensures a Sentry carrier exists\n  getSentryCarrier(GLOBAL_OBJ);\n  return GLOBAL_OBJ;\n}\n\n/** Will either get the existing sentry carrier, or create a new one. */\nfunction getSentryCarrier(carrier) {\n  const __SENTRY__ = (carrier.__SENTRY__ = carrier.__SENTRY__ || {});\n\n  // For now: First SDK that sets the .version property wins\n  __SENTRY__.version = __SENTRY__.version || SDK_VERSION;\n\n  // Intentionally populating and returning the version of \"this\" SDK instance\n  // rather than what's set in .version so that \"this\" SDK always gets its carrier\n  return (__SENTRY__[SDK_VERSION] = __SENTRY__[SDK_VERSION] || {});\n}\n\n/**\n * Returns a global singleton contained in the global `__SENTRY__[]` object.\n *\n * If the singleton doesn't already exist in `__SENTRY__`, it will be created using the given factory\n * function and added to the `__SENTRY__` object.\n *\n * @param name name of the global singleton on __SENTRY__\n * @param creator creator Factory function to create the singleton if it doesn't already exist on `__SENTRY__`\n * @param obj (Optional) The global object on which to look for `__SENTRY__`, if not `GLOBAL_OBJ`'s return value\n * @returns the singleton\n */\nfunction getGlobalSingleton(\n  name,\n  creator,\n  obj = GLOBAL_OBJ,\n) {\n  const __SENTRY__ = (obj.__SENTRY__ = obj.__SENTRY__ || {});\n  const carrier = (__SENTRY__[SDK_VERSION] = __SENTRY__[SDK_VERSION] || {});\n  // Note: We do not want to set `carrier.version` here, as this may be called before any `init` is called, e.g. for the default scopes\n  return carrier[name] || (carrier[name] = creator());\n}\n\nexport { getGlobalSingleton, getMainCarrier, getSentryCarrier };\n//# sourceMappingURL=carrier.js.map\n","import { getGlobalSingleton } from '../carrier.js';\nimport { DEBUG_BUILD } from './debug-build.js';\nimport { GLOBAL_OBJ } from './worldwide.js';\n\n/** Prefix for logging strings */\nconst PREFIX = 'Sentry Logger ';\n\nconst CONSOLE_LEVELS = [\n  'debug',\n  'info',\n  'warn',\n  'error',\n  'log',\n  'assert',\n  'trace',\n] ;\n\n/** This may be mutated by the console instrumentation. */\nconst originalConsoleMethods\n\n = {};\n\n/** A Sentry Logger instance. */\n\n/**\n * Temporarily disable sentry console instrumentations.\n *\n * @param callback The function to run against the original `console` messages\n * @returns The results of the callback\n */\nfunction consoleSandbox(callback) {\n  if (!('console' in GLOBAL_OBJ)) {\n    return callback();\n  }\n\n  const console = GLOBAL_OBJ.console ;\n  const wrappedFuncs = {};\n\n  const wrappedLevels = Object.keys(originalConsoleMethods) ;\n\n  // Restore all wrapped console methods\n  wrappedLevels.forEach(level => {\n    const originalConsoleMethod = originalConsoleMethods[level] ;\n    wrappedFuncs[level] = console[level] ;\n    console[level] = originalConsoleMethod;\n  });\n\n  try {\n    return callback();\n  } finally {\n    // Revert restoration to wrapped state\n    wrappedLevels.forEach(level => {\n      console[level] = wrappedFuncs[level] ;\n    });\n  }\n}\n\nfunction makeLogger() {\n  let enabled = false;\n  const logger = {\n    enable: () => {\n      enabled = true;\n    },\n    disable: () => {\n      enabled = false;\n    },\n    isEnabled: () => enabled,\n  };\n\n  if (DEBUG_BUILD) {\n    CONSOLE_LEVELS.forEach(name => {\n      logger[name] = (...args) => {\n        if (enabled) {\n          consoleSandbox(() => {\n            GLOBAL_OBJ.console[name](`${PREFIX}[${name}]:`, ...args);\n          });\n        }\n      };\n    });\n  } else {\n    CONSOLE_LEVELS.forEach(name => {\n      logger[name] = () => undefined;\n    });\n  }\n\n  return logger ;\n}\n\n/**\n * This is a logger singleton which either logs things or no-ops if logging is not enabled.\n * The logger is a singleton on the carrier, to ensure that a consistent logger is used throughout the SDK.\n */\nconst logger = getGlobalSingleton('logger', makeLogger);\n\nexport { CONSOLE_LEVELS, consoleSandbox, logger, originalConsoleMethods };\n//# sourceMappingURL=logger.js.map\n","const STACKTRACE_FRAME_LIMIT = 50;\nconst UNKNOWN_FUNCTION = '?';\n// Used to sanitize webpack (error: *) wrapped stack errors\nconst WEBPACK_ERROR_REGEXP = /\\(error: (.*)\\)/;\nconst STRIP_FRAME_REGEXP = /captureMessage|captureException/;\n\n/**\n * Creates a stack parser with the supplied line parsers\n *\n * StackFrames are returned in the correct order for Sentry Exception\n * frames and with Sentry SDK internal frames removed from the top and bottom\n *\n */\nfunction createStackParser(...parsers) {\n  const sortedParsers = parsers.sort((a, b) => a[0] - b[0]).map(p => p[1]);\n\n  return (stack, skipFirstLines = 0, framesToPop = 0) => {\n    const frames = [];\n    const lines = stack.split('\\n');\n\n    for (let i = skipFirstLines; i < lines.length; i++) {\n      const line = lines[i] ;\n      // Ignore lines over 1kb as they are unlikely to be stack frames.\n      // Many of the regular expressions use backtracking which results in run time that increases exponentially with\n      // input size. Huge strings can result in hangs/Denial of Service:\n      // https://github.com/getsentry/sentry-javascript/issues/2286\n      if (line.length > 1024) {\n        continue;\n      }\n\n      // https://github.com/getsentry/sentry-javascript/issues/5459\n      // Remove webpack (error: *) wrappers\n      const cleanedLine = WEBPACK_ERROR_REGEXP.test(line) ? line.replace(WEBPACK_ERROR_REGEXP, '$1') : line;\n\n      // https://github.com/getsentry/sentry-javascript/issues/7813\n      // Skip Error: lines\n      if (cleanedLine.match(/\\S*Error: /)) {\n        continue;\n      }\n\n      for (const parser of sortedParsers) {\n        const frame = parser(cleanedLine);\n\n        if (frame) {\n          frames.push(frame);\n          break;\n        }\n      }\n\n      if (frames.length >= STACKTRACE_FRAME_LIMIT + framesToPop) {\n        break;\n      }\n    }\n\n    return stripSentryFramesAndReverse(frames.slice(framesToPop));\n  };\n}\n\n/**\n * Gets a stack parser implementation from Options.stackParser\n * @see Options\n *\n * If options contains an array of line parsers, it is converted into a parser\n */\nfunction stackParserFromStackParserOptions(stackParser) {\n  if (Array.isArray(stackParser)) {\n    return createStackParser(...stackParser);\n  }\n  return stackParser;\n}\n\n/**\n * Removes Sentry frames from the top and bottom of the stack if present and enforces a limit of max number of frames.\n * Assumes stack input is ordered from top to bottom and returns the reverse representation so call site of the\n * function that caused the crash is the last frame in the array.\n * @hidden\n */\nfunction stripSentryFramesAndReverse(stack) {\n  if (!stack.length) {\n    return [];\n  }\n\n  const localStack = Array.from(stack);\n\n  // If stack starts with one of our API calls, remove it (starts, meaning it's the top of the stack - aka last call)\n  if (/sentryWrapped/.test(getLastStackFrame(localStack).function || '')) {\n    localStack.pop();\n  }\n\n  // Reversing in the middle of the procedure allows us to just pop the values off the stack\n  localStack.reverse();\n\n  // If stack ends with one of our internal API calls, remove it (ends, meaning it's the bottom of the stack - aka top-most call)\n  if (STRIP_FRAME_REGEXP.test(getLastStackFrame(localStack).function || '')) {\n    localStack.pop();\n\n    // When using synthetic events, we will have a 2 levels deep stack, as `new Error('Sentry syntheticException')`\n    // is produced within the scope itself, making it:\n    //\n    //   Sentry.captureException()\n    //   scope.captureException()\n    //\n    // instead of just the top `Sentry` call itself.\n    // This forces us to possibly strip an additional frame in the exact same was as above.\n    if (STRIP_FRAME_REGEXP.test(getLastStackFrame(localStack).function || '')) {\n      localStack.pop();\n    }\n  }\n\n  return localStack.slice(0, STACKTRACE_FRAME_LIMIT).map(frame => ({\n    ...frame,\n    filename: frame.filename || getLastStackFrame(localStack).filename,\n    function: frame.function || UNKNOWN_FUNCTION,\n  }));\n}\n\nfunction getLastStackFrame(arr) {\n  return arr[arr.length - 1] || {};\n}\n\nconst defaultFunctionName = '<anonymous>';\n\n/**\n * Safely extract function name from itself\n */\nfunction getFunctionName(fn) {\n  try {\n    if (!fn || typeof fn !== 'function') {\n      return defaultFunctionName;\n    }\n    return fn.name || defaultFunctionName;\n  } catch (e) {\n    // Just accessing custom props in some Selenium environments\n    // can cause a \"Permission denied\" exception (see raven-js#495).\n    return defaultFunctionName;\n  }\n}\n\n/**\n * Get's stack frames from an event without needing to check for undefined properties.\n */\nfunction getFramesFromEvent(event) {\n  const exception = event.exception;\n\n  if (exception) {\n    const frames = [];\n    try {\n      // @ts-expect-error Object could be undefined\n      exception.values.forEach(value => {\n        // @ts-expect-error Value could be undefined\n        if (value.stacktrace.frames) {\n          // @ts-expect-error Value could be undefined\n          frames.push(...value.stacktrace.frames);\n        }\n      });\n      return frames;\n    } catch (_oO) {\n      return undefined;\n    }\n  }\n  return undefined;\n}\n\nexport { UNKNOWN_FUNCTION, createStackParser, getFramesFromEvent, getFunctionName, stackParserFromStackParserOptions, stripSentryFramesAndReverse };\n//# sourceMappingURL=stacktrace.js.map\n","import { DEBUG_BUILD } from '../debug-build.js';\nimport { logger } from '../logger.js';\nimport { getFunctionName } from '../stacktrace.js';\n\n// We keep the handlers globally\nconst handlers = {};\nconst instrumented = {};\n\n/** Add a handler function. */\nfunction addHandler(type, handler) {\n  handlers[type] = handlers[type] || [];\n  (handlers[type] ).push(handler);\n}\n\n/**\n * Reset all instrumentation handlers.\n * This can be used by tests to ensure we have a clean slate of instrumentation handlers.\n */\nfunction resetInstrumentationHandlers() {\n  Object.keys(handlers).forEach(key => {\n    handlers[key ] = undefined;\n  });\n}\n\n/** Maybe run an instrumentation function, unless it was already called. */\nfunction maybeInstrument(type, instrumentFn) {\n  if (!instrumented[type]) {\n    instrumented[type] = true;\n    try {\n      instrumentFn();\n    } catch (e) {\n      DEBUG_BUILD && logger.error(`Error while instrumenting ${type}`, e);\n    }\n  }\n}\n\n/** Trigger handlers for a given instrumentation type. */\nfunction triggerHandlers(type, data) {\n  const typeHandlers = type && handlers[type];\n  if (!typeHandlers) {\n    return;\n  }\n\n  for (const handler of typeHandlers) {\n    try {\n      handler(data);\n    } catch (e) {\n      DEBUG_BUILD &&\n        logger.error(\n          `Error while triggering instrumentation handler.\\nType: ${type}\\nName: ${getFunctionName(handler)}\\nError:`,\n          e,\n        );\n    }\n  }\n}\n\nexport { addHandler, maybeInstrument, resetInstrumentationHandlers, triggerHandlers };\n//# sourceMappingURL=handlers.js.map\n","import { GLOBAL_OBJ } from '../worldwide.js';\nimport { addHandler, maybeInstrument, triggerHandlers } from './handlers.js';\n\nlet _oldOnErrorHandler = null;\n\n/**\n * Add an instrumentation handler for when an error is captured by the global error handler.\n *\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nfunction addGlobalErrorInstrumentationHandler(handler) {\n  const type = 'error';\n  addHandler(type, handler);\n  maybeInstrument(type, instrumentError);\n}\n\nfunction instrumentError() {\n  _oldOnErrorHandler = GLOBAL_OBJ.onerror;\n\n  // Note: The reason we are doing window.onerror instead of window.addEventListener('error')\n  // is that we are using this handler in the Loader Script, to handle buffered errors consistently\n  GLOBAL_OBJ.onerror = function (\n    msg,\n    url,\n    line,\n    column,\n    error,\n  ) {\n    const handlerData = {\n      column,\n      error,\n      line,\n      msg,\n      url,\n    };\n    triggerHandlers('error', handlerData);\n\n    if (_oldOnErrorHandler) {\n      // eslint-disable-next-line prefer-rest-params\n      return _oldOnErrorHandler.apply(this, arguments);\n    }\n\n    return false;\n  };\n\n  GLOBAL_OBJ.onerror.__SENTRY_INSTRUMENTED__ = true;\n}\n\nexport { addGlobalErrorInstrumentationHandler };\n//# sourceMappingURL=globalError.js.map\n","import { GLOBAL_OBJ } from '../worldwide.js';\nimport { addHandler, maybeInstrument, triggerHandlers } from './handlers.js';\n\nlet _oldOnUnhandledRejectionHandler = null;\n\n/**\n * Add an instrumentation handler for when an unhandled promise rejection is captured.\n *\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nfunction addGlobalUnhandledRejectionInstrumentationHandler(\n  handler,\n) {\n  const type = 'unhandledrejection';\n  addHandler(type, handler);\n  maybeInstrument(type, instrumentUnhandledRejection);\n}\n\nfunction instrumentUnhandledRejection() {\n  _oldOnUnhandledRejectionHandler = GLOBAL_OBJ.onunhandledrejection;\n\n  // Note: The reason we are doing window.onunhandledrejection instead of window.addEventListener('unhandledrejection')\n  // is that we are using this handler in the Loader Script, to handle buffered rejections consistently\n  GLOBAL_OBJ.onunhandledrejection = function (e) {\n    const handlerData = e;\n    triggerHandlers('unhandledrejection', handlerData);\n\n    if (_oldOnUnhandledRejectionHandler) {\n      // eslint-disable-next-line prefer-rest-params\n      return _oldOnUnhandledRejectionHandler.apply(this, arguments);\n    }\n\n    return true;\n  };\n\n  GLOBAL_OBJ.onunhandledrejection.__SENTRY_INSTRUMENTED__ = true;\n}\n\nexport { addGlobalUnhandledRejectionInstrumentationHandler };\n//# sourceMappingURL=globalUnhandledRejection.js.map\n","import { GLOBAL_OBJ } from './worldwide.js';\n\nconst ONE_SECOND_IN_MS = 1000;\n\n/**\n * A partial definition of the [Performance Web API]{@link https://developer.mozilla.org/en-US/docs/Web/API/Performance}\n * for accessing a high-resolution monotonic clock.\n */\n\n/**\n * Returns a timestamp in seconds since the UNIX epoch using the Date API.\n */\nfunction dateTimestampInSeconds() {\n  return Date.now() / ONE_SECOND_IN_MS;\n}\n\n/**\n * Returns a wrapper around the native Performance API browser implementation, or undefined for browsers that do not\n * support the API.\n *\n * Wrapping the native API works around differences in behavior from different browsers.\n */\nfunction createUnixTimestampInSecondsFunc() {\n  const { performance } = GLOBAL_OBJ ;\n  if (!performance?.now) {\n    return dateTimestampInSeconds;\n  }\n\n  // Some browser and environments don't have a timeOrigin, so we fallback to\n  // using Date.now() to compute the starting time.\n  const approxStartingTimeOrigin = Date.now() - performance.now();\n  const timeOrigin = performance.timeOrigin == undefined ? approxStartingTimeOrigin : performance.timeOrigin;\n\n  // performance.now() is a monotonic clock, which means it starts at 0 when the process begins. To get the current\n  // wall clock time (actual UNIX timestamp), we need to add the starting time origin and the current time elapsed.\n  //\n  // TODO: This does not account for the case where the monotonic clock that powers performance.now() drifts from the\n  // wall clock time, which causes the returned timestamp to be inaccurate. We should investigate how to detect and\n  // correct for this.\n  // See: https://github.com/getsentry/sentry-javascript/issues/2590\n  // See: https://github.com/mdn/content/issues/4713\n  // See: https://dev.to/noamr/when-a-millisecond-is-not-a-millisecond-3h6\n  return () => {\n    return (timeOrigin + performance.now()) / ONE_SECOND_IN_MS;\n  };\n}\n\n/**\n * Returns a timestamp in seconds since the UNIX epoch using either the Performance or Date APIs, depending on the\n * availability of the Performance API.\n *\n * BUG: Note that because of how browsers implement the Performance API, the clock might stop when the computer is\n * asleep. This creates a skew between `dateTimestampInSeconds` and `timestampInSeconds`. The\n * skew can grow to arbitrary amounts like days, weeks or months.\n * See https://github.com/getsentry/sentry-javascript/issues/2590.\n */\nconst timestampInSeconds = createUnixTimestampInSecondsFunc();\n\n/**\n * Cached result of getBrowserTimeOrigin.\n */\nlet cachedTimeOrigin;\n\n/**\n * Gets the time origin and the mode used to determine it.\n */\nfunction getBrowserTimeOrigin() {\n  // Unfortunately browsers may report an inaccurate time origin data, through either performance.timeOrigin or\n  // performance.timing.navigationStart, which results in poor results in performance data. We only treat time origin\n  // data as reliable if they are within a reasonable threshold of the current time.\n\n  const { performance } = GLOBAL_OBJ ;\n  if (!performance?.now) {\n    return [undefined, 'none'];\n  }\n\n  const threshold = 3600 * 1000;\n  const performanceNow = performance.now();\n  const dateNow = Date.now();\n\n  // if timeOrigin isn't available set delta to threshold so it isn't used\n  const timeOriginDelta = performance.timeOrigin\n    ? Math.abs(performance.timeOrigin + performanceNow - dateNow)\n    : threshold;\n  const timeOriginIsReliable = timeOriginDelta < threshold;\n\n  // While performance.timing.navigationStart is deprecated in favor of performance.timeOrigin, performance.timeOrigin\n  // is not as widely supported. Namely, performance.timeOrigin is undefined in Safari as of writing.\n  // Also as of writing, performance.timing is not available in Web Workers in mainstream browsers, so it is not always\n  // a valid fallback. In the absence of an initial time provided by the browser, fallback to the current time from the\n  // Date API.\n  // eslint-disable-next-line deprecation/deprecation\n  const navigationStart = performance.timing?.navigationStart;\n  const hasNavigationStart = typeof navigationStart === 'number';\n  // if navigationStart isn't available set delta to threshold so it isn't used\n  const navigationStartDelta = hasNavigationStart ? Math.abs(navigationStart + performanceNow - dateNow) : threshold;\n  const navigationStartIsReliable = navigationStartDelta < threshold;\n\n  if (timeOriginIsReliable || navigationStartIsReliable) {\n    // Use the more reliable time origin\n    if (timeOriginDelta <= navigationStartDelta) {\n      return [performance.timeOrigin, 'timeOrigin'];\n    } else {\n      return [navigationStart, 'navigationStart'];\n    }\n  }\n\n  // Either both timeOrigin and navigationStart are skewed or neither is available, fallback to Date.\n  return [dateNow, 'dateNow'];\n}\n\n/**\n * The number of milliseconds since the UNIX epoch. This value is only usable in a browser, and only when the\n * performance API is available.\n */\nfunction browserPerformanceTimeOrigin() {\n  if (!cachedTimeOrigin) {\n    cachedTimeOrigin = getBrowserTimeOrigin();\n  }\n\n  return cachedTimeOrigin[0];\n}\n\nexport { browserPerformanceTimeOrigin, dateTimestampInSeconds, timestampInSeconds };\n//# sourceMappingURL=time.js.map\n","// eslint-disable-next-line @typescript-eslint/unbound-method\nconst objectToString = Object.prototype.toString;\n\n/**\n * Checks whether given value's type is one of a few Error or Error-like\n * {@link isError}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isError(wat) {\n  switch (objectToString.call(wat)) {\n    case '[object Error]':\n    case '[object Exception]':\n    case '[object DOMException]':\n    case '[object WebAssembly.Exception]':\n      return true;\n    default:\n      return isInstanceOf(wat, Error);\n  }\n}\n/**\n * Checks whether given value is an instance of the given built-in class.\n *\n * @param wat The value to be checked\n * @param className\n * @returns A boolean representing the result.\n */\nfunction isBuiltin(wat, className) {\n  return objectToString.call(wat) === `[object ${className}]`;\n}\n\n/**\n * Checks whether given value's type is ErrorEvent\n * {@link isErrorEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isErrorEvent(wat) {\n  return isBuiltin(wat, 'ErrorEvent');\n}\n\n/**\n * Checks whether given value's type is DOMError\n * {@link isDOMError}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isDOMError(wat) {\n  return isBuiltin(wat, 'DOMError');\n}\n\n/**\n * Checks whether given value's type is DOMException\n * {@link isDOMException}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isDOMException(wat) {\n  return isBuiltin(wat, 'DOMException');\n}\n\n/**\n * Checks whether given value's type is a string\n * {@link isString}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isString(wat) {\n  return isBuiltin(wat, 'String');\n}\n\n/**\n * Checks whether given string is parameterized\n * {@link isParameterizedString}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isParameterizedString(wat) {\n  return (\n    typeof wat === 'object' &&\n    wat !== null &&\n    '__sentry_template_string__' in wat &&\n    '__sentry_template_values__' in wat\n  );\n}\n\n/**\n * Checks whether given value is a primitive (undefined, null, number, boolean, string, bigint, symbol)\n * {@link isPrimitive}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isPrimitive(wat) {\n  return wat === null || isParameterizedString(wat) || (typeof wat !== 'object' && typeof wat !== 'function');\n}\n\n/**\n * Checks whether given value's type is an object literal, or a class instance.\n * {@link isPlainObject}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isPlainObject(wat) {\n  return isBuiltin(wat, 'Object');\n}\n\n/**\n * Checks whether given value's type is an Event instance\n * {@link isEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isEvent(wat) {\n  return typeof Event !== 'undefined' && isInstanceOf(wat, Event);\n}\n\n/**\n * Checks whether given value's type is an Element instance\n * {@link isElement}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isElement(wat) {\n  return typeof Element !== 'undefined' && isInstanceOf(wat, Element);\n}\n\n/**\n * Checks whether given value's type is an regexp\n * {@link isRegExp}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isRegExp(wat) {\n  return isBuiltin(wat, 'RegExp');\n}\n\n/**\n * Checks whether given value has a then function.\n * @param wat A value to be checked.\n */\nfunction isThenable(wat) {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  return Boolean(wat?.then && typeof wat.then === 'function');\n}\n\n/**\n * Checks whether given value's type is a SyntheticEvent\n * {@link isSyntheticEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isSyntheticEvent(wat) {\n  return isPlainObject(wat) && 'nativeEvent' in wat && 'preventDefault' in wat && 'stopPropagation' in wat;\n}\n\n/**\n * Checks whether given value's type is an instance of provided constructor.\n * {@link isInstanceOf}.\n *\n * @param wat A value to be checked.\n * @param base A constructor to be used in a check.\n * @returns A boolean representing the result.\n */\nfunction isInstanceOf(wat, base) {\n  try {\n    return wat instanceof base;\n  } catch (_e) {\n    return false;\n  }\n}\n\n/**\n * Checks whether given value's type is a Vue ViewModel.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nfunction isVueViewModel(wat) {\n  // Not using Object.prototype.toString because in Vue 3 it would read the instance's Symbol(Symbol.toStringTag) property.\n  return !!(typeof wat === 'object' && wat !== null && ((wat ).__isVue || (wat )._isVue));\n}\n\n/**\n * Checks whether the given parameter is a Standard Web API Request instance.\n *\n * Returns false if Request is not available in the current runtime.\n */\nfunction isRequest(request) {\n  return typeof Request !== 'undefined' && isInstanceOf(request, Request);\n}\n\nexport { isDOMError, isDOMException, isElement, isError, isErrorEvent, isEvent, isInstanceOf, isParameterizedString, isPlainObject, isPrimitive, isRegExp, isRequest, isString, isSyntheticEvent, isThenable, isVueViewModel };\n//# sourceMappingURL=is.js.map\n","import { isString } from './is.js';\nimport { GLOBAL_OBJ } from './worldwide.js';\n\nconst WINDOW = GLOBAL_OBJ ;\n\nconst DEFAULT_MAX_STRING_LENGTH = 80;\n\n/**\n * Given a child DOM element, returns a query-selector statement describing that\n * and its ancestors\n * e.g. [HTMLElement] => body > div > input#foo.btn[name=baz]\n * @returns generated DOM path\n */\nfunction htmlTreeAsString(\n  elem,\n  options = {},\n) {\n  if (!elem) {\n    return '<unknown>';\n  }\n\n  // try/catch both:\n  // - accessing event.target (see getsentry/raven-js#838, #768)\n  // - `htmlTreeAsString` because it's complex, and just accessing the DOM incorrectly\n  // - can throw an exception in some circumstances.\n  try {\n    let currentElem = elem ;\n    const MAX_TRAVERSE_HEIGHT = 5;\n    const out = [];\n    let height = 0;\n    let len = 0;\n    const separator = ' > ';\n    const sepLength = separator.length;\n    let nextStr;\n    const keyAttrs = Array.isArray(options) ? options : options.keyAttrs;\n    const maxStringLength = (!Array.isArray(options) && options.maxStringLength) || DEFAULT_MAX_STRING_LENGTH;\n\n    while (currentElem && height++ < MAX_TRAVERSE_HEIGHT) {\n      nextStr = _htmlElementAsString(currentElem, keyAttrs);\n      // bail out if\n      // - nextStr is the 'html' element\n      // - the length of the string that would be created exceeds maxStringLength\n      //   (ignore this limit if we are on the first iteration)\n      if (nextStr === 'html' || (height > 1 && len + out.length * sepLength + nextStr.length >= maxStringLength)) {\n        break;\n      }\n\n      out.push(nextStr);\n\n      len += nextStr.length;\n      currentElem = currentElem.parentNode;\n    }\n\n    return out.reverse().join(separator);\n  } catch (_oO) {\n    return '<unknown>';\n  }\n}\n\n/**\n * Returns a simple, query-selector representation of a DOM element\n * e.g. [HTMLElement] => input#foo.btn[name=baz]\n * @returns generated DOM path\n */\nfunction _htmlElementAsString(el, keyAttrs) {\n  const elem = el\n\n;\n\n  const out = [];\n\n  if (!elem?.tagName) {\n    return '';\n  }\n\n  // @ts-expect-error WINDOW has HTMLElement\n  if (WINDOW.HTMLElement) {\n    // If using the component name annotation plugin, this value may be available on the DOM node\n    if (elem instanceof HTMLElement && elem.dataset) {\n      if (elem.dataset['sentryComponent']) {\n        return elem.dataset['sentryComponent'];\n      }\n      if (elem.dataset['sentryElement']) {\n        return elem.dataset['sentryElement'];\n      }\n    }\n  }\n\n  out.push(elem.tagName.toLowerCase());\n\n  // Pairs of attribute keys defined in `serializeAttribute` and their values on element.\n  const keyAttrPairs = keyAttrs?.length\n    ? keyAttrs.filter(keyAttr => elem.getAttribute(keyAttr)).map(keyAttr => [keyAttr, elem.getAttribute(keyAttr)])\n    : null;\n\n  if (keyAttrPairs?.length) {\n    keyAttrPairs.forEach(keyAttrPair => {\n      out.push(`[${keyAttrPair[0]}=\"${keyAttrPair[1]}\"]`);\n    });\n  } else {\n    if (elem.id) {\n      out.push(`#${elem.id}`);\n    }\n\n    const className = elem.className;\n    if (className && isString(className)) {\n      const classes = className.split(/\\s+/);\n      for (const c of classes) {\n        out.push(`.${c}`);\n      }\n    }\n  }\n  const allowedAttrs = ['aria-label', 'type', 'name', 'title', 'alt'];\n  for (const k of allowedAttrs) {\n    const attr = elem.getAttribute(k);\n    if (attr) {\n      out.push(`[${k}=\"${attr}\"]`);\n    }\n  }\n\n  return out.join('');\n}\n\n/**\n * A safe form of location.href\n */\nfunction getLocationHref() {\n  try {\n    return WINDOW.document.location.href;\n  } catch (oO) {\n    return '';\n  }\n}\n\n/**\n * Given a DOM element, traverses up the tree until it finds the first ancestor node\n * that has the `data-sentry-component` or `data-sentry-element` attribute with `data-sentry-component` taking\n * precedence. This attribute is added at build-time by projects that have the component name annotation plugin installed.\n *\n * @returns a string representation of the component for the provided DOM element, or `null` if not found\n */\nfunction getComponentName(elem) {\n  // @ts-expect-error WINDOW has HTMLElement\n  if (!WINDOW.HTMLElement) {\n    return null;\n  }\n\n  let currentElem = elem ;\n  const MAX_TRAVERSE_HEIGHT = 5;\n  for (let i = 0; i < MAX_TRAVERSE_HEIGHT; i++) {\n    if (!currentElem) {\n      return null;\n    }\n\n    if (currentElem instanceof HTMLElement) {\n      if (currentElem.dataset['sentryComponent']) {\n        return currentElem.dataset['sentryComponent'];\n      }\n      if (currentElem.dataset['sentryElement']) {\n        return currentElem.dataset['sentryElement'];\n      }\n    }\n\n    currentElem = currentElem.parentNode;\n  }\n\n  return null;\n}\n\nexport { getComponentName, getLocationHref, htmlTreeAsString };\n//# sourceMappingURL=browser.js.map\n","import { isString, isRegExp, isVueViewModel } from './is.js';\n\n/**\n * Truncates given string to the maximum characters count\n *\n * @param str An object that contains serializable values\n * @param max Maximum number of characters in truncated string (0 = unlimited)\n * @returns string Encoded\n */\nfunction truncate(str, max = 0) {\n  if (typeof str !== 'string' || max === 0) {\n    return str;\n  }\n  return str.length <= max ? str : `${str.slice(0, max)}...`;\n}\n\n/**\n * This is basically just `trim_line` from\n * https://github.com/getsentry/sentry/blob/master/src/sentry/lang/javascript/processor.py#L67\n *\n * @param str An object that contains serializable values\n * @param max Maximum number of characters in truncated string\n * @returns string Encoded\n */\nfunction snipLine(line, colno) {\n  let newLine = line;\n  const lineLength = newLine.length;\n  if (lineLength <= 150) {\n    return newLine;\n  }\n  if (colno > lineLength) {\n    // eslint-disable-next-line no-param-reassign\n    colno = lineLength;\n  }\n\n  let start = Math.max(colno - 60, 0);\n  if (start < 5) {\n    start = 0;\n  }\n\n  let end = Math.min(start + 140, lineLength);\n  if (end > lineLength - 5) {\n    end = lineLength;\n  }\n  if (end === lineLength) {\n    start = Math.max(end - 140, 0);\n  }\n\n  newLine = newLine.slice(start, end);\n  if (start > 0) {\n    newLine = `'{snip} ${newLine}`;\n  }\n  if (end < lineLength) {\n    newLine += ' {snip}';\n  }\n\n  return newLine;\n}\n\n/**\n * Join values in array\n * @param input array of values to be joined together\n * @param delimiter string to be placed in-between values\n * @returns Joined values\n */\nfunction safeJoin(input, delimiter) {\n  if (!Array.isArray(input)) {\n    return '';\n  }\n\n  const output = [];\n  // eslint-disable-next-line @typescript-eslint/prefer-for-of\n  for (let i = 0; i < input.length; i++) {\n    const value = input[i];\n    try {\n      // This is a hack to fix a Vue3-specific bug that causes an infinite loop of\n      // console warnings. This happens when a Vue template is rendered with\n      // an undeclared variable, which we try to stringify, ultimately causing\n      // Vue to issue another warning which repeats indefinitely.\n      // see: https://github.com/getsentry/sentry-javascript/pull/8981\n      if (isVueViewModel(value)) {\n        output.push('[VueViewModel]');\n      } else {\n        output.push(String(value));\n      }\n    } catch (e) {\n      output.push('[value cannot be serialized]');\n    }\n  }\n\n  return output.join(delimiter);\n}\n\n/**\n * Checks if the given value matches a regex or string\n *\n * @param value The string to test\n * @param pattern Either a regex or a string against which `value` will be matched\n * @param requireExactStringMatch If true, `value` must match `pattern` exactly. If false, `value` will match\n * `pattern` if it contains `pattern`. Only applies to string-type patterns.\n */\nfunction isMatchingPattern(\n  value,\n  pattern,\n  requireExactStringMatch = false,\n) {\n  if (!isString(value)) {\n    return false;\n  }\n\n  if (isRegExp(pattern)) {\n    return pattern.test(value);\n  }\n  if (isString(pattern)) {\n    return requireExactStringMatch ? value === pattern : value.includes(pattern);\n  }\n\n  return false;\n}\n\n/**\n * Test the given string against an array of strings and regexes. By default, string matching is done on a\n * substring-inclusion basis rather than a strict equality basis\n *\n * @param testString The string to test\n * @param patterns The patterns against which to test the string\n * @param requireExactStringMatch If true, `testString` must match one of the given string patterns exactly in order to\n * count. If false, `testString` will match a string pattern if it contains that pattern.\n * @returns\n */\nfunction stringMatchesSomePattern(\n  testString,\n  patterns = [],\n  requireExactStringMatch = false,\n) {\n  return patterns.some(pattern => isMatchingPattern(testString, pattern, requireExactStringMatch));\n}\n\nexport { isMatchingPattern, safeJoin, snipLine, stringMatchesSomePattern, truncate };\n//# sourceMappingURL=string.js.map\n","import { htmlTreeAsString } from './browser.js';\nimport { DEBUG_BUILD } from './debug-build.js';\nimport { isError, isEvent, isInstanceOf, isPrimitive, isElement } from './is.js';\nimport { logger } from './logger.js';\nimport { truncate } from './string.js';\n\n/**\n * Replace a method in an object with a wrapped version of itself.\n *\n * If the method on the passed object is not a function, the wrapper will not be applied.\n *\n * @param source An object that contains a method to be wrapped.\n * @param name The name of the method to be wrapped.\n * @param replacementFactory A higher-order function that takes the original version of the given method and returns a\n * wrapped version. Note: The function returned by `replacementFactory` needs to be a non-arrow function, in order to\n * preserve the correct value of `this`, and the original method must be called using `origMethod.call(this, <other\n * args>)` or `origMethod.apply(this, [<other args>])` (rather than being called directly), again to preserve `this`.\n * @returns void\n */\nfunction fill(source, name, replacementFactory) {\n  if (!(name in source)) {\n    return;\n  }\n\n  // explicitly casting to unknown because we don't know the type of the method initially at all\n  const original = source[name] ;\n\n  if (typeof original !== 'function') {\n    return;\n  }\n\n  const wrapped = replacementFactory(original) ;\n\n  // Make sure it's a function first, as we need to attach an empty prototype for `defineProperties` to work\n  // otherwise it'll throw \"TypeError: Object.defineProperties called on non-object\"\n  if (typeof wrapped === 'function') {\n    markFunctionWrapped(wrapped, original);\n  }\n\n  try {\n    source[name] = wrapped;\n  } catch {\n    DEBUG_BUILD && logger.log(`Failed to replace method \"${name}\" in object`, source);\n  }\n}\n\n/**\n * Defines a non-enumerable property on the given object.\n *\n * @param obj The object on which to set the property\n * @param name The name of the property to be set\n * @param value The value to which to set the property\n */\nfunction addNonEnumerableProperty(obj, name, value) {\n  try {\n    Object.defineProperty(obj, name, {\n      // enumerable: false, // the default, so we can save on bundle size by not explicitly setting it\n      value: value,\n      writable: true,\n      configurable: true,\n    });\n  } catch (o_O) {\n    DEBUG_BUILD && logger.log(`Failed to add non-enumerable property \"${name}\" to object`, obj);\n  }\n}\n\n/**\n * Remembers the original function on the wrapped function and\n * patches up the prototype.\n *\n * @param wrapped the wrapper function\n * @param original the original function that gets wrapped\n */\nfunction markFunctionWrapped(wrapped, original) {\n  try {\n    const proto = original.prototype || {};\n    wrapped.prototype = original.prototype = proto;\n    addNonEnumerableProperty(wrapped, '__sentry_original__', original);\n  } catch (o_O) {} // eslint-disable-line no-empty\n}\n\n/**\n * This extracts the original function if available.  See\n * `markFunctionWrapped` for more information.\n *\n * @param func the function to unwrap\n * @returns the unwrapped version of the function if available.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction getOriginalFunction(func) {\n  return func.__sentry_original__;\n}\n\n/**\n * Transforms any `Error` or `Event` into a plain object with all of their enumerable properties, and some of their\n * non-enumerable properties attached.\n *\n * @param value Initial source that we have to transform in order for it to be usable by the serializer\n * @returns An Event or Error turned into an object - or the value argument itself, when value is neither an Event nor\n *  an Error.\n */\nfunction convertToPlainObject(value)\n\n {\n  if (isError(value)) {\n    return {\n      message: value.message,\n      name: value.name,\n      stack: value.stack,\n      ...getOwnProperties(value),\n    };\n  } else if (isEvent(value)) {\n    const newObj\n\n = {\n      type: value.type,\n      target: serializeEventTarget(value.target),\n      currentTarget: serializeEventTarget(value.currentTarget),\n      ...getOwnProperties(value),\n    };\n\n    if (typeof CustomEvent !== 'undefined' && isInstanceOf(value, CustomEvent)) {\n      newObj.detail = value.detail;\n    }\n\n    return newObj;\n  } else {\n    return value;\n  }\n}\n\n/** Creates a string representation of the target of an `Event` object */\nfunction serializeEventTarget(target) {\n  try {\n    return isElement(target) ? htmlTreeAsString(target) : Object.prototype.toString.call(target);\n  } catch (_oO) {\n    return '<unknown>';\n  }\n}\n\n/** Filters out all but an object's own properties */\nfunction getOwnProperties(obj) {\n  if (typeof obj === 'object' && obj !== null) {\n    const extractedProps = {};\n    for (const property in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, property)) {\n        extractedProps[property] = (obj )[property];\n      }\n    }\n    return extractedProps;\n  } else {\n    return {};\n  }\n}\n\n/**\n * Given any captured exception, extract its keys and create a sorted\n * and truncated list that will be used inside the event message.\n * eg. `Non-error exception captured with keys: foo, bar, baz`\n */\nfunction extractExceptionKeysForMessage(exception, maxLength = 40) {\n  const keys = Object.keys(convertToPlainObject(exception));\n  keys.sort();\n\n  const firstKey = keys[0];\n\n  if (!firstKey) {\n    return '[object has no keys]';\n  }\n\n  if (firstKey.length >= maxLength) {\n    return truncate(firstKey, maxLength);\n  }\n\n  for (let includedKeys = keys.length; includedKeys > 0; includedKeys--) {\n    const serialized = keys.slice(0, includedKeys).join(', ');\n    if (serialized.length > maxLength) {\n      continue;\n    }\n    if (includedKeys === keys.length) {\n      return serialized;\n    }\n    return truncate(serialized, maxLength);\n  }\n\n  return '';\n}\n\n/**\n * Given any object, return a new object having removed all fields whose value was `undefined`.\n * Works recursively on objects and arrays.\n *\n * Attention: This function keeps circular references in the returned object.\n *\n * @deprecated This function is no longer used by the SDK and will be removed in a future major version.\n */\nfunction dropUndefinedKeys(inputValue) {\n  // This map keeps track of what already visited nodes map to.\n  // Our Set - based memoBuilder doesn't work here because we want to the output object to have the same circular\n  // references as the input object.\n  const memoizationMap = new Map();\n\n  // This function just proxies `_dropUndefinedKeys` to keep the `memoBuilder` out of this function's API\n  return _dropUndefinedKeys(inputValue, memoizationMap);\n}\n\nfunction _dropUndefinedKeys(inputValue, memoizationMap) {\n  // Early return for primitive values\n  if (inputValue === null || typeof inputValue !== 'object') {\n    return inputValue;\n  }\n\n  // Check memo map first for all object types\n  const memoVal = memoizationMap.get(inputValue);\n  if (memoVal !== undefined) {\n    return memoVal ;\n  }\n\n  // handle arrays\n  if (Array.isArray(inputValue)) {\n    const returnValue = [];\n    // Store mapping to handle circular references\n    memoizationMap.set(inputValue, returnValue);\n\n    inputValue.forEach(value => {\n      returnValue.push(_dropUndefinedKeys(value, memoizationMap));\n    });\n\n    return returnValue ;\n  }\n\n  if (isPojo(inputValue)) {\n    const returnValue = {};\n    // Store mapping to handle circular references\n    memoizationMap.set(inputValue, returnValue);\n\n    const keys = Object.keys(inputValue);\n\n    keys.forEach(key => {\n      const val = inputValue[key];\n      if (val !== undefined) {\n        returnValue[key] = _dropUndefinedKeys(val, memoizationMap);\n      }\n    });\n\n    return returnValue ;\n  }\n\n  // For other object types, return as is\n  return inputValue;\n}\n\nfunction isPojo(input) {\n  // Plain objects have Object as constructor or no constructor\n  const constructor = (input ).constructor;\n  return constructor === Object || constructor === undefined;\n}\n\n/**\n * Ensure that something is an object.\n *\n * Turns `undefined` and `null` into `String`s and all other primitives into instances of their respective wrapper\n * classes (String, Boolean, Number, etc.). Acts as the identity function on non-primitives.\n *\n * @param wat The subject of the objectification\n * @returns A version of `wat` which can safely be used with `Object` class methods\n */\nfunction objectify(wat) {\n  let objectified;\n  switch (true) {\n    // this will catch both undefined and null\n    case wat == undefined:\n      objectified = new String(wat);\n      break;\n\n    // Though symbols and bigints do have wrapper classes (`Symbol` and `BigInt`, respectively), for whatever reason\n    // those classes don't have constructors which can be used with the `new` keyword. We therefore need to cast each as\n    // an object in order to wrap it.\n    case typeof wat === 'symbol' || typeof wat === 'bigint':\n      objectified = Object(wat);\n      break;\n\n    // this will catch the remaining primitives: `String`, `Number`, and `Boolean`\n    case isPrimitive(wat):\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      objectified = new (wat ).constructor(wat);\n      break;\n\n    // by process of elimination, at this point we know that `wat` must already be an object\n    default:\n      objectified = wat;\n      break;\n  }\n  return objectified;\n}\n\nexport { addNonEnumerableProperty, convertToPlainObject, dropUndefinedKeys, extractExceptionKeysForMessage, fill, getOriginalFunction, markFunctionWrapped, objectify };\n//# sourceMappingURL=object.js.map\n","import { addNonEnumerableProperty } from './object.js';\nimport { snipLine } from './string.js';\nimport { GLOBAL_OBJ } from './worldwide.js';\n\nfunction getCrypto() {\n  const gbl = GLOBAL_OBJ ;\n  return gbl.crypto || gbl.msCrypto;\n}\n\n/**\n * UUID4 generator\n * @param crypto Object that provides the crypto API.\n * @returns string Generated UUID4.\n */\nfunction uuid4(crypto = getCrypto()) {\n  let getRandomByte = () => Math.random() * 16;\n  try {\n    if (crypto?.randomUUID) {\n      return crypto.randomUUID().replace(/-/g, '');\n    }\n    if (crypto?.getRandomValues) {\n      getRandomByte = () => {\n        // crypto.getRandomValues might return undefined instead of the typed array\n        // in old Chromium versions (e.g. 23.0.1235.0 (151422))\n        // However, `typedArray` is still filled in-place.\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues#typedarray\n        const typedArray = new Uint8Array(1);\n        crypto.getRandomValues(typedArray);\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        return typedArray[0];\n      };\n    }\n  } catch (_) {\n    // some runtimes can crash invoking crypto\n    // https://github.com/getsentry/sentry-javascript/issues/8935\n  }\n\n  // http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#2117523\n  // Concatenating the following numbers as strings results in '10000000100040008000100000000000'\n  return (([1e7] ) + 1e3 + 4e3 + 8e3 + 1e11).replace(/[018]/g, c =>\n    // eslint-disable-next-line no-bitwise\n    ((c ) ^ ((getRandomByte() & 15) >> ((c ) / 4))).toString(16),\n  );\n}\n\nfunction getFirstException(event) {\n  return event.exception?.values?.[0];\n}\n\n/**\n * Extracts either message or type+value from an event that can be used for user-facing logs\n * @returns event's description\n */\nfunction getEventDescription(event) {\n  const { message, event_id: eventId } = event;\n  if (message) {\n    return message;\n  }\n\n  const firstException = getFirstException(event);\n  if (firstException) {\n    if (firstException.type && firstException.value) {\n      return `${firstException.type}: ${firstException.value}`;\n    }\n    return firstException.type || firstException.value || eventId || '<unknown>';\n  }\n  return eventId || '<unknown>';\n}\n\n/**\n * Adds exception values, type and value to an synthetic Exception.\n * @param event The event to modify.\n * @param value Value of the exception.\n * @param type Type of the exception.\n * @hidden\n */\nfunction addExceptionTypeValue(event, value, type) {\n  const exception = (event.exception = event.exception || {});\n  const values = (exception.values = exception.values || []);\n  const firstException = (values[0] = values[0] || {});\n  if (!firstException.value) {\n    firstException.value = value || '';\n  }\n  if (!firstException.type) {\n    firstException.type = type || 'Error';\n  }\n}\n\n/**\n * Adds exception mechanism data to a given event. Uses defaults if the second parameter is not passed.\n *\n * @param event The event to modify.\n * @param newMechanism Mechanism data to add to the event.\n * @hidden\n */\nfunction addExceptionMechanism(event, newMechanism) {\n  const firstException = getFirstException(event);\n  if (!firstException) {\n    return;\n  }\n\n  const defaultMechanism = { type: 'generic', handled: true };\n  const currentMechanism = firstException.mechanism;\n  firstException.mechanism = { ...defaultMechanism, ...currentMechanism, ...newMechanism };\n\n  if (newMechanism && 'data' in newMechanism) {\n    const mergedData = { ...currentMechanism?.data, ...newMechanism.data };\n    firstException.mechanism.data = mergedData;\n  }\n}\n\n// https://semver.org/#is-there-a-suggested-regular-expression-regex-to-check-a-semver-string\nconst SEMVER_REGEXP =\n  /^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$/;\n\n/**\n * Represents Semantic Versioning object\n */\n\nfunction _parseInt(input) {\n  return parseInt(input || '', 10);\n}\n\n/**\n * Parses input into a SemVer interface\n * @param input string representation of a semver version\n */\nfunction parseSemver(input) {\n  const match = input.match(SEMVER_REGEXP) || [];\n  const major = _parseInt(match[1]);\n  const minor = _parseInt(match[2]);\n  const patch = _parseInt(match[3]);\n  return {\n    buildmetadata: match[5],\n    major: isNaN(major) ? undefined : major,\n    minor: isNaN(minor) ? undefined : minor,\n    patch: isNaN(patch) ? undefined : patch,\n    prerelease: match[4],\n  };\n}\n\n/**\n * This function adds context (pre/post/line) lines to the provided frame\n *\n * @param lines string[] containing all lines\n * @param frame StackFrame that will be mutated\n * @param linesOfContext number of context lines we want to add pre/post\n */\nfunction addContextToFrame(lines, frame, linesOfContext = 5) {\n  // When there is no line number in the frame, attaching context is nonsensical and will even break grouping\n  if (frame.lineno === undefined) {\n    return;\n  }\n\n  const maxLines = lines.length;\n  const sourceLine = Math.max(Math.min(maxLines - 1, frame.lineno - 1), 0);\n\n  frame.pre_context = lines\n    .slice(Math.max(0, sourceLine - linesOfContext), sourceLine)\n    .map((line) => snipLine(line, 0));\n\n  // We guard here to ensure this is not larger than the existing number of lines\n  const lineIndex = Math.min(maxLines - 1, sourceLine);\n\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  frame.context_line = snipLine(lines[lineIndex], frame.colno || 0);\n\n  frame.post_context = lines\n    .slice(Math.min(sourceLine + 1, maxLines), sourceLine + 1 + linesOfContext)\n    .map((line) => snipLine(line, 0));\n}\n\n/**\n * Checks whether or not we've already captured the given exception (note: not an identical exception - the very object\n * in question), and marks it captured if not.\n *\n * This is useful because it's possible for an error to get captured by more than one mechanism. After we intercept and\n * record an error, we rethrow it (assuming we've intercepted it before it's reached the top-level global handlers), so\n * that we don't interfere with whatever effects the error might have had were the SDK not there. At that point, because\n * the error has been rethrown, it's possible for it to bubble up to some other code we've instrumented. If it's not\n * caught after that, it will bubble all the way up to the global handlers (which of course we also instrument). This\n * function helps us ensure that even if we encounter the same error more than once, we only record it the first time we\n * see it.\n *\n * Note: It will ignore primitives (always return `false` and not mark them as seen), as properties can't be set on\n * them. {@link: Object.objectify} can be used on exceptions to convert any that are primitives into their equivalent\n * object wrapper forms so that this check will always work. However, because we need to flag the exact object which\n * will get rethrown, and because that rethrowing happens outside of the event processing pipeline, the objectification\n * must be done before the exception captured.\n *\n * @param A thrown exception to check or flag as having been seen\n * @returns `true` if the exception has already been captured, `false` if not (with the side effect of marking it seen)\n */\nfunction checkOrSetAlreadyCaught(exception) {\n  if (isAlreadyCaptured(exception)) {\n    return true;\n  }\n\n  try {\n    // set it this way rather than by assignment so that it's not ennumerable and therefore isn't recorded by the\n    // `ExtraErrorData` integration\n    addNonEnumerableProperty(exception , '__sentry_captured__', true);\n  } catch (err) {\n    // `exception` is a primitive, so we can't mark it seen\n  }\n\n  return false;\n}\n\nfunction isAlreadyCaptured(exception) {\n  try {\n    return (exception ).__sentry_captured__;\n  } catch {} // eslint-disable-line no-empty\n}\n\nexport { addContextToFrame, addExceptionMechanism, addExceptionTypeValue, checkOrSetAlreadyCaught, getEventDescription, parseSemver, uuid4 };\n//# sourceMappingURL=misc.js.map\n","import { isThenable } from './is.js';\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/** SyncPromise internal states */\nvar States; (function (States) {\n  /** Pending */\n  const PENDING = 0; States[States[\"PENDING\"] = PENDING] = \"PENDING\";\n  /** Resolved / OK */\n  const RESOLVED = 1; States[States[\"RESOLVED\"] = RESOLVED] = \"RESOLVED\";\n  /** Rejected / Error */\n  const REJECTED = 2; States[States[\"REJECTED\"] = REJECTED] = \"REJECTED\";\n})(States || (States = {}));\n\n// Overloads so we can call resolvedSyncPromise without arguments and generic argument\n\n/**\n * Creates a resolved sync promise.\n *\n * @param value the value to resolve the promise with\n * @returns the resolved sync promise\n */\nfunction resolvedSyncPromise(value) {\n  return new SyncPromise(resolve => {\n    resolve(value);\n  });\n}\n\n/**\n * Creates a rejected sync promise.\n *\n * @param value the value to reject the promise with\n * @returns the rejected sync promise\n */\nfunction rejectedSyncPromise(reason) {\n  return new SyncPromise((_, reject) => {\n    reject(reason);\n  });\n}\n\n/**\n * Thenable class that behaves like a Promise and follows it's interface\n * but is not async internally\n */\nclass SyncPromise {\n\n   constructor(executor) {\n    this._state = States.PENDING;\n    this._handlers = [];\n\n    this._runExecutor(executor);\n  }\n\n  /** @inheritdoc */\n   then(\n    onfulfilled,\n    onrejected,\n  ) {\n    return new SyncPromise((resolve, reject) => {\n      this._handlers.push([\n        false,\n        result => {\n          if (!onfulfilled) {\n            // TODO: ¯\\_(ツ)_/¯\n            // TODO: FIXME\n            resolve(result );\n          } else {\n            try {\n              resolve(onfulfilled(result));\n            } catch (e) {\n              reject(e);\n            }\n          }\n        },\n        reason => {\n          if (!onrejected) {\n            reject(reason);\n          } else {\n            try {\n              resolve(onrejected(reason));\n            } catch (e) {\n              reject(e);\n            }\n          }\n        },\n      ]);\n      this._executeHandlers();\n    });\n  }\n\n  /** @inheritdoc */\n   catch(\n    onrejected,\n  ) {\n    return this.then(val => val, onrejected);\n  }\n\n  /** @inheritdoc */\n   finally(onfinally) {\n    return new SyncPromise((resolve, reject) => {\n      let val;\n      let isRejected;\n\n      return this.then(\n        value => {\n          isRejected = false;\n          val = value;\n          if (onfinally) {\n            onfinally();\n          }\n        },\n        reason => {\n          isRejected = true;\n          val = reason;\n          if (onfinally) {\n            onfinally();\n          }\n        },\n      ).then(() => {\n        if (isRejected) {\n          reject(val);\n          return;\n        }\n\n        resolve(val );\n      });\n    });\n  }\n\n  /** Excute the resolve/reject handlers. */\n   _executeHandlers() {\n    if (this._state === States.PENDING) {\n      return;\n    }\n\n    const cachedHandlers = this._handlers.slice();\n    this._handlers = [];\n\n    cachedHandlers.forEach(handler => {\n      if (handler[0]) {\n        return;\n      }\n\n      if (this._state === States.RESOLVED) {\n        handler[1](this._value );\n      }\n\n      if (this._state === States.REJECTED) {\n        handler[2](this._value);\n      }\n\n      handler[0] = true;\n    });\n  }\n\n  /** Run the executor for the SyncPromise. */\n   _runExecutor(executor) {\n    const setResult = (state, value) => {\n      if (this._state !== States.PENDING) {\n        return;\n      }\n\n      if (isThenable(value)) {\n        void (value ).then(resolve, reject);\n        return;\n      }\n\n      this._state = state;\n      this._value = value;\n\n      this._executeHandlers();\n    };\n\n    const resolve = (value) => {\n      setResult(States.RESOLVED, value);\n    };\n\n    const reject = (reason) => {\n      setResult(States.REJECTED, reason);\n    };\n\n    try {\n      executor(resolve, reject);\n    } catch (e) {\n      reject(e);\n    }\n  }\n}\n\nexport { SyncPromise, rejectedSyncPromise, resolvedSyncPromise };\n//# sourceMappingURL=syncpromise.js.map\n","import './utils-hoist/debug-build.js';\nimport './utils-hoist/logger.js';\nimport { timestampInSeconds } from './utils-hoist/time.js';\nimport { uuid4 } from './utils-hoist/misc.js';\nimport './utils-hoist/syncpromise.js';\n\n/**\n * Creates a new `Session` object by setting certain default parameters. If optional @param context\n * is passed, the passed properties are applied to the session object.\n *\n * @param context (optional) additional properties to be applied to the returned session object\n *\n * @returns a new `Session` object\n */\nfunction makeSession(context) {\n  // Both timestamp and started are in seconds since the UNIX epoch.\n  const startingTime = timestampInSeconds();\n\n  const session = {\n    sid: uuid4(),\n    init: true,\n    timestamp: startingTime,\n    started: startingTime,\n    duration: 0,\n    status: 'ok',\n    errors: 0,\n    ignoreDuration: false,\n    toJSON: () => sessionToJSON(session),\n  };\n\n  if (context) {\n    updateSession(session, context);\n  }\n\n  return session;\n}\n\n/**\n * Updates a session object with the properties passed in the context.\n *\n * Note that this function mutates the passed object and returns void.\n * (Had to do this instead of returning a new and updated session because closing and sending a session\n * makes an update to the session after it was passed to the sending logic.\n * @see Client.captureSession )\n *\n * @param session the `Session` to update\n * @param context the `SessionContext` holding the properties that should be updated in @param session\n */\n// eslint-disable-next-line complexity\nfunction updateSession(session, context = {}) {\n  if (context.user) {\n    if (!session.ipAddress && context.user.ip_address) {\n      session.ipAddress = context.user.ip_address;\n    }\n\n    if (!session.did && !context.did) {\n      session.did = context.user.id || context.user.email || context.user.username;\n    }\n  }\n\n  session.timestamp = context.timestamp || timestampInSeconds();\n\n  if (context.abnormal_mechanism) {\n    session.abnormal_mechanism = context.abnormal_mechanism;\n  }\n\n  if (context.ignoreDuration) {\n    session.ignoreDuration = context.ignoreDuration;\n  }\n  if (context.sid) {\n    // Good enough uuid validation. — Kamil\n    session.sid = context.sid.length === 32 ? context.sid : uuid4();\n  }\n  if (context.init !== undefined) {\n    session.init = context.init;\n  }\n  if (!session.did && context.did) {\n    session.did = `${context.did}`;\n  }\n  if (typeof context.started === 'number') {\n    session.started = context.started;\n  }\n  if (session.ignoreDuration) {\n    session.duration = undefined;\n  } else if (typeof context.duration === 'number') {\n    session.duration = context.duration;\n  } else {\n    const duration = session.timestamp - session.started;\n    session.duration = duration >= 0 ? duration : 0;\n  }\n  if (context.release) {\n    session.release = context.release;\n  }\n  if (context.environment) {\n    session.environment = context.environment;\n  }\n  if (!session.ipAddress && context.ipAddress) {\n    session.ipAddress = context.ipAddress;\n  }\n  if (!session.userAgent && context.userAgent) {\n    session.userAgent = context.userAgent;\n  }\n  if (typeof context.errors === 'number') {\n    session.errors = context.errors;\n  }\n  if (context.status) {\n    session.status = context.status;\n  }\n}\n\n/**\n * Closes a session by setting its status and updating the session object with it.\n * Internally calls `updateSession` to update the passed session object.\n *\n * Note that this function mutates the passed session (@see updateSession for explanation).\n *\n * @param session the `Session` object to be closed\n * @param status the `SessionStatus` with which the session was closed. If you don't pass a status,\n *               this function will keep the previously set status, unless it was `'ok'` in which case\n *               it is changed to `'exited'`.\n */\nfunction closeSession(session, status) {\n  let context = {};\n  if (status) {\n    context = { status };\n  } else if (session.status === 'ok') {\n    context = { status: 'exited' };\n  }\n\n  updateSession(session, context);\n}\n\n/**\n * Serializes a passed session object to a JSON object with a slightly different structure.\n * This is necessary because the Sentry backend requires a slightly different schema of a session\n * than the one the JS SDKs use internally.\n *\n * @param session the session to be converted\n *\n * @returns a JSON object of the passed session\n */\nfunction sessionToJSON(session) {\n  return {\n    sid: `${session.sid}`,\n    init: session.init,\n    // Make sure that sec is converted to ms for date constructor\n    started: new Date(session.started * 1000).toISOString(),\n    timestamp: new Date(session.timestamp * 1000).toISOString(),\n    status: session.status,\n    errors: session.errors,\n    did: typeof session.did === 'number' || typeof session.did === 'string' ? `${session.did}` : undefined,\n    duration: session.duration,\n    abnormal_mechanism: session.abnormal_mechanism,\n    attrs: {\n      release: session.release,\n      environment: session.environment,\n      ip_address: session.ipAddress,\n      user_agent: session.userAgent,\n    },\n  };\n}\n\nexport { closeSession, makeSession, updateSession };\n//# sourceMappingURL=session.js.map\n","import { uuid4 } from './misc.js';\n\n/**\n * Generate a random, valid trace ID.\n */\nfunction generateTraceId() {\n  return uuid4();\n}\n\n/**\n * Generate a random, valid span ID.\n */\nfunction generateSpanId() {\n  return uuid4().substring(16);\n}\n\nexport { generateSpanId, generateTraceId };\n//# sourceMappingURL=propagationContext.js.map\n","/**\n * Shallow merge two objects.\n * Does not mutate the passed in objects.\n * Undefined/empty values in the merge object will overwrite existing values.\n *\n * By default, this merges 2 levels deep.\n */\nfunction merge(initialObj, mergeObj, levels = 2) {\n  // If the merge value is not an object, or we have no merge levels left,\n  // we just set the value to the merge value\n  if (!mergeObj || typeof mergeObj !== 'object' || levels <= 0) {\n    return mergeObj;\n  }\n\n  // If the merge object is an empty object, and the initial object is not undefined, we return the initial object\n  if (initialObj && Object.keys(mergeObj).length === 0) {\n    return initialObj;\n  }\n\n  // Clone object\n  const output = { ...initialObj };\n\n  // Merge values into output, resursively\n  for (const key in mergeObj) {\n    if (Object.prototype.hasOwnProperty.call(mergeObj, key)) {\n      output[key] = merge(output[key], mergeObj[key], levels - 1);\n    }\n  }\n\n  return output;\n}\n\nexport { merge };\n//# sourceMappingURL=merge.js.map\n","import { addNonEnumerableProperty } from '../utils-hoist/object.js';\n\nconst SCOPE_SPAN_FIELD = '_sentrySpan';\n\n/**\n * Set the active span for a given scope.\n * NOTE: This should NOT be used directly, but is only used internally by the trace methods.\n */\nfunction _setSpanForScope(scope, span) {\n  if (span) {\n    addNonEnumerableProperty(scope , SCOPE_SPAN_FIELD, span);\n  } else {\n    // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n    delete (scope )[SCOPE_SPAN_FIELD];\n  }\n}\n\n/**\n * Get the active span for a given scope.\n * NOTE: This should NOT be used directly, but is only used internally by the trace methods.\n */\nfunction _getSpanForScope(scope) {\n  return scope[SCOPE_SPAN_FIELD];\n}\n\nexport { _getSpanForScope, _setSpanForScope };\n//# sourceMappingURL=spanOnScope.js.map\n","import { updateSession } from './session.js';\nimport { isPlainObject } from './utils-hoist/is.js';\nimport { logger } from './utils-hoist/logger.js';\nimport { uuid4 } from './utils-hoist/misc.js';\nimport { generateTraceId } from './utils-hoist/propagationContext.js';\nimport { truncate } from './utils-hoist/string.js';\nimport { dateTimestampInSeconds } from './utils-hoist/time.js';\nimport { merge } from './utils/merge.js';\nimport { _setSpanForScope, _getSpanForScope } from './utils/spanOnScope.js';\n\n/**\n * Default value for maximum number of breadcrumbs added to an event.\n */\nconst DEFAULT_MAX_BREADCRUMBS = 100;\n\n/**\n * A context to be used for capturing an event.\n * This can either be a Scope, or a partial ScopeContext,\n * or a callback that receives the current scope and returns a new scope to use.\n */\n\n/**\n * Holds additional event information.\n */\nclass Scope {\n  /** Flag if notifying is happening. */\n\n  /** Callback for client to receive scope changes. */\n\n  /** Callback list that will be called during event processing. */\n\n  /** Array of breadcrumbs. */\n\n  /** User */\n\n  /** Tags */\n\n  /** Extra */\n\n  /** Contexts */\n\n  /** Attachments */\n\n  /** Propagation Context for distributed tracing */\n\n  /**\n   * A place to stash data which is needed at some point in the SDK's event processing pipeline but which shouldn't get\n   * sent to Sentry\n   */\n\n  /** Fingerprint */\n\n  /** Severity */\n\n  /**\n   * Transaction Name\n   *\n   * IMPORTANT: The transaction name on the scope has nothing to do with root spans/transaction objects.\n   * It's purpose is to assign a transaction to the scope that's added to non-transaction events.\n   */\n\n  /** Session */\n\n  /** The client on this scope */\n\n  /** Contains the last event id of a captured event.  */\n\n  // NOTE: Any field which gets added here should get added not only to the constructor but also to the `clone` method.\n\n   constructor() {\n    this._notifyingListeners = false;\n    this._scopeListeners = [];\n    this._eventProcessors = [];\n    this._breadcrumbs = [];\n    this._attachments = [];\n    this._user = {};\n    this._tags = {};\n    this._extra = {};\n    this._contexts = {};\n    this._sdkProcessingMetadata = {};\n    this._propagationContext = {\n      traceId: generateTraceId(),\n      sampleRand: Math.random(),\n    };\n  }\n\n  /**\n   * Clone all data from this scope into a new scope.\n   */\n   clone() {\n    const newScope = new Scope();\n    newScope._breadcrumbs = [...this._breadcrumbs];\n    newScope._tags = { ...this._tags };\n    newScope._extra = { ...this._extra };\n    newScope._contexts = { ...this._contexts };\n    if (this._contexts.flags) {\n      // We need to copy the `values` array so insertions on a cloned scope\n      // won't affect the original array.\n      newScope._contexts.flags = {\n        values: [...this._contexts.flags.values],\n      };\n    }\n\n    newScope._user = this._user;\n    newScope._level = this._level;\n    newScope._session = this._session;\n    newScope._transactionName = this._transactionName;\n    newScope._fingerprint = this._fingerprint;\n    newScope._eventProcessors = [...this._eventProcessors];\n    newScope._attachments = [...this._attachments];\n    newScope._sdkProcessingMetadata = { ...this._sdkProcessingMetadata };\n    newScope._propagationContext = { ...this._propagationContext };\n    newScope._client = this._client;\n    newScope._lastEventId = this._lastEventId;\n\n    _setSpanForScope(newScope, _getSpanForScope(this));\n\n    return newScope;\n  }\n\n  /**\n   * Update the client assigned to this scope.\n   * Note that not every scope will have a client assigned - isolation scopes & the global scope will generally not have a client,\n   * as well as manually created scopes.\n   */\n   setClient(client) {\n    this._client = client;\n  }\n\n  /**\n   * Set the ID of the last captured error event.\n   * This is generally only captured on the isolation scope.\n   */\n   setLastEventId(lastEventId) {\n    this._lastEventId = lastEventId;\n  }\n\n  /**\n   * Get the client assigned to this scope.\n   */\n   getClient() {\n    return this._client ;\n  }\n\n  /**\n   * Get the ID of the last captured error event.\n   * This is generally only available on the isolation scope.\n   */\n   lastEventId() {\n    return this._lastEventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n   addScopeListener(callback) {\n    this._scopeListeners.push(callback);\n  }\n\n  /**\n   * Add an event processor that will be called before an event is sent.\n   */\n   addEventProcessor(callback) {\n    this._eventProcessors.push(callback);\n    return this;\n  }\n\n  /**\n   * Set the user for this scope.\n   * Set to `null` to unset the user.\n   */\n   setUser(user) {\n    // If null is passed we want to unset everything, but still define keys,\n    // so that later down in the pipeline any existing values are cleared.\n    this._user = user || {\n      email: undefined,\n      id: undefined,\n      ip_address: undefined,\n      username: undefined,\n    };\n\n    if (this._session) {\n      updateSession(this._session, { user });\n    }\n\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Get the user from this scope.\n   */\n   getUser() {\n    return this._user;\n  }\n\n  /**\n   * Set an object that will be merged into existing tags on the scope,\n   * and will be sent as tags data with the event.\n   */\n   setTags(tags) {\n    this._tags = {\n      ...this._tags,\n      ...tags,\n    };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Set a single tag that will be sent as tags data with the event.\n   */\n   setTag(key, value) {\n    this._tags = { ...this._tags, [key]: value };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Set an object that will be merged into existing extra on the scope,\n   * and will be sent as extra data with the event.\n   */\n   setExtras(extras) {\n    this._extra = {\n      ...this._extra,\n      ...extras,\n    };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Set a single key:value extra entry that will be sent as extra data with the event.\n   */\n   setExtra(key, extra) {\n    this._extra = { ...this._extra, [key]: extra };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Sets the fingerprint on the scope to send with the events.\n   * @param {string[]} fingerprint Fingerprint to group events in Sentry.\n   */\n   setFingerprint(fingerprint) {\n    this._fingerprint = fingerprint;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Sets the level on the scope for future events.\n   */\n   setLevel(level) {\n    this._level = level;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Sets the transaction name on the scope so that the name of e.g. taken server route or\n   * the page location is attached to future events.\n   *\n   * IMPORTANT: Calling this function does NOT change the name of the currently active\n   * root span. If you want to change the name of the active root span, use\n   * `Sentry.updateSpanName(rootSpan, 'new name')` instead.\n   *\n   * By default, the SDK updates the scope's transaction name automatically on sensible\n   * occasions, such as a page navigation or when handling a new request on the server.\n   */\n   setTransactionName(name) {\n    this._transactionName = name;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Sets context data with the given name.\n   * Data passed as context will be normalized. You can also pass `null` to unset the context.\n   * Note that context data will not be merged - calling `setContext` will overwrite an existing context with the same key.\n   */\n   setContext(key, context) {\n    if (context === null) {\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete this._contexts[key];\n    } else {\n      this._contexts[key] = context;\n    }\n\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Set the session for the scope.\n   */\n   setSession(session) {\n    if (!session) {\n      delete this._session;\n    } else {\n      this._session = session;\n    }\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Get the session from the scope.\n   */\n   getSession() {\n    return this._session;\n  }\n\n  /**\n   * Updates the scope with provided data. Can work in three variations:\n   * - plain object containing updatable attributes\n   * - Scope instance that'll extract the attributes from\n   * - callback function that'll receive the current scope as an argument and allow for modifications\n   */\n   update(captureContext) {\n    if (!captureContext) {\n      return this;\n    }\n\n    const scopeToMerge = typeof captureContext === 'function' ? captureContext(this) : captureContext;\n\n    const scopeInstance =\n      scopeToMerge instanceof Scope\n        ? scopeToMerge.getScopeData()\n        : isPlainObject(scopeToMerge)\n          ? (captureContext )\n          : undefined;\n\n    const { tags, extra, user, contexts, level, fingerprint = [], propagationContext } = scopeInstance || {};\n\n    this._tags = { ...this._tags, ...tags };\n    this._extra = { ...this._extra, ...extra };\n    this._contexts = { ...this._contexts, ...contexts };\n\n    if (user && Object.keys(user).length) {\n      this._user = user;\n    }\n\n    if (level) {\n      this._level = level;\n    }\n\n    if (fingerprint.length) {\n      this._fingerprint = fingerprint;\n    }\n\n    if (propagationContext) {\n      this._propagationContext = propagationContext;\n    }\n\n    return this;\n  }\n\n  /**\n   * Clears the current scope and resets its properties.\n   * Note: The client will not be cleared.\n   */\n   clear() {\n    // client is not cleared here on purpose!\n    this._breadcrumbs = [];\n    this._tags = {};\n    this._extra = {};\n    this._user = {};\n    this._contexts = {};\n    this._level = undefined;\n    this._transactionName = undefined;\n    this._fingerprint = undefined;\n    this._session = undefined;\n    _setSpanForScope(this, undefined);\n    this._attachments = [];\n    this.setPropagationContext({ traceId: generateTraceId(), sampleRand: Math.random() });\n\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Adds a breadcrumb to the scope.\n   * By default, the last 100 breadcrumbs are kept.\n   */\n   addBreadcrumb(breadcrumb, maxBreadcrumbs) {\n    const maxCrumbs = typeof maxBreadcrumbs === 'number' ? maxBreadcrumbs : DEFAULT_MAX_BREADCRUMBS;\n\n    // No data has been changed, so don't notify scope listeners\n    if (maxCrumbs <= 0) {\n      return this;\n    }\n\n    const mergedBreadcrumb = {\n      timestamp: dateTimestampInSeconds(),\n      ...breadcrumb,\n      // Breadcrumb messages can theoretically be infinitely large and they're held in memory so we truncate them not to leak (too much) memory\n      message: breadcrumb.message ? truncate(breadcrumb.message, 2048) : breadcrumb.message,\n    };\n\n    this._breadcrumbs.push(mergedBreadcrumb);\n    if (this._breadcrumbs.length > maxCrumbs) {\n      this._breadcrumbs = this._breadcrumbs.slice(-maxCrumbs);\n      this._client?.recordDroppedEvent('buffer_overflow', 'log_item');\n    }\n\n    this._notifyScopeListeners();\n\n    return this;\n  }\n\n  /**\n   * Get the last breadcrumb of the scope.\n   */\n   getLastBreadcrumb() {\n    return this._breadcrumbs[this._breadcrumbs.length - 1];\n  }\n\n  /**\n   * Clear all breadcrumbs from the scope.\n   */\n   clearBreadcrumbs() {\n    this._breadcrumbs = [];\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Add an attachment to the scope.\n   */\n   addAttachment(attachment) {\n    this._attachments.push(attachment);\n    return this;\n  }\n\n  /**\n   * Clear all attachments from the scope.\n   */\n   clearAttachments() {\n    this._attachments = [];\n    return this;\n  }\n\n  /**\n   * Get the data of this scope, which should be applied to an event during processing.\n   */\n   getScopeData() {\n    return {\n      breadcrumbs: this._breadcrumbs,\n      attachments: this._attachments,\n      contexts: this._contexts,\n      tags: this._tags,\n      extra: this._extra,\n      user: this._user,\n      level: this._level,\n      fingerprint: this._fingerprint || [],\n      eventProcessors: this._eventProcessors,\n      propagationContext: this._propagationContext,\n      sdkProcessingMetadata: this._sdkProcessingMetadata,\n      transactionName: this._transactionName,\n      span: _getSpanForScope(this),\n    };\n  }\n\n  /**\n   * Add data which will be accessible during event processing but won't get sent to Sentry.\n   */\n   setSDKProcessingMetadata(newData) {\n    this._sdkProcessingMetadata = merge(this._sdkProcessingMetadata, newData, 2);\n    return this;\n  }\n\n  /**\n   * Add propagation context to the scope, used for distributed tracing\n   */\n   setPropagationContext(context) {\n    this._propagationContext = context;\n    return this;\n  }\n\n  /**\n   * Get propagation context from the scope, used for distributed tracing\n   */\n   getPropagationContext() {\n    return this._propagationContext;\n  }\n\n  /**\n   * Capture an exception for this scope.\n   *\n   * @returns {string} The id of the captured Sentry event.\n   */\n   captureException(exception, hint) {\n    const eventId = hint?.event_id || uuid4();\n\n    if (!this._client) {\n      logger.warn('No client configured on scope - will not capture exception!');\n      return eventId;\n    }\n\n    const syntheticException = new Error('Sentry syntheticException');\n\n    this._client.captureException(\n      exception,\n      {\n        originalException: exception,\n        syntheticException,\n        ...hint,\n        event_id: eventId,\n      },\n      this,\n    );\n\n    return eventId;\n  }\n\n  /**\n   * Capture a message for this scope.\n   *\n   * @returns {string} The id of the captured message.\n   */\n   captureMessage(message, level, hint) {\n    const eventId = hint?.event_id || uuid4();\n\n    if (!this._client) {\n      logger.warn('No client configured on scope - will not capture message!');\n      return eventId;\n    }\n\n    const syntheticException = new Error(message);\n\n    this._client.captureMessage(\n      message,\n      level,\n      {\n        originalException: message,\n        syntheticException,\n        ...hint,\n        event_id: eventId,\n      },\n      this,\n    );\n\n    return eventId;\n  }\n\n  /**\n   * Capture a Sentry event for this scope.\n   *\n   * @returns {string} The id of the captured event.\n   */\n   captureEvent(event, hint) {\n    const eventId = hint?.event_id || uuid4();\n\n    if (!this._client) {\n      logger.warn('No client configured on scope - will not capture event!');\n      return eventId;\n    }\n\n    this._client.captureEvent(event, { ...hint, event_id: eventId }, this);\n\n    return eventId;\n  }\n\n  /**\n   * This will be called on every set call.\n   */\n   _notifyScopeListeners() {\n    // We need this check for this._notifyingListeners to be able to work on scope during updates\n    // If this check is not here we'll produce endless recursion when something is done with the scope\n    // during the callback.\n    if (!this._notifyingListeners) {\n      this._notifyingListeners = true;\n      this._scopeListeners.forEach(callback => {\n        callback(this);\n      });\n      this._notifyingListeners = false;\n    }\n  }\n}\n\nexport { Scope };\n//# sourceMappingURL=scope.js.map\n","import { getDefaultCurrentScope, getDefaultIsolationScope } from '../defaultScopes.js';\nimport { Scope } from '../scope.js';\nimport { isThenable } from '../utils-hoist/is.js';\nimport { getMainCarrier, getSentryCarrier } from '../carrier.js';\n\n/**\n * This is an object that holds a stack of scopes.\n */\nclass AsyncContextStack {\n\n   constructor(scope, isolationScope) {\n    let assignedScope;\n    if (!scope) {\n      assignedScope = new Scope();\n    } else {\n      assignedScope = scope;\n    }\n\n    let assignedIsolationScope;\n    if (!isolationScope) {\n      assignedIsolationScope = new Scope();\n    } else {\n      assignedIsolationScope = isolationScope;\n    }\n\n    // scope stack for domains or the process\n    this._stack = [{ scope: assignedScope }];\n    this._isolationScope = assignedIsolationScope;\n  }\n\n  /**\n   * Fork a scope for the stack.\n   */\n   withScope(callback) {\n    const scope = this._pushScope();\n\n    let maybePromiseResult;\n    try {\n      maybePromiseResult = callback(scope);\n    } catch (e) {\n      this._popScope();\n      throw e;\n    }\n\n    if (isThenable(maybePromiseResult)) {\n      // @ts-expect-error - isThenable returns the wrong type\n      return maybePromiseResult.then(\n        res => {\n          this._popScope();\n          return res;\n        },\n        e => {\n          this._popScope();\n          throw e;\n        },\n      );\n    }\n\n    this._popScope();\n    return maybePromiseResult;\n  }\n\n  /**\n   * Get the client of the stack.\n   */\n   getClient() {\n    return this.getStackTop().client ;\n  }\n\n  /**\n   * Returns the scope of the top stack.\n   */\n   getScope() {\n    return this.getStackTop().scope;\n  }\n\n  /**\n   * Get the isolation scope for the stack.\n   */\n   getIsolationScope() {\n    return this._isolationScope;\n  }\n\n  /**\n   * Returns the topmost scope layer in the order domain > local > process.\n   */\n   getStackTop() {\n    return this._stack[this._stack.length - 1] ;\n  }\n\n  /**\n   * Push a scope to the stack.\n   */\n   _pushScope() {\n    // We want to clone the content of prev scope\n    const scope = this.getScope().clone();\n    this._stack.push({\n      client: this.getClient(),\n      scope,\n    });\n    return scope;\n  }\n\n  /**\n   * Pop a scope from the stack.\n   */\n   _popScope() {\n    if (this._stack.length <= 1) return false;\n    return !!this._stack.pop();\n  }\n}\n\n/**\n * Get the global async context stack.\n * This will be removed during the v8 cycle and is only here to make migration easier.\n */\nfunction getAsyncContextStack() {\n  const registry = getMainCarrier();\n  const sentry = getSentryCarrier(registry);\n\n  return (sentry.stack = sentry.stack || new AsyncContextStack(getDefaultCurrentScope(), getDefaultIsolationScope()));\n}\n\nfunction withScope(callback) {\n  return getAsyncContextStack().withScope(callback);\n}\n\nfunction withSetScope(scope, callback) {\n  const stack = getAsyncContextStack() ;\n  return stack.withScope(() => {\n    stack.getStackTop().scope = scope;\n    return callback(scope);\n  });\n}\n\nfunction withIsolationScope(callback) {\n  return getAsyncContextStack().withScope(() => {\n    return callback(getAsyncContextStack().getIsolationScope());\n  });\n}\n\n/**\n * Get the stack-based async context strategy.\n */\nfunction getStackAsyncContextStrategy() {\n  return {\n    withIsolationScope,\n    withScope,\n    withSetScope,\n    withSetIsolationScope: (_isolationScope, callback) => {\n      return withIsolationScope(callback);\n    },\n    getCurrentScope: () => getAsyncContextStack().getScope(),\n    getIsolationScope: () => getAsyncContextStack().getIsolationScope(),\n  };\n}\n\nexport { AsyncContextStack, getStackAsyncContextStrategy };\n//# sourceMappingURL=stackStrategy.js.map\n","import { getGlobalSingleton } from './carrier.js';\nimport { Scope } from './scope.js';\n\n/** Get the default current scope. */\nfunction getDefaultCurrentScope() {\n  return getGlobalSingleton('defaultCurrentScope', () => new Scope());\n}\n\n/** Get the default isolation scope. */\nfunction getDefaultIsolationScope() {\n  return getGlobalSingleton('defaultIsolationScope', () => new Scope());\n}\n\nexport { getDefaultCurrentScope, getDefaultIsolationScope };\n//# sourceMappingURL=defaultScopes.js.map\n","import { getMainCarrier, getSentryCarrier } from '../carrier.js';\nimport { getStackAsyncContextStrategy } from './stackStrategy.js';\n\n/**\n * @private Private API with no semver guarantees!\n *\n * Sets the global async context strategy\n */\nfunction setAsyncContextStrategy(strategy) {\n  // Get main carrier (global for every environment)\n  const registry = getMainCarrier();\n  const sentry = getSentryCarrier(registry);\n  sentry.acs = strategy;\n}\n\n/**\n * Get the current async context strategy.\n * If none has been setup, the default will be used.\n */\nfunction getAsyncContextStrategy(carrier) {\n  const sentry = getSentryCarrier(carrier);\n\n  if (sentry.acs) {\n    return sentry.acs;\n  }\n\n  // Otherwise, use the default one (stack)\n  return getStackAsyncContextStrategy();\n}\n\nexport { getAsyncContextStrategy, setAsyncContextStrategy };\n//# sourceMappingURL=index.js.map\n","import { getAsyncContextStrategy } from './asyncContext/index.js';\nimport { getMainCarrier, getGlobalSingleton } from './carrier.js';\nimport { Scope } from './scope.js';\nimport './utils-hoist/debug-build.js';\nimport './utils-hoist/logger.js';\nimport './utils-hoist/time.js';\nimport './utils-hoist/syncpromise.js';\nimport { generateSpanId } from './utils-hoist/propagationContext.js';\n\n/**\n * Get the currently active scope.\n */\nfunction getCurrentScope() {\n  const carrier = getMainCarrier();\n  const acs = getAsyncContextStrategy(carrier);\n  return acs.getCurrentScope();\n}\n\n/**\n * Get the currently active isolation scope.\n * The isolation scope is active for the current execution context.\n */\nfunction getIsolationScope() {\n  const carrier = getMainCarrier();\n  const acs = getAsyncContextStrategy(carrier);\n  return acs.getIsolationScope();\n}\n\n/**\n * Get the global scope.\n * This scope is applied to _all_ events.\n */\nfunction getGlobalScope() {\n  return getGlobalSingleton('globalScope', () => new Scope());\n}\n\n/**\n * Creates a new scope with and executes the given operation within.\n * The scope is automatically removed once the operation\n * finishes or throws.\n */\n\n/**\n * Either creates a new active scope, or sets the given scope as active scope in the given callback.\n */\nfunction withScope(\n  ...rest\n) {\n  const carrier = getMainCarrier();\n  const acs = getAsyncContextStrategy(carrier);\n\n  // If a scope is defined, we want to make this the active scope instead of the default one\n  if (rest.length === 2) {\n    const [scope, callback] = rest;\n\n    if (!scope) {\n      return acs.withScope(callback);\n    }\n\n    return acs.withSetScope(scope, callback);\n  }\n\n  return acs.withScope(rest[0]);\n}\n\n/**\n * Attempts to fork the current isolation scope and the current scope based on the current async context strategy. If no\n * async context strategy is set, the isolation scope and the current scope will not be forked (this is currently the\n * case, for example, in the browser).\n *\n * Usage of this function in environments without async context strategy is discouraged and may lead to unexpected behaviour.\n *\n * This function is intended for Sentry SDK and SDK integration development. It is not recommended to be used in \"normal\"\n * applications directly because it comes with pitfalls. Use at your own risk!\n */\n\n/**\n * Either creates a new active isolation scope, or sets the given isolation scope as active scope in the given callback.\n */\nfunction withIsolationScope(\n  ...rest\n\n) {\n  const carrier = getMainCarrier();\n  const acs = getAsyncContextStrategy(carrier);\n\n  // If a scope is defined, we want to make this the active scope instead of the default one\n  if (rest.length === 2) {\n    const [isolationScope, callback] = rest;\n\n    if (!isolationScope) {\n      return acs.withIsolationScope(callback);\n    }\n\n    return acs.withSetIsolationScope(isolationScope, callback);\n  }\n\n  return acs.withIsolationScope(rest[0]);\n}\n\n/**\n * Get the currently active client.\n */\nfunction getClient() {\n  return getCurrentScope().getClient();\n}\n\n/**\n * Get a trace context for the given scope.\n */\nfunction getTraceContextFromScope(scope) {\n  const propagationContext = scope.getPropagationContext();\n\n  const { traceId, parentSpanId, propagationSpanId } = propagationContext;\n\n  const traceContext = {\n    trace_id: traceId,\n    span_id: propagationSpanId || generateSpanId(),\n  };\n\n  if (parentSpanId) {\n    traceContext.parent_span_id = parentSpanId;\n  }\n\n  return traceContext;\n}\n\nexport { getClient, getCurrentScope, getGlobalScope, getIsolationScope, getTraceContextFromScope, withIsolationScope, withScope };\n//# sourceMappingURL=currentScopes.js.map\n","/**\n * Use this attribute to represent the source of a span.\n * Should be one of: custom, url, route, view, component, task, unknown\n *\n */\nconst SEMANTIC_ATTRIBUTE_SENTRY_SOURCE = 'sentry.source';\n\n/**\n * Attributes that holds the sample rate that was locally applied to a span.\n * If this attribute is not defined, it means that the span inherited a sampling decision.\n *\n * NOTE: Is only defined on root spans.\n */\nconst SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE = 'sentry.sample_rate';\n\n/**\n * Use this attribute to represent the operation of a span.\n */\nconst SEMANTIC_ATTRIBUTE_SENTRY_OP = 'sentry.op';\n\n/**\n * Use this attribute to represent the origin of a span.\n */\nconst SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN = 'sentry.origin';\n\n/** The reason why an idle span finished. */\nconst SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON = 'sentry.idle_span_finish_reason';\n\n/** The unit of a measurement, which may be stored as a TimedEvent. */\nconst SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT = 'sentry.measurement_unit';\n\n/** The value of a measurement, which may be stored as a TimedEvent. */\nconst SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE = 'sentry.measurement_value';\n\n/**\n * A custom span name set by users guaranteed to be taken over any automatically\n * inferred name. This attribute is removed before the span is sent.\n *\n * @internal only meant for internal SDK usage\n * @hidden\n */\nconst SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME = 'sentry.custom_span_name';\n\n/**\n * The id of the profile that this span occurred in.\n */\nconst SEMANTIC_ATTRIBUTE_PROFILE_ID = 'sentry.profile_id';\n\nconst SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME = 'sentry.exclusive_time';\n\nconst SEMANTIC_ATTRIBUTE_CACHE_HIT = 'cache.hit';\n\nconst SEMANTIC_ATTRIBUTE_CACHE_KEY = 'cache.key';\n\nconst SEMANTIC_ATTRIBUTE_CACHE_ITEM_SIZE = 'cache.item_size';\n\n/** TODO: Remove these once we update to latest semantic conventions */\nconst SEMANTIC_ATTRIBUTE_HTTP_REQUEST_METHOD = 'http.request.method';\nconst SEMANTIC_ATTRIBUTE_URL_FULL = 'url.full';\n\n/**\n * A span link attribute to mark the link as a special span link.\n *\n * Known values:\n * - `previous_trace`: The span links to the frontend root span of the previous trace.\n * - `next_trace`: The span links to the frontend root span of the next trace. (Not set by the SDK)\n *\n * Other values may be set as appropriate.\n * @see https://develop.sentry.dev/sdk/telemetry/traces/span-links/#link-types\n */\nconst SEMANTIC_LINK_ATTRIBUTE_LINK_TYPE = 'sentry.link.type';\n\nexport { SEMANTIC_ATTRIBUTE_CACHE_HIT, SEMANTIC_ATTRIBUTE_CACHE_ITEM_SIZE, SEMANTIC_ATTRIBUTE_CACHE_KEY, SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME, SEMANTIC_ATTRIBUTE_HTTP_REQUEST_METHOD, SEMANTIC_ATTRIBUTE_PROFILE_ID, SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME, SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON, SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT, SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE, SEMANTIC_ATTRIBUTE_SENTRY_OP, SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN, SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE, SEMANTIC_ATTRIBUTE_SENTRY_SOURCE, SEMANTIC_ATTRIBUTE_URL_FULL, SEMANTIC_LINK_ATTRIBUTE_LINK_TYPE };\n//# sourceMappingURL=semanticAttributes.js.map\n","const SPAN_STATUS_UNSET = 0;\nconst SPAN_STATUS_OK = 1;\nconst SPAN_STATUS_ERROR = 2;\n\n/**\n * Converts a HTTP status code into a sentry status with a message.\n *\n * @param httpStatus The HTTP response status code.\n * @returns The span status or unknown_error.\n */\n// https://develop.sentry.dev/sdk/event-payloads/span/\nfunction getSpanStatusFromHttpCode(httpStatus) {\n  if (httpStatus < 400 && httpStatus >= 100) {\n    return { code: SPAN_STATUS_OK };\n  }\n\n  if (httpStatus >= 400 && httpStatus < 500) {\n    switch (httpStatus) {\n      case 401:\n        return { code: SPAN_STATUS_ERROR, message: 'unauthenticated' };\n      case 403:\n        return { code: SPAN_STATUS_ERROR, message: 'permission_denied' };\n      case 404:\n        return { code: SPAN_STATUS_ERROR, message: 'not_found' };\n      case 409:\n        return { code: SPAN_STATUS_ERROR, message: 'already_exists' };\n      case 413:\n        return { code: SPAN_STATUS_ERROR, message: 'failed_precondition' };\n      case 429:\n        return { code: SPAN_STATUS_ERROR, message: 'resource_exhausted' };\n      case 499:\n        return { code: SPAN_STATUS_ERROR, message: 'cancelled' };\n      default:\n        return { code: SPAN_STATUS_ERROR, message: 'invalid_argument' };\n    }\n  }\n\n  if (httpStatus >= 500 && httpStatus < 600) {\n    switch (httpStatus) {\n      case 501:\n        return { code: SPAN_STATUS_ERROR, message: 'unimplemented' };\n      case 503:\n        return { code: SPAN_STATUS_ERROR, message: 'unavailable' };\n      case 504:\n        return { code: SPAN_STATUS_ERROR, message: 'deadline_exceeded' };\n      default:\n        return { code: SPAN_STATUS_ERROR, message: 'internal_error' };\n    }\n  }\n\n  return { code: SPAN_STATUS_ERROR, message: 'unknown_error' };\n}\n\n/**\n * Sets the Http status attributes on the current span based on the http code.\n * Additionally, the span's status is updated, depending on the http code.\n */\nfunction setHttpStatus(span, httpStatus) {\n  span.setAttribute('http.response.status_code', httpStatus);\n\n  const spanStatus = getSpanStatusFromHttpCode(httpStatus);\n  if (spanStatus.message !== 'unknown_error') {\n    span.setStatus(spanStatus);\n  }\n}\n\nexport { SPAN_STATUS_ERROR, SPAN_STATUS_OK, SPAN_STATUS_UNSET, getSpanStatusFromHttpCode, setHttpStatus };\n//# sourceMappingURL=spanstatus.js.map\n","import { addNonEnumerableProperty } from '../utils-hoist/object.js';\n\nconst SCOPE_ON_START_SPAN_FIELD = '_sentryScope';\nconst ISOLATION_SCOPE_ON_START_SPAN_FIELD = '_sentryIsolationScope';\n\n/** Store the scope & isolation scope for a span, which can the be used when it is finished. */\nfunction setCapturedScopesOnSpan(span, scope, isolationScope) {\n  if (span) {\n    addNonEnumerableProperty(span, ISOLATION_SCOPE_ON_START_SPAN_FIELD, isolationScope);\n    addNonEnumerableProperty(span, SCOPE_ON_START_SPAN_FIELD, scope);\n  }\n}\n\n/**\n * Grabs the scope and isolation scope off a span that were active when the span was started.\n */\nfunction getCapturedScopesOnSpan(span) {\n  return {\n    scope: (span )[SCOPE_ON_START_SPAN_FIELD],\n    isolationScope: (span )[ISOLATION_SCOPE_ON_START_SPAN_FIELD],\n  };\n}\n\nexport { getCapturedScopesOnSpan, setCapturedScopesOnSpan };\n//# sourceMappingURL=utils.js.map\n","import { DEBUG_BUILD } from './debug-build.js';\nimport { isString } from './is.js';\nimport { logger } from './logger.js';\n\nconst SENTRY_BAGGAGE_KEY_PREFIX = 'sentry-';\n\nconst SENTRY_BAGGAGE_KEY_PREFIX_REGEX = /^sentry-/;\n\n/**\n * Max length of a serialized baggage string\n *\n * https://www.w3.org/TR/baggage/#limits\n */\nconst MAX_BAGGAGE_STRING_LENGTH = 8192;\n\n/**\n * Takes a baggage header and turns it into Dynamic Sampling Context, by extracting all the \"sentry-\" prefixed values\n * from it.\n *\n * @param baggageHeader A very bread definition of a baggage header as it might appear in various frameworks.\n * @returns The Dynamic Sampling Context that was found on `baggageHeader`, if there was any, `undefined` otherwise.\n */\nfunction baggageHeaderToDynamicSamplingContext(\n  // Very liberal definition of what any incoming header might look like\n  baggageHeader,\n) {\n  const baggageObject = parseBaggageHeader(baggageHeader);\n\n  if (!baggageObject) {\n    return undefined;\n  }\n\n  // Read all \"sentry-\" prefixed values out of the baggage object and put it onto a dynamic sampling context object.\n  const dynamicSamplingContext = Object.entries(baggageObject).reduce((acc, [key, value]) => {\n    if (key.match(SENTRY_BAGGAGE_KEY_PREFIX_REGEX)) {\n      const nonPrefixedKey = key.slice(SENTRY_BAGGAGE_KEY_PREFIX.length);\n      acc[nonPrefixedKey] = value;\n    }\n    return acc;\n  }, {});\n\n  // Only return a dynamic sampling context object if there are keys in it.\n  // A keyless object means there were no sentry values on the header, which means that there is no DSC.\n  if (Object.keys(dynamicSamplingContext).length > 0) {\n    return dynamicSamplingContext ;\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Turns a Dynamic Sampling Object into a baggage header by prefixing all the keys on the object with \"sentry-\".\n *\n * @param dynamicSamplingContext The Dynamic Sampling Context to turn into a header. For convenience and compatibility\n * with the `getDynamicSamplingContext` method on the Transaction class ,this argument can also be `undefined`. If it is\n * `undefined` the function will return `undefined`.\n * @returns a baggage header, created from `dynamicSamplingContext`, or `undefined` either if `dynamicSamplingContext`\n * was `undefined`, or if `dynamicSamplingContext` didn't contain any values.\n */\nfunction dynamicSamplingContextToSentryBaggageHeader(\n  // this also takes undefined for convenience and bundle size in other places\n  dynamicSamplingContext,\n) {\n  if (!dynamicSamplingContext) {\n    return undefined;\n  }\n\n  // Prefix all DSC keys with \"sentry-\" and put them into a new object\n  const sentryPrefixedDSC = Object.entries(dynamicSamplingContext).reduce(\n    (acc, [dscKey, dscValue]) => {\n      if (dscValue) {\n        acc[`${SENTRY_BAGGAGE_KEY_PREFIX}${dscKey}`] = dscValue;\n      }\n      return acc;\n    },\n    {},\n  );\n\n  return objectToBaggageHeader(sentryPrefixedDSC);\n}\n\n/**\n * Take a baggage header and parse it into an object.\n */\nfunction parseBaggageHeader(\n  baggageHeader,\n) {\n  if (!baggageHeader || (!isString(baggageHeader) && !Array.isArray(baggageHeader))) {\n    return undefined;\n  }\n\n  if (Array.isArray(baggageHeader)) {\n    // Combine all baggage headers into one object containing the baggage values so we can later read the Sentry-DSC-values from it\n    return baggageHeader.reduce((acc, curr) => {\n      const currBaggageObject = baggageHeaderToObject(curr);\n      Object.entries(currBaggageObject).forEach(([key, value]) => {\n        acc[key] = value;\n      });\n      return acc;\n    }, {});\n  }\n\n  return baggageHeaderToObject(baggageHeader);\n}\n\n/**\n * Will parse a baggage header, which is a simple key-value map, into a flat object.\n *\n * @param baggageHeader The baggage header to parse.\n * @returns a flat object containing all the key-value pairs from `baggageHeader`.\n */\nfunction baggageHeaderToObject(baggageHeader) {\n  return baggageHeader\n    .split(',')\n    .map(baggageEntry => baggageEntry.split('=').map(keyOrValue => decodeURIComponent(keyOrValue.trim())))\n    .reduce((acc, [key, value]) => {\n      if (key && value) {\n        acc[key] = value;\n      }\n      return acc;\n    }, {});\n}\n\n/**\n * Turns a flat object (key-value pairs) into a baggage header, which is also just key-value pairs.\n *\n * @param object The object to turn into a baggage header.\n * @returns a baggage header string, or `undefined` if the object didn't have any values, since an empty baggage header\n * is not spec compliant.\n */\nfunction objectToBaggageHeader(object) {\n  if (Object.keys(object).length === 0) {\n    // An empty baggage header is not spec compliant: We return undefined.\n    return undefined;\n  }\n\n  return Object.entries(object).reduce((baggageHeader, [objectKey, objectValue], currentIndex) => {\n    const baggageEntry = `${encodeURIComponent(objectKey)}=${encodeURIComponent(objectValue)}`;\n    const newBaggageHeader = currentIndex === 0 ? baggageEntry : `${baggageHeader},${baggageEntry}`;\n    if (newBaggageHeader.length > MAX_BAGGAGE_STRING_LENGTH) {\n      DEBUG_BUILD &&\n        logger.warn(\n          `Not adding key: ${objectKey} with val: ${objectValue} to baggage header due to exceeding baggage size limits.`,\n        );\n      return baggageHeader;\n    } else {\n      return newBaggageHeader;\n    }\n  }, '');\n}\n\nexport { MAX_BAGGAGE_STRING_LENGTH, SENTRY_BAGGAGE_KEY_PREFIX, SENTRY_BAGGAGE_KEY_PREFIX_REGEX, baggageHeaderToDynamicSamplingContext, dynamicSamplingContextToSentryBaggageHeader, objectToBaggageHeader, parseBaggageHeader };\n//# sourceMappingURL=baggage.js.map\n","import { getAsyncContextStrategy } from '../asyncContext/index.js';\nimport { getMainCarrier } from '../carrier.js';\nimport { getCurrentScope } from '../currentScopes.js';\nimport { SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN, SEMANTIC_ATTRIBUTE_SENTRY_OP, SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME, SEMANTIC_ATTRIBUTE_SENTRY_SOURCE } from '../semanticAttributes.js';\nimport { SPAN_STATUS_UNSET, SPAN_STATUS_OK } from '../tracing/spanstatus.js';\nimport { getCapturedScopesOnSpan } from '../tracing/utils.js';\nimport { consoleSandbox } from '../utils-hoist/logger.js';\nimport { addNonEnumerableProperty } from '../utils-hoist/object.js';\nimport { generateSpanId } from '../utils-hoist/propagationContext.js';\nimport { timestampInSeconds } from '../utils-hoist/time.js';\nimport { generateSentryTraceHeader } from '../utils-hoist/tracing.js';\nimport { _getSpanForScope } from './spanOnScope.js';\n\n// These are aligned with OpenTelemetry trace flags\nconst TRACE_FLAG_NONE = 0x0;\nconst TRACE_FLAG_SAMPLED = 0x1;\n\nlet hasShownSpanDropWarning = false;\n\n/**\n * Convert a span to a trace context, which can be sent as the `trace` context in an event.\n * By default, this will only include trace_id, span_id & parent_span_id.\n * If `includeAllData` is true, it will also include data, op, status & origin.\n */\nfunction spanToTransactionTraceContext(span) {\n  const { spanId: span_id, traceId: trace_id } = span.spanContext();\n  const { data, op, parent_span_id, status, origin, links } = spanToJSON(span);\n\n  return {\n    parent_span_id,\n    span_id,\n    trace_id,\n    data,\n    op,\n    status,\n    origin,\n    links,\n  };\n}\n\n/**\n * Convert a span to a trace context, which can be sent as the `trace` context in a non-transaction event.\n */\nfunction spanToTraceContext(span) {\n  const { spanId, traceId: trace_id, isRemote } = span.spanContext();\n\n  // If the span is remote, we use a random/virtual span as span_id to the trace context,\n  // and the remote span as parent_span_id\n  const parent_span_id = isRemote ? spanId : spanToJSON(span).parent_span_id;\n  const scope = getCapturedScopesOnSpan(span).scope;\n\n  const span_id = isRemote ? scope?.getPropagationContext().propagationSpanId || generateSpanId() : spanId;\n\n  return {\n    parent_span_id,\n    span_id,\n    trace_id,\n  };\n}\n\n/**\n * Convert a Span to a Sentry trace header.\n */\nfunction spanToTraceHeader(span) {\n  const { traceId, spanId } = span.spanContext();\n  const sampled = spanIsSampled(span);\n  return generateSentryTraceHeader(traceId, spanId, sampled);\n}\n\n/**\n *  Converts the span links array to a flattened version to be sent within an envelope.\n *\n *  If the links array is empty, it returns `undefined` so the empty value can be dropped before it's sent.\n */\nfunction convertSpanLinksForEnvelope(links) {\n  if (links && links.length > 0) {\n    return links.map(({ context: { spanId, traceId, traceFlags, ...restContext }, attributes }) => ({\n      span_id: spanId,\n      trace_id: traceId,\n      sampled: traceFlags === TRACE_FLAG_SAMPLED,\n      attributes,\n      ...restContext,\n    }));\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Convert a span time input into a timestamp in seconds.\n */\nfunction spanTimeInputToSeconds(input) {\n  if (typeof input === 'number') {\n    return ensureTimestampInSeconds(input);\n  }\n\n  if (Array.isArray(input)) {\n    // See {@link HrTime} for the array-based time format\n    return input[0] + input[1] / 1e9;\n  }\n\n  if (input instanceof Date) {\n    return ensureTimestampInSeconds(input.getTime());\n  }\n\n  return timestampInSeconds();\n}\n\n/**\n * Converts a timestamp to second, if it was in milliseconds, or keeps it as second.\n */\nfunction ensureTimestampInSeconds(timestamp) {\n  const isMs = timestamp > 9999999999;\n  return isMs ? timestamp / 1000 : timestamp;\n}\n\n/**\n * Convert a span to a JSON representation.\n */\n// Note: Because of this, we currently have a circular type dependency (which we opted out of in package.json).\n// This is not avoidable as we need `spanToJSON` in `spanUtils.ts`, which in turn is needed by `span.ts` for backwards compatibility.\n// And `spanToJSON` needs the Span class from `span.ts` to check here.\nfunction spanToJSON(span) {\n  if (spanIsSentrySpan(span)) {\n    return span.getSpanJSON();\n  }\n\n  const { spanId: span_id, traceId: trace_id } = span.spanContext();\n\n  // Handle a span from @opentelemetry/sdk-base-trace's `Span` class\n  if (spanIsOpenTelemetrySdkTraceBaseSpan(span)) {\n    const { attributes, startTime, name, endTime, parentSpanId, status, links } = span;\n\n    return {\n      span_id,\n      trace_id,\n      data: attributes,\n      description: name,\n      parent_span_id: parentSpanId,\n      start_timestamp: spanTimeInputToSeconds(startTime),\n      // This is [0,0] by default in OTEL, in which case we want to interpret this as no end time\n      timestamp: spanTimeInputToSeconds(endTime) || undefined,\n      status: getStatusMessage(status),\n      op: attributes[SEMANTIC_ATTRIBUTE_SENTRY_OP],\n      origin: attributes[SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN] ,\n      links: convertSpanLinksForEnvelope(links),\n    };\n  }\n\n  // Finally, at least we have `spanContext()`....\n  // This should not actually happen in reality, but we need to handle it for type safety.\n  return {\n    span_id,\n    trace_id,\n    start_timestamp: 0,\n    data: {},\n  };\n}\n\nfunction spanIsOpenTelemetrySdkTraceBaseSpan(span) {\n  const castSpan = span ;\n  return !!castSpan.attributes && !!castSpan.startTime && !!castSpan.name && !!castSpan.endTime && !!castSpan.status;\n}\n\n/** Exported only for tests. */\n\n/**\n * Sadly, due to circular dependency checks we cannot actually import the Span class here and check for instanceof.\n * :( So instead we approximate this by checking if it has the `getSpanJSON` method.\n */\nfunction spanIsSentrySpan(span) {\n  return typeof (span ).getSpanJSON === 'function';\n}\n\n/**\n * Returns true if a span is sampled.\n * In most cases, you should just use `span.isRecording()` instead.\n * However, this has a slightly different semantic, as it also returns false if the span is finished.\n * So in the case where this distinction is important, use this method.\n */\nfunction spanIsSampled(span) {\n  // We align our trace flags with the ones OpenTelemetry use\n  // So we also check for sampled the same way they do.\n  const { traceFlags } = span.spanContext();\n  return traceFlags === TRACE_FLAG_SAMPLED;\n}\n\n/** Get the status message to use for a JSON representation of a span. */\nfunction getStatusMessage(status) {\n  if (!status || status.code === SPAN_STATUS_UNSET) {\n    return undefined;\n  }\n\n  if (status.code === SPAN_STATUS_OK) {\n    return 'ok';\n  }\n\n  return status.message || 'unknown_error';\n}\n\nconst CHILD_SPANS_FIELD = '_sentryChildSpans';\nconst ROOT_SPAN_FIELD = '_sentryRootSpan';\n\n/**\n * Adds an opaque child span reference to a span.\n */\nfunction addChildSpanToSpan(span, childSpan) {\n  // We store the root span reference on the child span\n  // We need this for `getRootSpan()` to work\n  const rootSpan = span[ROOT_SPAN_FIELD] || span;\n  addNonEnumerableProperty(childSpan , ROOT_SPAN_FIELD, rootSpan);\n\n  // We store a list of child spans on the parent span\n  // We need this for `getSpanDescendants()` to work\n  if (span[CHILD_SPANS_FIELD]) {\n    span[CHILD_SPANS_FIELD].add(childSpan);\n  } else {\n    addNonEnumerableProperty(span, CHILD_SPANS_FIELD, new Set([childSpan]));\n  }\n}\n\n/** This is only used internally by Idle Spans. */\nfunction removeChildSpanFromSpan(span, childSpan) {\n  if (span[CHILD_SPANS_FIELD]) {\n    span[CHILD_SPANS_FIELD].delete(childSpan);\n  }\n}\n\n/**\n * Returns an array of the given span and all of its descendants.\n */\nfunction getSpanDescendants(span) {\n  const resultSet = new Set();\n\n  function addSpanChildren(span) {\n    // This exit condition is required to not infinitely loop in case of a circular dependency.\n    if (resultSet.has(span)) {\n      return;\n      // We want to ignore unsampled spans (e.g. non recording spans)\n    } else if (spanIsSampled(span)) {\n      resultSet.add(span);\n      const childSpans = span[CHILD_SPANS_FIELD] ? Array.from(span[CHILD_SPANS_FIELD]) : [];\n      for (const childSpan of childSpans) {\n        addSpanChildren(childSpan);\n      }\n    }\n  }\n\n  addSpanChildren(span);\n\n  return Array.from(resultSet);\n}\n\n/**\n * Returns the root span of a given span.\n */\nfunction getRootSpan(span) {\n  return span[ROOT_SPAN_FIELD] || span;\n}\n\n/**\n * Returns the currently active span.\n */\nfunction getActiveSpan() {\n  const carrier = getMainCarrier();\n  const acs = getAsyncContextStrategy(carrier);\n  if (acs.getActiveSpan) {\n    return acs.getActiveSpan();\n  }\n\n  return _getSpanForScope(getCurrentScope());\n}\n\n/**\n * Logs a warning once if `beforeSendSpan` is used to drop spans.\n */\nfunction showSpanDropWarning() {\n  if (!hasShownSpanDropWarning) {\n    consoleSandbox(() => {\n      // eslint-disable-next-line no-console\n      console.warn(\n        '[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.',\n      );\n    });\n    hasShownSpanDropWarning = true;\n  }\n}\n\n/**\n * Updates the name of the given span and ensures that the span name is not\n * overwritten by the Sentry SDK.\n *\n * Use this function instead of `span.updateName()` if you want to make sure that\n * your name is kept. For some spans, for example root `http.server` spans the\n * Sentry SDK would otherwise overwrite the span name with a high-quality name\n * it infers when the span ends.\n *\n * Use this function in server code or when your span is started on the server\n * and on the client (browser). If you only update a span name on the client,\n * you can also use `span.updateName()` the SDK does not overwrite the name.\n *\n * @param span - The span to update the name of.\n * @param name - The name to set on the span.\n */\nfunction updateSpanName(span, name) {\n  span.updateName(name);\n  span.setAttributes({\n    [SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]: 'custom',\n    [SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME]: name,\n  });\n}\n\nexport { TRACE_FLAG_NONE, TRACE_FLAG_SAMPLED, addChildSpanToSpan, convertSpanLinksForEnvelope, getActiveSpan, getRootSpan, getSpanDescendants, getStatusMessage, removeChildSpanFromSpan, showSpanDropWarning, spanIsSampled, spanTimeInputToSeconds, spanToJSON, spanToTraceContext, spanToTraceHeader, spanToTransactionTraceContext, updateSpanName };\n//# sourceMappingURL=spanUtils.js.map\n","const DEFAULT_ENVIRONMENT = 'production';\n\nexport { DEFAULT_ENVIRONMENT };\n//# sourceMappingURL=constants.js.map\n","import { DEFAULT_ENVIRONMENT } from '../constants.js';\nimport { getClient } from '../currentScopes.js';\nimport { SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE, SEMANTIC_ATTRIBUTE_SENTRY_SOURCE } from '../semanticAttributes.js';\nimport { baggageHeaderToDynamicSamplingContext, dynamicSamplingContextToSentryBaggageHeader } from '../utils-hoist/baggage.js';\nimport { addNonEnumerableProperty } from '../utils-hoist/object.js';\nimport { hasSpansEnabled } from '../utils/hasSpansEnabled.js';\nimport { getRootSpan, spanToJSON, spanIsSampled } from '../utils/spanUtils.js';\nimport { getCapturedScopesOnSpan } from './utils.js';\n\n/**\n * If you change this value, also update the terser plugin config to\n * avoid minification of the object property!\n */\nconst FROZEN_DSC_FIELD = '_frozenDsc';\n\n/**\n * Freeze the given DSC on the given span.\n */\nfunction freezeDscOnSpan(span, dsc) {\n  const spanWithMaybeDsc = span ;\n  addNonEnumerableProperty(spanWithMaybeDsc, FROZEN_DSC_FIELD, dsc);\n}\n\n/**\n * Creates a dynamic sampling context from a client.\n *\n * Dispatches the `createDsc` lifecycle hook as a side effect.\n */\nfunction getDynamicSamplingContextFromClient(trace_id, client) {\n  const options = client.getOptions();\n\n  const { publicKey: public_key } = client.getDsn() || {};\n\n  // Instead of conditionally adding non-undefined values, we add them and then remove them if needed\n  // otherwise, the order of baggage entries changes, which \"breaks\" a bunch of tests etc.\n  const dsc = {\n    environment: options.environment || DEFAULT_ENVIRONMENT,\n    release: options.release,\n    public_key,\n    trace_id,\n  };\n\n  client.emit('createDsc', dsc);\n\n  return dsc;\n}\n\n/**\n * Get the dynamic sampling context for the currently active scopes.\n */\nfunction getDynamicSamplingContextFromScope(client, scope) {\n  const propagationContext = scope.getPropagationContext();\n  return propagationContext.dsc || getDynamicSamplingContextFromClient(propagationContext.traceId, client);\n}\n\n/**\n * Creates a dynamic sampling context from a span (and client and scope)\n *\n * @param span the span from which a few values like the root span name and sample rate are extracted.\n *\n * @returns a dynamic sampling context\n */\nfunction getDynamicSamplingContextFromSpan(span) {\n  const client = getClient();\n  if (!client) {\n    return {};\n  }\n\n  const rootSpan = getRootSpan(span);\n  const rootSpanJson = spanToJSON(rootSpan);\n  const rootSpanAttributes = rootSpanJson.data;\n  const traceState = rootSpan.spanContext().traceState;\n\n  // The span sample rate that was locally applied to the root span should also always be applied to the DSC, even if the DSC is frozen.\n  // This is so that the downstream traces/services can use parentSampleRate in their `tracesSampler` to make consistent sampling decisions across the entire trace.\n  const rootSpanSampleRate =\n    traceState?.get('sentry.sample_rate') ?? rootSpanAttributes[SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE];\n  function applyLocalSampleRateToDsc(dsc) {\n    if (typeof rootSpanSampleRate === 'number' || typeof rootSpanSampleRate === 'string') {\n      dsc.sample_rate = `${rootSpanSampleRate}`;\n    }\n    return dsc;\n  }\n\n  // For core implementation, we freeze the DSC onto the span as a non-enumerable property\n  const frozenDsc = (rootSpan )[FROZEN_DSC_FIELD];\n  if (frozenDsc) {\n    return applyLocalSampleRateToDsc(frozenDsc);\n  }\n\n  // For OpenTelemetry, we freeze the DSC on the trace state\n  const traceStateDsc = traceState?.get('sentry.dsc');\n\n  // If the span has a DSC, we want it to take precedence\n  const dscOnTraceState = traceStateDsc && baggageHeaderToDynamicSamplingContext(traceStateDsc);\n\n  if (dscOnTraceState) {\n    return applyLocalSampleRateToDsc(dscOnTraceState);\n  }\n\n  // Else, we generate it from the span\n  const dsc = getDynamicSamplingContextFromClient(span.spanContext().traceId, client);\n\n  // We don't want to have a transaction name in the DSC if the source is \"url\" because URLs might contain PII\n  const source = rootSpanAttributes[SEMANTIC_ATTRIBUTE_SENTRY_SOURCE];\n\n  // after JSON conversion, txn.name becomes jsonSpan.description\n  const name = rootSpanJson.description;\n  if (source !== 'url' && name) {\n    dsc.transaction = name;\n  }\n\n  // How can we even land here with hasSpansEnabled() returning false?\n  // Otel creates a Non-recording span in Tracing Without Performance mode when handling incoming requests\n  // So we end up with an active span that is not sampled (neither positively nor negatively)\n  if (hasSpansEnabled()) {\n    dsc.sampled = String(spanIsSampled(rootSpan));\n    dsc.sample_rand =\n      // In OTEL we store the sample rand on the trace state because we cannot access scopes for NonRecordingSpans\n      // The Sentry OTEL SpanSampler takes care of writing the sample rand on the root span\n      traceState?.get('sentry.sample_rand') ??\n      // On all other platforms we can actually get the scopes from a root span (we use this as a fallback)\n      getCapturedScopesOnSpan(rootSpan).scope?.getPropagationContext().sampleRand.toString();\n  }\n\n  applyLocalSampleRateToDsc(dsc);\n\n  client.emit('createDsc', dsc, rootSpan);\n\n  return dsc;\n}\n\n/**\n * Convert a Span to a baggage header.\n */\nfunction spanToBaggageHeader(span) {\n  const dsc = getDynamicSamplingContextFromSpan(span);\n  return dynamicSamplingContextToSentryBaggageHeader(dsc);\n}\n\nexport { freezeDscOnSpan, getDynamicSamplingContextFromClient, getDynamicSamplingContextFromScope, getDynamicSamplingContextFromSpan, spanToBaggageHeader };\n//# sourceMappingURL=dynamicSamplingContext.js.map\n","import { getClient } from '../currentScopes.js';\n\n// Treeshakable guard to remove all code related to tracing\n\n/**\n * Determines if span recording is currently enabled.\n *\n * Spans are recorded when at least one of `tracesSampleRate` and `tracesSampler`\n * is defined in the SDK config. This function does not make any assumption about\n * sampling decisions, it only checks if the SDK is configured to record spans.\n *\n * Important: This function only determines if span recording is enabled. Trace\n * continuation and propagation is separately controlled and not covered by this function.\n * If this function returns `false`, traces can still be propagated (which is what\n * we refer to by \"Tracing without Performance\")\n * @see https://develop.sentry.dev/sdk/telemetry/traces/tracing-without-performance/\n *\n * @param maybeOptions An SDK options object to be passed to this function.\n * If this option is not provided, the function will use the current client's options.\n */\nfunction hasSpansEnabled(\n  maybeOptions,\n) {\n  if (typeof __SENTRY_TRACING__ === 'boolean' && !__SENTRY_TRACING__) {\n    return false;\n  }\n\n  const options = maybeOptions || getClient()?.getOptions();\n  return (\n    !!options &&\n    // Note: This check is `!= null`, meaning \"nullish\". `0` is not \"nullish\", `undefined` and `null` are. (This comment was brought to you by 15 minutes of questioning life)\n    (options.tracesSampleRate != null || !!options.tracesSampler)\n  );\n}\n\n/**\n * @see JSDoc of `hasSpansEnabled`\n * @deprecated Use `hasSpansEnabled` instead, which is a more accurately named version of this function.\n * This function will be removed in the next major version of the SDK.\n */\n// TODO(v10): Remove this export\nconst hasTracingEnabled = hasSpansEnabled;\n\nexport { hasSpansEnabled, hasTracingEnabled };\n//# sourceMappingURL=hasSpansEnabled.js.map\n","import { DEBUG_BUILD } from './debug-build.js';\nimport { consoleSandbox, logger } from './logger.js';\n\n/** Regular expression used to parse a Dsn. */\nconst DSN_REGEX = /^(?:(\\w+):)\\/\\/(?:(\\w+)(?::(\\w+)?)?@)([\\w.-]+)(?::(\\d+))?\\/(.+)/;\n\nfunction isValidProtocol(protocol) {\n  return protocol === 'http' || protocol === 'https';\n}\n\n/**\n * Renders the string representation of this Dsn.\n *\n * By default, this will render the public representation without the password\n * component. To get the deprecated private representation, set `withPassword`\n * to true.\n *\n * @param withPassword When set to true, the password will be included.\n */\nfunction dsnToString(dsn, withPassword = false) {\n  const { host, path, pass, port, projectId, protocol, publicKey } = dsn;\n  return (\n    `${protocol}://${publicKey}${withPassword && pass ? `:${pass}` : ''}` +\n    `@${host}${port ? `:${port}` : ''}/${path ? `${path}/` : path}${projectId}`\n  );\n}\n\n/**\n * Parses a Dsn from a given string.\n *\n * @param str A Dsn as string\n * @returns Dsn as DsnComponents or undefined if @param str is not a valid DSN string\n */\nfunction dsnFromString(str) {\n  const match = DSN_REGEX.exec(str);\n\n  if (!match) {\n    // This should be logged to the console\n    consoleSandbox(() => {\n      // eslint-disable-next-line no-console\n      console.error(`Invalid Sentry Dsn: ${str}`);\n    });\n    return undefined;\n  }\n\n  const [protocol, publicKey, pass = '', host = '', port = '', lastPath = ''] = match.slice(1);\n  let path = '';\n  let projectId = lastPath;\n\n  const split = projectId.split('/');\n  if (split.length > 1) {\n    path = split.slice(0, -1).join('/');\n    projectId = split.pop() ;\n  }\n\n  if (projectId) {\n    const projectMatch = projectId.match(/^\\d+/);\n    if (projectMatch) {\n      projectId = projectMatch[0];\n    }\n  }\n\n  return dsnFromComponents({ host, pass, path, projectId, port, protocol: protocol , publicKey });\n}\n\nfunction dsnFromComponents(components) {\n  return {\n    protocol: components.protocol,\n    publicKey: components.publicKey || '',\n    pass: components.pass || '',\n    host: components.host,\n    port: components.port || '',\n    path: components.path || '',\n    projectId: components.projectId,\n  };\n}\n\nfunction validateDsn(dsn) {\n  if (!DEBUG_BUILD) {\n    return true;\n  }\n\n  const { port, projectId, protocol } = dsn;\n\n  const requiredComponents = ['protocol', 'publicKey', 'host', 'projectId'];\n  const hasMissingRequiredComponent = requiredComponents.find(component => {\n    if (!dsn[component]) {\n      logger.error(`Invalid Sentry Dsn: ${component} missing`);\n      return true;\n    }\n    return false;\n  });\n\n  if (hasMissingRequiredComponent) {\n    return false;\n  }\n\n  if (!projectId.match(/^\\d+$/)) {\n    logger.error(`Invalid Sentry Dsn: Invalid projectId ${projectId}`);\n    return false;\n  }\n\n  if (!isValidProtocol(protocol)) {\n    logger.error(`Invalid Sentry Dsn: Invalid protocol ${protocol}`);\n    return false;\n  }\n\n  if (port && isNaN(parseInt(port, 10))) {\n    logger.error(`Invalid Sentry Dsn: Invalid port ${port}`);\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Creates a valid Sentry Dsn object, identifying a Sentry instance and project.\n * @returns a valid DsnComponents object or `undefined` if @param from is an invalid DSN source\n */\nfunction makeDsn(from) {\n  const components = typeof from === 'string' ? dsnFromString(from) : dsnFromComponents(from);\n  if (!components || !validateDsn(components)) {\n    return undefined;\n  }\n  return components;\n}\n\nexport { dsnFromString, dsnToString, makeDsn };\n//# sourceMappingURL=dsn.js.map\n","import { isVueViewModel, isSyntheticEvent } from './is.js';\nimport { convertToPlainObject } from './object.js';\nimport { getFunctionName } from './stacktrace.js';\n\n/**\n * Recursively normalizes the given object.\n *\n * - Creates a copy to prevent original input mutation\n * - Skips non-enumerable properties\n * - When stringifying, calls `toJSON` if implemented\n * - Removes circular references\n * - Translates non-serializable values (`undefined`/`NaN`/functions) to serializable format\n * - Translates known global objects/classes to a string representations\n * - Takes care of `Error` object serialization\n * - Optionally limits depth of final output\n * - Optionally limits number of properties/elements included in any single object/array\n *\n * @param input The object to be normalized.\n * @param depth The max depth to which to normalize the object. (Anything deeper stringified whole.)\n * @param maxProperties The max number of elements or properties to be included in any single array or\n * object in the normalized output.\n * @returns A normalized version of the object, or `\"**non-serializable**\"` if any errors are thrown during normalization.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction normalize(input, depth = 100, maxProperties = +Infinity) {\n  try {\n    // since we're at the outermost level, we don't provide a key\n    return visit('', input, depth, maxProperties);\n  } catch (err) {\n    return { ERROR: `**non-serializable** (${err})` };\n  }\n}\n\n/** JSDoc */\nfunction normalizeToSize(\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  object,\n  // Default Node.js REPL depth\n  depth = 3,\n  // 100kB, as 200kB is max payload size, so half sounds reasonable\n  maxSize = 100 * 1024,\n) {\n  const normalized = normalize(object, depth);\n\n  if (jsonSize(normalized) > maxSize) {\n    return normalizeToSize(object, depth - 1, maxSize);\n  }\n\n  return normalized ;\n}\n\n/**\n * Visits a node to perform normalization on it\n *\n * @param key The key corresponding to the given node\n * @param value The node to be visited\n * @param depth Optional number indicating the maximum recursion depth\n * @param maxProperties Optional maximum number of properties/elements included in any single object/array\n * @param memo Optional Memo class handling decycling\n */\nfunction visit(\n  key,\n  value,\n  depth = +Infinity,\n  maxProperties = +Infinity,\n  memo = memoBuilder(),\n) {\n  const [memoize, unmemoize] = memo;\n\n  // Get the simple cases out of the way first\n  if (\n    value == null || // this matches null and undefined -> eqeq not eqeqeq\n    ['boolean', 'string'].includes(typeof value) ||\n    (typeof value === 'number' && Number.isFinite(value))\n  ) {\n    return value ;\n  }\n\n  const stringified = stringifyValue(key, value);\n\n  // Anything we could potentially dig into more (objects or arrays) will have come back as `\"[object XXXX]\"`.\n  // Everything else will have already been serialized, so if we don't see that pattern, we're done.\n  if (!stringified.startsWith('[object ')) {\n    return stringified;\n  }\n\n  // From here on, we can assert that `value` is either an object or an array.\n\n  // Do not normalize objects that we know have already been normalized. As a general rule, the\n  // \"__sentry_skip_normalization__\" property should only be used sparingly and only should only be set on objects that\n  // have already been normalized.\n  if ((value )['__sentry_skip_normalization__']) {\n    return value ;\n  }\n\n  // We can set `__sentry_override_normalization_depth__` on an object to ensure that from there\n  // We keep a certain amount of depth.\n  // This should be used sparingly, e.g. we use it for the redux integration to ensure we get a certain amount of state.\n  const remainingDepth =\n    typeof (value )['__sentry_override_normalization_depth__'] === 'number'\n      ? ((value )['__sentry_override_normalization_depth__'] )\n      : depth;\n\n  // We're also done if we've reached the max depth\n  if (remainingDepth === 0) {\n    // At this point we know `serialized` is a string of the form `\"[object XXXX]\"`. Clean it up so it's just `\"[XXXX]\"`.\n    return stringified.replace('object ', '');\n  }\n\n  // If we've already visited this branch, bail out, as it's circular reference. If not, note that we're seeing it now.\n  if (memoize(value)) {\n    return '[Circular ~]';\n  }\n\n  // If the value has a `toJSON` method, we call it to extract more information\n  const valueWithToJSON = value ;\n  if (valueWithToJSON && typeof valueWithToJSON.toJSON === 'function') {\n    try {\n      const jsonValue = valueWithToJSON.toJSON();\n      // We need to normalize the return value of `.toJSON()` in case it has circular references\n      return visit('', jsonValue, remainingDepth - 1, maxProperties, memo);\n    } catch (err) {\n      // pass (The built-in `toJSON` failed, but we can still try to do it ourselves)\n    }\n  }\n\n  // At this point we know we either have an object or an array, we haven't seen it before, and we're going to recurse\n  // because we haven't yet reached the max depth. Create an accumulator to hold the results of visiting each\n  // property/entry, and keep track of the number of items we add to it.\n  const normalized = (Array.isArray(value) ? [] : {}) ;\n  let numAdded = 0;\n\n  // Before we begin, convert`Error` and`Event` instances into plain objects, since some of each of their relevant\n  // properties are non-enumerable and otherwise would get missed.\n  const visitable = convertToPlainObject(value );\n\n  for (const visitKey in visitable) {\n    // Avoid iterating over fields in the prototype if they've somehow been exposed to enumeration.\n    if (!Object.prototype.hasOwnProperty.call(visitable, visitKey)) {\n      continue;\n    }\n\n    if (numAdded >= maxProperties) {\n      normalized[visitKey] = '[MaxProperties ~]';\n      break;\n    }\n\n    // Recursively visit all the child nodes\n    const visitValue = visitable[visitKey];\n    normalized[visitKey] = visit(visitKey, visitValue, remainingDepth - 1, maxProperties, memo);\n\n    numAdded++;\n  }\n\n  // Once we've visited all the branches, remove the parent from memo storage\n  unmemoize(value);\n\n  // Return accumulated values\n  return normalized;\n}\n\n/* eslint-disable complexity */\n/**\n * Stringify the given value. Handles various known special values and types.\n *\n * Not meant to be used on simple primitives which already have a string representation, as it will, for example, turn\n * the number 1231 into \"[Object Number]\", nor on `null`, as it will throw.\n *\n * @param value The value to stringify\n * @returns A stringified representation of the given value\n */\nfunction stringifyValue(\n  key,\n  // this type is a tiny bit of a cheat, since this function does handle NaN (which is technically a number), but for\n  // our internal use, it'll do\n  value,\n) {\n  try {\n    if (key === 'domain' && value && typeof value === 'object' && (value )._events) {\n      return '[Domain]';\n    }\n\n    if (key === 'domainEmitter') {\n      return '[DomainEmitter]';\n    }\n\n    // It's safe to use `global`, `window`, and `document` here in this manner, as we are asserting using `typeof` first\n    // which won't throw if they are not present.\n\n    if (typeof global !== 'undefined' && value === global) {\n      return '[Global]';\n    }\n\n    // eslint-disable-next-line no-restricted-globals\n    if (typeof window !== 'undefined' && value === window) {\n      return '[Window]';\n    }\n\n    // eslint-disable-next-line no-restricted-globals\n    if (typeof document !== 'undefined' && value === document) {\n      return '[Document]';\n    }\n\n    if (isVueViewModel(value)) {\n      return '[VueViewModel]';\n    }\n\n    // React's SyntheticEvent thingy\n    if (isSyntheticEvent(value)) {\n      return '[SyntheticEvent]';\n    }\n\n    if (typeof value === 'number' && !Number.isFinite(value)) {\n      return `[${value}]`;\n    }\n\n    if (typeof value === 'function') {\n      return `[Function: ${getFunctionName(value)}]`;\n    }\n\n    if (typeof value === 'symbol') {\n      return `[${String(value)}]`;\n    }\n\n    // stringified BigInts are indistinguishable from regular numbers, so we need to label them to avoid confusion\n    if (typeof value === 'bigint') {\n      return `[BigInt: ${String(value)}]`;\n    }\n\n    // Now that we've knocked out all the special cases and the primitives, all we have left are objects. Simply casting\n    // them to strings means that instances of classes which haven't defined their `toStringTag` will just come out as\n    // `\"[object Object]\"`. If we instead look at the constructor's name (which is the same as the name of the class),\n    // we can make sure that only plain objects come out that way.\n    const objName = getConstructorName(value);\n\n    // Handle HTML Elements\n    if (/^HTML(\\w*)Element$/.test(objName)) {\n      return `[HTMLElement: ${objName}]`;\n    }\n\n    return `[object ${objName}]`;\n  } catch (err) {\n    return `**non-serializable** (${err})`;\n  }\n}\n/* eslint-enable complexity */\n\nfunction getConstructorName(value) {\n  const prototype = Object.getPrototypeOf(value);\n\n  return prototype?.constructor ? prototype.constructor.name : 'null prototype';\n}\n\n/** Calculates bytes size of input string */\nfunction utf8Length(value) {\n  // eslint-disable-next-line no-bitwise\n  return ~-encodeURI(value).split(/%..|./).length;\n}\n\n/** Calculates bytes size of input object */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction jsonSize(value) {\n  return utf8Length(JSON.stringify(value));\n}\n\n/**\n * Normalizes URLs in exceptions and stacktraces to a base path so Sentry can fingerprint\n * across platforms and working directory.\n *\n * @param url The URL to be normalized.\n * @param basePath The application base path.\n * @returns The normalized URL.\n */\nfunction normalizeUrlToBase(url, basePath) {\n  const escapedBase = basePath\n    // Backslash to forward\n    .replace(/\\\\/g, '/')\n    // Escape RegExp special characters\n    .replace(/[|\\\\{}()[\\]^$+*?.]/g, '\\\\$&');\n\n  let newUrl = url;\n  try {\n    newUrl = decodeURI(url);\n  } catch (_Oo) {\n    // Sometime this breaks\n  }\n  return (\n    newUrl\n      .replace(/\\\\/g, '/')\n      .replace(/webpack:\\/?/g, '') // Remove intermediate base path\n      // eslint-disable-next-line @sentry-internal/sdk/no-regexp-constructor\n      .replace(new RegExp(`(file://)?/*${escapedBase}/*`, 'ig'), 'app:///')\n  );\n}\n\n/**\n * Helper to decycle json objects\n */\nfunction memoBuilder() {\n  const inner = new WeakSet();\n  function memoize(obj) {\n    if (inner.has(obj)) {\n      return true;\n    }\n    inner.add(obj);\n    return false;\n  }\n\n  function unmemoize(obj) {\n    inner.delete(obj);\n  }\n  return [memoize, unmemoize];\n}\n\nexport { normalize, normalizeToSize, normalizeUrlToBase };\n//# sourceMappingURL=normalize.js.map\n","import { getSentryCarrier } from '../carrier.js';\nimport { dsnToString } from './dsn.js';\nimport { normalize } from './normalize.js';\nimport { GLOBAL_OBJ } from './worldwide.js';\n\n/**\n * Creates an envelope.\n * Make sure to always explicitly provide the generic to this function\n * so that the envelope types resolve correctly.\n */\nfunction createEnvelope(headers, items = []) {\n  return [headers, items] ;\n}\n\n/**\n * Add an item to an envelope.\n * Make sure to always explicitly provide the generic to this function\n * so that the envelope types resolve correctly.\n */\nfunction addItemToEnvelope(envelope, newItem) {\n  const [headers, items] = envelope;\n  return [headers, [...items, newItem]] ;\n}\n\n/**\n * Convenience function to loop through the items and item types of an envelope.\n * (This function was mostly created because working with envelope types is painful at the moment)\n *\n * If the callback returns true, the rest of the items will be skipped.\n */\nfunction forEachEnvelopeItem(\n  envelope,\n  callback,\n) {\n  const envelopeItems = envelope[1];\n\n  for (const envelopeItem of envelopeItems) {\n    const envelopeItemType = envelopeItem[0].type;\n    const result = callback(envelopeItem, envelopeItemType);\n\n    if (result) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Returns true if the envelope contains any of the given envelope item types\n */\nfunction envelopeContainsItemType(envelope, types) {\n  return forEachEnvelopeItem(envelope, (_, type) => types.includes(type));\n}\n\n/**\n * Encode a string to UTF8 array.\n */\nfunction encodeUTF8(input) {\n  const carrier = getSentryCarrier(GLOBAL_OBJ);\n  return carrier.encodePolyfill ? carrier.encodePolyfill(input) : new TextEncoder().encode(input);\n}\n\n/**\n * Decode a UTF8 array to string.\n */\nfunction decodeUTF8(input) {\n  const carrier = getSentryCarrier(GLOBAL_OBJ);\n  return carrier.decodePolyfill ? carrier.decodePolyfill(input) : new TextDecoder().decode(input);\n}\n\n/**\n * Serializes an envelope.\n */\nfunction serializeEnvelope(envelope) {\n  const [envHeaders, items] = envelope;\n\n  // Initially we construct our envelope as a string and only convert to binary chunks if we encounter binary data\n  let parts = JSON.stringify(envHeaders);\n\n  function append(next) {\n    if (typeof parts === 'string') {\n      parts = typeof next === 'string' ? parts + next : [encodeUTF8(parts), next];\n    } else {\n      parts.push(typeof next === 'string' ? encodeUTF8(next) : next);\n    }\n  }\n\n  for (const item of items) {\n    const [itemHeaders, payload] = item;\n\n    append(`\\n${JSON.stringify(itemHeaders)}\\n`);\n\n    if (typeof payload === 'string' || payload instanceof Uint8Array) {\n      append(payload);\n    } else {\n      let stringifiedPayload;\n      try {\n        stringifiedPayload = JSON.stringify(payload);\n      } catch (e) {\n        // In case, despite all our efforts to keep `payload` circular-dependency-free, `JSON.stringify()` still\n        // fails, we try again after normalizing it again with infinite normalization depth. This of course has a\n        // performance impact but in this case a performance hit is better than throwing.\n        stringifiedPayload = JSON.stringify(normalize(payload));\n      }\n      append(stringifiedPayload);\n    }\n  }\n\n  return typeof parts === 'string' ? parts : concatBuffers(parts);\n}\n\nfunction concatBuffers(buffers) {\n  const totalLength = buffers.reduce((acc, buf) => acc + buf.length, 0);\n\n  const merged = new Uint8Array(totalLength);\n  let offset = 0;\n  for (const buffer of buffers) {\n    merged.set(buffer, offset);\n    offset += buffer.length;\n  }\n\n  return merged;\n}\n\n/**\n * Parses an envelope\n */\nfunction parseEnvelope(env) {\n  let buffer = typeof env === 'string' ? encodeUTF8(env) : env;\n\n  function readBinary(length) {\n    const bin = buffer.subarray(0, length);\n    // Replace the buffer with the remaining data excluding trailing newline\n    buffer = buffer.subarray(length + 1);\n    return bin;\n  }\n\n  function readJson() {\n    let i = buffer.indexOf(0xa);\n    // If we couldn't find a newline, we must have found the end of the buffer\n    if (i < 0) {\n      i = buffer.length;\n    }\n\n    return JSON.parse(decodeUTF8(readBinary(i))) ;\n  }\n\n  const envelopeHeader = readJson();\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const items = [];\n\n  while (buffer.length) {\n    const itemHeader = readJson();\n    const binaryLength = typeof itemHeader.length === 'number' ? itemHeader.length : undefined;\n\n    items.push([itemHeader, binaryLength ? readBinary(binaryLength) : readJson()]);\n  }\n\n  return [envelopeHeader, items];\n}\n\n/**\n * Creates envelope item for a single span\n */\nfunction createSpanEnvelopeItem(spanJson) {\n  const spanHeaders = {\n    type: 'span',\n  };\n\n  return [spanHeaders, spanJson];\n}\n\n/**\n * Creates attachment envelope items\n */\nfunction createAttachmentEnvelopeItem(attachment) {\n  const buffer = typeof attachment.data === 'string' ? encodeUTF8(attachment.data) : attachment.data;\n\n  return [\n    {\n      type: 'attachment',\n      length: buffer.length,\n      filename: attachment.filename,\n      content_type: attachment.contentType,\n      attachment_type: attachment.attachmentType,\n    },\n    buffer,\n  ];\n}\n\nconst ITEM_TYPE_TO_DATA_CATEGORY_MAP = {\n  session: 'session',\n  sessions: 'session',\n  attachment: 'attachment',\n  transaction: 'transaction',\n  event: 'error',\n  client_report: 'internal',\n  user_report: 'default',\n  profile: 'profile',\n  profile_chunk: 'profile',\n  replay_event: 'replay',\n  replay_recording: 'replay',\n  check_in: 'monitor',\n  feedback: 'feedback',\n  span: 'span',\n  raw_security: 'security',\n  otel_log: 'log_item',\n};\n\n/**\n * Maps the type of an envelope item to a data category.\n */\nfunction envelopeItemTypeToDataCategory(type) {\n  return ITEM_TYPE_TO_DATA_CATEGORY_MAP[type];\n}\n\n/** Extracts the minimal SDK info from the metadata or an events */\nfunction getSdkMetadataForEnvelopeHeader(metadataOrEvent) {\n  if (!metadataOrEvent?.sdk) {\n    return;\n  }\n  const { name, version } = metadataOrEvent.sdk;\n  return { name, version };\n}\n\n/**\n * Creates event envelope headers, based on event, sdk info and tunnel\n * Note: This function was extracted from the core package to make it available in Replay\n */\nfunction createEventEnvelopeHeaders(\n  event,\n  sdkInfo,\n  tunnel,\n  dsn,\n) {\n  const dynamicSamplingContext = event.sdkProcessingMetadata?.dynamicSamplingContext;\n  return {\n    event_id: event.event_id ,\n    sent_at: new Date().toISOString(),\n    ...(sdkInfo && { sdk: sdkInfo }),\n    ...(!!tunnel && dsn && { dsn: dsnToString(dsn) }),\n    ...(dynamicSamplingContext && {\n      trace: dynamicSamplingContext,\n    }),\n  };\n}\n\nexport { addItemToEnvelope, createAttachmentEnvelopeItem, createEnvelope, createEventEnvelopeHeaders, createSpanEnvelopeItem, envelopeContainsItemType, envelopeItemTypeToDataCategory, forEachEnvelopeItem, getSdkMetadataForEnvelopeHeader, parseEnvelope, serializeEnvelope };\n//# sourceMappingURL=envelope.js.map\n","import { getDynamicSamplingContextFromSpan } from './tracing/dynamicSamplingContext.js';\nimport { dsnToString } from './utils-hoist/dsn.js';\nimport { getSdkMetadataForEnvelopeHeader, createEventEnvelopeHeaders, createEnvelope, createSpanEnvelopeItem } from './utils-hoist/envelope.js';\nimport './utils-hoist/debug-build.js';\nimport './utils-hoist/logger.js';\nimport { spanToJSON, showSpanDropWarning } from './utils/spanUtils.js';\n\n/**\n * Apply SdkInfo (name, version, packages, integrations) to the corresponding event key.\n * Merge with existing data if any.\n **/\nfunction enhanceEventWithSdkInfo(event, sdkInfo) {\n  if (!sdkInfo) {\n    return event;\n  }\n  event.sdk = event.sdk || {};\n  event.sdk.name = event.sdk.name || sdkInfo.name;\n  event.sdk.version = event.sdk.version || sdkInfo.version;\n  event.sdk.integrations = [...(event.sdk.integrations || []), ...(sdkInfo.integrations || [])];\n  event.sdk.packages = [...(event.sdk.packages || []), ...(sdkInfo.packages || [])];\n  return event;\n}\n\n/** Creates an envelope from a Session */\nfunction createSessionEnvelope(\n  session,\n  dsn,\n  metadata,\n  tunnel,\n) {\n  const sdkInfo = getSdkMetadataForEnvelopeHeader(metadata);\n  const envelopeHeaders = {\n    sent_at: new Date().toISOString(),\n    ...(sdkInfo && { sdk: sdkInfo }),\n    ...(!!tunnel && dsn && { dsn: dsnToString(dsn) }),\n  };\n\n  const envelopeItem =\n    'aggregates' in session ? [{ type: 'sessions' }, session] : [{ type: 'session' }, session.toJSON()];\n\n  return createEnvelope(envelopeHeaders, [envelopeItem]);\n}\n\n/**\n * Create an Envelope from an event.\n */\nfunction createEventEnvelope(\n  event,\n  dsn,\n  metadata,\n  tunnel,\n) {\n  const sdkInfo = getSdkMetadataForEnvelopeHeader(metadata);\n\n  /*\n    Note: Due to TS, event.type may be `replay_event`, theoretically.\n    In practice, we never call `createEventEnvelope` with `replay_event` type,\n    and we'd have to adjust a looot of types to make this work properly.\n    We want to avoid casting this around, as that could lead to bugs (e.g. when we add another type)\n    So the safe choice is to really guard against the replay_event type here.\n  */\n  const eventType = event.type && event.type !== 'replay_event' ? event.type : 'event';\n\n  enhanceEventWithSdkInfo(event, metadata?.sdk);\n\n  const envelopeHeaders = createEventEnvelopeHeaders(event, sdkInfo, tunnel, dsn);\n\n  // Prevent this data (which, if it exists, was used in earlier steps in the processing pipeline) from being sent to\n  // sentry. (Note: Our use of this property comes and goes with whatever we might be debugging, whatever hacks we may\n  // have temporarily added, etc. Even if we don't happen to be using it at some point in the future, let's not get rid\n  // of this `delete`, lest we miss putting it back in the next time the property is in use.)\n  delete event.sdkProcessingMetadata;\n\n  const eventItem = [{ type: eventType }, event];\n  return createEnvelope(envelopeHeaders, [eventItem]);\n}\n\n/**\n * Create envelope from Span item.\n *\n * Takes an optional client and runs spans through `beforeSendSpan` if available.\n */\nfunction createSpanEnvelope(spans, client) {\n  function dscHasRequiredProps(dsc) {\n    return !!dsc.trace_id && !!dsc.public_key;\n  }\n\n  // For the moment we'll obtain the DSC from the first span in the array\n  // This might need to be changed if we permit sending multiple spans from\n  // different segments in one envelope\n  const dsc = getDynamicSamplingContextFromSpan(spans[0]);\n\n  const dsn = client?.getDsn();\n  const tunnel = client?.getOptions().tunnel;\n\n  const headers = {\n    sent_at: new Date().toISOString(),\n    ...(dscHasRequiredProps(dsc) && { trace: dsc }),\n    ...(!!tunnel && dsn && { dsn: dsnToString(dsn) }),\n  };\n\n  const beforeSendSpan = client?.getOptions().beforeSendSpan;\n  const convertToSpanJSON = beforeSendSpan\n    ? (span) => {\n        const spanJson = spanToJSON(span);\n        const processedSpan = beforeSendSpan(spanJson);\n\n        if (!processedSpan) {\n          showSpanDropWarning();\n          return spanJson;\n        }\n\n        return processedSpan;\n      }\n    : spanToJSON;\n\n  const items = [];\n  for (const span of spans) {\n    const spanJson = convertToSpanJSON(span);\n    if (spanJson) {\n      items.push(createSpanEnvelopeItem(spanJson));\n    }\n  }\n\n  return createEnvelope(headers, items);\n}\n\nexport { createEventEnvelope, createSessionEnvelope, createSpanEnvelope };\n//# sourceMappingURL=envelope.js.map\n","import { DEBUG_BUILD } from './debug-build.js';\nimport { isThenable } from './utils-hoist/is.js';\nimport { logger } from './utils-hoist/logger.js';\nimport { SyncPromise } from './utils-hoist/syncpromise.js';\n\n/**\n * Process an array of event processors, returning the processed event (or `null` if the event was dropped).\n */\nfunction notifyEventProcessors(\n  processors,\n  event,\n  hint,\n  index = 0,\n) {\n  return new SyncPromise((resolve, reject) => {\n    const processor = processors[index];\n    if (event === null || typeof processor !== 'function') {\n      resolve(event);\n    } else {\n      const result = processor({ ...event }, hint) ;\n\n      DEBUG_BUILD && processor.id && result === null && logger.log(`Event processor \"${processor.id}\" dropped event`);\n\n      if (isThenable(result)) {\n        void result\n          .then(final => notifyEventProcessors(processors, final, hint, index + 1).then(resolve))\n          .then(null, reject);\n      } else {\n        void notifyEventProcessors(processors, result, hint, index + 1)\n          .then(resolve)\n          .then(null, reject);\n      }\n    }\n  });\n}\n\nexport { notifyEventProcessors };\n//# sourceMappingURL=eventProcessors.js.map\n","import { GLOBAL_OBJ } from './worldwide.js';\n\nlet parsedStackResults;\nlet lastKeysCount;\nlet cachedFilenameDebugIds;\n\n/**\n * Returns a map of filenames to debug identifiers.\n */\nfunction getFilenameToDebugIdMap(stackParser) {\n  const debugIdMap = GLOBAL_OBJ._sentryDebugIds;\n  if (!debugIdMap) {\n    return {};\n  }\n\n  const debugIdKeys = Object.keys(debugIdMap);\n\n  // If the count of registered globals hasn't changed since the last call, we\n  // can just return the cached result.\n  if (cachedFilenameDebugIds && debugIdKeys.length === lastKeysCount) {\n    return cachedFilenameDebugIds;\n  }\n\n  lastKeysCount = debugIdKeys.length;\n\n  // Build a map of filename -> debug_id.\n  cachedFilenameDebugIds = debugIdKeys.reduce((acc, stackKey) => {\n    if (!parsedStackResults) {\n      parsedStackResults = {};\n    }\n\n    const result = parsedStackResults[stackKey];\n\n    if (result) {\n      acc[result[0]] = result[1];\n    } else {\n      const parsedStack = stackParser(stackKey);\n\n      for (let i = parsedStack.length - 1; i >= 0; i--) {\n        const stackFrame = parsedStack[i];\n        const filename = stackFrame?.filename;\n        const debugId = debugIdMap[stackKey];\n\n        if (filename && debugId) {\n          acc[filename] = debugId;\n          parsedStackResults[stackKey] = [filename, debugId];\n          break;\n        }\n      }\n    }\n\n    return acc;\n  }, {});\n\n  return cachedFilenameDebugIds;\n}\n\n/**\n * Returns a list of debug images for the given resources.\n */\nfunction getDebugImagesForResources(\n  stackParser,\n  resource_paths,\n) {\n  const filenameDebugIdMap = getFilenameToDebugIdMap(stackParser);\n\n  if (!filenameDebugIdMap) {\n    return [];\n  }\n\n  const images = [];\n  for (const path of resource_paths) {\n    if (path && filenameDebugIdMap[path]) {\n      images.push({\n        type: 'sourcemap',\n        code_file: path,\n        debug_id: filenameDebugIdMap[path] ,\n      });\n    }\n  }\n\n  return images;\n}\n\nexport { getDebugImagesForResources, getFilenameToDebugIdMap };\n//# sourceMappingURL=debug-ids.js.map\n","import { getDynamicSamplingContextFromSpan } from '../tracing/dynamicSamplingContext.js';\nimport { merge } from './merge.js';\nimport { spanToTraceContext, getRootSpan, spanToJSON } from './spanUtils.js';\n\n/**\n * Applies data from the scope to the event and runs all event processors on it.\n */\nfunction applyScopeDataToEvent(event, data) {\n  const { fingerprint, span, breadcrumbs, sdkProcessingMetadata } = data;\n\n  // Apply general data\n  applyDataToEvent(event, data);\n\n  // We want to set the trace context for normal events only if there isn't already\n  // a trace context on the event. There is a product feature in place where we link\n  // errors with transaction and it relies on that.\n  if (span) {\n    applySpanToEvent(event, span);\n  }\n\n  applyFingerprintToEvent(event, fingerprint);\n  applyBreadcrumbsToEvent(event, breadcrumbs);\n  applySdkMetadataToEvent(event, sdkProcessingMetadata);\n}\n\n/** Merge data of two scopes together. */\nfunction mergeScopeData(data, mergeData) {\n  const {\n    extra,\n    tags,\n    user,\n    contexts,\n    level,\n    sdkProcessingMetadata,\n    breadcrumbs,\n    fingerprint,\n    eventProcessors,\n    attachments,\n    propagationContext,\n    transactionName,\n    span,\n  } = mergeData;\n\n  mergeAndOverwriteScopeData(data, 'extra', extra);\n  mergeAndOverwriteScopeData(data, 'tags', tags);\n  mergeAndOverwriteScopeData(data, 'user', user);\n  mergeAndOverwriteScopeData(data, 'contexts', contexts);\n\n  data.sdkProcessingMetadata = merge(data.sdkProcessingMetadata, sdkProcessingMetadata, 2);\n\n  if (level) {\n    data.level = level;\n  }\n\n  if (transactionName) {\n    data.transactionName = transactionName;\n  }\n\n  if (span) {\n    data.span = span;\n  }\n\n  if (breadcrumbs.length) {\n    data.breadcrumbs = [...data.breadcrumbs, ...breadcrumbs];\n  }\n\n  if (fingerprint.length) {\n    data.fingerprint = [...data.fingerprint, ...fingerprint];\n  }\n\n  if (eventProcessors.length) {\n    data.eventProcessors = [...data.eventProcessors, ...eventProcessors];\n  }\n\n  if (attachments.length) {\n    data.attachments = [...data.attachments, ...attachments];\n  }\n\n  data.propagationContext = { ...data.propagationContext, ...propagationContext };\n}\n\n/**\n * Merges certain scope data. Undefined values will overwrite any existing values.\n * Exported only for tests.\n */\nfunction mergeAndOverwriteScopeData\n\n(data, prop, mergeVal) {\n  data[prop] = merge(data[prop], mergeVal, 1);\n}\n\nfunction applyDataToEvent(event, data) {\n  const { extra, tags, user, contexts, level, transactionName } = data;\n\n  if (Object.keys(extra).length) {\n    event.extra = { ...extra, ...event.extra };\n  }\n\n  if (Object.keys(tags).length) {\n    event.tags = { ...tags, ...event.tags };\n  }\n\n  if (Object.keys(user).length) {\n    event.user = { ...user, ...event.user };\n  }\n\n  if (Object.keys(contexts).length) {\n    event.contexts = { ...contexts, ...event.contexts };\n  }\n\n  if (level) {\n    event.level = level;\n  }\n\n  // transaction events get their `transaction` from the root span name\n  if (transactionName && event.type !== 'transaction') {\n    event.transaction = transactionName;\n  }\n}\n\nfunction applyBreadcrumbsToEvent(event, breadcrumbs) {\n  const mergedBreadcrumbs = [...(event.breadcrumbs || []), ...breadcrumbs];\n  event.breadcrumbs = mergedBreadcrumbs.length ? mergedBreadcrumbs : undefined;\n}\n\nfunction applySdkMetadataToEvent(event, sdkProcessingMetadata) {\n  event.sdkProcessingMetadata = {\n    ...event.sdkProcessingMetadata,\n    ...sdkProcessingMetadata,\n  };\n}\n\nfunction applySpanToEvent(event, span) {\n  event.contexts = {\n    trace: spanToTraceContext(span),\n    ...event.contexts,\n  };\n\n  event.sdkProcessingMetadata = {\n    dynamicSamplingContext: getDynamicSamplingContextFromSpan(span),\n    ...event.sdkProcessingMetadata,\n  };\n\n  const rootSpan = getRootSpan(span);\n  const transactionName = spanToJSON(rootSpan).description;\n  if (transactionName && !event.transaction && event.type === 'transaction') {\n    event.transaction = transactionName;\n  }\n}\n\n/**\n * Applies fingerprint from the scope to the event if there's one,\n * uses message if there's one instead or get rid of empty fingerprint\n */\nfunction applyFingerprintToEvent(event, fingerprint) {\n  // Make sure it's an array first and we actually have something in place\n  event.fingerprint = event.fingerprint\n    ? Array.isArray(event.fingerprint)\n      ? event.fingerprint\n      : [event.fingerprint]\n    : [];\n\n  // If we have something on the scope, then merge it with event\n  if (fingerprint) {\n    event.fingerprint = event.fingerprint.concat(fingerprint);\n  }\n\n  // If we have no data at all, remove empty array default\n  if (!event.fingerprint.length) {\n    delete event.fingerprint;\n  }\n}\n\nexport { applyScopeDataToEvent, mergeAndOverwriteScopeData, mergeScopeData };\n//# sourceMappingURL=applyScopeDataToEvent.js.map\n","import { DEFAULT_ENVIRONMENT } from '../constants.js';\nimport { getGlobalScope } from '../currentScopes.js';\nimport { notifyEventProcessors } from '../eventProcessors.js';\nimport { Scope } from '../scope.js';\nimport { getFilenameToDebugIdMap } from '../utils-hoist/debug-ids.js';\nimport { uuid4, addExceptionMechanism } from '../utils-hoist/misc.js';\nimport { normalize } from '../utils-hoist/normalize.js';\nimport { truncate } from '../utils-hoist/string.js';\nimport { dateTimestampInSeconds } from '../utils-hoist/time.js';\nimport { mergeScopeData, applyScopeDataToEvent } from './applyScopeDataToEvent.js';\n\n/**\n * This type makes sure that we get either a CaptureContext, OR an EventHint.\n * It does not allow mixing them, which could lead to unexpected outcomes, e.g. this is disallowed:\n * { user: { id: '123' }, mechanism: { handled: false } }\n */\n\n/**\n * Adds common information to events.\n *\n * The information includes release and environment from `options`,\n * breadcrumbs and context (extra, tags and user) from the scope.\n *\n * Information that is already present in the event is never overwritten. For\n * nested objects, such as the context, keys are merged.\n *\n * @param event The original event.\n * @param hint May contain additional information about the original exception.\n * @param scope A scope containing event metadata.\n * @returns A new event with more information.\n * @hidden\n */\nfunction prepareEvent(\n  options,\n  event,\n  hint,\n  scope,\n  client,\n  isolationScope,\n) {\n  const { normalizeDepth = 3, normalizeMaxBreadth = 1000 } = options;\n  const prepared = {\n    ...event,\n    event_id: event.event_id || hint.event_id || uuid4(),\n    timestamp: event.timestamp || dateTimestampInSeconds(),\n  };\n  const integrations = hint.integrations || options.integrations.map(i => i.name);\n\n  applyClientOptions(prepared, options);\n  applyIntegrationsMetadata(prepared, integrations);\n\n  if (client) {\n    client.emit('applyFrameMetadata', event);\n  }\n\n  // Only put debug IDs onto frames for error events.\n  if (event.type === undefined) {\n    applyDebugIds(prepared, options.stackParser);\n  }\n\n  // If we have scope given to us, use it as the base for further modifications.\n  // This allows us to prevent unnecessary copying of data if `captureContext` is not provided.\n  const finalScope = getFinalScope(scope, hint.captureContext);\n\n  if (hint.mechanism) {\n    addExceptionMechanism(prepared, hint.mechanism);\n  }\n\n  const clientEventProcessors = client ? client.getEventProcessors() : [];\n\n  // This should be the last thing called, since we want that\n  // {@link Scope.addEventProcessor} gets the finished prepared event.\n  // Merge scope data together\n  const data = getGlobalScope().getScopeData();\n\n  if (isolationScope) {\n    const isolationData = isolationScope.getScopeData();\n    mergeScopeData(data, isolationData);\n  }\n\n  if (finalScope) {\n    const finalScopeData = finalScope.getScopeData();\n    mergeScopeData(data, finalScopeData);\n  }\n\n  const attachments = [...(hint.attachments || []), ...data.attachments];\n  if (attachments.length) {\n    hint.attachments = attachments;\n  }\n\n  applyScopeDataToEvent(prepared, data);\n\n  const eventProcessors = [\n    ...clientEventProcessors,\n    // Run scope event processors _after_ all other processors\n    ...data.eventProcessors,\n  ];\n\n  const result = notifyEventProcessors(eventProcessors, prepared, hint);\n\n  return result.then(evt => {\n    if (evt) {\n      // We apply the debug_meta field only after all event processors have ran, so that if any event processors modified\n      // file names (e.g.the RewriteFrames integration) the filename -> debug ID relationship isn't destroyed.\n      // This should not cause any PII issues, since we're only moving data that is already on the event and not adding\n      // any new data\n      applyDebugMeta(evt);\n    }\n\n    if (typeof normalizeDepth === 'number' && normalizeDepth > 0) {\n      return normalizeEvent(evt, normalizeDepth, normalizeMaxBreadth);\n    }\n    return evt;\n  });\n}\n\n/**\n * Enhances event using the client configuration.\n * It takes care of all \"static\" values like environment, release and `dist`,\n * as well as truncating overly long values.\n *\n * Only exported for tests.\n *\n * @param event event instance to be enhanced\n */\nfunction applyClientOptions(event, options) {\n  const { environment, release, dist, maxValueLength = 250 } = options;\n\n  // empty strings do not make sense for environment, release, and dist\n  // so we handle them the same as if they were not provided\n  event.environment = event.environment || environment || DEFAULT_ENVIRONMENT;\n\n  if (!event.release && release) {\n    event.release = release;\n  }\n\n  if (!event.dist && dist) {\n    event.dist = dist;\n  }\n\n  const request = event.request;\n  if (request?.url) {\n    request.url = truncate(request.url, maxValueLength);\n  }\n}\n\n/**\n * Puts debug IDs into the stack frames of an error event.\n */\nfunction applyDebugIds(event, stackParser) {\n  // Build a map of filename -> debug_id\n  const filenameDebugIdMap = getFilenameToDebugIdMap(stackParser);\n\n  event.exception?.values?.forEach(exception => {\n    exception.stacktrace?.frames?.forEach(frame => {\n      if (frame.filename) {\n        frame.debug_id = filenameDebugIdMap[frame.filename];\n      }\n    });\n  });\n}\n\n/**\n * Moves debug IDs from the stack frames of an error event into the debug_meta field.\n */\nfunction applyDebugMeta(event) {\n  // Extract debug IDs and filenames from the stack frames on the event.\n  const filenameDebugIdMap = {};\n  event.exception?.values?.forEach(exception => {\n    exception.stacktrace?.frames?.forEach(frame => {\n      if (frame.debug_id) {\n        if (frame.abs_path) {\n          filenameDebugIdMap[frame.abs_path] = frame.debug_id;\n        } else if (frame.filename) {\n          filenameDebugIdMap[frame.filename] = frame.debug_id;\n        }\n        delete frame.debug_id;\n      }\n    });\n  });\n\n  if (Object.keys(filenameDebugIdMap).length === 0) {\n    return;\n  }\n\n  // Fill debug_meta information\n  event.debug_meta = event.debug_meta || {};\n  event.debug_meta.images = event.debug_meta.images || [];\n  const images = event.debug_meta.images;\n  Object.entries(filenameDebugIdMap).forEach(([filename, debug_id]) => {\n    images.push({\n      type: 'sourcemap',\n      code_file: filename,\n      debug_id,\n    });\n  });\n}\n\n/**\n * This function adds all used integrations to the SDK info in the event.\n * @param event The event that will be filled with all integrations.\n */\nfunction applyIntegrationsMetadata(event, integrationNames) {\n  if (integrationNames.length > 0) {\n    event.sdk = event.sdk || {};\n    event.sdk.integrations = [...(event.sdk.integrations || []), ...integrationNames];\n  }\n}\n\n/**\n * Applies `normalize` function on necessary `Event` attributes to make them safe for serialization.\n * Normalized keys:\n * - `breadcrumbs.data`\n * - `user`\n * - `contexts`\n * - `extra`\n * @param event Event\n * @returns Normalized event\n */\nfunction normalizeEvent(event, depth, maxBreadth) {\n  if (!event) {\n    return null;\n  }\n\n  const normalized = {\n    ...event,\n    ...(event.breadcrumbs && {\n      breadcrumbs: event.breadcrumbs.map(b => ({\n        ...b,\n        ...(b.data && {\n          data: normalize(b.data, depth, maxBreadth),\n        }),\n      })),\n    }),\n    ...(event.user && {\n      user: normalize(event.user, depth, maxBreadth),\n    }),\n    ...(event.contexts && {\n      contexts: normalize(event.contexts, depth, maxBreadth),\n    }),\n    ...(event.extra && {\n      extra: normalize(event.extra, depth, maxBreadth),\n    }),\n  };\n\n  // event.contexts.trace stores information about a Transaction. Similarly,\n  // event.spans[] stores information about child Spans. Given that a\n  // Transaction is conceptually a Span, normalization should apply to both\n  // Transactions and Spans consistently.\n  // For now the decision is to skip normalization of Transactions and Spans,\n  // so this block overwrites the normalized event to add back the original\n  // Transaction information prior to normalization.\n  if (event.contexts?.trace && normalized.contexts) {\n    normalized.contexts.trace = event.contexts.trace;\n\n    // event.contexts.trace.data may contain circular/dangerous data so we need to normalize it\n    if (event.contexts.trace.data) {\n      normalized.contexts.trace.data = normalize(event.contexts.trace.data, depth, maxBreadth);\n    }\n  }\n\n  // event.spans[].data may contain circular/dangerous data so we need to normalize it\n  if (event.spans) {\n    normalized.spans = event.spans.map(span => {\n      return {\n        ...span,\n        ...(span.data && {\n          data: normalize(span.data, depth, maxBreadth),\n        }),\n      };\n    });\n  }\n\n  // event.contexts.flags (FeatureFlagContext) stores context for our feature\n  // flag integrations. It has a greater nesting depth than our other typed\n  // Contexts, so we re-normalize with a fixed depth of 3 here. We do not want\n  // to skip this in case of conflicting, user-provided context.\n  if (event.contexts?.flags && normalized.contexts) {\n    normalized.contexts.flags = normalize(event.contexts.flags, 3, maxBreadth);\n  }\n\n  return normalized;\n}\n\nfunction getFinalScope(scope, captureContext) {\n  if (!captureContext) {\n    return scope;\n  }\n\n  const finalScope = scope ? scope.clone() : new Scope();\n  finalScope.update(captureContext);\n  return finalScope;\n}\n\n/**\n * Parse either an `EventHint` directly, or convert a `CaptureContext` to an `EventHint`.\n * This is used to allow to update method signatures that used to accept a `CaptureContext` but should now accept an `EventHint`.\n */\nfunction parseEventHintOrCaptureContext(\n  hint,\n) {\n  if (!hint) {\n    return undefined;\n  }\n\n  // If you pass a Scope or `() => Scope` as CaptureContext, we just return this as captureContext\n  if (hintIsScopeOrFunction(hint)) {\n    return { captureContext: hint };\n  }\n\n  if (hintIsScopeContext(hint)) {\n    return {\n      captureContext: hint,\n    };\n  }\n\n  return hint;\n}\n\nfunction hintIsScopeOrFunction(hint) {\n  return hint instanceof Scope || typeof hint === 'function';\n}\n\nconst captureContextKeys = [\n  'user',\n  'level',\n  'extra',\n  'contexts',\n  'tags',\n  'fingerprint',\n  'propagationContext',\n] ;\n\nfunction hintIsScopeContext(hint) {\n  return Object.keys(hint).some(key => captureContextKeys.includes(key ));\n}\n\nexport { applyClientOptions, applyDebugIds, applyDebugMeta, parseEventHintOrCaptureContext, prepareEvent };\n//# sourceMappingURL=prepareEvent.js.map\n","import { getCurrentScope, getClient, withIsolationScope, getIsolationScope } from './currentScopes.js';\nimport { DEBUG_BUILD } from './debug-build.js';\nimport { makeSession, updateSession, closeSession } from './session.js';\nimport { isThenable } from './utils-hoist/is.js';\nimport { logger } from './utils-hoist/logger.js';\nimport { uuid4 } from './utils-hoist/misc.js';\nimport { timestampInSeconds } from './utils-hoist/time.js';\nimport { GLOBAL_OBJ } from './utils-hoist/worldwide.js';\nimport { parseEventHintOrCaptureContext } from './utils/prepareEvent.js';\n\n/**\n * Captures an exception event and sends it to Sentry.\n *\n * @param exception The exception to capture.\n * @param hint Optional additional data to attach to the Sentry event.\n * @returns the id of the captured Sentry event.\n */\nfunction captureException(exception, hint) {\n  return getCurrentScope().captureException(exception, parseEventHintOrCaptureContext(hint));\n}\n\n/**\n * Captures a message event and sends it to Sentry.\n *\n * @param message The message to send to Sentry.\n * @param captureContext Define the level of the message or pass in additional data to attach to the message.\n * @returns the id of the captured message.\n */\nfunction captureMessage(message, captureContext) {\n  // This is necessary to provide explicit scopes upgrade, without changing the original\n  // arity of the `captureMessage(message, level)` method.\n  const level = typeof captureContext === 'string' ? captureContext : undefined;\n  const context = typeof captureContext !== 'string' ? { captureContext } : undefined;\n  return getCurrentScope().captureMessage(message, level, context);\n}\n\n/**\n * Captures a manually created event and sends it to Sentry.\n *\n * @param event The event to send to Sentry.\n * @param hint Optional additional data to attach to the Sentry event.\n * @returns the id of the captured event.\n */\nfunction captureEvent(event, hint) {\n  return getCurrentScope().captureEvent(event, hint);\n}\n\n/**\n * Sets context data with the given name.\n * @param name of the context\n * @param context Any kind of data. This data will be normalized.\n */\nfunction setContext(name, context) {\n  getIsolationScope().setContext(name, context);\n}\n\n/**\n * Set an object that will be merged sent as extra data with the event.\n * @param extras Extras object to merge into current context.\n */\nfunction setExtras(extras) {\n  getIsolationScope().setExtras(extras);\n}\n\n/**\n * Set key:value that will be sent as extra data with the event.\n * @param key String of extra\n * @param extra Any kind of data. This data will be normalized.\n */\nfunction setExtra(key, extra) {\n  getIsolationScope().setExtra(key, extra);\n}\n\n/**\n * Set an object that will be merged sent as tags data with the event.\n * @param tags Tags context object to merge into current context.\n */\nfunction setTags(tags) {\n  getIsolationScope().setTags(tags);\n}\n\n/**\n * Set key:value that will be sent as tags data with the event.\n *\n * Can also be used to unset a tag, by passing `undefined`.\n *\n * @param key String key of tag\n * @param value Value of tag\n */\nfunction setTag(key, value) {\n  getIsolationScope().setTag(key, value);\n}\n\n/**\n * Updates user context information for future events.\n *\n * @param user User context object to be set in the current context. Pass `null` to unset the user.\n */\nfunction setUser(user) {\n  getIsolationScope().setUser(user);\n}\n\n/**\n * The last error event id of the isolation scope.\n *\n * Warning: This function really returns the last recorded error event id on the current\n * isolation scope. If you call this function after handling a certain error and another error\n * is captured in between, the last one is returned instead of the one you might expect.\n * Also, ids of events that were never sent to Sentry (for example because\n * they were dropped in `beforeSend`) could be returned.\n *\n * @returns The last event id of the isolation scope.\n */\nfunction lastEventId() {\n  return getIsolationScope().lastEventId();\n}\n\n/**\n * Create a cron monitor check in and send it to Sentry.\n *\n * @param checkIn An object that describes a check in.\n * @param upsertMonitorConfig An optional object that describes a monitor config. Use this if you want\n * to create a monitor automatically when sending a check in.\n */\nfunction captureCheckIn(checkIn, upsertMonitorConfig) {\n  const scope = getCurrentScope();\n  const client = getClient();\n  if (!client) {\n    DEBUG_BUILD && logger.warn('Cannot capture check-in. No client defined.');\n  } else if (!client.captureCheckIn) {\n    DEBUG_BUILD && logger.warn('Cannot capture check-in. Client does not support sending check-ins.');\n  } else {\n    return client.captureCheckIn(checkIn, upsertMonitorConfig, scope);\n  }\n\n  return uuid4();\n}\n\n/**\n * Wraps a callback with a cron monitor check in. The check in will be sent to Sentry when the callback finishes.\n *\n * @param monitorSlug The distinct slug of the monitor.\n * @param upsertMonitorConfig An optional object that describes a monitor config. Use this if you want\n * to create a monitor automatically when sending a check in.\n */\nfunction withMonitor(\n  monitorSlug,\n  callback,\n  upsertMonitorConfig,\n) {\n  const checkInId = captureCheckIn({ monitorSlug, status: 'in_progress' }, upsertMonitorConfig);\n  const now = timestampInSeconds();\n\n  function finishCheckIn(status) {\n    captureCheckIn({ monitorSlug, status, checkInId, duration: timestampInSeconds() - now });\n  }\n\n  return withIsolationScope(() => {\n    let maybePromiseResult;\n    try {\n      maybePromiseResult = callback();\n    } catch (e) {\n      finishCheckIn('error');\n      throw e;\n    }\n\n    if (isThenable(maybePromiseResult)) {\n      Promise.resolve(maybePromiseResult).then(\n        () => {\n          finishCheckIn('ok');\n        },\n        e => {\n          finishCheckIn('error');\n          throw e;\n        },\n      );\n    } else {\n      finishCheckIn('ok');\n    }\n\n    return maybePromiseResult;\n  });\n}\n\n/**\n * Call `flush()` on the current client, if there is one. See {@link Client.flush}.\n *\n * @param timeout Maximum time in ms the client should wait to flush its event queue. Omitting this parameter will cause\n * the client to wait until all events are sent before resolving the promise.\n * @returns A promise which resolves to `true` if the queue successfully drains before the timeout, or `false` if it\n * doesn't (or if there's no client defined).\n */\nasync function flush(timeout) {\n  const client = getClient();\n  if (client) {\n    return client.flush(timeout);\n  }\n  DEBUG_BUILD && logger.warn('Cannot flush events. No client defined.');\n  return Promise.resolve(false);\n}\n\n/**\n * Call `close()` on the current client, if there is one. See {@link Client.close}.\n *\n * @param timeout Maximum time in ms the client should wait to flush its event queue before shutting down. Omitting this\n * parameter will cause the client to wait until all events are sent before disabling itself.\n * @returns A promise which resolves to `true` if the queue successfully drains before the timeout, or `false` if it\n * doesn't (or if there's no client defined).\n */\nasync function close(timeout) {\n  const client = getClient();\n  if (client) {\n    return client.close(timeout);\n  }\n  DEBUG_BUILD && logger.warn('Cannot flush events and disable SDK. No client defined.');\n  return Promise.resolve(false);\n}\n\n/**\n * Returns true if Sentry has been properly initialized.\n */\nfunction isInitialized() {\n  return !!getClient();\n}\n\n/** If the SDK is initialized & enabled. */\nfunction isEnabled() {\n  const client = getClient();\n  return client?.getOptions().enabled !== false && !!client?.getTransport();\n}\n\n/**\n * Add an event processor.\n * This will be added to the current isolation scope, ensuring any event that is processed in the current execution\n * context will have the processor applied.\n */\nfunction addEventProcessor(callback) {\n  getIsolationScope().addEventProcessor(callback);\n}\n\n/**\n * Start a session on the current isolation scope.\n *\n * @param context (optional) additional properties to be applied to the returned session object\n *\n * @returns the new active session\n */\nfunction startSession(context) {\n  const isolationScope = getIsolationScope();\n  const currentScope = getCurrentScope();\n\n  // Will fetch userAgent if called from browser sdk\n  const { userAgent } = GLOBAL_OBJ.navigator || {};\n\n  const session = makeSession({\n    user: currentScope.getUser() || isolationScope.getUser(),\n    ...(userAgent && { userAgent }),\n    ...context,\n  });\n\n  // End existing session if there's one\n  const currentSession = isolationScope.getSession();\n  if (currentSession?.status === 'ok') {\n    updateSession(currentSession, { status: 'exited' });\n  }\n\n  endSession();\n\n  // Afterwards we set the new session on the scope\n  isolationScope.setSession(session);\n\n  return session;\n}\n\n/**\n * End the session on the current isolation scope.\n */\nfunction endSession() {\n  const isolationScope = getIsolationScope();\n  const currentScope = getCurrentScope();\n\n  const session = currentScope.getSession() || isolationScope.getSession();\n  if (session) {\n    closeSession(session);\n  }\n  _sendSessionUpdate();\n\n  // the session is over; take it off of the scope\n  isolationScope.setSession();\n}\n\n/**\n * Sends the current Session on the scope\n */\nfunction _sendSessionUpdate() {\n  const isolationScope = getIsolationScope();\n  const client = getClient();\n  const session = isolationScope.getSession();\n  if (session && client) {\n    client.captureSession(session);\n  }\n}\n\n/**\n * Sends the current session on the scope to Sentry\n *\n * @param end If set the session will be marked as exited and removed from the scope.\n *            Defaults to `false`.\n */\nfunction captureSession(end = false) {\n  // both send the update and pull the session from the scope\n  if (end) {\n    endSession();\n    return;\n  }\n\n  // only send the update\n  _sendSessionUpdate();\n}\n\nexport { addEventProcessor, captureCheckIn, captureEvent, captureException, captureMessage, captureSession, close, endSession, flush, isEnabled, isInitialized, lastEventId, setContext, setExtra, setExtras, setTag, setTags, setUser, startSession, withMonitor };\n//# sourceMappingURL=exports.js.map\n","import { makeDsn, dsnToString } from './utils-hoist/dsn.js';\n\nconst SENTRY_API_VERSION = '7';\n\n/** Returns the prefix to construct Sentry ingestion API endpoints. */\nfunction getBaseApiEndpoint(dsn) {\n  const protocol = dsn.protocol ? `${dsn.protocol}:` : '';\n  const port = dsn.port ? `:${dsn.port}` : '';\n  return `${protocol}//${dsn.host}${port}${dsn.path ? `/${dsn.path}` : ''}/api/`;\n}\n\n/** Returns the ingest API endpoint for target. */\nfunction _getIngestEndpoint(dsn) {\n  return `${getBaseApiEndpoint(dsn)}${dsn.projectId}/envelope/`;\n}\n\n/** Returns a URL-encoded string with auth config suitable for a query string. */\nfunction _encodedAuth(dsn, sdkInfo) {\n  const params = {\n    sentry_version: SENTRY_API_VERSION,\n  };\n\n  if (dsn.publicKey) {\n    // We send only the minimum set of required information. See\n    // https://github.com/getsentry/sentry-javascript/issues/2572.\n    params.sentry_key = dsn.publicKey;\n  }\n\n  if (sdkInfo) {\n    params.sentry_client = `${sdkInfo.name}/${sdkInfo.version}`;\n  }\n\n  return new URLSearchParams(params).toString();\n}\n\n/**\n * Returns the envelope endpoint URL with auth in the query string.\n *\n * Sending auth as part of the query string and not as custom HTTP headers avoids CORS preflight requests.\n */\nfunction getEnvelopeEndpointWithUrlEncodedAuth(dsn, tunnel, sdkInfo) {\n  return tunnel ? tunnel : `${_getIngestEndpoint(dsn)}?${_encodedAuth(dsn, sdkInfo)}`;\n}\n\n/** Returns the url to the report dialog endpoint. */\nfunction getReportDialogEndpoint(dsnLike, dialogOptions) {\n  const dsn = makeDsn(dsnLike);\n  if (!dsn) {\n    return '';\n  }\n\n  const endpoint = `${getBaseApiEndpoint(dsn)}embed/error-page/`;\n\n  let encodedOptions = `dsn=${dsnToString(dsn)}`;\n  for (const key in dialogOptions) {\n    if (key === 'dsn') {\n      continue;\n    }\n\n    if (key === 'onClose') {\n      continue;\n    }\n\n    if (key === 'user') {\n      const user = dialogOptions.user;\n      if (!user) {\n        continue;\n      }\n      if (user.name) {\n        encodedOptions += `&name=${encodeURIComponent(user.name)}`;\n      }\n      if (user.email) {\n        encodedOptions += `&email=${encodeURIComponent(user.email)}`;\n      }\n    } else {\n      encodedOptions += `&${encodeURIComponent(key)}=${encodeURIComponent(dialogOptions[key] )}`;\n    }\n  }\n\n  return `${endpoint}?${encodedOptions}`;\n}\n\nexport { getEnvelopeEndpointWithUrlEncodedAuth, getReportDialogEndpoint };\n//# sourceMappingURL=api.js.map\n","import { getClient } from './currentScopes.js';\nimport { DEBUG_BUILD } from './debug-build.js';\nimport { logger } from './utils-hoist/logger.js';\n\nconst installedIntegrations = [];\n\n/** Map of integrations assigned to a client */\n\n/**\n * Remove duplicates from the given array, preferring the last instance of any duplicate. Not guaranteed to\n * preserve the order of integrations in the array.\n *\n * @private\n */\nfunction filterDuplicates(integrations) {\n  const integrationsByName = {};\n\n  integrations.forEach((currentInstance) => {\n    const { name } = currentInstance;\n\n    const existingInstance = integrationsByName[name];\n\n    // We want integrations later in the array to overwrite earlier ones of the same type, except that we never want a\n    // default instance to overwrite an existing user instance\n    if (existingInstance && !existingInstance.isDefaultInstance && currentInstance.isDefaultInstance) {\n      return;\n    }\n\n    integrationsByName[name] = currentInstance;\n  });\n\n  return Object.values(integrationsByName);\n}\n\n/** Gets integrations to install */\nfunction getIntegrationsToSetup(options) {\n  const defaultIntegrations = options.defaultIntegrations || [];\n  const userIntegrations = options.integrations;\n\n  // We flag default instances, so that later we can tell them apart from any user-created instances of the same class\n  defaultIntegrations.forEach((integration) => {\n    integration.isDefaultInstance = true;\n  });\n\n  let integrations;\n\n  if (Array.isArray(userIntegrations)) {\n    integrations = [...defaultIntegrations, ...userIntegrations];\n  } else if (typeof userIntegrations === 'function') {\n    const resolvedUserIntegrations = userIntegrations(defaultIntegrations);\n    integrations = Array.isArray(resolvedUserIntegrations) ? resolvedUserIntegrations : [resolvedUserIntegrations];\n  } else {\n    integrations = defaultIntegrations;\n  }\n\n  return filterDuplicates(integrations);\n}\n\n/**\n * Given a list of integration instances this installs them all. When `withDefaults` is set to `true` then all default\n * integrations are added unless they were already provided before.\n * @param integrations array of integration instances\n * @param withDefault should enable default integrations\n */\nfunction setupIntegrations(client, integrations) {\n  const integrationIndex = {};\n\n  integrations.forEach((integration) => {\n    // guard against empty provided integrations\n    if (integration) {\n      setupIntegration(client, integration, integrationIndex);\n    }\n  });\n\n  return integrationIndex;\n}\n\n/**\n * Execute the `afterAllSetup` hooks of the given integrations.\n */\nfunction afterSetupIntegrations(client, integrations) {\n  for (const integration of integrations) {\n    // guard against empty provided integrations\n    if (integration?.afterAllSetup) {\n      integration.afterAllSetup(client);\n    }\n  }\n}\n\n/** Setup a single integration.  */\nfunction setupIntegration(client, integration, integrationIndex) {\n  if (integrationIndex[integration.name]) {\n    DEBUG_BUILD && logger.log(`Integration skipped because it was already installed: ${integration.name}`);\n    return;\n  }\n  integrationIndex[integration.name] = integration;\n\n  // `setupOnce` is only called the first time\n  if (installedIntegrations.indexOf(integration.name) === -1 && typeof integration.setupOnce === 'function') {\n    integration.setupOnce();\n    installedIntegrations.push(integration.name);\n  }\n\n  // `setup` is run for each client\n  if (integration.setup && typeof integration.setup === 'function') {\n    integration.setup(client);\n  }\n\n  if (typeof integration.preprocessEvent === 'function') {\n    const callback = integration.preprocessEvent.bind(integration) ;\n    client.on('preprocessEvent', (event, hint) => callback(event, hint, client));\n  }\n\n  if (typeof integration.processEvent === 'function') {\n    const callback = integration.processEvent.bind(integration) ;\n\n    const processor = Object.assign((event, hint) => callback(event, hint, client), {\n      id: integration.name,\n    });\n\n    client.addEventProcessor(processor);\n  }\n\n  DEBUG_BUILD && logger.log(`Integration installed: ${integration.name}`);\n}\n\n/** Add an integration to the current scope's client. */\nfunction addIntegration(integration) {\n  const client = getClient();\n\n  if (!client) {\n    DEBUG_BUILD && logger.warn(`Cannot add integration \"${integration.name}\" because no SDK Client is available.`);\n    return;\n  }\n\n  client.addIntegration(integration);\n}\n\n/**\n * Define an integration function that can be used to create an integration instance.\n * Note that this by design hides the implementation details of the integration, as they are considered internal.\n */\nfunction defineIntegration(fn) {\n  return fn;\n}\n\nexport { addIntegration, afterSetupIntegrations, defineIntegration, getIntegrationsToSetup, installedIntegrations, setupIntegration, setupIntegrations };\n//# sourceMappingURL=integration.js.map\n","/**\n * Get a list of possible event messages from a Sentry event.\n */\nfunction getPossibleEventMessages(event) {\n  const possibleMessages = [];\n\n  if (event.message) {\n    possibleMessages.push(event.message);\n  }\n\n  try {\n    // @ts-expect-error Try catching to save bundle size\n    const lastException = event.exception.values[event.exception.values.length - 1];\n    if (lastException?.value) {\n      possibleMessages.push(lastException.value);\n      if (lastException.type) {\n        possibleMessages.push(`${lastException.type}: ${lastException.value}`);\n      }\n    }\n  } catch (e) {\n    // ignore errors here\n  }\n\n  return possibleMessages;\n}\n\nexport { getPossibleEventMessages };\n//# sourceMappingURL=eventUtils.js.map\n","import { getEnvelopeEndpointWithUrlEncodedAuth } from './api.js';\nimport { DEFAULT_ENVIRONMENT } from './constants.js';\nimport { getTraceContextFromScope, getCurrentScope, getIsolationScope } from './currentScopes.js';\nimport { DEBUG_BUILD } from './debug-build.js';\nimport { createEventEnvelope, createSessionEnvelope } from './envelope.js';\nimport { setupIntegration, afterSetupIntegrations, setupIntegrations } from './integration.js';\nimport { updateSession } from './session.js';\nimport { getDynamicSamplingContextFromScope, getDynamicSamplingContextFromSpan } from './tracing/dynamicSamplingContext.js';\nimport { createClientReportEnvelope } from './utils-hoist/clientreport.js';\nimport { makeDsn, dsnToString } from './utils-hoist/dsn.js';\nimport { addItemToEnvelope, createAttachmentEnvelopeItem } from './utils-hoist/envelope.js';\nimport { isPrimitive, isParameterizedString, isThenable, isPlainObject } from './utils-hoist/is.js';\nimport { logger } from './utils-hoist/logger.js';\nimport { uuid4, checkOrSetAlreadyCaught } from './utils-hoist/misc.js';\nimport { resolvedSyncPromise, SyncPromise, rejectedSyncPromise } from './utils-hoist/syncpromise.js';\nimport { getPossibleEventMessages } from './utils/eventUtils.js';\nimport { merge } from './utils/merge.js';\nimport { parseSampleRate } from './utils/parseSampleRate.js';\nimport { prepareEvent } from './utils/prepareEvent.js';\nimport { showSpanDropWarning, spanToTraceContext } from './utils/spanUtils.js';\nimport { convertTransactionEventToSpanJson, convertSpanJsonToTransactionEvent } from './utils/transactionEvent.js';\nimport { _getSpanForScope } from './utils/spanOnScope.js';\n\nconst ALREADY_SEEN_ERROR = \"Not capturing exception because it's already been captured.\";\nconst MISSING_RELEASE_FOR_SESSION_ERROR = 'Discarded session because of missing or non-string release';\n\nconst INTERNAL_ERROR_SYMBOL = Symbol.for('SentryInternalError');\nconst DO_NOT_SEND_EVENT_SYMBOL = Symbol.for('SentryDoNotSendEventError');\n\nfunction _makeInternalError(message) {\n  return {\n    message,\n    [INTERNAL_ERROR_SYMBOL]: true,\n  };\n}\n\nfunction _makeDoNotSendEventError(message) {\n  return {\n    message,\n    [DO_NOT_SEND_EVENT_SYMBOL]: true,\n  };\n}\n\nfunction _isInternalError(error) {\n  return !!error && typeof error === 'object' && INTERNAL_ERROR_SYMBOL in error;\n}\n\nfunction _isDoNotSendEventError(error) {\n  return !!error && typeof error === 'object' && DO_NOT_SEND_EVENT_SYMBOL in error;\n}\n\n/**\n * Base implementation for all JavaScript SDK clients.\n *\n * Call the constructor with the corresponding options\n * specific to the client subclass. To access these options later, use\n * {@link Client.getOptions}.\n *\n * If a Dsn is specified in the options, it will be parsed and stored. Use\n * {@link Client.getDsn} to retrieve the Dsn at any moment. In case the Dsn is\n * invalid, the constructor will throw a {@link SentryException}. Note that\n * without a valid Dsn, the SDK will not send any events to Sentry.\n *\n * Before sending an event, it is passed through\n * {@link Client._prepareEvent} to add SDK information and scope data\n * (breadcrumbs and context). To add more custom information, override this\n * method and extend the resulting prepared event.\n *\n * To issue automatically created events (e.g. via instrumentation), use\n * {@link Client.captureEvent}. It will prepare the event and pass it through\n * the callback lifecycle. To issue auto-breadcrumbs, use\n * {@link Client.addBreadcrumb}.\n *\n * @example\n * class NodeClient extends Client<NodeOptions> {\n *   public constructor(options: NodeOptions) {\n *     super(options);\n *   }\n *\n *   // ...\n * }\n */\nclass Client {\n  /** Options passed to the SDK. */\n\n  /** The client Dsn, if specified in options. Without this Dsn, the SDK will be disabled. */\n\n  /** Array of set up integrations. */\n\n  /** Number of calls being processed */\n\n  /** Holds flushable  */\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n\n  /**\n   * Initializes this client instance.\n   *\n   * @param options Options for the client.\n   */\n   constructor(options) {\n    this._options = options;\n    this._integrations = {};\n    this._numProcessing = 0;\n    this._outcomes = {};\n    this._hooks = {};\n    this._eventProcessors = [];\n\n    if (options.dsn) {\n      this._dsn = makeDsn(options.dsn);\n    } else {\n      DEBUG_BUILD && logger.warn('No DSN provided, client will not send events.');\n    }\n\n    if (this._dsn) {\n      const url = getEnvelopeEndpointWithUrlEncodedAuth(\n        this._dsn,\n        options.tunnel,\n        options._metadata ? options._metadata.sdk : undefined,\n      );\n      this._transport = options.transport({\n        tunnel: this._options.tunnel,\n        recordDroppedEvent: this.recordDroppedEvent.bind(this),\n        ...options.transportOptions,\n        url,\n      });\n    }\n  }\n\n  /**\n   * Captures an exception event and sends it to Sentry.\n   *\n   * Unlike `captureException` exported from every SDK, this method requires that you pass it the current scope.\n   */\n   captureException(exception, hint, scope) {\n    const eventId = uuid4();\n\n    // ensure we haven't captured this very object before\n    if (checkOrSetAlreadyCaught(exception)) {\n      DEBUG_BUILD && logger.log(ALREADY_SEEN_ERROR);\n      return eventId;\n    }\n\n    const hintWithEventId = {\n      event_id: eventId,\n      ...hint,\n    };\n\n    this._process(\n      this.eventFromException(exception, hintWithEventId).then(event =>\n        this._captureEvent(event, hintWithEventId, scope),\n      ),\n    );\n\n    return hintWithEventId.event_id;\n  }\n\n  /**\n   * Captures a message event and sends it to Sentry.\n   *\n   * Unlike `captureMessage` exported from every SDK, this method requires that you pass it the current scope.\n   */\n   captureMessage(\n    message,\n    level,\n    hint,\n    currentScope,\n  ) {\n    const hintWithEventId = {\n      event_id: uuid4(),\n      ...hint,\n    };\n\n    const eventMessage = isParameterizedString(message) ? message : String(message);\n\n    const promisedEvent = isPrimitive(message)\n      ? this.eventFromMessage(eventMessage, level, hintWithEventId)\n      : this.eventFromException(message, hintWithEventId);\n\n    this._process(promisedEvent.then(event => this._captureEvent(event, hintWithEventId, currentScope)));\n\n    return hintWithEventId.event_id;\n  }\n\n  /**\n   * Captures a manually created event and sends it to Sentry.\n   *\n   * Unlike `captureEvent` exported from every SDK, this method requires that you pass it the current scope.\n   */\n   captureEvent(event, hint, currentScope) {\n    const eventId = uuid4();\n\n    // ensure we haven't captured this very object before\n    if (hint?.originalException && checkOrSetAlreadyCaught(hint.originalException)) {\n      DEBUG_BUILD && logger.log(ALREADY_SEEN_ERROR);\n      return eventId;\n    }\n\n    const hintWithEventId = {\n      event_id: eventId,\n      ...hint,\n    };\n\n    const sdkProcessingMetadata = event.sdkProcessingMetadata || {};\n    const capturedSpanScope = sdkProcessingMetadata.capturedSpanScope;\n    const capturedSpanIsolationScope = sdkProcessingMetadata.capturedSpanIsolationScope;\n\n    this._process(\n      this._captureEvent(event, hintWithEventId, capturedSpanScope || currentScope, capturedSpanIsolationScope),\n    );\n\n    return hintWithEventId.event_id;\n  }\n\n  /**\n   * Captures a session.\n   */\n   captureSession(session) {\n    this.sendSession(session);\n    // After sending, we set init false to indicate it's not the first occurrence\n    updateSession(session, { init: false });\n  }\n\n  /**\n   * Create a cron monitor check in and send it to Sentry. This method is not available on all clients.\n   *\n   * @param checkIn An object that describes a check in.\n   * @param upsertMonitorConfig An optional object that describes a monitor config. Use this if you want\n   * to create a monitor automatically when sending a check in.\n   * @param scope An optional scope containing event metadata.\n   * @returns A string representing the id of the check in.\n   */\n\n  /**\n   * Get the current Dsn.\n   */\n   getDsn() {\n    return this._dsn;\n  }\n\n  /**\n   * Get the current options.\n   */\n   getOptions() {\n    return this._options;\n  }\n\n  /**\n   * Get the SDK metadata.\n   * @see SdkMetadata\n   */\n   getSdkMetadata() {\n    return this._options._metadata;\n  }\n\n  /**\n   * Returns the transport that is used by the client.\n   * Please note that the transport gets lazy initialized so it will only be there once the first event has been sent.\n   */\n   getTransport() {\n    return this._transport;\n  }\n\n  /**\n   * Wait for all events to be sent or the timeout to expire, whichever comes first.\n   *\n   * @param timeout Maximum time in ms the client should wait for events to be flushed. Omitting this parameter will\n   *   cause the client to wait until all events are sent before resolving the promise.\n   * @returns A promise that will resolve with `true` if all events are sent before the timeout, or `false` if there are\n   * still events in the queue when the timeout is reached.\n   */\n   flush(timeout) {\n    const transport = this._transport;\n    if (transport) {\n      this.emit('flush');\n      return this._isClientDoneProcessing(timeout).then(clientFinished => {\n        return transport.flush(timeout).then(transportFlushed => clientFinished && transportFlushed);\n      });\n    } else {\n      return resolvedSyncPromise(true);\n    }\n  }\n\n  /**\n   * Flush the event queue and set the client to `enabled = false`. See {@link Client.flush}.\n   *\n   * @param {number} timeout Maximum time in ms the client should wait before shutting down. Omitting this parameter will cause\n   *   the client to wait until all events are sent before disabling itself.\n   * @returns {Promise<boolean>} A promise which resolves to `true` if the flush completes successfully before the timeout, or `false` if\n   * it doesn't.\n   */\n   close(timeout) {\n    return this.flush(timeout).then(result => {\n      this.getOptions().enabled = false;\n      this.emit('close');\n      return result;\n    });\n  }\n\n  /**\n   * Get all installed event processors.\n   */\n   getEventProcessors() {\n    return this._eventProcessors;\n  }\n\n  /**\n   * Adds an event processor that applies to any event processed by this client.\n   */\n   addEventProcessor(eventProcessor) {\n    this._eventProcessors.push(eventProcessor);\n  }\n\n  /**\n   * Initialize this client.\n   * Call this after the client was set on a scope.\n   */\n   init() {\n    if (\n      this._isEnabled() ||\n      // Force integrations to be setup even if no DSN was set when we have\n      // Spotlight enabled. This is particularly important for browser as we\n      // don't support the `spotlight` option there and rely on the users\n      // adding the `spotlightBrowserIntegration()` to their integrations which\n      // wouldn't get initialized with the check below when there's no DSN set.\n      this._options.integrations.some(({ name }) => name.startsWith('Spotlight'))\n    ) {\n      this._setupIntegrations();\n    }\n  }\n\n  /**\n   * Gets an installed integration by its name.\n   *\n   * @returns {Integration|undefined} The installed integration or `undefined` if no integration with that `name` was installed.\n   */\n   getIntegrationByName(integrationName) {\n    return this._integrations[integrationName] ;\n  }\n\n  /**\n   * Add an integration to the client.\n   * This can be used to e.g. lazy load integrations.\n   * In most cases, this should not be necessary,\n   * and you're better off just passing the integrations via `integrations: []` at initialization time.\n   * However, if you find the need to conditionally load & add an integration, you can use `addIntegration` to do so.\n   */\n   addIntegration(integration) {\n    const isAlreadyInstalled = this._integrations[integration.name];\n\n    // This hook takes care of only installing if not already installed\n    setupIntegration(this, integration, this._integrations);\n    // Here we need to check manually to make sure to not run this multiple times\n    if (!isAlreadyInstalled) {\n      afterSetupIntegrations(this, [integration]);\n    }\n  }\n\n  /**\n   * Send a fully prepared event to Sentry.\n   */\n   sendEvent(event, hint = {}) {\n    this.emit('beforeSendEvent', event, hint);\n\n    let env = createEventEnvelope(event, this._dsn, this._options._metadata, this._options.tunnel);\n\n    for (const attachment of hint.attachments || []) {\n      env = addItemToEnvelope(env, createAttachmentEnvelopeItem(attachment));\n    }\n\n    const promise = this.sendEnvelope(env);\n    if (promise) {\n      promise.then(sendResponse => this.emit('afterSendEvent', event, sendResponse), null);\n    }\n  }\n\n  /**\n   * Send a session or session aggregrates to Sentry.\n   */\n   sendSession(session) {\n    // Backfill release and environment on session\n    const { release: clientReleaseOption, environment: clientEnvironmentOption = DEFAULT_ENVIRONMENT } = this._options;\n    if ('aggregates' in session) {\n      const sessionAttrs = session.attrs || {};\n      if (!sessionAttrs.release && !clientReleaseOption) {\n        DEBUG_BUILD && logger.warn(MISSING_RELEASE_FOR_SESSION_ERROR);\n        return;\n      }\n      sessionAttrs.release = sessionAttrs.release || clientReleaseOption;\n      sessionAttrs.environment = sessionAttrs.environment || clientEnvironmentOption;\n      session.attrs = sessionAttrs;\n    } else {\n      if (!session.release && !clientReleaseOption) {\n        DEBUG_BUILD && logger.warn(MISSING_RELEASE_FOR_SESSION_ERROR);\n        return;\n      }\n      session.release = session.release || clientReleaseOption;\n      session.environment = session.environment || clientEnvironmentOption;\n    }\n\n    this.emit('beforeSendSession', session);\n\n    const env = createSessionEnvelope(session, this._dsn, this._options._metadata, this._options.tunnel);\n\n    // sendEnvelope should not throw\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.sendEnvelope(env);\n  }\n\n  /**\n   * Record on the client that an event got dropped (ie, an event that will not be sent to Sentry).\n   */\n   recordDroppedEvent(reason, category, count = 1) {\n    if (this._options.sendClientReports) {\n      // We want to track each category (error, transaction, session, replay_event) separately\n      // but still keep the distinction between different type of outcomes.\n      // We could use nested maps, but it's much easier to read and type this way.\n      // A correct type for map-based implementation if we want to go that route\n      // would be `Partial<Record<SentryRequestType, Partial<Record<Outcome, number>>>>`\n      // With typescript 4.1 we could even use template literal types\n      const key = `${reason}:${category}`;\n      DEBUG_BUILD && logger.log(`Recording outcome: \"${key}\"${count > 1 ? ` (${count} times)` : ''}`);\n      this._outcomes[key] = (this._outcomes[key] || 0) + count;\n    }\n  }\n\n  /* eslint-disable @typescript-eslint/unified-signatures */\n  /**\n   * Register a callback for whenever a span is started.\n   * Receives the span as argument.\n   * @returns {() => void} A function that, when executed, removes the registered callback.\n   */\n\n  /**\n   * Register a hook on this client.\n   */\n   on(hook, callback) {\n    const hooks = (this._hooks[hook] = this._hooks[hook] || []);\n\n    // @ts-expect-error We assume the types are correct\n    hooks.push(callback);\n\n    // This function returns a callback execution handler that, when invoked,\n    // deregisters a callback. This is crucial for managing instances where callbacks\n    // need to be unregistered to prevent self-referencing in callback closures,\n    // ensuring proper garbage collection.\n    return () => {\n      // @ts-expect-error We assume the types are correct\n      const cbIndex = hooks.indexOf(callback);\n      if (cbIndex > -1) {\n        hooks.splice(cbIndex, 1);\n      }\n    };\n  }\n\n  /** Fire a hook whenever a span starts. */\n\n  /**\n   * Emit a hook that was previously registered via `on()`.\n   */\n   emit(hook, ...rest) {\n    const callbacks = this._hooks[hook];\n    if (callbacks) {\n      callbacks.forEach(callback => callback(...rest));\n    }\n  }\n\n  /**\n   * Send an envelope to Sentry.\n   */\n   sendEnvelope(envelope) {\n    this.emit('beforeEnvelope', envelope);\n\n    if (this._isEnabled() && this._transport) {\n      return this._transport.send(envelope).then(null, reason => {\n        DEBUG_BUILD && logger.error('Error while sending envelope:', reason);\n        return reason;\n      });\n    }\n\n    DEBUG_BUILD && logger.error('Transport disabled');\n\n    return resolvedSyncPromise({});\n  }\n\n  /* eslint-enable @typescript-eslint/unified-signatures */\n\n  /** Setup integrations for this client. */\n   _setupIntegrations() {\n    const { integrations } = this._options;\n    this._integrations = setupIntegrations(this, integrations);\n    afterSetupIntegrations(this, integrations);\n  }\n\n  /** Updates existing session based on the provided event */\n   _updateSessionFromEvent(session, event) {\n    let crashed = event.level === 'fatal';\n    let errored = false;\n    const exceptions = event.exception?.values;\n\n    if (exceptions) {\n      errored = true;\n\n      for (const ex of exceptions) {\n        const mechanism = ex.mechanism;\n        if (mechanism?.handled === false) {\n          crashed = true;\n          break;\n        }\n      }\n    }\n\n    // A session is updated and that session update is sent in only one of the two following scenarios:\n    // 1. Session with non terminal status and 0 errors + an error occurred -> Will set error count to 1 and send update\n    // 2. Session with non terminal status and 1 error + a crash occurred -> Will set status crashed and send update\n    const sessionNonTerminal = session.status === 'ok';\n    const shouldUpdateAndSend = (sessionNonTerminal && session.errors === 0) || (sessionNonTerminal && crashed);\n\n    if (shouldUpdateAndSend) {\n      updateSession(session, {\n        ...(crashed && { status: 'crashed' }),\n        errors: session.errors || Number(errored || crashed),\n      });\n      this.captureSession(session);\n    }\n  }\n\n  /**\n   * Determine if the client is finished processing. Returns a promise because it will wait `timeout` ms before saying\n   * \"no\" (resolving to `false`) in order to give the client a chance to potentially finish first.\n   *\n   * @param timeout The time, in ms, after which to resolve to `false` if the client is still busy. Passing `0` (or not\n   * passing anything) will make the promise wait as long as it takes for processing to finish before resolving to\n   * `true`.\n   * @returns A promise which will resolve to `true` if processing is already done or finishes before the timeout, and\n   * `false` otherwise\n   */\n   _isClientDoneProcessing(timeout) {\n    return new SyncPromise(resolve => {\n      let ticked = 0;\n      const tick = 1;\n\n      const interval = setInterval(() => {\n        if (this._numProcessing == 0) {\n          clearInterval(interval);\n          resolve(true);\n        } else {\n          ticked += tick;\n          if (timeout && ticked >= timeout) {\n            clearInterval(interval);\n            resolve(false);\n          }\n        }\n      }, tick);\n    });\n  }\n\n  /** Determines whether this SDK is enabled and a transport is present. */\n   _isEnabled() {\n    return this.getOptions().enabled !== false && this._transport !== undefined;\n  }\n\n  /**\n   * Adds common information to events.\n   *\n   * The information includes release and environment from `options`,\n   * breadcrumbs and context (extra, tags and user) from the scope.\n   *\n   * Information that is already present in the event is never overwritten. For\n   * nested objects, such as the context, keys are merged.\n   *\n   * @param event The original event.\n   * @param hint May contain additional information about the original exception.\n   * @param currentScope A scope containing event metadata.\n   * @returns A new event with more information.\n   */\n   _prepareEvent(\n    event,\n    hint,\n    currentScope,\n    isolationScope,\n  ) {\n    const options = this.getOptions();\n    const integrations = Object.keys(this._integrations);\n    if (!hint.integrations && integrations?.length) {\n      hint.integrations = integrations;\n    }\n\n    this.emit('preprocessEvent', event, hint);\n\n    if (!event.type) {\n      isolationScope.setLastEventId(event.event_id || hint.event_id);\n    }\n\n    return prepareEvent(options, event, hint, currentScope, this, isolationScope).then(evt => {\n      if (evt === null) {\n        return evt;\n      }\n\n      this.emit('postprocessEvent', evt, hint);\n\n      evt.contexts = {\n        trace: getTraceContextFromScope(currentScope),\n        ...evt.contexts,\n      };\n\n      const dynamicSamplingContext = getDynamicSamplingContextFromScope(this, currentScope);\n\n      evt.sdkProcessingMetadata = {\n        dynamicSamplingContext,\n        ...evt.sdkProcessingMetadata,\n      };\n\n      return evt;\n    });\n  }\n\n  /**\n   * Processes the event and logs an error in case of rejection\n   * @param event\n   * @param hint\n   * @param scope\n   */\n   _captureEvent(\n    event,\n    hint = {},\n    currentScope = getCurrentScope(),\n    isolationScope = getIsolationScope(),\n  ) {\n    if (DEBUG_BUILD && isErrorEvent(event)) {\n      logger.log(`Captured error event \\`${getPossibleEventMessages(event)[0] || '<unknown>'}\\``);\n    }\n\n    return this._processEvent(event, hint, currentScope, isolationScope).then(\n      finalEvent => {\n        return finalEvent.event_id;\n      },\n      reason => {\n        if (DEBUG_BUILD) {\n          if (_isDoNotSendEventError(reason)) {\n            logger.log(reason.message);\n          } else if (_isInternalError(reason)) {\n            logger.warn(reason.message);\n          } else {\n            logger.warn(reason);\n          }\n        }\n        return undefined;\n      },\n    );\n  }\n\n  /**\n   * Processes an event (either error or message) and sends it to Sentry.\n   *\n   * This also adds breadcrumbs and context information to the event. However,\n   * platform specific meta data (such as the User's IP address) must be added\n   * by the SDK implementor.\n   *\n   *\n   * @param event The event to send to Sentry.\n   * @param hint May contain additional information about the original exception.\n   * @param currentScope A scope containing event metadata.\n   * @returns A SyncPromise that resolves with the event or rejects in case event was/will not be send.\n   */\n   _processEvent(\n    event,\n    hint,\n    currentScope,\n    isolationScope,\n  ) {\n    const options = this.getOptions();\n    const { sampleRate } = options;\n\n    const isTransaction = isTransactionEvent(event);\n    const isError = isErrorEvent(event);\n    const eventType = event.type || 'error';\n    const beforeSendLabel = `before send for type \\`${eventType}\\``;\n\n    // 1.0 === 100% events are sent\n    // 0.0 === 0% events are sent\n    // Sampling for transaction happens somewhere else\n    const parsedSampleRate = typeof sampleRate === 'undefined' ? undefined : parseSampleRate(sampleRate);\n    if (isError && typeof parsedSampleRate === 'number' && Math.random() > parsedSampleRate) {\n      this.recordDroppedEvent('sample_rate', 'error');\n      return rejectedSyncPromise(\n        _makeDoNotSendEventError(\n          `Discarding event because it's not included in the random sample (sampling rate = ${sampleRate})`,\n        ),\n      );\n    }\n\n    const dataCategory = (eventType === 'replay_event' ? 'replay' : eventType) ;\n\n    return this._prepareEvent(event, hint, currentScope, isolationScope)\n      .then(prepared => {\n        if (prepared === null) {\n          this.recordDroppedEvent('event_processor', dataCategory);\n          throw _makeDoNotSendEventError('An event processor returned `null`, will not send event.');\n        }\n\n        const isInternalException = hint.data && (hint.data ).__sentry__ === true;\n        if (isInternalException) {\n          return prepared;\n        }\n\n        const result = processBeforeSend(this, options, prepared, hint);\n        return _validateBeforeSendResult(result, beforeSendLabel);\n      })\n      .then(processedEvent => {\n        if (processedEvent === null) {\n          this.recordDroppedEvent('before_send', dataCategory);\n          if (isTransaction) {\n            const spans = event.spans || [];\n            // the transaction itself counts as one span, plus all the child spans that are added\n            const spanCount = 1 + spans.length;\n            this.recordDroppedEvent('before_send', 'span', spanCount);\n          }\n          throw _makeDoNotSendEventError(`${beforeSendLabel} returned \\`null\\`, will not send event.`);\n        }\n\n        const session = currentScope.getSession() || isolationScope.getSession();\n        if (isError && session) {\n          this._updateSessionFromEvent(session, processedEvent);\n        }\n\n        if (isTransaction) {\n          const spanCountBefore = processedEvent.sdkProcessingMetadata?.spanCountBeforeProcessing || 0;\n          const spanCountAfter = processedEvent.spans ? processedEvent.spans.length : 0;\n\n          const droppedSpanCount = spanCountBefore - spanCountAfter;\n          if (droppedSpanCount > 0) {\n            this.recordDroppedEvent('before_send', 'span', droppedSpanCount);\n          }\n        }\n\n        // None of the Sentry built event processor will update transaction name,\n        // so if the transaction name has been changed by an event processor, we know\n        // it has to come from custom event processor added by a user\n        const transactionInfo = processedEvent.transaction_info;\n        if (isTransaction && transactionInfo && processedEvent.transaction !== event.transaction) {\n          const source = 'custom';\n          processedEvent.transaction_info = {\n            ...transactionInfo,\n            source,\n          };\n        }\n\n        this.sendEvent(processedEvent, hint);\n        return processedEvent;\n      })\n      .then(null, reason => {\n        if (_isDoNotSendEventError(reason) || _isInternalError(reason)) {\n          throw reason;\n        }\n\n        this.captureException(reason, {\n          data: {\n            __sentry__: true,\n          },\n          originalException: reason,\n        });\n        throw _makeInternalError(\n          `Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\\nReason: ${reason}`,\n        );\n      });\n  }\n\n  /**\n   * Occupies the client with processing and event\n   */\n   _process(promise) {\n    this._numProcessing++;\n    void promise.then(\n      value => {\n        this._numProcessing--;\n        return value;\n      },\n      reason => {\n        this._numProcessing--;\n        return reason;\n      },\n    );\n  }\n\n  /**\n   * Clears outcomes on this client and returns them.\n   */\n   _clearOutcomes() {\n    const outcomes = this._outcomes;\n    this._outcomes = {};\n    return Object.entries(outcomes).map(([key, quantity]) => {\n      const [reason, category] = key.split(':') ;\n      return {\n        reason,\n        category,\n        quantity,\n      };\n    });\n  }\n\n  /**\n   * Sends client reports as an envelope.\n   */\n   _flushOutcomes() {\n    DEBUG_BUILD && logger.log('Flushing outcomes...');\n\n    const outcomes = this._clearOutcomes();\n\n    if (outcomes.length === 0) {\n      DEBUG_BUILD && logger.log('No outcomes to send');\n      return;\n    }\n\n    // This is really the only place where we want to check for a DSN and only send outcomes then\n    if (!this._dsn) {\n      DEBUG_BUILD && logger.log('No dsn provided, will not send outcomes');\n      return;\n    }\n\n    DEBUG_BUILD && logger.log('Sending outcomes:', outcomes);\n\n    const envelope = createClientReportEnvelope(outcomes, this._options.tunnel && dsnToString(this._dsn));\n\n    // sendEnvelope should not throw\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.sendEnvelope(envelope);\n  }\n\n  /**\n   * Creates an {@link Event} from all inputs to `captureException` and non-primitive inputs to `captureMessage`.\n   */\n\n}\n\n/**\n * @deprecated Use `Client` instead. This alias may be removed in a future major version.\n */\n// TODO(v10): Remove\n\n/**\n * @deprecated Use `Client` instead. This alias may be removed in a future major version.\n */\n// TODO(v10): Remove\nconst BaseClient = Client;\n\n/**\n * Verifies that return value of configured `beforeSend` or `beforeSendTransaction` is of expected type, and returns the value if so.\n */\nfunction _validateBeforeSendResult(\n  beforeSendResult,\n  beforeSendLabel,\n) {\n  const invalidValueError = `${beforeSendLabel} must return \\`null\\` or a valid event.`;\n  if (isThenable(beforeSendResult)) {\n    return beforeSendResult.then(\n      event => {\n        if (!isPlainObject(event) && event !== null) {\n          throw _makeInternalError(invalidValueError);\n        }\n        return event;\n      },\n      e => {\n        throw _makeInternalError(`${beforeSendLabel} rejected with ${e}`);\n      },\n    );\n  } else if (!isPlainObject(beforeSendResult) && beforeSendResult !== null) {\n    throw _makeInternalError(invalidValueError);\n  }\n  return beforeSendResult;\n}\n\n/**\n * Process the matching `beforeSendXXX` callback.\n */\nfunction processBeforeSend(\n  client,\n  options,\n  event,\n  hint,\n) {\n  const { beforeSend, beforeSendTransaction, beforeSendSpan } = options;\n  let processedEvent = event;\n\n  if (isErrorEvent(processedEvent) && beforeSend) {\n    return beforeSend(processedEvent, hint);\n  }\n\n  if (isTransactionEvent(processedEvent)) {\n    if (beforeSendSpan) {\n      // process root span\n      const processedRootSpanJson = beforeSendSpan(convertTransactionEventToSpanJson(processedEvent));\n      if (!processedRootSpanJson) {\n        showSpanDropWarning();\n      } else {\n        // update event with processed root span values\n        processedEvent = merge(event, convertSpanJsonToTransactionEvent(processedRootSpanJson));\n      }\n\n      // process child spans\n      if (processedEvent.spans) {\n        const processedSpans = [];\n        for (const span of processedEvent.spans) {\n          const processedSpan = beforeSendSpan(span);\n          if (!processedSpan) {\n            showSpanDropWarning();\n            processedSpans.push(span);\n          } else {\n            processedSpans.push(processedSpan);\n          }\n        }\n        processedEvent.spans = processedSpans;\n      }\n    }\n\n    if (beforeSendTransaction) {\n      if (processedEvent.spans) {\n        // We store the # of spans before processing in SDK metadata,\n        // so we can compare it afterwards to determine how many spans were dropped\n        const spanCountBefore = processedEvent.spans.length;\n        processedEvent.sdkProcessingMetadata = {\n          ...event.sdkProcessingMetadata,\n          spanCountBeforeProcessing: spanCountBefore,\n        };\n      }\n      return beforeSendTransaction(processedEvent , hint);\n    }\n  }\n\n  return processedEvent;\n}\n\nfunction isErrorEvent(event) {\n  return event.type === undefined;\n}\n\nfunction isTransactionEvent(event) {\n  return event.type === 'transaction';\n}\n\n/** Extract trace information from scope */\nfunction _getTraceInfoFromScope(\n  client,\n  scope,\n) {\n  if (!scope) {\n    return [undefined, undefined];\n  }\n\n  const span = _getSpanForScope(scope);\n  const traceContext = span ? spanToTraceContext(span) : getTraceContextFromScope(scope);\n  const dynamicSamplingContext = span\n    ? getDynamicSamplingContextFromSpan(span)\n    : getDynamicSamplingContextFromScope(client, scope);\n  return [dynamicSamplingContext, traceContext];\n}\n\nexport { BaseClient, Client, _getTraceInfoFromScope };\n//# sourceMappingURL=client.js.map\n","/**\n * Parse a sample rate from a given value.\n * This will either return a boolean or number sample rate, if the sample rate is valid (between 0 and 1).\n * If a string is passed, we try to convert it to a number.\n *\n * Any invalid sample rate will return `undefined`.\n */\nfunction parseSampleRate(sampleRate) {\n  if (typeof sampleRate === 'boolean') {\n    return Number(sampleRate);\n  }\n\n  const rate = typeof sampleRate === 'string' ? parseFloat(sampleRate) : sampleRate;\n  if (typeof rate !== 'number' || isNaN(rate) || rate < 0 || rate > 1) {\n    return undefined;\n  }\n\n  return rate;\n}\n\nexport { parseSampleRate };\n//# sourceMappingURL=parseSampleRate.js.map\n","import { SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME, SEMANTIC_ATTRIBUTE_PROFILE_ID } from '../semanticAttributes.js';\n\n/**\n * Converts a transaction event to a span JSON object.\n */\nfunction convertTransactionEventToSpanJson(event) {\n  const { trace_id, parent_span_id, span_id, status, origin, data, op } = event.contexts?.trace ?? {};\n\n  return {\n    data: data ?? {},\n    description: event.transaction,\n    op,\n    parent_span_id,\n    span_id: span_id ?? '',\n    start_timestamp: event.start_timestamp ?? 0,\n    status,\n    timestamp: event.timestamp,\n    trace_id: trace_id ?? '',\n    origin,\n    profile_id: data?.[SEMANTIC_ATTRIBUTE_PROFILE_ID] ,\n    exclusive_time: data?.[SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME] ,\n    measurements: event.measurements,\n    is_segment: true,\n  };\n}\n\n/**\n * Converts a span JSON object to a transaction event.\n */\nfunction convertSpanJsonToTransactionEvent(span) {\n  return {\n    type: 'transaction',\n    timestamp: span.timestamp,\n    start_timestamp: span.start_timestamp,\n    transaction: span.description,\n    contexts: {\n      trace: {\n        trace_id: span.trace_id,\n        span_id: span.span_id,\n        parent_span_id: span.parent_span_id,\n        op: span.op,\n        status: span.status,\n        origin: span.origin,\n        data: {\n          ...span.data,\n          ...(span.profile_id && { [SEMANTIC_ATTRIBUTE_PROFILE_ID]: span.profile_id }),\n          ...(span.exclusive_time && { [SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME]: span.exclusive_time }),\n        },\n      },\n    },\n    measurements: span.measurements,\n  };\n}\n\nexport { convertSpanJsonToTransactionEvent, convertTransactionEventToSpanJson };\n//# sourceMappingURL=transactionEvent.js.map\n","import { createEnvelope } from './envelope.js';\nimport { dateTimestampInSeconds } from './time.js';\n\n/**\n * Creates client report envelope\n * @param discarded_events An array of discard events\n * @param dsn A DSN that can be set on the header. Optional.\n */\nfunction createClientReportEnvelope(\n  discarded_events,\n  dsn,\n  timestamp,\n) {\n  const clientReportItem = [\n    { type: 'client_report' },\n    {\n      timestamp: timestamp || dateTimestampInSeconds(),\n      discarded_events,\n    },\n  ];\n  return createEnvelope(dsn ? { dsn } : {}, [clientReportItem]);\n}\n\nexport { createClientReportEnvelope };\n//# sourceMappingURL=clientreport.js.map\n","import { dsnToString } from '../utils-hoist/dsn.js';\nimport '../utils-hoist/logger.js';\nimport '../utils-hoist/debug-build.js';\nimport '../utils-hoist/time.js';\nimport '../utils-hoist/syncpromise.js';\nimport { createEnvelope } from '../utils-hoist/envelope.js';\n\n/**\n * Creates OTEL log envelope item for a serialized OTEL log.\n *\n * @param log - The serialized OTEL log to include in the envelope.\n * @returns The created OTEL log envelope item.\n */\nfunction createOtelLogEnvelopeItem(log) {\n  return [\n    {\n      type: 'otel_log',\n    },\n    log,\n  ];\n}\n\n/**\n * Creates an envelope for a list of logs.\n *\n * @param logs - The logs to include in the envelope.\n * @param metadata - The metadata to include in the envelope.\n * @param tunnel - The tunnel to include in the envelope.\n * @param dsn - The DSN to include in the envelope.\n * @returns The created envelope.\n */\nfunction createOtelLogEnvelope(\n  logs,\n  metadata,\n  tunnel,\n  dsn,\n) {\n  const headers = {};\n\n  if (metadata?.sdk) {\n    headers.sdk = {\n      name: metadata.sdk.name,\n      version: metadata.sdk.version,\n    };\n  }\n\n  if (!!tunnel && !!dsn) {\n    headers.dsn = dsnToString(dsn);\n  }\n\n  return createEnvelope(headers, logs.map(createOtelLogEnvelopeItem));\n}\n\nexport { createOtelLogEnvelope, createOtelLogEnvelopeItem };\n//# sourceMappingURL=envelope.js.map\n","import { _getTraceInfoFromScope } from '../client.js';\nimport { getClient, getCurrentScope } from '../currentScopes.js';\nimport { DEBUG_BUILD } from '../debug-build.js';\nimport { SEVERITY_TEXT_TO_SEVERITY_NUMBER } from './constants.js';\nimport { isParameterizedString } from '../utils-hoist/is.js';\nimport '../utils-hoist/debug-build.js';\nimport { logger } from '../utils-hoist/logger.js';\nimport '../utils-hoist/time.js';\nimport '../utils-hoist/syncpromise.js';\nimport { _getSpanForScope } from '../utils/spanOnScope.js';\nimport { createOtelLogEnvelope } from './envelope.js';\n\nconst MAX_LOG_BUFFER_SIZE = 100;\n\nconst CLIENT_TO_LOG_BUFFER_MAP = new WeakMap();\n\n/**\n * Converts a log attribute to a serialized log attribute.\n *\n * @param key - The key of the log attribute.\n * @param value - The value of the log attribute.\n * @returns The serialized log attribute.\n */\nfunction logAttributeToSerializedLogAttribute(key, value) {\n  switch (typeof value) {\n    case 'number':\n      return {\n        key,\n        value: { doubleValue: value },\n      };\n    case 'boolean':\n      return {\n        key,\n        value: { boolValue: value },\n      };\n    case 'string':\n      return {\n        key,\n        value: { stringValue: value },\n      };\n    default: {\n      let stringValue = '';\n      try {\n        stringValue = JSON.stringify(value) ?? '';\n      } catch {\n        // Do nothing\n      }\n      return {\n        key,\n        value: { stringValue },\n      };\n    }\n  }\n}\n\n/**\n * Captures a log event and sends it to Sentry.\n *\n * @param log - The log event to capture.\n * @param scope - A scope. Uses the current scope if not provided.\n * @param client - A client. Uses the current client if not provided.\n *\n * @experimental This method will experience breaking changes. This is not yet part of\n * the stable Sentry SDK API and can be changed or removed without warning.\n */\nfunction _INTERNAL_captureLog(\n  beforeLog,\n  client = getClient(),\n  scope = getCurrentScope(),\n) {\n  if (!client) {\n    DEBUG_BUILD && logger.warn('No client available to capture log.');\n    return;\n  }\n\n  const { _experiments, release, environment } = client.getOptions();\n  const { enableLogs = false, beforeSendLog } = _experiments ?? {};\n  if (!enableLogs) {\n    DEBUG_BUILD && logger.warn('logging option not enabled, log will not be captured.');\n    return;\n  }\n\n  const [, traceContext] = _getTraceInfoFromScope(client, scope);\n\n  const processedLogAttributes = {\n    ...beforeLog.attributes,\n  };\n\n  if (release) {\n    processedLogAttributes['sentry.release'] = release;\n  }\n\n  if (environment) {\n    processedLogAttributes['sentry.environment'] = environment;\n  }\n\n  const { sdk } = client.getSdkMetadata() ?? {};\n  if (sdk) {\n    processedLogAttributes['sentry.sdk.name'] = sdk.name;\n    processedLogAttributes['sentry.sdk.version'] = sdk.version;\n  }\n\n  const beforeLogMessage = beforeLog.message;\n  if (isParameterizedString(beforeLogMessage)) {\n    const { __sentry_template_string__, __sentry_template_values__ = [] } = beforeLogMessage;\n    processedLogAttributes['sentry.message.template'] = __sentry_template_string__;\n    __sentry_template_values__.forEach((param, index) => {\n      processedLogAttributes[`sentry.message.parameter.${index}`] = param;\n    });\n  }\n\n  const span = _getSpanForScope(scope);\n  if (span) {\n    // Add the parent span ID to the log attributes for trace context\n    processedLogAttributes['sentry.trace.parent_span_id'] = span.spanContext().spanId;\n  }\n\n  const processedLog = { ...beforeLog, attributes: processedLogAttributes };\n\n  client.emit('beforeCaptureLog', processedLog);\n\n  const log = beforeSendLog ? beforeSendLog(processedLog) : processedLog;\n  if (!log) {\n    client.recordDroppedEvent('before_send', 'log_item', 1);\n    DEBUG_BUILD && logger.warn('beforeSendLog returned null, log will not be captured.');\n    return;\n  }\n\n  const { level, message, attributes = {}, severityNumber } = log;\n\n  const serializedLog = {\n    severityText: level,\n    body: {\n      stringValue: message,\n    },\n    attributes: Object.entries(attributes).map(([key, value]) => logAttributeToSerializedLogAttribute(key, value)),\n    timeUnixNano: `${new Date().getTime().toString()}000000`,\n    traceId: traceContext?.trace_id,\n    severityNumber: severityNumber ?? SEVERITY_TEXT_TO_SEVERITY_NUMBER[level],\n  };\n\n  const logBuffer = CLIENT_TO_LOG_BUFFER_MAP.get(client);\n  if (logBuffer === undefined) {\n    CLIENT_TO_LOG_BUFFER_MAP.set(client, [serializedLog]);\n  } else {\n    logBuffer.push(serializedLog);\n    if (logBuffer.length > MAX_LOG_BUFFER_SIZE) {\n      _INTERNAL_flushLogsBuffer(client, logBuffer);\n    }\n  }\n\n  client.emit('afterCaptureLog', log);\n}\n\n/**\n * Flushes the logs buffer to Sentry.\n *\n * @param client - A client.\n * @param maybeLogBuffer - A log buffer. Uses the log buffer for the given client if not provided.\n *\n * @experimental This method will experience breaking changes. This is not yet part of\n * the stable Sentry SDK API and can be changed or removed without warning.\n */\nfunction _INTERNAL_flushLogsBuffer(client, maybeLogBuffer) {\n  const logBuffer = maybeLogBuffer ?? CLIENT_TO_LOG_BUFFER_MAP.get(client) ?? [];\n  if (logBuffer.length === 0) {\n    return;\n  }\n\n  const clientOptions = client.getOptions();\n  const envelope = createOtelLogEnvelope(logBuffer, clientOptions._metadata, clientOptions.tunnel, client.getDsn());\n\n  // Clear the log buffer after envelopes have been constructed.\n  logBuffer.length = 0;\n\n  client.emit('flushLogs');\n\n  // sendEnvelope should not throw\n  // eslint-disable-next-line @typescript-eslint/no-floating-promises\n  client.sendEnvelope(envelope);\n}\n\nexport { _INTERNAL_captureLog, _INTERNAL_flushLogsBuffer, logAttributeToSerializedLogAttribute };\n//# sourceMappingURL=exports.js.map\n","import { getCurrentScope } from './currentScopes.js';\nimport { DEBUG_BUILD } from './debug-build.js';\nimport { logger, consoleSandbox } from './utils-hoist/logger.js';\n\n/** A class object that can instantiate Client objects. */\n\n/**\n * Internal function to create a new SDK client instance. The client is\n * installed and then bound to the current scope.\n *\n * @param clientClass The client class to instantiate.\n * @param options Options to pass to the client.\n */\nfunction initAndBind(\n  clientClass,\n  options,\n) {\n  if (options.debug === true) {\n    if (DEBUG_BUILD) {\n      logger.enable();\n    } else {\n      // use `console.warn` rather than `logger.warn` since by non-debug bundles have all `logger.x` statements stripped\n      consoleSandbox(() => {\n        // eslint-disable-next-line no-console\n        console.warn('[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.');\n      });\n    }\n  }\n  const scope = getCurrentScope();\n  scope.update(options.initialScope);\n\n  const client = new clientClass(options);\n  setCurrentClient(client);\n  client.init();\n  return client;\n}\n\n/**\n * Make the given client the current client.\n */\nfunction setCurrentClient(client) {\n  getCurrentScope().setClient(client);\n}\n\nexport { initAndBind, setCurrentClient };\n//# sourceMappingURL=sdk.js.map\n","import { SyncPromise, resolvedSyncPromise, rejectedSyncPromise } from './syncpromise.js';\n\nconst SENTRY_BUFFER_FULL_ERROR = Symbol.for('SentryBufferFullError');\n\n/**\n * Creates an new PromiseBuffer object with the specified limit\n * @param limit max number of promises that can be stored in the buffer\n */\nfunction makePromiseBuffer(limit) {\n  const buffer = [];\n\n  function isReady() {\n    return limit === undefined || buffer.length < limit;\n  }\n\n  /**\n   * Remove a promise from the queue.\n   *\n   * @param task Can be any PromiseLike<T>\n   * @returns Removed promise.\n   */\n  function remove(task) {\n    return buffer.splice(buffer.indexOf(task), 1)[0] || Promise.resolve(undefined);\n  }\n\n  /**\n   * Add a promise (representing an in-flight action) to the queue, and set it to remove itself on fulfillment.\n   *\n   * @param taskProducer A function producing any PromiseLike<T>; In previous versions this used to be `task:\n   *        PromiseLike<T>`, but under that model, Promises were instantly created on the call-site and their executor\n   *        functions therefore ran immediately. Thus, even if the buffer was full, the action still happened. By\n   *        requiring the promise to be wrapped in a function, we can defer promise creation until after the buffer\n   *        limit check.\n   * @returns The original promise.\n   */\n  function add(taskProducer) {\n    if (!isReady()) {\n      return rejectedSyncPromise(SENTRY_BUFFER_FULL_ERROR);\n    }\n\n    // start the task and add its promise to the queue\n    const task = taskProducer();\n    if (buffer.indexOf(task) === -1) {\n      buffer.push(task);\n    }\n    void task\n      .then(() => remove(task))\n      // Use `then(null, rejectionHandler)` rather than `catch(rejectionHandler)` so that we can use `PromiseLike`\n      // rather than `Promise`. `PromiseLike` doesn't have a `.catch` method, making its polyfill smaller. (ES5 didn't\n      // have promises, so TS has to polyfill when down-compiling.)\n      .then(null, () =>\n        remove(task).then(null, () => {\n          // We have to add another catch here because `remove()` starts a new promise chain.\n        }),\n      );\n    return task;\n  }\n\n  /**\n   * Wait for all promises in the queue to resolve or for timeout to expire, whichever comes first.\n   *\n   * @param timeout The time, in ms, after which to resolve to `false` if the queue is still non-empty. Passing `0` (or\n   * not passing anything) will make the promise wait as long as it takes for the queue to drain before resolving to\n   * `true`.\n   * @returns A promise which will resolve to `true` if the queue is already empty or drains before the timeout, and\n   * `false` otherwise\n   */\n  function drain(timeout) {\n    return new SyncPromise((resolve, reject) => {\n      let counter = buffer.length;\n\n      if (!counter) {\n        return resolve(true);\n      }\n\n      // wait for `timeout` ms and then resolve to `false` (if not cancelled first)\n      const capturedSetTimeout = setTimeout(() => {\n        if (timeout && timeout > 0) {\n          resolve(false);\n        }\n      }, timeout);\n\n      // if all promises resolve in time, cancel the timer and resolve to `true`\n      buffer.forEach(item => {\n        void resolvedSyncPromise(item).then(() => {\n          if (!--counter) {\n            clearTimeout(capturedSetTimeout);\n            resolve(true);\n          }\n        }, reject);\n      });\n    });\n  }\n\n  return {\n    $: buffer,\n    add,\n    drain,\n  };\n}\n\nexport { SENTRY_BUFFER_FULL_ERROR, makePromiseBuffer };\n//# sourceMappingURL=promisebuffer.js.map\n","// Intentionally keeping the key broad, as we don't know for sure what rate limit headers get returned from backend\n\nconst DEFAULT_RETRY_AFTER = 60 * 1000; // 60 seconds\n\n/**\n * Extracts Retry-After value from the request header or returns default value\n * @param header string representation of 'Retry-After' header\n * @param now current unix timestamp\n *\n */\nfunction parseRetryAfterHeader(header, now = Date.now()) {\n  const headerDelay = parseInt(`${header}`, 10);\n  if (!isNaN(headerDelay)) {\n    return headerDelay * 1000;\n  }\n\n  const headerDate = Date.parse(`${header}`);\n  if (!isNaN(headerDate)) {\n    return headerDate - now;\n  }\n\n  return DEFAULT_RETRY_AFTER;\n}\n\n/**\n * Gets the time that the given category is disabled until for rate limiting.\n * In case no category-specific limit is set but a general rate limit across all categories is active,\n * that time is returned.\n *\n * @return the time in ms that the category is disabled until or 0 if there's no active rate limit.\n */\nfunction disabledUntil(limits, dataCategory) {\n  return limits[dataCategory] || limits.all || 0;\n}\n\n/**\n * Checks if a category is rate limited\n */\nfunction isRateLimited(limits, dataCategory, now = Date.now()) {\n  return disabledUntil(limits, dataCategory) > now;\n}\n\n/**\n * Update ratelimits from incoming headers.\n *\n * @return the updated RateLimits object.\n */\nfunction updateRateLimits(\n  limits,\n  { statusCode, headers },\n  now = Date.now(),\n) {\n  const updatedRateLimits = {\n    ...limits,\n  };\n\n  // \"The name is case-insensitive.\"\n  // https://developer.mozilla.org/en-US/docs/Web/API/Headers/get\n  const rateLimitHeader = headers?.['x-sentry-rate-limits'];\n  const retryAfterHeader = headers?.['retry-after'];\n\n  if (rateLimitHeader) {\n    /**\n     * rate limit headers are of the form\n     *     <header>,<header>,..\n     * where each <header> is of the form\n     *     <retry_after>: <categories>: <scope>: <reason_code>: <namespaces>\n     * where\n     *     <retry_after> is a delay in seconds\n     *     <categories> is the event type(s) (error, transaction, etc) being rate limited and is of the form\n     *         <category>;<category>;...\n     *     <scope> is what's being limited (org, project, or key) - ignored by SDK\n     *     <reason_code> is an arbitrary string like \"org_quota\" - ignored by SDK\n     *     <namespaces> Semicolon-separated list of metric namespace identifiers. Defines which namespace(s) will be affected.\n     *         Only present if rate limit applies to the metric_bucket data category.\n     */\n    for (const limit of rateLimitHeader.trim().split(',')) {\n      const [retryAfter, categories, , , namespaces] = limit.split(':', 5) ;\n      const headerDelay = parseInt(retryAfter, 10);\n      const delay = (!isNaN(headerDelay) ? headerDelay : 60) * 1000; // 60sec default\n      if (!categories) {\n        updatedRateLimits.all = now + delay;\n      } else {\n        for (const category of categories.split(';')) {\n          if (category === 'metric_bucket') {\n            // namespaces will be present when category === 'metric_bucket'\n            if (!namespaces || namespaces.split(';').includes('custom')) {\n              updatedRateLimits[category] = now + delay;\n            }\n          } else {\n            updatedRateLimits[category] = now + delay;\n          }\n        }\n      }\n    }\n  } else if (retryAfterHeader) {\n    updatedRateLimits.all = now + parseRetryAfterHeader(retryAfterHeader, now);\n  } else if (statusCode === 429) {\n    updatedRateLimits.all = now + 60 * 1000;\n  }\n\n  return updatedRateLimits;\n}\n\nexport { DEFAULT_RETRY_AFTER, disabledUntil, isRateLimited, parseRetryAfterHeader, updateRateLimits };\n//# sourceMappingURL=ratelimit.js.map\n","import { DEBUG_BUILD } from '../debug-build.js';\nimport { forEachEnvelopeItem, envelopeItemTypeToDataCategory, createEnvelope, serializeEnvelope } from '../utils-hoist/envelope.js';\nimport { logger } from '../utils-hoist/logger.js';\nimport { makePromiseBuffer, SENTRY_BUFFER_FULL_ERROR } from '../utils-hoist/promisebuffer.js';\nimport { isRateLimited, updateRateLimits } from '../utils-hoist/ratelimit.js';\nimport { resolvedSyncPromise } from '../utils-hoist/syncpromise.js';\n\nconst DEFAULT_TRANSPORT_BUFFER_SIZE = 64;\n\n/**\n * Creates an instance of a Sentry `Transport`\n *\n * @param options\n * @param makeRequest\n */\nfunction createTransport(\n  options,\n  makeRequest,\n  buffer = makePromiseBuffer(\n    options.bufferSize || DEFAULT_TRANSPORT_BUFFER_SIZE,\n  ),\n) {\n  let rateLimits = {};\n  const flush = (timeout) => buffer.drain(timeout);\n\n  function send(envelope) {\n    const filteredEnvelopeItems = [];\n\n    // Drop rate limited items from envelope\n    forEachEnvelopeItem(envelope, (item, type) => {\n      const dataCategory = envelopeItemTypeToDataCategory(type);\n      if (isRateLimited(rateLimits, dataCategory)) {\n        options.recordDroppedEvent('ratelimit_backoff', dataCategory);\n      } else {\n        filteredEnvelopeItems.push(item);\n      }\n    });\n\n    // Skip sending if envelope is empty after filtering out rate limited events\n    if (filteredEnvelopeItems.length === 0) {\n      return resolvedSyncPromise({});\n    }\n\n    const filteredEnvelope = createEnvelope(envelope[0], filteredEnvelopeItems );\n\n    // Creates client report for each item in an envelope\n    const recordEnvelopeLoss = (reason) => {\n      forEachEnvelopeItem(filteredEnvelope, (item, type) => {\n        options.recordDroppedEvent(reason, envelopeItemTypeToDataCategory(type));\n      });\n    };\n\n    const requestTask = () =>\n      makeRequest({ body: serializeEnvelope(filteredEnvelope) }).then(\n        response => {\n          // We don't want to throw on NOK responses, but we want to at least log them\n          if (response.statusCode !== undefined && (response.statusCode < 200 || response.statusCode >= 300)) {\n            DEBUG_BUILD && logger.warn(`Sentry responded with status code ${response.statusCode} to sent event.`);\n          }\n\n          rateLimits = updateRateLimits(rateLimits, response);\n          return response;\n        },\n        error => {\n          recordEnvelopeLoss('network_error');\n          DEBUG_BUILD && logger.error('Encountered error running transport request:', error);\n          throw error;\n        },\n      );\n\n    return buffer.add(requestTask).then(\n      result => result,\n      error => {\n        if (error === SENTRY_BUFFER_FULL_ERROR) {\n          DEBUG_BUILD && logger.error('Skipped sending event because buffer is full.');\n          recordEnvelopeLoss('queue_overflow');\n          return resolvedSyncPromise({});\n        } else {\n          throw error;\n        }\n      },\n    );\n  }\n\n  return {\n    send,\n    flush,\n  };\n}\n\nexport { DEFAULT_TRANSPORT_BUFFER_SIZE, createTransport };\n//# sourceMappingURL=base.js.map\n","// By default, we want to infer the IP address, unless this is explicitly set to `null`\n// We do this after all other processing is done\n// If `ip_address` is explicitly set to `null` or a value, we leave it as is\n\n/**\n * @internal\n */\nfunction addAutoIpAddressToUser(objWithMaybeUser) {\n  if (objWithMaybeUser.user?.ip_address === undefined) {\n    objWithMaybeUser.user = {\n      ...objWithMaybeUser.user,\n      ip_address: '{{auto}}',\n    };\n  }\n}\n\n/**\n * @internal\n */\nfunction addAutoIpAddressToSession(session) {\n  if ('aggregates' in session) {\n    if (session.attrs?.['ip_address'] === undefined) {\n      session.attrs = {\n        ...session.attrs,\n        ip_address: '{{auto}}',\n      };\n    }\n  } else {\n    if (session.ipAddress === undefined) {\n      session.ipAddress = '{{auto}}';\n    }\n  }\n}\n\nexport { addAutoIpAddressToSession, addAutoIpAddressToUser };\n//# sourceMappingURL=ipAddress.js.map\n","import { getClient, getIsolationScope } from './currentScopes.js';\nimport { consoleSandbox } from './utils-hoist/logger.js';\nimport { dateTimestampInSeconds } from './utils-hoist/time.js';\n\n/**\n * Default maximum number of breadcrumbs added to an event. Can be overwritten\n * with {@link Options.maxBreadcrumbs}.\n */\nconst DEFAULT_BREADCRUMBS = 100;\n\n/**\n * Records a new breadcrumb which will be attached to future events.\n *\n * Breadcrumbs will be added to subsequent events to provide more context on\n * user's actions prior to an error or crash.\n */\nfunction addBreadcrumb(breadcrumb, hint) {\n  const client = getClient();\n  const isolationScope = getIsolationScope();\n\n  if (!client) return;\n\n  const { beforeBreadcrumb = null, maxBreadcrumbs = DEFAULT_BREADCRUMBS } = client.getOptions();\n\n  if (maxBreadcrumbs <= 0) return;\n\n  const timestamp = dateTimestampInSeconds();\n  const mergedBreadcrumb = { timestamp, ...breadcrumb };\n  const finalBreadcrumb = beforeBreadcrumb\n    ? (consoleSandbox(() => beforeBreadcrumb(mergedBreadcrumb, hint)) )\n    : mergedBreadcrumb;\n\n  if (finalBreadcrumb === null) return;\n\n  if (client.emit) {\n    client.emit('beforeAddBreadcrumb', finalBreadcrumb, hint);\n  }\n\n  isolationScope.addBreadcrumb(finalBreadcrumb, maxBreadcrumbs);\n}\n\nexport { addBreadcrumb };\n//# sourceMappingURL=breadcrumbs.js.map\n","import { getClient } from '../currentScopes.js';\nimport { defineIntegration } from '../integration.js';\nimport { getOriginalFunction } from '../utils-hoist/object.js';\n\nlet originalFunctionToString;\n\nconst INTEGRATION_NAME = 'FunctionToString';\n\nconst SETUP_CLIENTS = new WeakMap();\n\nconst _functionToStringIntegration = (() => {\n  return {\n    name: INTEGRATION_NAME,\n    setupOnce() {\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      originalFunctionToString = Function.prototype.toString;\n\n      // intrinsics (like Function.prototype) might be immutable in some environments\n      // e.g. Node with --frozen-intrinsics, XS (an embedded JavaScript engine) or SES (a JavaScript proposal)\n      try {\n        Function.prototype.toString = function ( ...args) {\n          const originalFunction = getOriginalFunction(this);\n          const context =\n            SETUP_CLIENTS.has(getClient() ) && originalFunction !== undefined ? originalFunction : this;\n          return originalFunctionToString.apply(context, args);\n        };\n      } catch {\n        // ignore errors here, just don't patch this\n      }\n    },\n    setup(client) {\n      SETUP_CLIENTS.set(client, true);\n    },\n  };\n}) ;\n\n/**\n * Patch toString calls to return proper name for wrapped functions.\n *\n * ```js\n * Sentry.init({\n *   integrations: [\n *     functionToStringIntegration(),\n *   ],\n * });\n * ```\n */\nconst functionToStringIntegration = defineIntegration(_functionToStringIntegration);\n\nexport { functionToStringIntegration };\n//# sourceMappingURL=functiontostring.js.map\n","import { DEBUG_BUILD } from '../debug-build.js';\nimport { defineIntegration } from '../integration.js';\nimport { logger } from '../utils-hoist/logger.js';\nimport { getEventDescription } from '../utils-hoist/misc.js';\nimport { stringMatchesSomePattern } from '../utils-hoist/string.js';\nimport { getPossibleEventMessages } from '../utils/eventUtils.js';\n\n// \"Script error.\" is hard coded into browsers for errors that it can't read.\n// this is the result of a script being pulled in from an external domain and CORS.\nconst DEFAULT_IGNORE_ERRORS = [\n  /^Script error\\.?$/,\n  /^Javascript error: Script error\\.? on line 0$/,\n  /^ResizeObserver loop completed with undelivered notifications.$/, // The browser logs this when a ResizeObserver handler takes a bit longer. Usually this is not an actual issue though. It indicates slowness.\n  /^Cannot redefine property: googletag$/, // This is thrown when google tag manager is used in combination with an ad blocker\n  /^Can't find variable: gmo$/, // Error from Google Search App https://issuetracker.google.com/issues/396043331\n  /^undefined is not an object \\(evaluating 'a\\.[A-Z]'\\)$/, // Random error that happens but not actionable or noticeable to end-users.\n  'can\\'t redefine non-configurable property \"solana\"', // Probably a browser extension or custom browser (Brave) throwing this error\n  \"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)\", // Error thrown by GTM, seemingly not affecting end-users\n  \"Can't find variable: _AutofillCallbackHandler\", // Unactionable error in instagram webview https://developers.facebook.com/community/threads/320013549791141/\n  /^Non-Error promise rejection captured with value: Object Not Found Matching Id:\\d+, MethodName:simulateEvent, ParamCount:\\d+$/, // unactionable error from CEFSharp, a .NET library that embeds chromium in .NET apps\n  /^Java exception was raised during method invocation$/, // error from Facebook Mobile browser (https://github.com/getsentry/sentry-javascript/issues/15065)\n];\n\n/** Options for the EventFilters integration */\n\nconst INTEGRATION_NAME = 'EventFilters';\n\n/**\n * An integration that filters out events (errors and transactions) based on:\n *\n * - (Errors) A curated list of known low-value or irrelevant errors (see {@link DEFAULT_IGNORE_ERRORS})\n * - (Errors) A list of error messages or urls/filenames passed in via\n *   - Top level Sentry.init options (`ignoreErrors`, `denyUrls`, `allowUrls`)\n *   - The same options passed to the integration directly via @param options\n * - (Transactions/Spans) A list of root span (transaction) names passed in via\n *   - Top level Sentry.init option (`ignoreTransactions`)\n *   - The same option passed to the integration directly via @param options\n *\n * Events filtered by this integration will not be sent to Sentry.\n */\nconst eventFiltersIntegration = defineIntegration((options = {}) => {\n  let mergedOptions;\n  return {\n    name: INTEGRATION_NAME,\n    setup(client) {\n      const clientOptions = client.getOptions();\n      mergedOptions = _mergeOptions(options, clientOptions);\n    },\n    processEvent(event, _hint, client) {\n      if (!mergedOptions) {\n        const clientOptions = client.getOptions();\n        mergedOptions = _mergeOptions(options, clientOptions);\n      }\n      return _shouldDropEvent(event, mergedOptions) ? null : event;\n    },\n  };\n});\n\n/**\n * An integration that filters out events (errors and transactions) based on:\n *\n * - (Errors) A curated list of known low-value or irrelevant errors (see {@link DEFAULT_IGNORE_ERRORS})\n * - (Errors) A list of error messages or urls/filenames passed in via\n *   - Top level Sentry.init options (`ignoreErrors`, `denyUrls`, `allowUrls`)\n *   - The same options passed to the integration directly via @param options\n * - (Transactions/Spans) A list of root span (transaction) names passed in via\n *   - Top level Sentry.init option (`ignoreTransactions`)\n *   - The same option passed to the integration directly via @param options\n *\n * Events filtered by this integration will not be sent to Sentry.\n *\n * @deprecated this integration was renamed and will be removed in a future major version.\n * Use `eventFiltersIntegration` instead.\n */\nconst inboundFiltersIntegration = defineIntegration(((options = {}) => {\n  return {\n    ...eventFiltersIntegration(options),\n    name: 'InboundFilters',\n  };\n}) );\n\nfunction _mergeOptions(\n  internalOptions = {},\n  clientOptions = {},\n) {\n  return {\n    allowUrls: [...(internalOptions.allowUrls || []), ...(clientOptions.allowUrls || [])],\n    denyUrls: [...(internalOptions.denyUrls || []), ...(clientOptions.denyUrls || [])],\n    ignoreErrors: [\n      ...(internalOptions.ignoreErrors || []),\n      ...(clientOptions.ignoreErrors || []),\n      ...(internalOptions.disableErrorDefaults ? [] : DEFAULT_IGNORE_ERRORS),\n    ],\n    ignoreTransactions: [...(internalOptions.ignoreTransactions || []), ...(clientOptions.ignoreTransactions || [])],\n  };\n}\n\nfunction _shouldDropEvent(event, options) {\n  if (!event.type) {\n    // Filter errors\n    if (_isIgnoredError(event, options.ignoreErrors)) {\n      DEBUG_BUILD &&\n        logger.warn(\n          `Event dropped due to being matched by \\`ignoreErrors\\` option.\\nEvent: ${getEventDescription(event)}`,\n        );\n      return true;\n    }\n    if (_isUselessError(event)) {\n      DEBUG_BUILD &&\n        logger.warn(\n          `Event dropped due to not having an error message, error type or stacktrace.\\nEvent: ${getEventDescription(\n            event,\n          )}`,\n        );\n      return true;\n    }\n    if (_isDeniedUrl(event, options.denyUrls)) {\n      DEBUG_BUILD &&\n        logger.warn(\n          `Event dropped due to being matched by \\`denyUrls\\` option.\\nEvent: ${getEventDescription(\n            event,\n          )}.\\nUrl: ${_getEventFilterUrl(event)}`,\n        );\n      return true;\n    }\n    if (!_isAllowedUrl(event, options.allowUrls)) {\n      DEBUG_BUILD &&\n        logger.warn(\n          `Event dropped due to not being matched by \\`allowUrls\\` option.\\nEvent: ${getEventDescription(\n            event,\n          )}.\\nUrl: ${_getEventFilterUrl(event)}`,\n        );\n      return true;\n    }\n  } else if (event.type === 'transaction') {\n    // Filter transactions\n\n    if (_isIgnoredTransaction(event, options.ignoreTransactions)) {\n      DEBUG_BUILD &&\n        logger.warn(\n          `Event dropped due to being matched by \\`ignoreTransactions\\` option.\\nEvent: ${getEventDescription(event)}`,\n        );\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction _isIgnoredError(event, ignoreErrors) {\n  if (!ignoreErrors?.length) {\n    return false;\n  }\n\n  return getPossibleEventMessages(event).some(message => stringMatchesSomePattern(message, ignoreErrors));\n}\n\nfunction _isIgnoredTransaction(event, ignoreTransactions) {\n  if (!ignoreTransactions?.length) {\n    return false;\n  }\n\n  const name = event.transaction;\n  return name ? stringMatchesSomePattern(name, ignoreTransactions) : false;\n}\n\nfunction _isDeniedUrl(event, denyUrls) {\n  if (!denyUrls?.length) {\n    return false;\n  }\n  const url = _getEventFilterUrl(event);\n  return !url ? false : stringMatchesSomePattern(url, denyUrls);\n}\n\nfunction _isAllowedUrl(event, allowUrls) {\n  if (!allowUrls?.length) {\n    return true;\n  }\n  const url = _getEventFilterUrl(event);\n  return !url ? true : stringMatchesSomePattern(url, allowUrls);\n}\n\nfunction _getLastValidUrl(frames = []) {\n  for (let i = frames.length - 1; i >= 0; i--) {\n    const frame = frames[i];\n\n    if (frame && frame.filename !== '<anonymous>' && frame.filename !== '[native code]') {\n      return frame.filename || null;\n    }\n  }\n\n  return null;\n}\n\nfunction _getEventFilterUrl(event) {\n  try {\n    // If there are linked exceptions or exception aggregates we only want to match against the top frame of the \"root\" (the main exception)\n    // The root always comes last in linked exceptions\n    const rootException = [...(event.exception?.values ?? [])]\n      .reverse()\n      .find(value => value.mechanism?.parent_id === undefined && value.stacktrace?.frames?.length);\n    const frames = rootException?.stacktrace?.frames;\n    return frames ? _getLastValidUrl(frames) : null;\n  } catch (oO) {\n    DEBUG_BUILD && logger.error(`Cannot extract url for event ${getEventDescription(event)}`);\n    return null;\n  }\n}\n\nfunction _isUselessError(event) {\n  // We only want to consider events for dropping that actually have recorded exception values.\n  if (!event.exception?.values?.length) {\n    return false;\n  }\n\n  return (\n    // No top-level message\n    !event.message &&\n    // There are no exception values that have a stacktrace, a non-generic-Error type or value\n    !event.exception.values.some(value => value.stacktrace || (value.type && value.type !== 'Error') || value.value)\n  );\n}\n\nexport { eventFiltersIntegration, inboundFiltersIntegration };\n//# sourceMappingURL=eventFilters.js.map\n","import { isInstanceOf } from './is.js';\n\n/**\n * Creates exceptions inside `event.exception.values` for errors that are nested on properties based on the `key` parameter.\n */\nfunction applyAggregateErrorsToEvent(\n  exceptionFromErrorImplementation,\n  parser,\n  key,\n  limit,\n  event,\n  hint,\n) {\n  if (!event.exception?.values || !hint || !isInstanceOf(hint.originalException, Error)) {\n    return;\n  }\n\n  // Generally speaking the last item in `event.exception.values` is the exception originating from the original Error\n  const originalException =\n    event.exception.values.length > 0 ? event.exception.values[event.exception.values.length - 1] : undefined;\n\n  // We only create exception grouping if there is an exception in the event.\n  if (originalException) {\n    event.exception.values = aggregateExceptionsFromError(\n      exceptionFromErrorImplementation,\n      parser,\n      limit,\n      hint.originalException ,\n      key,\n      event.exception.values,\n      originalException,\n      0,\n    );\n  }\n}\n\nfunction aggregateExceptionsFromError(\n  exceptionFromErrorImplementation,\n  parser,\n  limit,\n  error,\n  key,\n  prevExceptions,\n  exception,\n  exceptionId,\n) {\n  if (prevExceptions.length >= limit + 1) {\n    return prevExceptions;\n  }\n\n  let newExceptions = [...prevExceptions];\n\n  // Recursively call this function in order to walk down a chain of errors\n  if (isInstanceOf(error[key], Error)) {\n    applyExceptionGroupFieldsForParentException(exception, exceptionId);\n    const newException = exceptionFromErrorImplementation(parser, error[key]);\n    const newExceptionId = newExceptions.length;\n    applyExceptionGroupFieldsForChildException(newException, key, newExceptionId, exceptionId);\n    newExceptions = aggregateExceptionsFromError(\n      exceptionFromErrorImplementation,\n      parser,\n      limit,\n      error[key],\n      key,\n      [newException, ...newExceptions],\n      newException,\n      newExceptionId,\n    );\n  }\n\n  // This will create exception grouping for AggregateErrors\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AggregateError\n  if (Array.isArray(error.errors)) {\n    error.errors.forEach((childError, i) => {\n      if (isInstanceOf(childError, Error)) {\n        applyExceptionGroupFieldsForParentException(exception, exceptionId);\n        const newException = exceptionFromErrorImplementation(parser, childError);\n        const newExceptionId = newExceptions.length;\n        applyExceptionGroupFieldsForChildException(newException, `errors[${i}]`, newExceptionId, exceptionId);\n        newExceptions = aggregateExceptionsFromError(\n          exceptionFromErrorImplementation,\n          parser,\n          limit,\n          childError,\n          key,\n          [newException, ...newExceptions],\n          newException,\n          newExceptionId,\n        );\n      }\n    });\n  }\n\n  return newExceptions;\n}\n\nfunction applyExceptionGroupFieldsForParentException(exception, exceptionId) {\n  // Don't know if this default makes sense. The protocol requires us to set these values so we pick *some* default.\n  exception.mechanism = exception.mechanism || { type: 'generic', handled: true };\n\n  exception.mechanism = {\n    ...exception.mechanism,\n    ...(exception.type === 'AggregateError' && { is_exception_group: true }),\n    exception_id: exceptionId,\n  };\n}\n\nfunction applyExceptionGroupFieldsForChildException(\n  exception,\n  source,\n  exceptionId,\n  parentId,\n) {\n  // Don't know if this default makes sense. The protocol requires us to set these values so we pick *some* default.\n  exception.mechanism = exception.mechanism || { type: 'generic', handled: true };\n\n  exception.mechanism = {\n    ...exception.mechanism,\n    type: 'chained',\n    source,\n    exception_id: exceptionId,\n    parent_id: parentId,\n  };\n}\n\nexport { applyAggregateErrorsToEvent };\n//# sourceMappingURL=aggregate-errors.js.map\n","import { CONSOLE_LEVELS, originalConsoleMethods } from '../logger.js';\nimport { fill } from '../object.js';\nimport { GLOBAL_OBJ } from '../worldwide.js';\nimport { addHandler, maybeInstrument, triggerHandlers } from './handlers.js';\n\n/**\n * Add an instrumentation handler for when a console.xxx method is called.\n *\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nfunction addConsoleInstrumentationHandler(handler) {\n  const type = 'console';\n  addHandler(type, handler);\n  maybeInstrument(type, instrumentConsole);\n}\n\nfunction instrumentConsole() {\n  if (!('console' in GLOBAL_OBJ)) {\n    return;\n  }\n\n  CONSOLE_LEVELS.forEach(function (level) {\n    if (!(level in GLOBAL_OBJ.console)) {\n      return;\n    }\n\n    fill(GLOBAL_OBJ.console, level, function (originalConsoleMethod) {\n      originalConsoleMethods[level] = originalConsoleMethod;\n\n      return function (...args) {\n        const handlerData = { args, level };\n        triggerHandlers('console', handlerData);\n\n        const log = originalConsoleMethods[level];\n        log?.apply(GLOBAL_OBJ.console, args);\n      };\n    });\n  });\n}\n\nexport { addConsoleInstrumentationHandler };\n//# sourceMappingURL=console.js.map\n","/**\n * Converts a string-based level into a `SeverityLevel`, normalizing it along the way.\n *\n * @param level String representation of desired `SeverityLevel`.\n * @returns The `SeverityLevel` corresponding to the given string, or 'log' if the string isn't a valid level.\n */\nfunction severityLevelFromString(level) {\n  return (\n    level === 'warn' ? 'warning' : ['fatal', 'error', 'warning', 'log', 'info', 'debug'].includes(level) ? level : 'log'\n  ) ;\n}\n\nexport { severityLevelFromString };\n//# sourceMappingURL=severity.js.map\n","import { defineIntegration } from '../integration.js';\nimport { DEBUG_BUILD } from '../debug-build.js';\nimport { logger } from '../utils-hoist/logger.js';\nimport { getFramesFromEvent } from '../utils-hoist/stacktrace.js';\n\nconst INTEGRATION_NAME = 'Dedupe';\n\nconst _dedupeIntegration = (() => {\n  let previousEvent;\n\n  return {\n    name: INTEGRATION_NAME,\n    processEvent(currentEvent) {\n      // We want to ignore any non-error type events, e.g. transactions or replays\n      // These should never be deduped, and also not be compared against as _previousEvent.\n      if (currentEvent.type) {\n        return currentEvent;\n      }\n\n      // Juuust in case something goes wrong\n      try {\n        if (_shouldDropEvent(currentEvent, previousEvent)) {\n          DEBUG_BUILD && logger.warn('Event dropped due to being a duplicate of previously captured event.');\n          return null;\n        }\n      } catch (_oO) {} // eslint-disable-line no-empty\n\n      return (previousEvent = currentEvent);\n    },\n  };\n}) ;\n\n/**\n * Deduplication filter.\n */\nconst dedupeIntegration = defineIntegration(_dedupeIntegration);\n\n/** only exported for tests. */\nfunction _shouldDropEvent(currentEvent, previousEvent) {\n  if (!previousEvent) {\n    return false;\n  }\n\n  if (_isSameMessageEvent(currentEvent, previousEvent)) {\n    return true;\n  }\n\n  if (_isSameExceptionEvent(currentEvent, previousEvent)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction _isSameMessageEvent(currentEvent, previousEvent) {\n  const currentMessage = currentEvent.message;\n  const previousMessage = previousEvent.message;\n\n  // If neither event has a message property, they were both exceptions, so bail out\n  if (!currentMessage && !previousMessage) {\n    return false;\n  }\n\n  // If only one event has a stacktrace, but not the other one, they are not the same\n  if ((currentMessage && !previousMessage) || (!currentMessage && previousMessage)) {\n    return false;\n  }\n\n  if (currentMessage !== previousMessage) {\n    return false;\n  }\n\n  if (!_isSameFingerprint(currentEvent, previousEvent)) {\n    return false;\n  }\n\n  if (!_isSameStacktrace(currentEvent, previousEvent)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction _isSameExceptionEvent(currentEvent, previousEvent) {\n  const previousException = _getExceptionFromEvent(previousEvent);\n  const currentException = _getExceptionFromEvent(currentEvent);\n\n  if (!previousException || !currentException) {\n    return false;\n  }\n\n  if (previousException.type !== currentException.type || previousException.value !== currentException.value) {\n    return false;\n  }\n\n  if (!_isSameFingerprint(currentEvent, previousEvent)) {\n    return false;\n  }\n\n  if (!_isSameStacktrace(currentEvent, previousEvent)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction _isSameStacktrace(currentEvent, previousEvent) {\n  let currentFrames = getFramesFromEvent(currentEvent);\n  let previousFrames = getFramesFromEvent(previousEvent);\n\n  // If neither event has a stacktrace, they are assumed to be the same\n  if (!currentFrames && !previousFrames) {\n    return true;\n  }\n\n  // If only one event has a stacktrace, but not the other one, they are not the same\n  if ((currentFrames && !previousFrames) || (!currentFrames && previousFrames)) {\n    return false;\n  }\n\n  currentFrames = currentFrames ;\n  previousFrames = previousFrames ;\n\n  // If number of frames differ, they are not the same\n  if (previousFrames.length !== currentFrames.length) {\n    return false;\n  }\n\n  // Otherwise, compare the two\n  for (let i = 0; i < previousFrames.length; i++) {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const frameA = previousFrames[i];\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const frameB = currentFrames[i];\n\n    if (\n      frameA.filename !== frameB.filename ||\n      frameA.lineno !== frameB.lineno ||\n      frameA.colno !== frameB.colno ||\n      frameA.function !== frameB.function\n    ) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction _isSameFingerprint(currentEvent, previousEvent) {\n  let currentFingerprint = currentEvent.fingerprint;\n  let previousFingerprint = previousEvent.fingerprint;\n\n  // If neither event has a fingerprint, they are assumed to be the same\n  if (!currentFingerprint && !previousFingerprint) {\n    return true;\n  }\n\n  // If only one event has a fingerprint, but not the other one, they are not the same\n  if ((currentFingerprint && !previousFingerprint) || (!currentFingerprint && previousFingerprint)) {\n    return false;\n  }\n\n  currentFingerprint = currentFingerprint ;\n  previousFingerprint = previousFingerprint ;\n\n  // Otherwise, compare the two\n  try {\n    return !!(currentFingerprint.join('') === previousFingerprint.join(''));\n  } catch (_oO) {\n    return false;\n  }\n}\n\nfunction _getExceptionFromEvent(event) {\n  return event.exception?.values && event.exception.values[0];\n}\n\nexport { _shouldDropEvent, dedupeIntegration };\n//# sourceMappingURL=dedupe.js.map\n","// Curious about `thismessage:/`? See: https://www.rfc-editor.org/rfc/rfc2557.html\n//  > When the methods above do not yield an absolute URI, a base URL\n//  > of \"thismessage:/\" MUST be employed. This base URL has been\n//  > defined for the sole purpose of resolving relative references\n//  > within a multipart/related structure when no other base URI is\n//  > specified.\n//\n// We need to provide a base URL to `parseStringToURLObject` because the fetch API gives us a\n// relative URL sometimes.\n//\n// This is the only case where we need to provide a base URL to `parseStringToURLObject`\n// because the relative URL is not valid on its own.\nconst DEFAULT_BASE_URL = 'thismessage:/';\n\n/**\n * Checks if the URL object is relative\n *\n * @param url - The URL object to check\n * @returns True if the URL object is relative, false otherwise\n */\nfunction isURLObjectRelative(url) {\n  return 'isRelative' in url;\n}\n\n/**\n * Parses string to a URL object\n *\n * @param url - The URL to parse\n * @returns The parsed URL object or undefined if the URL is invalid\n */\nfunction parseStringToURLObject(url, urlBase) {\n  const isRelative = url.startsWith('/');\n  const base = urlBase ?? (isRelative ? DEFAULT_BASE_URL : undefined);\n  try {\n    // Use `canParse` to short-circuit the URL constructor if it's not a valid URL\n    // This is faster than trying to construct the URL and catching the error\n    // Node 20+, Chrome 120+, Firefox 115+, Safari 17+\n    if ('canParse' in URL && !(URL ).canParse(url, base)) {\n      return undefined;\n    }\n\n    const fullUrlObject = new URL(url, base);\n    if (isRelative) {\n      // Because we used a fake base URL, we need to return a relative URL object.\n      // We cannot return anything about the origin, host, etc. because it will refer to the fake base URL.\n      return {\n        isRelative,\n        pathname: fullUrlObject.pathname,\n        search: fullUrlObject.search,\n        hash: fullUrlObject.hash,\n      };\n    }\n    return fullUrlObject;\n  } catch {\n    // empty body\n  }\n\n  return undefined;\n}\n\n/**\n * Takes a URL object and returns a sanitized string which is safe to use as span name\n * see: https://develop.sentry.dev/sdk/data-handling/#structuring-data\n */\nfunction getSanitizedUrlStringFromUrlObject(url) {\n  if (isURLObjectRelative(url)) {\n    return url.pathname;\n  }\n\n  const newUrl = new URL(url);\n  newUrl.search = '';\n  newUrl.hash = '';\n  if (['80', '443'].includes(newUrl.port)) {\n    newUrl.port = '';\n  }\n  if (newUrl.password) {\n    newUrl.password = '%filtered%';\n  }\n  if (newUrl.username) {\n    newUrl.username = '%filtered%';\n  }\n\n  return newUrl.toString();\n}\n\n/**\n * Parses string form of URL into an object\n * // borrowed from https://tools.ietf.org/html/rfc3986#appendix-B\n * // intentionally using regex and not <a/> href parsing trick because React Native and other\n * // environments where DOM might not be available\n * @returns parsed URL object\n */\nfunction parseUrl(url) {\n  if (!url) {\n    return {};\n  }\n\n  const match = url.match(/^(([^:/?#]+):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$/);\n\n  if (!match) {\n    return {};\n  }\n\n  // coerce to undefined values to empty string so we don't get 'undefined'\n  const query = match[6] || '';\n  const fragment = match[8] || '';\n  return {\n    host: match[4],\n    path: match[5],\n    protocol: match[2],\n    search: query,\n    hash: fragment,\n    relative: match[5] + query + fragment, // everything minus origin\n  };\n}\n\n/**\n * Strip the query string and fragment off of a given URL or path (if present)\n *\n * @param urlPath Full URL or path, including possible query string and/or fragment\n * @returns URL or path without query string or fragment\n */\nfunction stripUrlQueryAndFragment(urlPath) {\n  return (urlPath.split(/[?#]/, 1) )[0];\n}\n\n/**\n * Takes a URL object and returns a sanitized string which is safe to use as span name\n * see: https://develop.sentry.dev/sdk/data-handling/#structuring-data\n */\nfunction getSanitizedUrlString(url) {\n  const { protocol, host, path } = url;\n\n  const filteredHost =\n    host\n      // Always filter out authority\n      ?.replace(/^.*@/, '[filtered]:[filtered]@')\n      // Don't show standard :80 (http) and :443 (https) ports to reduce the noise\n      // TODO: Use new URL global if it exists\n      .replace(/(:80)$/, '')\n      .replace(/(:443)$/, '') || '';\n\n  return `${protocol ? `${protocol}://` : ''}${filteredHost}${path}`;\n}\n\nexport { getSanitizedUrlString, getSanitizedUrlStringFromUrlObject, isURLObjectRelative, parseStringToURLObject, parseUrl, stripUrlQueryAndFragment };\n//# sourceMappingURL=url.js.map\n","/**\n * Determine a breadcrumb's log level (only `warning` or `error`) based on an HTTP status code.\n */\nfunction getBreadcrumbLogLevelFromHttpStatusCode(statusCode) {\n  // NOTE: undefined defaults to 'info' in Sentry\n  if (statusCode === undefined) {\n    return undefined;\n  } else if (statusCode >= 400 && statusCode < 500) {\n    return 'warning';\n  } else if (statusCode >= 500) {\n    return 'error';\n  } else {\n    return undefined;\n  }\n}\n\nexport { getBreadcrumbLogLevelFromHttpStatusCode };\n//# sourceMappingURL=breadcrumb-log-level.js.map\n","import { DEBUG_BUILD } from './debug-build.js';\nimport { logger } from './logger.js';\nimport { GLOBAL_OBJ } from './worldwide.js';\n\nconst WINDOW = GLOBAL_OBJ ;\n\n/**\n * Tells whether current environment supports ErrorEvent objects\n * {@link supportsErrorEvent}.\n *\n * @returns Answer to the given question.\n */\nfunction supportsErrorEvent() {\n  try {\n    new ErrorEvent('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports DOMError objects\n * {@link supportsDOMError}.\n *\n * @returns Answer to the given question.\n */\nfunction supportsDOMError() {\n  try {\n    // Chrome: VM89:1 Uncaught TypeError: Failed to construct 'DOMError':\n    // 1 argument required, but only 0 present.\n    // @ts-expect-error It really needs 1 argument, not 0.\n    new DOMError('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports DOMException objects\n * {@link supportsDOMException}.\n *\n * @returns Answer to the given question.\n */\nfunction supportsDOMException() {\n  try {\n    new DOMException('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports History API\n * {@link supportsHistory}.\n *\n * @returns Answer to the given question.\n */\nfunction supportsHistory() {\n  return 'history' in WINDOW && !!WINDOW.history;\n}\n\n/**\n * Tells whether current environment supports Fetch API\n * {@link supportsFetch}.\n *\n * @returns Answer to the given question.\n */\nfunction supportsFetch() {\n  if (!('fetch' in WINDOW)) {\n    return false;\n  }\n\n  try {\n    new Headers();\n    new Request('http://www.example.com');\n    new Response();\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * isNative checks if the given function is a native implementation\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction isNativeFunction(func) {\n  return func && /^function\\s+\\w+\\(\\)\\s+\\{\\s+\\[native code\\]\\s+\\}$/.test(func.toString());\n}\n\n/**\n * Tells whether current environment supports Fetch API natively\n * {@link supportsNativeFetch}.\n *\n * @returns true if `window.fetch` is natively implemented, false otherwise\n */\nfunction supportsNativeFetch() {\n  if (typeof EdgeRuntime === 'string') {\n    return true;\n  }\n\n  if (!supportsFetch()) {\n    return false;\n  }\n\n  // Fast path to avoid DOM I/O\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  if (isNativeFunction(WINDOW.fetch)) {\n    return true;\n  }\n\n  // window.fetch is implemented, but is polyfilled or already wrapped (e.g: by a chrome extension)\n  // so create a \"pure\" iframe to see if that has native fetch\n  let result = false;\n  const doc = WINDOW.document;\n  // eslint-disable-next-line deprecation/deprecation\n  if (doc && typeof (doc.createElement ) === 'function') {\n    try {\n      const sandbox = doc.createElement('iframe');\n      sandbox.hidden = true;\n      doc.head.appendChild(sandbox);\n      if (sandbox.contentWindow?.fetch) {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        result = isNativeFunction(sandbox.contentWindow.fetch);\n      }\n      doc.head.removeChild(sandbox);\n    } catch (err) {\n      DEBUG_BUILD &&\n        logger.warn('Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ', err);\n    }\n  }\n\n  return result;\n}\n\n/**\n * Tells whether current environment supports ReportingObserver API\n * {@link supportsReportingObserver}.\n *\n * @returns Answer to the given question.\n */\nfunction supportsReportingObserver() {\n  return 'ReportingObserver' in WINDOW;\n}\n\n/**\n * Tells whether current environment supports Referrer Policy API\n * {@link supportsReferrerPolicy}.\n *\n * @returns Answer to the given question.\n */\nfunction supportsReferrerPolicy() {\n  // Despite all stars in the sky saying that Edge supports old draft syntax, aka 'never', 'always', 'origin' and 'default'\n  // (see https://caniuse.com/#feat=referrer-policy),\n  // it doesn't. And it throws an exception instead of ignoring this parameter...\n  // REF: https://github.com/getsentry/raven-js/issues/1233\n\n  if (!supportsFetch()) {\n    return false;\n  }\n\n  try {\n    new Request('_', {\n      referrerPolicy: 'origin' ,\n    });\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nexport { isNativeFunction, supportsDOMError, supportsDOMException, supportsErrorEvent, supportsFetch, supportsHistory, supportsNativeFetch, supportsReferrerPolicy, supportsReportingObserver };\n//# sourceMappingURL=supports.js.map\n","import { isError, isRequest } from '../is.js';\nimport { fill, addNonEnumerableProperty } from '../object.js';\nimport { supportsNativeFetch } from '../supports.js';\nimport { timestampInSeconds } from '../time.js';\nimport { GLOBAL_OBJ } from '../worldwide.js';\nimport { addHandler, maybeInstrument, triggerHandlers } from './handlers.js';\n\n/**\n * Add an instrumentation handler for when a fetch request happens.\n * The handler function is called once when the request starts and once when it ends,\n * which can be identified by checking if it has an `endTimestamp`.\n *\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nfunction addFetchInstrumentationHandler(\n  handler,\n  skipNativeFetchCheck,\n) {\n  const type = 'fetch';\n  addHandler(type, handler);\n  maybeInstrument(type, () => instrumentFetch(undefined, skipNativeFetchCheck));\n}\n\n/**\n * Add an instrumentation handler for long-lived fetch requests, like consuming server-sent events (SSE) via fetch.\n * The handler will resolve the request body and emit the actual `endTimestamp`, so that the\n * span can be updated accordingly.\n *\n * Only used internally\n * @hidden\n */\nfunction addFetchEndInstrumentationHandler(handler) {\n  const type = 'fetch-body-resolved';\n  addHandler(type, handler);\n  maybeInstrument(type, () => instrumentFetch(streamHandler));\n}\n\nfunction instrumentFetch(onFetchResolved, skipNativeFetchCheck = false) {\n  if (skipNativeFetchCheck && !supportsNativeFetch()) {\n    return;\n  }\n\n  fill(GLOBAL_OBJ, 'fetch', function (originalFetch) {\n    return function (...args) {\n      // We capture the error right here and not in the Promise error callback because Safari (and probably other\n      // browsers too) will wipe the stack trace up to this point, only leaving us with this file which is useless.\n\n      // NOTE: If you are a Sentry user, and you are seeing this stack frame,\n      //       it means the error, that was caused by your fetch call did not\n      //       have a stack trace, so the SDK backfilled the stack trace so\n      //       you can see which fetch call failed.\n      const virtualError = new Error();\n\n      const { method, url } = parseFetchArgs(args);\n      const handlerData = {\n        args,\n        fetchData: {\n          method,\n          url,\n        },\n        startTimestamp: timestampInSeconds() * 1000,\n        // // Adding the error to be able to fingerprint the failed fetch event in HttpClient instrumentation\n        virtualError,\n        headers: getHeadersFromFetchArgs(args),\n      };\n\n      // if there is no callback, fetch is instrumented directly\n      if (!onFetchResolved) {\n        triggerHandlers('fetch', {\n          ...handlerData,\n        });\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      return originalFetch.apply(GLOBAL_OBJ, args).then(\n        async (response) => {\n          if (onFetchResolved) {\n            onFetchResolved(response);\n          } else {\n            triggerHandlers('fetch', {\n              ...handlerData,\n              endTimestamp: timestampInSeconds() * 1000,\n              response,\n            });\n          }\n\n          return response;\n        },\n        (error) => {\n          triggerHandlers('fetch', {\n            ...handlerData,\n            endTimestamp: timestampInSeconds() * 1000,\n            error,\n          });\n\n          if (isError(error) && error.stack === undefined) {\n            // NOTE: If you are a Sentry user, and you are seeing this stack frame,\n            //       it means the error, that was caused by your fetch call did not\n            //       have a stack trace, so the SDK backfilled the stack trace so\n            //       you can see which fetch call failed.\n            error.stack = virtualError.stack;\n            addNonEnumerableProperty(error, 'framesToPop', 1);\n          }\n\n          // We enhance the not-so-helpful \"Failed to fetch\" error messages with the host\n          // Possible messages we handle here:\n          // * \"Failed to fetch\" (chromium)\n          // * \"Load failed\" (webkit)\n          // * \"NetworkError when attempting to fetch resource.\" (firefox)\n          if (\n            error instanceof TypeError &&\n            (error.message === 'Failed to fetch' ||\n              error.message === 'Load failed' ||\n              error.message === 'NetworkError when attempting to fetch resource.')\n          ) {\n            try {\n              const url = new URL(handlerData.fetchData.url);\n              error.message = `${error.message} (${url.host})`;\n            } catch {\n              // ignore it if errors happen here\n            }\n          }\n\n          // NOTE: If you are a Sentry user, and you are seeing this stack frame,\n          //       it means the sentry.javascript SDK caught an error invoking your application code.\n          //       This is expected behavior and NOT indicative of a bug with sentry.javascript.\n          throw error;\n        },\n      );\n    };\n  });\n}\n\nasync function resolveResponse(res, onFinishedResolving) {\n  if (res?.body) {\n    const body = res.body;\n    const responseReader = body.getReader();\n\n    // Define a maximum duration after which we just cancel\n    const maxFetchDurationTimeout = setTimeout(\n      () => {\n        body.cancel().then(null, () => {\n          // noop\n        });\n      },\n      90 * 1000, // 90s\n    );\n\n    let readingActive = true;\n    while (readingActive) {\n      let chunkTimeout;\n      try {\n        // abort reading if read op takes more than 5s\n        chunkTimeout = setTimeout(() => {\n          body.cancel().then(null, () => {\n            // noop on error\n          });\n        }, 5000);\n\n        // This .read() call will reject/throw when we abort due to timeouts through `body.cancel()`\n        const { done } = await responseReader.read();\n\n        clearTimeout(chunkTimeout);\n\n        if (done) {\n          onFinishedResolving();\n          readingActive = false;\n        }\n      } catch (error) {\n        readingActive = false;\n      } finally {\n        clearTimeout(chunkTimeout);\n      }\n    }\n\n    clearTimeout(maxFetchDurationTimeout);\n\n    responseReader.releaseLock();\n    body.cancel().then(null, () => {\n      // noop on error\n    });\n  }\n}\n\nfunction streamHandler(response) {\n  // clone response for awaiting stream\n  let clonedResponseForResolving;\n  try {\n    clonedResponseForResolving = response.clone();\n  } catch {\n    return;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-floating-promises\n  resolveResponse(clonedResponseForResolving, () => {\n    triggerHandlers('fetch-body-resolved', {\n      endTimestamp: timestampInSeconds() * 1000,\n      response,\n    });\n  });\n}\n\nfunction hasProp(obj, prop) {\n  return !!obj && typeof obj === 'object' && !!(obj )[prop];\n}\n\nfunction getUrlFromResource(resource) {\n  if (typeof resource === 'string') {\n    return resource;\n  }\n\n  if (!resource) {\n    return '';\n  }\n\n  if (hasProp(resource, 'url')) {\n    return resource.url;\n  }\n\n  if (resource.toString) {\n    return resource.toString();\n  }\n\n  return '';\n}\n\n/**\n * Parses the fetch arguments to find the used Http method and the url of the request.\n * Exported for tests only.\n */\nfunction parseFetchArgs(fetchArgs) {\n  if (fetchArgs.length === 0) {\n    return { method: 'GET', url: '' };\n  }\n\n  if (fetchArgs.length === 2) {\n    const [url, options] = fetchArgs ;\n\n    return {\n      url: getUrlFromResource(url),\n      method: hasProp(options, 'method') ? String(options.method).toUpperCase() : 'GET',\n    };\n  }\n\n  const arg = fetchArgs[0];\n  return {\n    url: getUrlFromResource(arg ),\n    method: hasProp(arg, 'method') ? String(arg.method).toUpperCase() : 'GET',\n  };\n}\n\nfunction getHeadersFromFetchArgs(fetchArgs) {\n  const [requestArgument, optionsArgument] = fetchArgs;\n\n  try {\n    if (\n      typeof optionsArgument === 'object' &&\n      optionsArgument !== null &&\n      'headers' in optionsArgument &&\n      optionsArgument.headers\n    ) {\n      return new Headers(optionsArgument.headers );\n    }\n\n    if (isRequest(requestArgument)) {\n      return new Headers(requestArgument.headers);\n    }\n  } catch {\n    // noop\n  }\n\n  return;\n}\n\nexport { addFetchEndInstrumentationHandler, addFetchInstrumentationHandler, parseFetchArgs };\n//# sourceMappingURL=fetch.js.map\n","import { GLOBAL_OBJ, getOriginalFunction, markFunctionWrapped, addNonEnumerableProperty, withScope, addExceptionTypeValue, addExceptionMechanism, captureException } from '@sentry/core';\n\nconst WINDOW = GLOBAL_OBJ ;\n\nlet ignoreOnError = 0;\n\n/**\n * @hidden\n */\nfunction shouldIgnoreOnError() {\n  return ignoreOnError > 0;\n}\n\n/**\n * @hidden\n */\nfunction ignoreNextOnError() {\n  // onerror should trigger before setTimeout\n  ignoreOnError++;\n  setTimeout(() => {\n    ignoreOnError--;\n  });\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\n\n/**\n * Instruments the given function and sends an event to Sentry every time the\n * function throws an exception.\n *\n * @param fn A function to wrap. It is generally safe to pass an unbound function, because the returned wrapper always\n * has a correct `this` context.\n * @returns The wrapped function.\n * @hidden\n */\nfunction wrap(\n  fn,\n  options\n\n = {},\n) {\n  // for future readers what this does is wrap a function and then create\n  // a bi-directional wrapping between them.\n  //\n  // example: wrapped = wrap(original);\n  //  original.__sentry_wrapped__ -> wrapped\n  //  wrapped.__sentry_original__ -> original\n\n  function isFunction(fn) {\n    return typeof fn === 'function';\n  }\n\n  if (!isFunction(fn)) {\n    return fn;\n  }\n\n  try {\n    // if we're dealing with a function that was previously wrapped, return\n    // the original wrapper.\n    const wrapper = (fn ).__sentry_wrapped__;\n    if (wrapper) {\n      if (typeof wrapper === 'function') {\n        return wrapper;\n      } else {\n        // If we find that the `__sentry_wrapped__` function is not a function at the time of accessing it, it means\n        // that something messed with it. In that case we want to return the originally passed function.\n        return fn;\n      }\n    }\n\n    // We don't wanna wrap it twice\n    if (getOriginalFunction(fn)) {\n      return fn;\n    }\n  } catch (e) {\n    // Just accessing custom props in some Selenium environments\n    // can cause a \"Permission denied\" exception (see raven-js#495).\n    // Bail on wrapping and return the function as-is (defers to window.onerror).\n    return fn;\n  }\n\n  // Wrap the function itself\n  // It is important that `sentryWrapped` is not an arrow function to preserve the context of `this`\n  const sentryWrapped = function ( ...args) {\n    try {\n      // Also wrap arguments that are themselves functions\n      const wrappedArguments = args.map(arg => wrap(arg, options));\n\n      // Attempt to invoke user-land function\n      // NOTE: If you are a Sentry user, and you are seeing this stack frame, it\n      //       means the sentry.javascript SDK caught an error invoking your application code. This\n      //       is expected behavior and NOT indicative of a bug with sentry.javascript.\n      return fn.apply(this, wrappedArguments);\n    } catch (ex) {\n      ignoreNextOnError();\n\n      withScope(scope => {\n        scope.addEventProcessor(event => {\n          if (options.mechanism) {\n            addExceptionTypeValue(event, undefined, undefined);\n            addExceptionMechanism(event, options.mechanism);\n          }\n\n          event.extra = {\n            ...event.extra,\n            arguments: args,\n          };\n\n          return event;\n        });\n\n        captureException(ex);\n      });\n\n      throw ex;\n    }\n  } ;\n\n  // Wrap the wrapped function in a proxy, to ensure any other properties of the original function remain available\n  try {\n    for (const property in fn) {\n      if (Object.prototype.hasOwnProperty.call(fn, property)) {\n        sentryWrapped[property ] = fn[property ];\n      }\n    }\n  } catch {\n    // Accessing some objects may throw\n    // ref: https://github.com/getsentry/sentry-javascript/issues/1168\n  }\n\n  // Signal that this function has been wrapped/filled already\n  // for both debugging and to prevent it to being wrapped/filled twice\n  markFunctionWrapped(sentryWrapped, fn);\n\n  addNonEnumerableProperty(fn, '__sentry_wrapped__', sentryWrapped);\n\n  // Restore original function name (not all browsers allow that)\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const descriptor = Object.getOwnPropertyDescriptor(sentryWrapped, 'name');\n    if (descriptor.configurable) {\n      Object.defineProperty(sentryWrapped, 'name', {\n        get() {\n          return fn.name;\n        },\n      });\n    }\n  } catch {\n    // This may throw if e.g. the descriptor does not exist, or a browser does not allow redefining `name`.\n    // to save some bytes we simply try-catch this\n  }\n\n  return sentryWrapped;\n}\n\nexport { WINDOW, ignoreNextOnError, shouldIgnoreOnError, wrap };\n//# sourceMappingURL=helpers.js.map\n","import { isErrorEvent, isDOMError, isDOMException, addExceptionTypeValue, isError, isPlainObject, isEvent, addExceptionMechanism, isParameterizedString, getClient, normalizeToSize, extractExceptionKeysForMessage, resolvedSyncPromise } from '@sentry/core';\n\n/**\n * This function creates an exception from a JavaScript Error\n */\nfunction exceptionFromError(stackParser, ex) {\n  // Get the frames first since Opera can lose the stack if we touch anything else first\n  const frames = parseStackFrames(stackParser, ex);\n\n  const exception = {\n    type: extractType(ex),\n    value: extractMessage(ex),\n  };\n\n  if (frames.length) {\n    exception.stacktrace = { frames };\n  }\n\n  if (exception.type === undefined && exception.value === '') {\n    exception.value = 'Unrecoverable error caught';\n  }\n\n  return exception;\n}\n\nfunction eventFromPlainObject(\n  stackParser,\n  exception,\n  syntheticException,\n  isUnhandledRejection,\n) {\n  const client = getClient();\n  const normalizeDepth = client?.getOptions().normalizeDepth;\n\n  // If we can, we extract an exception from the object properties\n  const errorFromProp = getErrorPropertyFromObject(exception);\n\n  const extra = {\n    __serialized__: normalizeToSize(exception, normalizeDepth),\n  };\n\n  if (errorFromProp) {\n    return {\n      exception: {\n        values: [exceptionFromError(stackParser, errorFromProp)],\n      },\n      extra,\n    };\n  }\n\n  const event = {\n    exception: {\n      values: [\n        {\n          type: isEvent(exception) ? exception.constructor.name : isUnhandledRejection ? 'UnhandledRejection' : 'Error',\n          value: getNonErrorObjectExceptionValue(exception, { isUnhandledRejection }),\n        } ,\n      ],\n    },\n    extra,\n  } ;\n\n  if (syntheticException) {\n    const frames = parseStackFrames(stackParser, syntheticException);\n    if (frames.length) {\n      // event.exception.values[0] has been set above\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      event.exception.values[0].stacktrace = { frames };\n    }\n  }\n\n  return event;\n}\n\nfunction eventFromError(stackParser, ex) {\n  return {\n    exception: {\n      values: [exceptionFromError(stackParser, ex)],\n    },\n  };\n}\n\n/** Parses stack frames from an error */\nfunction parseStackFrames(\n  stackParser,\n  ex,\n) {\n  // Access and store the stacktrace property before doing ANYTHING\n  // else to it because Opera is not very good at providing it\n  // reliably in other circumstances.\n  const stacktrace = ex.stacktrace || ex.stack || '';\n\n  const skipLines = getSkipFirstStackStringLines(ex);\n  const framesToPop = getPopFirstTopFrames(ex);\n\n  try {\n    return stackParser(stacktrace, skipLines, framesToPop);\n  } catch (e) {\n    // no-empty\n  }\n\n  return [];\n}\n\n// Based on our own mapping pattern - https://github.com/getsentry/sentry/blob/9f08305e09866c8bd6d0c24f5b0aabdd7dd6c59c/src/sentry/lang/javascript/errormapping.py#L83-L108\nconst reactMinifiedRegexp = /Minified React error #\\d+;/i;\n\n/**\n * Certain known React errors contain links that would be falsely\n * parsed as frames. This function check for these errors and\n * returns number of the stack string lines to skip.\n */\nfunction getSkipFirstStackStringLines(ex) {\n  if (ex && reactMinifiedRegexp.test(ex.message)) {\n    return 1;\n  }\n\n  return 0;\n}\n\n/**\n * If error has `framesToPop` property, it means that the\n * creator tells us the first x frames will be useless\n * and should be discarded. Typically error from wrapper function\n * which don't point to the actual location in the developer's code.\n *\n * Example: https://github.com/zertosh/invariant/blob/master/invariant.js#L46\n */\nfunction getPopFirstTopFrames(ex) {\n  if (typeof ex.framesToPop === 'number') {\n    return ex.framesToPop;\n  }\n\n  return 0;\n}\n\n// https://developer.mozilla.org/en-US/docs/WebAssembly/JavaScript_interface/Exception\n// @ts-expect-error - WebAssembly.Exception is a valid class\nfunction isWebAssemblyException(exception) {\n  // Check for support\n  // @ts-expect-error - WebAssembly.Exception is a valid class\n  if (typeof WebAssembly !== 'undefined' && typeof WebAssembly.Exception !== 'undefined') {\n    // @ts-expect-error - WebAssembly.Exception is a valid class\n    return exception instanceof WebAssembly.Exception;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Extracts from errors what we use as the exception `type` in error events.\n *\n * Usually, this is the `name` property on Error objects but WASM errors need to be treated differently.\n */\nfunction extractType(ex) {\n  const name = ex?.name;\n\n  // The name for WebAssembly.Exception Errors needs to be extracted differently.\n  // Context: https://github.com/getsentry/sentry-javascript/issues/13787\n  if (!name && isWebAssemblyException(ex)) {\n    // Emscripten sets array[type, message] to the \"message\" property on the WebAssembly.Exception object\n    const hasTypeInMessage = ex.message && Array.isArray(ex.message) && ex.message.length == 2;\n    return hasTypeInMessage ? ex.message[0] : 'WebAssembly.Exception';\n  }\n\n  return name;\n}\n\n/**\n * There are cases where stacktrace.message is an Event object\n * https://github.com/getsentry/sentry-javascript/issues/1949\n * In this specific case we try to extract stacktrace.message.error.message\n */\nfunction extractMessage(ex) {\n  const message = ex?.message;\n\n  if (isWebAssemblyException(ex)) {\n    // For Node 18, Emscripten sets array[type, message] to the \"message\" property on the WebAssembly.Exception object\n    if (Array.isArray(ex.message) && ex.message.length == 2) {\n      return ex.message[1];\n    }\n    return 'wasm exception';\n  }\n\n  if (!message) {\n    return 'No error message';\n  }\n\n  if (message.error && typeof message.error.message === 'string') {\n    return message.error.message;\n  }\n\n  return message;\n}\n\n/**\n * Creates an {@link Event} from all inputs to `captureException` and non-primitive inputs to `captureMessage`.\n * @hidden\n */\nfunction eventFromException(\n  stackParser,\n  exception,\n  hint,\n  attachStacktrace,\n) {\n  const syntheticException = hint?.syntheticException || undefined;\n  const event = eventFromUnknownInput(stackParser, exception, syntheticException, attachStacktrace);\n  addExceptionMechanism(event); // defaults to { type: 'generic', handled: true }\n  event.level = 'error';\n  if (hint?.event_id) {\n    event.event_id = hint.event_id;\n  }\n  return resolvedSyncPromise(event);\n}\n\n/**\n * Builds and Event from a Message\n * @hidden\n */\nfunction eventFromMessage(\n  stackParser,\n  message,\n  level = 'info',\n  hint,\n  attachStacktrace,\n) {\n  const syntheticException = hint?.syntheticException || undefined;\n  const event = eventFromString(stackParser, message, syntheticException, attachStacktrace);\n  event.level = level;\n  if (hint?.event_id) {\n    event.event_id = hint.event_id;\n  }\n  return resolvedSyncPromise(event);\n}\n\n/**\n * @hidden\n */\nfunction eventFromUnknownInput(\n  stackParser,\n  exception,\n  syntheticException,\n  attachStacktrace,\n  isUnhandledRejection,\n) {\n  let event;\n\n  if (isErrorEvent(exception ) && (exception ).error) {\n    // If it is an ErrorEvent with `error` property, extract it to get actual Error\n    const errorEvent = exception ;\n    return eventFromError(stackParser, errorEvent.error );\n  }\n\n  // If it is a `DOMError` (which is a legacy API, but still supported in some browsers) then we just extract the name\n  // and message, as it doesn't provide anything else. According to the spec, all `DOMExceptions` should also be\n  // `Error`s, but that's not the case in IE11, so in that case we treat it the same as we do a `DOMError`.\n  //\n  // https://developer.mozilla.org/en-US/docs/Web/API/DOMError\n  // https://developer.mozilla.org/en-US/docs/Web/API/DOMException\n  // https://webidl.spec.whatwg.org/#es-DOMException-specialness\n  if (isDOMError(exception) || isDOMException(exception )) {\n    const domException = exception ;\n\n    if ('stack' in (exception )) {\n      event = eventFromError(stackParser, exception );\n    } else {\n      const name = domException.name || (isDOMError(domException) ? 'DOMError' : 'DOMException');\n      const message = domException.message ? `${name}: ${domException.message}` : name;\n      event = eventFromString(stackParser, message, syntheticException, attachStacktrace);\n      addExceptionTypeValue(event, message);\n    }\n    if ('code' in domException) {\n      // eslint-disable-next-line deprecation/deprecation\n      event.tags = { ...event.tags, 'DOMException.code': `${domException.code}` };\n    }\n\n    return event;\n  }\n  if (isError(exception)) {\n    // we have a real Error object, do nothing\n    return eventFromError(stackParser, exception);\n  }\n  if (isPlainObject(exception) || isEvent(exception)) {\n    // If it's a plain object or an instance of `Event` (the built-in JS kind, not this SDK's `Event` type), serialize\n    // it manually. This will allow us to group events based on top-level keys which is much better than creating a new\n    // group on any key/value change.\n    const objectException = exception ;\n    event = eventFromPlainObject(stackParser, objectException, syntheticException, isUnhandledRejection);\n    addExceptionMechanism(event, {\n      synthetic: true,\n    });\n    return event;\n  }\n\n  // If none of previous checks were valid, then it means that it's not:\n  // - an instance of DOMError\n  // - an instance of DOMException\n  // - an instance of Event\n  // - an instance of Error\n  // - a valid ErrorEvent (one with an error property)\n  // - a plain Object\n  //\n  // So bail out and capture it as a simple message:\n  event = eventFromString(stackParser, exception , syntheticException, attachStacktrace);\n  addExceptionTypeValue(event, `${exception}`, undefined);\n  addExceptionMechanism(event, {\n    synthetic: true,\n  });\n\n  return event;\n}\n\nfunction eventFromString(\n  stackParser,\n  message,\n  syntheticException,\n  attachStacktrace,\n) {\n  const event = {};\n\n  if (attachStacktrace && syntheticException) {\n    const frames = parseStackFrames(stackParser, syntheticException);\n    if (frames.length) {\n      event.exception = {\n        values: [{ value: message, stacktrace: { frames } }],\n      };\n    }\n    addExceptionMechanism(event, { synthetic: true });\n  }\n\n  if (isParameterizedString(message)) {\n    const { __sentry_template_string__, __sentry_template_values__ } = message;\n\n    event.logentry = {\n      message: __sentry_template_string__,\n      params: __sentry_template_values__,\n    };\n    return event;\n  }\n\n  event.message = message;\n  return event;\n}\n\nfunction getNonErrorObjectExceptionValue(\n  exception,\n  { isUnhandledRejection },\n) {\n  const keys = extractExceptionKeysForMessage(exception);\n  const captureType = isUnhandledRejection ? 'promise rejection' : 'exception';\n\n  // Some ErrorEvent instances do not have an `error` property, which is why they are not handled before\n  // We still want to try to get a decent message for these cases\n  if (isErrorEvent(exception)) {\n    return `Event \\`ErrorEvent\\` captured as ${captureType} with message \\`${exception.message}\\``;\n  }\n\n  if (isEvent(exception)) {\n    const className = getObjectClassName(exception);\n    return `Event \\`${className}\\` (type=${exception.type}) captured as ${captureType}`;\n  }\n\n  return `Object captured as ${captureType} with keys: ${keys}`;\n}\n\nfunction getObjectClassName(obj) {\n  try {\n    const prototype = Object.getPrototypeOf(obj);\n    return prototype ? prototype.constructor.name : undefined;\n  } catch (e) {\n    // ignore errors here\n  }\n}\n\n/** If a plain object has a property that is an `Error`, return this error. */\nfunction getErrorPropertyFromObject(obj) {\n  for (const prop in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n      const value = obj[prop];\n      if (value instanceof Error) {\n        return value;\n      }\n    }\n  }\n\n  return undefined;\n}\n\nexport { eventFromException, eventFromMessage, eventFromUnknownInput, exceptionFromError, extractMessage, extractType };\n//# sourceMappingURL=eventbuilder.js.map\n","import { Client, getSDKSource, applySdkMetadata, _INTERNAL_flushLogsBuffer, addAutoIpAddressToUser, addAutoIpAddressToSession } from '@sentry/core';\nimport { eventFromException, eventFromMessage } from './eventbuilder.js';\nimport { WINDOW } from './helpers.js';\n\nconst DEFAULT_FLUSH_INTERVAL = 5000;\n\n/**\n * Configuration options for the Sentry Browser SDK.\n * @see @sentry/core Options for more information.\n */\n\n/**\n * The Sentry Browser SDK Client.\n *\n * @see BrowserOptions for documentation on configuration options.\n * @see SentryClient for usage documentation.\n */\nclass BrowserClient extends Client {\n\n  /**\n   * Creates a new Browser SDK instance.\n   *\n   * @param options Configuration options for this SDK.\n   */\n   constructor(options) {\n    const opts = {\n      // We default this to true, as it is the safer scenario\n      parentSpanIsAlwaysRootSpan: true,\n      ...options,\n    };\n    const sdkSource = WINDOW.SENTRY_SDK_SOURCE || getSDKSource();\n    applySdkMetadata(opts, 'browser', ['browser'], sdkSource);\n\n    super(opts);\n\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const client = this;\n    const { sendDefaultPii, _experiments } = client._options;\n    const enableLogs = _experiments?.enableLogs;\n\n    if (opts.sendClientReports && WINDOW.document) {\n      WINDOW.document.addEventListener('visibilitychange', () => {\n        if (WINDOW.document.visibilityState === 'hidden') {\n          this._flushOutcomes();\n          if (enableLogs) {\n            _INTERNAL_flushLogsBuffer(client);\n          }\n        }\n      });\n    }\n\n    if (enableLogs) {\n      client.on('flush', () => {\n        _INTERNAL_flushLogsBuffer(client);\n      });\n\n      client.on('afterCaptureLog', () => {\n        if (client._logFlushIdleTimeout) {\n          clearTimeout(client._logFlushIdleTimeout);\n        }\n\n        client._logFlushIdleTimeout = setTimeout(() => {\n          _INTERNAL_flushLogsBuffer(client);\n        }, DEFAULT_FLUSH_INTERVAL);\n      });\n    }\n\n    if (sendDefaultPii) {\n      client.on('postprocessEvent', addAutoIpAddressToUser);\n      client.on('beforeSendSession', addAutoIpAddressToSession);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n   eventFromException(exception, hint) {\n    return eventFromException(this._options.stackParser, exception, hint, this._options.attachStacktrace);\n  }\n\n  /**\n   * @inheritDoc\n   */\n   eventFromMessage(\n    message,\n    level = 'info',\n    hint,\n  ) {\n    return eventFromMessage(this._options.stackParser, message, level, hint, this._options.attachStacktrace);\n  }\n\n  /**\n   * @inheritDoc\n   */\n   _prepareEvent(\n    event,\n    hint,\n    currentScope,\n    isolationScope,\n  ) {\n    event.platform = event.platform || 'javascript';\n\n    return super._prepareEvent(event, hint, currentScope, isolationScope);\n  }\n}\n\nexport { BrowserClient };\n//# sourceMappingURL=client.js.map\n","import { SDK_VERSION } from '../utils-hoist/version.js';\n\n/**\n * A builder for the SDK metadata in the options for the SDK initialization.\n *\n * Note: This function is identical to `buildMetadata` in Remix and NextJS and SvelteKit.\n * We don't extract it for bundle size reasons.\n * @see https://github.com/getsentry/sentry-javascript/pull/7404\n * @see https://github.com/getsentry/sentry-javascript/pull/4196\n *\n * If you make changes to this function consider updating the others as well.\n *\n * @param options SDK options object that gets mutated\n * @param names list of package names\n */\nfunction applySdkMetadata(options, name, names = [name], source = 'npm') {\n  const metadata = options._metadata || {};\n\n  if (!metadata.sdk) {\n    metadata.sdk = {\n      name: `sentry.javascript.${name}`,\n      packages: names.map(name => ({\n        name: `${source}:@sentry/${name}`,\n        version: SDK_VERSION,\n      })),\n      version: SDK_VERSION,\n    };\n  }\n\n  options._metadata = metadata;\n}\n\nexport { applySdkMetadata };\n//# sourceMappingURL=sdkMetadata.js.map\n","/*\n * This module exists for optimizations in the build process through rollup and terser.  We define some global\n * constants, which can be overridden during build. By guarding certain pieces of code with functions that return these\n * constants, we can control whether or not they appear in the final bundle. (Any code guarded by a false condition will\n * never run, and will hence be dropped during treeshaking.) The two primary uses for this are stripping out calls to\n * `logger` and preventing node-related code from appearing in browser bundles.\n *\n * Attention:\n * This file should not be used to define constants/flags that are intended to be used for tree-shaking conducted by\n * users. These flags should live in their respective packages, as we identified user tooling (specifically webpack)\n * having issues tree-shaking these constants across package boundaries.\n * An example for this is the __SENTRY_DEBUG__ constant. It is declared in each package individually because we want\n * users to be able to shake away expressions that it guards.\n */\n\n/**\n * Figures out if we're building a browser bundle.\n *\n * @returns true if this is a browser bundle build.\n */\nfunction isBrowserBundle() {\n  return typeof __SENTRY_BROWSER_BUNDLE__ !== 'undefined' && !!__SENTRY_BROWSER_BUNDLE__;\n}\n\n/**\n * Get source of SDK.\n */\nfunction getSDKSource() {\n  // This comment is used to identify this line in the CDN bundle build step and replace this with \"return 'cdn';\"\n  /* __SENTRY_SDK_SOURCE__ */ return 'npm';\n}\n\nexport { getSDKSource, isBrowserBundle };\n//# sourceMappingURL=env.js.map\n","/**\n * This serves as a build time flag that will be true by default, but false in non-debug builds or if users replace `__SENTRY_DEBUG__` in their generated code.\n *\n * ATTENTION: This constant must never cross package boundaries (i.e. be exported) to guarantee that it can be used for tree shaking.\n */\nconst DEBUG_BUILD = (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__);\n\nexport { DEBUG_BUILD };\n//# sourceMappingURL=debug-build.js.map\n","import { GLOBAL_OBJ } from '@sentry/core';\n\nconst WINDOW = GLOBAL_OBJ\n\n;\n\nexport { WINDOW };\n//# sourceMappingURL=types.js.map\n","import { addHandler, maybeInstrument, triggerHandlers, fill, addNonEnumerableProperty, uuid4 } from '@sentry/core';\nimport { WINDOW } from '../types.js';\n\nconst DEBOUNCE_DURATION = 1000;\n\nlet debounceTimerID;\nlet lastCapturedEventType;\nlet lastCapturedEventTargetId;\n\n/**\n * Add an instrumentation handler for when a click or a keypress happens.\n *\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nfunction addClickKeypressInstrumentationHandler(handler) {\n  const type = 'dom';\n  addHandler(type, handler);\n  maybeInstrument(type, instrumentDOM);\n}\n\n/** Exported for tests only. */\nfunction instrumentDOM() {\n  if (!WINDOW.document) {\n    return;\n  }\n\n  // Make it so that any click or keypress that is unhandled / bubbled up all the way to the document triggers our dom\n  // handlers. (Normally we have only one, which captures a breadcrumb for each click or keypress.) Do this before\n  // we instrument `addEventListener` so that we don't end up attaching this handler twice.\n  const triggerDOMHandler = triggerHandlers.bind(null, 'dom');\n  const globalDOMEventHandler = makeDOMEventHandler(triggerDOMHandler, true);\n  WINDOW.document.addEventListener('click', globalDOMEventHandler, false);\n  WINDOW.document.addEventListener('keypress', globalDOMEventHandler, false);\n\n  // After hooking into click and keypress events bubbled up to `document`, we also hook into user-handled\n  // clicks & keypresses, by adding an event listener of our own to any element to which they add a listener. That\n  // way, whenever one of their handlers is triggered, ours will be, too. (This is needed because their handler\n  // could potentially prevent the event from bubbling up to our global listeners. This way, our handler are still\n  // guaranteed to fire at least once.)\n  ['EventTarget', 'Node'].forEach((target) => {\n    const globalObject = WINDOW ;\n    const proto = globalObject[target]?.prototype;\n\n    // eslint-disable-next-line no-prototype-builtins\n    if (!proto?.hasOwnProperty?.('addEventListener')) {\n      return;\n    }\n\n    fill(proto, 'addEventListener', function (originalAddEventListener) {\n      return function ( type, listener, options) {\n        if (type === 'click' || type == 'keypress') {\n          try {\n            const handlers = (this.__sentry_instrumentation_handlers__ =\n              this.__sentry_instrumentation_handlers__ || {});\n            const handlerForType = (handlers[type] = handlers[type] || { refCount: 0 });\n\n            if (!handlerForType.handler) {\n              const handler = makeDOMEventHandler(triggerDOMHandler);\n              handlerForType.handler = handler;\n              originalAddEventListener.call(this, type, handler, options);\n            }\n\n            handlerForType.refCount++;\n          } catch (e) {\n            // Accessing dom properties is always fragile.\n            // Also allows us to skip `addEventListeners` calls with no proper `this` context.\n          }\n        }\n\n        return originalAddEventListener.call(this, type, listener, options);\n      };\n    });\n\n    fill(\n      proto,\n      'removeEventListener',\n      function (originalRemoveEventListener) {\n        return function ( type, listener, options) {\n          if (type === 'click' || type == 'keypress') {\n            try {\n              const handlers = this.__sentry_instrumentation_handlers__ || {};\n              const handlerForType = handlers[type];\n\n              if (handlerForType) {\n                handlerForType.refCount--;\n                // If there are no longer any custom handlers of the current type on this element, we can remove ours, too.\n                if (handlerForType.refCount <= 0) {\n                  originalRemoveEventListener.call(this, type, handlerForType.handler, options);\n                  handlerForType.handler = undefined;\n                  delete handlers[type]; // eslint-disable-line @typescript-eslint/no-dynamic-delete\n                }\n\n                // If there are no longer any custom handlers of any type on this element, cleanup everything.\n                if (Object.keys(handlers).length === 0) {\n                  delete this.__sentry_instrumentation_handlers__;\n                }\n              }\n            } catch (e) {\n              // Accessing dom properties is always fragile.\n              // Also allows us to skip `addEventListeners` calls with no proper `this` context.\n            }\n          }\n\n          return originalRemoveEventListener.call(this, type, listener, options);\n        };\n      },\n    );\n  });\n}\n\n/**\n * Check whether the event is similar to the last captured one. For example, two click events on the same button.\n */\nfunction isSimilarToLastCapturedEvent(event) {\n  // If both events have different type, then user definitely performed two separate actions. e.g. click + keypress.\n  if (event.type !== lastCapturedEventType) {\n    return false;\n  }\n\n  try {\n    // If both events have the same type, it's still possible that actions were performed on different targets.\n    // e.g. 2 clicks on different buttons.\n    if (!event.target || (event.target )._sentryId !== lastCapturedEventTargetId) {\n      return false;\n    }\n  } catch (e) {\n    // just accessing `target` property can throw an exception in some rare circumstances\n    // see: https://github.com/getsentry/sentry-javascript/issues/838\n  }\n\n  // If both events have the same type _and_ same `target` (an element which triggered an event, _not necessarily_\n  // to which an event listener was attached), we treat them as the same action, as we want to capture\n  // only one breadcrumb. e.g. multiple clicks on the same button, or typing inside a user input box.\n  return true;\n}\n\n/**\n * Decide whether an event should be captured.\n * @param event event to be captured\n */\nfunction shouldSkipDOMEvent(eventType, target) {\n  // We are only interested in filtering `keypress` events for now.\n  if (eventType !== 'keypress') {\n    return false;\n  }\n\n  if (!target?.tagName) {\n    return true;\n  }\n\n  // Only consider keypress events on actual input elements. This will disregard keypresses targeting body\n  // e.g.tabbing through elements, hotkeys, etc.\n  if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Wraps addEventListener to capture UI breadcrumbs\n */\nfunction makeDOMEventHandler(\n  handler,\n  globalListener = false,\n) {\n  return (event) => {\n    // It's possible this handler might trigger multiple times for the same\n    // event (e.g. event propagation through node ancestors).\n    // Ignore if we've already captured that event.\n    if (!event || event['_sentryCaptured']) {\n      return;\n    }\n\n    const target = getEventTarget(event);\n\n    // We always want to skip _some_ events.\n    if (shouldSkipDOMEvent(event.type, target)) {\n      return;\n    }\n\n    // Mark event as \"seen\"\n    addNonEnumerableProperty(event, '_sentryCaptured', true);\n\n    if (target && !target._sentryId) {\n      // Add UUID to event target so we can identify if\n      addNonEnumerableProperty(target, '_sentryId', uuid4());\n    }\n\n    const name = event.type === 'keypress' ? 'input' : event.type;\n\n    // If there is no last captured event, it means that we can safely capture the new event and store it for future comparisons.\n    // If there is a last captured event, see if the new event is different enough to treat it as a unique one.\n    // If that's the case, emit the previous event and store locally the newly-captured DOM event.\n    if (!isSimilarToLastCapturedEvent(event)) {\n      const handlerData = { event, name, global: globalListener };\n      handler(handlerData);\n      lastCapturedEventType = event.type;\n      lastCapturedEventTargetId = target ? target._sentryId : undefined;\n    }\n\n    // Start a new debounce timer that will prevent us from capturing multiple events that should be grouped together.\n    clearTimeout(debounceTimerID);\n    debounceTimerID = WINDOW.setTimeout(() => {\n      lastCapturedEventTargetId = undefined;\n      lastCapturedEventType = undefined;\n    }, DEBOUNCE_DURATION);\n  };\n}\n\nfunction getEventTarget(event) {\n  try {\n    return event.target ;\n  } catch (e) {\n    // just accessing `target` property can throw an exception in some rare circumstances\n    // see: https://github.com/getsentry/sentry-javascript/issues/838\n    return null;\n  }\n}\n\nexport { addClickKeypressInstrumentationHandler, instrumentDOM };\n//# sourceMappingURL=dom.js.map\n","import { addHandler, maybeInstrument, triggerHandlers, supportsHistory, fill } from '@sentry/core';\nimport { WINDOW } from '../types.js';\n\nlet lastHref;\n\n/**\n * Add an instrumentation handler for when a fetch request happens.\n * The handler function is called once when the request starts and once when it ends,\n * which can be identified by checking if it has an `endTimestamp`.\n *\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nfunction addHistoryInstrumentationHandler(handler) {\n  const type = 'history';\n  addHandler(type, handler);\n  maybeInstrument(type, instrumentHistory);\n}\n\n/**\n * Exported just for testing\n */\nfunction instrumentHistory() {\n  // The `popstate` event may also be triggered on `pushState`, but it may not always reliably be emitted by the browser\n  // Which is why we also monkey-patch methods below, in addition to this\n  WINDOW.addEventListener('popstate', () => {\n    const to = WINDOW.location.href;\n    // keep track of the current URL state, as we always receive only the updated state\n    const from = lastHref;\n    lastHref = to;\n\n    if (from === to) {\n      return;\n    }\n\n    const handlerData = { from, to } ;\n    triggerHandlers('history', handlerData);\n  });\n\n  // Just guard against this not being available, in weird environments\n  if (!supportsHistory()) {\n    return;\n  }\n\n  function historyReplacementFunction(originalHistoryFunction) {\n    return function ( ...args) {\n      const url = args.length > 2 ? args[2] : undefined;\n      if (url) {\n        // coerce to string (this is what pushState does)\n        const from = lastHref;\n        const to = String(url);\n        // keep track of the current URL state, as we always receive only the updated state\n        lastHref = to;\n\n        if (from === to) {\n          return originalHistoryFunction.apply(this, args);\n        }\n\n        const handlerData = { from, to } ;\n        triggerHandlers('history', handlerData);\n      }\n      return originalHistoryFunction.apply(this, args);\n    };\n  }\n\n  fill(WINDOW.history, 'pushState', historyReplacementFunction);\n  fill(WINDOW.history, 'replaceState', historyReplacementFunction);\n}\n\nexport { addHistoryInstrumentationHandler, instrumentHistory };\n//# sourceMappingURL=history.js.map\n","import { isNativeFunction, logger } from '@sentry/core';\nimport { DEBUG_BUILD } from './debug-build.js';\nimport { WINDOW } from './types.js';\n\n/**\n * We generally want to use window.fetch / window.setTimeout.\n * However, in some cases this may be wrapped (e.g. by Zone.js for Angular),\n * so we try to get an unpatched version of this from a sandboxed iframe.\n */\n\nconst cachedImplementations = {};\n\n/**\n * Get the native implementation of a browser function.\n *\n * This can be used to ensure we get an unwrapped version of a function, in cases where a wrapped function can lead to problems.\n *\n * The following methods can be retrieved:\n * - `setTimeout`: This can be wrapped by e.g. Angular, causing change detection to be triggered.\n * - `fetch`: This can be wrapped by e.g. ad-blockers, causing an infinite loop when a request is blocked.\n */\nfunction getNativeImplementation(\n  name,\n) {\n  const cached = cachedImplementations[name];\n  if (cached) {\n    return cached;\n  }\n\n  let impl = WINDOW[name] ;\n\n  // Fast path to avoid DOM I/O\n  if (isNativeFunction(impl)) {\n    return (cachedImplementations[name] = impl.bind(WINDOW) );\n  }\n\n  const document = WINDOW.document;\n  // eslint-disable-next-line deprecation/deprecation\n  if (document && typeof document.createElement === 'function') {\n    try {\n      const sandbox = document.createElement('iframe');\n      sandbox.hidden = true;\n      document.head.appendChild(sandbox);\n      const contentWindow = sandbox.contentWindow;\n      if (contentWindow?.[name]) {\n        impl = contentWindow[name] ;\n      }\n      document.head.removeChild(sandbox);\n    } catch (e) {\n      // Could not create sandbox iframe, just use window.xxx\n      DEBUG_BUILD && logger.warn(`Could not create sandbox iframe for ${name} check, bailing to window.${name}: `, e);\n    }\n  }\n\n  // Sanity check: This _should_ not happen, but if it does, we just skip caching...\n  // This can happen e.g. in tests where fetch may not be available in the env, or similar.\n  if (!impl) {\n    return impl;\n  }\n\n  return (cachedImplementations[name] = impl.bind(WINDOW) );\n}\n\n/** Clear a cached implementation. */\nfunction clearCachedImplementation(name) {\n  cachedImplementations[name] = undefined;\n}\n\n/**\n * A special usecase for incorrectly wrapped Fetch APIs in conjunction with ad-blockers.\n * Whenever someone wraps the Fetch API and returns the wrong promise chain,\n * this chain becomes orphaned and there is no possible way to capture it's rejections\n * other than allowing it bubble up to this very handler. eg.\n *\n * const f = window.fetch;\n * window.fetch = function () {\n *   const p = f.apply(this, arguments);\n *\n *   p.then(function() {\n *     console.log('hi.');\n *   });\n *\n *   return p;\n * }\n *\n * `p.then(function () { ... })` is producing a completely separate promise chain,\n * however, what's returned is `p` - the result of original `fetch` call.\n *\n * This mean, that whenever we use the Fetch API to send our own requests, _and_\n * some ad-blocker blocks it, this orphaned chain will _always_ reject,\n * effectively causing another event to be captured.\n * This makes a whole process become an infinite loop, which we need to somehow\n * deal with, and break it in one way or another.\n *\n * To deal with this issue, we are making sure that we _always_ use the real\n * browser Fetch API, instead of relying on what `window.fetch` exposes.\n * The only downside to this would be missing our own requests as breadcrumbs,\n * but because we are already not doing this, it should be just fine.\n *\n * Possible failed fetch error messages per-browser:\n *\n * Chrome:  Failed to fetch\n * Edge:    Failed to Fetch\n * Firefox: NetworkError when attempting to fetch resource\n * Safari:  resource blocked by content blocker\n */\nfunction fetch(...rest) {\n  return getNativeImplementation('fetch')(...rest);\n}\n\n/**\n * Get an unwrapped `setTimeout` method.\n * This ensures that even if e.g. Angular wraps `setTimeout`, we get the native implementation,\n * avoiding triggering change detection.\n */\nfunction setTimeout(...rest) {\n  return getNativeImplementation('setTimeout')(...rest);\n}\n\nexport { clearCachedImplementation, fetch, getNativeImplementation, setTimeout };\n//# sourceMappingURL=getNativeImplementation.js.map\n","import { addHandler, maybeInstrument, timestampInSeconds, isString, triggerHandlers } from '@sentry/core';\nimport { WINDOW } from '../types.js';\n\nconst SENTRY_XHR_DATA_KEY = '__sentry_xhr_v3__';\n\n/**\n * Add an instrumentation handler for when an XHR request happens.\n * The handler function is called once when the request starts and once when it ends,\n * which can be identified by checking if it has an `endTimestamp`.\n *\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nfunction addXhrInstrumentationHandler(handler) {\n  const type = 'xhr';\n  addHandler(type, handler);\n  maybeInstrument(type, instrumentXHR);\n}\n\n/** Exported only for tests. */\nfunction instrumentXHR() {\n  if (!(WINDOW ).XMLHttpRequest) {\n    return;\n  }\n\n  const xhrproto = XMLHttpRequest.prototype;\n\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  xhrproto.open = new Proxy(xhrproto.open, {\n    apply(\n      originalOpen,\n      xhrOpenThisArg,\n      xhrOpenArgArray\n\n,\n    ) {\n      // NOTE: If you are a Sentry user, and you are seeing this stack frame,\n      //       it means the error, that was caused by your XHR call did not\n      //       have a stack trace. If you are using HttpClient integration,\n      //       this is the expected behavior, as we are using this virtual error to capture\n      //       the location of your XHR call, and group your HttpClient events accordingly.\n      const virtualError = new Error();\n\n      const startTimestamp = timestampInSeconds() * 1000;\n\n      // open() should always be called with two or more arguments\n      // But to be on the safe side, we actually validate this and bail out if we don't have a method & url\n      const method = isString(xhrOpenArgArray[0]) ? xhrOpenArgArray[0].toUpperCase() : undefined;\n      const url = parseXhrUrlArg(xhrOpenArgArray[1]);\n\n      if (!method || !url) {\n        return originalOpen.apply(xhrOpenThisArg, xhrOpenArgArray);\n      }\n\n      xhrOpenThisArg[SENTRY_XHR_DATA_KEY] = {\n        method,\n        url,\n        request_headers: {},\n      };\n\n      // if Sentry key appears in URL, don't capture it as a request\n      if (method === 'POST' && url.match(/sentry_key/)) {\n        xhrOpenThisArg.__sentry_own_request__ = true;\n      }\n\n      const onreadystatechangeHandler = () => {\n        // For whatever reason, this is not the same instance here as from the outer method\n        const xhrInfo = xhrOpenThisArg[SENTRY_XHR_DATA_KEY];\n\n        if (!xhrInfo) {\n          return;\n        }\n\n        if (xhrOpenThisArg.readyState === 4) {\n          try {\n            // touching statusCode in some platforms throws\n            // an exception\n            xhrInfo.status_code = xhrOpenThisArg.status;\n          } catch (e) {\n            /* do nothing */\n          }\n\n          const handlerData = {\n            endTimestamp: timestampInSeconds() * 1000,\n            startTimestamp,\n            xhr: xhrOpenThisArg,\n            virtualError,\n          };\n          triggerHandlers('xhr', handlerData);\n        }\n      };\n\n      if ('onreadystatechange' in xhrOpenThisArg && typeof xhrOpenThisArg.onreadystatechange === 'function') {\n        xhrOpenThisArg.onreadystatechange = new Proxy(xhrOpenThisArg.onreadystatechange, {\n          apply(originalOnreadystatechange, onreadystatechangeThisArg, onreadystatechangeArgArray) {\n            onreadystatechangeHandler();\n            return originalOnreadystatechange.apply(onreadystatechangeThisArg, onreadystatechangeArgArray);\n          },\n        });\n      } else {\n        xhrOpenThisArg.addEventListener('readystatechange', onreadystatechangeHandler);\n      }\n\n      // Intercepting `setRequestHeader` to access the request headers of XHR instance.\n      // This will only work for user/library defined headers, not for the default/browser-assigned headers.\n      // Request cookies are also unavailable for XHR, as `Cookie` header can't be defined by `setRequestHeader`.\n      xhrOpenThisArg.setRequestHeader = new Proxy(xhrOpenThisArg.setRequestHeader, {\n        apply(\n          originalSetRequestHeader,\n          setRequestHeaderThisArg,\n          setRequestHeaderArgArray,\n        ) {\n          const [header, value] = setRequestHeaderArgArray;\n\n          const xhrInfo = setRequestHeaderThisArg[SENTRY_XHR_DATA_KEY];\n\n          if (xhrInfo && isString(header) && isString(value)) {\n            xhrInfo.request_headers[header.toLowerCase()] = value;\n          }\n\n          return originalSetRequestHeader.apply(setRequestHeaderThisArg, setRequestHeaderArgArray);\n        },\n      });\n\n      return originalOpen.apply(xhrOpenThisArg, xhrOpenArgArray);\n    },\n  });\n\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  xhrproto.send = new Proxy(xhrproto.send, {\n    apply(originalSend, sendThisArg, sendArgArray) {\n      const sentryXhrData = sendThisArg[SENTRY_XHR_DATA_KEY];\n\n      if (!sentryXhrData) {\n        return originalSend.apply(sendThisArg, sendArgArray);\n      }\n\n      if (sendArgArray[0] !== undefined) {\n        sentryXhrData.body = sendArgArray[0];\n      }\n\n      const handlerData = {\n        startTimestamp: timestampInSeconds() * 1000,\n        xhr: sendThisArg,\n      };\n      triggerHandlers('xhr', handlerData);\n\n      return originalSend.apply(sendThisArg, sendArgArray);\n    },\n  });\n}\n\n/**\n * Parses the URL argument of a XHR method to a string.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/open#url\n * url: A string or any other object with a stringifier — including a URL object — that provides the URL of the resource to send the request to.\n *\n * @param url - The URL argument of an XHR method\n * @returns The parsed URL string or undefined if the URL is invalid\n */\nfunction parseXhrUrlArg(url) {\n  if (isString(url)) {\n    return url;\n  }\n\n  try {\n    // If the passed in argument is not a string, it should have a `toString` method as a stringifier.\n    // If that fails, we just return undefined (like in IE11 where URL is not available)\n    return (url ).toString();\n  } catch {} // eslint-disable-line no-empty\n\n  return undefined;\n}\n\nexport { SENTRY_XHR_DATA_KEY, addXhrInstrumentationHandler, instrumentXHR };\n//# sourceMappingURL=xhr.js.map\n","import { getNativeImplementation, clearCachedImplementation } from '@sentry-internal/browser-utils';\nimport { createTransport, rejectedSyncPromise } from '@sentry/core';\n\n/**\n * Creates a Transport that uses the Fetch API to send events to Sentry.\n */\nfunction makeFetchTransport(\n  options,\n  nativeFetch = getNativeImplementation('fetch'),\n) {\n  let pendingBodySize = 0;\n  let pendingCount = 0;\n\n  function makeRequest(request) {\n    const requestSize = request.body.length;\n    pendingBodySize += requestSize;\n    pendingCount++;\n\n    const requestOptions = {\n      body: request.body,\n      method: 'POST',\n      referrerPolicy: 'strict-origin',\n      headers: options.headers,\n      // Outgoing requests are usually cancelled when navigating to a different page, causing a \"TypeError: Failed to\n      // fetch\" error and sending a \"network_error\" client-outcome - in Chrome, the request status shows \"(cancelled)\".\n      // The `keepalive` flag keeps outgoing requests alive, even when switching pages. We want this since we're\n      // frequently sending events right before the user is switching pages (eg. when finishing navigation transactions).\n      // Gotchas:\n      // - `keepalive` isn't supported by Firefox\n      // - As per spec (https://fetch.spec.whatwg.org/#http-network-or-cache-fetch):\n      //   If the sum of contentLength and inflightKeepaliveBytes is greater than 64 kibibytes, then return a network error.\n      //   We will therefore only activate the flag when we're below that limit.\n      // There is also a limit of requests that can be open at the same time, so we also limit this to 15\n      // See https://github.com/getsentry/sentry-javascript/pull/7553 for details\n      keepalive: pendingBodySize <= 60000 && pendingCount < 15,\n      ...options.fetchOptions,\n    };\n\n    if (!nativeFetch) {\n      clearCachedImplementation('fetch');\n      return rejectedSyncPromise('No fetch implementation available');\n    }\n\n    try {\n      // TODO: This may need a `suppressTracing` call in the future when we switch the browser SDK to OTEL\n      return nativeFetch(options.url, requestOptions).then(response => {\n        pendingBodySize -= requestSize;\n        pendingCount--;\n        return {\n          statusCode: response.status,\n          headers: {\n            'x-sentry-rate-limits': response.headers.get('X-Sentry-Rate-Limits'),\n            'retry-after': response.headers.get('Retry-After'),\n          },\n        };\n      });\n    } catch (e) {\n      clearCachedImplementation('fetch');\n      pendingBodySize -= requestSize;\n      pendingCount--;\n      return rejectedSyncPromise(e);\n    }\n  }\n\n  return createTransport(options, makeRequest);\n}\n\nexport { makeFetchTransport };\n//# sourceMappingURL=fetch.js.map\n","import { createStackParser, UNKNOWN_FUNCTION } from '@sentry/core';\n\n// This was originally forked from https://github.com/csnover/TraceKit, and was largely\n// re - written as part of raven - js.\n//\n// This code was later copied to the JavaScript mono - repo and further modified and\n// refactored over the years.\n\n\nconst OPERA10_PRIORITY = 10;\nconst OPERA11_PRIORITY = 20;\nconst CHROME_PRIORITY = 30;\nconst WINJS_PRIORITY = 40;\nconst GECKO_PRIORITY = 50;\n\nfunction createFrame(filename, func, lineno, colno) {\n  const frame = {\n    filename,\n    function: func === '<anonymous>' ? UNKNOWN_FUNCTION : func,\n    in_app: true, // All browser frames are considered in_app\n  };\n\n  if (lineno !== undefined) {\n    frame.lineno = lineno;\n  }\n\n  if (colno !== undefined) {\n    frame.colno = colno;\n  }\n\n  return frame;\n}\n\n// This regex matches frames that have no function name (ie. are at the top level of a module).\n// For example \"at http://localhost:5000//script.js:1:126\"\n// Frames _with_ function names usually look as follows: \"at commitLayoutEffects (react-dom.development.js:23426:1)\"\nconst chromeRegexNoFnName = /^\\s*at (\\S+?)(?::(\\d+))(?::(\\d+))\\s*$/i;\n\n// This regex matches all the frames that have a function name.\nconst chromeRegex =\n  /^\\s*at (?:(.+?\\)(?: \\[.+\\])?|.*?) ?\\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\\/)?.*?)(?::(\\d+))?(?::(\\d+))?\\)?\\s*$/i;\n\nconst chromeEvalRegex = /\\((\\S*)(?::(\\d+))(?::(\\d+))\\)/;\n\n// Chromium based browsers: Chrome, Brave, new Opera, new Edge\n// We cannot call this variable `chrome` because it can conflict with global `chrome` variable in certain environments\n// See: https://github.com/getsentry/sentry-javascript/issues/6880\nconst chromeStackParserFn = line => {\n  // If the stack line has no function name, we need to parse it differently\n  const noFnParts = chromeRegexNoFnName.exec(line) ;\n\n  if (noFnParts) {\n    const [, filename, line, col] = noFnParts;\n    return createFrame(filename, UNKNOWN_FUNCTION, +line, +col);\n  }\n\n  const parts = chromeRegex.exec(line) ;\n\n  if (parts) {\n    const isEval = parts[2] && parts[2].indexOf('eval') === 0; // start of line\n\n    if (isEval) {\n      const subMatch = chromeEvalRegex.exec(parts[2]) ;\n\n      if (subMatch) {\n        // throw out eval line/column and use top-most line/column number\n        parts[2] = subMatch[1]; // url\n        parts[3] = subMatch[2]; // line\n        parts[4] = subMatch[3]; // column\n      }\n    }\n\n    // Kamil: One more hack won't hurt us right? Understanding and adding more rules on top of these regexps right now\n    // would be way too time consuming. (TODO: Rewrite whole RegExp to be more readable)\n    const [func, filename] = extractSafariExtensionDetails(parts[1] || UNKNOWN_FUNCTION, parts[2]);\n\n    return createFrame(filename, func, parts[3] ? +parts[3] : undefined, parts[4] ? +parts[4] : undefined);\n  }\n\n  return;\n};\n\nconst chromeStackLineParser = [CHROME_PRIORITY, chromeStackParserFn];\n\n// gecko regex: `(?:bundle|\\d+\\.js)`: `bundle` is for react native, `\\d+\\.js` also but specifically for ram bundles because it\n// generates filenames without a prefix like `file://` the filenames in the stacktrace are just 42.js\n// We need this specific case for now because we want no other regex to match.\nconst geckoREgex =\n  /^\\s*(.*?)(?:\\((.*?)\\))?(?:^|@)?((?:[-a-z]+)?:\\/.*?|\\[native code\\]|[^@]*(?:bundle|\\d+\\.js)|\\/[\\w\\-. /=]+)(?::(\\d+))?(?::(\\d+))?\\s*$/i;\nconst geckoEvalRegex = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i;\n\nconst gecko = line => {\n  const parts = geckoREgex.exec(line) ;\n\n  if (parts) {\n    const isEval = parts[3] && parts[3].indexOf(' > eval') > -1;\n    if (isEval) {\n      const subMatch = geckoEvalRegex.exec(parts[3]) ;\n\n      if (subMatch) {\n        // throw out eval line/column and use top-most line number\n        parts[1] = parts[1] || 'eval';\n        parts[3] = subMatch[1];\n        parts[4] = subMatch[2];\n        parts[5] = ''; // no column when eval\n      }\n    }\n\n    let filename = parts[3];\n    let func = parts[1] || UNKNOWN_FUNCTION;\n    [func, filename] = extractSafariExtensionDetails(func, filename);\n\n    return createFrame(filename, func, parts[4] ? +parts[4] : undefined, parts[5] ? +parts[5] : undefined);\n  }\n\n  return;\n};\n\nconst geckoStackLineParser = [GECKO_PRIORITY, gecko];\n\nconst winjsRegex = /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:[-a-z]+):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i;\n\nconst winjs = line => {\n  const parts = winjsRegex.exec(line) ;\n\n  return parts\n    ? createFrame(parts[2], parts[1] || UNKNOWN_FUNCTION, +parts[3], parts[4] ? +parts[4] : undefined)\n    : undefined;\n};\n\nconst winjsStackLineParser = [WINJS_PRIORITY, winjs];\n\nconst opera10Regex = / line (\\d+).*script (?:in )?(\\S+)(?:: in function (\\S+))?$/i;\n\nconst opera10 = line => {\n  const parts = opera10Regex.exec(line) ;\n  return parts ? createFrame(parts[2], parts[3] || UNKNOWN_FUNCTION, +parts[1]) : undefined;\n};\n\nconst opera10StackLineParser = [OPERA10_PRIORITY, opera10];\n\nconst opera11Regex =\n  / line (\\d+), column (\\d+)\\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\\(.*\\))? in (.*):\\s*$/i;\n\nconst opera11 = line => {\n  const parts = opera11Regex.exec(line) ;\n  return parts ? createFrame(parts[5], parts[3] || parts[4] || UNKNOWN_FUNCTION, +parts[1], +parts[2]) : undefined;\n};\n\nconst opera11StackLineParser = [OPERA11_PRIORITY, opera11];\n\nconst defaultStackLineParsers = [chromeStackLineParser, geckoStackLineParser];\n\nconst defaultStackParser = createStackParser(...defaultStackLineParsers);\n\n/**\n * Safari web extensions, starting version unknown, can produce \"frames-only\" stacktraces.\n * What it means, is that instead of format like:\n *\n * Error: wat\n *   at function@url:row:col\n *   at function@url:row:col\n *   at function@url:row:col\n *\n * it produces something like:\n *\n *   function@url:row:col\n *   function@url:row:col\n *   function@url:row:col\n *\n * Because of that, it won't be captured by `chrome` RegExp and will fall into `Gecko` branch.\n * This function is extracted so that we can use it in both places without duplicating the logic.\n * Unfortunately \"just\" changing RegExp is too complicated now and making it pass all tests\n * and fix this case seems like an impossible, or at least way too time-consuming task.\n */\nconst extractSafariExtensionDetails = (func, filename) => {\n  const isSafariExtension = func.indexOf('safari-extension') !== -1;\n  const isSafariWebExtension = func.indexOf('safari-web-extension') !== -1;\n\n  return isSafariExtension || isSafariWebExtension\n    ? [\n        func.indexOf('@') !== -1 ? (func.split('@')[0] ) : UNKNOWN_FUNCTION,\n        isSafariExtension ? `safari-extension:${filename}` : `safari-web-extension:${filename}`,\n      ]\n    : [func, filename];\n};\n\nexport { chromeStackLineParser, defaultStackLineParsers, defaultStackParser, geckoStackLineParser, opera10StackLineParser, opera11StackLineParser, winjsStackLineParser };\n//# sourceMappingURL=stack-parsers.js.map\n","/**\n * This serves as a build time flag that will be true by default, but false in non-debug builds or if users replace `__SENTRY_DEBUG__` in their generated code.\n *\n * ATTENTION: This constant must never cross package boundaries (i.e. be exported) to guarantee that it can be used for tree shaking.\n */\nconst DEBUG_BUILD = (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__);\n\nexport { DEBUG_BUILD };\n//# sourceMappingURL=debug-build.js.map\n","import { addClickKeypressInstrumentationHandler, addXhrInstrumentationHandler, addHistoryInstrumentationHandler, SENTRY_XHR_DATA_KEY } from '@sentry-internal/browser-utils';\nimport { defineIntegration, addConsoleInstrumentationHandler, addFetchInstrumentationHandler, getClient, safeJoin, severityLevelFromString, addBreadcrumb, logger, htmlTreeAsString, getComponentName, getBreadcrumbLogLevelFromHttpStatusCode, parseUrl, getEventDescription } from '@sentry/core';\nimport { DEBUG_BUILD } from '../debug-build.js';\nimport { WINDOW } from '../helpers.js';\n\n/* eslint-disable max-lines */\n\n\n/** maxStringLength gets capped to prevent 100 breadcrumbs exceeding 1MB event payload size */\nconst MAX_ALLOWED_STRING_LENGTH = 1024;\n\nconst INTEGRATION_NAME = 'Breadcrumbs';\n\nconst _breadcrumbsIntegration = ((options = {}) => {\n  const _options = {\n    console: true,\n    dom: true,\n    fetch: true,\n    history: true,\n    sentry: true,\n    xhr: true,\n    ...options,\n  };\n\n  return {\n    name: INTEGRATION_NAME,\n    setup(client) {\n      // TODO(v10): Remove this functionality and use `consoleIntegration` from @sentry/core instead.\n      if (_options.console) {\n        addConsoleInstrumentationHandler(_getConsoleBreadcrumbHandler(client));\n      }\n      if (_options.dom) {\n        addClickKeypressInstrumentationHandler(_getDomBreadcrumbHandler(client, _options.dom));\n      }\n      if (_options.xhr) {\n        addXhrInstrumentationHandler(_getXhrBreadcrumbHandler(client));\n      }\n      if (_options.fetch) {\n        addFetchInstrumentationHandler(_getFetchBreadcrumbHandler(client));\n      }\n      if (_options.history) {\n        addHistoryInstrumentationHandler(_getHistoryBreadcrumbHandler(client));\n      }\n      if (_options.sentry) {\n        client.on('beforeSendEvent', _getSentryBreadcrumbHandler(client));\n      }\n    },\n  };\n}) ;\n\nconst breadcrumbsIntegration = defineIntegration(_breadcrumbsIntegration);\n\n/**\n * Adds a breadcrumb for Sentry events or transactions if this option is enabled.\n */\nfunction _getSentryBreadcrumbHandler(client) {\n  return function addSentryBreadcrumb(event) {\n    if (getClient() !== client) {\n      return;\n    }\n\n    addBreadcrumb(\n      {\n        category: `sentry.${event.type === 'transaction' ? 'transaction' : 'event'}`,\n        event_id: event.event_id,\n        level: event.level,\n        message: getEventDescription(event),\n      },\n      {\n        event,\n      },\n    );\n  };\n}\n\n/**\n * A HOC that creates a function that creates breadcrumbs from DOM API calls.\n * This is a HOC so that we get access to dom options in the closure.\n */\nfunction _getDomBreadcrumbHandler(\n  client,\n  dom,\n) {\n  return function _innerDomBreadcrumb(handlerData) {\n    if (getClient() !== client) {\n      return;\n    }\n\n    let target;\n    let componentName;\n    let keyAttrs = typeof dom === 'object' ? dom.serializeAttribute : undefined;\n\n    let maxStringLength =\n      typeof dom === 'object' && typeof dom.maxStringLength === 'number' ? dom.maxStringLength : undefined;\n    if (maxStringLength && maxStringLength > MAX_ALLOWED_STRING_LENGTH) {\n      DEBUG_BUILD &&\n        logger.warn(\n          `\\`dom.maxStringLength\\` cannot exceed ${MAX_ALLOWED_STRING_LENGTH}, but a value of ${maxStringLength} was configured. Sentry will use ${MAX_ALLOWED_STRING_LENGTH} instead.`,\n        );\n      maxStringLength = MAX_ALLOWED_STRING_LENGTH;\n    }\n\n    if (typeof keyAttrs === 'string') {\n      keyAttrs = [keyAttrs];\n    }\n\n    // Accessing event.target can throw (see getsentry/raven-js#838, #768)\n    try {\n      const event = handlerData.event ;\n      const element = _isEvent(event) ? event.target : event;\n\n      target = htmlTreeAsString(element, { keyAttrs, maxStringLength });\n      componentName = getComponentName(element);\n    } catch (e) {\n      target = '<unknown>';\n    }\n\n    if (target.length === 0) {\n      return;\n    }\n\n    const breadcrumb = {\n      category: `ui.${handlerData.name}`,\n      message: target,\n    };\n\n    if (componentName) {\n      breadcrumb.data = { 'ui.component_name': componentName };\n    }\n\n    addBreadcrumb(breadcrumb, {\n      event: handlerData.event,\n      name: handlerData.name,\n      global: handlerData.global,\n    });\n  };\n}\n\n/**\n * Creates breadcrumbs from console API calls\n */\nfunction _getConsoleBreadcrumbHandler(client) {\n  return function _consoleBreadcrumb(handlerData) {\n    if (getClient() !== client) {\n      return;\n    }\n\n    const breadcrumb = {\n      category: 'console',\n      data: {\n        arguments: handlerData.args,\n        logger: 'console',\n      },\n      level: severityLevelFromString(handlerData.level),\n      message: safeJoin(handlerData.args, ' '),\n    };\n\n    if (handlerData.level === 'assert') {\n      if (handlerData.args[0] === false) {\n        breadcrumb.message = `Assertion failed: ${safeJoin(handlerData.args.slice(1), ' ') || 'console.assert'}`;\n        breadcrumb.data.arguments = handlerData.args.slice(1);\n      } else {\n        // Don't capture a breadcrumb for passed assertions\n        return;\n      }\n    }\n\n    addBreadcrumb(breadcrumb, {\n      input: handlerData.args,\n      level: handlerData.level,\n    });\n  };\n}\n\n/**\n * Creates breadcrumbs from XHR API calls\n */\nfunction _getXhrBreadcrumbHandler(client) {\n  return function _xhrBreadcrumb(handlerData) {\n    if (getClient() !== client) {\n      return;\n    }\n\n    const { startTimestamp, endTimestamp } = handlerData;\n\n    const sentryXhrData = handlerData.xhr[SENTRY_XHR_DATA_KEY];\n\n    // We only capture complete, non-sentry requests\n    if (!startTimestamp || !endTimestamp || !sentryXhrData) {\n      return;\n    }\n\n    const { method, url, status_code, body } = sentryXhrData;\n\n    const data = {\n      method,\n      url,\n      status_code,\n    };\n\n    const hint = {\n      xhr: handlerData.xhr,\n      input: body,\n      startTimestamp,\n      endTimestamp,\n    };\n\n    const breadcrumb = {\n      category: 'xhr',\n      data,\n      type: 'http',\n      level: getBreadcrumbLogLevelFromHttpStatusCode(status_code),\n    };\n\n    client.emit('beforeOutgoingRequestBreadcrumb', breadcrumb, hint );\n\n    addBreadcrumb(breadcrumb, hint);\n  };\n}\n\n/**\n * Creates breadcrumbs from fetch API calls\n */\nfunction _getFetchBreadcrumbHandler(client) {\n  return function _fetchBreadcrumb(handlerData) {\n    if (getClient() !== client) {\n      return;\n    }\n\n    const { startTimestamp, endTimestamp } = handlerData;\n\n    // We only capture complete fetch requests\n    if (!endTimestamp) {\n      return;\n    }\n\n    if (handlerData.fetchData.url.match(/sentry_key/) && handlerData.fetchData.method === 'POST') {\n      // We will not create breadcrumbs for fetch requests that contain `sentry_key` (internal sentry requests)\n      return;\n    }\n\n    ({\n      method: handlerData.fetchData.method,\n      url: handlerData.fetchData.url,\n    });\n\n    if (handlerData.error) {\n      const data = handlerData.fetchData;\n      const hint = {\n        data: handlerData.error,\n        input: handlerData.args,\n        startTimestamp,\n        endTimestamp,\n      };\n\n      const breadcrumb = {\n        category: 'fetch',\n        data,\n        level: 'error',\n        type: 'http',\n      } ;\n\n      client.emit('beforeOutgoingRequestBreadcrumb', breadcrumb, hint );\n\n      addBreadcrumb(breadcrumb, hint);\n    } else {\n      const response = handlerData.response ;\n      const data = {\n        ...handlerData.fetchData,\n        status_code: response?.status,\n      };\n\n      handlerData.fetchData.request_body_size;\n      handlerData.fetchData.response_body_size;\n      response?.status;\n\n      const hint = {\n        input: handlerData.args,\n        response,\n        startTimestamp,\n        endTimestamp,\n      };\n\n      const breadcrumb = {\n        category: 'fetch',\n        data,\n        type: 'http',\n        level: getBreadcrumbLogLevelFromHttpStatusCode(data.status_code),\n      };\n\n      client.emit('beforeOutgoingRequestBreadcrumb', breadcrumb, hint );\n\n      addBreadcrumb(breadcrumb, hint);\n    }\n  };\n}\n\n/**\n * Creates breadcrumbs from history API calls\n */\nfunction _getHistoryBreadcrumbHandler(client) {\n  return function _historyBreadcrumb(handlerData) {\n    if (getClient() !== client) {\n      return;\n    }\n\n    let from = handlerData.from;\n    let to = handlerData.to;\n    const parsedLoc = parseUrl(WINDOW.location.href);\n    let parsedFrom = from ? parseUrl(from) : undefined;\n    const parsedTo = parseUrl(to);\n\n    // Initial pushState doesn't provide `from` information\n    if (!parsedFrom?.path) {\n      parsedFrom = parsedLoc;\n    }\n\n    // Use only the path component of the URL if the URL matches the current\n    // document (almost all the time when using pushState)\n    if (parsedLoc.protocol === parsedTo.protocol && parsedLoc.host === parsedTo.host) {\n      to = parsedTo.relative;\n    }\n    if (parsedLoc.protocol === parsedFrom.protocol && parsedLoc.host === parsedFrom.host) {\n      from = parsedFrom.relative;\n    }\n\n    addBreadcrumb({\n      category: 'navigation',\n      data: {\n        from,\n        to,\n      },\n    });\n  };\n}\n\nfunction _isEvent(event) {\n  return !!event && !!(event ).target;\n}\n\nexport { breadcrumbsIntegration };\n//# sourceMappingURL=breadcrumbs.js.map\n","import { defineIntegration, fill, getFunctionName, getOriginalFunction } from '@sentry/core';\nimport { WINDOW, wrap } from '../helpers.js';\n\nconst DEFAULT_EVENT_TARGET = [\n  'EventTarget',\n  'Window',\n  'Node',\n  'ApplicationCache',\n  'AudioTrackList',\n  'BroadcastChannel',\n  'ChannelMergerNode',\n  'CryptoOperation',\n  'EventSource',\n  'FileReader',\n  'HTMLUnknownElement',\n  'IDBDatabase',\n  'IDBRequest',\n  'IDBTransaction',\n  'KeyOperation',\n  'MediaController',\n  'MessagePort',\n  'ModalWindow',\n  'Notification',\n  'SVGElementInstance',\n  'Screen',\n  'SharedWorker',\n  'TextTrack',\n  'TextTrackCue',\n  'TextTrackList',\n  'WebSocket',\n  'WebSocketWorker',\n  'Worker',\n  'XMLHttpRequest',\n  'XMLHttpRequestEventTarget',\n  'XMLHttpRequestUpload',\n];\n\nconst INTEGRATION_NAME = 'BrowserApiErrors';\n\nconst _browserApiErrorsIntegration = ((options = {}) => {\n  const _options = {\n    XMLHttpRequest: true,\n    eventTarget: true,\n    requestAnimationFrame: true,\n    setInterval: true,\n    setTimeout: true,\n    ...options,\n  };\n\n  return {\n    name: INTEGRATION_NAME,\n    // TODO: This currently only works for the first client this is setup\n    // We may want to adjust this to check for client etc.\n    setupOnce() {\n      if (_options.setTimeout) {\n        fill(WINDOW, 'setTimeout', _wrapTimeFunction);\n      }\n\n      if (_options.setInterval) {\n        fill(WINDOW, 'setInterval', _wrapTimeFunction);\n      }\n\n      if (_options.requestAnimationFrame) {\n        fill(WINDOW, 'requestAnimationFrame', _wrapRAF);\n      }\n\n      if (_options.XMLHttpRequest && 'XMLHttpRequest' in WINDOW) {\n        fill(XMLHttpRequest.prototype, 'send', _wrapXHR);\n      }\n\n      const eventTargetOption = _options.eventTarget;\n      if (eventTargetOption) {\n        const eventTarget = Array.isArray(eventTargetOption) ? eventTargetOption : DEFAULT_EVENT_TARGET;\n        eventTarget.forEach(_wrapEventTarget);\n      }\n    },\n  };\n}) ;\n\n/**\n * Wrap timer functions and event targets to catch errors and provide better meta data.\n */\nconst browserApiErrorsIntegration = defineIntegration(_browserApiErrorsIntegration);\n\nfunction _wrapTimeFunction(original) {\n  return function ( ...args) {\n    const originalCallback = args[0];\n    args[0] = wrap(originalCallback, {\n      mechanism: {\n        data: { function: getFunctionName(original) },\n        handled: false,\n        type: 'instrument',\n      },\n    });\n    return original.apply(this, args);\n  };\n}\n\nfunction _wrapRAF(original) {\n  return function ( callback) {\n    return original.apply(this, [\n      wrap(callback, {\n        mechanism: {\n          data: {\n            function: 'requestAnimationFrame',\n            handler: getFunctionName(original),\n          },\n          handled: false,\n          type: 'instrument',\n        },\n      }),\n    ]);\n  };\n}\n\nfunction _wrapXHR(originalSend) {\n  return function ( ...args) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const xhr = this;\n    const xmlHttpRequestProps = ['onload', 'onerror', 'onprogress', 'onreadystatechange'];\n\n    xmlHttpRequestProps.forEach(prop => {\n      if (prop in xhr && typeof xhr[prop] === 'function') {\n        fill(xhr, prop, function (original) {\n          const wrapOptions = {\n            mechanism: {\n              data: {\n                function: prop,\n                handler: getFunctionName(original),\n              },\n              handled: false,\n              type: 'instrument',\n            },\n          };\n\n          // If Instrument integration has been called before BrowserApiErrors, get the name of original function\n          const originalFunction = getOriginalFunction(original);\n          if (originalFunction) {\n            wrapOptions.mechanism.data.handler = getFunctionName(originalFunction);\n          }\n\n          // Otherwise wrap directly\n          return wrap(original, wrapOptions);\n        });\n      }\n    });\n\n    return originalSend.apply(this, args);\n  };\n}\n\nfunction _wrapEventTarget(target) {\n  const globalObject = WINDOW ;\n  const proto = globalObject[target]?.prototype;\n\n  // eslint-disable-next-line no-prototype-builtins\n  if (!proto?.hasOwnProperty?.('addEventListener')) {\n    return;\n  }\n\n  fill(proto, 'addEventListener', function (original)\n\n {\n    return function ( eventName, fn, options) {\n      try {\n        if (isEventListenerObject(fn)) {\n          // ESlint disable explanation:\n          //  First, it is generally safe to call `wrap` with an unbound function. Furthermore, using `.bind()` would\n          //  introduce a bug here, because bind returns a new function that doesn't have our\n          //  flags(like __sentry_original__) attached. `wrap` checks for those flags to avoid unnecessary wrapping.\n          //  Without those flags, every call to addEventListener wraps the function again, causing a memory leak.\n          // eslint-disable-next-line @typescript-eslint/unbound-method\n          fn.handleEvent = wrap(fn.handleEvent, {\n            mechanism: {\n              data: {\n                function: 'handleEvent',\n                handler: getFunctionName(fn),\n                target,\n              },\n              handled: false,\n              type: 'instrument',\n            },\n          });\n        }\n      } catch {\n        // can sometimes get 'Permission denied to access property \"handle Event'\n      }\n\n      return original.apply(this, [\n        eventName,\n        wrap(fn, {\n          mechanism: {\n            data: {\n              function: 'addEventListener',\n              handler: getFunctionName(fn),\n              target,\n            },\n            handled: false,\n            type: 'instrument',\n          },\n        }),\n        options,\n      ]);\n    };\n  });\n\n  fill(proto, 'removeEventListener', function (originalRemoveEventListener)\n\n {\n    return function ( eventName, fn, options) {\n      /**\n       * There are 2 possible scenarios here:\n       *\n       * 1. Someone passes a callback, which was attached prior to Sentry initialization, or by using unmodified\n       * method, eg. `document.addEventListener.call(el, name, handler). In this case, we treat this function\n       * as a pass-through, and call original `removeEventListener` with it.\n       *\n       * 2. Someone passes a callback, which was attached after Sentry was initialized, which means that it was using\n       * our wrapped version of `addEventListener`, which internally calls `wrap` helper.\n       * This helper \"wraps\" whole callback inside a try/catch statement, and attached appropriate metadata to it,\n       * in order for us to make a distinction between wrapped/non-wrapped functions possible.\n       * If a function was wrapped, it has additional property of `__sentry_wrapped__`, holding the handler.\n       *\n       * When someone adds a handler prior to initialization, and then do it again, but after,\n       * then we have to detach both of them. Otherwise, if we'd detach only wrapped one, it'd be impossible\n       * to get rid of the initial handler and it'd stick there forever.\n       */\n      try {\n        const originalEventHandler = (fn ).__sentry_wrapped__;\n        if (originalEventHandler) {\n          originalRemoveEventListener.call(this, eventName, originalEventHandler, options);\n        }\n      } catch (e) {\n        // ignore, accessing __sentry_wrapped__ will throw in some Selenium environments\n      }\n      return originalRemoveEventListener.call(this, eventName, fn, options);\n    };\n  });\n}\n\nfunction isEventListenerObject(obj) {\n  return typeof (obj ).handleEvent === 'function';\n}\n\nexport { browserApiErrorsIntegration };\n//# sourceMappingURL=browserapierrors.js.map\n","import { addHistoryInstrumentationHandler } from '@sentry-internal/browser-utils';\nimport { defineIntegration, logger, startSession, captureSession } from '@sentry/core';\nimport { DEBUG_BUILD } from '../debug-build.js';\nimport { WINDOW } from '../helpers.js';\n\n/**\n * When added, automatically creates sessions which allow you to track adoption and crashes (crash free rate) in your Releases in Sentry.\n * More information: https://docs.sentry.io/product/releases/health/\n *\n * Note: In order for session tracking to work, you need to set up Releases: https://docs.sentry.io/product/releases/\n */\nconst browserSessionIntegration = defineIntegration(() => {\n  return {\n    name: 'BrowserSession',\n    setupOnce() {\n      if (typeof WINDOW.document === 'undefined') {\n        DEBUG_BUILD &&\n          logger.warn('Using the `browserSessionIntegration` in non-browser environments is not supported.');\n        return;\n      }\n\n      // The session duration for browser sessions does not track a meaningful\n      // concept that can be used as a metric.\n      // Automatically captured sessions are akin to page views, and thus we\n      // discard their duration.\n      startSession({ ignoreDuration: true });\n      captureSession();\n\n      // We want to create a session for every navigation as well\n      addHistoryInstrumentationHandler(({ from, to }) => {\n        // Don't create an additional session for the initial route or if the location did not change\n        if (from !== undefined && from !== to) {\n          startSession({ ignoreDuration: true });\n          captureSession();\n        }\n      });\n    },\n  };\n});\n\nexport { browserSessionIntegration };\n//# sourceMappingURL=browsersession.js.map\n","import { defineIntegration, addGlobalErrorInstrumentationHandler, getClient, captureEvent, logger, addGlobalUnhandledRejectionInstrumentationHandler, isPrimitive, isString, getLocationHref, UNKNOWN_FUNCTION } from '@sentry/core';\nimport { DEBUG_BUILD } from '../debug-build.js';\nimport { eventFromUnknownInput } from '../eventbuilder.js';\nimport { shouldIgnoreOnError } from '../helpers.js';\n\nconst INTEGRATION_NAME = 'GlobalHandlers';\n\nconst _globalHandlersIntegration = ((options = {}) => {\n  const _options = {\n    onerror: true,\n    onunhandledrejection: true,\n    ...options,\n  };\n\n  return {\n    name: INTEGRATION_NAME,\n    setupOnce() {\n      Error.stackTraceLimit = 50;\n    },\n    setup(client) {\n      if (_options.onerror) {\n        _installGlobalOnErrorHandler(client);\n        globalHandlerLog('onerror');\n      }\n      if (_options.onunhandledrejection) {\n        _installGlobalOnUnhandledRejectionHandler(client);\n        globalHandlerLog('onunhandledrejection');\n      }\n    },\n  };\n}) ;\n\nconst globalHandlersIntegration = defineIntegration(_globalHandlersIntegration);\n\nfunction _installGlobalOnErrorHandler(client) {\n  addGlobalErrorInstrumentationHandler(data => {\n    const { stackParser, attachStacktrace } = getOptions();\n\n    if (getClient() !== client || shouldIgnoreOnError()) {\n      return;\n    }\n\n    const { msg, url, line, column, error } = data;\n\n    const event = _enhanceEventWithInitialFrame(\n      eventFromUnknownInput(stackParser, error || msg, undefined, attachStacktrace, false),\n      url,\n      line,\n      column,\n    );\n\n    event.level = 'error';\n\n    captureEvent(event, {\n      originalException: error,\n      mechanism: {\n        handled: false,\n        type: 'onerror',\n      },\n    });\n  });\n}\n\nfunction _installGlobalOnUnhandledRejectionHandler(client) {\n  addGlobalUnhandledRejectionInstrumentationHandler(e => {\n    const { stackParser, attachStacktrace } = getOptions();\n\n    if (getClient() !== client || shouldIgnoreOnError()) {\n      return;\n    }\n\n    const error = _getUnhandledRejectionError(e );\n\n    const event = isPrimitive(error)\n      ? _eventFromRejectionWithPrimitive(error)\n      : eventFromUnknownInput(stackParser, error, undefined, attachStacktrace, true);\n\n    event.level = 'error';\n\n    captureEvent(event, {\n      originalException: error,\n      mechanism: {\n        handled: false,\n        type: 'onunhandledrejection',\n      },\n    });\n  });\n}\n\nfunction _getUnhandledRejectionError(error) {\n  if (isPrimitive(error)) {\n    return error;\n  }\n\n  // dig the object of the rejection out of known event types\n  try {\n\n    // PromiseRejectionEvents store the object of the rejection under 'reason'\n    // see https://developer.mozilla.org/en-US/docs/Web/API/PromiseRejectionEvent\n    if ('reason' in (error )) {\n      return (error ).reason;\n    }\n\n    // something, somewhere, (likely a browser extension) effectively casts PromiseRejectionEvents\n    // to CustomEvents, moving the `promise` and `reason` attributes of the PRE into\n    // the CustomEvent's `detail` attribute, since they're not part of CustomEvent's spec\n    // see https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent and\n    // https://github.com/getsentry/sentry-javascript/issues/2380\n    if ('detail' in (error ) && 'reason' in (error ).detail) {\n      return (error ).detail.reason;\n    }\n  } catch {} // eslint-disable-line no-empty\n\n  return error;\n}\n\n/**\n * Create an event from a promise rejection where the `reason` is a primitive.\n *\n * @param reason: The `reason` property of the promise rejection\n * @returns An Event object with an appropriate `exception` value\n */\nfunction _eventFromRejectionWithPrimitive(reason) {\n  return {\n    exception: {\n      values: [\n        {\n          type: 'UnhandledRejection',\n          // String() is needed because the Primitive type includes symbols (which can't be automatically stringified)\n          value: `Non-Error promise rejection captured with value: ${String(reason)}`,\n        },\n      ],\n    },\n  };\n}\n\nfunction _enhanceEventWithInitialFrame(\n  event,\n  url,\n  line,\n  column,\n) {\n  // event.exception\n  const e = (event.exception = event.exception || {});\n  // event.exception.values\n  const ev = (e.values = e.values || []);\n  // event.exception.values[0]\n  const ev0 = (ev[0] = ev[0] || {});\n  // event.exception.values[0].stacktrace\n  const ev0s = (ev0.stacktrace = ev0.stacktrace || {});\n  // event.exception.values[0].stacktrace.frames\n  const ev0sf = (ev0s.frames = ev0s.frames || []);\n\n  const colno = column;\n  const lineno = line;\n  const filename = isString(url) && url.length > 0 ? url : getLocationHref();\n\n  // event.exception.values[0].stacktrace.frames\n  if (ev0sf.length === 0) {\n    ev0sf.push({\n      colno,\n      filename,\n      function: UNKNOWN_FUNCTION,\n      in_app: true,\n      lineno,\n    });\n  }\n\n  return event;\n}\n\nfunction globalHandlerLog(type) {\n  DEBUG_BUILD && logger.log(`Global Handler attached: ${type}`);\n}\n\nfunction getOptions() {\n  const client = getClient();\n  const options = client?.getOptions() || {\n    stackParser: () => [],\n    attachStacktrace: false,\n  };\n  return options;\n}\n\nexport { globalHandlersIntegration };\n//# sourceMappingURL=globalhandlers.js.map\n","import { defineIntegration, getLocationHref } from '@sentry/core';\nimport { WINDOW } from '../helpers.js';\n\n/**\n * Collects information about HTTP request headers and\n * attaches them to the event.\n */\nconst httpContextIntegration = defineIntegration(() => {\n  return {\n    name: 'HttpContext',\n    preprocessEvent(event) {\n      // if none of the information we want exists, don't bother\n      if (!WINDOW.navigator && !WINDOW.location && !WINDOW.document) {\n        return;\n      }\n\n      // grab as much info as exists and add it to the event\n      const url = event.request?.url || getLocationHref();\n      const { referrer } = WINDOW.document || {};\n      const { userAgent } = WINDOW.navigator || {};\n\n      const headers = {\n        ...event.request?.headers,\n        ...(referrer && { Referer: referrer }),\n        ...(userAgent && { 'User-Agent': userAgent }),\n      };\n      const request = {\n        ...event.request,\n        ...(url && { url }),\n        headers,\n      };\n\n      event.request = request;\n    },\n  };\n});\n\nexport { httpContextIntegration };\n//# sourceMappingURL=httpcontext.js.map\n","import { defineIntegration, applyAggregateErrorsToEvent } from '@sentry/core';\nimport { exceptionFromError } from '../eventbuilder.js';\n\nconst DEFAULT_KEY = 'cause';\nconst DEFAULT_LIMIT = 5;\n\nconst INTEGRATION_NAME = 'LinkedErrors';\n\nconst _linkedErrorsIntegration = ((options = {}) => {\n  const limit = options.limit || DEFAULT_LIMIT;\n  const key = options.key || DEFAULT_KEY;\n\n  return {\n    name: INTEGRATION_NAME,\n    preprocessEvent(event, hint, client) {\n      const options = client.getOptions();\n\n      applyAggregateErrorsToEvent(\n        // This differs from the LinkedErrors integration in core by using a different exceptionFromError function\n        exceptionFromError,\n        options.stackParser,\n        key,\n        limit,\n        event,\n        hint,\n      );\n    },\n  };\n}) ;\n\n/**\n * Aggregrate linked errors in an event.\n */\nconst linkedErrorsIntegration = defineIntegration(_linkedErrorsIntegration);\n\nexport { linkedErrorsIntegration };\n//# sourceMappingURL=linkederrors.js.map\n","import { inboundFiltersIntegration, functionToStringIntegration, dedupeIntegration, consoleSandbox, supportsFetch, logger, getIntegrationsToSetup, stackParserFromStackParserOptions, initAndBind, getCurrentScope, lastEventId, getReportDialogEndpoint, getLocationHref } from '@sentry/core';\nimport { BrowserClient } from './client.js';\nimport { DEBUG_BUILD } from './debug-build.js';\nimport { WINDOW } from './helpers.js';\nimport { breadcrumbsIntegration } from './integrations/breadcrumbs.js';\nimport { browserApiErrorsIntegration } from './integrations/browserapierrors.js';\nimport { browserSessionIntegration } from './integrations/browsersession.js';\nimport { globalHandlersIntegration } from './integrations/globalhandlers.js';\nimport { httpContextIntegration } from './integrations/httpcontext.js';\nimport { linkedErrorsIntegration } from './integrations/linkederrors.js';\nimport { defaultStackParser } from './stack-parsers.js';\nimport { makeFetchTransport } from './transports/fetch.js';\n\n/** Get the default integrations for the browser SDK. */\nfunction getDefaultIntegrations(_options) {\n  /**\n   * Note: Please make sure this stays in sync with Angular SDK, which re-exports\n   * `getDefaultIntegrations` but with an adjusted set of integrations.\n   */\n  return [\n    // TODO(v10): Replace with `eventFiltersIntegration` once we remove the deprecated `inboundFiltersIntegration`\n    // eslint-disable-next-line deprecation/deprecation\n    inboundFiltersIntegration(),\n    functionToStringIntegration(),\n    browserApiErrorsIntegration(),\n    breadcrumbsIntegration(),\n    globalHandlersIntegration(),\n    linkedErrorsIntegration(),\n    dedupeIntegration(),\n    httpContextIntegration(),\n    browserSessionIntegration(),\n  ];\n}\n\n/** Exported only for tests. */\nfunction applyDefaultOptions(optionsArg = {}) {\n  const defaultOptions = {\n    defaultIntegrations: getDefaultIntegrations(),\n    release:\n      typeof __SENTRY_RELEASE__ === 'string' // This allows build tooling to find-and-replace __SENTRY_RELEASE__ to inject a release value\n        ? __SENTRY_RELEASE__\n        : WINDOW.SENTRY_RELEASE?.id, // This supports the variable that sentry-webpack-plugin injects\n    sendClientReports: true,\n  };\n\n  return {\n    ...defaultOptions,\n    ...dropTopLevelUndefinedKeys(optionsArg),\n  };\n}\n\n/**\n * In contrast to the regular `dropUndefinedKeys` method,\n * this one does not deep-drop keys, but only on the top level.\n */\nfunction dropTopLevelUndefinedKeys(obj) {\n  const mutatetedObj = {};\n\n  for (const k of Object.getOwnPropertyNames(obj)) {\n    const key = k ;\n    if (obj[key] !== undefined) {\n      mutatetedObj[key] = obj[key];\n    }\n  }\n\n  return mutatetedObj;\n}\n\nfunction shouldShowBrowserExtensionError() {\n  const windowWithMaybeExtension =\n    typeof WINDOW.window !== 'undefined' && (WINDOW );\n  if (!windowWithMaybeExtension) {\n    // No need to show the error if we're not in a browser window environment (e.g. service workers)\n    return false;\n  }\n\n  const extensionKey = windowWithMaybeExtension.chrome ? 'chrome' : 'browser';\n  const extensionObject = windowWithMaybeExtension[extensionKey];\n\n  const runtimeId = extensionObject?.runtime?.id;\n  const href = getLocationHref() || '';\n\n  const extensionProtocols = ['chrome-extension:', 'moz-extension:', 'ms-browser-extension:', 'safari-web-extension:'];\n\n  // Running the SDK in a dedicated extension page and calling Sentry.init is fine; no risk of data leakage\n  const isDedicatedExtensionPage =\n    !!runtimeId && WINDOW === WINDOW.top && extensionProtocols.some(protocol => href.startsWith(`${protocol}//`));\n\n  // Running the SDK in NW.js, which appears like a browser extension but isn't, is also fine\n  // see: https://github.com/getsentry/sentry-javascript/issues/12668\n  const isNWjs = typeof windowWithMaybeExtension.nw !== 'undefined';\n\n  return !!runtimeId && !isDedicatedExtensionPage && !isNWjs;\n}\n\n/**\n * A magic string that build tooling can leverage in order to inject a release value into the SDK.\n */\n\n/**\n * The Sentry Browser SDK Client.\n *\n * To use this SDK, call the {@link init} function as early as possible when\n * loading the web page. To set context information or send manual events, use\n * the provided methods.\n *\n * @example\n *\n * ```\n *\n * import { init } from '@sentry/browser';\n *\n * init({\n *   dsn: '__DSN__',\n *   // ...\n * });\n * ```\n *\n * @example\n * ```\n *\n * import { addBreadcrumb } from '@sentry/browser';\n * addBreadcrumb({\n *   message: 'My Breadcrumb',\n *   // ...\n * });\n * ```\n *\n * @example\n *\n * ```\n *\n * import * as Sentry from '@sentry/browser';\n * Sentry.captureMessage('Hello, world!');\n * Sentry.captureException(new Error('Good bye'));\n * Sentry.captureEvent({\n *   message: 'Manual',\n *   stacktrace: [\n *     // ...\n *   ],\n * });\n * ```\n *\n * @see {@link BrowserOptions} for documentation on configuration options.\n */\nfunction init(browserOptions = {}) {\n  const options = applyDefaultOptions(browserOptions);\n\n  if (!options.skipBrowserExtensionCheck && shouldShowBrowserExtensionError()) {\n    if (DEBUG_BUILD) {\n      consoleSandbox(() => {\n        // eslint-disable-next-line no-console\n        console.error(\n          '[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/',\n        );\n      });\n    }\n    return;\n  }\n\n  if (DEBUG_BUILD && !supportsFetch()) {\n    logger.warn(\n      'No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.',\n    );\n  }\n  const clientOptions = {\n    ...options,\n    stackParser: stackParserFromStackParserOptions(options.stackParser || defaultStackParser),\n    integrations: getIntegrationsToSetup(options),\n    transport: options.transport || makeFetchTransport,\n  };\n\n  return initAndBind(BrowserClient, clientOptions);\n}\n\n/**\n * Present the user with a report dialog.\n *\n * @param options Everything is optional, we try to fetch all info need from the global scope.\n */\nfunction showReportDialog(options = {}) {\n  // doesn't work without a document (React Native)\n  if (!WINDOW.document) {\n    DEBUG_BUILD && logger.error('Global document not defined in showReportDialog call');\n    return;\n  }\n\n  const scope = getCurrentScope();\n  const client = scope.getClient();\n  const dsn = client?.getDsn();\n\n  if (!dsn) {\n    DEBUG_BUILD && logger.error('DSN not configured for showReportDialog call');\n    return;\n  }\n\n  if (scope) {\n    options.user = {\n      ...scope.getUser(),\n      ...options.user,\n    };\n  }\n\n  if (!options.eventId) {\n    const eventId = lastEventId();\n    if (eventId) {\n      options.eventId = eventId;\n    }\n  }\n\n  const script = WINDOW.document.createElement('script');\n  script.async = true;\n  script.crossOrigin = 'anonymous';\n  script.src = getReportDialogEndpoint(dsn, options);\n\n  if (options.onLoad) {\n    script.onload = options.onLoad;\n  }\n\n  const { onClose } = options;\n  if (onClose) {\n    const reportDialogClosedMessageHandler = (event) => {\n      if (event.data === '__sentry_reportdialog_closed__') {\n        try {\n          onClose();\n        } finally {\n          WINDOW.removeEventListener('message', reportDialogClosedMessageHandler);\n        }\n      }\n    };\n    WINDOW.addEventListener('message', reportDialogClosedMessageHandler);\n  }\n\n  const injectionPoint = WINDOW.document.head || WINDOW.document.body;\n  if (injectionPoint) {\n    injectionPoint.appendChild(script);\n  } else {\n    DEBUG_BUILD && logger.error('Not injecting report dialog. No injection point found in HTML');\n  }\n}\n\n/**\n * This function is here to be API compatible with the loader.\n * @hidden\n */\nfunction forceLoad() {\n  // Noop\n}\n\n/**\n * This function is here to be API compatible with the loader.\n * @hidden\n */\nfunction onLoad(callback) {\n  callback();\n}\n\nexport { applyDefaultOptions, forceLoad, getDefaultIntegrations, init, onLoad, showReportDialog };\n//# sourceMappingURL=sdk.js.map\n","import * as Sentry from '@sentry/browser';\nimport type { User } from '@sentry/browser';\n\nimport { parseConfigFragment } from '../../shared/config-fragment';\nimport { handleErrorsInFrames } from '../../shared/frame-error-capture';\nimport { warnOnce } from '../../shared/warn-once';\n\ntype SentryConfig = {\n  dsn: string;\n  environment: string;\n};\n\nlet eventsSent = 0;\nconst maxEventsToSendPerSession = 5;\n\nlet removeFrameErrorHandler: (() => void) | null = null;\n\nfunction currentScriptOrigin() {\n  // It might be possible to simplify this as `url` appears to be required\n  // according to the HTML spec.\n  //\n  // See https://html.spec.whatwg.org/multipage/webappapis.html#hostgetimportmetaproperties.\n  const url = import.meta.url;\n  if (!url) {\n    return null;\n  }\n  return new URL(url).origin;\n}\n\n/**\n * Initialize the Sentry integration.\n *\n * This will activate Sentry and enable capturing of uncaught errors and\n * unhandled promise rejections.\n */\nexport function init(config: SentryConfig) {\n  const scriptOrigin = currentScriptOrigin();\n  const allowUrls = scriptOrigin ? [scriptOrigin] : undefined;\n\n  Sentry.init({\n    dsn: config.dsn,\n    environment: config.environment,\n\n    // Only report exceptions where the stack trace references a URL that is\n    // part of our code. This reduces noise caused by third-party scripts which\n    // may be injected by browser extensions.\n    //\n    // Sentry currently always allows exceptions to bypass this list if no\n    // URL can be extracted.\n    allowUrls,\n\n    // Ignore various errors due to circumstances outside of our control.\n    ignoreErrors: [\n      // Ignore network request failures. Some of these ought to be\n      // caught and handled better but for now we are suppressing them to\n      // improve the signal-to-noise ratio.\n      'Network request failed', // Standard message prefix for `FetchError` errors\n\n      // Ignore an error that appears to come from CefSharp (embedded Chromium).\n      // See https://forum.sentry.io/t/unhandledrejection-non-error-promise-rejection-captured-with-value/14062/20\n      'Object Not Found Matching Id',\n    ],\n\n    release: '__VERSION__',\n\n    // See https://docs.sentry.io/error-reporting/configuration/filtering/?platform=javascript#before-send\n    beforeSend: (event, hint) => {\n      if (eventsSent >= maxEventsToSendPerSession) {\n        // Cap the number of events that any client instance will send, to\n        // reduce the impact on our Sentry event quotas.\n        //\n        // Sentry implements its own server-side rate limiting in addition.\n        // See https://docs.sentry.io/accounts/quotas/.\n        warnOnce(\n          'Client-side Sentry quota reached. No further Sentry events will be sent',\n        );\n        return null;\n      }\n      ++eventsSent;\n\n      // Add additional debugging information for non-Error exception types\n      // which Sentry can't serialize to a useful format automatically.\n      //\n      // See https://github.com/getsentry/sentry-javascript/issues/2210\n      try {\n        const originalErr = hint && hint.originalException;\n        if (originalErr instanceof Event) {\n          if (!event.extra) {\n            event.extra = {};\n          }\n          Object.assign(event.extra, {\n            type: originalErr.type,\n            // @ts-ignore - `detail` is a property of certain event types.\n            detail: originalErr.detail,\n            isTrusted: originalErr.isTrusted,\n          });\n        }\n      } catch {\n        // If something went wrong serializing the data, just ignore it.\n      }\n\n      return event;\n    },\n  });\n\n  try {\n    Sentry.setExtra('host_config', parseConfigFragment(window.location.href));\n  } catch {\n    // Ignore errors parsing configuration.\n  }\n\n  const isJavaScript = (script: HTMLScriptElement) =>\n    !script.type || script.type.match(/javascript|module/);\n\n  // Include information about the scripts on the page. This may help with\n  // debugging of errors caused by scripts injected by browser extensions.\n  const loadedScripts = Array.from(document.querySelectorAll('script'))\n    .filter(isJavaScript)\n    .map(script => script.src || '<inline>');\n  Sentry.setExtra('loaded_scripts', loadedScripts);\n\n  // Catch errors occuring in Hypothesis-related code in the host frame.\n  removeFrameErrorHandler = handleErrorsInFrames((err, context) => {\n    captureException(err, context);\n  });\n}\n\n/**\n * Forward an error to Sentry.\n *\n * This can be used to report errors to Sentry even if they have been caught\n * and handled by the application (eg. by presenting an error to the user).\n *\n * @param err - The error that occurred\n * @param context - A string identifying the context in which the error\n *   occurred. This is attached to the Sentry report as a tag.\n */\nexport function captureException(err: unknown, context: string) {\n  Sentry.captureException(err, {\n    tags: {\n      context,\n    },\n  });\n}\n\n/**\n * Record the user ID of the logged-in user.\n *\n * See https://docs.sentry.io/platforms/javascript/#capturing-the-user\n */\nexport function setUserInfo(user: User | null) {\n  Sentry.setUser(user);\n}\n\n/**\n * Testing aid that resets event counters and removes event handlers installed\n * by {@link init}.\n */\nexport function reset() {\n  eventsSent = 0;\n  removeFrameErrorHandler?.();\n  removeFrameErrorHandler = null;\n}\n","import type { Annotation, APIAnnotationData } from '../../types/api';\nimport { quote } from '../helpers/annotation-metadata';\nimport {\n  isShared,\n  privatePermissions,\n  sharedPermissions,\n} from '../helpers/permissions';\nimport type { SidebarStore } from '../store';\nimport type { Frame } from '../store/modules/frames';\nimport { captureException } from '../util/sentry';\nimport type { AnnotationsService } from './annotations';\nimport type { ToastMessengerService } from './toast-messenger';\n\n/** Number of annotations to import concurrently. */\nexport const MAX_CONCURRENT_IMPORTS = 5;\n\n/**\n * Non-standard metadata fields added to imported annotations.\n *\n * These are added for analytics / reporting purposes. If we decide to make\n * other uses of it, we should migrate these to a proper annotation metadata\n * field.\n */\ntype ImportExtra = {\n  extra: {\n    /** Indicator for where the annotation came from. */\n    source: 'import';\n\n    /** Original ID of the annotation that was imported. */\n    original_id?: string;\n  };\n};\n\n/**\n * The subset of annotation fields which are preserved during an import.\n */\ntype ImportData = Pick<\n  APIAnnotationData,\n  'document' | 'tags' | 'text' | 'target' | 'uri'\n> &\n  ImportExtra;\n\n/**\n * Enum of the result of an import operation for a single annotation.\n */\nexport type ImportResult =\n  /** Annotation was successfully imported. */\n  | { type: 'import'; annotation: Annotation }\n  /** Annotation was skipped because it is a duplicate. */\n  | { type: 'duplicate'; annotation: Annotation }\n  /** Annotation import failed. */\n  | { type: 'error'; error: Error };\n\n/**\n * Return a copy of `ann` that contains only fields which can be preserved by\n * an import performed on the client, overwriting some of them with the ones\n * from current frame, if provided\n */\nfunction getImportData(\n  ann: APIAnnotationData,\n  currentFrame: Frame | null,\n): ImportData {\n  return {\n    target: ann.target,\n    tags: ann.tags,\n    text: ann.text,\n    uri: currentFrame?.uri ?? ann.uri,\n    document: currentFrame?.metadata ?? ann.document,\n    extra: {\n      source: 'import',\n      original_id: ann.id,\n    },\n  };\n}\n\n/**\n * Summarize the results of an import operation.\n *\n * Returns an object which can easily mapped to a toast message notification.\n */\nfunction importStatus(results: ImportResult[]): {\n  messageType: 'success' | 'notice' | 'error';\n  message: string;\n} {\n  // In the event of an error we include the message of the first error as a\n  // debugging aid. Ideally this would be presented separately from the main\n  // message in a notification, but our toast message component doesn't\n  // currently support that.\n  const errors = results.filter(r => r.type === 'error') as Array<\n    Extract<ImportResult, { type: 'error' }>\n  >;\n  const errorMessage =\n    errors.length > 0\n      ? `${errors.length} imports failed (${errors[0].error.message})`\n      : '';\n\n  const importCount = results.filter(r => r.type === 'import').length;\n  const importMessage =\n    importCount > 0 ? `${importCount} annotations imported` : '';\n\n  const dupCount = results.filter(r => r.type === 'duplicate').length;\n  const dupMessage = dupCount > 0 ? `${dupCount} duplicates skipped` : '';\n\n  let messageType: 'success' | 'notice' | 'error';\n  if (errors.length === 0) {\n    if (importCount > 0) {\n      messageType = 'success';\n    } else {\n      messageType = 'notice';\n    }\n  } else if (importCount > 0) {\n    messageType = 'notice';\n  } else {\n    messageType = 'error';\n  }\n\n  const message = [importMessage, errorMessage, dupMessage]\n    .filter(msg => msg.length > 0)\n    .join(', ');\n\n  return { messageType, message };\n}\n\nfunction arraysEqual<T>(a: T[], b: T[]): boolean {\n  return a.length === b.length && a.every((x, i) => b[i] === x);\n}\n\n/**\n * Return true if two annotations should be considered duplicates based on their\n * content.\n */\nfunction duplicateMatch(a: APIAnnotationData, b: APIAnnotationData): boolean {\n  if (a.text !== b.text) {\n    return false;\n  }\n  if (!arraysEqual(a.tags, b.tags)) {\n    return false;\n  }\n  return quote(a) === quote(b);\n}\n\n/**\n * Imports annotations from a Hypothesis JSON file.\n *\n * @inject\n */\nexport class ImportAnnotationsService {\n  private _annotationsService: AnnotationsService;\n  private _store: SidebarStore;\n  private _toastMessenger: ToastMessengerService;\n\n  constructor(\n    store: SidebarStore,\n    annotationsService: AnnotationsService,\n    toastMessenger: ToastMessengerService,\n  ) {\n    this._store = store;\n    this._annotationsService = annotationsService;\n    this._toastMessenger = toastMessenger;\n  }\n\n  /**\n   * Import annotations.\n   *\n   * Returns an array of the results of each import. The results are in the\n   * same order as the input annotation list. Each result can either be a\n   * successful import, a skipped import, or an error.\n   */\n  async import(anns: APIAnnotationData[]): Promise<ImportResult[]> {\n    this._store.beginImport(anns.length);\n\n    const currentUser = this._store.profile().userid;\n    if (!currentUser) {\n      throw new Error('Cannot import when logged out');\n    }\n    const currentGroup = this._store.focusedGroupId();\n    if (!currentGroup) {\n      throw new Error('Cannot import when no group is selected');\n    }\n\n    const existingAnns = this._store.allAnnotations();\n    const currentFrame = this._store.defaultContentFrame();\n\n    const importAnn = async (ann: APIAnnotationData): Promise<ImportResult> => {\n      const existingAnn = existingAnns.find(ex => duplicateMatch(ann, ex));\n      if (existingAnn) {\n        return { type: 'duplicate', annotation: existingAnn };\n      }\n\n      try {\n        // Strip out all the fields that are ignored in an import, and overwrite\n        // the URI with current document's URI.\n        const importData = getImportData(ann, currentFrame);\n\n        // Fill out the annotation with default values for the current user and\n        // group.\n        const saveData =\n          this._annotationsService.annotationFromData(importData);\n\n        // Preserve shared / private status from existing annotation. We map\n        // the existing permissions to a shared/not-shared boolean and\n        // regenerate permissions, since the current user/group may differ.\n        saveData.permissions = isShared(ann.permissions)\n          ? sharedPermissions(currentUser, currentGroup)\n          : privatePermissions(currentUser);\n\n        // Persist the annotation.\n        const saved = await this._annotationsService.save(saveData);\n\n        return { type: 'import', annotation: saved };\n      } catch (error) {\n        captureException(error, 'annotation-import');\n        return { type: 'error', error };\n      }\n    };\n\n    // Save annotations to the server, allowing a maximum of\n    // `MAX_CONCURRENT_IMPORTS` in-flight requests at a time.\n    const results: ImportResult[] = [];\n    const queue = anns.map((ann, index) => ({ ann, index }));\n    const active: Array<Promise<void>> = [];\n    while (queue.length > 0) {\n      const task = queue.shift()!;\n      const done = importAnn(task.ann)\n        .then(result => {\n          this._store.completeImport(1);\n          results[task.index] = result;\n        })\n        .then(() => {\n          const idx = active.indexOf(done);\n          // nb. `idx` should always be >= 0 here.\n          if (idx !== -1) {\n            active.splice(idx, 1);\n          }\n        });\n      active.push(done);\n\n      // When we reach max concurrency, wait for at least one import to complete.\n      if (active.length >= MAX_CONCURRENT_IMPORTS) {\n        await Promise.race(active);\n      }\n    }\n\n    // Wait for all remaining imports to complete.\n    await Promise.all(active);\n\n    const { messageType, message } = importStatus(results);\n    if (messageType === 'success') {\n      this._toastMessenger.success(message);\n    } else if (messageType === 'notice') {\n      this._toastMessenger.notice(message, {\n        autoDismiss: false,\n      });\n    } else if (messageType === 'error') {\n      this._toastMessenger.error(message, {\n        autoDismiss: false,\n      });\n    }\n\n    return results;\n  }\n}\n","import type { Annotation } from '../../types/api';\nimport { isReply } from '../helpers/annotation-metadata';\nimport { SearchClient } from '../search-client';\nimport type { SortBy, SortOrder } from '../search-client';\nimport type { SidebarStore } from '../store';\nimport type { APIService } from './api';\nimport type { StreamFilter } from './stream-filter';\nimport type { StreamerService } from './streamer';\n\nexport type LoadAnnotationOptions = {\n  groupId: string;\n  uris?: string[];\n  /**\n   * If number of annotations in search results exceeds this value, do not load\n   * annotations (see: `SearchClient`)\n   */\n  maxResults?: number;\n\n  /**\n   * `sortBy` and `sortOrder` control in what order annotations are loaded. To\n   * minimize visible content changing as annotations load, `sortBy` and\n   * `sortOrder` should be chosen to correlate with the expected presentation\n   * order of annotations/threads in the current view.\n   */\n  sortBy?: SortBy;\n  sortOrder?: SortOrder;\n\n  /**\n   * Optional error handler for SearchClient. Default error handling logs errors\n   * to console.\n   */\n  onError?: (error: Error) => void;\n\n  /**\n   * Set the websocket stream to filter by either URIs or groupIds.\n   */\n  streamFilterBy?: 'uri' | 'group';\n};\n\n/**\n * A service for fetching annotations via the Hypothesis API and loading them\n * into the store.\n *\n * In addition to fetching annotations it also handles configuring the\n * WebSocket connection so that appropriate real-time updates are received\n * for the set of annotations being displayed.\n *\n * @inject\n */\nexport class LoadAnnotationsService {\n  private _api: APIService;\n  private _store: SidebarStore;\n  private _streamer: StreamerService;\n  private _streamFilter: StreamFilter;\n  private _searchClient: SearchClient | null;\n\n  constructor(\n    api: APIService,\n    store: SidebarStore,\n    streamer: StreamerService,\n    streamFilter: StreamFilter,\n  ) {\n    this._api = api;\n    this._store = store;\n    this._streamer = streamer;\n    this._streamFilter = streamFilter;\n\n    this._searchClient = null;\n  }\n\n  /**\n   * Load annotations from Hypothesis.\n   *\n   * The existing set of loaded annotations is cleared before the new set\n   * is fetched. If an existing annotation fetch is in progress it is canceled.\n   */\n  load({\n    groupId,\n    uris,\n    onError,\n    maxResults,\n    sortBy,\n    sortOrder,\n    streamFilterBy = 'uri',\n  }: LoadAnnotationOptions) {\n    this._store.removeAnnotations(this._store.savedAnnotations());\n\n    // Cancel previously running search client.\n    //\n    // This will emit the \"end\" event for the existing client and trigger cleanup\n    // associated with that client (eg. resetting the count of in-flight\n    // annotation fetches).\n    if (this._searchClient) {\n      this._searchClient.cancel();\n    }\n\n    // Set the filter for the websocket stream\n    switch (streamFilterBy) {\n      case 'group':\n        this._streamFilter\n          .resetFilter()\n          .addClause('/group', 'equals', groupId, true);\n        this._streamer.setConfig('filter', {\n          filter: this._streamFilter.getFilter(),\n        });\n        break;\n      case 'uri':\n      default:\n        if (uris && uris.length > 0) {\n          this._streamFilter.resetFilter().addClause('/uri', 'one_of', uris);\n          this._streamer.setConfig('filter', {\n            filter: this._streamFilter.getFilter(),\n          });\n        }\n        break;\n    }\n\n    const searchOptions = {\n      incremental: true,\n      separateReplies: false,\n      maxResults,\n\n      // Annotations are fetched in order of creation by default. This is expected\n      // to roughly correspond to the order in which threads end up being sorted\n      // because:\n      //\n      // 1. The default thread sort order in the sidebar is by document location\n      // 2. When users annotate a document, they will tend to annotate content in\n      //    document order. Annotations near the top of the document will\n      //    tend to have earlier creation dates.\n      //\n      // If the backend would allow us to sort on document location, we could do even better.\n\n      sortBy,\n      sortOrder,\n    };\n\n    this._searchClient = new SearchClient(this._api.search, searchOptions);\n\n    this._searchClient.on('resultCount', (count: number) => {\n      this._store.setAnnotationResultCount(count);\n    });\n\n    this._searchClient.on('results', (results: Annotation[]) => {\n      if (results.length) {\n        this._store.addAnnotations(results);\n      }\n    });\n\n    this._searchClient.on('error', (error: Error) => {\n      if (typeof onError === 'function') {\n        onError(error);\n      } else {\n        console.error(error);\n      }\n    });\n\n    this._searchClient.on('end', () => {\n      // Remove client as it's no longer active.\n      this._searchClient = null;\n\n      if (uris && uris.length > 0) {\n        this._store.frames().forEach(frame => {\n          if (uris.indexOf(frame.uri) >= 0) {\n            this._store.updateFrameAnnotationFetchStatus(frame.uri, true);\n          }\n        });\n      }\n      this._store.annotationFetchFinished();\n    });\n\n    this._store.annotationFetchStarted();\n    this._searchClient.get({ group: groupId, uri: uris });\n  }\n\n  /**\n   * Fetch all annotations in the same thread as `id` and add them to the store.\n   *\n   * @param id - Annotation ID. This may be an annotation or a reply.\n   * @return Top-level annotation in the thread, followed by any replies.\n   */\n  async loadThread(id: string) {\n    let annotation;\n    let replySearchResult;\n\n    // Clear out any annotations already in the store before fetching new ones\n    this._store.clearAnnotations();\n\n    try {\n      this._store.annotationFetchStarted();\n      // 1. Fetch the annotation indicated by `id` — the target annotation\n      annotation = await this._api.annotation.get({ id });\n\n      // 2. If annotation is not the top-level annotation in its thread,\n      //    fetch the top-level annotation\n      if (isReply(annotation)) {\n        annotation = await this._api.annotation.get({\n          id: annotation.references![0],\n        });\n      }\n\n      // 3. Fetch all of the annotations in the thread, based on the\n      //    top-level annotation\n      replySearchResult = await this._api.search({ references: annotation.id });\n    } finally {\n      this._store.annotationFetchFinished();\n    }\n    const threadAnnotations = [annotation, ...replySearchResult.rows];\n\n    this._store.addAnnotations(threadAnnotations);\n\n    // If we've been successful in retrieving a thread, with a top-level annotation,\n    // configure the connection to the real-time update service to send us\n    // updates to any of the annotations in the thread.\n    if (!isReply(annotation)) {\n      const id = annotation.id!;\n      this._streamFilter\n        .addClause('/references', 'one_of', id, true)\n        .addClause('/id', 'equals', id, true);\n      this._streamer.setConfig('filter', {\n        filter: this._streamFilter.getFilter(),\n      });\n      this._streamer.connect();\n    }\n\n    return threadAnnotations;\n  }\n}\n","type BasicStorage = Omit<Storage, 'length' | 'clear' | 'key'>;\n\n/**\n * Fallback in-memory store if `localStorage` is not read/writable.\n */\nclass InMemoryStorage implements BasicStorage {\n  private _store: Map<string, string>;\n\n  constructor() {\n    this._store = new Map();\n  }\n\n  getItem(key: string): string | null {\n    return this._store.get(key) ?? null;\n  }\n\n  setItem(key: string, value: string) {\n    this._store.set(key, value);\n  }\n\n  removeItem(key: string) {\n    this._store.delete(key);\n  }\n}\n\n/**\n * A wrapper around the `localStorage` API which provides a fallback to\n * in-memory storage in browsers that block access to `window.localStorage`.\n * in third-party iframes.\n *\n * This service also provides convenience methods set and fetch JSON-serializable\n * values.\n */\n// @inject\nexport class LocalStorageService {\n  private _storage: BasicStorage;\n\n  constructor($window: Window) {\n    const testKey = 'hypothesis.testKey';\n\n    try {\n      // Test whether we can read/write localStorage.\n      this._storage = $window.localStorage;\n      $window.localStorage.setItem(testKey, testKey);\n      $window.localStorage.getItem(testKey);\n      $window.localStorage.removeItem(testKey);\n    } catch {\n      this._storage = new InMemoryStorage();\n    }\n  }\n\n  /**\n   * Look up a value in local storage.\n   */\n  getItem(key: string): string | null {\n    return this._storage.getItem(key);\n  }\n\n  /**\n   * Look up and deserialize a value from storage.\n   */\n  getObject<T = unknown>(key: string): T | null {\n    const item = this._storage.getItem(key);\n    return item ? (JSON.parse(item) as T) : null;\n  }\n\n  /**\n   * Set a value in local storage.\n   */\n  setItem(key: string, value: string) {\n    this._storage.setItem(key, value);\n  }\n\n  /**\n   * Serialize `value` to JSON and persist it.\n   */\n  setObject(key: string, value: any) {\n    const repr = JSON.stringify(value);\n    this._storage.setItem(key, repr);\n  }\n\n  /**\n   * Remove an item from storage.\n   */\n  removeItem(key: string) {\n    this._storage.removeItem(key);\n  }\n}\n","import type { SidebarStore } from '../store';\nimport type { Key } from '../store/modules/defaults';\nimport { entries } from '../util/collections';\nimport { watch } from '../util/watch';\nimport type { LocalStorageService } from './local-storage';\n\nconst DEFAULT_KEYS: Record<Key, string> = {\n  annotationPrivacy: 'hypothesis.privacy',\n  focusedGroup: 'hypothesis.groups.focus',\n};\n\n/**\n * A service for reading and persisting convenient client-side defaults for\n * the (browser) user.\n *\n * @inject\n */\nexport class PersistedDefaultsService {\n  private _storage: LocalStorageService;\n  private _store: SidebarStore;\n\n  constructor(localStorage: LocalStorageService, store: SidebarStore) {\n    this._storage = localStorage;\n    this._store = store;\n  }\n\n  /**\n   * Initially populate the store with any available persisted defaults,\n   * then subscribe to the store in order to persist any changes to\n   * those defaults.\n   */\n  init() {\n    /**\n     * Store subscribe callback for persisting changes to defaults. It will only\n     * persist defaults that it \"knows about\" via `DEFAULT_KEYS`.\n     */\n    const persistChangedDefaults = (\n      defaults: Record<Key, any>,\n      prevDefaults: Record<Key, any>,\n    ) => {\n      for (const [defaultKey, newValue] of entries(defaults)) {\n        if (\n          prevDefaults[defaultKey] !== newValue &&\n          defaultKey in DEFAULT_KEYS\n        ) {\n          this._storage.setItem(DEFAULT_KEYS[defaultKey], newValue);\n        }\n      }\n    };\n\n    // Read persisted defaults into the store\n    for (const [defaultKey, key] of entries(DEFAULT_KEYS)) {\n      // `localStorage.getItem` will return `null` for a non-existent key\n      const defaultValue = this._storage.getItem(key);\n      this._store.setDefault(defaultKey, defaultValue);\n    }\n\n    // Listen for changes to those defaults from the store and persist them\n    watch(\n      this._store.subscribe,\n      () => this._store.getDefaults(),\n      persistChangedDefaults,\n    );\n  }\n}\n","import type { SidebarStore } from '../store';\n\ntype RouteName = 'annotation' | 'notebook' | 'profile' | 'stream' | 'sidebar';\n\ntype RouteParams = Record<string, string>;\n\n/**\n * A service that manages the association between the route and route parameters\n * implied by the URL and the corresponding route state in the store.\n */\n// @inject\nexport class RouterService {\n  private _window: Window;\n  private _store: SidebarStore;\n  private _didRegisterPopstateListener: boolean;\n\n  constructor($window: Window, store: SidebarStore) {\n    this._window = $window;\n    this._store = store;\n    this._didRegisterPopstateListener = false;\n  }\n\n  /**\n   * Return the name and parameters of the current route.\n   */\n  currentRoute(): { route: RouteName; params: RouteParams } {\n    const path = this._window.location.pathname;\n    const pathSegments = path.slice(1).split('/');\n    const searchParams = new URLSearchParams(this._window.location.search);\n\n    const params: Record<string, string> = {};\n    for (const [key, value] of searchParams) {\n      params[key] = value;\n    }\n\n    // The extension puts client resources under `/client/` to separate them\n    // from extension-specific resources. Ignore this part.\n    if (pathSegments[0] === 'client') {\n      pathSegments.shift();\n    }\n\n    // Routes loaded from h have no file extensions (eg. `/a/:id`, `/notebook`).\n    //\n    // Routes loaded from custom builds or the Chrome extension may have a '.html'\n    // extension.\n    const mainSegment = pathSegments[0].replace(/\\.html$/, '');\n\n    let route: RouteName;\n\n    switch (mainSegment) {\n      case 'a':\n        route = 'annotation';\n        params.id = pathSegments[1] || '';\n        break;\n      case 'notebook':\n        route = 'notebook';\n        break;\n      case 'user-profile':\n        route = 'profile';\n        break;\n      case 'stream':\n        route = 'stream';\n        break;\n      default:\n        route = 'sidebar';\n        break;\n    }\n\n    return { route, params };\n  }\n\n  /**\n   * Generate a URL for a given route.\n   */\n  routeUrl(name: RouteName, params: RouteParams = {}) {\n    let url;\n    const queryParams = { ...params };\n\n    switch (name) {\n      case 'annotation':\n        {\n          const id = params.id;\n          delete queryParams.id;\n          url = `/a/${id}`;\n        }\n        break;\n      case 'notebook':\n        url = '/notebook';\n        break;\n      case 'profile':\n        url = '/user-profile';\n        break;\n      case 'stream':\n        url = '/stream';\n        break;\n      default:\n        throw new Error(`Cannot generate URL for route \"${name}\"`);\n    }\n\n    let hasParams = false;\n    const searchParams = new URLSearchParams();\n    for (const [key, value] of Object.entries(queryParams)) {\n      hasParams = true;\n      searchParams.set(key, value);\n    }\n\n    if (hasParams) {\n      url += '?' + searchParams.toString();\n    }\n\n    return url;\n  }\n\n  /**\n   * Synchronize the route name and parameters in the store with the current\n   * URL.\n   *\n   * The first call to this method also registers a listener for future back/forwards\n   * navigation in the browser.\n   */\n  sync() {\n    const { route, params } = this.currentRoute();\n    this._store.changeRoute(route, params);\n\n    // Set up listener for back/forward navigation. We do this in `sync()` to\n    // avoid the route being changed by a \"popstate\" emitted by the browser on\n    // document load (which Safari and Chrome do).\n    if (!this._didRegisterPopstateListener) {\n      this._window.addEventListener('popstate', () => {\n        // All the state we need to update the route is contained in the URL, which\n        // has already been updated at this point, so just sync the store route\n        // to match the URL.\n        this.sync();\n      });\n      this._didRegisterPopstateListener = true;\n    }\n  }\n\n  /**\n   * Navigate to a given route.\n   */\n  navigate(name: RouteName, params: RouteParams) {\n    this._window.history.pushState({}, '', this.routeUrl(name, params));\n    this.sync();\n  }\n}\n","import type { SidebarStore } from '../store';\nimport type { APIRoutesService } from './api-routes';\n\n/**\n * Service for fetching the data needed to render URLs that point to the H\n * service.\n *\n * The H API has an `/api/links` endpoint that returns a map of link name to\n * URL template for URLs that point to the H API. This service fetches that\n * data and persists it in the store.\n *\n * To use a link within a UI component, use `store.getLink(name, params)`.\n *\n * @inject\n */\nexport class ServiceURLService {\n  private _apiRoutes: APIRoutesService;\n  private _store: SidebarStore;\n\n  constructor(apiRoutes: APIRoutesService, store: SidebarStore) {\n    this._apiRoutes = apiRoutes;\n    this._store = store;\n  }\n\n  /**\n   * Fetch URL templates for links from the API and persist them in the store.\n   */\n  async init() {\n    try {\n      const links = await this._apiRoutes.links();\n      this._store.updateLinks(links);\n    } catch (error) {\n      console.warn(`Failed to fetch Hypothesis links: ${error.message}`);\n    }\n  }\n}\n","import type { Profile } from '../../types/api';\nimport type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from '../config/service-config';\nimport type { SidebarStore } from '../store';\nimport { retryPromiseOperation } from '../util/retry';\nimport * as sentry from '../util/sentry';\nimport type { APIService } from './api';\nimport type { AuthService } from './auth';\nimport type { ToastMessengerService } from './toast-messenger';\n\nconst CACHE_TTL = 5 * 60 * 1000; // 5 minutes\n\n/**\n * This service handles fetching the user's profile, updating profile settings\n * and logging out.\n *\n * @inject\n */\nexport class SessionService {\n  private _store: SidebarStore;\n  private _api: APIService;\n  private _auth: AuthService;\n  private _toastMessenger: ToastMessengerService;\n  private _authority: string | null;\n  private _lastLoad: Promise<Profile> | null;\n  private _lastLoadTime: number | null;\n\n  constructor(\n    store: SidebarStore,\n    api: APIService,\n    auth: AuthService,\n    settings: SidebarSettings,\n    toastMessenger: ToastMessengerService,\n  ) {\n    this._api = api;\n    this._auth = auth;\n    this._store = store;\n    this._toastMessenger = toastMessenger;\n\n    this._authority = serviceConfig(settings)?.authority ?? null;\n    this._lastLoad = null;\n    this._lastLoadTime = null;\n\n    // Re-fetch profile when user logs in or out in another tab.\n    auth.on('oauthTokensChanged', () => this.reload());\n  }\n\n  /**\n   * Fetch the user's profile from the annotation service.\n   *\n   * If the profile has been previously fetched within `CACHE_TTL` ms, then this\n   * method returns a cached profile instead of triggering another fetch.\n   *\n   * @return A promise for the user's profile data.\n   */\n  load(): Promise<Profile> {\n    if (\n      !this._lastLoad ||\n      !this._lastLoadTime ||\n      Date.now() - this._lastLoadTime > CACHE_TTL\n    ) {\n      // The load attempt is automatically retried with a backoff.\n      //\n      // This serves to make loading the app in the extension cope better with\n      // flakey connectivity but it also throttles the frequency of calls to\n      // the /app endpoint.\n      this._lastLoadTime = Date.now();\n      this._lastLoad = retryPromiseOperation(() => {\n        const opts = this._authority ? { authority: this._authority } : {};\n        return this._api.profile.read(opts);\n      })\n        .then(session => {\n          this.update(session);\n          this._lastLoadTime = Date.now();\n          return session;\n        })\n        .catch(err => {\n          this._lastLoadTime = null;\n          throw err;\n        });\n    }\n    return this._lastLoad;\n  }\n\n  /**\n   * Store the preference server-side that the user dismissed the sidebar\n   * tutorial and then update the local profile data.\n   */\n  async dismissSidebarTutorial() {\n    const updatedProfile = await this._api.profile.update(\n      {},\n      { preferences: { show_sidebar_tutorial: false } },\n    );\n    this.update(updatedProfile);\n  }\n\n  /**\n   * Update the local profile data.\n   *\n   * This method can be used to update the profile data in the client when new\n   * data is pushed from the server via the real-time API.\n   *\n   * @return The updated profile data\n   */\n  update(profile: Profile): Profile {\n    const prevProfile = this._store.profile();\n    const userChanged = profile.userid !== prevProfile.userid;\n\n    this._store.updateProfile(profile);\n\n    this._lastLoad = Promise.resolve(profile);\n    this._lastLoadTime = Date.now();\n\n    if (userChanged) {\n      // Associate error reports with the current user in Sentry.\n      if (profile.userid) {\n        sentry.setUserInfo({\n          id: profile.userid,\n        });\n      } else {\n        sentry.setUserInfo(null);\n      }\n    }\n\n    return profile;\n  }\n\n  /**\n   * Log the user out of the current session and re-fetch the profile.\n   */\n  async logout() {\n    try {\n      await this._auth.logout();\n      return this.reload();\n    } catch (err) {\n      this._toastMessenger.error('Log out failed');\n      throw new Error(err);\n    }\n  }\n\n  /**\n   * Clear the cached profile information and re-fetch it from the server.\n   *\n   * This can be used to refresh the user's profile state after logging in.\n   *\n   * @return {Promise<Profile>}\n   */\n  reload() {\n    this._lastLoad = null;\n    this._lastLoadTime = null;\n    return this.load();\n  }\n}\n","/**\n * Filter clause against which annotation updates are tested before being\n * sent to the client.\n */\ntype FilterClause = {\n  field: '/group' | '/id' | '/references' | '/uri';\n  operator: 'equals' | 'one_of';\n  value: string | string[];\n\n  /**\n   * @todo Backend doesn't use this at present, but it seems important for\n   *       certain fields (eg. ID).\n   */\n  case_sensitive: boolean;\n};\n\ntype Filter = {\n  clauses: FilterClause[];\n\n  /**\n   * @deprecated\n   * @todo Remove this, the backend doesn't use it any more.\n   */\n  match_policy: string;\n\n  /**\n   * @deprecated\n   * @todo Remove this, the backend doesn't use it any more.\n   */\n  actions: {\n    create: boolean;\n    update: boolean;\n    delete: boolean;\n  };\n};\n\n/**\n * Return a filter which matches every update that is visible to the current user.\n */\nfunction defaultFilter(): Filter {\n  return {\n    match_policy: 'include_any',\n    clauses: [],\n    actions: {\n      create: true,\n      update: true,\n      delete: true,\n    },\n  };\n}\n\n/**\n * StreamFilter generates JSON-serializable configuration objects that\n * control which real-time updates are received from the annotation service.\n *\n * See https://github.com/hypothesis/h/blob/master/h/streamer/filter.py\n * for the schema.\n */\nexport class StreamFilter {\n  private _filter: Filter;\n\n  constructor() {\n    this._filter = defaultFilter();\n  }\n\n  /**\n   * Add a matching clause to the configuration.\n   *\n   * @param field - Field to filter by\n   * @param operator - How to filter\n   * @param value - Value to match\n   * @param caseSensitive - Whether matching should be case-sensitive\n   */\n  addClause(\n    field: FilterClause['field'],\n    operator: FilterClause['operator'],\n    value: FilterClause['value'],\n    caseSensitive: FilterClause['case_sensitive'] = false,\n  ) {\n    this._filter.clauses.push({\n      field,\n      operator,\n      value,\n      case_sensitive: caseSensitive,\n    });\n    return this;\n  }\n\n  /** Return the JSON-serializable filtering configuration. */\n  getFilter() {\n    return this._filter;\n  }\n\n  /** Reset the configuration to return all updates. */\n  resetFilter() {\n    this._filter = defaultFilter();\n    return this;\n  }\n}\n","import { EventEmitter } from '../shared/event-emitter';\n\n// Status codes indicating the reason why a WebSocket connection closed.\n// See https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent and\n// https://tools.ietf.org/html/rfc6455#section-7.4.\n\n// \"Normal\" closures.\nexport const CLOSE_NORMAL = 1000;\nexport const CLOSE_GOING_AWAY = 1001;\n\n// \"Abnormal\" closures.\nexport const CLOSE_ABNORMAL = 1006;\n\n// There are other possible close status codes not listed here. They are all\n// considered abnormal closures.\n\nexport type SocketEvents = {\n  open(e: Event): void;\n  close(e: Event): void;\n  disconnect(): void;\n  message(e: MessageEvent): void;\n  error(e: Event): void;\n};\n\n/**\n * Socket is a minimal wrapper around {@link WebSocket} which provides:\n *\n * - Serialization of JSON messages (see {@link send})\n * - An EventEmitter API\n * - Queuing of messages passed to send() whilst the socket is\n *   connecting\n */\nexport class Socket extends EventEmitter<SocketEvents> {\n  private _socket: WebSocket;\n\n  /** Queue of JSON objects which have not yet been submitted. */\n  private _messageQueue: object[];\n\n  /**\n   * Connect to the WebSocket endpoint at `url`.\n   */\n  constructor(url: string) {\n    super();\n\n    this._messageQueue = [];\n\n    this._socket = new WebSocket(url);\n    this._socket.onopen = event => {\n      this.sendMessages();\n      this.emit('open', event);\n    };\n    this._socket.onclose = event => {\n      if (event.code === CLOSE_NORMAL || event.code === CLOSE_GOING_AWAY) {\n        this.emit('close', event);\n        return;\n      }\n      const err = new Error(`WebSocket closed abnormally, code: ${event.code}`);\n      console.warn(err);\n      this.emit('disconnect');\n    };\n    this._socket.onerror = event => {\n      this.emit('error', event);\n    };\n    this._socket.onmessage = event => {\n      this.emit('message', event);\n    };\n  }\n\n  /** Close the underlying WebSocket connection */\n  close() {\n    // nb. Always sent a status code in the `close()` call to work around\n    // a problem in the backend's ws4py library.\n    //\n    // If no status code is provided in the `close()` call, the browser will\n    // send a close frame with no payload, which is allowed by the spec.\n    // ws4py however, will respond by sending back a close frame with a 1005\n    // status code, which is not allowed by the spec. What ws4py should do in\n    // that scenario is send back a close frame with no payload itself. This\n    // invalid close frame causes browsers to report an abnormal WS\n    // termination, even though nothing really went wrong.\n    //\n    // To avoid the problem, we just explicitly send a \"closed normally\"\n    // status code here and ws4py will respond with the same status.\n    this._socket.close(CLOSE_NORMAL);\n  }\n\n  /**\n   * Send a JSON object via the WebSocket connection, or queue it\n   * for later delivery if not currently connected.\n   */\n  send(message: object) {\n    this._messageQueue.push(message);\n    if (this.isConnected()) {\n      this.sendMessages();\n    }\n  }\n\n  /** Returns true if the WebSocket is currently connected. */\n  isConnected() {\n    return this._socket.readyState === WebSocket.OPEN;\n  }\n\n  private sendMessages() {\n    while (this._messageQueue.length > 0) {\n      const messageString = JSON.stringify(this._messageQueue.shift());\n      this._socket.send(messageString);\n    }\n  }\n}\n","import { generateHexString } from '../../shared/random';\nimport { warnOnce } from '../../shared/warn-once';\nimport type { SidebarStore } from '../store';\nimport { watch } from '../util/watch';\nimport { Socket } from '../websocket';\nimport type { APIRoutesService } from './api-routes';\nimport type { AuthService } from './auth';\nimport type { GroupsService } from './groups';\nimport type { SessionService } from './session';\n\n/**\n * `StreamerService` manages the WebSocket connection to the Hypothesis Real-Time\n * API [1]\n *\n * This service is responsible for opening the WebSocket connection and sending\n * messages to configure what notifications are delivered to the client.\n * Other services call `setConfig` to specify the filtering configuration.\n *\n * When notifications are received via the WebSocket, this service adds them to\n * the store. Depending on the update they may be applied immediately or added\n * to the \"pending real time updates\" state so that they can be applied by the\n * user at a convenient time.\n *\n * [1] https://h.readthedocs.io/en/latest/api/realtime/\n *\n * @inject\n */\nexport class StreamerService {\n  private _auth: AuthService;\n  private _groups: GroupsService;\n  private _session: SessionService;\n  private _store: SidebarStore;\n  private _websocketURL: Promise<string>;\n  private _socket: Socket | null;\n  private _reconnectSetUp: boolean;\n\n  /**\n   * Flag that controls whether to apply updates immediately or defer them\n   * until \"manually\" applied via `applyPendingUpdates`\n   */\n  private _updateImmediately: boolean;\n\n  /**\n   * Client configuration messages, to be sent each time a new connection is\n   * established.\n   */\n  private _configMessages: Record<string, object>;\n\n  /**\n   * Number of automatic reconnection attempts that have been made following\n   * an unexpected disconnection.\n   */\n  private _reconnectionAttempts: number;\n\n  // Test seam\n  private _window: Window;\n\n  /** The randomly generated session ID */\n  clientId: string;\n\n  constructor(\n    store: SidebarStore,\n    apiRoutes: APIRoutesService,\n    auth: AuthService,\n    groups: GroupsService,\n    session: SessionService,\n    $window: Window,\n  ) {\n    this._auth = auth;\n    this._groups = groups;\n    this._session = session;\n    this._store = store;\n    this._websocketURL = apiRoutes.links().then(links => links.websocket);\n\n    this.clientId = generateHexString(32);\n\n    this._socket = null;\n    this._updateImmediately = true;\n    this._configMessages = {};\n    this._reconnectionAttempts = 0;\n    this._reconnectSetUp = false;\n    this._window = $window;\n  }\n\n  /**\n   * Apply updates to annotations which have been received but not yet\n   * applied.\n   */\n  applyPendingUpdates() {\n    const updates = Object.values(this._store.pendingUpdates());\n    if (updates.length) {\n      this._store.addAnnotations(updates);\n      // Highlight the new/edited annotations for 5 seconds\n      this._store.highlightAnnotations(\n        updates.map(({ id }) => id).filter(Boolean) as string[],\n      );\n      this._window.setTimeout(() => this._store.highlightAnnotations([]), 5000);\n    }\n\n    const deletions = Object.keys(this._store.pendingDeletions()).map(id => ({\n      id,\n    }));\n    if (deletions.length) {\n      this._store.removeAnnotations(deletions);\n    }\n\n    this._store.clearPendingUpdates();\n  }\n\n  private _handleSocketError(websocketURL: string, event: ErrorEvent) {\n    warnOnce('Error connecting to H push notification service:', event);\n\n    // In development, warn if the connection failure might be due to\n    // the app's origin not having been whitelisted in the H service's config.\n    //\n    // Unfortunately the error event does not provide a way to get at the\n    // HTTP status code for HTTP -> WS upgrade requests.\n    const websocketHost = new URL(websocketURL).hostname;\n    if (['localhost', '127.0.0.1'].indexOf(websocketHost) !== -1) {\n      /* istanbul ignore next */\n      warnOnce(\n        'Check that your H service is configured to allow ' +\n          'WebSocket connections from ' +\n          window.location.origin,\n      );\n    }\n  }\n\n  private _handleSocketMessage(event: MessageEvent) {\n    const message = JSON.parse(event.data);\n    if (!message) {\n      return;\n    }\n\n    if (message.type === 'annotation-notification') {\n      const annotations = message.payload;\n      switch (message.options.action) {\n        case 'create':\n        case 'update':\n        case 'past':\n          this._store.receiveRealTimeUpdates({\n            updatedAnnotations: annotations,\n          });\n          break;\n        case 'delete':\n          this._store.receiveRealTimeUpdates({\n            deletedAnnotations: annotations,\n          });\n          break;\n      }\n\n      if (this._updateImmediately) {\n        this.applyPendingUpdates();\n      }\n    } else if (message.type === 'session-change') {\n      this._session.update(message.model);\n      this._groups.load();\n    } else if (message.type === 'whoyouare') {\n      const userid = this._store.profile().userid;\n      if (message.userid !== userid) {\n        console.warn(\n          'WebSocket user ID \"%s\" does not match logged-in ID \"%s\"',\n          message.userid,\n          userid,\n        );\n      }\n    } else {\n      warnOnce('Received unsupported notification', message.type);\n    }\n  }\n\n  private _sendClientConfig(socket: Socket) {\n    Object.keys(this._configMessages).forEach(key => {\n      if (this._configMessages[key]) {\n        socket.send(this._configMessages[key]);\n      }\n    });\n  }\n\n  /**\n   * Send a configuration message to the push notification service.\n   * Each message is associated with a key, which is used to re-send\n   * configuration data to the server in the event of a reconnection.\n   */\n  setConfig(key: string, configMessage: object) {\n    this._configMessages[key] = configMessage;\n    if (this._socket?.isConnected()) {\n      this._socket.send(configMessage);\n    }\n  }\n\n  async _reconnect() {\n    const websocketURL = await this._websocketURL;\n    if (!websocketURL) {\n      return;\n    }\n    this._socket?.close();\n\n    let token;\n    try {\n      token = await this._auth.getAccessToken();\n    } catch (err) {\n      console.error('Failed to fetch token for WebSocket authentication', err);\n      throw err;\n    }\n\n    let url;\n    if (token) {\n      // Include the access token in the URL via a query param. This method\n      // is used to send credentials because the `WebSocket` constructor does\n      // not support setting the `Authorization` header directly as we do for\n      // other API requests.\n      const parsedURL = new URL(websocketURL);\n      parsedURL.searchParams.set('access_token', token);\n      url = parsedURL.toString();\n    } else {\n      url = websocketURL;\n    }\n\n    const newSocket = new Socket(url);\n    newSocket.on('open', () => {\n      this._reconnectionAttempts = 0;\n      this._sendClientConfig(newSocket);\n    });\n    newSocket.on('disconnect', () => {\n      ++this._reconnectionAttempts;\n      if (this._reconnectionAttempts < 10) {\n        // Reconnect with a delay that doubles on each attempt.\n        // This reduces the stampede of requests if the WebSocket server has a\n        // problem.\n        const delay = 1000 * 2 ** this._reconnectionAttempts;\n        setTimeout(() => this._reconnect(), delay);\n      } else {\n        console.error(\n          'Gave up trying to reconnect to Hypothesis real time update service',\n        );\n      }\n    });\n    newSocket.on('error', (event: ErrorEvent) =>\n      this._handleSocketError(websocketURL, event),\n    );\n    newSocket.on('message', (event: MessageEvent) =>\n      this._handleSocketMessage(event),\n    );\n    this._socket = newSocket;\n\n    // Configure the client ID\n    this.setConfig('client-id', {\n      messageType: 'client_id',\n      value: this.clientId,\n    });\n\n    // Send a \"whoami\" message. The server will respond with a \"whoyouare\"\n    // reply which is useful for verifying that authentication worked as\n    // expected.\n    this.setConfig('auth-check', {\n      type: 'whoami',\n      id: 1,\n    });\n  }\n\n  /**\n   * Connect to the Hypothesis real time update service.\n   *\n   * If the service has already connected this does nothing.\n   *\n   * @param [options.applyUpdatesImmediately] - true if pending updates should be applied immediately\n   * @return Promise which resolves once the WebSocket connection process has started.\n   */\n  async connect(\n    options: { applyUpdatesImmediately?: boolean } = {},\n  ): Promise<void> {\n    this._updateImmediately = options.applyUpdatesImmediately ?? true;\n\n    // Setup reconnection when user changes, as auth token will have changed.\n    if (!this._reconnectSetUp) {\n      this._reconnectSetUp = true;\n      watch(\n        this._store.subscribe,\n        () => this._store.profile().userid,\n        () => this._reconnect(),\n      );\n    }\n\n    if (this._socket) {\n      return;\n    }\n    await this._reconnect();\n  }\n}\n","import escapeStringRegexp from 'escape-string-regexp';\n\nimport type { LocalStorageService } from './local-storage';\n\ntype Tag = {\n  /** The label of the tag */\n  text: string;\n  /** The number of times this tag has been used. */\n  count: number;\n  /** The timestamp when this tag was last used. */\n  updated: number;\n};\n\nconst TAGS_LIST_KEY = 'hypothesis.user.tags.list';\nconst TAGS_MAP_KEY = 'hypothesis.user.tags.map';\n\n/**\n * Service for fetching tag suggestions and storing data to generate them.\n *\n * The `tags` service stores metadata about recently used tags to local storage\n * and provides a `filter` method to fetch tags matching a query, ranked based\n * on frequency of usage.\n */\n// @inject\nexport class TagsService {\n  private _storage: LocalStorageService;\n\n  /**\n   * @param localStorage - Storage used to persist the tags\n   */\n  constructor(localStorage: LocalStorageService) {\n    this._storage = localStorage;\n  }\n\n  /**\n   * Return a list of tag suggestions matching `query`.\n   *\n   * @param limit - Optional limit of the results.\n   * @return List of matching tags\n   */\n  filter(query: string, limit: number | null = null): string[] {\n    const savedTags = this._storage.getObject<string[]>(TAGS_LIST_KEY) || [];\n    let resultCount = 0;\n    // Match any tag where the query is a prefix of the tag or a word within the tag.\n    return savedTags.filter(tag => {\n      if (limit !== null && resultCount >= limit) {\n        // limit allows a subset of the results\n        // See https://github.com/hypothesis/client/issues/1606\n        return false;\n      }\n      // Split the string on words. An improvement would be to use a unicode word boundary\n      // algorithm implemented by the browser (when available).\n      // https://unicode.org/reports/tr29/#Word_Boundaries\n      const words = tag.split(/\\W+/);\n      const regex = new RegExp(`^${escapeStringRegexp(query)}`, 'i'); // Only match the start of the string\n      const matches = words.some(word => word.match(regex)) || tag.match(regex);\n      if (matches) {\n        ++resultCount;\n        return true;\n      }\n      return false;\n    });\n  }\n\n  /**\n   * Update the list of stored tag suggestions based on the tags that a user has\n   * entered for a given annotation.\n   */\n  store(tags: string[]) {\n    // Update the stored (tag, frequency) map.\n    const savedTags =\n      this._storage.getObject<Record<string, Tag>>(TAGS_MAP_KEY) || {};\n    tags.forEach(tag => {\n      if (savedTags[tag]) {\n        savedTags[tag].count += 1;\n        savedTags[tag].updated = Date.now();\n      } else {\n        savedTags[tag] = {\n          text: tag,\n          count: 1,\n          updated: Date.now(),\n        };\n      }\n    });\n    this._storage.setObject(TAGS_MAP_KEY, savedTags);\n\n    // Sort tag suggestions by frequency.\n    const tagsList = Object.keys(savedTags).sort((t1, t2) => {\n      if (savedTags[t1].count !== savedTags[t2].count) {\n        return savedTags[t2].count - savedTags[t1].count;\n      }\n      return t1.localeCompare(t2);\n    });\n    this._storage.setObject(TAGS_LIST_KEY, tagsList);\n  }\n}\n","import type { Thread } from '../helpers/build-thread';\nimport type { SidebarStore } from '../store';\n\n/**\n * A service for performing operations related to the current set of threads.\n */\n// @inject\nexport class ThreadsService {\n  private _store: SidebarStore;\n\n  constructor(store: SidebarStore) {\n    this._store = store;\n  }\n\n  /**\n   * Make this thread and all of its children \"visible\". This has the effect of\n   * \"unhiding\" a thread which is currently hidden by an applied search filter\n   * (as well as its child threads). Only threads that are not currently visible\n   * will be forced visible.\n   */\n  forceVisible(thread: Thread) {\n    thread.children.forEach(child => {\n      this.forceVisible(child);\n    });\n    if (!thread.visible) {\n      this._store.setForcedVisible(thread.id, true);\n    }\n  }\n}\n","import type { RenderToBitmapOptions } from '../../types/annotator';\nimport type { FrameSyncService } from './frame-sync';\n\n/**\n * Service for managing thumbnails for annotated sections of a document.\n *\n * @inject\n */\nexport class ThumbnailService {\n  /** Map of annotation tag to thumbnail image. */\n  #cache = new Map<string, ImageBitmap>();\n  #frameSync: FrameSyncService;\n\n  constructor(frameSync: FrameSyncService) {\n    this.#frameSync = frameSync;\n  }\n\n  /**\n   * Request a thumbnail for an annotation.\n   *\n   * The annotation must have been anchored in the document before a thumbnail\n   * can be fetched.\n   *\n   * @param tag - Tag identifying the annotation to fetch a thumbnail for\n   * @return Thumbnail image\n   */\n  async fetch(\n    tag: string,\n    options: RenderToBitmapOptions = {},\n  ): Promise<ImageBitmap> {\n    const entry = this.#cache.get(tag);\n    if (entry) {\n      return entry;\n    }\n\n    // TODO - Implement a mechanism to remove old cache entries when annotations\n    // are unloaded or thumbnails have been unused for long enough.\n\n    const bitmap = await this.#frameSync.requestThumbnail(tag, options);\n    this.#cache.set(tag, bitmap);\n    return bitmap;\n  }\n\n  /**\n   * Return the cached thumbnail for an annotation.\n   *\n   * Returns `null` if there is no cached entry, in which case\n   * {@link ThumbnailService.fetch} must be called to generate and cache a new\n   * thumbnail.\n   */\n  get(tag: string): ImageBitmap | null {\n    return this.#cache.get(tag) ?? null;\n  }\n}\n","import type { ToastMessage } from '@hypothesis/frontend-shared';\n\nimport { EventEmitter } from '../../shared/event-emitter';\nimport { generateHexString } from '../../shared/random';\nimport type { SidebarStore } from '../store';\n\n/**\n * Additional control over the display of a particular message.\n */\nexport type MessageOptions = {\n  /** Whether the toast message automatically disappears. */\n  autoDismiss?: boolean;\n\n  /**\n   * When `true`, message will be visually hidden but still available to screen\n   * readers.\n   */\n  visuallyHidden?: boolean;\n\n  /**\n   * When `true`, the message will not be created until the frame where the\n   * ToastMessengerService is running, is focused.\n   * Usage example: messages where you want to announce the availability of\n   * keyboard shortcuts that wouldn't work when other frames are focused.\n   */\n  delayed?: boolean;\n};\n\nexport type MessageType = 'error' | 'success' | 'notice';\n\ntype MessageData = {\n  type: MessageType;\n  messageText: string;\n  options: MessageOptions;\n};\n\nexport type Events = {\n  toastMessageAdded(msg: ToastMessage): void;\n  toastMessageDismissed(id: string): void;\n};\n\n/**\n * A service for managing toast messages. Added messages may be manually\n * dismissed with the `#dismiss()` method.\n */\n// @inject\nexport class ToastMessengerService extends EventEmitter<Events> {\n  private _store: SidebarStore;\n  private _window: Window;\n\n  /**\n   * This holds a queue of delayed messages that need to be published as soon as\n   * the window gets focused\n   */\n  private _delayedMessageQueue: MessageData[];\n\n  constructor(store: SidebarStore, $window: Window) {\n    super();\n\n    this._store = store;\n    this._window = $window;\n    this._delayedMessageQueue = [];\n\n    this._window.addEventListener('focus', () => {\n      this._delayedMessageQueue.forEach(({ type, messageText, options }) =>\n        this._addMessage(type, messageText, options),\n      );\n      this._delayedMessageQueue = [];\n    });\n  }\n\n  /**\n   * Update a toast message's dismiss status and set a timeout to remove\n   * it after a bit. This allows effects/animations to happen before the\n   * message is removed entirely.\n   *\n   * @param messageId - The value of the `id` property for the message that is\n   *                    to be dismissed.\n   */\n  dismiss(messageId: string) {\n    const message = this._store.getToastMessage(messageId);\n    if (message) {\n      this._store.removeToastMessage(messageId);\n      this.emit('toastMessageDismissed', messageId);\n    }\n  }\n\n  /**\n   * Add a new toast message to the store and set a timeout to dismiss it\n   * after some time. This method will not add a message that is already\n   * extant in the store's collection of toast messages (i.e. has the same\n   * `type` and `message` text of an existing message).\n   */\n  private _addMessage(\n    type: MessageType,\n    messageText: string,\n    {\n      autoDismiss = true,\n      visuallyHidden = false,\n      delayed = false,\n    }: MessageOptions = {},\n  ) {\n    // Do not add duplicate messages (messages with the same type and text)\n    if (this._store.hasToastMessage(type, messageText)) {\n      return;\n    }\n\n    if (delayed && !this._window.document.hasFocus()) {\n      // Ignore the \"delayed\" option to avoid an infinite loop of re-enqueuing\n      // the same messages over and over\n      const options = { autoDismiss, visuallyHidden };\n      this._delayedMessageQueue.push({ type, messageText, options });\n      return;\n    }\n\n    const id = generateHexString(10);\n    const message: ToastMessage = {\n      type,\n      id,\n      message: messageText,\n      visuallyHidden,\n      autoDismiss,\n    };\n\n    this._store.addToastMessage(message);\n    this.emit('toastMessageAdded', message);\n  }\n\n  /**\n   * Add an error toast message with `messageText`\n   */\n  error(messageText: string, options?: MessageOptions) {\n    this._addMessage('error', messageText, options);\n  }\n\n  /**\n   * Add a success toast message with `messageText`\n   */\n  success(messageText: string, options?: MessageOptions) {\n    this._addMessage('success', messageText, options);\n  }\n\n  /**\n   * Add a warn/notice toast message with `messageText`\n   */\n  notice(messageText: string, options?: MessageOptions) {\n    this._addMessage('notice', messageText, options);\n  }\n}\n","// Load polyfill for :focus-visible pseudo-class.\nimport 'focus-visible';\nimport { render } from 'preact';\n// Enable debugging checks for Preact. Removed in prod builds by Rollup config.\nimport 'preact/debug';\n\nimport { parseJsonConfig } from '../boot/parse-json-config';\nimport { Injector } from '../shared/injector';\nimport type { ConfigFromSidebar } from '../types/config';\nimport type { SidebarSettings } from '../types/config';\nimport HypothesisApp from './components/HypothesisApp';\nimport LaunchErrorPanel from './components/LaunchErrorPanel';\nimport { buildSettings } from './config/build-settings';\nimport { checkEnvironment } from './config/check-env';\nimport {\n  startServer as startRPCServer,\n  preStartServer as preStartRPCServer,\n} from './cross-origin-rpc';\nimport { ServiceContext } from './service-context';\nimport { AnalyticsService } from './services/analytics';\nimport { AnnotationActivityService } from './services/annotation-activity';\nimport { AnnotationsService } from './services/annotations';\nimport { AnnotationsExporter } from './services/annotations-exporter';\nimport { APIService } from './services/api';\nimport { APIRoutesService } from './services/api-routes';\nimport { AuthService } from './services/auth';\nimport { AutosaveService } from './services/autosave';\nimport { DashboardService } from './services/dashboard';\nimport { FrameSyncService } from './services/frame-sync';\nimport { GroupsService } from './services/groups';\nimport { ImportAnnotationsService } from './services/import-annotations';\nimport { LoadAnnotationsService } from './services/load-annotations';\nimport { LocalStorageService } from './services/local-storage';\nimport { PersistedDefaultsService } from './services/persisted-defaults';\nimport { RouterService } from './services/router';\nimport { ServiceURLService } from './services/service-url';\nimport { SessionService } from './services/session';\nimport { StreamFilter } from './services/stream-filter';\nimport { StreamerService } from './services/streamer';\nimport { TagsService } from './services/tags';\nimport { ThreadsService } from './services/threads';\nimport { ThumbnailService } from './services/thumbnail';\nimport { ToastMessengerService } from './services/toast-messenger';\nimport { createSidebarStore } from './store';\nimport type { SidebarStore } from './store';\nimport { disableOpenerForExternalLinks } from './util/disable-opener-for-external-links';\nimport * as sentry from './util/sentry';\n\n// Read settings rendered into sidebar app HTML by service/extension.\nconst configFromSidebar = parseJsonConfig(document) as ConfigFromSidebar;\n\n// Check for known issues which may prevent the client from working.\n//\n// If any checks fail we'll log warnings and disable error reporting, but try\n// and continue anyway.\nconst envOk = checkEnvironment(window);\n\nif (configFromSidebar.sentry && envOk) {\n  // Initialize Sentry. This is required at the top of this file\n  // so that it happens early in the app's startup flow\n  sentry.init(configFromSidebar.sentry);\n}\n\n// Prevent tab-jacking.\ndisableOpenerForExternalLinks(document.body);\n\n/**\n * Configure the Hypothesis API client.\n *\n * @inject\n */\nfunction setupApi(api: APIService, streamer: StreamerService) {\n  api.setClientId(streamer.clientId);\n}\n\n/**\n * Update the route in the store based on the initial URL.\n *\n * @inject\n */\nfunction syncRoute(router: RouterService) {\n  router.sync();\n}\n\n/**\n * Perform the initial fetch of groups and user profile.\n *\n * @inject\n */\nfunction loadGroupsAndProfile(groups: GroupsService, session: SessionService) {\n  groups.load();\n  session.load();\n}\n\n/**\n * Initialize background processes provided by various services.\n *\n * These processes include persisting or synchronizing data from one place\n * to another.\n *\n * @inject\n */\nfunction initServices(\n  autosaveService: AutosaveService,\n  persistedDefaults: PersistedDefaultsService,\n  serviceURL: ServiceURLService,\n) {\n  autosaveService.init();\n  persistedDefaults.init();\n  serviceURL.init();\n}\n\n/**\n * Setup connection between sidebar and host page.\n *\n * @inject\n */\nfunction setupFrameSync(\n  frameSync: FrameSyncService,\n  store: SidebarStore,\n  toastMessenger: ToastMessengerService,\n) {\n  if (store.route() === 'sidebar') {\n    frameSync.connect().catch(() => {\n      toastMessenger.error(\n        'Hypothesis failed to connect to the web page. Try reloading the page.',\n        {\n          autoDismiss: false,\n        },\n      );\n    });\n  }\n}\n\n/**\n * Launch the client application corresponding to the current URL.\n *\n * @param appEl - Root HTML container for the app\n */\nfunction startApp(settings: SidebarSettings, appEl: HTMLElement) {\n  const container = new Injector();\n\n  // Register services.\n  container\n    .register('analytics', AnalyticsService)\n    .register('annotationsExporter', AnnotationsExporter)\n    .register('annotationsService', AnnotationsService)\n    .register('annotationActivity', AnnotationActivityService)\n    .register('api', APIService)\n    .register('apiRoutes', APIRoutesService)\n    .register('auth', AuthService)\n    .register('autosaveService', AutosaveService)\n    .register('dashboard', DashboardService)\n    .register('frameSync', FrameSyncService)\n    .register('groups', GroupsService)\n    .register('importAnnotationsService', ImportAnnotationsService)\n    .register('loadAnnotationsService', LoadAnnotationsService)\n    .register('localStorage', LocalStorageService)\n    .register('persistedDefaults', PersistedDefaultsService)\n    .register('router', RouterService)\n    .register('serviceURL', ServiceURLService)\n    .register('session', SessionService)\n    .register('streamer', StreamerService)\n    .register('streamFilter', StreamFilter)\n    .register('tags', TagsService)\n    .register('threadsService', ThreadsService)\n    .register('thumbnailService', ThumbnailService)\n    .register('toastMessenger', ToastMessengerService)\n    .register('store', { factory: createSidebarStore });\n\n  // Register utility values/classes.\n  //\n  // nb. In many cases these can be replaced by direct imports in the services\n  // that use them, since they don't depend on instances of other services.\n  container\n    .register('$window', { value: window })\n    .register('settings', { value: settings });\n\n  // Initialize services.\n  //\n  // We sync the route with the initial URL as the first step, because\n  // initialization of other services may depend on the route (eg. enabling\n  // sidebar-only behavior).\n  container.run(syncRoute);\n  container.run(initServices);\n  container.run(setupApi);\n  container.run(loadGroupsAndProfile);\n  container.run(startRPCServer);\n  container.run(setupFrameSync);\n\n  // Render the UI.\n  render(\n    <ServiceContext.Provider value={container}>\n      <HypothesisApp />\n    </ServiceContext.Provider>,\n    appEl,\n  );\n}\n\nfunction reportLaunchError(error: Error, appEl: HTMLElement) {\n  // Report error. In the sidebar the console log is the only notice the user\n  // gets because the sidebar does not appear at all if the app fails to start.\n  console.error('Failed to start Hypothesis client: ', error);\n\n  // For apps where the UI is visible (eg. notebook, single-annotation view),\n  // show an error notice.\n  render(<LaunchErrorPanel error={error} />, appEl);\n}\n\nconst appEl = document.querySelector('hypothesis-app') as HTMLElement;\n\n// Start capturing RPC requests before we start the RPC server (startRPCServer)\npreStartRPCServer();\n\nbuildSettings(configFromSidebar)\n  .then(settings => {\n    startApp(settings, appEl);\n  })\n  .catch(err => reportLaunchError(err, appEl));\n","/**\n * Return a parsed `js-hypothesis-config` object from the document, or `{}`.\n *\n * Find all `<script class=\"js-hypothesis-config\">` tags in the given document,\n * parse them as JSON, and return the parsed object.\n *\n * If there are no `js-hypothesis-config` tags in the document then return\n * `{}`.\n *\n * If there are multiple `js-hypothesis-config` tags in the document then merge\n * them into a single returned object (when multiple scripts contain the same\n * setting names, scripts further down in the document override those further\n * up).\n *\n * @param document - The root element to search.\n */\nexport function parseJsonConfig(document: Document | Element) {\n  const config: Record<string, unknown> = {};\n  const settingsElements = document.querySelectorAll(\n    'script.js-hypothesis-config',\n  );\n\n  for (let i = 0; i < settingsElements.length; i++) {\n    let settings;\n    try {\n      settings = JSON.parse(settingsElements[i].textContent || '');\n    } catch (err) {\n      console.warn(\n        'Could not parse settings from js-hypothesis-config tags',\n        err,\n      );\n      settings = {};\n    }\n    Object.assign(config, settings);\n  }\n\n  return config;\n}\n","import { parseConfigFragment } from '../../shared/config-fragment';\n\n/**\n * Perform checks for situations in which the Hypothesis client might not work\n * properly.\n *\n * This function does not check for supported browser features. That is handled\n * by the boot script.\n *\n * @return `true` if the checks passed\n */\nexport function checkEnvironment(window: Window): boolean {\n  const { version, origin } = parseConfigFragment(window.location.href);\n\n  // If the sidebar and annotator code are using different versions of the\n  // client, there might be a protocol mismatch in sidebar <-> guest/host RPC\n  // calls. This can happen if an old version of the client has been cached\n  // on the host/sidebar side. We try to set appropriate headers on the boot\n  // script to minimize the chances of this happening, but there are still\n  // situations beyond our control where it can happen.\n  if (version !== '__VERSION__') {\n    console.warn(\n      `The Hypothesis sidebar is using a different version (__VERSION__) than the host page (${version}). It may not work.`,\n    );\n    return false;\n  }\n\n  // The sidebar can't work if loaded in the wrong origin or an opaque origin\n  // because various cross-frame messaging (eg. login window, host <-> sidebar\n  // RPC) set an origin filter on `postMessage` calls to the sidebar frame for\n  // security.\n  if (window.origin === 'null') {\n    console.warn(\n      `Hypothesis has been loaded in a sandboxed frame. This is not supported.`,\n    );\n    return false;\n  } else if (window.origin !== origin) {\n    console.warn(\n      `The Hypothesis sidebar is running in a different origin (${window.origin}) than expected (${origin}). It may not work.`,\n    );\n    return false;\n  }\n\n  return true;\n}\n","function isHTMLAnchorElement(\n  element: HTMLElement,\n): element is HTMLAnchorElement {\n  return element.tagName === 'A';\n}\n\n/**\n * Prevent windows or tabs opened via links under `root` from accessing their\n * opening `Window`.\n *\n * This makes links with `target=\"blank\"` attributes act as if they also had\n * the `rel=\"noopener\"` [1] attribute set.\n *\n * In addition to preventing tab-jacking [2], this also enables multi-process\n * browsers to more easily use a new process for instances of Hypothesis in the\n * newly-opened tab and works around a bug in Chrome [3]\n *\n * [1] https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types#noopener\n * [2] https://mathiasbynens.github.io/rel-noopener/\n * [3] https://bugs.chromium.org/p/chromium/issues/detail?id=753314\n */\nexport function disableOpenerForExternalLinks(root: Element) {\n  root.addEventListener('click', event => {\n    const target = event.target as HTMLElement;\n\n    if (isHTMLAnchorElement(target)) {\n      if (target.target === '_blank') {\n        target.rel = 'noopener';\n      }\n    }\n  });\n}\n","import { parseConfigFragment } from '../../shared/config-fragment';\nimport {\n  toBoolean,\n  toInteger,\n  toObject,\n  toString,\n} from '../../shared/type-coercions';\nimport type { ConfigFromAnnotator } from '../../types/config';\n\n/**\n * Return the app configuration specified by the frame embedding the Hypothesis\n * client.\n */\nexport function hostPageConfig(window: Window): ConfigFromAnnotator {\n  const config = parseConfigFragment(window.location.href);\n\n  // Known configuration parameters which we will import from the host page.\n  // Note that since the host page is untrusted code, the filtering needs to\n  // be done here.\n  const paramWhiteList = [\n    // Direct-linked annotation ID\n    'annotations',\n\n    // Direct-linked group ID\n    'group',\n\n    // Default query passed by url\n    'query',\n\n    // Config param added by the extension, Via etc.  indicating how Hypothesis\n    // was added to the page.\n    'appType',\n\n    // Config params documented at\n    // https://h.readthedocs.io/projects/client/en/latest/publishers/config/\n    'openSidebar',\n    'showHighlights',\n    'services',\n    'branding',\n\n    // New note button override.\n    // This should be removed once new note button is enabled for everybody.\n    'enableExperimentalNewNoteButton',\n\n    // Forces the sidebar to filter annotations to a single user.\n    'focus',\n\n    // Fetch config from a parent frame.\n    'requestConfigFromFrame',\n\n    // Theme which can either be specified as 'clean'.\n    // If nothing is the specified the classic look is applied.\n    'theme',\n\n    'usernameUrl',\n  ];\n\n  // We need to coerce incoming values from the host config for 2 reasons:\n  //\n  // 1. New versions of via may no longer support passing any type other than\n  // string and our client is set up to expect values that are in fact not a\n  // string in some cases. This will help cast these values to the expected\n  // type if they can be.\n  //\n  // 2. A publisher of our sidebar could accidentally pass un-sanitized values\n  // into the config and this ensures they safely work downstream even if they\n  // are incorrect.\n  //\n  // Currently, we are only handling the following config values due to the fact\n  // that via3 will soon discontinue passing boolean types or integer types.\n  //  - requestConfigFromFrame\n  //  - openSidebar\n  //\n  // It is assumed we should expand this list and coerce and eventually\n  // even validate all such config values.\n  // See https://github.com/hypothesis/client/issues/1968\n\n  const coercions: Record<string, (value: unknown) => unknown> = {\n    openSidebar: toBoolean,\n\n    requestConfigFromFrame: value => {\n      if (typeof value === 'string') {\n        // Legacy `requestConfigFromFrame` value which holds only the origin.\n        return value;\n      }\n      const objectVal = toObject(value) as {\n        origin: unknown;\n        ancestorLevel: unknown;\n      };\n      return {\n        origin: toString(objectVal.origin),\n        ancestorLevel: toInteger(objectVal.ancestorLevel),\n      };\n    },\n  };\n\n  const result: Record<string, unknown> = {};\n  for (const [key, value] of Object.entries(config)) {\n    if (!paramWhiteList.includes(key)) {\n      continue;\n    }\n\n    // Ignore `null` values as these indicate a default value.\n    // In this case the config value set in the sidebar app HTML config is\n    // used.\n    if (value === null) {\n      continue;\n    }\n\n    if (coercions[key]) {\n      result[key] = coercions[key](value);\n    } else {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n","import type { SidebarSettings } from '../../types/config';\nimport { serviceConfig } from './service-config';\n\n/**\n * Function that returns apiUrl from the settings object.\n *\n * @return The apiUrl from the service or the default apiUrl from the settings\n * @throws {Error} If the settings has a service but the service doesn't have an apiUrl\n */\nexport function getApiUrl(settings: SidebarSettings): string {\n  const service = serviceConfig(settings);\n  if (!service) {\n    return settings.apiUrl;\n  }\n\n  // If the host page contains a service setting then the client should default\n  // to using that apiUrl.\n  if (service.apiUrl) {\n    return service.apiUrl;\n  }\n\n  throw new Error('Service should contain an apiUrl value.');\n}\n"],"names":["applyFocusVisiblePolyfill","scope","hadKeyboardEvent","hadFocusVisibleRecently","hadFocusVisibleRecentlyTimeout","inputTypesAllowlist","text","search","url","tel","email","password","number","date","month","week","time","datetime","isValidFocusTarget","el","document","nodeName","classList","focusTriggersKeyboardModality","type","tagName","readOnly","isContentEditable","addFocusVisibleClass","contains","add","setAttribute","removeFocusVisibleClass","hasAttribute","remove","removeAttribute","onKeyDown","e","metaKey","altKey","ctrlKey","activeElement","onPointerDown","onFocus","target","onBlur","window","clearTimeout","setTimeout","onVisibilityChange","visibilityState","addInitialPointerMoveListeners","addEventListener","onInitialPointerMove","removeInitialPointerMoveListeners","removeEventListener","toLowerCase","nodeType","Node","DOCUMENT_FRAGMENT_NODE","host","DOCUMENT_NODE","documentElement","event","CustomEvent","error","createEvent","initCustomEvent","dispatchEvent","factory","n","l","u","i","r","o","f","c","s","a","h","p","y","v","w","Array","isArray","d","g","parentNode","removeChild","m","t","props","key","ref","__k","__","__b","__e","__c","constructor","__v","__i","__u","vnode","k","children","x","this","context","S","length","C","base","M","__d","push","$","__r","debounceRendering","sort","shift","__P","O","__n","namespaceURI","z","I","_","String","L","B","P","q","A","nextSibling","insertBefore","H","some","T","setProperty","test","j","style","cssText","replace","slice","F","b","prototype","render","contextType","value","__E","D","sub","state","__h","_sb","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","N","then","indexOf","localName","createTextNode","createElementNS","is","__m","data","call","childNodes","attributes","name","__html","innerHTML","content","V","diffed","map","current","unmount","componentWillUnmount","E","arguments","defaultProps","firstChild","K","Set","forEach","delete","Provider","__l","Consumer","isValueProvider","provider","isClassProvider","class","isFactoryProvider","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","Promise","bind","resolve","Injector","_providers","Map","_instances","_constructing","get","has","Error","set","resolvedDependencies","dependencies","$inject","dependency","resolveErr","message","cause","instance","register","isValidProvider","run","callback","tempName","__H","__N","__f","filter","every","requestAnimationFrame","cancelAnimationFrame","_defineProperty","Symbol","toPrimitive","TypeError","Number","_toPrimitive","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","ListenerCollection","_listeners","eventTarget","eventType","listener","options","symbol","listenerId","removeAll","clear","defaultSetFocus","element","focus","useArrowKeyNavigation","containerRef","autofocus","loop","horizontal","vertical","selector","containerVisible","focusElement","focusElement_","lastFocusedItem","useRef","wrapper","args","useStableCallback","useEffect","container","getNavigableElements","filtered","from","querySelectorAll","offsetParent","disabled","isElementDisabled","unshift","updateTabIndexes","elements","currentIndex","setFocus","keyEvent","findIndex","tabIndex","index","entries","navigableElements","initialIndex","listeners","targetIndex","item","handled","preventDefault","stopPropagation","mo","MutationObserver","observe","subtree","attributeFilter","childList","disconnect","useClickAway","enabled","body","handleAwayClick","composedPath","includes","useFocusAway","relatedTarget","useKeyPress","keys","usePopoverShouldClose","popoverEl","handleClose","SyncedRef","_target","_value","_updateTarget","useSyncedRef","targetRef","SECOND","MINUTE","HOUR","formatters","delta","now","format","Intl","JSON","stringify","formatter","DateTimeFormat","undefined","BREAKPOINTS","nextUpdate","Math","floor","getFullYear","day","DEFAULT_BREAKPOINT","year","getBreakpoint","breakpoint","isDateValid","isNaN","valueOf","decayingInterval","timer","timestamp","Date","update","fuzzyUpdate","max","min","nextFuzzyUpdate","formatRelativeDate","formatDateTime","includeWeekday","includeTime","weekday","hour","minute","hasOwn","hasOwnProperty","classNames","classes","arg","appendClass","parseValue","apply","toString","newClass","module","exports","default","defaultSelector","__source","__self","_jsxFileName","Overlay","elementRef","open","variant","htmlAttributes","_jsxDEV","className","classnames","fileName","lineNumber","columnNumber","CloseableContext","createContext","ScrollContext","Scroll","scrollContext","useMemo","scrollRef","Card","active","width","CardActions","CardContent","size","AnnotateIcon","xmlns","height","viewBox","fill","ArrowLeftIcon","ArrowRightIcon","CancelIcon","CaretRightIcon","CautionIcon","CcStdIcon","CcZeroIcon","CheckIcon","CheckboxIcon","CheckboxCheckedFilledIcon","CollapseIcon","CopyIcon","DownloadIcon","EditIcon","EditorLatexIcon","EditorQuoteIcon","EditorTextBoldIcon","EditorTextItalicIcon","EmailIcon","ExpandIcon","ExternalIcon","FileGenericIcon","FlagIcon","FlagFilledIcon","GlobeIcon","GlobeLockIcon","GroupsIcon","HelpIcon","HideIcon","HighlightIcon","ImageIcon","InfoIcon","LeaveIcon","LinkIcon","ListOrderedIcon","ListUnorderedIcon","LockFilledIcon","LogoIcon","MentionIcon","MenuCollapseIcon","MenuExpandIcon","MinusIcon","PlusIcon","PointerDownIcon","stroke","PointerUpIcon","ProfileIcon","RadioIcon","RadioCheckedIcon","ReplyIcon","RestrictedIcon","SearchIcon","ShareIcon","SocialFacebookIcon","SocialTwitterIcon","SortIcon","SpinnerSpokesIcon","attributeName","dur","repeatCount","values","TrashIcon","Button","expanded","pressed","title","icon","Icon","unstyled","role","styled","themed","sized","ariaProps","inputGroupStyles","InputGroup","IconButton","CloseButton","onClick","iconButtonProps","_ref","closeableContext","useContext","onClose","CardTitle","WrapperElement","CardHeader","fullWidth","closeHandler","Panel","buttons","fullWidthHeader","paddingSize","scrollable","heightConstraintClasses","panelContent","_Fragment","Dialog","closeOnClickAway","closeOnEscape","closeOnFocusAway","initialFocus","restoreFocus","transitionComponent","TransitionComponent","closeTitle","rest","isPanel","modalRef","restoreFocusEl","transitionComponentVisible","setTransitionComponentVisible","useState","useCallback","initializeDialog","_modalRef$current","focusEl","_modalRef$current2","dialogDescriptionId","useId","Wrapper","Fragment","useLayoutEffect","restoreFocusTo","_modalRef$current3","description","querySelector","id","direction","onTransitionEnd","ModalDialog","disableCloseOnEscape","disableFocusTrap","disableRestoreFocus","htmlAndPanelAttributes","isElementVisible","focusedIndex","shiftKey","useTabKeyNavigation","async","confirm","confirmAction","cancelAction","cancelButton","confirmButton","initialFocusRef","createElement","position","zIndex","appendChild","close","result","ToggleInput","checked","UncheckedIcon","checkedIcon","CheckedIcon","onChange","containerClasses","htmlFor","Checkbox","defaultChecked","isControlled","uncontrolledChecked","setUncontrolledChecked","inputStyles","feedback","Input","console","warn","_ref$current","setCustomValidity","useValidationError","RadioGroupContext","Radio","subtitle","radioDisabled","radioGroupContext","selected","isSelected","displayName","assign","label","labelledBy","dataset","POPOVER_ANCHOR_EL_GAP","POPOVER_VIEWPORT_HORIZONTAL_GAP","Popover","anchorElementRef","align","onScroll","asNativePopover","HTMLElement","popoverRef","popoverOpen","alignToRight","adjustPopoverPositioning","anchorEl","setPopoverCSSProps","prop","viewportHeight","innerHeight","top","anchorElDistanceToTop","bottom","anchorElBottom","left","anchorElLeft","anchorElHeight","anchorElWidth","getBoundingClientRect","anchorElDistanceToBottom","popoverHeight","popoverWidth","shouldBeAbove","marginBottom","marginTop","bodyTop","bodyWidth","absBodyTop","abs","availableSpace","minWidth","popover","togglePopover","cleanup","capture","observer","ResizeObserver","usePopoverPositioning","toggleListener","oldState","newState","useOnClose","currentFocus","useRestoreFocusOnClose","hidden","SelectContext","optionChildren","status","SelectOption","checkboxRef","checkboxContainerRef","optionRef","eventTriggeredInCheckbox","selectContext","selectValue","currentValue","multiple","selectOneValue","closeListbox","toggleValue","copy","splice","truncate","listboxOverflow","_optionRef$current","SelectMain","buttonContent","buttonId","buttonClasses","popoverClasses","onPopoverScroll","alignListbox","ariaLabel","ariaLabelledBy","listboxAsPopover","wrapperRef","listboxRef","listboxOpen","setListboxOpen","listboxId","buttonRef","defaultButtonId","prev","Select","Option","Spinner","color","Callout","StatusIcon","withIcon","ToastMessageItem","onDismiss","visuallyHidden","ToastMessageTransition","transitionClasses","isDismissed","transitionIn","transitionOut","onAnimationEnd","ToastMessages","messages","onMessageDismiss","setTimeout_","dismissedMessages","setDismissedMessages","messageSchedules","dismissMessage","ids","scheduleMessageDismiss","timeout","_message$autoDismiss","autoDismiss","pendingTimeouts","Link","underline","rel","LinkButton","inline","NavigationButton","invisible","Pagination","currentPage","onChangePage","totalPages","hasNextPage","hasPreviousPage","pageNumbers","boundaryCount","siblingCount","afterCurrent","elideBefore","page","count","elideAfter","maxItems","_elideAfter","_elideBefore","paginationItems","changePageTo","pageNumber","blur","idx","Tab","textContent","TabList","tabListRef","Slider","visible","containerHeight","setContainerHeight","contentVisible","setContentVisible","display","scrollHeight","handleTransitionEnd","propertyName","ontransitionend","overflow","transition","serviceConfig","services","isThirdPartyService","settings","service","authority","authDomain","supportedThemeProperties","accentColor","appBackgroundColor","ctaBackgroundColor","ctaTextColor","selectionFontFamily","annotationFontFamily","applyTheme","themeProperties","branding","themeProp","propertyValue","ServiceContext","withServices","Component","serviceNames","injector","propsWithServices","_jsx","wrappedName","formatProdErrorMessage","code","symbol_observable_default","observable","randomString","random","substring","split","join","actionTypes_default","INIT","REPLACE","PROBE_UNKNOWN_ACTION","createStore","reducer","preloadedState","enhancer","currentReducer","currentState","currentListeners","nextListeners","listenerIdCounter","isDispatching","ensureCanMutateNextListeners","getState","subscribe","isSubscribed","dispatch","action","obj","proto","getPrototypeOf","isPlainObject","replaceReducer","nextReducer","outerSubscribe","observeState","observerAsObserver","next","unsubscribe","combineReducers","reducers","reducerKeys","finalReducers","finalReducerKeys","shapeAssertionError","assertReducerShape","hasChanged","nextState","previousStateForKey","nextStateForKey","bindActionCreator","actionCreator","extraArgument","thunk","createReducer","stateChanges","bindSelectors","selectors","boundSelectors","assignOnce","source","modules","initArgs","middleware","initialState","namespace","allReducers","middlewares","createStore2","store","middlewareAPI","chain","funcs","reduce","compose","redux","actionCreators","actionMethods","boundActionCreators","selectorMethods","rootSelectors","makeAction","payload","createStoreModule","config","Function","debugMiddleware","serial","debug","groupTitle","group","log","groupEnd","API_REQUEST_STARTED","activeApiRequests","API_REQUEST_FINISHED","ANNOTATION_SAVE_STARTED","addToStarted","annotation","$tag","activeAnnotationSaveRequests","updatedSaves","concat","ANNOTATION_SAVE_FINISHED","ANNOTATION_FETCH_STARTED","activeAnnotationFetches","ANNOTATION_FETCH_FINISHED","hasFetchedAnnotations","SET_ANNOTATION_RESULT_COUNT","annotationResultCount","resultCount","BEGIN_IMPORT","importsPending","importsTotal","COMPLETE_IMPORT","activityModule","annotationFetchStarted","annotationFetchFinished","annotationSaveStarted","annotationSaveFinished","apiRequestStarted","apiRequestFinished","beginImport","completeImport","setAnnotationResultCount","isLoading","isFetchingAnnotations","isSavingAnnotation","NOT_FOUND","ensureIsArray","getDependencies","createSelectorArgs","array","errorMessage","itemTypes","assertIsArrayOfFunctions","referenceEqualityCheck","Ref","WeakRef","deref","UNTERMINATED","TERMINATED","createCacheNode","weakMapMemoize","func","fnNode","resultEqualityCheck","lastResult","resultsCount","memoized","cacheNode","objectCache","WeakMap","objectNode","primitiveCache","primitiveNode","terminatedNode","lastResultValue","clearCache","resetResultsCount","createSelectorCreator","memoizeOrOptions","memoizeOptionsFromArgs","createSelectorCreatorOptions","memoize","memoizeOptions","createSelector2","recomputations","dependencyRecomputations","directlyPassedOptions","resultFunc","pop","assertIsFunction","combinedOptions","argsMemoize","argsMemoizeOptions","finalMemoizeOptions","finalArgsMemoizeOptions","memoizedResultFunc","inputSelectorResults","inputSelectorArgs","collectInputSelectorResults","resetDependencyRecomputations","resetRecomputations","withTypes","createSelector","createStructuredSelector","inputSelectorsObject","selectorCreator","object","assertIsObject","inputSelectorKeys","composition","property","parseAccountID","user","match","username","account","isThirdPartyUser","defaultAuthority","documentMetadata","uri","domain","URL","hostname","titleLinkFromAnnotation","titleLink","links","incontext","domainTextFromAnnotation","domainText","parts","filename","titleTextFromAnnotation","titleText","isReply","references","isSaved","isNew","isPublic","permissions","read","perm","readPermArr","hasSelector","isWaitingToAnchor","$orphan","$anchorTimeout","isHidden","isHighlight","$highlight","isPageNote","tags","isOrphan","isAnnotation","annotationRole","location","cfi","charOffset","pageIndex","start","distanceFromTopOfView","pageTop","view","shape","quote","quoteSel","find","exact","epubSel","pageLabel","pageSel","countIf","ary","predicate","toTrueMap","arr","trueKeys","CHANGE_ROUTE","params","routeModule","changeRoute","route","routeParams","initialProfile","features","preferences","userid","UPDATE_PROFILE","profile","combinedFeatures","feat","sessionModule","updateProfile","hasFetchedProfile","isFeatureEnabled","feature","Boolean","isLoggedIn","findByID","annotations","findByTag","tag","initializeAnnotation","currentUserId","orphan","$cluster","ADD_ANNOTATIONS","updatedIDs","updatedTags","added","unchanged","updated","nextTag","annot","existing","CLEAR_ANNOTATIONS","highlighted","hovered","HOVER_ANNOTATIONS","HIDE_ANNOTATION","ann","HIGHLIGHT_ANNOTATIONS","REMOVE_ANNOTATIONS","remainingAnnotations","UNHIDE_ANNOTATION","UPDATE_ANCHOR_STATUS","statusUpdates","UPDATE_FLAG_STATUS","flagged","isFlagged","newAnn","moderation","countDelta","flagCount","removeAnnotations","excludeAnnotations","annotationsToRemove","updateAnchorStatus","annotationCount","metadata","hoveredAnnotations","highlightedAnnotations","isWaitingToAnchorAnnotations","newAnnotations","newHighlights","noteCount","orphanCount","savedAnnotations","usersWhoAnnotated","usersMap","anno","getUsername","user_info","display_name","aUsername","bUsername","localeCompare","sensitivity","usersWhoWereMentioned","mentions","flatMap","addedUserIds","userAlreadyAdded","annotationsModule","addAnnotations","session","currentAnnotationCount","anchoringIds","anns","anchorStatusUpdates","updates","clearAnnotations","hoverAnnotations","hideAnnotation","highlightAnnotations","unhideAnnotation","updateFlagStatus","allAnnotations","annotationExists","findAnnotationByID","findIDsForTags","isAnnotationHighlighted","isAnnotationHovered","SET_DEFAULT","defaultKey","defaultsModule","annotationPrivacy","focusedGroup","setDefault","getDefault","getDefaults","UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED","directLinkedGroupFetchFailed","UPDATE_DIRECT_LINKED_GROUP_ID","directLinkedGroupId","UPDATE_DIRECT_LINKED_ANNOTATION_ID","directLinkedAnnotationId","CLEAR_DIRECT_LINKED_IDS","CLEAR_SELECTION","directLinkedModule","setDirectLinkedGroupFetchFailed","setDirectLinkedGroupId","groupId","setDirectLinkedAnnotationId","annId","clearDirectLinkedGroupFetchFailed","clearDirectLinkedIds","Draft","changes","isPrivate","isEmpty","DISCARD_ALL_DRAFTS","drafts","REMOVE_DRAFT","draft","UPDATE_DRAFT","removeDraft","getDraft","getDraftIfNotEmpty","unsavedAnnotations","draftsModule","createDraft","deleteNewAndEmptyDrafts","removedAnnotations","discardAllDrafts","countDrafts","focusFiltersFromConfig","focusConfig","filters","userFilterValue","pages","range","CHANGE_FOCUS_MODE_USER","focusFilters","focusActive","SET_FILTER","updatedFilters","filterName","filterOption","SET_FILTER_QUERY","query","SET_FOCUS_MODE","focusState","configured","val","contentRange","pageRange","getFilters","mergedFilters","focusFilter","getFilterValues","allFilters","filterValues","filtersModule","changeFocusModeUser","setFilter","setFilterQuery","toggleFocusMode","filterQuery","getFilter","getFocusActive","getFocusFilters","hasAppliedFilter","shallowequal","objA","objB","compare","compareContext","ret","keysA","keysB","bHasOwnProperty","valueA","valueB","CONNECT_FRAME","frameIndex","frames","frame","newFrames","DESTROY_FRAME","UPDATE_FRAME_ANNOTATION_FETCH_STATUS","isAnnotationFetchComplete","SET_CONTENT_INFO","contentInfo","info","firstFrameWithoutId","mainFrame","defaultContentFrame","createShallowEqualSelector","equalityCheckOrOptions","providedOptions","equalityCheck","maxSize","comparator","createCacheKeyComparator","cache","equals","entry","put","getEntries","createSingletonCache","cacheIndex","createLruCache","matchingEntry","shallowEqual","searchUris","uris","documentFingerprint","link","href","startsWith","searchUrisForFrame","devModeChecks","identityFunctionCheck","framesModule","connectFrame","destroyFrame","setContentInfo","updateFrameAnnotationFetchStatus","isFetchComplete","getContentInfo","FILTER_GROUPS","filteredGroupIds","filteredGroups","groups","focusedGroupId","FOCUS_GROUP","focusedGroupMembers","LOAD_GROUPS","LOAD_FOCUSED_GROUP_MEMBERS","CLEAR_GROUPS","getGroup","getFeaturedGroups","isMember","isScopedToUri","getInScopeGroups","getMyGroups","rootState","loggedIn","getCurrentlyViewingGroups","allGroups","myGroups","featuredGroups","groupsModule","filterGroups","focusGroup","loadGroups","startLoadingFocusedGroupMembers","loadFocusedGroupMembers","members","clearGroups","getFocusedGroupMembers","replaceURLParams","unusedParams","param","urlParam","encodeURIComponent","UPDATE_LINKS","linksModule","updateLinks","getLink","linkName","template","unusedKeys","RECEIVE_REAL_TIME_UPDATES","pendingUpdates","pendingDeletions","CLEAR_PENDING_UPDATES","pendingUpdateCount","pendingMentionCount","realTimeUpdates","pendingAnnotations","mentionsIncludeCurrentUser","mention","mentionsCurrentUser","prevAnnotation","realTimeUpdatesModule","receiveRealTimeUpdates","updatedAnnotations","deletedAnnotations","groupState","routeState","annotationsState","clearPendingUpdates","hasPendingDeletion","hasPendingUpdates","hasPendingUpdatesOrDeletions","TAB_SORTKEY_DEFAULT","note","initialSelection","selection","setTab","newTab","oldTab","selectedTab","sortKey","CLEAR_ANNOTATION_FOCUS_REQUEST","focusRequest","forcedVisible","SELECT_ANNOTATIONS","SELECT_TAB","tab","SET_EXPANDED","newExpanded","SET_ANNOTATION_FOCUS_REQUEST","SET_FORCED_VISIBLE","SET_SORT_KEY","TOGGLE_SELECTED_ANNOTATIONS","toggleIds","topLevelAnnotations","haveOnlyPageNotes","removeAnns","collection","clearSelection","expandedMap","forcedVisibleThreads","hasSelectedAnnotations","selectedAnnotations","selectionState","sortKeys","sortKeysForTab","selectionModule","clearAnnotationFocusRequest","selectAnnotations","selectTab","tabKey","setAnnotationFocusRequest","setExpanded","setForcedVisible","setSortKey","toggleSelectedAnnotations","annotationFocusRequest","OPEN_SIDEBAR_PANEL","activePanelName","panelName","CLOSE_SIDEBAR_PANEL","TOGGLE_SIDEBAR_PANEL","panelIsActive","panelShouldBeActive","panelState","sidebarPanelsModule","openSidebarPanel","closeSidebarPanel","toggleSidebarPanel","isSidebarPanelOpen","ADD_MESSAGE","REMOVE_MESSAGE","toastMessagesModule","addToastMessage","removeToastMessage","getToastMessage","getToastMessages","hasToastMessage","SET_SIDEBAR_OPENED","opened","sidebarHasOpened","viewerModule","setSidebarOpened","hasSidebarOpened","CacheEntry","method","matches","createSidebarStore","useSidebarStore","useReducer","proxy","wrappedMethods","wrapped","cacheEntry","prevState","Proxy","useStore","SidebarContentError","errorType","onLoginRequest","showClearSelection","_jsxs","NAN","symbolTag","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","freeGlobal","global","freeSelf","self","root","objectToString","nativeMax","nativeMin","isObject","toNumber","isObjectLike","isSymbol","other","isBinary","lodash_debounce","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","thisArg","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","remainingWait","debounced","isInvoking","leadingEdge","cancel","flush","THREAD_DIMENSION_DEFAULTS","defaultHeight","marginAbove","marginBelow","getElementHeightWithMargins","getComputedStyle","parseFloat","countByVisibility","thread","visibility","matchesVisibility","reply","countHidden","countVisible","rootAnnotations","threads","threadAnnotations","allChildren","annotationDisplayName","displayNamesEnabled","isThirdParty","isShareableURI","privatePermissions","sharedPermissions","groupid","defaultPermissions","savedLevel","defaultLevel","isShared","perms","principal","isMacOS","_userAgent","navigator","userAgent","isIOS","_navigator","_ontouchend","platform","copyPlainText","navigator_","clipboard","writeText","MenuArrow","ShareLink","ShareLinks","shareURI","encodedURI","AnnotationShareControl$1","toastMessenger","shareUri","annotationIsPrivate","inContextAvailable","inputRef","shareRef","isOpen","setOpen","wasOpen","closePanel","select","showShareLinks","groupSharingInfo","annotationSharingInfo","toggleSharePanel","success","annotationsService","onReply","userProfile","userIsAuthorizedTo","permits","showDeleteAction","showEditAction","showFlagAction","allowFlagging","flaggingEnabled","shareLink","enableShareLinks","sharingEnabled","html","annotationSharingLink","onEdit","annType","err","onReplyClick","AnnotationShareControl","onFlag","flag","catch","InlineControls","isCollapsed","setCollapsed","linkStyle","noop","Excerpt$1","collapse","collapsedHeight","inlineControls","onCollapsibleChanged","onToggleCollapsed","overflowThreshold","collapsedByInlineControls","setCollapsedByInlineControls","contentElement","contentHeight","setContentHeight","updateContentHeight","newContentHeight","clientHeight","onSizeChanged","clientWidth","observeElementSize","isOverflowing","isExpandable","contentStyle","collapsed","BOUNDARY_CHARS","raw","USERNAME_MENTIONS_PAT","RegExp","DISPLAY_NAME_PAT","DISPLAY_NAME_MENTIONS_PAT","buildMentionTag","outerHTML","MENTION_TAG_RE","processAndReplaceMention","unprocessedMention","mentionMode","originalTagContent","mentionOrInvalidContent","processedMention","replaceWith","getContainingMentionOffsets","referencePosition","matchAll","precedingCharPos","subsequentCharPos","end","displayNameMention","iframe","src","aspectRatio","iframe_","paddingBottom","wrapInAspectRatioContainer","parseTimeString","timeValue","timePattern","multipliers","seconds","exec","unit","youTubeEmbed","allowedParams","linkParams","URLSearchParams","filteredQuery","append","youTubeQueryParams","createEmbedGenerator","pathPattern","iframeUrlGenerator","pathname","embedGenerators","slugMatch","slug","startTime","endTime","startPathParam","endPathParam","iframeUrl","searchParams","endsWith","html5audio","controls","audioElement","replaceLinkWithEmbed","encodedText","encodeURI","embed","embedForLink","parentElement","replaceChild","setPrototypeOf","isFrozen","getOwnPropertyDescriptor","freeze","seal","create","construct","Reflect","fun","thisValue","Func","arrayForEach","unapply","arrayLastIndexOf","lastIndexOf","arrayPop","arrayPush","arraySplice","stringToLowerCase","stringToString","stringMatch","stringReplace","stringIndexOf","stringTrim","trim","objectHasOwnProperty","regExpTest","typeErrorCreate","_len2","_key2","lastIndex","_len","_key","addToSet","transformCaseFunc","lcElement","cleanArray","clone","newObject","lookupGetter","desc","html$1","svg$1","svgFilters","svgDisallowed","mathMl$1","mathMlDisallowed","svg","mathMl","xml","MUSTACHE_EXPR","ERB_EXPR","TMPLIT_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","ATTR_WHITESPACE","DOCTYPE_NAME","CUSTOM_ELEMENT","EXPRESSIONS","__proto__","NODE_TYPE","getGlobal","purify","createDOMPurify","DOMPurify","version","removed","Element","isSupported","originalDocument","currentScript","DocumentFragment","HTMLTemplateElement","NodeFilter","NamedNodeMap","MozNamedAttrMap","HTMLFormElement","DOMParser","trustedTypes","ElementPrototype","cloneNode","getNextSibling","getChildNodes","getParentNode","ownerDocument","trustedTypesPolicy","emptyHTML","implementation","createNodeIterator","createDocumentFragment","getElementsByTagName","importNode","hooks","afterSanitizeAttributes","afterSanitizeElements","afterSanitizeShadowDOM","beforeSanitizeAttributes","beforeSanitizeElements","beforeSanitizeShadowDOM","uponSanitizeAttribute","uponSanitizeElement","uponSanitizeShadowNode","createHTMLDocument","IS_ALLOWED_URI$1","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","CUSTOM_ELEMENT_HANDLING","tagNameCheck","attributeNameCheck","allowCustomizedBuiltInElements","FORBID_TAGS","FORBID_ATTR","ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","ALLOW_SELF_CLOSE_IN_ATTR","SAFE_FOR_TEMPLATES","SAFE_FOR_XML","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_TRUSTED_TYPE","SANITIZE_DOM","SANITIZE_NAMED_PROPS","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DEFAULT_FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","DEFAULT_URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","HTML_NAMESPACE","NAMESPACE","IS_EMPTY_INPUT","ALLOWED_NAMESPACES","DEFAULT_ALLOWED_NAMESPACES","MATHML_TEXT_INTEGRATION_POINTS","HTML_INTEGRATION_POINTS","COMMON_SVG_AND_HTML_ELEMENTS","PARSER_MEDIA_TYPE","SUPPORTED_PARSER_MEDIA_TYPES","CONFIG","formElement","isRegexOrFunction","testValue","_parseConfig","cfg","ADD_URI_SAFE_ATTR","ADD_DATA_URI_TAGS","ALLOWED_URI_REGEXP","ADD_TAGS","ADD_ATTR","table","tbody","TRUSTED_TYPES_POLICY","createHTML","createScriptURL","purifyHostElement","createPolicy","suffix","ATTR_NAME","getAttribute","policyName","scriptUrl","_createTrustedTypesPolicy","ALL_SVG_TAGS","ALL_MATHML_TAGS","_forceRemove","node","_removeAttribute","attribute","getAttributeNode","_initDocument","dirty","doc","leadingWhitespace","dirtyPayload","parseFromString","createDocument","_createNodeIterator","SHOW_ELEMENT","SHOW_COMMENT","SHOW_TEXT","SHOW_PROCESSING_INSTRUCTION","SHOW_CDATA_SECTION","_isClobbered","hasChildNodes","_isNode","_executeHooks","currentNode","hook","_sanitizeElements","allowedTags","firstElementChild","_isBasicCustomElement","childClone","__removalCount","parent","parentTagName","_checkValidNamespace","expr","_isValidAttribute","lcTag","lcName","_sanitizeAttributes","hookEvent","attrName","attrValue","keepAttr","allowedAttributes","forceKeepAttr","attr","getAttributeType","setAttributeNS","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","nextNode","sanitize","importedNode","returnNode","nodeIterator","shadowroot","shadowrootmode","serializedHTML","doctype","setConfig","clearConfig","isValidAttribute","addHook","entryPoint","hookFunction","removeHook","removeHooks","removeAllHooks","matchHtmlRegExp","escapeHtml_1","string","escape","str","charCodeAt","SourceLocation","lexer","static","first","second","loc","Token","noexpand","treatAsRelax","endToken","ParseError","token","rawMessage","input","underlined","uppercase","ESCAPE_LOOKUP","ESCAPE_REGEX","getBaseElem","utils","list","elem","deflt","setting","defaultIfUndefined","hyphenate","isCharacterBox","baseElem","protocolFromUrl","protocol","SETTINGS_SCHEMA","displayMode","cli","output","enum","leqno","fleqn","throwOnError","cliDescription","errorColor","cliProcessor","macros","cliDefault","def","defs","minRuleThickness","processor","colorIsTextColor","strict","trust","Infinity","maxExpand","globalGroup","getDefaultValue","schema","defaultType","Settings","reportNonstrict","errorCode","errorMsg","useStrictBehavior","isTrusted","Style","cramped","sup","styles","fracNum","fracDen","cramp","text$1","isTight","Style$1","DISPLAY","TEXT","SCRIPT","SCRIPTSCRIPT","scriptData","blocks","allBlocks","supportedCodepoint","codepoint","hLinePad","path","doubleleftarrow","doublerightarrow","leftarrow","leftbrace","leftbraceunder","leftgroup","leftgroupunder","leftharpoon","leftharpoonplus","leftharpoondown","leftharpoondownplus","lefthook","leftlinesegment","leftmapsto","leftToFrom","longequal","midbrace","midbraceunder","oiintSize1","oiintSize2","oiiintSize1","oiiintSize2","rightarrow","rightbrace","rightbraceunder","rightgroup","rightgroupunder","rightharpoon","rightharpoonplus","rightharpoondown","rightharpoondownplus","righthook","rightlinesegment","rightToFrom","twoheadleftarrow","twoheadrightarrow","tilde1","tilde2","tilde3","tilde4","vec","widehat1","widehat2","widehat3","widehat4","widecheck1","widecheck2","widecheck3","widecheck4","baraboveleftarrow","rightarrowabovebar","baraboveshortleftharpoon","rightharpoonaboveshortbar","shortbaraboveleftharpoon","shortrightharpoonabovebar","depth","maxFontSize","hasClass","toNode","frag","toMarkup","markup","toText","child","fontMetricsData","sigmasAndXis","slant","space","stretch","shrink","xHeight","quad","extraSpace","num1","num2","num3","denom1","denom2","sup1","sup2","sup3","sub1","sub2","supDrop","subDrop","delim1","delim2","axisHeight","defaultRuleThickness","bigOpSpacing1","bigOpSpacing2","bigOpSpacing3","bigOpSpacing4","bigOpSpacing5","sqrtRuleThickness","ptPerEm","doubleRuleSep","arrayRuleWidth","fboxsep","fboxrule","extraCharacterMap","getCharacterMetrics","character","font","mode","ch","metrics","italic","skew","fontMetricsBySizeIndex","sizeStyleMap","sizeMultipliers","sizeAtStyle","Options","textSize","phantom","fontFamily","fontWeight","fontShape","sizeMultiplier","_fontMetrics","BASESIZE","extend","extension","havingStyle","havingCrampedStyle","havingSize","havingBaseStyle","wantSize","havingBaseSizing","withColor","withPhantom","withFont","withTextFontFamily","withTextFontWeight","withTextFontShape","sizingClasses","oldOptions","baseSizingClasses","fontMetrics","sizeIndex","cssEmPerMu","getGlobalMetrics","getColor","ptPerUnit","pt","mm","cm","in","bp","pc","dd","cc","nd","nc","sp","px","relativeUnit","ex","em","mu","validUnit","calculateSize","sizeValue","scale","unitOptions","makeEm","toFixed","createClass","cls","initNode","invalidAttributeNameRegex","Span","Anchor","Img","alt","iCombinations","SymbolNode","script","_i","block","scriptFromCodepoint","span","marginRight","needsSpan","escaped","SvgNode","PathNode","pathName","alternate","LineNode","assertSymbolDomNode","ATOMS","bin","inner","punct","NON_ATOMS","mathord","spacing","textord","symbols","math","defineSymbol","acceptUnicodeChar","main","ams","accent","op","ligatures","mathTextSymbols","charAt","textSymbols","_ch","letters","_i2","_ch2","wideChar","_i3","_ch3","fromCharCode","_i4","_ch4","extraLatin","_i5","_ch5","wideLatinLetterData","wideNumeralData","lookupSymbol","fontName","makeSymbol","symbolNode","lookup","canCombine","_style","sizeElementFromChildren","makeSpan$2","makeSvgSpan","makeFragment","retrieveTextFontName","baseFontName","fontMap","mathbf","mathrm","textit","mathit","mathnormal","mathsfit","mathbb","mathcal","mathfrak","mathscr","mathsf","mathtt","svgData","buildCommon","mathsym","makeSpan","makeLineSpan","thickness","line","borderBottomWidth","makeAnchor","anchor","wrapFragment","makeVList","positionType","oldChildren","_depth","currPos","diff","positionData","getVListChildrenAndDepth","pstrutSize","pstrut","realChildren","minPos","maxPos","_child","_elem","wrapperClasses","wrapperStyle","childWrap","marginLeft","rows","vlist","emptySpan","depthStrut","topStrut","vtable","makeOrd","isFont","fontOrFamily","wideFontName","wideFontClass","codePoint","wideCharacterFont","fontClasses","fontData","fontClass","boldsymbol","_fontName","_fontName3","_fontName2","makeGlue","measurement","rule","staticSvg","svgNode","preserveAspectRatio","tryCombineChars","chars","thinspace","mediumspace","thickspace","spacings","mord","mop","mbin","mrel","minner","mopen","mclose","mpunct","tightSpacings","_functions","_htmlGroupBuilders","_mathmlGroupBuilders","defineFunction","names","handler","htmlBuilder","mathmlBuilder","numArgs","argTypes","allowedInArgument","allowedInText","allowedInMath","numOptionalArgs","infix","primitive","defineFunctionBuilders","_ref2","normalizeArgument","ordargument","makeSpan$1","binLeftCanceller","binRightCanceller","styleMap$1","scriptscript","DomEnum","buildExpression$1","expression","isRealGroup","surrounding","buildGroup$1","glueOptions","dummyPrev","dummyNext","isRoot","traverseNonSpaceNodes","prevType","getTypeOfDomTree","nodes","partialGroup","checkPartialGroup","nonspace","insertAfter","getOutermostNode","side","makeNullDelimiter","moreClasses","baseOptions","groupNode","multiplier","buildHTMLUnbreakable","strut","verticalAlign","buildHTML","tree","eqnNum","tagChild","nobreak","htmlNode","newDocumentFragment","MathNode","TextNode","mathMLTree","SpaceNode","makeText","makeRow","getVariant","isNumberPunctuation","buildExpression","isOrdgroup","buildGroup","lastGroup","_group","lastChild","buildExpressionRow","buildMathML","texExpression","isDisplayMode","forMathmlOnly","semantics","wrapperClass","optionsFromSettings","displayWrap","stretchyCodePoint","widehat","widecheck","widetilde","utilde","overleftarrow","underleftarrow","xleftarrow","overrightarrow","underrightarrow","xrightarrow","underbrace","overbrace","overgroup","undergroup","overleftrightarrow","underleftrightarrow","xleftrightarrow","Overrightarrow","xRightarrow","overleftharpoon","xleftharpoonup","overrightharpoon","xrightharpoonup","xLeftarrow","xLeftrightarrow","xhookleftarrow","xhookrightarrow","xmapsto","xrightharpoondown","xleftharpoondown","xrightleftharpoons","xleftrightharpoons","xtwoheadleftarrow","xtwoheadrightarrow","xlongequal","xtofrom","xrightleftarrows","xrightequilibrium","xleftequilibrium","katexImagesData","overlinesegment","underlinesegment","stretchy","topPad","bottomPad","img","totalHeight","borderColor","lines","x1","y1","x2","y2","viewBoxWidth","viewBoxHeight","_height","numChars","imgIndex","widthClasses","aligns","spans","paths","_minWidth","_viewBoxHeight","_height2","numSvgChildren","_path","_svgNode","_span","buildSvgSpan_","assertNodeType","assertSymbolNodeType","typedNode","checkSymbolNodeType","htmlBuilder$a","grp","supSubGroup","assertSpan","isShifty","baseChar","accentBody","accentBelow","clearance","isStretchy","accentFull","accentWrap","mathmlBuilder$9","accentNode","NON_STRETCHY_ACCENT_REGEX","funcName","parser","innerGroup","kern","paddedNode","optArgs","below","lowerGroup","newOptions","upperGroup","arrowPrefix","arrowBody","arrowShift","upperShift","lowerShift","arrowNode","upperNode","lowerNode","_lowerNode","htmlBuilder$9","mclass","mathmlBuilder$8","lspace","rspace","binrelClass","atom","family","_ref3","baseArg","shiftedArg","baseOp","limits","alwaysHandleSupSub","parentIsSupSub","suppressBaseShift","supsub","textShadow","cdArrowFunctionName","isStartOfArrow","cdArrow","arrowChar","labels","callFunction","bareArrow","arrowGroup","htmlBuilder$8","mathmlBuilder$7","breakOnTokenText","gullet","parseExpression","future","parseSizeGroup","newLine","globalMap","checkControlSequence","tok","letCommand","macro","tokens","unexpandable","consumeSpaces","fetch","parseFunction","popToken","insert","delimiters","consumeArg","expandTokens","reverse","getRHS","_ref4","middle","pushToken","getMetrics","styleWrap","delim","toStyle","delimSizeMultiplier","centerSpan","makeLargeDelim","center","mathrmSize","makeGlyphSpan","sizeClass","makeInner","innerPath","round","lap","verts","doubleVerts","makeStackedDelim","heightTotal","repeat","svgLabel","topMetrics","topHeightTotal","repeatMetrics","repeatHeightTotal","bottomMetrics","bottomHeightTotal","middleHeightTotal","middleFactor","middleMetrics","minHeight","realHeightTotal","ceil","stack","midHeight","pathStr","tallDelim","_innerHeight","emPad","sqrtSvg","sqrtName","extraVinculum","sqrtMain","sqrtSize1","sqrtSize2","sqrtSize3","sqrtSize4","sqrtTall","sqrtPath","pathNode","stackLargeDelimiters","stackAlwaysDelimiters","stackNeverDelimiters","sizeToMaxHeight","stackNeverDelimiterSequence","stackAlwaysDelimiterSequence","stackLargeDelimiterSequence","delimTypeToFont","traverseSequence","sequence","heightDepth","makeCustomSizedDelim","delimType","makeSmallDelim","delimiter","sqrtImage","advanceWidth","spanHeight","texHeight","ruleWidth","sizedDelim","customSizedDelim","leftRightDelim","delimiterExtend","maxDistFromAxis","delimiterSizes","checkDelimiter","symDelim","assertParsed","leftrightDepth","expect","right","rightColor","leftDelim","rightDelim","innerDepth","hadMiddle","isMiddle","colorOptions","leftNode","rightNode","middleDelim","textNode","middleNode","htmlBuilder$7","imgShift","isSingleChar","lineWeight","angleHeight","paddingLeft","phasePath","ruleThickness","borderStyle","borderWidth","borderTopWidth","borderRightWidth","backgroundColor","mathmlBuilder$6","thk","_ref5","_environments","defineEnvironment","_macros","defineMacro","getHLines","hlineInfo","nxt","consume","validateAmsEnvironmentContext","envName","getAutoTag","parseArray","hskipBeforeAndAfter","addJot","cols","arraystretch","colSeparationType","autoTag","singleRow","emptySingleRow","maxNumCols","beginGroup","expandMacroAsText","row","rowGaps","hLinesBeforeRow","beginRow","endRow","subparse","cell","endGroup","nextToken","dCellStyle","htmlBuilder$6","nr","hlines","arraycolsep","baselineskip","jot","arrayskip","arstrutHeight","arstrutDepth","setHLinePos","hlinesInGap","pos","isDashed","inrow","outrow","elt","rowGap","gap","colSep","colDescrNum","offset","colDescriptions","tagSpans","rw","tagSpan","colDescr","firstSeparator","separator","lineType","borderRightStyle","margin","_shift","sepwidth","pregap","col","_shift2","postgap","dashes","vListElems","hline","lineShift","eqnNumCol","alignMap","mathmlBuilder$5","tbl","glue","menclose","columnLines","prevTypeWasAlign","iStart","iEnd","_cols","rowLines","alignedHandler","numMaths","separationType","isSplit","res","numCols","emptyGroup","arg0","isAligned","styling","curMaths","nde","ca","matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","colAlign","parsedRows","endChar","rowNodes","labelNum","inLabel","wrappedArrow","parseCD","environments","nameGroup","env","_args","parseArguments","endNameToken","htmlBuilder$5","mathmlBuilder$4","fontAliases","adjustStyle","originalStyle","htmlBuilder$4","nstyle","dstyle","numerm","numer","continued","hStrut","dStrut","ruleSpacing","numShift","denomShift","frac","delimSize","denomm","denom","hasBarLine","barSize","midShift","candidateClearance","mathmlBuilder$3","isDisplay","withDelims","leftOp","rightOp","stylArray","delimFromValue","delimString","barNode","isBlank","styl","textOrd","_ref6","assert","htmlBuilder$3","braceBody","isOver","vSpan","command","formatUnsupportedCmd","trustContext","keyVal","mathml","sizeData","totalheight","mathFunction","muUnit","dimension","alignment","fix","outerMode","switchMode","chooseMathStyle","assembleSupSub","supGroup","subGroup","baseShift","finalGroup","subIsSingleCharacter","_bottom","spacer","noSuccessor","htmlBuilder$2","hasLimits","large","stash","oval","mathmlBuilder$1","operator","singleCharBigOps","fName","singleCharIntegrals","htmlBuilder$1","childText","sizingGroup","isAllString","word","identifier","semisimple","amount","dy","sizeFuncs","smashHeight","smashDepth","tbArg","letter","smashedNode","theta","phi","lineClearance","minDelimiterHeight","delimDepth","rootm","toShift","rootVList","rootVListWrap","styleMap","newStyle","builderDelegate","htmlBuilderDelegate","supm","subm","minSupShift","valueBase","valueSup","valueSub","supShift","subShift","_newOptions","isOiint","maxWidth","psi","vlistElem","_vlistElem","isBrace","_base2","_base","defaultVariant","mi","mn","mtext","cssSpace","regularSpace","ord","pad","padNode","textFontFamilies","textFontWeights","textFontShapes","optionsWithFont","makeVerb","star","functions","spaceRegexString","controlWordWhitespaceRegexString","combiningDiacriticalMarkString","combiningDiacriticalMarksEndRegex","tokenRegexString","Lexer","tokenRegex","catcodes","setCatcode","char","lex","nlIndex","Namespace","builtins","globalMacros","undefStack","undefs","undef","endGroups","expandOnce","consumeArgs","digitToNumber","digit","newcommand","existsOK","nonexistsOK","skipIfExists","exists","isDefined","argText","expandNextToken","dotsByToken","thedots","expandAfterFuture","spaceAfterDots","latexRaiseA","braketHelper","one","middleDouble","oldMiddle","oldMiddleDouble","midMacro","double","doubled","implicitCommands","MacroExpander","expansionCount","feed","newMode","pushTokens","scanArgument","isOptional","delims","isDelimited","countExpansion","expandableOnly","topToken","expansion","_getExpansion","expandMacro","oldStackLength","definition","catcode","stripped","bodyLexer","unicodeSubRegEx","uSubsAndSups","unicodeAccents","unicodeSymbols","Parser","parse","oldToken","breakOnInfix","endOfExpression","parseAtom","formLigatures","handleInfixNodes","overIndex","numerNode","denomNode","numerBody","denomBody","handleSupSubscript","symbolToken","parseGroup","textordArray","superscript","subscript","prime","primes","isSub","subsupTokens","funcData","totalArgs","argType","parseGroupOfType","optional","parseColorGroup","parseUrlGroup","parseArgumentGroup","parseStringGroup","_group2","modeName","argToken","parseRegexGroup","regex","firstToken","lastToken","parseSymbol","nucleus","parseTree","toParse","baseNode","renderToDomTree","compatMode","renderError","katexNode","mathMLNode","_htmlNode","buildTree","katex","renderToString","__parse","__renderToDomTree","__renderToHTMLTree","buildHTMLTree","__setFontMetrics","__defineSymbol","__defineFunction","__defineMacro","__domTree","getDefaultOpts","simple","defaultOptions","omitExtraWLInCodeBlocks","defaultValue","describe","noHeaderId","prefixHeaderId","rawPrefixHeaderId","ghCompatibleHeaderId","rawHeaderId","headerLevelStart","parseImgDimensions","simplifiedAutoLink","excludeTrailingPunctuationFromURLs","literalMidWordUnderscores","literalMidWordAsterisks","strikethrough","tables","tablesHeaderId","ghCodeBlocks","tasklists","smoothLivePreview","smartIndentationFix","disableForced4SpacesIndentedSublists","simpleLineBreaks","requireSpaceBeforeHeadingText","ghMentions","ghMentionsLink","encodeEmails","openLinksInNewWindow","backslashEscapesHTMLTags","emoji","ellipsis","completeHTMLDocument","splitAdjacentBlockquotes","opt","showdown","parsers","extensions","globalOptions","setFlavor","flavor","github","original","ghost","vanilla","allOn","allOptionsOn","validate","errMsg","valid","helper","baseMsg","ext","isString","isUndefined","ln","escapeCharactersCallback","wholeMatch","m1","setOption","getOption","getOptions","resetOptions","preset","option","getFlavor","getFlavorOptions","getDefaultOptions","subParser","stdExtName","validExtension","getAllExtensions","removeExtension","resetExtensions","validateExtension","isFunction","escapeCharacters","charsToEscape","afterBackslash","regexString","unescapeHTMLEntities","txt","rgxFindMatchPos","flags","matchRecursiveRegExp","matchPos","results","replaceRecursiveRegExp","replacement","repStr","finalStr","lng","bits","regexIndexOf","fromIndex","splitAtIndex","encodeEmailAddress","mail","encode","padEnd","targetLength","padString","msg","alert","regexes","asteriskDashAndColon","emojis","ab","abc","abcd","accept","aerial_tramway","airplane","alarm_clock","alembic","alien","ambulance","amphora","angel","anger","angry","anguished","ant","apple","aquarius","aries","arrow_backward","arrow_double_down","arrow_double_up","arrow_down","arrow_down_small","arrow_forward","arrow_heading_down","arrow_heading_up","arrow_left","arrow_lower_left","arrow_lower_right","arrow_right","arrow_right_hook","arrow_up","arrow_up_down","arrow_up_small","arrow_upper_left","arrow_upper_right","arrows_clockwise","arrows_counterclockwise","art","articulated_lorry","artificial_satellite","astonished","athletic_shoe","atm","atom_symbol","avocado","baby","baby_bottle","baby_chick","baby_symbol","back","bacon","badminton","baggage_claim","baguette_bread","balance_scale","balloon","ballot_box","ballot_box_with_check","bamboo","banana","bangbang","bank","bar_chart","barber","baseball","basketball","basketball_man","basketball_woman","bat","bath","bathtub","battery","beach_umbrella","bear","bed","bee","beer","beers","beetle","beginner","bell","bellhop_bell","bento","biking_man","bike","biking_woman","bikini","biohazard","bird","birthday","black_circle","black_flag","black_heart","black_joker","black_large_square","black_medium_small_square","black_medium_square","black_nib","black_small_square","black_square_button","blonde_man","blonde_woman","blossom","blowfish","blue_book","blue_car","blue_heart","blush","boar","boat","bomb","book","bookmark","bookmark_tabs","books","boom","boot","bouquet","bowing_man","bow_and_arrow","bowing_woman","bowling","boxing_glove","boy","bread","bride_with_veil","bridge_at_night","briefcase","broken_heart","bug","building_construction","bulb","bullettrain_front","bullettrain_side","burrito","bus","business_suit_levitating","busstop","bust_in_silhouette","busts_in_silhouette","butterfly","cactus","cake","calendar","call_me_hand","calling","camel","camera","camera_flash","camping","cancer","candle","candy","canoe","capital_abcd","capricorn","car","card_file_box","card_index","card_index_dividers","carousel_horse","carrot","cat","cat2","cd","chains","champagne","chart","chart_with_downwards_trend","chart_with_upwards_trend","checkered_flag","cheese","cherries","cherry_blossom","chestnut","chicken","children_crossing","chipmunk","chocolate_bar","christmas_tree","church","cinema","circus_tent","city_sunrise","city_sunset","cityscape","cl","clamp","clap","clapper","classical_building","clinking_glasses","clock1","clock10","clock1030","clock11","clock1130","clock12","clock1230","clock130","clock2","clock230","clock3","clock330","clock4","clock430","clock5","clock530","clock6","clock630","clock7","clock730","clock8","clock830","clock9","clock930","closed_book","closed_lock_with_key","closed_umbrella","cloud","cloud_with_lightning","cloud_with_lightning_and_rain","cloud_with_rain","cloud_with_snow","clown_face","clubs","cocktail","coffee","coffin","cold_sweat","comet","computer","computer_mouse","confetti_ball","confounded","confused","congratulations","construction","construction_worker_man","construction_worker_woman","control_knobs","convenience_store","cookie","cool","policeman","copyright","corn","couch_and_lamp","couple","couple_with_heart_woman_man","couple_with_heart_man_man","couple_with_heart_woman_woman","couplekiss_man_man","couplekiss_man_woman","couplekiss_woman_woman","cow","cow2","cowboy_hat_face","crab","crayon","credit_card","crescent_moon","cricket","crocodile","croissant","crossed_fingers","crossed_flags","crossed_swords","crown","cry","crying_cat_face","crystal_ball","cucumber","cupid","curly_loop","currency_exchange","curry","custard","customs","cyclone","dagger","dancer","dancing_women","dancing_men","dango","dark_sunglasses","dart","dash","deciduous_tree","deer","department_store","derelict_house","desert","desert_island","desktop_computer","male_detective","diamond_shape_with_a_dot_inside","diamonds","disappointed","disappointed_relieved","dizzy","dizzy_face","do_not_litter","dog","dog2","dollar","dolls","dolphin","door","doughnut","dove","dragon","dragon_face","dress","dromedary_camel","drooling_face","droplet","drum","duck","dvd","eagle","ear","ear_of_rice","earth_africa","earth_americas","earth_asia","egg","eggplant","eight_pointed_black_star","eight_spoked_asterisk","electric_plug","elephant","envelope_with_arrow","euro","european_castle","european_post_office","evergreen_tree","exclamation","expressionless","eye","eye_speech_bubble","eyeglasses","eyes","face_with_head_bandage","face_with_thermometer","fist_oncoming","fallen_leaf","family_man_woman_boy","family_man_boy","family_man_boy_boy","family_man_girl","family_man_girl_boy","family_man_girl_girl","family_man_man_boy","family_man_man_boy_boy","family_man_man_girl","family_man_man_girl_boy","family_man_man_girl_girl","family_man_woman_boy_boy","family_man_woman_girl","family_man_woman_girl_boy","family_man_woman_girl_girl","family_woman_boy","family_woman_boy_boy","family_woman_girl","family_woman_girl_boy","family_woman_girl_girl","family_woman_woman_boy","family_woman_woman_boy_boy","family_woman_woman_girl","family_woman_woman_girl_boy","family_woman_woman_girl_girl","fast_forward","fax","fearful","feet","female_detective","ferris_wheel","ferry","field_hockey","file_cabinet","file_folder","film_projector","film_strip","fire","fire_engine","fireworks","first_quarter_moon","first_quarter_moon_with_face","fish","fish_cake","fishing_pole_and_fish","fist_raised","fist_left","fist_right","flashlight","fleur_de_lis","flight_arrival","flight_departure","floppy_disk","flower_playing_cards","flushed","fog","foggy","football","footprints","fork_and_knife","fountain","fountain_pen","four_leaf_clover","fox_face","framed_picture","free","fried_egg","fried_shrimp","fries","frog","frowning","frowning_face","frowning_man","frowning_woman","middle_finger","fuelpump","full_moon","full_moon_with_face","funeral_urn","game_die","gear","gem","gemini","gift","gift_heart","girl","globe_with_meridians","goal_net","goat","golf","golfing_man","golfing_woman","gorilla","grapes","green_apple","green_book","green_heart","green_salad","grey_exclamation","grey_question","grimacing","grin","grinning","guardsman","guardswoman","guitar","gun","haircut_woman","haircut_man","hamburger","hammer","hammer_and_pick","hammer_and_wrench","hamster","hand","handbag","handshake","hankey","hatched_chick","hatching_chick","headphones","hear_no_evil","heart","heart_decoration","heart_eyes","heart_eyes_cat","heartbeat","heartpulse","hearts","heavy_check_mark","heavy_division_sign","heavy_dollar_sign","heavy_heart_exclamation","heavy_minus_sign","heavy_multiplication_x","heavy_plus_sign","helicopter","herb","hibiscus","high_brightness","high_heel","hocho","hole","honey_pot","horse","horse_racing","hospital","hot_pepper","hotdog","hotel","hotsprings","hourglass","hourglass_flowing_sand","house","house_with_garden","houses","hugs","hushed","ice_cream","ice_hockey","ice_skate","icecream","ideograph_advantage","imp","inbox_tray","incoming_envelope","tipping_hand_woman","information_source","innocent","interrobang","iphone","izakaya_lantern","jack_o_lantern","japan","japanese_castle","japanese_goblin","japanese_ogre","jeans","joy","joy_cat","joystick","kaaba","keyboard","keycap_ten","kick_scooter","kimono","kiss","kissing","kissing_cat","kissing_closed_eyes","kissing_heart","kissing_smiling_eyes","kiwi_fruit","koala","koko","large_blue_circle","large_blue_diamond","large_orange_diamond","last_quarter_moon","last_quarter_moon_with_face","latin_cross","laughing","leaves","ledger","left_luggage","left_right_arrow","leftwards_arrow_with_hook","lemon","leo","leopard","level_slider","libra","light_rail","lion","lips","lipstick","lizard","lock","lock_with_ink_pen","lollipop","loud_sound","loudspeaker","love_hotel","love_letter","low_brightness","lying_face","mag","mag_right","mahjong","mailbox","mailbox_closed","mailbox_with_mail","mailbox_with_no_mail","man","man_artist","man_astronaut","man_cartwheeling","man_cook","man_dancing","man_facepalming","man_factory_worker","man_farmer","man_firefighter","man_health_worker","man_in_tuxedo","man_judge","man_juggling","man_mechanic","man_office_worker","man_pilot","man_playing_handball","man_playing_water_polo","man_scientist","man_shrugging","man_singer","man_student","man_teacher","man_technologist","man_with_gua_pi_mao","man_with_turban","tangerine","mans_shoe","mantelpiece_clock","maple_leaf","martial_arts_uniform","mask","massage_woman","massage_man","meat_on_bone","medal_military","medal_sports","mega","melon","memo","men_wrestling","menorah","mens","metal","metro","microphone","microscope","milk_glass","milky_way","minibus","minidisc","mobile_phone_off","money_mouth_face","money_with_wings","moneybag","monkey","monkey_face","monorail","moon","mortar_board","mosque","motor_boat","motor_scooter","motorcycle","motorway","mount_fuji","mountain","mountain_biking_man","mountain_biking_woman","mountain_cableway","mountain_railway","mountain_snow","mouse","mouse2","movie_camera","moyai","mrs_claus","muscle","mushroom","musical_keyboard","musical_note","musical_score","mute","nail_care","name_badge","national_park","nauseated_face","necktie","negative_squared_cross_mark","nerd_face","neutral_face","new","new_moon","new_moon_with_face","newspaper","newspaper_roll","next_track_button","ng","no_good_man","no_good_woman","night_with_stars","no_bell","no_bicycles","no_entry","no_entry_sign","no_mobile_phones","no_mouth","no_pedestrians","no_smoking","nose","notebook","notebook_with_decorative_cover","notes","nut_and_bolt","o2","ocean","octopus","oden","office","oil_drum","ok","ok_hand","ok_man","ok_woman","old_key","older_man","older_woman","om","on","oncoming_automobile","oncoming_bus","oncoming_police_car","oncoming_taxi","open_file_folder","open_hands","open_mouth","open_umbrella","ophiuchus","orange_book","orthodox_cross","outbox_tray","owl","ox","package","page_facing_up","page_with_curl","pager","paintbrush","palm_tree","pancakes","panda_face","paperclip","paperclips","parasol_on_ground","parking","part_alternation_mark","partly_sunny","passenger_ship","passport_control","pause_button","peace_symbol","peach","peanuts","pear","pen","pencil2","penguin","pensive","performing_arts","persevere","person_fencing","pouting_woman","phone","pick","pig","pig2","pig_nose","pill","pineapple","ping_pong","pisces","pizza","place_of_worship","plate_with_cutlery","play_or_pause_button","point_down","point_left","point_right","point_up","point_up_2","police_car","policewoman","poodle","popcorn","post_office","postal_horn","postbox","potable_water","potato","pouch","poultry_leg","pound","rage","pouting_cat","pouting_man","pray","prayer_beads","pregnant_woman","previous_track_button","prince","princess","printer","purple_heart","purse","pushpin","put_litter_in_its_place","question","rabbit","rabbit2","racehorse","racing_car","radio","radio_button","radioactive","railway_car","railway_track","rainbow","rainbow_flag","raised_back_of_hand","raised_hand_with_fingers_splayed","raised_hands","raising_hand_woman","raising_hand_man","ram","ramen","rat","record_button","recycle","red_circle","registered","relaxed","relieved","reminder_ribbon","repeat_one","rescue_worker_helmet","restroom","revolving_hearts","rewind","rhinoceros","ribbon","rice","rice_ball","rice_cracker","rice_scene","right_anger_bubble","ring","robot","rocket","rofl","roll_eyes","roller_coaster","rooster","rose","rosette","rotating_light","round_pushpin","rowing_man","rowing_woman","rugby_football","running_man","running_shirt_with_sash","running_woman","sa","sagittarius","sake","sandal","santa","satellite","saxophone","school","school_satchel","scissors","scorpion","scorpius","scream","scream_cat","scroll","seat","secret","see_no_evil","seedling","selfie","shallow_pan_of_food","shamrock","shark","shaved_ice","sheep","shell","shield","shinto_shrine","ship","shirt","shopping","shopping_cart","shower","shrimp","signal_strength","six_pointed_star","ski","skier","skull","skull_and_crossbones","sleeping","sleeping_bed","sleepy","slightly_frowning_face","slightly_smiling_face","slot_machine","small_airplane","small_blue_diamond","small_orange_diamond","small_red_triangle","small_red_triangle_down","smile","smile_cat","smiley","smiley_cat","smiling_imp","smirk","smirk_cat","smoking","snail","snake","sneezing_face","snowboarder","snowflake","snowman","snowman_with_snow","sob","soccer","soon","sos","sound","space_invader","spades","spaghetti","sparkle","sparkler","sparkles","sparkling_heart","speak_no_evil","speaker","speaking_head","speech_balloon","speedboat","spider","spider_web","spiral_calendar","spiral_notepad","spoon","squid","stadium","star2","star_and_crescent","star_of_david","stars","station","statue_of_liberty","steam_locomotive","stew","stop_button","stop_sign","stopwatch","straight_ruler","strawberry","stuck_out_tongue","stuck_out_tongue_closed_eyes","stuck_out_tongue_winking_eye","studio_microphone","stuffed_flatbread","sun_behind_large_cloud","sun_behind_rain_cloud","sun_behind_small_cloud","sun_with_face","sunflower","sunglasses","sunny","sunrise","sunrise_over_mountains","surfing_man","surfing_woman","sushi","suspension_railway","sweat","sweat_drops","sweat_smile","sweet_potato","swimming_man","swimming_woman","synagogue","syringe","taco","tada","tanabata_tree","taurus","taxi","tea","telephone_receiver","telescope","tennis","tent","thermometer","thinking","thought_balloon","ticket","tickets","tiger","tiger2","timer_clock","tipping_hand_man","tired_face","tm","toilet","tokyo_tower","tomato","tongue","tophat","tornado","trackball","tractor","traffic_light","train","train2","tram","triangular_flag_on_post","triangular_ruler","trident","triumph","trolleybus","trophy","tropical_drink","tropical_fish","truck","trumpet","tulip","tumbler_glass","turkey","turtle","tv","twisted_rightwards_arrows","two_hearts","two_men_holding_hands","two_women_holding_hands","u5272","u5408","u55b6","u6307","u6708","u6709","u6e80","u7121","u7533","u7981","u7a7a","umbrella","unamused","underage","unicorn","unlock","up","upside_down_face","vertical_traffic_light","vhs","vibration_mode","video_camera","video_game","violin","virgo","volcano","volleyball","vs","vulcan_salute","walking_man","walking_woman","waning_crescent_moon","waning_gibbous_moon","warning","wastebasket","watch","water_buffalo","watermelon","wave","wavy_dash","waxing_crescent_moon","wc","weary","wedding","weight_lifting_man","weight_lifting_woman","whale","whale2","wheel_of_dharma","wheelchair","white_check_mark","white_circle","white_flag","white_flower","white_large_square","white_medium_small_square","white_medium_square","white_small_square","white_square_button","wilted_flower","wind_chime","wind_face","wine_glass","wink","wolf","woman","woman_artist","woman_astronaut","woman_cartwheeling","woman_cook","woman_facepalming","woman_factory_worker","woman_farmer","woman_firefighter","woman_health_worker","woman_judge","woman_juggling","woman_mechanic","woman_office_worker","woman_pilot","woman_playing_handball","woman_playing_water_polo","woman_scientist","woman_shrugging","woman_singer","woman_student","woman_teacher","woman_technologist","woman_with_turban","womans_clothes","womans_hat","women_wrestling","womens","world_map","worried","wrench","writing_hand","yellow_heart","yen","yin_yang","yum","zap","zipper_mouth_face","zzz","octocat","Converter","converterOptions","langExtensions","outputModifiers","setConvFlavor","parsed","_parseExtension","legacyExtensionLoading","validExt","listen","gOpt","_constructor","_dispatch","evtName","globals","ei","nText","makeHtml","gHtmlBlocks","gHtmlMdBlocks","gHtmlSpans","gUrls","gTitles","gDimensions","gListLevel","hashLinkCounts","converter","rsp","rgx","rTrimInputText","makeMarkdown","makeMd","HTMLParser","preList","pres","presPH","childElementCount","language","substitutePreCodeTags","clean","nodeValue","mdDoc","addExtension","useExtension","extensionName","ii","getMetadata","getMetadataFormat","_setMetadataPair","_setMetadataFormat","_setMetadataRaw","writeAnchorTag","linkText","linkId","m5","m6","wm","st","lnk","simpleURLRegex","simpleURLRegex2","delimUrlRegex","simpleMailRegex","delimMailRegex","replaceLink","leadingMagicChars","m2","m3","trailingPunctuation","trailingMagicChars","lnkTxt","lmc","tmc","replaceMail","bq","pre","codeblock","nextChar","doctypeParsed","charset","lang","meta","leadingText","numSpaces","emojiCode","blockText","blockTags","repFunc","inside","opTagPos","rgx1","patLeft","patRight","subTexts","newSubText1","hashHTMLSpan","repText","limit","num","$1","setextRegexH1","setextRegexH2","spanGamut","hID","headerId","hashBlock","matchFound","hLevel","atxStyle","prefix","customizedHeaderId","hText","header","writeImageTag","altText","gDims","parseInside","lead","processListItems","listStr","trimTrailing","isParagraphed","m4","taskbtn","bulletStyle","otp","wm2","styleStartNumber","listType","parseConsecutiveLists","olRgx","ulRgx","counterRxg","parseCL","parseMetadataContents","wholematch","grafs","grafsOut","grafsOutIt","codeFlag","$2","re","replaceFunc","blankLines","parseCells","parseTable","rawTable","tableLines","sLine","rawHeaders","rawStyles","rawCells","headers","cells","tableHeaderId","tb","tblLgn","buildTable","charCodeToReplace","childrenLength","innerTxt","headerLevel","headerMark","listItems","listItemsLenght","listNum","listItemTxt","childrenLenght","spansOnly","tableArray","headings","headContent","allign","cellContent","cellSpacesCount","strLen","targetBlank","mathPlaceholder","renderMathAndMarkdown","markdown","mathInfo","mathBlocks","replacedContent","blockMathStart","inlineMathStart","mathStart","mathEnd","placeholder","extractMath","markdownHTML","renderMarkdown","mathAndMarkdownHTML","renderedMath","escapeHtml","insertMath","StyledText","restProps","dir","MentionPopoverContent","isUsernameMode","joined","roundRectCoords","rect","DOMRect","MarkdownView","mentionsEnabled","clearTimeout_","mentionsPopoverAnchorRef","mentionsPopoverRef","elementToMentionMap","popoverContent","setPopoverContent","popoverContentTimeout","setPopoverContentAfterDelay","setContent","replaceLinksWithEmbeds","mentionElements","foundMentions","mentionElement","htmlMentionElement","mentionUserId","processAndReplaceMentionElements","maybeHidePopover","unionBox","fromRect","unionRect","rectContainsPoint","clientX","clientY","relative","dangerouslySetInnerHTML","onMouseEnterCapture","onMouseLeaveCapture","TagList","TagListItem","onRemoveTag","ToggleExcerptButton","toggleText","AnnotationBody$1","collapsible","setCollapsible","showExcerpt","showTagList","textStyle","authorIsThirdParty","createTagSearchURL","Excerpt","LinkType","mirrorDiv","replaceText","newSelectionStart","selectionStart","newSelectionEnd","selectionEnd","convertSelectionToLink","linkType","ANCHOR_LINK","linkPrefix","IMAGE_LINK","dummyLabel","beforeURL","dummyLink","toggleSpanStyle","selectionPrefix","selectionSuffix","endOfLine","transformLines","lineStart","startOfLine","lineEnd","lineIndex","isLastLine","currentLineLength","newLineLength","toggleBlockStyle","prefixToString","blockHasStyle","_lineEnd","mirrorDebug","SuggestionItem","usersListboxId","onSelect","onHighlight","showUsername","onMouseMove","MentionSuggestionsPopover","loadingUsers","users","onSelectUser","highlightedSuggestion","onHighlightSuggestion","popoverProps","SHORTCUT_KEYS","bold","image","numlist","ToolbarButton","shortcutKey","modifierKey","tooltip","toUpperCase","buttonProps","TextArea","usersForMentions","onEditText","onInsertMentionSuggestion","suggestionsPopoverOpen","setSuggestionsPopoverOpen","activeMention","setActiveMention","textareaRef","setHighlightedSuggestion","caretElementRef","userSuggestions","mentionToMatch","maxUsers","usersMatchingMention","checkForMentionAtCaret","textarea","textareaRect","padding","whiteSpace","wordWrap","caretPosition","caretSpan","textBeforeCaret","textAfterCaret","overflowY","scrollTop","getCaretCoordinates","transform","term","termBeforePosition","isAtMention","insertMention","suggestion","beforeCaret","toPlainTextMention","afterMention","accessibilityAttributes","selectedSuggestion","activeDescendant","onInput","onKeyUp","Toolbar","isPreviewing","onCommand","onTogglePreview","showHelpLink","toolbarContainer","MarkdownEditor","preview","setPreview","textWithoutMentionTags","tagContent","tempElement","original_userid","unwrapMentions","handleCommand","inputEl","newStateFn","before","KeyboardEvent","handleToolbarCommand","togglePreview","defaultListFormatter","AutocompleteList","activeItem","itemPrefixId","listFormatter","onSelectItem","items","tagEditorIdCounter","TagEditor$1","onAddTag","onTagInput","tagList","tagsService","suggestions","setSuggestions","setActiveItem","suggestionsListOpen","setSuggestionsListOpen","tagEditorId","closeWrapperRef","pendingTag","hasPendingTag","clearPendingTag","addTag","newTag","changeSelectedItem","nextActiveItem","handleOnInput","updateSuggestions","removeDuplicates","duplicates","suggestionsSet","handleFocus","autoComplete","curVal","matchIndex","matchString","AnnotationLicense","MenuKeyboardNavigation","closeMenu","menuRef","focusTimer","firstItem","menuItems","ignoreNextClick","Menu","containerPositioned","contentClass","defaultOpen","onOpenChanged","menuIndicator","toggleMenu","onMouseDown","SubmenuToggle","isExpanded","onToggleSubmenu","MenuItem","isDisabled","isSubmenuItem","isSubmenuVisible","leftChannelContent","submenu","submenuToggleTitle","menuItemRef","menuItem","hasSubmenuVisible","isRadioButtonType","renderedIcon","leftIcon","rightIcon","hasRightContent","menuItemContent","AnnotationPublishControl$1","onCancel","onSave","onSetPrivate","buttonStyle","menuLabel","AnnotationEditor$1","groupsService","setPendingTag","isReplyAnno","shouldShowLicense","enableHelpPanel","onEditTags","newTagList","displayNameToUserMap","successMessage","save","focusedGroupUsers","usernameAlreadyAdded","displayNameA","displayNameB","combineUsersForMentions","TagEditor","AnnotationPublishControl","AnnotationDocumentInfo","AnnotationGroupInfo","linkToGroup","AnnotationTimestamps","annotationCreated","annotationUpdated","annotationURL","withEditedTimestamp","setNow","createdDate","updatedDate","created","absolute","editedString","AnnotationUser","authorLink","AnnotationHeader$1","isEditing","replyCount","threadIsCollapsed","userURL","authorName","userLink","usernameUrl","annotationAuthorLink","isCollapsedReply","showEditedTimestamp","getTime","hasBeenEdited","documentInfo","domainAndTitle","documentLink","showDocumentInfo","getPageLabel","onReplyCountClick","AnnotationQuote$1","isHovered","AnnotationReplyToggle","onToggleReplies","BitmapImage","bitmap","canvasRef","getContext","drawImage","AnnotationThumbnail$1","thumbnailService","thumbnail","setThumbnail","setError","devicePixelRatio","SavingMessage","Annotation$1","annotationQuote","isSaving","showActions","annotationDescription","targetShape","shapeSelector","AnnotationHeader","AnnotationThumbnail","AnnotationQuote","AnnotationBody","AnnotationEditor","AnnotationActionBar","EmptyAnnotation","api","annotationMetadata","unhide","hide","ThreadCollapseControl","ToggleIcon","toggleTitle","Thread$1","Thread","threadsService","visibleChildren","showReplyToggle","annotationContent","ModerationBanner","Annotation","forceVisible","ThreadCard$1","frameSync","threadTag","setThreadHovered","debounce","hoverAnnotation","isHighlighted","scrollToAnnotation","threadContent","cardRef","closest","onMouseEnter","onMouseLeave","SCROLL_PRECISION","getScrollContainer","roundScrollPosition","getSegmentSelector","headingKey","chapter","ThreadList","scrollContainerHeight","setScrollContainerHeight","scrollPosition","setScrollPosition","scrollContainer","updateScrollPosition","threadHeights","setThreadHeights","scrollToId","setScrollToId","topLevelThreads","offscreenLowerHeight","offscreenUpperHeight","visibleThreads","scrollPos","windowHeight","threadHeight","calculateVisibleThreads","prevHeadingKey","prevHeading","headingForKey","headingMap","heading","editing","newAnnotationTag","mostRelevantHighlightedAnnotationId","sortedHighlightedAnnos","mostRelevantAnnotation","threadIndex","yOffset","total","getThreadHeight","prevHeights","changedHeights","threadElement","getElementById","ThreadCard","DEFAULT_THREAD_STATE","annotationId","hasPathToRoot","ancestorId","ancestor","setParent","parents","parentId","mapThread","mapFn","sortThread","compareFn","replyCompareFn","sortedChildren","countRepliesAndDepth","hasVisibleChildren","replySortCompareFn","buildThread","hasSelection","hasForcedVisible","rootThreads","rootThreadId","isForcedVisible","threadFilterFn","threadIsVisible","filterFn","threadStates","hasUnfilteredChildren","sortCompareFn","splitCFIRange","rangeWithoutAssertions","stripCFIAssertions","inAssertion","compareCFIs","parseCFI","sepIndex","documentCFI","intVal","compareArrays","cfiInRange","parseRange","startInt","isInteger","endInt","RangeOverlap","normalizeRange","pageRangeOverlap","rangeA","rangeB","intRangeA","intRangeB","Overlap","Unknown","maxPage","aStart","aEnd","bStart","bEnd","NoOverlap","COMBINING_MARKS","normalizeStr","unicodeUtils","normalize","TermFilter","matcher","fieldValues","BooleanOpFilter","stringFieldMatcher","fieldMatchers","getCFI","cfiTerm","pageTerm","since","updatedTime","age","filterAnnotations","makeTermFilter","field","fieldFilters","terms","termFilters","anyFields","rootFilter","filterFields","searchFields","splitTerm","fieldNames","removeSurroundingQuotes","tokenize","tokenMatches","parseHypothesisSearchQuery","backendFilter","backendField","tabForAnnotation","newestRootAnnotationDate","newestDate","oldestRootAnnotationDate","oldestDate","compareNumbers","sign","compareStrings","compareThreads","sortBy","dateA","compareHeadlessThreads","aLocation","bLocation","cfiResult","pageOrder","topOrder","textOrder","compareByLocation","fn","lastArg","threadState","addedFilters","initialTerms","init","any","fieldValue","secondsPerDay","secondsPerUnit","sec","filterReplies","parseFilterQuery","annotationFilters","threadFilters","facet","rootThread","tabCounts","showTabs","useRootThread","AnnotationView$1","loadAnnotationsService","onLogin","fetchError","setFetchError","loadThread","annots","topLevelAnnot","VersionData","userInfo","documentFrames","window_","noValueString","accountString","urls","df","fingerprint","segmentInfo","segment","segmentFields","asFormattedString","asEncodedURLString","COMPLETE","CANCELED","setElementScroll","scrollTo","scrollLeft","animate","scrollSettings","_scrollSettings","maxSynchronousAlignments","parentPosition","differenceX","differenceY","targetWidth","targetHeight","targetPosition","leftAlign","topAlign","leftOffset","topOffset","leftScalar","topScalar","isWindow","innerWidth","pageXOffset","pageYOffset","lockX","lockY","offsetLeft","offsetTop","scrollWidth","getTargetScrollLocation","endIterations","easeValue","ease","scrollAncestor","task","raf","defaultIsWindow","defaultIsScrollable","defaultValidTarget","findParentElement","assignedSlot","defaultView","ownerWindow","getRootNode","scrollIntoView","pow","validTarget","isScrollable","scrollingElements","done","cancelHandler","idle","lastSettings","passiveOptions","passive","endType","cancellable","transitionScrollTo","SidebarPanel","onActiveChanged","panelElement","panelWasActive","LabeledIcon","commandName","Tutorial$1","canCreatePrivateGroups","VersionInfoItem","VersionInfo$1","versionData","TabHeader","TabPanel","HelpPanelTab","HelpPanel$1","tutorialTabId","tutorialPanelId","versionTabId","versionPanelId","hasAutoDisplayPreference","show_sidebar_tutorial","activeSubPanel","setActiveSubPanel","supportTicketURL","dismissSidebarTutorial","Tutorial","VersionInfo","EventEmitter","destroy","off","emit","ResultSizeError","super","defaultPageSize","SearchClient","searchFn","getPageSize","separateReplies","incremental","maxResults","sortOrder","_searchFn","_getPageSize","_separateReplies","_incremental","_maxResults","_sortBy","_sortOrder","_canceled","_expectedCount","_fetchedCount","_results","searchAfter","searchQuery","order","_separate_replies","search_after","replies","expectMore","nextSearchAfter","_getPage","FilterSelect","defaultOption","selectedOption","filterOptions","NotebookFilters","userFilter","userFilterOptions","currentUsername","username_","userOptions","useUserFilterOptions","NotebookResultCount","forcedVisibleCount","isFiltered","visibleCount","hasResults","matchCount","threadCount","PaginatedThreadList","pageSize","paginatedThreads","startIndex","endIndex","pluralize","singular","plural","modifiers","ctrl","installShortcut","shortcut","onPress","rootElement","onKeydown","requiredModifiers","requiredKey","part","modifierFlag","matchShortcut","useShortcut","HideableBlock","UpdateBlock","streamer","analytics","hasPendingChanges","applyPendingUpdates","trackEvent","groupName","lastPaginationPage","paginationPage","setPaginationPage","hasTooManyAnnotationsError","setHasTooManyAnnotationsError","onLoadError","connect","applyUpdatesImmediately","load","onError","streamFilterBy","newPage","threadListScrollTop","PendingUpdatesNotification","ToastBadge","ProfileView","loading","setLoading","saveCount","setSaveCount","savingTimeout","prevCount","withSaveMessage","annotationsByUser","getDisplayName","excludeReplies","userInfos","formatDate","getMonth","padStart","getDate","suggestedFilename","filenameSegments","maxLength","LoadingSpinner","UserAnnotationsListItem","userAnnotations","exportFormats","shortTitle","annotationsExporter","exportReady","contentFrame","exportableAnnotations","userList","currentUser","allAnnotationsOption","selectedUserId","setSelectedUserId","selectedUserAnnotations","exportFormat","setExportFormat","fileInputId","userSelectId","draftCount","defaultFilename","customFilename","setCustomFilename","buildExportContent","annotationsToExport","buildJSONExportContent","buildTextExportContent","buildCSVExportContent","buildHTMLExportContent","exportAnnotations","exportData","mimeType","json","csv","formatToMimeType","document_","blob","Blob","createObjectURL","click","revokeObjectURL","downloadFile","copyAnnotationsExport","types","write","blobs","acc","ClipboardItem","copyHandler","clipboardData","setData","execCommand","copyHTML","onSubmit","required","readJSONFile","file","fileReader","FileReader","promise","reject","resolve_","reject_","promiseWithResolvers","readAsText","CircularProgress","diameter","circumference","PI","cx","cy","strokeDasharray","strokeDashoffset","transitionDuration","transitionProperty","FileInput","onFileSelected","fileInputRef","setFilename","files","ImportAnnotations$1","importAnnotationsService","setFile","setAnnotations","selectedUser","importAnnotations","readExportFile","userMatch","import","importReady","parseInProgress","importsCompleted","busy","importProgress","newValue","ShareAnnotations$1","sharingReady","documentURI","copyShareLink","ShareDialog","shareTab","panelTitle","initialTab","setSelectedTab","isFirstTabSelected","ShareAnnotations","ExportAnnotations","ImportAnnotations","LoggedOutMessage","LoginPromptPanel","onSignUp","idForTab","idForPanel","tabId","showAnnotationsUnavailableMessage","showNotesUnavailableMessage","tabCountsSummaryPieces","enableExperimentalNewNoteButton","createPageNote","FilterToggle","IconComponent","setActive","testId","CardContainer","FilterControls","withCardContainer","selectedCount","hasFocusFilters","linkedAnnotationId","linkedAnnotation","directLinkedTab","userId","hasDirectLinkedAnnotationError","hasDirectLinkedGroupError","hasContentError","isSearchPanelOpen","showFilterControls","showLoggedOutMessage","prevGroupId","SidebarTabs","currentQuery","loadAnnotations","queryParams","ToastMessages$1","BaseToastMessages","dismiss","orgName","organization","DEFAULT_ORG_ID","organizations","orgs","orgId","groupObj","groupList","logo","addGroup","groupsByOrganization","defaultOrganizationGroups","sortedGroups","orgKey","MenuSection","toChildArray","GroupIcon","onExpand","activityUrl","hasActionMenu","canLeave","isSelectable","scopes","enforced","toggleSubmenu","copyLinkLabel","copyLink","leave","GroupListSection","expandedGroup","onExpandGroup","GroupListItem","GroupList$1","currentGroups","myGroupsSorted","featuredGroupsSorted","currentGroupsSorted","canCreateNewGroup","newGroupLink","setExpandedGroup","svc","publisherProvidedIcon","altName","itemLabels","newest","oldest","SortMenu","sortOption","PressableIconButton","TopBarToggleButton","dashboard","isMenuOpen","authTokenOrError","setAuthTokenOrError","getAuthToken","onLogout","serviceSupports","isSelectableProfile","logoutAvailable","logoutDisabled","isProfileEnabled","onSelectNotebook","notifyHost","onSelectProfile","profileHref","onProfileSelected","showEntryPoint","OpenDashboardMenuItem","SearchIconButton","toggleSearchPanel","prevFocusRef","openSearch","useSearchKeyboardShortcuts","SearchField","onClearSearch","onSearch","prevQuery","setPrevQuery","pendingQuery","setPendingQuery","StreamSearchInput$1","router","setQuery","navigate","controlEnabled","enableShareImportExportPanel","enableAccountMenu","isSidebar","loginLinkStyle","isHelpPanelOpen","isAnnotationsPanelOpen","GroupList","StreamSearchInput","requestHelp","onHelpRequestProvided","UserMenu","SearchPanel","clearSearch","HypothesisApp$1","auth","isModalRoute","backgroundStyle","isThemeClean","theme","shouldAutoDisplayTutorial","login","reload","signUp","TopBar","promptToLogout","logout","HelpPanel","AnnotationView","NotebookView","StreamView","SidebarView","LaunchErrorPanel","byteToHex","generateHexString","len","bytes","Uint8Array","crypto","getRandomValues","origin","request","jsonrpc","postMessage","response","responseOrTimeout","delay","race","parseConfigFragment","configStr","hash","configJSON","toBoolean","toLocaleLowerCase","numericalVal","toInteger","getEmbedderFrame","levels","ancestorWindow","shownWarnings","warnOnce","reset","escapeStringRegexp","allowLeavingGroups","PUBLIC_GROUP_ID","combineGroups","userGroups","worldGroup","myGroupIds","uri_patterns","uriRegex","uriMatchesScopes","preStartQueue","registeredMethods","groupIds","findGroupsByAnyIds","normalizeGroupIds","showContentInfo","startServer","$window","methods","receiveMessage","allowedOrigins","rpcAllowedOrigins","jsonRpcRequest","jsonRpcResponse","preStartMessageListener","AnalyticsService","_api","events","AnnotationActivityService","_rpc","rpc","_reportConfig","reportActivity","activityDate","toISOString","postMessageJsonRpc","targetFrame","AnnotationsService","annotationActivity","_activity","_settings","_store","_applyDraftChanges","mentionsOptions","precedingChar","buildAccountID","wrapMentions","wrapDisplayNameMentions","annotationFromData","annotationData","defaultPrivacy","topLevelFrame","pageNoteAnnotation","replyAnnotation","saved","annotationWithChanges","savedAnnotation","for","pretty","shallow","renderRootComponent","shallowHighOrder","_dirty","_nextState","W","U","Z","sortAttributes","R","allAttributes","attributeHook","J","voidElements","G","Q","X","Y","tt","et","nt","getOwnPropertySymbols","toJSON","print","edgeSpacing","indent","maxDepth","plugins","opts","rt","skipFalseAttributes","functionNames","jsx","dedentStr","indentRegexp","trimAndDedent","strings","smallestIndent","dedent","stripInternalProperties","formatSortableDateTime","getHours","getMinutes","AnnotationsExporter","export_date","export_userid","client_version","uniqueUsers","extractUsername","_exportCommon","annotationsAsText","annotationToRow","escapeCSVValue","charSet","dateTime","renderedComment","comment","firstAnnotation","FetchError","reason","fetchJSON","APIService","apiRoutes","_clientId","routes","getClientId","apiCall","getAccessToken","onRequestStarted","onRequestFinished","signal","linksMap","all","descriptor","routeMap","cursor","pathSegments","nextCursor","findRouteMetadata","Authorization","clientId","apiURL","createAPICall","member","setClientId","RetryOperation","timeouts","forever","_originalTimeouts","_timeouts","_options","_maxRetryTime","maxRetryTime","_fn","_errors","_attempts","_operationTimeout","_operationTimeoutCb","_timeout","_operationStart","_timer","_cachedTimeouts","retry_operation","stop","retry","currentTime","unref","attempt","timeoutOps","cb","try","errors","attempts","mainError","counts","mainErrorCount","require$$0","operation","retries","factor","minTimeout","maxTimeout","randomize","createTimeout","wrap","retryPromiseOperation","getJSON","APIRoutesService","_apiURL","apiUrl","_routeCache","_linkCache","TokenError","OAuthClient","tokenEndpoint","authorizationEndpoint","revokeEndpoint","exchangeAuthCode","_getAccessToken","client_id","grant_type","exchangeGrantToken","assertion","refreshToken","refresh_token","accessToken","_formPost","authorize","authResponse","authRespListener","authURL","authWindowSettings","screen","access_token","expiresAt","expires_in","AuthService","localStorage","_authCode","_client","_tokenInfoPromise","_apiRoutes","_localStorage","_toastMessenger","_window","_listenForTokenStorageEvents","_storageKey","_loadToken","getObject","isTokenInfo","relativeURL","baseURL","oauthClientId","client","_oauthClient","tokenInfo","_saveToken","grantToken","_getGrantToken","apiDomain","setObject","persist","_exchangeGrantToken","_exchangeAuthCodeForToken","origToken","_refreshAccessToken","authCode","revokeToken","removeItem","AutosaveService","_annotationsService","_saving","_failed","shouldSaveHighlight","htag","autosaveNewHighlights","highlight","finally","DashboardService","_dashboardConfig","authTokenRPCMethod","authToken","form","entryPointURL","authInput","authFieldName","submit","isMessage","PortRequestError","PortFinder","hostFrame","sourceId","_hostFrame","_source","_sourceId","requestId","postRequest","frame1","frame2","intervalId","setInterval","timeoutId","clearInterval","ports","handleErrorsInFrames","handleMessage","deserializeError","VERSION","PROTOCOL","makeRequestMessage","sendCall","port","PortRPC","currentWindow","forceUnloadListener","_port","_methods","_sequence","_callbacks","MessagePort","webkitVersionMatch","versionMatch","shouldUseSafariWorkaround","_pendingCalls","_destroyed","_receivedCloseEvent","_handle","MessageEvent","seq","finalArg","_parseMessage","annotationMatchesSegment","getValue","prevValue","savedPrevValue","formatAnnot","frameForAnnotation","uriMatch","FrameSyncService","_portFinder","_hostRPC","_guestRPC","_inFrame","_highlightsVisible","_pendingScrollToTag","_pendingHoverTag","_pendingAnchorStatusUpdates","_scheduleAnchorStatusUpdate","records","fromEntries","_sidebarIsOpen","_setupSyncToGuests","_setupHostEvents","_setupFeatureFlagSync","_setupToastMessengerEvents","prevPublicAnns","onStoreAnnotationsChanged","prevAnnotations","publicAnns","inSidebar","deleted","addedByFrame","anchorImmediately","_updateAnchorStatus","frameId","guest","_connectGuest","guestRPC","cfiStart","cfiEnd","segmentMatchesFocusFilters","persistent","hasGroup","focusFirstInSelection","getFlags","sendFlags","messageId","hostPort","discover","isMessageEqual","DEFAULT_ORGANIZATION","expandParam","GroupsService","_focusedMembersController","_auth","_serviceConfig","_reloadSetUp","_mainURI","directLinkedAnnotationGroupId","directLinkedGroup","pageHasAssociatedGroups","_setupAutoReload","prevFetchedProfile","_addGroupsToStore","groupToFocus","injectOrganizations","isFirstLoad","prevFocusedGroup","_fetchGroup","expand","getDocumentUriForGroupSearch","awaitStateChange","documentUri","directLinkedAnnId","directLinkedAnnApi","directLinkedGroupApi","listParams","document_uri","directLinkedAnn","directLinkedAnnGroup","_filterGroups","tryFetchGroup","groupResults","groupIdsOrPromise","_loadServiceSpecifiedGroups","_loadGroupsForUserAndDocument","newGroupId","abort","pubid","AbortController","_fetchAllMembers","aborted","firstPage","_fetchMembers","membersPage","DEBUG_BUILD","__SENTRY_DEBUG__","GLOBAL_OBJ","globalThis","SDK_VERSION","getMainCarrier","getSentryCarrier","carrier","__SENTRY__","getGlobalSingleton","creator","CONSOLE_LEVELS","originalConsoleMethods","consoleSandbox","wrappedFuncs","wrappedLevels","level","originalConsoleMethod","logger","enable","disable","isEnabled","STACKTRACE_FRAME_LIMIT","UNKNOWN_FUNCTION","WEBPACK_ERROR_REGEXP","STRIP_FRAME_REGEXP","createStackParser","sortedParsers","skipFirstLines","framesToPop","cleanedLine","localStack","getLastStackFrame","function","stripSentryFramesAndReverse","defaultFunctionName","getFunctionName","getFramesFromEvent","exception","stacktrace","_oO","handlers","instrumented","addHandler","maybeInstrument","instrumentFn","triggerHandlers","typeHandlers","_oldOnErrorHandler","instrumentError","onerror","column","__SENTRY_INSTRUMENTED__","_oldOnUnhandledRejectionHandler","instrumentUnhandledRejection","onunhandledrejection","ONE_SECOND_IN_MS","dateTimestampInSeconds","timestampInSeconds","performance","approxStartingTimeOrigin","timeOrigin","createUnixTimestampInSecondsFunc","isError","wat","isInstanceOf","isBuiltin","isErrorEvent","isDOMError","isParameterizedString","isPrimitive","isEvent","Event","isThenable","_e","isVueViewModel","__isVue","_isVue","WINDOW","DEFAULT_MAX_STRING_LENGTH","htmlTreeAsString","currentElem","MAX_TRAVERSE_HEIGHT","out","sepLength","nextStr","keyAttrs","maxStringLength","_htmlElementAsString","keyAttrPairs","keyAttr","keyAttrPair","allowedAttrs","getLocationHref","oO","safeJoin","isMatchingPattern","pattern","requireExactStringMatch","stringMatchesSomePattern","testString","patterns","replacementFactory","markFunctionWrapped","addNonEnumerableProperty","o_O","getOriginalFunction","__sentry_original__","convertToPlainObject","getOwnProperties","newObj","serializeEventTarget","currentTarget","detail","extractedProps","uuid4","gbl","msCrypto","getCrypto","getRandomByte","randomUUID","typedArray","getFirstException","getEventDescription","event_id","eventId","firstException","addExceptionTypeValue","addExceptionMechanism","newMechanism","currentMechanism","mechanism","mergedData","checkOrSetAlreadyCaught","__sentry_captured__","isAlreadyCaptured","States","resolvedSyncPromise","SyncPromise","rejectedSyncPromise","executor","_state","PENDING","_handlers","_runExecutor","onfulfilled","onrejected","_executeHandlers","onfinally","isRejected","cachedHandlers","RESOLVED","REJECTED","setResult","makeSession","startingTime","sid","started","duration","ignoreDuration","did","abnormal_mechanism","attrs","release","environment","ip_address","ipAddress","user_agent","sessionToJSON","updateSession","generateTraceId","generateSpanId","merge","initialObj","mergeObj","SCOPE_SPAN_FIELD","_setSpanForScope","_getSpanForScope","Scope","_notifyingListeners","_scopeListeners","_eventProcessors","_breadcrumbs","_attachments","_user","_tags","_extra","_contexts","_sdkProcessingMetadata","_propagationContext","traceId","sampleRand","newScope","_level","_session","_transactionName","_fingerprint","_lastEventId","setClient","setLastEventId","lastEventId","getClient","addScopeListener","addEventProcessor","setUser","_notifyScopeListeners","getUser","setTags","setTag","setExtras","extras","setExtra","extra","setFingerprint","setLevel","setTransactionName","setContext","setSession","getSession","captureContext","scopeToMerge","scopeInstance","getScopeData","contexts","propagationContext","setPropagationContext","addBreadcrumb","breadcrumb","maxBreadcrumbs","maxCrumbs","mergedBreadcrumb","recordDroppedEvent","getLastBreadcrumb","clearBreadcrumbs","addAttachment","attachment","clearAttachments","breadcrumbs","attachments","eventProcessors","sdkProcessingMetadata","transactionName","setSDKProcessingMetadata","newData","getPropagationContext","captureException","hint","syntheticException","originalException","captureMessage","captureEvent","AsyncContextStack","isolationScope","assignedScope","assignedIsolationScope","_stack","_isolationScope","withScope","_pushScope","maybePromiseResult","_popScope","getStackTop","getScope","getIsolationScope","getAsyncContextStack","sentry","withSetScope","withIsolationScope","getAsyncContextStrategy","acs","withSetIsolationScope","getCurrentScope","getTraceContextFromScope","parentSpanId","propagationSpanId","traceContext","trace_id","span_id","parent_span_id","SEMANTIC_ATTRIBUTE_SENTRY_SOURCE","SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE","SEMANTIC_ATTRIBUTE_SENTRY_OP","SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN","SEMANTIC_ATTRIBUTE_PROFILE_ID","SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME","SPAN_STATUS_UNSET","SPAN_STATUS_OK","SCOPE_ON_START_SPAN_FIELD","ISOLATION_SCOPE_ON_START_SPAN_FIELD","getCapturedScopesOnSpan","SENTRY_BAGGAGE_KEY_PREFIX","SENTRY_BAGGAGE_KEY_PREFIX_REGEX","baggageHeaderToDynamicSamplingContext","baggageHeader","baggageObject","curr","currBaggageObject","baggageHeaderToObject","parseBaggageHeader","dynamicSamplingContext","baggageEntry","keyOrValue","decodeURIComponent","TRACE_FLAG_SAMPLED","hasShownSpanDropWarning","spanToTraceContext","spanId","isRemote","spanContext","spanToJSON","convertSpanLinksForEnvelope","traceFlags","restContext","sampled","spanTimeInputToSeconds","ensureTimestampInSeconds","getSpanJSON","spanIsSentrySpan","castSpan","spanIsOpenTelemetrySdkTraceBaseSpan","start_timestamp","getStatusMessage","ROOT_SPAN_FIELD","getRootSpan","showSpanDropWarning","DEFAULT_ENVIRONMENT","FROZEN_DSC_FIELD","getDynamicSamplingContextFromClient","publicKey","public_key","getDsn","dsc","getDynamicSamplingContextFromSpan","rootSpan","rootSpanJson","rootSpanAttributes","traceState","rootSpanSampleRate","applyLocalSampleRateToDsc","sample_rate","frozenDsc","traceStateDsc","dscOnTraceState","transaction","maybeOptions","__SENTRY_TRACING__","tracesSampleRate","tracesSampler","hasSpansEnabled","spanIsSampled","sample_rand","DSN_REGEX","dsnToString","dsn","withPassword","pass","projectId","dsnFromComponents","components","makeDsn","lastPath","projectMatch","dsnFromString","component","isValidProtocol","validateDsn","maxProperties","visit","ERROR","normalizeToSize","normalized","utf8Length","WeakSet","unmemoize","memoBuilder","isFinite","stringified","_events","objName","getConstructorName","stringifyValue","remainingDepth","valueWithToJSON","numAdded","visitable","visitKey","visitValue","createEnvelope","addItemToEnvelope","envelope","newItem","forEachEnvelopeItem","envelopeItems","envelopeItem","encodeUTF8","encodePolyfill","TextEncoder","serializeEnvelope","envHeaders","itemHeaders","stringifiedPayload","buffers","totalLength","buf","merged","buffer","concatBuffers","createAttachmentEnvelopeItem","content_type","contentType","attachment_type","attachmentType","ITEM_TYPE_TO_DATA_CATEGORY_MAP","sessions","client_report","user_report","profile_chunk","replay_event","replay_recording","check_in","raw_security","otel_log","envelopeItemTypeToDataCategory","getSdkMetadataForEnvelopeHeader","metadataOrEvent","sdk","createEventEnvelope","tunnel","sdkInfo","integrations","packages","enhanceEventWithSdkInfo","envelopeHeaders","sent_at","trace","createEventEnvelopeHeaders","notifyEventProcessors","processors","final","parsedStackResults","lastKeysCount","cachedFilenameDebugIds","applyScopeDataToEvent","applyDataToEvent","applySpanToEvent","applyFingerprintToEvent","mergedBreadcrumbs","applyBreadcrumbsToEvent","applySdkMetadataToEvent","mergeScopeData","mergeData","mergeAndOverwriteScopeData","mergeVal","prepareEvent","normalizeDepth","normalizeMaxBreadth","prepared","dist","maxValueLength","applyClientOptions","integrationNames","applyIntegrationsMetadata","stackParser","filenameDebugIdMap","debugIdMap","_sentryDebugIds","debugIdKeys","stackKey","parsedStack","stackFrame","debugId","getFilenameToDebugIdMap","debug_id","applyDebugIds","finalScope","getFinalScope","clientEventProcessors","getEventProcessors","evt","abs_path","debug_meta","images","code_file","applyDebugMeta","maxBreadth","normalizeEvent","parseEventHintOrCaptureContext","hintIsScopeOrFunction","captureContextKeys","hintIsScopeContext","startSession","currentScope","currentSession","endSession","closeSession","_sendSessionUpdate","captureSession","SENTRY_API_VERSION","getEnvelopeEndpointWithUrlEncodedAuth","getBaseApiEndpoint","_getIngestEndpoint","sentry_version","sentry_key","sentry_client","_encodedAuth","installedIntegrations","getIntegrationsToSetup","defaultIntegrations","userIntegrations","integration","isDefaultInstance","resolvedUserIntegrations","integrationsByName","currentInstance","existingInstance","filterDuplicates","afterSetupIntegrations","afterAllSetup","setupIntegration","integrationIndex","setupOnce","setup","preprocessEvent","processEvent","getPossibleEventMessages","possibleMessages","lastException","ALREADY_SEEN_ERROR","MISSING_RELEASE_FOR_SESSION_ERROR","INTERNAL_ERROR_SYMBOL","DO_NOT_SEND_EVENT_SYMBOL","_makeInternalError","_makeDoNotSendEventError","_isInternalError","_isDoNotSendEventError","Client","_integrations","_numProcessing","_outcomes","_hooks","_dsn","_metadata","_transport","transport","transportOptions","hintWithEventId","_process","eventFromException","_captureEvent","eventMessage","promisedEvent","eventFromMessage","capturedSpanScope","capturedSpanIsolationScope","sendSession","getSdkMetadata","getTransport","_isClientDoneProcessing","clientFinished","transportFlushed","eventProcessor","_isEnabled","_setupIntegrations","getIntegrationByName","integrationName","addIntegration","isAlreadyInstalled","sendEvent","sendEnvelope","sendResponse","clientReleaseOption","clientEnvironmentOption","sessionAttrs","createSessionEnvelope","category","sendClientReports","cbIndex","callbacks","send","setupIntegrations","_updateSessionFromEvent","crashed","errored","exceptions","sessionNonTerminal","ticked","interval","_prepareEvent","getDynamicSamplingContextFromScope","_processEvent","finalEvent","sampleRate","isTransaction","isTransactionEvent","beforeSendLabel","parsedSampleRate","rate","parseSampleRate","dataCategory","__sentry__","beforeSend","beforeSendTransaction","beforeSendSpan","processedEvent","processedRootSpanJson","profile_id","exclusive_time","measurements","is_segment","convertTransactionEventToSpanJson","processedSpans","processedSpan","spanCountBefore","spanCountBeforeProcessing","processBeforeSend","beforeSendResult","invalidValueError","_validateBeforeSendResult","spanCount","droppedSpanCount","transactionInfo","transaction_info","_clearOutcomes","outcomes","quantity","_flushOutcomes","discarded_events","createOtelLogEnvelopeItem","CLIENT_TO_LOG_BUFFER_MAP","_INTERNAL_flushLogsBuffer","maybeLogBuffer","logBuffer","clientOptions","logs","createOtelLogEnvelope","initAndBind","clientClass","initialScope","setCurrentClient","SENTRY_BUFFER_FULL_ERROR","makePromiseBuffer","taskProducer","drain","counter","capturedSetTimeout","DEFAULT_RETRY_AFTER","updateRateLimits","statusCode","updatedRateLimits","rateLimitHeader","retryAfterHeader","retryAfter","categories","namespaces","headerDelay","headerDate","parseRetryAfterHeader","DEFAULT_TRANSPORT_BUFFER_SIZE","createTransport","makeRequest","bufferSize","rateLimits","filteredEnvelopeItems","disabledUntil","isRateLimited","filteredEnvelope","recordEnvelopeLoss","addAutoIpAddressToUser","objWithMaybeUser","addAutoIpAddressToSession","DEFAULT_BREADCRUMBS","beforeBreadcrumb","finalBreadcrumb","originalFunctionToString","SETUP_CLIENTS","functionToStringIntegration","originalFunction","DEFAULT_IGNORE_ERRORS","eventFiltersIntegration","mergedOptions","_mergeOptions","_hint","ignoreTransactions","_isIgnoredTransaction","ignoreErrors","_isIgnoredError","_isUselessError","denyUrls","_getEventFilterUrl","_isDeniedUrl","allowUrls","_isAllowedUrl","_shouldDropEvent","inboundFiltersIntegration","internalOptions","disableErrorDefaults","rootException","parent_id","_getLastValidUrl","applyAggregateErrorsToEvent","exceptionFromErrorImplementation","aggregateExceptionsFromError","prevExceptions","exceptionId","newExceptions","applyExceptionGroupFieldsForParentException","newException","newExceptionId","applyExceptionGroupFieldsForChildException","childError","is_exception_group","exception_id","instrumentConsole","severityLevelFromString","dedupeIntegration","previousEvent","currentEvent","currentMessage","previousMessage","_isSameFingerprint","_isSameStacktrace","_isSameMessageEvent","previousException","_getExceptionFromEvent","currentException","_isSameExceptionEvent","currentFrames","previousFrames","frameA","frameB","lineno","colno","currentFingerprint","previousFingerprint","parseUrl","getBreadcrumbLogLevelFromHttpStatusCode","supportsFetch","Headers","Request","Response","isNativeFunction","addFetchInstrumentationHandler","skipNativeFetchCheck","onFetchResolved","EdgeRuntime","sandbox","head","contentWindow","supportsNativeFetch","originalFetch","virtualError","fetchArgs","getUrlFromResource","hasProp","parseFetchArgs","handlerData","fetchData","startTimestamp","getHeadersFromFetchArgs","endTimestamp","instrumentFetch","resource","requestArgument","optionsArgument","ignoreOnError","shouldIgnoreOnError","__sentry_wrapped__","sentryWrapped","wrappedArguments","exceptionFromError","parseStackFrames","extractType","extractMessage","eventFromPlainObject","isUnhandledRejection","errorFromProp","getErrorPropertyFromObject","__serialized__","getNonErrorObjectExceptionValue","eventFromError","skipLines","reactMinifiedRegexp","getSkipFirstStackStringLines","getPopFirstTopFrames","isWebAssemblyException","WebAssembly","Exception","eventFromUnknownInput","attachStacktrace","domException","eventFromString","synthetic","__sentry_template_string__","__sentry_template_values__","logentry","firstKey","includedKeys","serialized","extractExceptionKeysForMessage","captureType","getObjectClassName","BrowserClient","parentSpanIsAlwaysRootSpan","applySdkMetadata","SENTRY_SDK_SOURCE","sendDefaultPii","_experiments","enableLogs","_logFlushIdleTimeout","DEBOUNCE_DURATION","debounceTimerID","lastCapturedEventType","lastCapturedEventTargetId","lastHref","instrumentDOM","triggerDOMHandler","globalDOMEventHandler","makeDOMEventHandler","globalObject","originalAddEventListener","__sentry_instrumentation_handlers__","handlerForType","refCount","originalRemoveEventListener","globalListener","getEventTarget","shouldSkipDOMEvent","_sentryId","isSimilarToLastCapturedEvent","addHistoryInstrumentationHandler","instrumentHistory","historyReplacementFunction","originalHistoryFunction","to","history","cachedImplementations","clearCachedImplementation","SENTRY_XHR_DATA_KEY","instrumentXHR","XMLHttpRequest","xhrproto","originalOpen","xhrOpenThisArg","xhrOpenArgArray","parseXhrUrlArg","request_headers","__sentry_own_request__","onreadystatechangeHandler","xhrInfo","readyState","status_code","xhr","onreadystatechange","originalOnreadystatechange","onreadystatechangeThisArg","onreadystatechangeArgArray","setRequestHeader","originalSetRequestHeader","setRequestHeaderThisArg","setRequestHeaderArgArray","originalSend","sendThisArg","sendArgArray","sentryXhrData","makeFetchTransport","nativeFetch","cached","impl","getNativeImplementation","pendingBodySize","pendingCount","requestSize","requestOptions","referrerPolicy","keepalive","fetchOptions","createFrame","in_app","chromeRegexNoFnName","chromeRegex","chromeEvalRegex","chromeStackLineParser","noFnParts","subMatch","extractSafariExtensionDetails","geckoREgex","geckoEvalRegex","geckoStackLineParser","defaultStackParser","isSafariExtension","isSafariWebExtension","MAX_ALLOWED_STRING_LENGTH","breadcrumbsIntegration","dom","addConsoleInstrumentationHandler","_getConsoleBreadcrumbHandler","componentName","serializeAttribute","_isEvent","getComponentName","_getDomBreadcrumbHandler","addXhrInstrumentationHandler","_getXhrBreadcrumbHandler","request_body_size","response_body_size","_getFetchBreadcrumbHandler","parsedLoc","parsedFrom","parsedTo","_getHistoryBreadcrumbHandler","_getSentryBreadcrumbHandler","DEFAULT_EVENT_TARGET","browserApiErrorsIntegration","_wrapTimeFunction","_wrapRAF","_wrapXHR","eventTargetOption","_wrapEventTarget","originalCallback","wrapOptions","eventName","handleEvent","originalEventHandler","browserSessionIntegration","globalHandlersIntegration","stackTraceLimit","addGlobalErrorInstrumentationHandler","ev","ev0","ev0s","ev0sf","_enhanceEventWithInitialFrame","_installGlobalOnErrorHandler","globalHandlerLog","addGlobalUnhandledRejectionInstrumentationHandler","_getUnhandledRejectionError","_installGlobalOnUnhandledRejectionHandler","httpContextIntegration","referrer","Referer","linkedErrorsIntegration","dropTopLevelUndefinedKeys","mutatetedObj","getOwnPropertyNames","browserOptions","optionsArg","__SENTRY_RELEASE__","SENTRY_RELEASE","applyDefaultOptions","skipBrowserExtensionCheck","windowWithMaybeExtension","extensionObject","chrome","runtimeId","runtime","isDedicatedExtensionPage","isNWjs","nw","shouldShowBrowserExtensionError","eventsSent","Sentry","setUserInfo","ImportAnnotationsService","currentGroup","existingAnns","currentFrame","importAnn","existingAnn","arraysEqual","duplicateMatch","importData","original_id","getImportData","saveData","queue","messageType","importCount","importMessage","dupCount","dupMessage","importStatus","notice","LoadAnnotationsService","streamFilter","_streamer","_streamFilter","_searchClient","resetFilter","addClause","searchOptions","replySearchResult","InMemoryStorage","getItem","setItem","LocalStorageService","testKey","_storage","repr","DEFAULT_KEYS","PersistedDefaultsService","persistChangedDefaults","defaults","prevDefaults","RouterService","_didRegisterPopstateListener","currentRoute","routeUrl","hasParams","sync","pushState","ServiceURLService","SessionService","_authority","_lastLoad","_lastLoadTime","updatedProfile","prevProfile","userChanged","StreamFilter","_filter","match_policy","clauses","actions","caseSensitive","case_sensitive","Socket","_messageQueue","_socket","WebSocket","onopen","sendMessages","onclose","onmessage","isConnected","OPEN","messageString","StreamerService","_groups","_websocketURL","websocket","_updateImmediately","_configMessages","_reconnectionAttempts","_reconnectSetUp","deletions","_handleSocketError","websocketURL","websocketHost","_handleSocketMessage","model","_sendClientConfig","socket","configMessage","parsedURL","newSocket","_reconnect","TAGS_LIST_KEY","TAGS_MAP_KEY","TagsService","savedTags","words","tagsList","t1","t2","ThreadsService","ThumbnailService","requestThumbnail","ToastMessengerService","_delayedMessageQueue","messageText","_addMessage","delayed","hasFocus","configFromSidebar","settingsElements","parseJsonConfig","envOk","checkEnvironment","setupApi","syncRoute","loadGroupsAndProfile","initServices","autosaveService","persistedDefaults","serviceURL","setupFrameSync","scriptOrigin","currentScriptOrigin","originalErr","appEl","preStartRPCServer","configFromAnnotator","paramWhiteList","coercions","openSidebar","requestConfigFromFrame","objectVal","toObject","ancestorLevel","hostPageConfig","rpcSettings","rpcConfig","buildRPCSettings","configFromHost","configFromEmbedder","getEmbedderConfig","fetchServiceGroups","sidebarSettings","getApiUrl","buildSettings","startRPCServer","HypothesisApp","startApp","reportLaunchError"],"mappings":"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IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,OAAS,OAAS,EAAG,EAAG,MAChC,IAAO,CAAC,OAAS,OAAS,EAAG,EAAG,MAChC,IAAO,CAAC,OAAS,OAAS,EAAG,EAAG,MAChC,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,EAAG,EAAG,EAAG,MACpB,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,OAAS,EAAG,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,OAAS,OAAS,EAAG,EAAG,MAChC,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,IAAO,CAAC,EAAG,OAAS,EAAG,EAAG,MAC1B,KAAQ,CAAC,EAAG,OAAS,EAAG,EAAG,MAC3B,KAAQ,CAAC,EAAG,OAAS,EAAG,EAAG,MAC3B,KAAQ,CAAC,EA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AK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK;AACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK;AACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IA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","x_google_ignoreList":[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,116,117,121,133,146,163,164,165,166,215,281,287,295,296,297,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401]}